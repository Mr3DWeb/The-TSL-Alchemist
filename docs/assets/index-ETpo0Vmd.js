function TY(r,e){for(var t=0;t<e.length;t++){const n=e[t];if(typeof n!="string"&&!Array.isArray(n)){for(const i in n)if(i!=="default"&&!(i in r)){const s=Object.getOwnPropertyDescriptor(n,i);s&&Object.defineProperty(r,i,s.get?s:{enumerable:!0,get:()=>n[i]})}}}return Object.freeze(Object.defineProperty(r,Symbol.toStringTag,{value:"Module"}))}(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))n(i);new MutationObserver(i=>{for(const s of i)if(s.type==="childList")for(const a of s.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&n(a)}).observe(document,{childList:!0,subtree:!0});function t(i){const s={};return i.integrity&&(s.integrity=i.integrity),i.referrerPolicy&&(s.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?s.credentials="include":i.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function n(i){if(i.ep)return;i.ep=!0;const s=t(i);fetch(i.href,s)}})();function Ey(r){return r&&r.__esModule&&Object.prototype.hasOwnProperty.call(r,"default")?r.default:r}var A2={exports:{}},AS={};var RF;function EY(){if(RF)return AS;RF=1;var r=Symbol.for("react.transitional.element"),e=Symbol.for("react.fragment");function t(n,i,s){var a=null;if(s!==void 0&&(a=""+s),i.key!==void 0&&(a=""+i.key),"key"in i){s={};for(var o in i)o!=="key"&&(s[o]=i[o])}else s=i;return i=s.ref,{$$typeof:r,type:n,key:a,ref:i!==void 0?i:null,props:s}}return AS.Fragment=e,AS.jsx=t,AS.jsxs=t,AS}var CF;function MY(){return CF||(CF=1,A2.exports=EY()),A2.exports}var Wt=MY(),w2={exports:{}},wS={},R2={exports:{}},C2={};var NF;function AY(){return NF||(NF=1,(function(r){function e(V,X){var ee=V.length;V.push(X);e:for(;0<ee;){var fe=ee-1>>>1,Y=V[fe];if(0<i(Y,X))V[fe]=X,V[ee]=Y,ee=fe;else break e}}function t(V){return V.length===0?null:V[0]}function n(V){if(V.length===0)return null;var X=V[0],ee=V.pop();if(ee!==X){V[0]=ee;e:for(var fe=0,Y=V.length,K=Y>>>1;fe<K;){var he=2*(fe+1)-1,Ce=V[he],Ie=he+1,ut=V[Ie];if(0>i(Ce,ee))Ie<Y&&0>i(ut,Ce)?(V[fe]=ut,V[Ie]=ee,fe=Ie):(V[fe]=Ce,V[he]=ee,fe=he);else if(Ie<Y&&0>i(ut,ee))V[fe]=ut,V[Ie]=ee,fe=Ie;else break e}}return X}function i(V,X){var ee=V.sortIndex-X.sortIndex;return ee!==0?ee:V.id-X.id}if(r.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var s=performance;r.unstable_now=function(){return s.now()}}else{var a=Date,o=a.now();r.unstable_now=function(){return a.now()-o}}var l=[],c=[],d=1,p=null,y=3,_=!1,v=!1,b=!1,E=!1,T=typeof setTimeout=="function"?setTimeout:null,M=typeof clearTimeout=="function"?clearTimeout:null,R=typeof setImmediate<"u"?setImmediate:null;function N(V){for(var X=t(c);X!==null;){if(X.callback===null)n(c);else if(X.startTime<=V)n(c),X.sortIndex=X.expirationTime,e(l,X);else break;X=t(c)}}function P(V){if(b=!1,N(V),!v)if(t(l)!==null)v=!0,U||(U=!0,j());else{var X=t(c);X!==null&&ae(P,X.startTime-V)}}var U=!1,L=-1,F=5,O=-1;function B(){return E?!0:!(r.unstable_now()-O<F)}function q(){if(E=!1,U){var V=r.unstable_now();O=V;var X=!0;try{e:{v=!1,b&&(b=!1,M(L),L=-1),_=!0;var ee=y;try{t:{for(N(V),p=t(l);p!==null&&!(p.expirationTime>V&&B());){var fe=p.callback;if(typeof fe=="function"){p.callback=null,y=p.priorityLevel;var Y=fe(p.expirationTime<=V);if(V=r.unstable_now(),typeof Y=="function"){p.callback=Y,N(V),X=!0;break t}p===t(l)&&n(l),N(V)}else n(l);p=t(l)}if(p!==null)X=!0;else{var K=t(c);K!==null&&ae(P,K.startTime-V),X=!1}}break e}finally{p=null,y=ee,_=!1}X=void 0}}finally{X?j():U=!1}}}var j;if(typeof R=="function")j=function(){R(q)};else if(typeof MessageChannel<"u"){var Q=new MessageChannel,se=Q.port2;Q.port1.onmessage=q,j=function(){se.postMessage(null)}}else j=function(){T(q,0)};function ae(V,X){L=T(function(){V(r.unstable_now())},X)}r.unstable_IdlePriority=5,r.unstable_ImmediatePriority=1,r.unstable_LowPriority=4,r.unstable_NormalPriority=3,r.unstable_Profiling=null,r.unstable_UserBlockingPriority=2,r.unstable_cancelCallback=function(V){V.callback=null},r.unstable_forceFrameRate=function(V){0>V||125<V?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):F=0<V?Math.floor(1e3/V):5},r.unstable_getCurrentPriorityLevel=function(){return y},r.unstable_next=function(V){switch(y){case 1:case 2:case 3:var X=3;break;default:X=y}var ee=y;y=X;try{return V()}finally{y=ee}},r.unstable_requestPaint=function(){E=!0},r.unstable_runWithPriority=function(V,X){switch(V){case 1:case 2:case 3:case 4:case 5:break;default:V=3}var ee=y;y=V;try{return X()}finally{y=ee}},r.unstable_scheduleCallback=function(V,X,ee){var fe=r.unstable_now();switch(typeof ee=="object"&&ee!==null?(ee=ee.delay,ee=typeof ee=="number"&&0<ee?fe+ee:fe):ee=fe,V){case 1:var Y=-1;break;case 2:Y=250;break;case 5:Y=1073741823;break;case 4:Y=1e4;break;default:Y=5e3}return Y=ee+Y,V={id:d++,callback:X,priorityLevel:V,startTime:ee,expirationTime:Y,sortIndex:-1},ee>fe?(V.sortIndex=ee,e(c,V),t(l)===null&&V===t(c)&&(b?(M(L),L=-1):b=!0,ae(P,ee-fe))):(V.sortIndex=Y,e(l,V),v||_||(v=!0,U||(U=!0,j()))),V},r.unstable_shouldYield=B,r.unstable_wrapCallback=function(V){var X=y;return function(){var ee=y;y=X;try{return V.apply(this,arguments)}finally{y=ee}}}})(C2)),C2}var DF;function wY(){return DF||(DF=1,R2.exports=AY()),R2.exports}var N2={exports:{}},ti={};var OF;function RY(){if(OF)return ti;OF=1;var r=Symbol.for("react.transitional.element"),e=Symbol.for("react.portal"),t=Symbol.for("react.fragment"),n=Symbol.for("react.strict_mode"),i=Symbol.for("react.profiler"),s=Symbol.for("react.consumer"),a=Symbol.for("react.context"),o=Symbol.for("react.forward_ref"),l=Symbol.for("react.suspense"),c=Symbol.for("react.memo"),d=Symbol.for("react.lazy"),p=Symbol.for("react.activity"),y=Symbol.iterator;function _(K){return K===null||typeof K!="object"?null:(K=y&&K[y]||K["@@iterator"],typeof K=="function"?K:null)}var v={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},b=Object.assign,E={};function T(K,he,Ce){this.props=K,this.context=he,this.refs=E,this.updater=Ce||v}T.prototype.isReactComponent={},T.prototype.setState=function(K,he){if(typeof K!="object"&&typeof K!="function"&&K!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,K,he,"setState")},T.prototype.forceUpdate=function(K){this.updater.enqueueForceUpdate(this,K,"forceUpdate")};function M(){}M.prototype=T.prototype;function R(K,he,Ce){this.props=K,this.context=he,this.refs=E,this.updater=Ce||v}var N=R.prototype=new M;N.constructor=R,b(N,T.prototype),N.isPureReactComponent=!0;var P=Array.isArray;function U(){}var L={H:null,A:null,T:null,S:null},F=Object.prototype.hasOwnProperty;function O(K,he,Ce){var Ie=Ce.ref;return{$$typeof:r,type:K,key:he,ref:Ie!==void 0?Ie:null,props:Ce}}function B(K,he){return O(K.type,he,K.props)}function q(K){return typeof K=="object"&&K!==null&&K.$$typeof===r}function j(K){var he={"=":"=0",":":"=2"};return"$"+K.replace(/[=:]/g,function(Ce){return he[Ce]})}var Q=/\/+/g;function se(K,he){return typeof K=="object"&&K!==null&&K.key!=null?j(""+K.key):he.toString(36)}function ae(K){switch(K.status){case"fulfilled":return K.value;case"rejected":throw K.reason;default:switch(typeof K.status=="string"?K.then(U,U):(K.status="pending",K.then(function(he){K.status==="pending"&&(K.status="fulfilled",K.value=he)},function(he){K.status==="pending"&&(K.status="rejected",K.reason=he)})),K.status){case"fulfilled":return K.value;case"rejected":throw K.reason}}throw K}function V(K,he,Ce,Ie,ut){var Ee=typeof K;(Ee==="undefined"||Ee==="boolean")&&(K=null);var Ne=!1;if(K===null)Ne=!0;else switch(Ee){case"bigint":case"string":case"number":Ne=!0;break;case"object":switch(K.$$typeof){case r:case e:Ne=!0;break;case d:return Ne=K._init,V(Ne(K._payload),he,Ce,Ie,ut)}}if(Ne)return ut=ut(K),Ne=Ie===""?"."+se(K,0):Ie,P(ut)?(Ce="",Ne!=null&&(Ce=Ne.replace(Q,"$&/")+"/"),V(ut,he,Ce,"",function(Ft){return Ft})):ut!=null&&(q(ut)&&(ut=B(ut,Ce+(ut.key==null||K&&K.key===ut.key?"":(""+ut.key).replace(Q,"$&/")+"/")+Ne)),he.push(ut)),1;Ne=0;var rt=Ie===""?".":Ie+":";if(P(K))for(var Nt=0;Nt<K.length;Nt++)Ie=K[Nt],Ee=rt+se(Ie,Nt),Ne+=V(Ie,he,Ce,Ee,ut);else if(Nt=_(K),typeof Nt=="function")for(K=Nt.call(K),Nt=0;!(Ie=K.next()).done;)Ie=Ie.value,Ee=rt+se(Ie,Nt++),Ne+=V(Ie,he,Ce,Ee,ut);else if(Ee==="object"){if(typeof K.then=="function")return V(ae(K),he,Ce,Ie,ut);throw he=String(K),Error("Objects are not valid as a React child (found: "+(he==="[object Object]"?"object with keys {"+Object.keys(K).join(", ")+"}":he)+"). If you meant to render a collection of children, use an array instead.")}return Ne}function X(K,he,Ce){if(K==null)return K;var Ie=[],ut=0;return V(K,Ie,"","",function(Ee){return he.call(Ce,Ee,ut++)}),Ie}function ee(K){if(K._status===-1){var he=K._result;he=he(),he.then(function(Ce){(K._status===0||K._status===-1)&&(K._status=1,K._result=Ce)},function(Ce){(K._status===0||K._status===-1)&&(K._status=2,K._result=Ce)}),K._status===-1&&(K._status=0,K._result=he)}if(K._status===1)return K._result.default;throw K._result}var fe=typeof reportError=="function"?reportError:function(K){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var he=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof K=="object"&&K!==null&&typeof K.message=="string"?String(K.message):String(K),error:K});if(!window.dispatchEvent(he))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",K);return}console.error(K)},Y={map:X,forEach:function(K,he,Ce){X(K,function(){he.apply(this,arguments)},Ce)},count:function(K){var he=0;return X(K,function(){he++}),he},toArray:function(K){return X(K,function(he){return he})||[]},only:function(K){if(!q(K))throw Error("React.Children.only expected to receive a single React element child.");return K}};return ti.Activity=p,ti.Children=Y,ti.Component=T,ti.Fragment=t,ti.Profiler=i,ti.PureComponent=R,ti.StrictMode=n,ti.Suspense=l,ti.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=L,ti.__COMPILER_RUNTIME={__proto__:null,c:function(K){return L.H.useMemoCache(K)}},ti.cache=function(K){return function(){return K.apply(null,arguments)}},ti.cacheSignal=function(){return null},ti.cloneElement=function(K,he,Ce){if(K==null)throw Error("The argument must be a React element, but you passed "+K+".");var Ie=b({},K.props),ut=K.key;if(he!=null)for(Ee in he.key!==void 0&&(ut=""+he.key),he)!F.call(he,Ee)||Ee==="key"||Ee==="__self"||Ee==="__source"||Ee==="ref"&&he.ref===void 0||(Ie[Ee]=he[Ee]);var Ee=arguments.length-2;if(Ee===1)Ie.children=Ce;else if(1<Ee){for(var Ne=Array(Ee),rt=0;rt<Ee;rt++)Ne[rt]=arguments[rt+2];Ie.children=Ne}return O(K.type,ut,Ie)},ti.createContext=function(K){return K={$$typeof:a,_currentValue:K,_currentValue2:K,_threadCount:0,Provider:null,Consumer:null},K.Provider=K,K.Consumer={$$typeof:s,_context:K},K},ti.createElement=function(K,he,Ce){var Ie,ut={},Ee=null;if(he!=null)for(Ie in he.key!==void 0&&(Ee=""+he.key),he)F.call(he,Ie)&&Ie!=="key"&&Ie!=="__self"&&Ie!=="__source"&&(ut[Ie]=he[Ie]);var Ne=arguments.length-2;if(Ne===1)ut.children=Ce;else if(1<Ne){for(var rt=Array(Ne),Nt=0;Nt<Ne;Nt++)rt[Nt]=arguments[Nt+2];ut.children=rt}if(K&&K.defaultProps)for(Ie in Ne=K.defaultProps,Ne)ut[Ie]===void 0&&(ut[Ie]=Ne[Ie]);return O(K,Ee,ut)},ti.createRef=function(){return{current:null}},ti.forwardRef=function(K){return{$$typeof:o,render:K}},ti.isValidElement=q,ti.lazy=function(K){return{$$typeof:d,_payload:{_status:-1,_result:K},_init:ee}},ti.memo=function(K,he){return{$$typeof:c,type:K,compare:he===void 0?null:he}},ti.startTransition=function(K){var he=L.T,Ce={};L.T=Ce;try{var Ie=K(),ut=L.S;ut!==null&&ut(Ce,Ie),typeof Ie=="object"&&Ie!==null&&typeof Ie.then=="function"&&Ie.then(U,fe)}catch(Ee){fe(Ee)}finally{he!==null&&Ce.types!==null&&(he.types=Ce.types),L.T=he}},ti.unstable_useCacheRefresh=function(){return L.H.useCacheRefresh()},ti.use=function(K){return L.H.use(K)},ti.useActionState=function(K,he,Ce){return L.H.useActionState(K,he,Ce)},ti.useCallback=function(K,he){return L.H.useCallback(K,he)},ti.useContext=function(K){return L.H.useContext(K)},ti.useDebugValue=function(){},ti.useDeferredValue=function(K,he){return L.H.useDeferredValue(K,he)},ti.useEffect=function(K,he){return L.H.useEffect(K,he)},ti.useEffectEvent=function(K){return L.H.useEffectEvent(K)},ti.useId=function(){return L.H.useId()},ti.useImperativeHandle=function(K,he,Ce){return L.H.useImperativeHandle(K,he,Ce)},ti.useInsertionEffect=function(K,he){return L.H.useInsertionEffect(K,he)},ti.useLayoutEffect=function(K,he){return L.H.useLayoutEffect(K,he)},ti.useMemo=function(K,he){return L.H.useMemo(K,he)},ti.useOptimistic=function(K,he){return L.H.useOptimistic(K,he)},ti.useReducer=function(K,he,Ce){return L.H.useReducer(K,he,Ce)},ti.useRef=function(K){return L.H.useRef(K)},ti.useState=function(K){return L.H.useState(K)},ti.useSyncExternalStore=function(K,he,Ce){return L.H.useSyncExternalStore(K,he,Ce)},ti.useTransition=function(){return L.H.useTransition()},ti.version="19.2.3",ti}var UF;function Bx(){return UF||(UF=1,N2.exports=RY()),N2.exports}var D2={exports:{}},no={};var LF;function CY(){if(LF)return no;LF=1;var r=Bx();function e(l){var c="https://react.dev/errors/"+l;if(1<arguments.length){c+="?args[]="+encodeURIComponent(arguments[1]);for(var d=2;d<arguments.length;d++)c+="&args[]="+encodeURIComponent(arguments[d])}return"Minified React error #"+l+"; visit "+c+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function t(){}var n={d:{f:t,r:function(){throw Error(e(522))},D:t,C:t,L:t,m:t,X:t,S:t,M:t},p:0,findDOMNode:null},i=Symbol.for("react.portal");function s(l,c,d){var p=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:i,key:p==null?null:""+p,children:l,containerInfo:c,implementation:d}}var a=r.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function o(l,c){if(l==="font")return"";if(typeof c=="string")return c==="use-credentials"?c:""}return no.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=n,no.createPortal=function(l,c){var d=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!c||c.nodeType!==1&&c.nodeType!==9&&c.nodeType!==11)throw Error(e(299));return s(l,c,null,d)},no.flushSync=function(l){var c=a.T,d=n.p;try{if(a.T=null,n.p=2,l)return l()}finally{a.T=c,n.p=d,n.d.f()}},no.preconnect=function(l,c){typeof l=="string"&&(c?(c=c.crossOrigin,c=typeof c=="string"?c==="use-credentials"?c:"":void 0):c=null,n.d.C(l,c))},no.prefetchDNS=function(l){typeof l=="string"&&n.d.D(l)},no.preinit=function(l,c){if(typeof l=="string"&&c&&typeof c.as=="string"){var d=c.as,p=o(d,c.crossOrigin),y=typeof c.integrity=="string"?c.integrity:void 0,_=typeof c.fetchPriority=="string"?c.fetchPriority:void 0;d==="style"?n.d.S(l,typeof c.precedence=="string"?c.precedence:void 0,{crossOrigin:p,integrity:y,fetchPriority:_}):d==="script"&&n.d.X(l,{crossOrigin:p,integrity:y,fetchPriority:_,nonce:typeof c.nonce=="string"?c.nonce:void 0})}},no.preinitModule=function(l,c){if(typeof l=="string")if(typeof c=="object"&&c!==null){if(c.as==null||c.as==="script"){var d=o(c.as,c.crossOrigin);n.d.M(l,{crossOrigin:d,integrity:typeof c.integrity=="string"?c.integrity:void 0,nonce:typeof c.nonce=="string"?c.nonce:void 0})}}else c==null&&n.d.M(l)},no.preload=function(l,c){if(typeof l=="string"&&typeof c=="object"&&c!==null&&typeof c.as=="string"){var d=c.as,p=o(d,c.crossOrigin);n.d.L(l,d,{crossOrigin:p,integrity:typeof c.integrity=="string"?c.integrity:void 0,nonce:typeof c.nonce=="string"?c.nonce:void 0,type:typeof c.type=="string"?c.type:void 0,fetchPriority:typeof c.fetchPriority=="string"?c.fetchPriority:void 0,referrerPolicy:typeof c.referrerPolicy=="string"?c.referrerPolicy:void 0,imageSrcSet:typeof c.imageSrcSet=="string"?c.imageSrcSet:void 0,imageSizes:typeof c.imageSizes=="string"?c.imageSizes:void 0,media:typeof c.media=="string"?c.media:void 0})}},no.preloadModule=function(l,c){if(typeof l=="string")if(c){var d=o(c.as,c.crossOrigin);n.d.m(l,{as:typeof c.as=="string"&&c.as!=="script"?c.as:void 0,crossOrigin:d,integrity:typeof c.integrity=="string"?c.integrity:void 0})}else n.d.m(l)},no.requestFormReset=function(l){n.d.r(l)},no.unstable_batchedUpdates=function(l,c){return l(c)},no.useFormState=function(l,c,d){return a.H.useFormState(l,c,d)},no.useFormStatus=function(){return a.H.useHostTransitionStatus()},no.version="19.2.3",no}var PF;function bk(){if(PF)return D2.exports;PF=1;function r(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(r)}catch(e){console.error(e)}}return r(),D2.exports=CY(),D2.exports}var BF;function NY(){if(BF)return wS;BF=1;var r=wY(),e=Bx(),t=bk();function n(u){var f="https://react.dev/errors/"+u;if(1<arguments.length){f+="?args[]="+encodeURIComponent(arguments[1]);for(var g=2;g<arguments.length;g++)f+="&args[]="+encodeURIComponent(arguments[g])}return"Minified React error #"+u+"; visit "+f+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function i(u){return!(!u||u.nodeType!==1&&u.nodeType!==9&&u.nodeType!==11)}function s(u){var f=u,g=u;if(u.alternate)for(;f.return;)f=f.return;else{u=f;do f=u,(f.flags&4098)!==0&&(g=f.return),u=f.return;while(u)}return f.tag===3?g:null}function a(u){if(u.tag===13){var f=u.memoizedState;if(f===null&&(u=u.alternate,u!==null&&(f=u.memoizedState)),f!==null)return f.dehydrated}return null}function o(u){if(u.tag===31){var f=u.memoizedState;if(f===null&&(u=u.alternate,u!==null&&(f=u.memoizedState)),f!==null)return f.dehydrated}return null}function l(u){if(s(u)!==u)throw Error(n(188))}function c(u){var f=u.alternate;if(!f){if(f=s(u),f===null)throw Error(n(188));return f!==u?null:u}for(var g=u,x=f;;){var A=g.return;if(A===null)break;var C=A.alternate;if(C===null){if(x=A.return,x!==null){g=x;continue}break}if(A.child===C.child){for(C=A.child;C;){if(C===g)return l(A),u;if(C===x)return l(A),f;C=C.sibling}throw Error(n(188))}if(g.return!==x.return)g=A,x=C;else{for(var G=!1,te=A.child;te;){if(te===g){G=!0,g=A,x=C;break}if(te===x){G=!0,x=A,g=C;break}te=te.sibling}if(!G){for(te=C.child;te;){if(te===g){G=!0,g=C,x=A;break}if(te===x){G=!0,x=C,g=A;break}te=te.sibling}if(!G)throw Error(n(189))}}if(g.alternate!==x)throw Error(n(190))}if(g.tag!==3)throw Error(n(188));return g.stateNode.current===g?u:f}function d(u){var f=u.tag;if(f===5||f===26||f===27||f===6)return u;for(u=u.child;u!==null;){if(f=d(u),f!==null)return f;u=u.sibling}return null}var p=Object.assign,y=Symbol.for("react.element"),_=Symbol.for("react.transitional.element"),v=Symbol.for("react.portal"),b=Symbol.for("react.fragment"),E=Symbol.for("react.strict_mode"),T=Symbol.for("react.profiler"),M=Symbol.for("react.consumer"),R=Symbol.for("react.context"),N=Symbol.for("react.forward_ref"),P=Symbol.for("react.suspense"),U=Symbol.for("react.suspense_list"),L=Symbol.for("react.memo"),F=Symbol.for("react.lazy"),O=Symbol.for("react.activity"),B=Symbol.for("react.memo_cache_sentinel"),q=Symbol.iterator;function j(u){return u===null||typeof u!="object"?null:(u=q&&u[q]||u["@@iterator"],typeof u=="function"?u:null)}var Q=Symbol.for("react.client.reference");function se(u){if(u==null)return null;if(typeof u=="function")return u.$$typeof===Q?null:u.displayName||u.name||null;if(typeof u=="string")return u;switch(u){case b:return"Fragment";case T:return"Profiler";case E:return"StrictMode";case P:return"Suspense";case U:return"SuspenseList";case O:return"Activity"}if(typeof u=="object")switch(u.$$typeof){case v:return"Portal";case R:return u.displayName||"Context";case M:return(u._context.displayName||"Context")+".Consumer";case N:var f=u.render;return u=u.displayName,u||(u=f.displayName||f.name||"",u=u!==""?"ForwardRef("+u+")":"ForwardRef"),u;case L:return f=u.displayName||null,f!==null?f:se(u.type)||"Memo";case F:f=u._payload,u=u._init;try{return se(u(f))}catch{}}return null}var ae=Array.isArray,V=e.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,X=t.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,ee={pending:!1,data:null,method:null,action:null},fe=[],Y=-1;function K(u){return{current:u}}function he(u){0>Y||(u.current=fe[Y],fe[Y]=null,Y--)}function Ce(u,f){Y++,fe[Y]=u.current,u.current=f}var Ie=K(null),ut=K(null),Ee=K(null),Ne=K(null);function rt(u,f){switch(Ce(Ee,f),Ce(ut,u),Ce(Ie,null),f.nodeType){case 9:case 11:u=(u=f.documentElement)&&(u=u.namespaceURI)?KI(u):0;break;default:if(u=f.tagName,f=f.namespaceURI)f=KI(f),u=QI(f,u);else switch(u){case"svg":u=1;break;case"math":u=2;break;default:u=0}}he(Ie),Ce(Ie,u)}function Nt(){he(Ie),he(ut),he(Ee)}function Ft(u){u.memoizedState!==null&&Ce(Ne,u);var f=Ie.current,g=QI(f,u.type);f!==g&&(Ce(ut,u),Ce(Ie,g))}function fn(u){ut.current===u&&(he(Ie),he(ut)),Ne.current===u&&(he(Ne),SS._currentValue=ee)}var Sn,At;function qe(u){if(Sn===void 0)try{throw Error()}catch(g){var f=g.stack.trim().match(/\n( *(at )?)/);Sn=f&&f[1]||"",At=-1<g.stack.indexOf(`
    at`)?" (<anonymous>)":-1<g.stack.indexOf("@")?"@unknown:0:0":""}return`
`+Sn+u+At}var at=!1;function Je(u,f){if(!u||at)return"";at=!0;var g=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var x={DetermineComponentFrameRoot:function(){try{if(f){var xt=function(){throw Error()};if(Object.defineProperty(xt.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(xt,[])}catch(Qe){var Xe=Qe}Reflect.construct(u,[],xt)}else{try{xt.call()}catch(Qe){Xe=Qe}u.call(xt.prototype)}}else{try{throw Error()}catch(Qe){Xe=Qe}(xt=u())&&typeof xt.catch=="function"&&xt.catch(function(){})}}catch(Qe){if(Qe&&Xe&&typeof Qe.stack=="string")return[Qe.stack,Xe.stack]}return[null,null]}};x.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var A=Object.getOwnPropertyDescriptor(x.DetermineComponentFrameRoot,"name");A&&A.configurable&&Object.defineProperty(x.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var C=x.DetermineComponentFrameRoot(),G=C[0],te=C[1];if(G&&te){var _e=G.split(`
`),ke=te.split(`
`);for(A=x=0;x<_e.length&&!_e[x].includes("DetermineComponentFrameRoot");)x++;for(;A<ke.length&&!ke[A].includes("DetermineComponentFrameRoot");)A++;if(x===_e.length||A===ke.length)for(x=_e.length-1,A=ke.length-1;1<=x&&0<=A&&_e[x]!==ke[A];)A--;for(;1<=x&&0<=A;x--,A--)if(_e[x]!==ke[A]){if(x!==1||A!==1)do if(x--,A--,0>A||_e[x]!==ke[A]){var ot=`
`+_e[x].replace(" at new "," at ");return u.displayName&&ot.includes("<anonymous>")&&(ot=ot.replace("<anonymous>",u.displayName)),ot}while(1<=x&&0<=A);break}}}finally{at=!1,Error.prepareStackTrace=g}return(g=u?u.displayName||u.name:"")?qe(g):""}function xe(u,f){switch(u.tag){case 26:case 27:case 5:return qe(u.type);case 16:return qe("Lazy");case 13:return u.child!==f&&f!==null?qe("Suspense Fallback"):qe("Suspense");case 19:return qe("SuspenseList");case 0:case 15:return Je(u.type,!1);case 11:return Je(u.type.render,!1);case 1:return Je(u.type,!0);case 31:return qe("Activity");default:return""}}function oe(u){try{var f="",g=null;do f+=xe(u,g),g=u,u=u.return;while(u);return f}catch(x){return`
Error generating stack: `+x.message+`
`+x.stack}}var Qt=Object.prototype.hasOwnProperty,Dt=r.unstable_scheduleCallback,zt=r.unstable_cancelCallback,wt=r.unstable_shouldYield,Z=r.unstable_requestPaint,k=r.unstable_now,pe=r.unstable_getCurrentPriorityLevel,Fe=r.unstable_ImmediatePriority,He=r.unstable_UserBlockingPriority,ze=r.unstable_NormalPriority,Bt=r.unstable_LowPriority,Ct=r.unstable_IdlePriority,Yt=r.log,$t=r.unstable_setDisableYieldValue,st=null,nt=null;function Pt(u){if(typeof Yt=="function"&&$t(u),nt&&typeof nt.setStrictMode=="function")try{nt.setStrictMode(st,u)}catch{}}var ue=Math.clz32?Math.clz32:le,Re=Math.log,dt=Math.LN2;function le(u){return u>>>=0,u===0?32:31-(Re(u)/dt|0)|0}var Be=256,lt=262144,Ot=4194304;function ht(u){var f=u&42;if(f!==0)return f;switch(u&-u){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:return u&261888;case 262144:case 524288:case 1048576:case 2097152:return u&3932160;case 4194304:case 8388608:case 16777216:case 33554432:return u&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return u}}function it(u,f,g){var x=u.pendingLanes;if(x===0)return 0;var A=0,C=u.suspendedLanes,G=u.pingedLanes;u=u.warmLanes;var te=x&134217727;return te!==0?(x=te&~C,x!==0?A=ht(x):(G&=te,G!==0?A=ht(G):g||(g=te&~u,g!==0&&(A=ht(g))))):(te=x&~C,te!==0?A=ht(te):G!==0?A=ht(G):g||(g=x&~u,g!==0&&(A=ht(g)))),A===0?0:f!==0&&f!==A&&(f&C)===0&&(C=A&-A,g=f&-f,C>=g||C===32&&(g&4194048)!==0)?f:A}function Tt(u,f){return(u.pendingLanes&~(u.suspendedLanes&~u.pingedLanes)&f)===0}function ln(u,f){switch(u){case 1:case 2:case 4:case 8:case 64:return f+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return f+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function jn(){var u=Ot;return Ot<<=1,(Ot&62914560)===0&&(Ot=4194304),u}function qt(u){for(var f=[],g=0;31>g;g++)f.push(u);return f}function nn(u,f){u.pendingLanes|=f,f!==268435456&&(u.suspendedLanes=0,u.pingedLanes=0,u.warmLanes=0)}function Bn(u,f,g,x,A,C){var G=u.pendingLanes;u.pendingLanes=g,u.suspendedLanes=0,u.pingedLanes=0,u.warmLanes=0,u.expiredLanes&=g,u.entangledLanes&=g,u.errorRecoveryDisabledLanes&=g,u.shellSuspendCounter=0;var te=u.entanglements,_e=u.expirationTimes,ke=u.hiddenUpdates;for(g=G&~g;0<g;){var ot=31-ue(g),xt=1<<ot;te[ot]=0,_e[ot]=-1;var Xe=ke[ot];if(Xe!==null)for(ke[ot]=null,ot=0;ot<Xe.length;ot++){var Qe=Xe[ot];Qe!==null&&(Qe.lane&=-536870913)}g&=~xt}x!==0&&Zt(u,x,0),C!==0&&A===0&&u.tag!==0&&(u.suspendedLanes|=C&~(G&~f))}function Zt(u,f,g){u.pendingLanes|=f,u.suspendedLanes&=~f;var x=31-ue(f);u.entangledLanes|=f,u.entanglements[x]=u.entanglements[x]|1073741824|g&261930}function Ln(u,f){var g=u.entangledLanes|=f;for(u=u.entanglements;g;){var x=31-ue(g),A=1<<x;A&f|u[x]&f&&(u[x]|=f),g&=~A}}function dn(u,f){var g=f&-f;return g=(g&42)!==0?1:wn(g),(g&(u.suspendedLanes|f))!==0?0:g}function wn(u){switch(u){case 2:u=1;break;case 8:u=4;break;case 32:u=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:u=128;break;case 268435456:u=134217728;break;default:u=0}return u}function Bi(u){return u&=-u,2<u?8<u?(u&134217727)!==0?32:268435456:8:2}function Un(){var u=X.p;return u!==0?u:(u=window.event,u===void 0?32:bF(u.type))}function Jt(u,f){var g=X.p;try{return X.p=u,f()}finally{X.p=g}}var xi=Math.random().toString(36).slice(2),pn="__reactFiber$"+xi,W="__reactProps$"+xi,J="__reactContainer$"+xi,me="__reactEvents$"+xi,De="__reactListeners$"+xi,$e="__reactHandles$"+xi,je="__reactResources$"+xi,_t="__reactMarker$"+xi;function ct(u){delete u[pn],delete u[W],delete u[me],delete u[De],delete u[$e]}function pt(u){var f=u[pn];if(f)return f;for(var g=u.parentNode;g;){if(f=g[J]||g[pn]){if(g=f.alternate,f.child!==null||g!==null&&g.child!==null)for(u=sF(u);u!==null;){if(g=u[pn])return g;u=sF(u)}return f}u=g,g=u.parentNode}return null}function gt(u){if(u=u[pn]||u[J]){var f=u.tag;if(f===5||f===6||f===13||f===31||f===26||f===27||f===3)return u}return null}function Lt(u){var f=u.tag;if(f===5||f===26||f===27||f===6)return u.stateNode;throw Error(n(33))}function bt(u){var f=u[je];return f||(f=u[je]={hoistableStyles:new Map,hoistableScripts:new Map}),f}function $(u){u[_t]=!0}var ce=new Set,Me={};function Ae(u,f){Se(u,f),Se(u+"Capture",f)}function Se(u,f){for(Me[u]=f,u=0;u<f.length;u++)ce.add(f[u])}var mt=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),Et={},Rt={};function It(u){return Qt.call(Rt,u)?!0:Qt.call(Et,u)?!1:mt.test(u)?Rt[u]=!0:(Et[u]=!0,!1)}function Vt(u,f,g){if(It(f))if(g===null)u.removeAttribute(f);else{switch(typeof g){case"undefined":case"function":case"symbol":u.removeAttribute(f);return;case"boolean":var x=f.toLowerCase().slice(0,5);if(x!=="data-"&&x!=="aria-"){u.removeAttribute(f);return}}u.setAttribute(f,""+g)}}function mn(u,f,g){if(g===null)u.removeAttribute(f);else{switch(typeof g){case"undefined":case"function":case"symbol":case"boolean":u.removeAttribute(f);return}u.setAttribute(f,""+g)}}function Gt(u,f,g,x){if(x===null)u.removeAttribute(g);else{switch(typeof x){case"undefined":case"function":case"symbol":case"boolean":u.removeAttribute(g);return}u.setAttributeNS(f,g,""+x)}}function un(u){switch(typeof u){case"bigint":case"boolean":case"number":case"string":case"undefined":return u;case"object":return u;default:return""}}function ni(u){var f=u.type;return(u=u.nodeName)&&u.toLowerCase()==="input"&&(f==="checkbox"||f==="radio")}function zi(u,f,g){var x=Object.getOwnPropertyDescriptor(u.constructor.prototype,f);if(!u.hasOwnProperty(f)&&typeof x<"u"&&typeof x.get=="function"&&typeof x.set=="function"){var A=x.get,C=x.set;return Object.defineProperty(u,f,{configurable:!0,get:function(){return A.call(this)},set:function(G){g=""+G,C.call(this,G)}}),Object.defineProperty(u,f,{enumerable:x.enumerable}),{getValue:function(){return g},setValue:function(G){g=""+G},stopTracking:function(){u._valueTracker=null,delete u[f]}}}}function si(u){if(!u._valueTracker){var f=ni(u)?"checked":"value";u._valueTracker=zi(u,f,""+u[f])}}function Mn(u){if(!u)return!1;var f=u._valueTracker;if(!f)return!0;var g=f.getValue(),x="";return u&&(x=ni(u)?u.checked?"true":"false":u.value),u=x,u!==g?(f.setValue(u),!0):!1}function en(u){if(u=u||(typeof document<"u"?document:void 0),typeof u>"u")return null;try{return u.activeElement||u.body}catch{return u.body}}var Cn=/[\n"\\]/g;function tn(u){return u.replace(Cn,function(f){return"\\"+f.charCodeAt(0).toString(16)+" "})}function Vi(u,f,g,x,A,C,G,te){u.name="",G!=null&&typeof G!="function"&&typeof G!="symbol"&&typeof G!="boolean"?u.type=G:u.removeAttribute("type"),f!=null?G==="number"?(f===0&&u.value===""||u.value!=f)&&(u.value=""+un(f)):u.value!==""+un(f)&&(u.value=""+un(f)):G!=="submit"&&G!=="reset"||u.removeAttribute("value"),f!=null?Ii(u,G,un(f)):g!=null?Ii(u,G,un(g)):x!=null&&u.removeAttribute("value"),A==null&&C!=null&&(u.defaultChecked=!!C),A!=null&&(u.checked=A&&typeof A!="function"&&typeof A!="symbol"),te!=null&&typeof te!="function"&&typeof te!="symbol"&&typeof te!="boolean"?u.name=""+un(te):u.removeAttribute("name")}function Ds(u,f,g,x,A,C,G,te){if(C!=null&&typeof C!="function"&&typeof C!="symbol"&&typeof C!="boolean"&&(u.type=C),f!=null||g!=null){if(!(C!=="submit"&&C!=="reset"||f!=null)){si(u);return}g=g!=null?""+un(g):"",f=f!=null?""+un(f):g,te||f===u.value||(u.value=f),u.defaultValue=f}x=x??A,x=typeof x!="function"&&typeof x!="symbol"&&!!x,u.checked=te?u.checked:!!x,u.defaultChecked=!!x,G!=null&&typeof G!="function"&&typeof G!="symbol"&&typeof G!="boolean"&&(u.name=G),si(u)}function Ii(u,f,g){f==="number"&&en(u.ownerDocument)===u||u.defaultValue===""+g||(u.defaultValue=""+g)}function Jr(u,f,g,x){if(u=u.options,f){f={};for(var A=0;A<g.length;A++)f["$"+g[A]]=!0;for(g=0;g<u.length;g++)A=f.hasOwnProperty("$"+u[g].value),u[g].selected!==A&&(u[g].selected=A),A&&x&&(u[g].defaultSelected=!0)}else{for(g=""+un(g),f=null,A=0;A<u.length;A++){if(u[A].value===g){u[A].selected=!0,x&&(u[A].defaultSelected=!0);return}f!==null||u[A].disabled||(f=u[A])}f!==null&&(f.selected=!0)}}function qi(u,f,g){if(f!=null&&(f=""+un(f),f!==u.value&&(u.value=f),g==null)){u.defaultValue!==f&&(u.defaultValue=f);return}u.defaultValue=g!=null?""+un(g):""}function Vr(u,f,g,x){if(f==null){if(x!=null){if(g!=null)throw Error(n(92));if(ae(x)){if(1<x.length)throw Error(n(93));x=x[0]}g=x}g==null&&(g=""),f=g}g=un(f),u.defaultValue=g,x=u.textContent,x===g&&x!==""&&x!==null&&(u.value=x),si(u)}function hs(u,f){if(f){var g=u.firstChild;if(g&&g===u.lastChild&&g.nodeType===3){g.nodeValue=f;return}}u.textContent=f}var ps=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function ms(u,f,g){var x=f.indexOf("--")===0;g==null||typeof g=="boolean"||g===""?x?u.setProperty(f,""):f==="float"?u.cssFloat="":u[f]="":x?u.setProperty(f,g):typeof g!="number"||g===0||ps.has(f)?f==="float"?u.cssFloat=g:u[f]=(""+g).trim():u[f]=g+"px"}function Ed(u,f,g){if(f!=null&&typeof f!="object")throw Error(n(62));if(u=u.style,g!=null){for(var x in g)!g.hasOwnProperty(x)||f!=null&&f.hasOwnProperty(x)||(x.indexOf("--")===0?u.setProperty(x,""):x==="float"?u.cssFloat="":u[x]="");for(var A in f)x=f[A],f.hasOwnProperty(A)&&g[A]!==x&&ms(u,A,x)}else for(var C in f)f.hasOwnProperty(C)&&ms(u,C,f[C])}function To(u){if(u.indexOf("-")===-1)return!1;switch(u){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var xE=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),bE=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function $m(u){return bE.test(""+u)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":u}function Tu(){}var jm=null;function zy(u){return u=u.target||u.srcElement||window,u.correspondingUseElement&&(u=u.correspondingUseElement),u.nodeType===3?u.parentNode:u}var Md=null,lf=null;function ib(u){var f=gt(u);if(f&&(u=f.stateNode)){var g=u[W]||null;e:switch(u=f.stateNode,f.type){case"input":if(Vi(u,g.value,g.defaultValue,g.defaultValue,g.checked,g.defaultChecked,g.type,g.name),f=g.name,g.type==="radio"&&f!=null){for(g=u;g.parentNode;)g=g.parentNode;for(g=g.querySelectorAll('input[name="'+tn(""+f)+'"][type="radio"]'),f=0;f<g.length;f++){var x=g[f];if(x!==u&&x.form===u.form){var A=x[W]||null;if(!A)throw Error(n(90));Vi(x,A.value,A.defaultValue,A.defaultValue,A.checked,A.defaultChecked,A.type,A.name)}}for(f=0;f<g.length;f++)x=g[f],x.form===u.form&&Mn(x)}break e;case"textarea":qi(u,g.value,g.defaultValue);break e;case"select":f=g.value,f!=null&&Jr(u,!!g.multiple,f,!1)}}}var Vy=!1;function rb(u,f,g){if(Vy)return u(f,g);Vy=!0;try{var x=u(f);return x}finally{if(Vy=!1,(Md!==null||lf!==null)&&(ie(),Md&&(f=Md,u=lf,lf=Md=null,ib(f),u)))for(f=0;f<u.length;f++)ib(u[f])}}function Ad(u,f){var g=u.stateNode;if(g===null)return null;var x=g[W]||null;if(x===null)return null;g=x[f];e:switch(f){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(x=!x.disabled)||(u=u.type,x=!(u==="button"||u==="input"||u==="select"||u==="textarea")),u=!x;break e;default:u=!1}if(u)return null;if(g&&typeof g!="function")throw Error(n(231,f,typeof g));return g}var Eu=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Gy=!1;if(Eu)try{var Ym={};Object.defineProperty(Ym,"passive",{get:function(){Gy=!0}}),window.addEventListener("test",Ym,Ym),window.removeEventListener("test",Ym,Ym)}catch{Gy=!1}var uf=null,ky=null,cf=null;function Hy(){if(cf)return cf;var u,f=ky,g=f.length,x,A="value"in uf?uf.value:uf.textContent,C=A.length;for(u=0;u<g&&f[u]===A[u];u++);var G=g-u;for(x=1;x<=G&&f[g-x]===A[C-x];x++);return cf=A.slice(u,1<x?1-x:void 0)}function wd(u){var f=u.keyCode;return"charCode"in u?(u=u.charCode,u===0&&f===13&&(u=13)):u=f,u===10&&(u=13),32<=u||u===13?u:0}function Zm(){return!0}function sb(){return!1}function sa(u){function f(g,x,A,C,G){this._reactName=g,this._targetInst=A,this.type=x,this.nativeEvent=C,this.target=G,this.currentTarget=null;for(var te in u)u.hasOwnProperty(te)&&(g=u[te],this[te]=g?g(C):C[te]);return this.isDefaultPrevented=(C.defaultPrevented!=null?C.defaultPrevented:C.returnValue===!1)?Zm:sb,this.isPropagationStopped=sb,this}return p(f.prototype,{preventDefault:function(){this.defaultPrevented=!0;var g=this.nativeEvent;g&&(g.preventDefault?g.preventDefault():typeof g.returnValue!="unknown"&&(g.returnValue=!1),this.isDefaultPrevented=Zm)},stopPropagation:function(){var g=this.nativeEvent;g&&(g.stopPropagation?g.stopPropagation():typeof g.cancelBubble!="unknown"&&(g.cancelBubble=!0),this.isPropagationStopped=Zm)},persist:function(){},isPersistent:Zm}),f}var ff={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(u){return u.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Km=sa(ff),kl=p({},ff,{view:0,detail:0}),Wy=sa(kl),qy,Qm,Qh,Jm=p({},kl,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:tg,button:0,buttons:0,relatedTarget:function(u){return u.relatedTarget===void 0?u.fromElement===u.srcElement?u.toElement:u.fromElement:u.relatedTarget},movementX:function(u){return"movementX"in u?u.movementX:(u!==Qh&&(Qh&&u.type==="mousemove"?(qy=u.screenX-Qh.screenX,Qm=u.screenY-Qh.screenY):Qm=qy=0,Qh=u),qy)},movementY:function(u){return"movementY"in u?u.movementY:Qm}}),SE=sa(Jm),qs=p({},Jm,{dataTransfer:0}),TE=sa(qs),EE=p({},kl,{relatedTarget:0}),Xy=sa(EE),ME=p({},ff,{animationName:0,elapsedTime:0,pseudoElement:0}),AE=sa(ME),eg=p({},ff,{clipboardData:function(u){return"clipboardData"in u?u.clipboardData:window.clipboardData}}),ab=sa(eg),wE=p({},ff,{data:0}),ob=sa(wE),RE={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},lb={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},ub={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function CE(u){var f=this.nativeEvent;return f.getModifierState?f.getModifierState(u):(u=ub[u])?!!f[u]:!1}function tg(){return CE}var cb=p({},kl,{key:function(u){if(u.key){var f=RE[u.key]||u.key;if(f!=="Unidentified")return f}return u.type==="keypress"?(u=wd(u),u===13?"Enter":String.fromCharCode(u)):u.type==="keydown"||u.type==="keyup"?lb[u.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:tg,charCode:function(u){return u.type==="keypress"?wd(u):0},keyCode:function(u){return u.type==="keydown"||u.type==="keyup"?u.keyCode:0},which:function(u){return u.type==="keypress"?wd(u):u.type==="keydown"||u.type==="keyup"?u.keyCode:0}}),fb=sa(cb),NE=p({},Jm,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),$y=sa(NE),DE=p({},kl,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:tg}),mc=sa(DE),db=p({},ff,{propertyName:0,elapsedTime:0,pseudoElement:0}),qN=sa(db),OE=p({},Jm,{deltaX:function(u){return"deltaX"in u?u.deltaX:"wheelDeltaX"in u?-u.wheelDeltaX:0},deltaY:function(u){return"deltaY"in u?u.deltaY:"wheelDeltaY"in u?-u.wheelDeltaY:"wheelDelta"in u?-u.wheelDelta:0},deltaZ:0,deltaMode:0}),df=sa(OE),gc=p({},ff,{newState:0,oldState:0}),hb=sa(gc),pb=[9,13,27,32],Rd=Eu&&"CompositionEvent"in window,hf=null;Eu&&"documentMode"in document&&(hf=document.documentMode);var Cd=Eu&&"TextEvent"in window&&!hf,Xs=Eu&&(!Rd||hf&&8<hf&&11>=hf),ng=" ",mb=!1;function jy(u,f){switch(u){case"keyup":return pb.indexOf(f.keyCode)!==-1;case"keydown":return f.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Jh(u){return u=u.detail,typeof u=="object"&&"data"in u?u.data:null}var pf=!1;function Yy(u,f){switch(u){case"compositionend":return Jh(f);case"keypress":return f.which!==32?null:(mb=!0,ng);case"textInput":return u=f.data,u===ng&&mb?null:u;default:return null}}function UE(u,f){if(pf)return u==="compositionend"||!Rd&&jy(u,f)?(u=Hy(),cf=ky=uf=null,pf=!1,u):null;switch(u){case"paste":return null;case"keypress":if(!(f.ctrlKey||f.altKey||f.metaKey)||f.ctrlKey&&f.altKey){if(f.char&&1<f.char.length)return f.char;if(f.which)return String.fromCharCode(f.which)}return null;case"compositionend":return Xs&&f.locale!=="ko"?null:f.data;default:return null}}var Eo={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function gb(u){var f=u&&u.nodeName&&u.nodeName.toLowerCase();return f==="input"?!!Eo[u.type]:f==="textarea"}function Zy(u,f,g,x){Md?lf?lf.push(x):lf=[x]:Md=x,f=EM(f,"onChange"),0<f.length&&(g=new Km("onChange","change",null,g,x),u.push({event:g,listeners:f}))}var ep=null,tp=null;function yb(u){qI(u,0)}function np(u){var f=Lt(u);if(Mn(f))return u}function _b(u,f){if(u==="change")return f}var ig=!1;if(Eu){var Nd;if(Eu){var Er="oninput"in document;if(!Er){var LE=document.createElement("div");LE.setAttribute("oninput","return;"),Er=typeof LE.oninput=="function"}Nd=Er}else Nd=!1;ig=Nd&&(!document.documentMode||9<document.documentMode)}function PE(){ep&&(ep.detachEvent("onpropertychange",vb),tp=ep=null)}function vb(u){if(u.propertyName==="value"&&np(tp)){var f=[];Zy(f,tp,u,zy(u)),rb(yb,f)}}function rg(u,f,g){u==="focusin"?(PE(),ep=f,tp=g,ep.attachEvent("onpropertychange",vb)):u==="focusout"&&PE()}function mf(u){if(u==="selectionchange"||u==="keyup"||u==="keydown")return np(tp)}function BE(u,f){if(u==="click")return np(f)}function IE(u,f){if(u==="input"||u==="change")return np(f)}function Dd(u,f){return u===f&&(u!==0||1/u===1/f)||u!==u&&f!==f}var Mr=typeof Object.is=="function"?Object.is:Dd;function ip(u,f){if(Mr(u,f))return!0;if(typeof u!="object"||u===null||typeof f!="object"||f===null)return!1;var g=Object.keys(u),x=Object.keys(f);if(g.length!==x.length)return!1;for(x=0;x<g.length;x++){var A=g[x];if(!Qt.call(f,A)||!Mr(u[A],f[A]))return!1}return!0}function xb(u){for(;u&&u.firstChild;)u=u.firstChild;return u}function bb(u,f){var g=xb(u);u=0;for(var x;g;){if(g.nodeType===3){if(x=u+g.textContent.length,u<=f&&x>=f)return{node:g,offset:f-u};u=x}e:{for(;g;){if(g.nextSibling){g=g.nextSibling;break e}g=g.parentNode}g=void 0}g=xb(g)}}function Ky(u,f){return u&&f?u===f?!0:u&&u.nodeType===3?!1:f&&f.nodeType===3?Ky(u,f.parentNode):"contains"in u?u.contains(f):u.compareDocumentPosition?!!(u.compareDocumentPosition(f)&16):!1:!1}function Qy(u){u=u!=null&&u.ownerDocument!=null&&u.ownerDocument.defaultView!=null?u.ownerDocument.defaultView:window;for(var f=en(u.document);f instanceof u.HTMLIFrameElement;){try{var g=typeof f.contentWindow.location.href=="string"}catch{g=!1}if(g)u=f.contentWindow;else break;f=en(u.document)}return f}function rp(u){var f=u&&u.nodeName&&u.nodeName.toLowerCase();return f&&(f==="input"&&(u.type==="text"||u.type==="search"||u.type==="tel"||u.type==="url"||u.type==="password")||f==="textarea"||u.contentEditable==="true")}var FE=Eu&&"documentMode"in document&&11>=document.documentMode,sp=null,Jy=null,ap=null,Mo=!1;function e_(u,f,g){var x=g.window===g?g.document:g.nodeType===9?g:g.ownerDocument;Mo||sp==null||sp!==en(x)||(x=sp,"selectionStart"in x&&rp(x)?x={start:x.selectionStart,end:x.selectionEnd}:(x=(x.ownerDocument&&x.ownerDocument.defaultView||window).getSelection(),x={anchorNode:x.anchorNode,anchorOffset:x.anchorOffset,focusNode:x.focusNode,focusOffset:x.focusOffset}),ap&&ip(ap,x)||(ap=x,x=EM(Jy,"onSelect"),0<x.length&&(f=new Km("onSelect","select",null,f,g),u.push({event:f,listeners:x}),f.target=sp)))}function gf(u,f){var g={};return g[u.toLowerCase()]=f.toLowerCase(),g["Webkit"+u]="webkit"+f,g["Moz"+u]="moz"+f,g}var op={animationend:gf("Animation","AnimationEnd"),animationiteration:gf("Animation","AnimationIteration"),animationstart:gf("Animation","AnimationStart"),transitionrun:gf("Transition","TransitionRun"),transitionstart:gf("Transition","TransitionStart"),transitioncancel:gf("Transition","TransitionCancel"),transitionend:gf("Transition","TransitionEnd")},sg={},Ma={};Eu&&(Ma=document.createElement("div").style,"AnimationEvent"in window||(delete op.animationend.animation,delete op.animationiteration.animation,delete op.animationstart.animation),"TransitionEvent"in window||delete op.transitionend.transition);function yf(u){if(sg[u])return sg[u];if(!op[u])return u;var f=op[u],g;for(g in f)if(f.hasOwnProperty(g)&&g in Ma)return sg[u]=f[g];return u}var qa=yf("animationend"),Sb=yf("animationiteration"),Mu=yf("animationstart"),lp=yf("transitionrun"),_f=yf("transitionstart"),Tb=yf("transitioncancel"),t_=yf("transitionend"),yc=new Map,n_="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");n_.push("scrollEnd");function aa(u,f){yc.set(u,f),Ae(f,[u])}var vf=typeof reportError=="function"?reportError:function(u){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var f=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof u=="object"&&u!==null&&typeof u.message=="string"?String(u.message):String(u),error:u});if(!window.dispatchEvent(f))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",u);return}console.error(u)},Os=[],Od=0,i_=0;function xf(){for(var u=Od,f=i_=Od=0;f<u;){var g=Os[f];Os[f++]=null;var x=Os[f];Os[f++]=null;var A=Os[f];Os[f++]=null;var C=Os[f];if(Os[f++]=null,x!==null&&A!==null){var G=x.pending;G===null?A.next=A:(A.next=G.next,G.next=A),x.pending=A}C!==0&&r_(g,A,C)}}function ag(u,f,g,x){Os[Od++]=u,Os[Od++]=f,Os[Od++]=g,Os[Od++]=x,i_|=x,u.lanes|=x,u=u.alternate,u!==null&&(u.lanes|=x)}function up(u,f,g,x){return ag(u,f,g,x),cp(u)}function bf(u,f){return ag(u,null,null,f),cp(u)}function r_(u,f,g){u.lanes|=g;var x=u.alternate;x!==null&&(x.lanes|=g);for(var A=!1,C=u.return;C!==null;)C.childLanes|=g,x=C.alternate,x!==null&&(x.childLanes|=g),C.tag===22&&(u=C.stateNode,u===null||u._visibility&1||(A=!0)),u=C,C=C.return;return u.tag===3?(C=u.stateNode,A&&f!==null&&(A=31-ue(g),u=C.hiddenUpdates,x=u[A],x===null?u[A]=[f]:x.push(f),f.lane=g|536870912),C):null}function cp(u){if(50<Yd)throw Yd=0,Zd=null,Error(n(185));for(var f=u.return;f!==null;)u=f,f=u.return;return u.tag===3?u.stateNode:null}var Sf={};function zE(u,f,g,x){this.tag=u,this.key=g,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=f,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=x,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Aa(u,f,g,x){return new zE(u,f,g,x)}function wa(u){return u=u.prototype,!(!u||!u.isReactComponent)}function Au(u,f){var g=u.alternate;return g===null?(g=Aa(u.tag,f,u.key,u.mode),g.elementType=u.elementType,g.type=u.type,g.stateNode=u.stateNode,g.alternate=u,u.alternate=g):(g.pendingProps=f,g.type=u.type,g.flags=0,g.subtreeFlags=0,g.deletions=null),g.flags=u.flags&65011712,g.childLanes=u.childLanes,g.lanes=u.lanes,g.child=u.child,g.memoizedProps=u.memoizedProps,g.memoizedState=u.memoizedState,g.updateQueue=u.updateQueue,f=u.dependencies,g.dependencies=f===null?null:{lanes:f.lanes,firstContext:f.firstContext},g.sibling=u.sibling,g.index=u.index,g.ref=u.ref,g.refCleanup=u.refCleanup,g}function oa(u,f){u.flags&=65011714;var g=u.alternate;return g===null?(u.childLanes=0,u.lanes=f,u.child=null,u.subtreeFlags=0,u.memoizedProps=null,u.memoizedState=null,u.updateQueue=null,u.dependencies=null,u.stateNode=null):(u.childLanes=g.childLanes,u.lanes=g.lanes,u.child=g.child,u.subtreeFlags=0,u.deletions=null,u.memoizedProps=g.memoizedProps,u.memoizedState=g.memoizedState,u.updateQueue=g.updateQueue,u.type=g.type,f=g.dependencies,u.dependencies=f===null?null:{lanes:f.lanes,firstContext:f.firstContext}),u}function og(u,f,g,x,A,C){var G=0;if(x=u,typeof u=="function")wa(u)&&(G=1);else if(typeof u=="string")G=fY(u,g,Ie.current)?26:u==="html"||u==="head"||u==="body"?27:5;else e:switch(u){case O:return u=Aa(31,g,f,A),u.elementType=O,u.lanes=C,u;case b:return _c(g.children,A,C,f);case E:G=8,A|=24;break;case T:return u=Aa(12,g,f,A|2),u.elementType=T,u.lanes=C,u;case P:return u=Aa(13,g,f,A),u.elementType=P,u.lanes=C,u;case U:return u=Aa(19,g,f,A),u.elementType=U,u.lanes=C,u;default:if(typeof u=="object"&&u!==null)switch(u.$$typeof){case R:G=10;break e;case M:G=9;break e;case N:G=11;break e;case L:G=14;break e;case F:G=16,x=null;break e}G=29,g=Error(n(130,u===null?"null":typeof u,"")),x=null}return f=Aa(G,g,f,A),f.elementType=u,f.type=x,f.lanes=C,f}function _c(u,f,g,x){return u=Aa(7,u,x,f),u.lanes=g,u}function s_(u,f,g){return u=Aa(6,u,null,f),u.lanes=g,u}function VE(u){var f=Aa(18,null,null,0);return f.stateNode=u,f}function Hl(u,f,g){return f=Aa(4,u.children!==null?u.children:[],u.key,f),f.lanes=g,f.stateNode={containerInfo:u.containerInfo,pendingChildren:null,implementation:u.implementation},f}var Eb=new WeakMap;function Xa(u,f){if(typeof u=="object"&&u!==null){var g=Eb.get(u);return g!==void 0?g:(f={value:u,source:f,stack:oe(f)},Eb.set(u,f),f)}return{value:u,source:f,stack:oe(f)}}var Wl=[],Ud=0,lg=null,fp=0,Ao=[],$a=0,wu=null,Ru=1,Cu="";function vc(u,f){Wl[Ud++]=fp,Wl[Ud++]=lg,lg=u,fp=f}function Mb(u,f,g){Ao[$a++]=Ru,Ao[$a++]=Cu,Ao[$a++]=wu,wu=u;var x=Ru;u=Cu;var A=32-ue(x)-1;x&=~(1<<A),g+=1;var C=32-ue(f)+A;if(30<C){var G=A-A%5;C=(x&(1<<G)-1).toString(32),x>>=G,A-=G,Ru=1<<32-ue(f)+A|g<<A|x,Cu=C+u}else Ru=1<<C|g<<A|x,Cu=u}function a_(u){u.return!==null&&(vc(u,1),Mb(u,1,0))}function Tf(u){for(;u===lg;)lg=Wl[--Ud],Wl[Ud]=null,fp=Wl[--Ud],Wl[Ud]=null;for(;u===wu;)wu=Ao[--$a],Ao[$a]=null,Cu=Ao[--$a],Ao[$a]=null,Ru=Ao[--$a],Ao[$a]=null}function ug(u,f){Ao[$a++]=Ru,Ao[$a++]=Cu,Ao[$a++]=wu,Ru=f.id,Cu=f.overflow,wu=u}var Us=null,yr=null,bi=!1,xc=null,Ls=!1,o_=Error(n(519));function di(u){var f=Error(n(418,1<arguments.length&&arguments[1]!==void 0&&arguments[1]?"text":"HTML",""));throw cg(Xa(f,u)),o_}function l_(u){var f=u.stateNode,g=u.type,x=u.memoizedProps;switch(f[pn]=u,f[W]=x,g){case"dialog":Si("cancel",f),Si("close",f);break;case"iframe":case"object":case"embed":Si("load",f);break;case"video":case"audio":for(g=0;g<yS.length;g++)Si(yS[g],f);break;case"source":Si("error",f);break;case"img":case"image":case"link":Si("error",f),Si("load",f);break;case"details":Si("toggle",f);break;case"input":Si("invalid",f),Ds(f,x.value,x.defaultValue,x.checked,x.defaultChecked,x.type,x.name,!0);break;case"select":Si("invalid",f);break;case"textarea":Si("invalid",f),Vr(f,x.value,x.defaultValue,x.children)}g=x.children,typeof g!="string"&&typeof g!="number"&&typeof g!="bigint"||f.textContent===""+g||x.suppressHydrationWarning===!0||YI(f.textContent,g)?(x.popover!=null&&(Si("beforetoggle",f),Si("toggle",f)),x.onScroll!=null&&Si("scroll",f),x.onScrollEnd!=null&&Si("scrollend",f),x.onClick!=null&&(f.onclick=Tu),f=!0):f=!1,f||di(u,!0)}function GE(u){for(Us=u.return;Us;)switch(Us.tag){case 5:case 31:case 13:Ls=!1;return;case 27:case 3:Ls=!0;return;default:Us=Us.return}}function Ld(u){if(u!==Us)return!1;if(!bi)return GE(u),bi=!0,!1;var f=u.tag,g;if((g=f!==3&&f!==27)&&((g=f===5)&&(g=u.type,g=!(g!=="form"&&g!=="button")||f2(u.type,u.memoizedProps)),g=!g),g&&yr&&di(u),GE(u),f===13){if(u=u.memoizedState,u=u!==null?u.dehydrated:null,!u)throw Error(n(317));yr=rF(u)}else if(f===31){if(u=u.memoizedState,u=u!==null?u.dehydrated:null,!u)throw Error(n(317));yr=rF(u)}else f===27?(f=yr,Np(u.type)?(u=g2,g2=null,yr=u):yr=f):yr=Us?Vu(u.stateNode.nextSibling):null;return!0}function Pd(){yr=Us=null,bi=!1}function Ab(){var u=xc;return u!==null&&(ha===null?ha=u:ha.push.apply(ha,u),xc=null),u}function cg(u){xc===null?xc=[u]:xc.push(u)}var wb=K(null),bc=null,la=null;function Sc(u,f,g){Ce(wb,f._currentValue),f._currentValue=g}function fl(u){u._currentValue=wb.current,he(wb)}function Tc(u,f,g){for(;u!==null;){var x=u.alternate;if((u.childLanes&f)!==f?(u.childLanes|=f,x!==null&&(x.childLanes|=f)):x!==null&&(x.childLanes&f)!==f&&(x.childLanes|=f),u===g)break;u=u.return}}function u_(u,f,g,x){var A=u.child;for(A!==null&&(A.return=u);A!==null;){var C=A.dependencies;if(C!==null){var G=A.child;C=C.firstContext;e:for(;C!==null;){var te=C;C=A;for(var _e=0;_e<f.length;_e++)if(te.context===f[_e]){C.lanes|=g,te=C.alternate,te!==null&&(te.lanes|=g),Tc(C.return,g,u),x||(G=null);break e}C=te.next}}else if(A.tag===18){if(G=A.return,G===null)throw Error(n(341));G.lanes|=g,C=G.alternate,C!==null&&(C.lanes|=g),Tc(G,g,u),G=null}else G=A.child;if(G!==null)G.return=A;else for(G=A;G!==null;){if(G===u){G=null;break}if(A=G.sibling,A!==null){A.return=G.return,G=A;break}G=G.return}A=G}}function Ef(u,f,g,x){u=null;for(var A=f,C=!1;A!==null;){if(!C){if((A.flags&524288)!==0)C=!0;else if((A.flags&262144)!==0)break}if(A.tag===10){var G=A.alternate;if(G===null)throw Error(n(387));if(G=G.memoizedProps,G!==null){var te=A.type;Mr(A.pendingProps.value,G.value)||(u!==null?u.push(te):u=[te])}}else if(A===Ne.current){if(G=A.alternate,G===null)throw Error(n(387));G.memoizedState.memoizedState!==A.memoizedState.memoizedState&&(u!==null?u.push(SS):u=[SS])}A=A.return}u!==null&&u_(f,u,g,x),f.flags|=262144}function dp(u){for(u=u.firstContext;u!==null;){if(!Mr(u.context._currentValue,u.memoizedValue))return!0;u=u.next}return!1}function Bd(u){bc=u,la=null,u=u.dependencies,u!==null&&(u.firstContext=null)}function Ps(u){return Rb(bc,u)}function fg(u,f){return bc===null&&Bd(u),Rb(u,f)}function Rb(u,f){var g=f._currentValue;if(f={context:f,memoizedValue:g,next:null},la===null){if(u===null)throw Error(n(308));la=f,u.dependencies={lanes:0,firstContext:f},u.flags|=524288}else la=la.next=f;return g}var kE=typeof AbortController<"u"?AbortController:function(){var u=[],f=this.signal={aborted:!1,addEventListener:function(g,x){u.push(x)}};this.abort=function(){f.aborted=!0,u.forEach(function(g){return g()})}},HE=r.unstable_scheduleCallback,Cb=r.unstable_NormalPriority,Dn={$$typeof:R,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function Nb(){return{controller:new kE,data:new Map,refCount:0}}function $s(u){u.refCount--,u.refCount===0&&HE(Cb,function(){u.controller.abort()})}var Id=null,Db=0,Ec=0,ql=null;function hp(u,f){if(Id===null){var g=Id=[];Db=0,Ec=n2(),ql={status:"pending",value:void 0,then:function(x){g.push(x)}}}return Db++,f.then(Ob,Ob),f}function Ob(){if(--Db===0&&Id!==null){ql!==null&&(ql.status="fulfilled");var u=Id;Id=null,Ec=0,ql=null;for(var f=0;f<u.length;f++)(0,u[f])()}}function Ub(u,f){var g=[],x={status:"pending",value:null,reason:null,then:function(A){g.push(A)}};return u.then(function(){x.status="fulfilled",x.value=f;for(var A=0;A<g.length;A++)(0,g[A])(f)},function(A){for(x.status="rejected",x.reason=A,A=0;A<g.length;A++)(0,g[A])(void 0)}),x}var WE=V.S;V.S=function(u,f){wp=k(),typeof f=="object"&&f!==null&&typeof f.then=="function"&&hp(u,f),WE!==null&&WE(u,f)};var Mf=K(null);function Nu(){var u=Mf.current;return u!==null?u:$i.pooledCache}function pp(u,f){f===null?Ce(Mf,Mf.current):Ce(Mf,f.pool)}function c_(){var u=Nu();return u===null?null:{parent:Dn._currentValue,pool:u}}var Af=Error(n(460)),dg=Error(n(474)),Xl=Error(n(542)),hg={then:function(){}};function qE(u){return u=u.status,u==="fulfilled"||u==="rejected"}function Lb(u,f,g){switch(g=u[g],g===void 0?u.push(f):g!==f&&(f.then(Tu,Tu),f=g),f.status){case"fulfilled":return f.value;case"rejected":throw u=f.reason,Pb(u),u;default:if(typeof f.status=="string")f.then(Tu,Tu);else{if(u=$i,u!==null&&100<u.shellSuspendCounter)throw Error(n(482));u=f,u.status="pending",u.then(function(x){if(f.status==="pending"){var A=f;A.status="fulfilled",A.value=x}},function(x){if(f.status==="pending"){var A=f;A.status="rejected",A.reason=x}})}switch(f.status){case"fulfilled":return f.value;case"rejected":throw u=f.reason,Pb(u),u}throw In=f,Af}}function Fd(u){try{var f=u._init;return f(u._payload)}catch(g){throw g!==null&&typeof g=="object"&&typeof g.then=="function"?(In=g,Af):g}}var In=null;function f_(){if(In===null)throw Error(n(459));var u=In;return In=null,u}function Pb(u){if(u===Af||u===Xl)throw Error(n(483))}var wf=null,Rf=0;function d_(u){var f=Rf;return Rf+=1,wf===null&&(wf=[]),Lb(wf,u,f)}function pg(u,f){f=f.props.ref,u.ref=f!==void 0?f:null}function mg(u,f){throw f.$$typeof===y?Error(n(525)):(u=Object.prototype.toString.call(f),Error(n(31,u==="[object Object]"?"object with keys {"+Object.keys(f).join(", ")+"}":u)))}function mp(u){function f(Ue,we){if(u){var Ge=Ue.deletions;Ge===null?(Ue.deletions=[we],Ue.flags|=16):Ge.push(we)}}function g(Ue,we){if(!u)return null;for(;we!==null;)f(Ue,we),we=we.sibling;return null}function x(Ue){for(var we=new Map;Ue!==null;)Ue.key!==null?we.set(Ue.key,Ue):we.set(Ue.index,Ue),Ue=Ue.sibling;return we}function A(Ue,we){return Ue=Au(Ue,we),Ue.index=0,Ue.sibling=null,Ue}function C(Ue,we,Ge){return Ue.index=Ge,u?(Ge=Ue.alternate,Ge!==null?(Ge=Ge.index,Ge<we?(Ue.flags|=67108866,we):Ge):(Ue.flags|=67108866,we)):(Ue.flags|=1048576,we)}function G(Ue){return u&&Ue.alternate===null&&(Ue.flags|=67108866),Ue}function te(Ue,we,Ge,yt){return we===null||we.tag!==6?(we=s_(Ge,Ue.mode,yt),we.return=Ue,we):(we=A(we,Ge),we.return=Ue,we)}function _e(Ue,we,Ge,yt){var Pn=Ge.type;return Pn===b?ot(Ue,we,Ge.props.children,yt,Ge.key):we!==null&&(we.elementType===Pn||typeof Pn=="object"&&Pn!==null&&Pn.$$typeof===F&&Fd(Pn)===we.type)?(we=A(we,Ge.props),pg(we,Ge),we.return=Ue,we):(we=og(Ge.type,Ge.key,Ge.props,null,Ue.mode,yt),pg(we,Ge),we.return=Ue,we)}function ke(Ue,we,Ge,yt){return we===null||we.tag!==4||we.stateNode.containerInfo!==Ge.containerInfo||we.stateNode.implementation!==Ge.implementation?(we=Hl(Ge,Ue.mode,yt),we.return=Ue,we):(we=A(we,Ge.children||[]),we.return=Ue,we)}function ot(Ue,we,Ge,yt,Pn){return we===null||we.tag!==7?(we=_c(Ge,Ue.mode,yt,Pn),we.return=Ue,we):(we=A(we,Ge),we.return=Ue,we)}function xt(Ue,we,Ge){if(typeof we=="string"&&we!==""||typeof we=="number"||typeof we=="bigint")return we=s_(""+we,Ue.mode,Ge),we.return=Ue,we;if(typeof we=="object"&&we!==null){switch(we.$$typeof){case _:return Ge=og(we.type,we.key,we.props,null,Ue.mode,Ge),pg(Ge,we),Ge.return=Ue,Ge;case v:return we=Hl(we,Ue.mode,Ge),we.return=Ue,we;case F:return we=Fd(we),xt(Ue,we,Ge)}if(ae(we)||j(we))return we=_c(we,Ue.mode,Ge,null),we.return=Ue,we;if(typeof we.then=="function")return xt(Ue,d_(we),Ge);if(we.$$typeof===R)return xt(Ue,fg(Ue,we),Ge);mg(Ue,we)}return null}function Xe(Ue,we,Ge,yt){var Pn=we!==null?we.key:null;if(typeof Ge=="string"&&Ge!==""||typeof Ge=="number"||typeof Ge=="bigint")return Pn!==null?null:te(Ue,we,""+Ge,yt);if(typeof Ge=="object"&&Ge!==null){switch(Ge.$$typeof){case _:return Ge.key===Pn?_e(Ue,we,Ge,yt):null;case v:return Ge.key===Pn?ke(Ue,we,Ge,yt):null;case F:return Ge=Fd(Ge),Xe(Ue,we,Ge,yt)}if(ae(Ge)||j(Ge))return Pn!==null?null:ot(Ue,we,Ge,yt,null);if(typeof Ge.then=="function")return Xe(Ue,we,d_(Ge),yt);if(Ge.$$typeof===R)return Xe(Ue,we,fg(Ue,Ge),yt);mg(Ue,Ge)}return null}function Qe(Ue,we,Ge,yt,Pn){if(typeof yt=="string"&&yt!==""||typeof yt=="number"||typeof yt=="bigint")return Ue=Ue.get(Ge)||null,te(we,Ue,""+yt,Pn);if(typeof yt=="object"&&yt!==null){switch(yt.$$typeof){case _:return Ue=Ue.get(yt.key===null?Ge:yt.key)||null,_e(we,Ue,yt,Pn);case v:return Ue=Ue.get(yt.key===null?Ge:yt.key)||null,ke(we,Ue,yt,Pn);case F:return yt=Fd(yt),Qe(Ue,we,Ge,yt,Pn)}if(ae(yt)||j(yt))return Ue=Ue.get(Ge)||null,ot(we,Ue,yt,Pn,null);if(typeof yt.then=="function")return Qe(Ue,we,Ge,d_(yt),Pn);if(yt.$$typeof===R)return Qe(Ue,we,Ge,fg(we,yt),Pn);mg(we,yt)}return null}function vn(Ue,we,Ge,yt){for(var Pn=null,Yi=null,An=we,li=we=0,wi=null;An!==null&&li<Ge.length;li++){An.index>li?(wi=An,An=null):wi=An.sibling;var Zi=Xe(Ue,An,Ge[li],yt);if(Zi===null){An===null&&(An=wi);break}u&&An&&Zi.alternate===null&&f(Ue,An),we=C(Zi,we,li),Yi===null?Pn=Zi:Yi.sibling=Zi,Yi=Zi,An=wi}if(li===Ge.length)return g(Ue,An),bi&&vc(Ue,li),Pn;if(An===null){for(;li<Ge.length;li++)An=xt(Ue,Ge[li],yt),An!==null&&(we=C(An,we,li),Yi===null?Pn=An:Yi.sibling=An,Yi=An);return bi&&vc(Ue,li),Pn}for(An=x(An);li<Ge.length;li++)wi=Qe(An,Ue,li,Ge[li],yt),wi!==null&&(u&&wi.alternate!==null&&An.delete(wi.key===null?li:wi.key),we=C(wi,we,li),Yi===null?Pn=wi:Yi.sibling=wi,Yi=wi);return u&&An.forEach(function(Pp){return f(Ue,Pp)}),bi&&vc(Ue,li),Pn}function Hn(Ue,we,Ge,yt){if(Ge==null)throw Error(n(151));for(var Pn=null,Yi=null,An=we,li=we=0,wi=null,Zi=Ge.next();An!==null&&!Zi.done;li++,Zi=Ge.next()){An.index>li?(wi=An,An=null):wi=An.sibling;var Pp=Xe(Ue,An,Zi.value,yt);if(Pp===null){An===null&&(An=wi);break}u&&An&&Pp.alternate===null&&f(Ue,An),we=C(Pp,we,li),Yi===null?Pn=Pp:Yi.sibling=Pp,Yi=Pp,An=wi}if(Zi.done)return g(Ue,An),bi&&vc(Ue,li),Pn;if(An===null){for(;!Zi.done;li++,Zi=Ge.next())Zi=xt(Ue,Zi.value,yt),Zi!==null&&(we=C(Zi,we,li),Yi===null?Pn=Zi:Yi.sibling=Zi,Yi=Zi);return bi&&vc(Ue,li),Pn}for(An=x(An);!Zi.done;li++,Zi=Ge.next())Zi=Qe(An,Ue,li,Zi.value,yt),Zi!==null&&(u&&Zi.alternate!==null&&An.delete(Zi.key===null?li:Zi.key),we=C(Zi,we,li),Yi===null?Pn=Zi:Yi.sibling=Zi,Yi=Zi);return u&&An.forEach(function(SY){return f(Ue,SY)}),bi&&vc(Ue,li),Pn}function xr(Ue,we,Ge,yt){if(typeof Ge=="object"&&Ge!==null&&Ge.type===b&&Ge.key===null&&(Ge=Ge.props.children),typeof Ge=="object"&&Ge!==null){switch(Ge.$$typeof){case _:e:{for(var Pn=Ge.key;we!==null;){if(we.key===Pn){if(Pn=Ge.type,Pn===b){if(we.tag===7){g(Ue,we.sibling),yt=A(we,Ge.props.children),yt.return=Ue,Ue=yt;break e}}else if(we.elementType===Pn||typeof Pn=="object"&&Pn!==null&&Pn.$$typeof===F&&Fd(Pn)===we.type){g(Ue,we.sibling),yt=A(we,Ge.props),pg(yt,Ge),yt.return=Ue,Ue=yt;break e}g(Ue,we);break}else f(Ue,we);we=we.sibling}Ge.type===b?(yt=_c(Ge.props.children,Ue.mode,yt,Ge.key),yt.return=Ue,Ue=yt):(yt=og(Ge.type,Ge.key,Ge.props,null,Ue.mode,yt),pg(yt,Ge),yt.return=Ue,Ue=yt)}return G(Ue);case v:e:{for(Pn=Ge.key;we!==null;){if(we.key===Pn)if(we.tag===4&&we.stateNode.containerInfo===Ge.containerInfo&&we.stateNode.implementation===Ge.implementation){g(Ue,we.sibling),yt=A(we,Ge.children||[]),yt.return=Ue,Ue=yt;break e}else{g(Ue,we);break}else f(Ue,we);we=we.sibling}yt=Hl(Ge,Ue.mode,yt),yt.return=Ue,Ue=yt}return G(Ue);case F:return Ge=Fd(Ge),xr(Ue,we,Ge,yt)}if(ae(Ge))return vn(Ue,we,Ge,yt);if(j(Ge)){if(Pn=j(Ge),typeof Pn!="function")throw Error(n(150));return Ge=Pn.call(Ge),Hn(Ue,we,Ge,yt)}if(typeof Ge.then=="function")return xr(Ue,we,d_(Ge),yt);if(Ge.$$typeof===R)return xr(Ue,we,fg(Ue,Ge),yt);mg(Ue,Ge)}return typeof Ge=="string"&&Ge!==""||typeof Ge=="number"||typeof Ge=="bigint"?(Ge=""+Ge,we!==null&&we.tag===6?(g(Ue,we.sibling),yt=A(we,Ge),yt.return=Ue,Ue=yt):(g(Ue,we),yt=s_(Ge,Ue.mode,yt),yt.return=Ue,Ue=yt),G(Ue)):g(Ue,we)}return function(Ue,we,Ge,yt){try{Rf=0;var Pn=xr(Ue,we,Ge,yt);return wf=null,Pn}catch(An){if(An===Af||An===Xl)throw An;var Yi=Aa(29,An,null,Ue.mode);return Yi.lanes=yt,Yi.return=Ue,Yi}}}var zd=mp(!0),XE=mp(!1),Cf=!1;function Bb(u){u.updateQueue={baseState:u.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function Ib(u,f){u=u.updateQueue,f.updateQueue===u&&(f.updateQueue={baseState:u.baseState,firstBaseUpdate:u.firstBaseUpdate,lastBaseUpdate:u.lastBaseUpdate,shared:u.shared,callbacks:null})}function Du(u){return{lane:u,tag:0,payload:null,callback:null,next:null}}function Mc(u,f,g){var x=u.updateQueue;if(x===null)return null;if(x=x.shared,(Mi&2)!==0){var A=x.pending;return A===null?f.next=f:(f.next=A.next,A.next=f),x.pending=f,f=cp(u),r_(u,null,g),f}return ag(u,x,f,g),cp(u)}function Nf(u,f,g){if(f=f.updateQueue,f!==null&&(f=f.shared,(g&4194048)!==0)){var x=f.lanes;x&=u.pendingLanes,g|=x,f.lanes=g,Ln(u,g)}}function h_(u,f){var g=u.updateQueue,x=u.alternate;if(x!==null&&(x=x.updateQueue,g===x)){var A=null,C=null;if(g=g.firstBaseUpdate,g!==null){do{var G={lane:g.lane,tag:g.tag,payload:g.payload,callback:null,next:null};C===null?A=C=G:C=C.next=G,g=g.next}while(g!==null);C===null?A=C=f:C=C.next=f}else A=C=f;g={baseState:x.baseState,firstBaseUpdate:A,lastBaseUpdate:C,shared:x.shared,callbacks:x.callbacks},u.updateQueue=g;return}u=g.lastBaseUpdate,u===null?g.firstBaseUpdate=f:u.next=f,g.lastBaseUpdate=f}var Fb=!1;function gg(){if(Fb){var u=ql;if(u!==null)throw u}}function Vd(u,f,g,x){Fb=!1;var A=u.updateQueue;Cf=!1;var C=A.firstBaseUpdate,G=A.lastBaseUpdate,te=A.shared.pending;if(te!==null){A.shared.pending=null;var _e=te,ke=_e.next;_e.next=null,G===null?C=ke:G.next=ke,G=_e;var ot=u.alternate;ot!==null&&(ot=ot.updateQueue,te=ot.lastBaseUpdate,te!==G&&(te===null?ot.firstBaseUpdate=ke:te.next=ke,ot.lastBaseUpdate=_e))}if(C!==null){var xt=A.baseState;G=0,ot=ke=_e=null,te=C;do{var Xe=te.lane&-536870913,Qe=Xe!==te.lane;if(Qe?(hi&Xe)===Xe:(x&Xe)===Xe){Xe!==0&&Xe===Ec&&(Fb=!0),ot!==null&&(ot=ot.next={lane:0,tag:te.tag,payload:te.payload,callback:null,next:null});e:{var vn=u,Hn=te;Xe=f;var xr=g;switch(Hn.tag){case 1:if(vn=Hn.payload,typeof vn=="function"){xt=vn.call(xr,xt,Xe);break e}xt=vn;break e;case 3:vn.flags=vn.flags&-65537|128;case 0:if(vn=Hn.payload,Xe=typeof vn=="function"?vn.call(xr,xt,Xe):vn,Xe==null)break e;xt=p({},xt,Xe);break e;case 2:Cf=!0}}Xe=te.callback,Xe!==null&&(u.flags|=64,Qe&&(u.flags|=8192),Qe=A.callbacks,Qe===null?A.callbacks=[Xe]:Qe.push(Xe))}else Qe={lane:Xe,tag:te.tag,payload:te.payload,callback:te.callback,next:null},ot===null?(ke=ot=Qe,_e=xt):ot=ot.next=Qe,G|=Xe;if(te=te.next,te===null){if(te=A.shared.pending,te===null)break;Qe=te,te=Qe.next,Qe.next=null,A.lastBaseUpdate=Qe,A.shared.pending=null}}while(!0);ot===null&&(_e=xt),A.baseState=_e,A.firstBaseUpdate=ke,A.lastBaseUpdate=ot,C===null&&(A.shared.lanes=0),Io|=G,u.lanes=G,u.memoizedState=xt}}function Ou(u,f){if(typeof u!="function")throw Error(n(191,u));u.call(f)}function js(u,f){var g=u.callbacks;if(g!==null)for(u.callbacks=null,u=0;u<g.length;u++)Ou(g[u],f)}var wo=K(null),Ra=K(0);function zb(u,f){u=rs,Ce(Ra,u),Ce(wo,f),rs=u|f.baseLanes}function Vb(){Ce(Ra,rs),Ce(wo,wo.current)}function ua(){rs=Ra.current,he(wo),he(Ra)}var Ts=K(null),dl=null;function Df(u){var f=u.alternate;Ce(Gr,Gr.current&1),Ce(Ts,u),dl===null&&(f===null||wo.current!==null||f.memoizedState!==null)&&(dl=u)}function Gb(u){Ce(Gr,Gr.current),Ce(Ts,u),dl===null&&(dl=u)}function $E(u){u.tag===22?(Ce(Gr,Gr.current),Ce(Ts,u),dl===null&&(dl=u)):Ac()}function Ac(){Ce(Gr,Gr.current),Ce(Ts,Ts.current)}function Ro(u){he(Ts),dl===u&&(dl=null),he(Gr)}var Gr=K(0);function p_(u){for(var f=u;f!==null;){if(f.tag===13){var g=f.memoizedState;if(g!==null&&(g=g.dehydrated,g===null||p2(g)||m2(g)))return f}else if(f.tag===19&&(f.memoizedProps.revealOrder==="forwards"||f.memoizedProps.revealOrder==="backwards"||f.memoizedProps.revealOrder==="unstable_legacy-backwards"||f.memoizedProps.revealOrder==="together")){if((f.flags&128)!==0)return f}else if(f.child!==null){f.child.return=f,f=f.child;continue}if(f===u)break;for(;f.sibling===null;){if(f.return===null||f.return===u)return null;f=f.return}f.sibling.return=f.return,f=f.sibling}return null}var ja=0,qn=null,or=null,gs=null,m_=!1,Uu=!1,Gd=!1,g_=0,yg=0,Lu=null,XN=0;function kr(){throw Error(n(321))}function kb(u,f){if(f===null)return!1;for(var g=0;g<f.length&&g<u.length;g++)if(!Mr(u[g],f[g]))return!1;return!0}function Hb(u,f,g,x,A,C){return ja=C,qn=f,f.memoizedState=null,f.updateQueue=null,f.lanes=0,V.H=u===null||u.memoizedState===null?hM:_p,Gd=!1,C=g(x,A),Gd=!1,Uu&&(C=YE(f,g,x,A)),jE(u),C}function jE(u){V.H=Sg;var f=or!==null&&or.next!==null;if(ja=0,gs=or=qn=null,m_=!1,yg=0,Lu=null,f)throw Error(n(300));u===null||Ar||(u=u.dependencies,u!==null&&dp(u)&&(Ar=!0))}function YE(u,f,g,x){qn=u;var A=0;do{if(Uu&&(Lu=null),yg=0,Uu=!1,25<=A)throw Error(n(301));if(A+=1,gs=or=null,u.updateQueue!=null){var C=u.updateQueue;C.lastEffect=null,C.events=null,C.stores=null,C.memoCache!=null&&(C.memoCache.index=0)}V.H=Tg,C=f(g,x)}while(Uu);return C}function $N(){var u=V.H,f=u.useState()[0];return f=typeof f.then=="function"?vg(f):f,u=u.useState()[0],(or!==null?or.memoizedState:null)!==u&&(qn.flags|=1024),f}function Wb(){var u=g_!==0;return g_=0,u}function qb(u,f,g){f.updateQueue=u.updateQueue,f.flags&=-2053,u.lanes&=~g}function Xb(u){if(m_){for(u=u.memoizedState;u!==null;){var f=u.queue;f!==null&&(f.pending=null),u=u.next}m_=!1}ja=0,gs=or=qn=null,Uu=!1,yg=g_=0,Lu=null}function Ca(){var u={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return gs===null?qn.memoizedState=gs=u:gs=gs.next=u,gs}function es(){if(or===null){var u=qn.alternate;u=u!==null?u.memoizedState:null}else u=or.next;var f=gs===null?qn.memoizedState:gs.next;if(f!==null)gs=f,or=u;else{if(u===null)throw qn.alternate===null?Error(n(467)):Error(n(310));or=u,u={memoizedState:or.memoizedState,baseState:or.baseState,baseQueue:or.baseQueue,queue:or.queue,next:null},gs===null?qn.memoizedState=gs=u:gs=gs.next=u}return gs}function _g(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function vg(u){var f=yg;return yg+=1,Lu===null&&(Lu=[]),u=Lb(Lu,u,f),f=qn,(gs===null?f.memoizedState:gs.next)===null&&(f=f.alternate,V.H=f===null||f.memoizedState===null?hM:_p),u}function y_(u){if(u!==null&&typeof u=="object"){if(typeof u.then=="function")return vg(u);if(u.$$typeof===R)return Ps(u)}throw Error(n(438,String(u)))}function $b(u){var f=null,g=qn.updateQueue;if(g!==null&&(f=g.memoCache),f==null){var x=qn.alternate;x!==null&&(x=x.updateQueue,x!==null&&(x=x.memoCache,x!=null&&(f={data:x.data.map(function(A){return A.slice()}),index:0})))}if(f==null&&(f={data:[],index:0}),g===null&&(g=_g(),qn.updateQueue=g),g.memoCache=f,g=f.data[f.index],g===void 0)for(g=f.data[f.index]=Array(u),x=0;x<u;x++)g[x]=B;return f.index++,g}function wc(u,f){return typeof f=="function"?f(u):f}function __(u){var f=es();return jb(f,or,u)}function jb(u,f,g){var x=u.queue;if(x===null)throw Error(n(311));x.lastRenderedReducer=g;var A=u.baseQueue,C=x.pending;if(C!==null){if(A!==null){var G=A.next;A.next=C.next,C.next=G}f.baseQueue=A=C,x.pending=null}if(C=u.baseState,A===null)u.memoizedState=C;else{f=A.next;var te=G=null,_e=null,ke=f,ot=!1;do{var xt=ke.lane&-536870913;if(xt!==ke.lane?(hi&xt)===xt:(ja&xt)===xt){var Xe=ke.revertLane;if(Xe===0)_e!==null&&(_e=_e.next={lane:0,revertLane:0,gesture:null,action:ke.action,hasEagerState:ke.hasEagerState,eagerState:ke.eagerState,next:null}),xt===Ec&&(ot=!0);else if((ja&Xe)===Xe){ke=ke.next,Xe===Ec&&(ot=!0);continue}else xt={lane:0,revertLane:ke.revertLane,gesture:null,action:ke.action,hasEagerState:ke.hasEagerState,eagerState:ke.eagerState,next:null},_e===null?(te=_e=xt,G=C):_e=_e.next=xt,qn.lanes|=Xe,Io|=Xe;xt=ke.action,Gd&&g(C,xt),C=ke.hasEagerState?ke.eagerState:g(C,xt)}else Xe={lane:xt,revertLane:ke.revertLane,gesture:ke.gesture,action:ke.action,hasEagerState:ke.hasEagerState,eagerState:ke.eagerState,next:null},_e===null?(te=_e=Xe,G=C):_e=_e.next=Xe,qn.lanes|=xt,Io|=xt;ke=ke.next}while(ke!==null&&ke!==f);if(_e===null?G=C:_e.next=te,!Mr(C,u.memoizedState)&&(Ar=!0,ot&&(g=ql,g!==null)))throw g;u.memoizedState=C,u.baseState=G,u.baseQueue=_e,x.lastRenderedState=C}return A===null&&(x.lanes=0),[u.memoizedState,x.dispatch]}function v_(u){var f=es(),g=f.queue;if(g===null)throw Error(n(311));g.lastRenderedReducer=u;var x=g.dispatch,A=g.pending,C=f.memoizedState;if(A!==null){g.pending=null;var G=A=A.next;do C=u(C,G.action),G=G.next;while(G!==A);Mr(C,f.memoizedState)||(Ar=!0),f.memoizedState=C,f.baseQueue===null&&(f.baseState=C),g.lastRenderedState=C}return[C,x]}function Yb(u,f,g){var x=qn,A=es(),C=bi;if(C){if(g===void 0)throw Error(n(407));g=g()}else g=f();var G=!Mr((or||A).memoizedState,g);if(G&&(A.memoizedState=g,Ar=!0),A=A.queue,eS(Kb.bind(null,x,A,u),[u]),A.getSnapshot!==f||G||gs!==null&&gs.memoizedState.tag&1){if(x.flags|=2048,gp(9,{destroy:void 0},Zb.bind(null,x,A,g,f),null),$i===null)throw Error(n(349));C||(ja&127)!==0||ZE(x,f,g)}return g}function ZE(u,f,g){u.flags|=16384,u={getSnapshot:f,value:g},f=qn.updateQueue,f===null?(f=_g(),qn.updateQueue=f,f.stores=[u]):(g=f.stores,g===null?f.stores=[u]:g.push(u))}function Zb(u,f,g,x){f.value=g,f.getSnapshot=x,Qb(f)&&x_(u)}function Kb(u,f,g){return g(function(){Qb(f)&&x_(u)})}function Qb(u){var f=u.getSnapshot;u=u.value;try{var g=f();return!Mr(u,g)}catch{return!0}}function x_(u){var f=bf(u,2);f!==null&&m(f,u,2)}function xg(u){var f=Ca();if(typeof u=="function"){var g=u;if(u=g(),Gd){Pt(!0);try{g()}finally{Pt(!1)}}}return f.memoizedState=f.baseState=u,f.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:wc,lastRenderedState:u},f}function KE(u,f,g,x){return u.baseState=g,jb(u,or,typeof x=="function"?x:wc)}function jN(u,f,g,x,A){if(Rc(u))throw Error(n(485));if(u=f.action,u!==null){var C={payload:A,action:u,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(G){C.listeners.push(G)}};V.T!==null?g(!0):C.isTransition=!1,x(C),g=f.pending,g===null?(C.next=f.pending=C,QE(f,C)):(C.next=g.next,f.pending=g.next=C)}}function QE(u,f){var g=f.action,x=f.payload,A=u.state;if(f.isTransition){var C=V.T,G={};V.T=G;try{var te=g(A,x),_e=V.S;_e!==null&&_e(G,te),JE(u,f,te)}catch(ke){b_(u,f,ke)}finally{C!==null&&G.types!==null&&(C.types=G.types),V.T=C}}else try{C=g(A,x),JE(u,f,C)}catch(ke){b_(u,f,ke)}}function JE(u,f,g){g!==null&&typeof g=="object"&&typeof g.then=="function"?g.then(function(x){Jb(u,f,x)},function(x){return b_(u,f,x)}):Jb(u,f,g)}function Jb(u,f,g){f.status="fulfilled",f.value=g,eM(f),u.state=g,f=u.pending,f!==null&&(g=f.next,g===f?u.pending=null:(g=g.next,f.next=g,QE(u,g)))}function b_(u,f,g){var x=u.pending;if(u.pending=null,x!==null){x=x.next;do f.status="rejected",f.reason=g,eM(f),f=f.next;while(f!==x)}u.action=null}function eM(u){u=u.listeners;for(var f=0;f<u.length;f++)(0,u[f])()}function tM(u,f){return f}function nM(u,f){if(bi){var g=$i.formState;if(g!==null){e:{var x=qn;if(bi){if(yr){t:{for(var A=yr,C=Ls;A.nodeType!==8;){if(!C){A=null;break t}if(A=Vu(A.nextSibling),A===null){A=null;break t}}C=A.data,A=C==="F!"||C==="F"?A:null}if(A){yr=Vu(A.nextSibling),x=A.data==="F!";break e}}di(x)}x=!1}x&&(f=g[0])}}return g=Ca(),g.memoizedState=g.baseState=f,x={pending:null,lanes:0,dispatch:null,lastRenderedReducer:tM,lastRenderedState:f},g.queue=x,g=dM.bind(null,qn,x),x.dispatch=g,x=xg(!1),C=bg.bind(null,qn,!1,x.queue),x=Ca(),A={state:f,dispatch:null,action:u,pending:null},x.queue=A,g=jN.bind(null,qn,A,C,g),A.dispatch=g,x.memoizedState=u,[f,g,!1]}function iM(u){var f=es();return rM(f,or,u)}function rM(u,f,g){if(f=jb(u,f,tM)[0],u=__(wc)[0],typeof f=="object"&&f!==null&&typeof f.then=="function")try{var x=vg(f)}catch(G){throw G===Af?Xl:G}else x=f;f=es();var A=f.queue,C=A.dispatch;return g!==f.memoizedState&&(qn.flags|=2048,gp(9,{destroy:void 0},YN.bind(null,A,g),null)),[x,C,u]}function YN(u,f){u.action=f}function sM(u){var f=es(),g=or;if(g!==null)return rM(f,g,u);es(),f=f.memoizedState,g=es();var x=g.queue.dispatch;return g.memoizedState=u,[f,x,!1]}function gp(u,f,g,x){return u={tag:u,create:g,deps:x,inst:f,next:null},f=qn.updateQueue,f===null&&(f=_g(),qn.updateQueue=f),g=f.lastEffect,g===null?f.lastEffect=u.next=u:(x=g.next,g.next=u,u.next=x,f.lastEffect=u),u}function aM(){return es().memoizedState}function S_(u,f,g,x){var A=Ca();qn.flags|=u,A.memoizedState=gp(1|f,{destroy:void 0},g,x===void 0?null:x)}function T_(u,f,g,x){var A=es();x=x===void 0?null:x;var C=A.memoizedState.inst;or!==null&&x!==null&&kb(x,or.memoizedState.deps)?A.memoizedState=gp(f,C,g,x):(qn.flags|=u,A.memoizedState=gp(1|f,C,g,x))}function oM(u,f){S_(8390656,8,u,f)}function eS(u,f){T_(2048,8,u,f)}function lM(u){qn.flags|=4;var f=qn.updateQueue;if(f===null)f=_g(),qn.updateQueue=f,f.events=[u];else{var g=f.events;g===null?f.events=[u]:g.push(u)}}function uM(u){var f=es().memoizedState;return lM({ref:f,nextImpl:u}),function(){if((Mi&2)!==0)throw Error(n(440));return f.impl.apply(void 0,arguments)}}function cM(u,f){return T_(4,2,u,f)}function Co(u,f){return T_(4,4,u,f)}function tS(u,f){if(typeof f=="function"){u=u();var g=f(u);return function(){typeof g=="function"?g():f(null)}}if(f!=null)return u=u(),f.current=u,function(){f.current=null}}function E_(u,f,g){g=g!=null?g.concat([u]):null,T_(4,4,tS.bind(null,f,u),g)}function M_(){}function nS(u,f){var g=es();f=f===void 0?null:f;var x=g.memoizedState;return f!==null&&kb(f,x[1])?x[0]:(g.memoizedState=[u,f],u)}function iS(u,f){var g=es();f=f===void 0?null:f;var x=g.memoizedState;if(f!==null&&kb(f,x[1]))return x[0];if(x=u(),Gd){Pt(!0);try{u()}finally{Pt(!1)}}return g.memoizedState=[x,f],x}function rS(u,f,g){return g===void 0||(ja&1073741824)!==0&&(hi&261930)===0?u.memoizedState=f:(u.memoizedState=g,u=h(),qn.lanes|=u,Io|=u,g)}function sS(u,f,g,x){return Mr(g,f)?g:wo.current!==null?(u=rS(u,g,x),Mr(u,f)||(Ar=!0),u):(ja&42)===0||(ja&1073741824)!==0&&(hi&261930)===0?(Ar=!0,u.memoizedState=g):(u=h(),qn.lanes|=u,Io|=u,f)}function aS(u,f,g,x,A){var C=X.p;X.p=C!==0&&8>C?C:8;var G=V.T,te={};V.T=te,bg(u,!1,f,g);try{var _e=A(),ke=V.S;if(ke!==null&&ke(te,_e),_e!==null&&typeof _e=="object"&&typeof _e.then=="function"){var ot=Ub(_e,x);yp(u,f,ot,Da(u))}else yp(u,f,x,Da(u))}catch(xt){yp(u,f,{then:function(){},status:"rejected",reason:xt},Da())}finally{X.p=C,G!==null&&te.types!==null&&(G.types=te.types),V.T=G}}function ZN(){}function oS(u,f,g,x){if(u.tag!==5)throw Error(n(476));var A=fM(u).queue;aS(u,A,f,ee,g===null?ZN:function(){return lS(u),g(x)})}function fM(u){var f=u.memoizedState;if(f!==null)return f;f={memoizedState:ee,baseState:ee,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:wc,lastRenderedState:ee},next:null};var g={};return f.next={memoizedState:g,baseState:g,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:wc,lastRenderedState:g},next:null},u.memoizedState=f,u=u.alternate,u!==null&&(u.memoizedState=f),f}function lS(u){var f=fM(u);f.next===null&&(f=u.alternate.memoizedState),yp(u,f.next.queue,{},Da())}function uS(){return Ps(SS)}function Ys(){return es().memoizedState}function cS(){return es().memoizedState}function KN(u){for(var f=u.return;f!==null;){switch(f.tag){case 24:case 3:var g=Da();u=Du(g);var x=Mc(f,u,g);x!==null&&(m(x,f,g),Nf(x,f,g)),f={cache:Nb()},u.payload=f;return}f=f.return}}function QN(u,f,g){var x=Da();g={lane:x,revertLane:0,gesture:null,action:g,hasEagerState:!1,eagerState:null,next:null},Rc(u)?kd(f,g):(g=up(u,f,g,x),g!==null&&(m(g,u,x),Ya(g,f,x)))}function dM(u,f,g){var x=Da();yp(u,f,g,x)}function yp(u,f,g,x){var A={lane:x,revertLane:0,gesture:null,action:g,hasEagerState:!1,eagerState:null,next:null};if(Rc(u))kd(f,A);else{var C=u.alternate;if(u.lanes===0&&(C===null||C.lanes===0)&&(C=f.lastRenderedReducer,C!==null))try{var G=f.lastRenderedState,te=C(G,g);if(A.hasEagerState=!0,A.eagerState=te,Mr(te,G))return ag(u,f,A,0),$i===null&&xf(),!1}catch{}if(g=up(u,f,A,x),g!==null)return m(g,u,x),Ya(g,f,x),!0}return!1}function bg(u,f,g,x){if(x={lane:2,revertLane:n2(),gesture:null,action:x,hasEagerState:!1,eagerState:null,next:null},Rc(u)){if(f)throw Error(n(479))}else f=up(u,g,x,2),f!==null&&m(f,u,2)}function Rc(u){var f=u.alternate;return u===qn||f!==null&&f===qn}function kd(u,f){Uu=m_=!0;var g=u.pending;g===null?f.next=f:(f.next=g.next,g.next=f),u.pending=f}function Ya(u,f,g){if((g&4194048)!==0){var x=f.lanes;x&=u.pendingLanes,g|=x,f.lanes=g,Ln(u,g)}}var Sg={readContext:Ps,use:y_,useCallback:kr,useContext:kr,useEffect:kr,useImperativeHandle:kr,useLayoutEffect:kr,useInsertionEffect:kr,useMemo:kr,useReducer:kr,useRef:kr,useState:kr,useDebugValue:kr,useDeferredValue:kr,useTransition:kr,useSyncExternalStore:kr,useId:kr,useHostTransitionStatus:kr,useFormState:kr,useActionState:kr,useOptimistic:kr,useMemoCache:kr,useCacheRefresh:kr};Sg.useEffectEvent=kr;var hM={readContext:Ps,use:y_,useCallback:function(u,f){return Ca().memoizedState=[u,f===void 0?null:f],u},useContext:Ps,useEffect:oM,useImperativeHandle:function(u,f,g){g=g!=null?g.concat([u]):null,S_(4194308,4,tS.bind(null,f,u),g)},useLayoutEffect:function(u,f){return S_(4194308,4,u,f)},useInsertionEffect:function(u,f){S_(4,2,u,f)},useMemo:function(u,f){var g=Ca();f=f===void 0?null:f;var x=u();if(Gd){Pt(!0);try{u()}finally{Pt(!1)}}return g.memoizedState=[x,f],x},useReducer:function(u,f,g){var x=Ca();if(g!==void 0){var A=g(f);if(Gd){Pt(!0);try{g(f)}finally{Pt(!1)}}}else A=f;return x.memoizedState=x.baseState=A,u={pending:null,lanes:0,dispatch:null,lastRenderedReducer:u,lastRenderedState:A},x.queue=u,u=u.dispatch=QN.bind(null,qn,u),[x.memoizedState,u]},useRef:function(u){var f=Ca();return u={current:u},f.memoizedState=u},useState:function(u){u=xg(u);var f=u.queue,g=dM.bind(null,qn,f);return f.dispatch=g,[u.memoizedState,g]},useDebugValue:M_,useDeferredValue:function(u,f){var g=Ca();return rS(g,u,f)},useTransition:function(){var u=xg(!1);return u=aS.bind(null,qn,u.queue,!0,!1),Ca().memoizedState=u,[!1,u]},useSyncExternalStore:function(u,f,g){var x=qn,A=Ca();if(bi){if(g===void 0)throw Error(n(407));g=g()}else{if(g=f(),$i===null)throw Error(n(349));(hi&127)!==0||ZE(x,f,g)}A.memoizedState=g;var C={value:g,getSnapshot:f};return A.queue=C,oM(Kb.bind(null,x,C,u),[u]),x.flags|=2048,gp(9,{destroy:void 0},Zb.bind(null,x,C,g,f),null),g},useId:function(){var u=Ca(),f=$i.identifierPrefix;if(bi){var g=Cu,x=Ru;g=(x&~(1<<32-ue(x)-1)).toString(32)+g,f="_"+f+"R_"+g,g=g_++,0<g&&(f+="H"+g.toString(32)),f+="_"}else g=XN++,f="_"+f+"r_"+g.toString(32)+"_";return u.memoizedState=f},useHostTransitionStatus:uS,useFormState:nM,useActionState:nM,useOptimistic:function(u){var f=Ca();f.memoizedState=f.baseState=u;var g={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return f.queue=g,f=bg.bind(null,qn,!0,g),g.dispatch=f,[u,f]},useMemoCache:$b,useCacheRefresh:function(){return Ca().memoizedState=KN.bind(null,qn)},useEffectEvent:function(u){var f=Ca(),g={impl:u};return f.memoizedState=g,function(){if((Mi&2)!==0)throw Error(n(440));return g.impl.apply(void 0,arguments)}}},_p={readContext:Ps,use:y_,useCallback:nS,useContext:Ps,useEffect:eS,useImperativeHandle:E_,useInsertionEffect:cM,useLayoutEffect:Co,useMemo:iS,useReducer:__,useRef:aM,useState:function(){return __(wc)},useDebugValue:M_,useDeferredValue:function(u,f){var g=es();return sS(g,or.memoizedState,u,f)},useTransition:function(){var u=__(wc)[0],f=es().memoizedState;return[typeof u=="boolean"?u:vg(u),f]},useSyncExternalStore:Yb,useId:Ys,useHostTransitionStatus:uS,useFormState:iM,useActionState:iM,useOptimistic:function(u,f){var g=es();return KE(g,or,u,f)},useMemoCache:$b,useCacheRefresh:cS};_p.useEffectEvent=uM;var Tg={readContext:Ps,use:y_,useCallback:nS,useContext:Ps,useEffect:eS,useImperativeHandle:E_,useInsertionEffect:cM,useLayoutEffect:Co,useMemo:iS,useReducer:v_,useRef:aM,useState:function(){return v_(wc)},useDebugValue:M_,useDeferredValue:function(u,f){var g=es();return or===null?rS(g,u,f):sS(g,or.memoizedState,u,f)},useTransition:function(){var u=v_(wc)[0],f=es().memoizedState;return[typeof u=="boolean"?u:vg(u),f]},useSyncExternalStore:Yb,useId:Ys,useHostTransitionStatus:uS,useFormState:sM,useActionState:sM,useOptimistic:function(u,f){var g=es();return or!==null?KE(g,or,u,f):(g.baseState=u,[u,g.queue.dispatch])},useMemoCache:$b,useCacheRefresh:cS};Tg.useEffectEvent=uM;function vp(u,f,g,x){f=u.memoizedState,g=g(x,f),g=g==null?f:p({},f,g),u.memoizedState=g,u.lanes===0&&(u.updateQueue.baseState=g)}var Eg={enqueueSetState:function(u,f,g){u=u._reactInternals;var x=Da(),A=Du(x);A.payload=f,g!=null&&(A.callback=g),f=Mc(u,A,x),f!==null&&(m(f,u,x),Nf(f,u,x))},enqueueReplaceState:function(u,f,g){u=u._reactInternals;var x=Da(),A=Du(x);A.tag=1,A.payload=f,g!=null&&(A.callback=g),f=Mc(u,A,x),f!==null&&(m(f,u,x),Nf(f,u,x))},enqueueForceUpdate:function(u,f){u=u._reactInternals;var g=Da(),x=Du(g);x.tag=2,f!=null&&(x.callback=f),f=Mc(u,x,g),f!==null&&(m(f,u,g),Nf(f,u,g))}};function pM(u,f,g,x,A,C,G){return u=u.stateNode,typeof u.shouldComponentUpdate=="function"?u.shouldComponentUpdate(x,C,G):f.prototype&&f.prototype.isPureReactComponent?!ip(g,x)||!ip(A,C):!0}function mM(u,f,g,x){u=f.state,typeof f.componentWillReceiveProps=="function"&&f.componentWillReceiveProps(g,x),typeof f.UNSAFE_componentWillReceiveProps=="function"&&f.UNSAFE_componentWillReceiveProps(g,x),f.state!==u&&Eg.enqueueReplaceState(f,f.state,null)}function Zs(u,f){var g=f;if("ref"in f){g={};for(var x in f)x!=="ref"&&(g[x]=f[x])}if(u=u.defaultProps){g===f&&(g=p({},g));for(var A in u)g[A]===void 0&&(g[A]=u[A])}return g}function fS(u){vf(u)}function gM(u){console.error(u)}function A_(u){vf(u)}function w_(u,f){try{var g=u.onUncaughtError;g(f.value,{componentStack:f.stack})}catch(x){setTimeout(function(){throw x})}}function yM(u,f,g){try{var x=u.onCaughtError;x(g.value,{componentStack:g.stack,errorBoundary:f.tag===1?f.stateNode:null})}catch(A){setTimeout(function(){throw A})}}function dS(u,f,g){return g=Du(g),g.tag=3,g.payload={element:null},g.callback=function(){w_(u,f)},g}function xp(u){return u=Du(u),u.tag=3,u}function Za(u,f,g,x){var A=g.type.getDerivedStateFromError;if(typeof A=="function"){var C=x.value;u.payload=function(){return A(C)},u.callback=function(){yM(f,g,x)}}var G=g.stateNode;G!==null&&typeof G.componentDidCatch=="function"&&(u.callback=function(){yM(f,g,x),typeof A!="function"&&(zu===null?zu=new Set([this]):zu.add(this));var te=x.stack;this.componentDidCatch(x.value,{componentStack:te!==null?te:""})})}function No(u,f,g,x,A){if(g.flags|=32768,x!==null&&typeof x=="object"&&typeof x.then=="function"){if(f=g.alternate,f!==null&&Ef(f,g,A,!0),g=Ts.current,g!==null){switch(g.tag){case 31:case 13:return dl===null?Kn():g.alternate===null&&ji===0&&(ji=3),g.flags&=-257,g.flags|=65536,g.lanes=A,x===hg?g.flags|=16384:(f=g.updateQueue,f===null?g.updateQueue=new Set([x]):f.add(x),JN(u,x,A)),!1;case 22:return g.flags|=65536,x===hg?g.flags|=16384:(f=g.updateQueue,f===null?(f={transitions:null,markerInstances:null,retryQueue:new Set([x])},g.updateQueue=f):(g=f.retryQueue,g===null?f.retryQueue=new Set([x]):g.add(x)),JN(u,x,A)),!1}throw Error(n(435,g.tag))}return JN(u,x,A),Kn(),!1}if(bi)return f=Ts.current,f!==null?((f.flags&65536)===0&&(f.flags|=256),f.flags|=65536,f.lanes=A,x!==o_&&(u=Error(n(422),{cause:x}),cg(Xa(u,g)))):(x!==o_&&(f=Error(n(423),{cause:x}),cg(Xa(f,g))),u=u.current.alternate,u.flags|=65536,A&=-A,u.lanes|=A,x=Xa(x,g),A=dS(u.stateNode,x,A),h_(u,A),ji!==4&&(ji=2)),!1;var C=Error(n(520),{cause:x});if(C=Xa(C,g),Kl===null?Kl=[C]:Kl.push(C),ji!==4&&(ji=2),f===null)return!0;x=Xa(x,g),g=f;do{switch(g.tag){case 3:return g.flags|=65536,u=A&-A,g.lanes|=u,u=dS(g.stateNode,x,u),h_(g,u),!1;case 1:if(f=g.type,C=g.stateNode,(g.flags&128)===0&&(typeof f.getDerivedStateFromError=="function"||C!==null&&typeof C.componentDidCatch=="function"&&(zu===null||!zu.has(C))))return g.flags|=65536,A&=-A,g.lanes|=A,A=xp(A),Za(A,u,g,x),h_(g,A),!1}g=g.return}while(g!==null);return!1}var R_=Error(n(461)),Ar=!1;function Hr(u,f,g,x){f.child=u===null?XE(f,null,g,x):zd(f,u.child,g,x)}function Mg(u,f,g,x,A){g=g.render;var C=f.ref;if("ref"in x){var G={};for(var te in x)te!=="ref"&&(G[te]=x[te])}else G=x;return Bd(f),x=Hb(u,f,g,G,C,A),te=Wb(),u!==null&&!Ar?(qb(u,f,A),Yl(u,f,A)):(bi&&te&&a_(f),f.flags|=1,Hr(u,f,x,A),f.child)}function Ag(u,f,g,x,A){if(u===null){var C=g.type;return typeof C=="function"&&!wa(C)&&C.defaultProps===void 0&&g.compare===null?(f.tag=15,f.type=C,Do(u,f,C,x,A)):(u=og(g.type,null,x,f,f.mode,A),u.ref=f.ref,u.return=f,f.child=u)}if(C=u.child,!Uf(u,A)){var G=C.memoizedProps;if(g=g.compare,g=g!==null?g:ip,g(G,x)&&u.ref===f.ref)return Yl(u,f,A)}return f.flags|=1,u=Au(C,x),u.ref=f.ref,u.return=f,f.child=u}function Do(u,f,g,x,A){if(u!==null){var C=u.memoizedProps;if(ip(C,x)&&u.ref===f.ref)if(Ar=!1,f.pendingProps=x=C,Uf(u,A))(u.flags&131072)!==0&&(Ar=!0);else return f.lanes=u.lanes,Yl(u,f,A)}return bp(u,f,g,x,A)}function Oo(u,f,g,x){var A=x.children,C=u!==null?u.memoizedState:null;if(u===null&&f.stateNode===null&&(f.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),x.mode==="hidden"){if((f.flags&128)!==0){if(C=C!==null?C.baseLanes|g:g,u!==null){for(x=f.child=u.child,A=0;x!==null;)A=A|x.lanes|x.childLanes,x=x.sibling;x=A&~C}else x=0,f.child=null;return Pu(u,f,C,g,x)}if((g&536870912)!==0)f.memoizedState={baseLanes:0,cachePool:null},u!==null&&pp(f,C!==null?C.cachePool:null),C!==null?zb(f,C):Vb(),$E(f);else return x=f.lanes=536870912,Pu(u,f,C!==null?C.baseLanes|g:g,g,x)}else C!==null?(pp(f,C.cachePool),zb(f,C),Ac(),f.memoizedState=null):(u!==null&&pp(f,null),Vb(),Ac());return Hr(u,f,A,g),f.child}function $l(u,f){return u!==null&&u.tag===22||f.stateNode!==null||(f.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),f.sibling}function Pu(u,f,g,x,A){var C=Nu();return C=C===null?null:{parent:Dn._currentValue,pool:C},f.memoizedState={baseLanes:g,cachePool:C},u!==null&&pp(f,null),Vb(),$E(f),u!==null&&Ef(u,f,x,!0),f.childLanes=A,null}function hl(u,f){return f=Sp({mode:f.mode,children:f.children},u.mode),f.ref=u.ref,u.child=f,f.return=u,f}function Bs(u,f,g){return zd(f,u.child,null,g),u=hl(f,f.pendingProps),u.flags|=2,Ro(f),f.memoizedState=null,u}function wg(u,f,g){var x=f.pendingProps,A=(f.flags&128)!==0;if(f.flags&=-129,u===null){if(bi){if(x.mode==="hidden")return u=hl(f,x),f.lanes=536870912,$l(null,u);if(Gb(f),(u=yr)?(u=iF(u,Ls),u=u!==null&&u.data==="&"?u:null,u!==null&&(f.memoizedState={dehydrated:u,treeContext:wu!==null?{id:Ru,overflow:Cu}:null,retryLane:536870912,hydrationErrors:null},g=VE(u),g.return=f,f.child=g,Us=f,yr=null)):u=null,u===null)throw di(f);return f.lanes=536870912,null}return hl(f,x)}var C=u.memoizedState;if(C!==null){var G=C.dehydrated;if(Gb(f),A)if(f.flags&256)f.flags&=-257,f=Bs(u,f,g);else if(f.memoizedState!==null)f.child=u.child,f.flags|=128,f=null;else throw Error(n(558));else if(Ar||Ef(u,f,g,!1),A=(g&u.childLanes)!==0,Ar||A){if(x=$i,x!==null&&(G=dn(x,g),G!==0&&G!==C.retryLane))throw C.retryLane=G,bf(u,G),m(x,u,G),R_;Kn(),f=Bs(u,f,g)}else u=C.treeContext,yr=Vu(G.nextSibling),Us=f,bi=!0,xc=null,Ls=!1,u!==null&&ug(f,u),f=hl(f,x),f.flags|=4096;return f}return u=Au(u.child,{mode:x.mode,children:x.children}),u.ref=f.ref,f.child=u,u.return=f,u}function jl(u,f){var g=f.ref;if(g===null)u!==null&&u.ref!==null&&(f.flags|=4194816);else{if(typeof g!="function"&&typeof g!="object")throw Error(n(284));(u===null||u.ref!==g)&&(f.flags|=4194816)}}function bp(u,f,g,x,A){return Bd(f),g=Hb(u,f,g,x,void 0,A),x=Wb(),u!==null&&!Ar?(qb(u,f,A),Yl(u,f,A)):(bi&&x&&a_(f),f.flags|=1,Hr(u,f,g,A),f.child)}function ca(u,f,g,x,A,C){return Bd(f),f.updateQueue=null,g=YE(f,x,g,A),jE(u),x=Wb(),u!==null&&!Ar?(qb(u,f,C),Yl(u,f,C)):(bi&&x&&a_(f),f.flags|=1,Hr(u,f,g,C),f.child)}function Ks(u,f,g,x,A){if(Bd(f),f.stateNode===null){var C=Sf,G=g.contextType;typeof G=="object"&&G!==null&&(C=Ps(G)),C=new g(x,C),f.memoizedState=C.state!==null&&C.state!==void 0?C.state:null,C.updater=Eg,f.stateNode=C,C._reactInternals=f,C=f.stateNode,C.props=x,C.state=f.memoizedState,C.refs={},Bb(f),G=g.contextType,C.context=typeof G=="object"&&G!==null?Ps(G):Sf,C.state=f.memoizedState,G=g.getDerivedStateFromProps,typeof G=="function"&&(vp(f,g,G,x),C.state=f.memoizedState),typeof g.getDerivedStateFromProps=="function"||typeof C.getSnapshotBeforeUpdate=="function"||typeof C.UNSAFE_componentWillMount!="function"&&typeof C.componentWillMount!="function"||(G=C.state,typeof C.componentWillMount=="function"&&C.componentWillMount(),typeof C.UNSAFE_componentWillMount=="function"&&C.UNSAFE_componentWillMount(),G!==C.state&&Eg.enqueueReplaceState(C,C.state,null),Vd(f,x,C,A),gg(),C.state=f.memoizedState),typeof C.componentDidMount=="function"&&(f.flags|=4194308),x=!0}else if(u===null){C=f.stateNode;var te=f.memoizedProps,_e=Zs(g,te);C.props=_e;var ke=C.context,ot=g.contextType;G=Sf,typeof ot=="object"&&ot!==null&&(G=Ps(ot));var xt=g.getDerivedStateFromProps;ot=typeof xt=="function"||typeof C.getSnapshotBeforeUpdate=="function",te=f.pendingProps!==te,ot||typeof C.UNSAFE_componentWillReceiveProps!="function"&&typeof C.componentWillReceiveProps!="function"||(te||ke!==G)&&mM(f,C,x,G),Cf=!1;var Xe=f.memoizedState;C.state=Xe,Vd(f,x,C,A),gg(),ke=f.memoizedState,te||Xe!==ke||Cf?(typeof xt=="function"&&(vp(f,g,xt,x),ke=f.memoizedState),(_e=Cf||pM(f,g,_e,x,Xe,ke,G))?(ot||typeof C.UNSAFE_componentWillMount!="function"&&typeof C.componentWillMount!="function"||(typeof C.componentWillMount=="function"&&C.componentWillMount(),typeof C.UNSAFE_componentWillMount=="function"&&C.UNSAFE_componentWillMount()),typeof C.componentDidMount=="function"&&(f.flags|=4194308)):(typeof C.componentDidMount=="function"&&(f.flags|=4194308),f.memoizedProps=x,f.memoizedState=ke),C.props=x,C.state=ke,C.context=G,x=_e):(typeof C.componentDidMount=="function"&&(f.flags|=4194308),x=!1)}else{C=f.stateNode,Ib(u,f),G=f.memoizedProps,ot=Zs(g,G),C.props=ot,xt=f.pendingProps,Xe=C.context,ke=g.contextType,_e=Sf,typeof ke=="object"&&ke!==null&&(_e=Ps(ke)),te=g.getDerivedStateFromProps,(ke=typeof te=="function"||typeof C.getSnapshotBeforeUpdate=="function")||typeof C.UNSAFE_componentWillReceiveProps!="function"&&typeof C.componentWillReceiveProps!="function"||(G!==xt||Xe!==_e)&&mM(f,C,x,_e),Cf=!1,Xe=f.memoizedState,C.state=Xe,Vd(f,x,C,A),gg();var Qe=f.memoizedState;G!==xt||Xe!==Qe||Cf||u!==null&&u.dependencies!==null&&dp(u.dependencies)?(typeof te=="function"&&(vp(f,g,te,x),Qe=f.memoizedState),(ot=Cf||pM(f,g,ot,x,Xe,Qe,_e)||u!==null&&u.dependencies!==null&&dp(u.dependencies))?(ke||typeof C.UNSAFE_componentWillUpdate!="function"&&typeof C.componentWillUpdate!="function"||(typeof C.componentWillUpdate=="function"&&C.componentWillUpdate(x,Qe,_e),typeof C.UNSAFE_componentWillUpdate=="function"&&C.UNSAFE_componentWillUpdate(x,Qe,_e)),typeof C.componentDidUpdate=="function"&&(f.flags|=4),typeof C.getSnapshotBeforeUpdate=="function"&&(f.flags|=1024)):(typeof C.componentDidUpdate!="function"||G===u.memoizedProps&&Xe===u.memoizedState||(f.flags|=4),typeof C.getSnapshotBeforeUpdate!="function"||G===u.memoizedProps&&Xe===u.memoizedState||(f.flags|=1024),f.memoizedProps=x,f.memoizedState=Qe),C.props=x,C.state=Qe,C.context=_e,x=ot):(typeof C.componentDidUpdate!="function"||G===u.memoizedProps&&Xe===u.memoizedState||(f.flags|=4),typeof C.getSnapshotBeforeUpdate!="function"||G===u.memoizedProps&&Xe===u.memoizedState||(f.flags|=1024),x=!1)}return C=x,jl(u,f),x=(f.flags&128)!==0,C||x?(C=f.stateNode,g=x&&typeof g.getDerivedStateFromError!="function"?null:C.render(),f.flags|=1,u!==null&&x?(f.child=zd(f,u.child,null,A),f.child=zd(f,null,g,A)):Hr(u,f,g,A),f.memoizedState=C.state,u=f.child):u=Yl(u,f,A),u}function Ni(u,f,g,x){return Pd(),f.flags|=256,Hr(u,f,g,x),f.child}var Uo={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function pl(u){return{baseLanes:u,cachePool:c_()}}function Rg(u,f,g){return u=u!==null?u.childLanes&~g:0,f&&(u|=Ai),u}function Lo(u,f,g){var x=f.pendingProps,A=!1,C=(f.flags&128)!==0,G;if((G=C)||(G=u!==null&&u.memoizedState===null?!1:(Gr.current&2)!==0),G&&(A=!0,f.flags&=-129),G=(f.flags&32)!==0,f.flags&=-33,u===null){if(bi){if(A?Df(f):Ac(),(u=yr)?(u=iF(u,Ls),u=u!==null&&u.data!=="&"?u:null,u!==null&&(f.memoizedState={dehydrated:u,treeContext:wu!==null?{id:Ru,overflow:Cu}:null,retryLane:536870912,hydrationErrors:null},g=VE(u),g.return=f,f.child=g,Us=f,yr=null)):u=null,u===null)throw di(f);return m2(u)?f.lanes=32:f.lanes=536870912,null}var te=x.children;return x=x.fallback,A?(Ac(),A=f.mode,te=Sp({mode:"hidden",children:te},A),x=_c(x,A,g,null),te.return=f,x.return=f,te.sibling=x,f.child=te,x=f.child,x.memoizedState=pl(g),x.childLanes=Rg(u,G,g),f.memoizedState=Uo,$l(null,x)):(Df(f),Of(f,te))}var _e=u.memoizedState;if(_e!==null&&(te=_e.dehydrated,te!==null)){if(C)f.flags&256?(Df(f),f.flags&=-257,f=Tp(u,f,g)):f.memoizedState!==null?(Ac(),f.child=u.child,f.flags|=128,f=null):(Ac(),te=x.fallback,A=f.mode,x=Sp({mode:"visible",children:x.children},A),te=_c(te,A,g,null),te.flags|=2,x.return=f,te.return=f,x.sibling=te,f.child=x,zd(f,u.child,null,g),x=f.child,x.memoizedState=pl(g),x.childLanes=Rg(u,G,g),f.memoizedState=Uo,f=$l(null,x));else if(Df(f),m2(te)){if(G=te.nextSibling&&te.nextSibling.dataset,G)var ke=G.dgst;G=ke,x=Error(n(419)),x.stack="",x.digest=G,cg({value:x,source:null,stack:null}),f=Tp(u,f,g)}else if(Ar||Ef(u,f,g,!1),G=(g&u.childLanes)!==0,Ar||G){if(G=$i,G!==null&&(x=dn(G,g),x!==0&&x!==_e.retryLane))throw _e.retryLane=x,bf(u,x),m(G,u,x),R_;p2(te)||Kn(),f=Tp(u,f,g)}else p2(te)?(f.flags|=192,f.child=u.child,f=null):(u=_e.treeContext,yr=Vu(te.nextSibling),Us=f,bi=!0,xc=null,Ls=!1,u!==null&&ug(f,u),f=Of(f,x.children),f.flags|=4096);return f}return A?(Ac(),te=x.fallback,A=f.mode,_e=u.child,ke=_e.sibling,x=Au(_e,{mode:"hidden",children:x.children}),x.subtreeFlags=_e.subtreeFlags&65011712,ke!==null?te=Au(ke,te):(te=_c(te,A,g,null),te.flags|=2),te.return=f,x.return=f,x.sibling=te,f.child=x,$l(null,x),x=f.child,te=u.child.memoizedState,te===null?te=pl(g):(A=te.cachePool,A!==null?(_e=Dn._currentValue,A=A.parent!==_e?{parent:_e,pool:_e}:A):A=c_(),te={baseLanes:te.baseLanes|g,cachePool:A}),x.memoizedState=te,x.childLanes=Rg(u,G,g),f.memoizedState=Uo,$l(u.child,x)):(Df(f),g=u.child,u=g.sibling,g=Au(g,{mode:"visible",children:x.children}),g.return=f,g.sibling=null,u!==null&&(G=f.deletions,G===null?(f.deletions=[u],f.flags|=16):G.push(u)),f.child=g,f.memoizedState=null,g)}function Of(u,f){return f=Sp({mode:"visible",children:f},u.mode),f.return=u,u.child=f}function Sp(u,f){return u=Aa(22,u,null,f),u.lanes=0,u}function Tp(u,f,g){return zd(f,u.child,null,g),u=Of(f,f.pendingProps.children),u.flags|=2,f.memoizedState=null,u}function Hd(u,f,g){u.lanes|=f;var x=u.alternate;x!==null&&(x.lanes|=f),Tc(u.return,f,g)}function Cg(u,f,g,x,A,C){var G=u.memoizedState;G===null?u.memoizedState={isBackwards:f,rendering:null,renderingStartTime:0,last:x,tail:g,tailMode:A,treeForkCount:C}:(G.isBackwards=f,G.rendering=null,G.renderingStartTime=0,G.last=x,G.tail=g,G.tailMode=A,G.treeForkCount=C)}function Ng(u,f,g){var x=f.pendingProps,A=x.revealOrder,C=x.tail;x=x.children;var G=Gr.current,te=(G&2)!==0;if(te?(G=G&1|2,f.flags|=128):G&=1,Ce(Gr,G),Hr(u,f,x,g),x=bi?fp:0,!te&&u!==null&&(u.flags&128)!==0)e:for(u=f.child;u!==null;){if(u.tag===13)u.memoizedState!==null&&Hd(u,g,f);else if(u.tag===19)Hd(u,g,f);else if(u.child!==null){u.child.return=u,u=u.child;continue}if(u===f)break e;for(;u.sibling===null;){if(u.return===null||u.return===f)break e;u=u.return}u.sibling.return=u.return,u=u.sibling}switch(A){case"forwards":for(g=f.child,A=null;g!==null;)u=g.alternate,u!==null&&p_(u)===null&&(A=g),g=g.sibling;g=A,g===null?(A=f.child,f.child=null):(A=g.sibling,g.sibling=null),Cg(f,!1,A,g,C,x);break;case"backwards":case"unstable_legacy-backwards":for(g=null,A=f.child,f.child=null;A!==null;){if(u=A.alternate,u!==null&&p_(u)===null){f.child=A;break}u=A.sibling,A.sibling=g,g=A,A=u}Cg(f,!0,g,null,C,x);break;case"together":Cg(f,!1,null,null,void 0,x);break;default:f.memoizedState=null}return f.child}function Yl(u,f,g){if(u!==null&&(f.dependencies=u.dependencies),Io|=f.lanes,(g&f.childLanes)===0)if(u!==null){if(Ef(u,f,g,!1),(g&f.childLanes)===0)return null}else return null;if(u!==null&&f.child!==u.child)throw Error(n(153));if(f.child!==null){for(u=f.child,g=Au(u,u.pendingProps),f.child=g,g.return=f;u.sibling!==null;)u=u.sibling,g=g.sibling=Au(u,u.pendingProps),g.return=f;g.sibling=null}return f.child}function Uf(u,f){return(u.lanes&f)!==0?!0:(u=u.dependencies,!!(u!==null&&dp(u)))}function Dg(u,f,g){switch(f.tag){case 3:rt(f,f.stateNode.containerInfo),Sc(f,Dn,u.memoizedState.cache),Pd();break;case 27:case 5:Ft(f);break;case 4:rt(f,f.stateNode.containerInfo);break;case 10:Sc(f,f.type,f.memoizedProps.value);break;case 31:if(f.memoizedState!==null)return f.flags|=128,Gb(f),null;break;case 13:var x=f.memoizedState;if(x!==null)return x.dehydrated!==null?(Df(f),f.flags|=128,null):(g&f.child.childLanes)!==0?Lo(u,f,g):(Df(f),u=Yl(u,f,g),u!==null?u.sibling:null);Df(f);break;case 19:var A=(u.flags&128)!==0;if(x=(g&f.childLanes)!==0,x||(Ef(u,f,g,!1),x=(g&f.childLanes)!==0),A){if(x)return Ng(u,f,g);f.flags|=128}if(A=f.memoizedState,A!==null&&(A.rendering=null,A.tail=null,A.lastEffect=null),Ce(Gr,Gr.current),x)break;return null;case 22:return f.lanes=0,Oo(u,f,g,f.pendingProps);case 24:Sc(f,Dn,u.memoizedState.cache)}return Yl(u,f,g)}function C_(u,f,g){if(u!==null)if(u.memoizedProps!==f.pendingProps)Ar=!0;else{if(!Uf(u,g)&&(f.flags&128)===0)return Ar=!1,Dg(u,f,g);Ar=(u.flags&131072)!==0}else Ar=!1,bi&&(f.flags&1048576)!==0&&Mb(f,fp,f.index);switch(f.lanes=0,f.tag){case 16:e:{var x=f.pendingProps;if(u=Fd(f.elementType),f.type=u,typeof u=="function")wa(u)?(x=Zs(u,x),f.tag=1,f=Ks(null,f,u,x,g)):(f.tag=0,f=bp(null,f,u,x,g));else{if(u!=null){var A=u.$$typeof;if(A===N){f.tag=11,f=Mg(null,f,u,x,g);break e}else if(A===L){f.tag=14,f=Ag(null,f,u,x,g);break e}}throw f=se(u)||u,Error(n(306,f,""))}}return f;case 0:return bp(u,f,f.type,f.pendingProps,g);case 1:return x=f.type,A=Zs(x,f.pendingProps),Ks(u,f,x,A,g);case 3:e:{if(rt(f,f.stateNode.containerInfo),u===null)throw Error(n(387));x=f.pendingProps;var C=f.memoizedState;A=C.element,Ib(u,f),Vd(f,x,null,g);var G=f.memoizedState;if(x=G.cache,Sc(f,Dn,x),x!==C.cache&&u_(f,[Dn],g,!0),gg(),x=G.element,C.isDehydrated)if(C={element:x,isDehydrated:!1,cache:G.cache},f.updateQueue.baseState=C,f.memoizedState=C,f.flags&256){f=Ni(u,f,x,g);break e}else if(x!==A){A=Xa(Error(n(424)),f),cg(A),f=Ni(u,f,x,g);break e}else{switch(u=f.stateNode.containerInfo,u.nodeType){case 9:u=u.body;break;default:u=u.nodeName==="HTML"?u.ownerDocument.body:u}for(yr=Vu(u.firstChild),Us=f,bi=!0,xc=null,Ls=!0,g=XE(f,null,x,g),f.child=g;g;)g.flags=g.flags&-3|4096,g=g.sibling}else{if(Pd(),x===A){f=Yl(u,f,g);break e}Hr(u,f,x,g)}f=f.child}return f;case 26:return jl(u,f),u===null?(g=uF(f.type,null,f.pendingProps,null))?f.memoizedState=g:bi||(g=f.type,u=f.pendingProps,x=MM(Ee.current).createElement(g),x[pn]=f,x[W]=u,Oa(x,g,u),$(x),f.stateNode=x):f.memoizedState=uF(f.type,u.memoizedProps,f.pendingProps,u.memoizedState),null;case 27:return Ft(f),u===null&&bi&&(x=f.stateNode=aF(f.type,f.pendingProps,Ee.current),Us=f,Ls=!0,A=yr,Np(f.type)?(g2=A,yr=Vu(x.firstChild)):yr=A),Hr(u,f,f.pendingProps.children,g),jl(u,f),u===null&&(f.flags|=4194304),f.child;case 5:return u===null&&bi&&((A=x=yr)&&(x=Qj(x,f.type,f.pendingProps,Ls),x!==null?(f.stateNode=x,Us=f,yr=Vu(x.firstChild),Ls=!1,A=!0):A=!1),A||di(f)),Ft(f),A=f.type,C=f.pendingProps,G=u!==null?u.memoizedProps:null,x=C.children,f2(A,C)?x=null:G!==null&&f2(A,G)&&(f.flags|=32),f.memoizedState!==null&&(A=Hb(u,f,$N,null,null,g),SS._currentValue=A),jl(u,f),Hr(u,f,x,g),f.child;case 6:return u===null&&bi&&((u=g=yr)&&(g=Jj(g,f.pendingProps,Ls),g!==null?(f.stateNode=g,Us=f,yr=null,u=!0):u=!1),u||di(f)),null;case 13:return Lo(u,f,g);case 4:return rt(f,f.stateNode.containerInfo),x=f.pendingProps,u===null?f.child=zd(f,null,x,g):Hr(u,f,x,g),f.child;case 11:return Mg(u,f,f.type,f.pendingProps,g);case 7:return Hr(u,f,f.pendingProps,g),f.child;case 8:return Hr(u,f,f.pendingProps.children,g),f.child;case 12:return Hr(u,f,f.pendingProps.children,g),f.child;case 10:return x=f.pendingProps,Sc(f,f.type,x.value),Hr(u,f,x.children,g),f.child;case 9:return A=f.type._context,x=f.pendingProps.children,Bd(f),A=Ps(A),x=x(A),f.flags|=1,Hr(u,f,x,g),f.child;case 14:return Ag(u,f,f.type,f.pendingProps,g);case 15:return Do(u,f,f.type,f.pendingProps,g);case 19:return Ng(u,f,g);case 31:return wg(u,f,g);case 22:return Oo(u,f,g,f.pendingProps);case 24:return Bd(f),x=Ps(Dn),u===null?(A=Nu(),A===null&&(A=$i,C=Nb(),A.pooledCache=C,C.refCount++,C!==null&&(A.pooledCacheLanes|=g),A=C),f.memoizedState={parent:x,cache:A},Bb(f),Sc(f,Dn,A)):((u.lanes&g)!==0&&(Ib(u,f),Vd(f,null,null,g),gg()),A=u.memoizedState,C=f.memoizedState,A.parent!==x?(A={parent:x,cache:x},f.memoizedState=A,f.lanes===0&&(f.memoizedState=f.updateQueue.baseState=A),Sc(f,Dn,x)):(x=C.cache,Sc(f,Dn,x),x!==A.cache&&u_(f,[Dn],g,!0))),Hr(u,f,f.pendingProps.children,g),f.child;case 29:throw f.pendingProps}throw Error(n(156,f.tag))}function Ka(u){u.flags|=4}function Lf(u,f,g,x,A){if((f=(u.mode&32)!==0)&&(f=!1),f){if(u.flags|=16777216,(A&335544128)===A)if(u.stateNode.complete)u.flags|=8192;else if(Ht())u.flags|=8192;else throw In=hg,dg}else u.flags&=-16777217}function Cc(u,f){if(f.type!=="stylesheet"||(f.state.loading&4)!==0)u.flags&=-16777217;else if(u.flags|=16777216,!pF(f))if(Ht())u.flags|=8192;else throw In=hg,dg}function Ep(u,f){f!==null&&(u.flags|=4),u.flags&16384&&(f=u.tag!==22?jn():536870912,u.lanes|=f,Fo|=f)}function Og(u,f){if(!bi)switch(u.tailMode){case"hidden":f=u.tail;for(var g=null;f!==null;)f.alternate!==null&&(g=f),f=f.sibling;g===null?u.tail=null:g.sibling=null;break;case"collapsed":g=u.tail;for(var x=null;g!==null;)g.alternate!==null&&(x=g),g=g.sibling;x===null?f||u.tail===null?u.tail=null:u.tail.sibling=null:x.sibling=null}}function er(u){var f=u.alternate!==null&&u.alternate.child===u.child,g=0,x=0;if(f)for(var A=u.child;A!==null;)g|=A.lanes|A.childLanes,x|=A.subtreeFlags&65011712,x|=A.flags&65011712,A.return=u,A=A.sibling;else for(A=u.child;A!==null;)g|=A.lanes|A.childLanes,x|=A.subtreeFlags,x|=A.flags,A.return=u,A=A.sibling;return u.subtreeFlags|=x,u.childLanes=g,f}function hS(u,f,g){var x=f.pendingProps;switch(Tf(f),f.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return er(f),null;case 1:return er(f),null;case 3:return g=f.stateNode,x=null,u!==null&&(x=u.memoizedState.cache),f.memoizedState.cache!==x&&(f.flags|=2048),fl(Dn),Nt(),g.pendingContext&&(g.context=g.pendingContext,g.pendingContext=null),(u===null||u.child===null)&&(Ld(f)?Ka(f):u===null||u.memoizedState.isDehydrated&&(f.flags&256)===0||(f.flags|=1024,Ab())),er(f),null;case 26:var A=f.type,C=f.memoizedState;return u===null?(Ka(f),C!==null?(er(f),Cc(f,C)):(er(f),Lf(f,A,null,x,g))):C?C!==u.memoizedState?(Ka(f),er(f),Cc(f,C)):(er(f),f.flags&=-16777217):(u=u.memoizedProps,u!==x&&Ka(f),er(f),Lf(f,A,u,x,g)),null;case 27:if(fn(f),g=Ee.current,A=f.type,u!==null&&f.stateNode!=null)u.memoizedProps!==x&&Ka(f);else{if(!x){if(f.stateNode===null)throw Error(n(166));return er(f),null}u=Ie.current,Ld(f)?l_(f):(u=aF(A,x,g),f.stateNode=u,Ka(f))}return er(f),null;case 5:if(fn(f),A=f.type,u!==null&&f.stateNode!=null)u.memoizedProps!==x&&Ka(f);else{if(!x){if(f.stateNode===null)throw Error(n(166));return er(f),null}if(C=Ie.current,Ld(f))l_(f);else{var G=MM(Ee.current);switch(C){case 1:C=G.createElementNS("http://www.w3.org/2000/svg",A);break;case 2:C=G.createElementNS("http://www.w3.org/1998/Math/MathML",A);break;default:switch(A){case"svg":C=G.createElementNS("http://www.w3.org/2000/svg",A);break;case"math":C=G.createElementNS("http://www.w3.org/1998/Math/MathML",A);break;case"script":C=G.createElement("div"),C.innerHTML="<script><\/script>",C=C.removeChild(C.firstChild);break;case"select":C=typeof x.is=="string"?G.createElement("select",{is:x.is}):G.createElement("select"),x.multiple?C.multiple=!0:x.size&&(C.size=x.size);break;default:C=typeof x.is=="string"?G.createElement(A,{is:x.is}):G.createElement(A)}}C[pn]=f,C[W]=x;e:for(G=f.child;G!==null;){if(G.tag===5||G.tag===6)C.appendChild(G.stateNode);else if(G.tag!==4&&G.tag!==27&&G.child!==null){G.child.return=G,G=G.child;continue}if(G===f)break e;for(;G.sibling===null;){if(G.return===null||G.return===f)break e;G=G.return}G.sibling.return=G.return,G=G.sibling}f.stateNode=C;e:switch(Oa(C,A,x),A){case"button":case"input":case"select":case"textarea":x=!!x.autoFocus;break e;case"img":x=!0;break e;default:x=!1}x&&Ka(f)}}return er(f),Lf(f,f.type,u===null?null:u.memoizedProps,f.pendingProps,g),null;case 6:if(u&&f.stateNode!=null)u.memoizedProps!==x&&Ka(f);else{if(typeof x!="string"&&f.stateNode===null)throw Error(n(166));if(u=Ee.current,Ld(f)){if(u=f.stateNode,g=f.memoizedProps,x=null,A=Us,A!==null)switch(A.tag){case 27:case 5:x=A.memoizedProps}u[pn]=f,u=!!(u.nodeValue===g||x!==null&&x.suppressHydrationWarning===!0||YI(u.nodeValue,g)),u||di(f,!0)}else u=MM(u).createTextNode(x),u[pn]=f,f.stateNode=u}return er(f),null;case 31:if(g=f.memoizedState,u===null||u.memoizedState!==null){if(x=Ld(f),g!==null){if(u===null){if(!x)throw Error(n(318));if(u=f.memoizedState,u=u!==null?u.dehydrated:null,!u)throw Error(n(557));u[pn]=f}else Pd(),(f.flags&128)===0&&(f.memoizedState=null),f.flags|=4;er(f),u=!1}else g=Ab(),u!==null&&u.memoizedState!==null&&(u.memoizedState.hydrationErrors=g),u=!0;if(!u)return f.flags&256?(Ro(f),f):(Ro(f),null);if((f.flags&128)!==0)throw Error(n(558))}return er(f),null;case 13:if(x=f.memoizedState,u===null||u.memoizedState!==null&&u.memoizedState.dehydrated!==null){if(A=Ld(f),x!==null&&x.dehydrated!==null){if(u===null){if(!A)throw Error(n(318));if(A=f.memoizedState,A=A!==null?A.dehydrated:null,!A)throw Error(n(317));A[pn]=f}else Pd(),(f.flags&128)===0&&(f.memoizedState=null),f.flags|=4;er(f),A=!1}else A=Ab(),u!==null&&u.memoizedState!==null&&(u.memoizedState.hydrationErrors=A),A=!0;if(!A)return f.flags&256?(Ro(f),f):(Ro(f),null)}return Ro(f),(f.flags&128)!==0?(f.lanes=g,f):(g=x!==null,u=u!==null&&u.memoizedState!==null,g&&(x=f.child,A=null,x.alternate!==null&&x.alternate.memoizedState!==null&&x.alternate.memoizedState.cachePool!==null&&(A=x.alternate.memoizedState.cachePool.pool),C=null,x.memoizedState!==null&&x.memoizedState.cachePool!==null&&(C=x.memoizedState.cachePool.pool),C!==A&&(x.flags|=2048)),g!==u&&g&&(f.child.flags|=8192),Ep(f,f.updateQueue),er(f),null);case 4:return Nt(),u===null&&a2(f.stateNode.containerInfo),er(f),null;case 10:return fl(f.type),er(f),null;case 19:if(he(Gr),x=f.memoizedState,x===null)return er(f),null;if(A=(f.flags&128)!==0,C=x.rendering,C===null)if(A)Og(x,!1);else{if(ji!==0||u!==null&&(u.flags&128)!==0)for(u=f.child;u!==null;){if(C=p_(u),C!==null){for(f.flags|=128,Og(x,!1),u=C.updateQueue,f.updateQueue=u,Ep(f,u),f.subtreeFlags=0,u=g,g=f.child;g!==null;)oa(g,u),g=g.sibling;return Ce(Gr,Gr.current&1|2),bi&&vc(f,x.treeForkCount),f.child}u=u.sibling}x.tail!==null&&k()>zo&&(f.flags|=128,A=!0,Og(x,!1),f.lanes=4194304)}else{if(!A)if(u=p_(C),u!==null){if(f.flags|=128,A=!0,u=u.updateQueue,f.updateQueue=u,Ep(f,u),Og(x,!0),x.tail===null&&x.tailMode==="hidden"&&!C.alternate&&!bi)return er(f),null}else 2*k()-x.renderingStartTime>zo&&g!==536870912&&(f.flags|=128,A=!0,Og(x,!1),f.lanes=4194304);x.isBackwards?(C.sibling=f.child,f.child=C):(u=x.last,u!==null?u.sibling=C:f.child=C,x.last=C)}return x.tail!==null?(u=x.tail,x.rendering=u,x.tail=u.sibling,x.renderingStartTime=k(),u.sibling=null,g=Gr.current,Ce(Gr,A?g&1|2:g&1),bi&&vc(f,x.treeForkCount),u):(er(f),null);case 22:case 23:return Ro(f),ua(),x=f.memoizedState!==null,u!==null?u.memoizedState!==null!==x&&(f.flags|=8192):x&&(f.flags|=8192),x?(g&536870912)!==0&&(f.flags&128)===0&&(er(f),f.subtreeFlags&6&&(f.flags|=8192)):er(f),g=f.updateQueue,g!==null&&Ep(f,g.retryQueue),g=null,u!==null&&u.memoizedState!==null&&u.memoizedState.cachePool!==null&&(g=u.memoizedState.cachePool.pool),x=null,f.memoizedState!==null&&f.memoizedState.cachePool!==null&&(x=f.memoizedState.cachePool.pool),x!==g&&(f.flags|=2048),u!==null&&he(Mf),null;case 24:return g=null,u!==null&&(g=u.memoizedState.cache),f.memoizedState.cache!==g&&(f.flags|=2048),fl(Dn),er(f),null;case 25:return null;case 30:return null}throw Error(n(156,f.tag))}function N_(u,f){switch(Tf(f),f.tag){case 1:return u=f.flags,u&65536?(f.flags=u&-65537|128,f):null;case 3:return fl(Dn),Nt(),u=f.flags,(u&65536)!==0&&(u&128)===0?(f.flags=u&-65537|128,f):null;case 26:case 27:case 5:return fn(f),null;case 31:if(f.memoizedState!==null){if(Ro(f),f.alternate===null)throw Error(n(340));Pd()}return u=f.flags,u&65536?(f.flags=u&-65537|128,f):null;case 13:if(Ro(f),u=f.memoizedState,u!==null&&u.dehydrated!==null){if(f.alternate===null)throw Error(n(340));Pd()}return u=f.flags,u&65536?(f.flags=u&-65537|128,f):null;case 19:return he(Gr),null;case 4:return Nt(),null;case 10:return fl(f.type),null;case 22:case 23:return Ro(f),ua(),u!==null&&he(Mf),u=f.flags,u&65536?(f.flags=u&-65537|128,f):null;case 24:return fl(Dn),null;case 25:return null;default:return null}}function Wd(u,f){switch(Tf(f),f.tag){case 3:fl(Dn),Nt();break;case 26:case 27:case 5:fn(f);break;case 4:Nt();break;case 31:f.memoizedState!==null&&Ro(f);break;case 13:Ro(f);break;case 19:he(Gr);break;case 10:fl(f.type);break;case 22:case 23:Ro(f),ua(),u!==null&&he(Mf);break;case 24:fl(Dn)}}function Bu(u,f){try{var g=f.updateQueue,x=g!==null?g.lastEffect:null;if(x!==null){var A=x.next;g=A;do{if((g.tag&u)===u){x=void 0;var C=g.create,G=g.inst;x=C(),G.destroy=x}g=g.next}while(g!==A)}}catch(te){pr(f,f.return,te)}}function ml(u,f,g){try{var x=f.updateQueue,A=x!==null?x.lastEffect:null;if(A!==null){var C=A.next;x=C;do{if((x.tag&u)===u){var G=x.inst,te=G.destroy;if(te!==void 0){G.destroy=void 0,A=f;var _e=g,ke=te;try{ke()}catch(ot){pr(A,_e,ot)}}}x=x.next}while(x!==C)}}catch(ot){pr(f,f.return,ot)}}function Pf(u){var f=u.updateQueue;if(f!==null){var g=u.stateNode;try{js(f,g)}catch(x){pr(u,u.return,x)}}}function pS(u,f,g){g.props=Zs(u.type,u.memoizedProps),g.state=u.memoizedState;try{g.componentWillUnmount()}catch(x){pr(u,f,x)}}function Iu(u,f){try{var g=u.ref;if(g!==null){switch(u.tag){case 26:case 27:case 5:var x=u.stateNode;break;case 30:x=u.stateNode;break;default:x=u.stateNode}typeof g=="function"?u.refCleanup=g(x):g.current=x}}catch(A){pr(u,f,A)}}function Po(u,f){var g=u.ref,x=u.refCleanup;if(g!==null)if(typeof x=="function")try{x()}catch(A){pr(u,f,A)}finally{u.refCleanup=null,u=u.alternate,u!=null&&(u.refCleanup=null)}else if(typeof g=="function")try{g(null)}catch(A){pr(u,f,A)}else g.current=null}function Bo(u){var f=u.type,g=u.memoizedProps,x=u.stateNode;try{e:switch(f){case"button":case"input":case"select":case"textarea":g.autoFocus&&x.focus();break e;case"img":g.src?x.src=g.src:g.srcSet&&(x.srcset=g.srcSet)}}catch(A){pr(u,u.return,A)}}function gl(u,f,g){try{var x=u.stateNode;Xj(x,u.type,g,f),x[W]=f}catch(A){pr(u,u.return,A)}}function ys(u){return u.tag===5||u.tag===3||u.tag===26||u.tag===27&&Np(u.type)||u.tag===4}function Fu(u){e:for(;;){for(;u.sibling===null;){if(u.return===null||ys(u.return))return null;u=u.return}for(u.sibling.return=u.return,u=u.sibling;u.tag!==5&&u.tag!==6&&u.tag!==18;){if(u.tag===27&&Np(u.type)||u.flags&2||u.child===null||u.tag===4)continue e;u.child.return=u,u=u.child}if(!(u.flags&2))return u.stateNode}}function ii(u,f,g){var x=u.tag;if(x===5||x===6)u=u.stateNode,f?(g.nodeType===9?g.body:g.nodeName==="HTML"?g.ownerDocument.body:g).insertBefore(u,f):(f=g.nodeType===9?g.body:g.nodeName==="HTML"?g.ownerDocument.body:g,f.appendChild(u),g=g._reactRootContainer,g!=null||f.onclick!==null||(f.onclick=Tu));else if(x!==4&&(x===27&&Np(u.type)&&(g=u.stateNode,f=null),u=u.child,u!==null))for(ii(u,f,g),u=u.sibling;u!==null;)ii(u,f,g),u=u.sibling}function Gi(u,f,g){var x=u.tag;if(x===5||x===6)u=u.stateNode,f?g.insertBefore(u,f):g.appendChild(u);else if(x!==4&&(x===27&&Np(u.type)&&(g=u.stateNode),u=u.child,u!==null))for(Gi(u,f,g),u=u.sibling;u!==null;)Gi(u,f,g),u=u.sibling}function ts(u){var f=u.stateNode,g=u.memoizedProps;try{for(var x=u.type,A=f.attributes;A.length;)f.removeAttributeNode(A[0]);Oa(f,x,g),f[pn]=u,f[W]=g}catch(C){pr(u,u.return,C)}}var yl=!1,wr=!1,Nc=!1,Ug=typeof WeakSet=="function"?WeakSet:Set,Wr=null;function Mp(u,f){if(u=u.containerInfo,u2=OM,u=Qy(u),rp(u)){if("selectionStart"in u)var g={start:u.selectionStart,end:u.selectionEnd};else e:{g=(g=u.ownerDocument)&&g.defaultView||window;var x=g.getSelection&&g.getSelection();if(x&&x.rangeCount!==0){g=x.anchorNode;var A=x.anchorOffset,C=x.focusNode;x=x.focusOffset;try{g.nodeType,C.nodeType}catch{g=null;break e}var G=0,te=-1,_e=-1,ke=0,ot=0,xt=u,Xe=null;t:for(;;){for(var Qe;xt!==g||A!==0&&xt.nodeType!==3||(te=G+A),xt!==C||x!==0&&xt.nodeType!==3||(_e=G+x),xt.nodeType===3&&(G+=xt.nodeValue.length),(Qe=xt.firstChild)!==null;)Xe=xt,xt=Qe;for(;;){if(xt===u)break t;if(Xe===g&&++ke===A&&(te=G),Xe===C&&++ot===x&&(_e=G),(Qe=xt.nextSibling)!==null)break;xt=Xe,Xe=xt.parentNode}xt=Qe}g=te===-1||_e===-1?null:{start:te,end:_e}}else g=null}g=g||{start:0,end:0}}else g=null;for(c2={focusedElem:u,selectionRange:g},OM=!1,Wr=f;Wr!==null;)if(f=Wr,u=f.child,(f.subtreeFlags&1028)!==0&&u!==null)u.return=f,Wr=u;else for(;Wr!==null;){switch(f=Wr,C=f.alternate,u=f.flags,f.tag){case 0:if((u&4)!==0&&(u=f.updateQueue,u=u!==null?u.events:null,u!==null))for(g=0;g<u.length;g++)A=u[g],A.ref.impl=A.nextImpl;break;case 11:case 15:break;case 1:if((u&1024)!==0&&C!==null){u=void 0,g=f,A=C.memoizedProps,C=C.memoizedState,x=g.stateNode;try{var vn=Zs(g.type,A);u=x.getSnapshotBeforeUpdate(vn,C),x.__reactInternalSnapshotBeforeUpdate=u}catch(Hn){pr(g,g.return,Hn)}}break;case 3:if((u&1024)!==0){if(u=f.stateNode.containerInfo,g=u.nodeType,g===9)h2(u);else if(g===1)switch(u.nodeName){case"HEAD":case"HTML":case"BODY":h2(u);break;default:u.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((u&1024)!==0)throw Error(n(163))}if(u=f.sibling,u!==null){u.return=f.return,Wr=u;break}Wr=f.return}}function _M(u,f,g){var x=g.flags;switch(g.tag){case 0:case 11:case 15:Dc(u,g),x&4&&Bu(5,g);break;case 1:if(Dc(u,g),x&4)if(u=g.stateNode,f===null)try{u.componentDidMount()}catch(G){pr(g,g.return,G)}else{var A=Zs(g.type,f.memoizedProps);f=f.memoizedState;try{u.componentDidUpdate(A,f,u.__reactInternalSnapshotBeforeUpdate)}catch(G){pr(g,g.return,G)}}x&64&&Pf(g),x&512&&Iu(g,g.return);break;case 3:if(Dc(u,g),x&64&&(u=g.updateQueue,u!==null)){if(f=null,g.child!==null)switch(g.child.tag){case 27:case 5:f=g.child.stateNode;break;case 1:f=g.child.stateNode}try{js(u,f)}catch(G){pr(g,g.return,G)}}break;case 27:f===null&&x&4&&ts(g);case 26:case 5:Dc(u,g),f===null&&x&4&&Bo(g),x&512&&Iu(g,g.return);break;case 12:Dc(u,g);break;case 31:Dc(u,g),x&4&&O_(u,g);break;case 13:Dc(u,g),x&4&&mS(u,g),x&64&&(u=g.memoizedState,u!==null&&(u=u.dehydrated,u!==null&&(g=Lj.bind(null,g),eY(u,g))));break;case 22:if(x=g.memoizedState!==null||yl,!x){f=f!==null&&f.memoizedState!==null||wr,A=yl;var C=wr;yl=x,(wr=f)&&!C?Xi(u,g,(g.subtreeFlags&8772)!==0):Dc(u,g),yl=A,wr=C}break;case 30:break;default:Dc(u,g)}}function D_(u){var f=u.alternate;f!==null&&(u.alternate=null,D_(f)),u.child=null,u.deletions=null,u.sibling=null,u.tag===5&&(f=u.stateNode,f!==null&&ct(f)),u.stateNode=null,u.return=null,u.dependencies=null,u.memoizedProps=null,u.memoizedState=null,u.pendingProps=null,u.stateNode=null,u.updateQueue=null}var Di=null,_s=!1;function fa(u,f,g){for(g=g.child;g!==null;)Bf(u,f,g),g=g.sibling}function Bf(u,f,g){if(nt&&typeof nt.onCommitFiberUnmount=="function")try{nt.onCommitFiberUnmount(st,g)}catch{}switch(g.tag){case 26:wr||Po(g,f),fa(u,f,g),g.memoizedState?g.memoizedState.count--:g.stateNode&&(g=g.stateNode,g.parentNode.removeChild(g));break;case 27:wr||Po(g,f);var x=Di,A=_s;Np(g.type)&&(Di=g.stateNode,_s=!1),fa(u,f,g),vS(g.stateNode),Di=x,_s=A;break;case 5:wr||Po(g,f);case 6:if(x=Di,A=_s,Di=null,fa(u,f,g),Di=x,_s=A,Di!==null)if(_s)try{(Di.nodeType===9?Di.body:Di.nodeName==="HTML"?Di.ownerDocument.body:Di).removeChild(g.stateNode)}catch(C){pr(g,f,C)}else try{Di.removeChild(g.stateNode)}catch(C){pr(g,f,C)}break;case 18:Di!==null&&(_s?(u=Di,tF(u.nodeType===9?u.body:u.nodeName==="HTML"?u.ownerDocument.body:u,g.stateNode),H_(u)):tF(Di,g.stateNode));break;case 4:x=Di,A=_s,Di=g.stateNode.containerInfo,_s=!0,fa(u,f,g),Di=x,_s=A;break;case 0:case 11:case 14:case 15:ml(2,g,f),wr||ml(4,g,f),fa(u,f,g);break;case 1:wr||(Po(g,f),x=g.stateNode,typeof x.componentWillUnmount=="function"&&pS(g,f,x)),fa(u,f,g);break;case 21:fa(u,f,g);break;case 22:wr=(x=wr)||g.memoizedState!==null,fa(u,f,g),wr=x;break;default:fa(u,f,g)}}function O_(u,f){if(f.memoizedState===null&&(u=f.alternate,u!==null&&(u=u.memoizedState,u!==null))){u=u.dehydrated;try{H_(u)}catch(g){pr(f,f.return,g)}}}function mS(u,f){if(f.memoizedState===null&&(u=f.alternate,u!==null&&(u=u.memoizedState,u!==null&&(u=u.dehydrated,u!==null))))try{H_(u)}catch(g){pr(f,f.return,g)}}function vM(u){switch(u.tag){case 31:case 13:case 19:var f=u.stateNode;return f===null&&(f=u.stateNode=new Ug),f;case 22:return u=u.stateNode,f=u._retryCache,f===null&&(f=u._retryCache=new Ug),f;default:throw Error(n(435,u.tag))}}function ns(u,f){var g=vM(u);f.forEach(function(x){if(!g.has(x)){g.add(x);var A=Pj.bind(null,u,x);x.then(A,A)}})}function da(u,f){var g=f.deletions;if(g!==null)for(var x=0;x<g.length;x++){var A=g[x],C=u,G=f,te=G;e:for(;te!==null;){switch(te.tag){case 27:if(Np(te.type)){Di=te.stateNode,_s=!1;break e}break;case 5:Di=te.stateNode,_s=!1;break e;case 3:case 4:Di=te.stateNode.containerInfo,_s=!0;break e}te=te.return}if(Di===null)throw Error(n(160));Bf(C,G,A),Di=null,_s=!1,C=A.alternate,C!==null&&(C.return=null),A.return=null}if(f.subtreeFlags&13886)for(f=f.child;f!==null;)If(f,u),f=f.sibling}var Qa=null;function If(u,f){var g=u.alternate,x=u.flags;switch(u.tag){case 0:case 11:case 14:case 15:da(f,u),qr(u),x&4&&(ml(3,u,u.return),Bu(3,u),ml(5,u,u.return));break;case 1:da(f,u),qr(u),x&512&&(wr||g===null||Po(g,g.return)),x&64&&yl&&(u=u.updateQueue,u!==null&&(x=u.callbacks,x!==null&&(g=u.shared.hiddenCallbacks,u.shared.hiddenCallbacks=g===null?x:g.concat(x))));break;case 26:var A=Qa;if(da(f,u),qr(u),x&512&&(wr||g===null||Po(g,g.return)),x&4){var C=g!==null?g.memoizedState:null;if(x=u.memoizedState,g===null)if(x===null)if(u.stateNode===null){e:{x=u.type,g=u.memoizedProps,A=A.ownerDocument||A;t:switch(x){case"title":C=A.getElementsByTagName("title")[0],(!C||C[_t]||C[pn]||C.namespaceURI==="http://www.w3.org/2000/svg"||C.hasAttribute("itemprop"))&&(C=A.createElement(x),A.head.insertBefore(C,A.querySelector("head > title"))),Oa(C,x,g),C[pn]=u,$(C),x=C;break e;case"link":var G=dF("link","href",A).get(x+(g.href||""));if(G){for(var te=0;te<G.length;te++)if(C=G[te],C.getAttribute("href")===(g.href==null||g.href===""?null:g.href)&&C.getAttribute("rel")===(g.rel==null?null:g.rel)&&C.getAttribute("title")===(g.title==null?null:g.title)&&C.getAttribute("crossorigin")===(g.crossOrigin==null?null:g.crossOrigin)){G.splice(te,1);break t}}C=A.createElement(x),Oa(C,x,g),A.head.appendChild(C);break;case"meta":if(G=dF("meta","content",A).get(x+(g.content||""))){for(te=0;te<G.length;te++)if(C=G[te],C.getAttribute("content")===(g.content==null?null:""+g.content)&&C.getAttribute("name")===(g.name==null?null:g.name)&&C.getAttribute("property")===(g.property==null?null:g.property)&&C.getAttribute("http-equiv")===(g.httpEquiv==null?null:g.httpEquiv)&&C.getAttribute("charset")===(g.charSet==null?null:g.charSet)){G.splice(te,1);break t}}C=A.createElement(x),Oa(C,x,g),A.head.appendChild(C);break;default:throw Error(n(468,x))}C[pn]=u,$(C),x=C}u.stateNode=x}else hF(A,u.type,u.stateNode);else u.stateNode=fF(A,x,u.memoizedProps);else C!==x?(C===null?g.stateNode!==null&&(g=g.stateNode,g.parentNode.removeChild(g)):C.count--,x===null?hF(A,u.type,u.stateNode):fF(A,x,u.memoizedProps)):x===null&&u.stateNode!==null&&gl(u,u.memoizedProps,g.memoizedProps)}break;case 27:da(f,u),qr(u),x&512&&(wr||g===null||Po(g,g.return)),g!==null&&x&4&&gl(u,u.memoizedProps,g.memoizedProps);break;case 5:if(da(f,u),qr(u),x&512&&(wr||g===null||Po(g,g.return)),u.flags&32){A=u.stateNode;try{hs(A,"")}catch(vn){pr(u,u.return,vn)}}x&4&&u.stateNode!=null&&(A=u.memoizedProps,gl(u,A,g!==null?g.memoizedProps:A)),x&1024&&(Nc=!0);break;case 6:if(da(f,u),qr(u),x&4){if(u.stateNode===null)throw Error(n(162));x=u.memoizedProps,g=u.stateNode;try{g.nodeValue=x}catch(vn){pr(u,u.return,vn)}}break;case 3:if(RM=null,A=Qa,Qa=AM(f.containerInfo),da(f,u),Qa=A,qr(u),x&4&&g!==null&&g.memoizedState.isDehydrated)try{H_(f.containerInfo)}catch(vn){pr(u,u.return,vn)}Nc&&(Nc=!1,xM(u));break;case 4:x=Qa,Qa=AM(u.stateNode.containerInfo),da(f,u),qr(u),Qa=x;break;case 12:da(f,u),qr(u);break;case 31:da(f,u),qr(u),x&4&&(x=u.updateQueue,x!==null&&(u.updateQueue=null,ns(u,x)));break;case 13:da(f,u),qr(u),u.child.flags&8192&&u.memoizedState!==null!=(g!==null&&g.memoizedState!==null)&&(Lc=k()),x&4&&(x=u.updateQueue,x!==null&&(u.updateQueue=null,ns(u,x)));break;case 22:A=u.memoizedState!==null;var _e=g!==null&&g.memoizedState!==null,ke=yl,ot=wr;if(yl=ke||A,wr=ot||_e,da(f,u),wr=ot,yl=ke,qr(u),x&8192)e:for(f=u.stateNode,f._visibility=A?f._visibility&-2:f._visibility|1,A&&(g===null||_e||yl||wr||qd(u)),g=null,f=u;;){if(f.tag===5||f.tag===26){if(g===null){_e=g=f;try{if(C=_e.stateNode,A)G=C.style,typeof G.setProperty=="function"?G.setProperty("display","none","important"):G.display="none";else{te=_e.stateNode;var xt=_e.memoizedProps.style,Xe=xt!=null&&xt.hasOwnProperty("display")?xt.display:null;te.style.display=Xe==null||typeof Xe=="boolean"?"":(""+Xe).trim()}}catch(vn){pr(_e,_e.return,vn)}}}else if(f.tag===6){if(g===null){_e=f;try{_e.stateNode.nodeValue=A?"":_e.memoizedProps}catch(vn){pr(_e,_e.return,vn)}}}else if(f.tag===18){if(g===null){_e=f;try{var Qe=_e.stateNode;A?nF(Qe,!0):nF(_e.stateNode,!1)}catch(vn){pr(_e,_e.return,vn)}}}else if((f.tag!==22&&f.tag!==23||f.memoizedState===null||f===u)&&f.child!==null){f.child.return=f,f=f.child;continue}if(f===u)break e;for(;f.sibling===null;){if(f.return===null||f.return===u)break e;g===f&&(g=null),f=f.return}g===f&&(g=null),f.sibling.return=f.return,f=f.sibling}x&4&&(x=u.updateQueue,x!==null&&(g=x.retryQueue,g!==null&&(x.retryQueue=null,ns(u,g))));break;case 19:da(f,u),qr(u),x&4&&(x=u.updateQueue,x!==null&&(u.updateQueue=null,ns(u,x)));break;case 30:break;case 21:break;default:da(f,u),qr(u)}}function qr(u){var f=u.flags;if(f&2){try{for(var g,x=u.return;x!==null;){if(ys(x)){g=x;break}x=x.return}if(g==null)throw Error(n(160));switch(g.tag){case 27:var A=g.stateNode,C=Fu(u);Gi(u,C,A);break;case 5:var G=g.stateNode;g.flags&32&&(hs(G,""),g.flags&=-33);var te=Fu(u);Gi(u,te,G);break;case 3:case 4:var _e=g.stateNode.containerInfo,ke=Fu(u);ii(u,ke,_e);break;default:throw Error(n(161))}}catch(ot){pr(u,u.return,ot)}u.flags&=-3}f&4096&&(u.flags&=-4097)}function xM(u){if(u.subtreeFlags&1024)for(u=u.child;u!==null;){var f=u;xM(f),f.tag===5&&f.flags&1024&&f.stateNode.reset(),u=u.sibling}}function Dc(u,f){if(f.subtreeFlags&8772)for(f=f.child;f!==null;)_M(u,f.alternate,f),f=f.sibling}function qd(u){for(u=u.child;u!==null;){var f=u;switch(f.tag){case 0:case 11:case 14:case 15:ml(4,f,f.return),qd(f);break;case 1:Po(f,f.return);var g=f.stateNode;typeof g.componentWillUnmount=="function"&&pS(f,f.return,g),qd(f);break;case 27:vS(f.stateNode);case 26:case 5:Po(f,f.return),qd(f);break;case 22:f.memoizedState===null&&qd(f);break;case 30:qd(f);break;default:qd(f)}u=u.sibling}}function Xi(u,f,g){for(g=g&&(f.subtreeFlags&8772)!==0,f=f.child;f!==null;){var x=f.alternate,A=u,C=f,G=C.flags;switch(C.tag){case 0:case 11:case 15:Xi(A,C,g),Bu(4,C);break;case 1:if(Xi(A,C,g),x=C,A=x.stateNode,typeof A.componentDidMount=="function")try{A.componentDidMount()}catch(ke){pr(x,x.return,ke)}if(x=C,A=x.updateQueue,A!==null){var te=x.stateNode;try{var _e=A.shared.hiddenCallbacks;if(_e!==null)for(A.shared.hiddenCallbacks=null,A=0;A<_e.length;A++)Ou(_e[A],te)}catch(ke){pr(x,x.return,ke)}}g&&G&64&&Pf(C),Iu(C,C.return);break;case 27:ts(C);case 26:case 5:Xi(A,C,g),g&&x===null&&G&4&&Bo(C),Iu(C,C.return);break;case 12:Xi(A,C,g);break;case 31:Xi(A,C,g),g&&G&4&&O_(A,C);break;case 13:Xi(A,C,g),g&&G&4&&mS(A,C);break;case 22:C.memoizedState===null&&Xi(A,C,g),Iu(C,C.return);break;case 30:break;default:Xi(A,C,g)}f=f.sibling}}function U_(u,f){var g=null;u!==null&&u.memoizedState!==null&&u.memoizedState.cachePool!==null&&(g=u.memoizedState.cachePool.pool),u=null,f.memoizedState!==null&&f.memoizedState.cachePool!==null&&(u=f.memoizedState.cachePool.pool),u!==g&&(u!=null&&u.refCount++,g!=null&&$s(g))}function Oc(u,f){u=null,f.alternate!==null&&(u=f.alternate.memoizedState.cache),f=f.memoizedState.cache,f!==u&&(f.refCount++,u!=null&&$s(u))}function Es(u,f,g,x){if(f.subtreeFlags&10256)for(f=f.child;f!==null;)Lr(u,f,g,x),f=f.sibling}function Lr(u,f,g,x){var A=f.flags;switch(f.tag){case 0:case 11:case 15:Es(u,f,g,x),A&2048&&Bu(9,f);break;case 1:Es(u,f,g,x);break;case 3:Es(u,f,g,x),A&2048&&(u=null,f.alternate!==null&&(u=f.alternate.memoizedState.cache),f=f.memoizedState.cache,f!==u&&(f.refCount++,u!=null&&$s(u)));break;case 12:if(A&2048){Es(u,f,g,x),u=f.stateNode;try{var C=f.memoizedProps,G=C.id,te=C.onPostCommit;typeof te=="function"&&te(G,f.alternate===null?"mount":"update",u.passiveEffectDuration,-0)}catch(_e){pr(f,f.return,_e)}}else Es(u,f,g,x);break;case 31:Es(u,f,g,x);break;case 13:Es(u,f,g,x);break;case 23:break;case 22:C=f.stateNode,G=f.alternate,f.memoizedState!==null?C._visibility&2?Es(u,f,g,x):Ap(u,f):C._visibility&2?Es(u,f,g,x):(C._visibility|=2,Ff(u,f,g,x,(f.subtreeFlags&10256)!==0||!1)),A&2048&&U_(G,f);break;case 24:Es(u,f,g,x),A&2048&&Oc(f.alternate,f);break;default:Es(u,f,g,x)}}function Ff(u,f,g,x,A){for(A=A&&((f.subtreeFlags&10256)!==0||!1),f=f.child;f!==null;){var C=u,G=f,te=g,_e=x,ke=G.flags;switch(G.tag){case 0:case 11:case 15:Ff(C,G,te,_e,A),Bu(8,G);break;case 23:break;case 22:var ot=G.stateNode;G.memoizedState!==null?ot._visibility&2?Ff(C,G,te,_e,A):Ap(C,G):(ot._visibility|=2,Ff(C,G,te,_e,A)),A&&ke&2048&&U_(G.alternate,G);break;case 24:Ff(C,G,te,_e,A),A&&ke&2048&&Oc(G.alternate,G);break;default:Ff(C,G,te,_e,A)}f=f.sibling}}function Ap(u,f){if(f.subtreeFlags&10256)for(f=f.child;f!==null;){var g=u,x=f,A=x.flags;switch(x.tag){case 22:Ap(g,x),A&2048&&U_(x.alternate,x);break;case 24:Ap(g,x),A&2048&&Oc(x.alternate,x);break;default:Ap(g,x)}f=f.sibling}}var Xr=8192;function Xd(u,f,g){if(u.subtreeFlags&Xr)for(u=u.child;u!==null;)is(u,f,g),u=u.sibling}function is(u,f,g){switch(u.tag){case 26:Xd(u,f,g),u.flags&Xr&&u.memoizedState!==null&&dY(g,Qa,u.memoizedState,u.memoizedProps);break;case 5:Xd(u,f,g);break;case 3:case 4:var x=Qa;Qa=AM(u.stateNode.containerInfo),Xd(u,f,g),Qa=x;break;case 22:u.memoizedState===null&&(x=u.alternate,x!==null&&x.memoizedState!==null?(x=Xr,Xr=16777216,Xd(u,f,g),Xr=x):Xd(u,f,g));break;default:Xd(u,f,g)}}function Ja(u){var f=u.alternate;if(f!==null&&(u=f.child,u!==null)){f.child=null;do f=u.sibling,u.sibling=null,u=f;while(u!==null)}}function Na(u){var f=u.deletions;if((u.flags&16)!==0){if(f!==null)for(var g=0;g<f.length;g++){var x=f[g];Wr=x,Lg(x,u)}Ja(u)}if(u.subtreeFlags&10256)for(u=u.child;u!==null;)$d(u),u=u.sibling}function $d(u){switch(u.tag){case 0:case 11:case 15:Na(u),u.flags&2048&&ml(9,u,u.return);break;case 3:Na(u);break;case 12:Na(u);break;case 22:var f=u.stateNode;u.memoizedState!==null&&f._visibility&2&&(u.return===null||u.return.tag!==13)?(f._visibility&=-3,L_(u)):Na(u);break;default:Na(u)}}function L_(u){var f=u.deletions;if((u.flags&16)!==0){if(f!==null)for(var g=0;g<f.length;g++){var x=f[g];Wr=x,Lg(x,u)}Ja(u)}for(u=u.child;u!==null;){switch(f=u,f.tag){case 0:case 11:case 15:ml(8,f,f.return),L_(f);break;case 22:g=f.stateNode,g._visibility&2&&(g._visibility&=-3,L_(f));break;default:L_(f)}u=u.sibling}}function Lg(u,f){for(;Wr!==null;){var g=Wr;switch(g.tag){case 0:case 11:case 15:ml(8,g,f);break;case 23:case 22:if(g.memoizedState!==null&&g.memoizedState.cachePool!==null){var x=g.memoizedState.cachePool.pool;x!=null&&x.refCount++}break;case 24:$s(g.memoizedState.cache)}if(x=g.child,x!==null)x.return=g,Wr=x;else e:for(g=u;Wr!==null;){x=Wr;var A=x.sibling,C=x.return;if(D_(x),x===g){Wr=null;break e}if(A!==null){A.return=C,Wr=A;break e}Wr=C}}}var P_={getCacheForType:function(u){var f=Ps(Dn),g=f.data.get(u);return g===void 0&&(g=u(),f.data.set(u,g)),g},cacheSignal:function(){return Ps(Dn).controller.signal}},B_=typeof WeakMap=="function"?WeakMap:Map,Mi=0,$i=null,ri=null,hi=0,On=0,ci=null,Jn=!1,oi=!1,lr=!1,rs=0,ji=0,Io=0,Uc=0,Zl=0,Ai=0,Fo=0,Kl=null,ha=null,eo=!1,Lc=0,wp=0,zo=1/0,Rp=null,zu=null,Pr=0,Ql=null,Vo=null,_l=0,Pc=0,jd=null,I_=null,Yd=0,Zd=null;function Da(){return(Mi&2)!==0&&hi!==0?hi&-hi:V.T!==null?n2():Un()}function h(){if(Ai===0)if((hi&536870912)===0||bi){var u=lt;lt<<=1,(lt&3932160)===0&&(lt=262144),Ai=u}else Ai=536870912;return u=Ts.current,u!==null&&(u.flags|=32),Ai}function m(u,f,g){(u===$i&&(On===2||On===9)||u.cancelPendingCommit!==null)&&(Le(u,0),z(u,hi,Ai,!1)),nn(u,g),((Mi&2)===0||u!==$i)&&(u===$i&&((Mi&2)===0&&(Uc|=g),ji===4&&z(u,hi,Ai,!1)),zf(u))}function S(u,f,g){if((Mi&6)!==0)throw Error(n(327));var x=!g&&(f&127)===0&&(f&u.expiredLanes)===0||Tt(u,f),A=x?Kd(u,f):to(u,f,!0),C=x;do{if(A===0){oi&&!x&&z(u,f,0,!1);break}else{if(g=u.current.alternate,C&&!D(g)){A=to(u,f,!1),C=!1;continue}if(A===2){if(C=f,u.errorRecoveryDisabledLanes&C)var G=0;else G=u.pendingLanes&-536870913,G=G!==0?G:G&536870912?536870912:0;if(G!==0){f=G;e:{var te=u;A=Kl;var _e=te.current.memoizedState.isDehydrated;if(_e&&(Le(te,G).flags|=256),G=to(te,G,!1),G!==2){if(lr&&!_e){te.errorRecoveryDisabledLanes|=C,Uc|=C,A=4;break e}C=ha,ha=A,C!==null&&(ha===null?ha=C:ha.push.apply(ha,C))}A=G}if(C=!1,A!==2)continue}}if(A===1){Le(u,0),z(u,f,0,!0);break}e:{switch(x=u,C=A,C){case 0:case 1:throw Error(n(345));case 4:if((f&4194048)!==f)break;case 6:z(x,f,Ai,!Jn);break e;case 2:ha=null;break;case 3:case 5:break;default:throw Error(n(329))}if((f&62914560)===f&&(A=Lc+300-k(),10<A)){if(z(x,f,Ai,!Jn),it(x,0,!0)!==0)break e;_l=f,x.timeoutHandle=JI(w.bind(null,x,g,ha,Rp,eo,f,Ai,Uc,Fo,Jn,C,"Throttled",-0,0),A);break e}w(x,g,ha,Rp,eo,f,Ai,Uc,Fo,Jn,C,null,-0,0)}}break}while(!0);zf(u)}function w(u,f,g,x,A,C,G,te,_e,ke,ot,xt,Xe,Qe){if(u.timeoutHandle=-1,xt=f.subtreeFlags,xt&8192||(xt&16785408)===16785408){xt={stylesheets:null,count:0,imgCount:0,imgBytes:0,suspenseyImages:[],waitingForImages:!0,waitingForViewTransition:!1,unsuspend:Tu},is(f,C,xt);var vn=(C&62914560)===C?Lc-k():(C&4194048)===C?wp-k():0;if(vn=hY(xt,vn),vn!==null){_l=C,u.cancelPendingCommit=vn(Xn.bind(null,u,f,C,g,x,A,G,te,_e,ot,xt,null,Xe,Qe)),z(u,C,G,!ke);return}}Xn(u,f,C,g,x,A,G,te,_e)}function D(u){for(var f=u;;){var g=f.tag;if((g===0||g===11||g===15)&&f.flags&16384&&(g=f.updateQueue,g!==null&&(g=g.stores,g!==null)))for(var x=0;x<g.length;x++){var A=g[x],C=A.getSnapshot;A=A.value;try{if(!Mr(C(),A))return!1}catch{return!1}}if(g=f.child,f.subtreeFlags&16384&&g!==null)g.return=f,f=g;else{if(f===u)break;for(;f.sibling===null;){if(f.return===null||f.return===u)return!0;f=f.return}f.sibling.return=f.return,f=f.sibling}}return!0}function z(u,f,g,x){f&=~Zl,f&=~Uc,u.suspendedLanes|=f,u.pingedLanes&=~f,x&&(u.warmLanes|=f),x=u.expirationTimes;for(var A=f;0<A;){var C=31-ue(A),G=1<<C;x[C]=-1,A&=~G}g!==0&&Zt(u,g,f)}function ie(){return(Mi&6)===0?(gS(0),!1):!0}function ye(){if(ri!==null){if(On===0)var u=ri.return;else u=ri,la=bc=null,Xb(u),wf=null,Rf=0,u=ri;for(;u!==null;)Wd(u.alternate,u),u=u.return;ri=null}}function Le(u,f){var g=u.timeoutHandle;g!==-1&&(u.timeoutHandle=-1,Yj(g)),g=u.cancelPendingCommit,g!==null&&(u.cancelPendingCommit=null,g()),_l=0,ye(),$i=u,ri=g=Au(u.current,null),hi=f,On=0,ci=null,Jn=!1,oi=Tt(u,f),lr=!1,Fo=Ai=Zl=Uc=Io=ji=0,ha=Kl=null,eo=!1,(f&8)!==0&&(f|=f&32);var x=u.entangledLanes;if(x!==0)for(u=u.entanglements,x&=f;0<x;){var A=31-ue(x),C=1<<A;f|=u[A],x&=~C}return rs=f,xf(),g}function ft(u,f){qn=null,V.H=Sg,f===Af||f===Xl?(f=f_(),On=3):f===dg?(f=f_(),On=4):On=f===R_?8:f!==null&&typeof f=="object"&&typeof f.then=="function"?6:1,ci=f,ri===null&&(ji=1,w_(u,Xa(f,u.current)))}function Ht(){var u=Ts.current;return u===null?!0:(hi&4194048)===hi?dl===null:(hi&62914560)===hi||(hi&536870912)!==0?u===dl:!1}function rn(){var u=V.H;return V.H=Sg,u===null?Sg:u}function cn(){var u=V.A;return V.A=P_,u}function Kn(){ji=4,Jn||(hi&4194048)!==hi&&Ts.current!==null||(oi=!0),(Io&134217727)===0&&(Uc&134217727)===0||$i===null||z($i,hi,Ai,!1)}function to(u,f,g){var x=Mi;Mi|=2;var A=rn(),C=cn();($i!==u||hi!==f)&&(Rp=null,Le(u,f)),f=!1;var G=ji;e:do try{if(On!==0&&ri!==null){var te=ri,_e=ci;switch(On){case 8:ye(),G=6;break e;case 3:case 2:case 9:case 6:Ts.current===null&&(f=!0);var ke=On;if(On=0,ci=null,Ut(u,te,_e,ke),g&&oi){G=0;break e}break;default:ke=On,On=0,ci=null,Ut(u,te,_e,ke)}}Pg(),G=ji;break}catch(ot){ft(u,ot)}while(!0);return f&&u.shellSuspendCounter++,la=bc=null,Mi=x,V.H=A,V.A=C,ri===null&&($i=null,hi=0,xf()),G}function Pg(){for(;ri!==null;)Oe(ri)}function Kd(u,f){var g=Mi;Mi|=2;var x=rn(),A=cn();$i!==u||hi!==f?(Rp=null,zo=k()+500,Le(u,f)):oi=Tt(u,f);e:do try{if(On!==0&&ri!==null){f=ri;var C=ci;t:switch(On){case 1:On=0,ci=null,Ut(u,f,C,1);break;case 2:case 9:if(qE(C)){On=0,ci=null,Ye(f);break}f=function(){On!==2&&On!==9||$i!==u||(On=7),zf(u)},C.then(f,f);break e;case 3:On=7;break e;case 4:On=5;break e;case 7:qE(C)?(On=0,ci=null,Ye(f)):(On=0,ci=null,Ut(u,f,C,7));break;case 5:var G=null;switch(ri.tag){case 26:G=ri.memoizedState;case 5:case 27:var te=ri;if(G?pF(G):te.stateNode.complete){On=0,ci=null;var _e=te.sibling;if(_e!==null)ri=_e;else{var ke=te.return;ke!==null?(ri=ke,Rn(ke)):ri=null}break t}}On=0,ci=null,Ut(u,f,C,5);break;case 6:On=0,ci=null,Ut(u,f,C,6);break;case 8:ye(),ji=6;break e;default:throw Error(n(462))}}We();break}catch(ot){ft(u,ot)}while(!0);return la=bc=null,V.H=x,V.A=A,Mi=g,ri!==null?0:($i=null,hi=0,xf(),ji)}function We(){for(;ri!==null&&!wt();)Oe(ri)}function Oe(u){var f=C_(u.alternate,u,rs);u.memoizedProps=u.pendingProps,f===null?Rn(u):ri=f}function Ye(u){var f=u,g=f.alternate;switch(f.tag){case 15:case 0:f=ca(g,f,f.pendingProps,f.type,void 0,hi);break;case 11:f=ca(g,f,f.pendingProps,f.type.render,f.ref,hi);break;case 5:Xb(f);default:Wd(g,f),f=ri=oa(f,rs),f=C_(g,f,rs)}u.memoizedProps=u.pendingProps,f===null?Rn(u):ri=f}function Ut(u,f,g,x){la=bc=null,Xb(f),wf=null,Rf=0;var A=f.return;try{if(No(u,A,f,g,hi)){ji=1,w_(u,Xa(g,u.current)),ri=null;return}}catch(C){if(A!==null)throw ri=A,C;ji=1,w_(u,Xa(g,u.current)),ri=null;return}f.flags&32768?(bi||x===1?u=!0:oi||(hi&536870912)!==0?u=!1:(Jn=u=!0,(x===2||x===9||x===3||x===6)&&(x=Ts.current,x!==null&&x.tag===13&&(x.flags|=16384))),_r(f,u)):Rn(f)}function Rn(u){var f=u;do{if((f.flags&32768)!==0){_r(f,Jn);return}u=f.return;var g=hS(f.alternate,f,rs);if(g!==null){ri=g;return}if(f=f.sibling,f!==null){ri=f;return}ri=f=u}while(f!==null);ji===0&&(ji=5)}function _r(u,f){do{var g=N_(u.alternate,u);if(g!==null){g.flags&=32767,ri=g;return}if(g=u.return,g!==null&&(g.flags|=32768,g.subtreeFlags=0,g.deletions=null),!f&&(u=u.sibling,u!==null)){ri=u;return}ri=u=g}while(u!==null);ji=6,ri=null}function Xn(u,f,g,x,A,C,G,te,_e){u.cancelPendingCommit=null;do F_();while(Pr!==0);if((Mi&6)!==0)throw Error(n(327));if(f!==null){if(f===u.current)throw Error(n(177));if(C=f.lanes|f.childLanes,C|=i_,Bn(u,g,C,G,te,_e),u===$i&&(ri=$i=null,hi=0),Vo=f,Ql=u,_l=g,Pc=C,jd=A,I_=x,(f.subtreeFlags&10256)!==0||(f.flags&10256)!==0?(u.callbackNode=null,u.callbackPriority=0,Bj(ze,function(){return BI(),null})):(u.callbackNode=null,u.callbackPriority=0),x=(f.flags&13878)!==0,(f.subtreeFlags&13878)!==0||x){x=V.T,V.T=null,A=X.p,X.p=2,G=Mi,Mi|=4;try{Mp(u,f,g)}finally{Mi=G,X.p=A,V.T=x}}Pr=1,Oi(),Ms(),Ui()}}function Oi(){if(Pr===1){Pr=0;var u=Ql,f=Vo,g=(f.flags&13878)!==0;if((f.subtreeFlags&13878)!==0||g){g=V.T,V.T=null;var x=X.p;X.p=2;var A=Mi;Mi|=4;try{If(f,u);var C=c2,G=Qy(u.containerInfo),te=C.focusedElem,_e=C.selectionRange;if(G!==te&&te&&te.ownerDocument&&Ky(te.ownerDocument.documentElement,te)){if(_e!==null&&rp(te)){var ke=_e.start,ot=_e.end;if(ot===void 0&&(ot=ke),"selectionStart"in te)te.selectionStart=ke,te.selectionEnd=Math.min(ot,te.value.length);else{var xt=te.ownerDocument||document,Xe=xt&&xt.defaultView||window;if(Xe.getSelection){var Qe=Xe.getSelection(),vn=te.textContent.length,Hn=Math.min(_e.start,vn),xr=_e.end===void 0?Hn:Math.min(_e.end,vn);!Qe.extend&&Hn>xr&&(G=xr,xr=Hn,Hn=G);var Ue=bb(te,Hn),we=bb(te,xr);if(Ue&&we&&(Qe.rangeCount!==1||Qe.anchorNode!==Ue.node||Qe.anchorOffset!==Ue.offset||Qe.focusNode!==we.node||Qe.focusOffset!==we.offset)){var Ge=xt.createRange();Ge.setStart(Ue.node,Ue.offset),Qe.removeAllRanges(),Hn>xr?(Qe.addRange(Ge),Qe.extend(we.node,we.offset)):(Ge.setEnd(we.node,we.offset),Qe.addRange(Ge))}}}}for(xt=[],Qe=te;Qe=Qe.parentNode;)Qe.nodeType===1&&xt.push({element:Qe,left:Qe.scrollLeft,top:Qe.scrollTop});for(typeof te.focus=="function"&&te.focus(),te=0;te<xt.length;te++){var yt=xt[te];yt.element.scrollLeft=yt.left,yt.element.scrollTop=yt.top}}OM=!!u2,c2=u2=null}finally{Mi=A,X.p=x,V.T=g}}u.current=f,Pr=2}}function Ms(){if(Pr===2){Pr=0;var u=Ql,f=Vo,g=(f.flags&8772)!==0;if((f.subtreeFlags&8772)!==0||g){g=V.T,V.T=null;var x=X.p;X.p=2;var A=Mi;Mi|=4;try{_M(u,f.alternate,f)}finally{Mi=A,X.p=x,V.T=g}}Pr=3}}function Ui(){if(Pr===4||Pr===3){Pr=0,Z();var u=Ql,f=Vo,g=_l,x=I_;(f.subtreeFlags&10256)!==0||(f.flags&10256)!==0?Pr=5:(Pr=0,Vo=Ql=null,Bc(u,u.pendingLanes));var A=u.pendingLanes;if(A===0&&(zu=null),Bi(g),f=f.stateNode,nt&&typeof nt.onCommitFiberRoot=="function")try{nt.onCommitFiberRoot(st,f,void 0,(f.current.flags&128)===128)}catch{}if(x!==null){f=V.T,A=X.p,X.p=2,V.T=null;try{for(var C=u.onRecoverableError,G=0;G<x.length;G++){var te=x[G];C(te.value,{componentStack:te.stack})}}finally{V.T=f,X.p=A}}(_l&3)!==0&&F_(),zf(u),A=u.pendingLanes,(g&261930)!==0&&(A&42)!==0?u===Zd?Yd++:(Yd=0,Zd=u):Yd=0,gS(0)}}function Bc(u,f){(u.pooledCacheLanes&=f)===0&&(f=u.pooledCache,f!=null&&(u.pooledCache=null,$s(f)))}function F_(){return Oi(),Ms(),Ui(),BI()}function BI(){if(Pr!==5)return!1;var u=Ql,f=Pc;Pc=0;var g=Bi(_l),x=V.T,A=X.p;try{X.p=32>g?32:g,V.T=null,g=jd,jd=null;var C=Ql,G=_l;if(Pr=0,Vo=Ql=null,_l=0,(Mi&6)!==0)throw Error(n(331));var te=Mi;if(Mi|=4,$d(C.current),Lr(C,C.current,G,g),Mi=te,gS(0,!1),nt&&typeof nt.onPostCommitFiberRoot=="function")try{nt.onPostCommitFiberRoot(st,C)}catch{}return!0}finally{X.p=A,V.T=x,Bc(u,f)}}function II(u,f,g){f=Xa(g,f),f=dS(u.stateNode,f,2),u=Mc(u,f,2),u!==null&&(nn(u,2),zf(u))}function pr(u,f,g){if(u.tag===3)II(u,u,g);else for(;f!==null;){if(f.tag===3){II(f,u,g);break}else if(f.tag===1){var x=f.stateNode;if(typeof f.type.getDerivedStateFromError=="function"||typeof x.componentDidCatch=="function"&&(zu===null||!zu.has(x))){u=Xa(g,u),g=xp(2),x=Mc(f,g,2),x!==null&&(Za(g,x,f,u),nn(x,2),zf(x));break}}f=f.return}}function JN(u,f,g){var x=u.pingCache;if(x===null){x=u.pingCache=new B_;var A=new Set;x.set(f,A)}else A=x.get(f),A===void 0&&(A=new Set,x.set(f,A));A.has(g)||(lr=!0,A.add(g),u=Uj.bind(null,u,f,g),f.then(u,u))}function Uj(u,f,g){var x=u.pingCache;x!==null&&x.delete(f),u.pingedLanes|=u.suspendedLanes&g,u.warmLanes&=~g,$i===u&&(hi&g)===g&&(ji===4||ji===3&&(hi&62914560)===hi&&300>k()-Lc?(Mi&2)===0&&Le(u,0):Zl|=g,Fo===hi&&(Fo=0)),zf(u)}function FI(u,f){f===0&&(f=jn()),u=bf(u,f),u!==null&&(nn(u,f),zf(u))}function Lj(u){var f=u.memoizedState,g=0;f!==null&&(g=f.retryLane),FI(u,g)}function Pj(u,f){var g=0;switch(u.tag){case 31:case 13:var x=u.stateNode,A=u.memoizedState;A!==null&&(g=A.retryLane);break;case 19:x=u.stateNode;break;case 22:x=u.stateNode._retryCache;break;default:throw Error(n(314))}x!==null&&x.delete(f),FI(u,g)}function Bj(u,f){return Dt(u,f)}var bM=null,z_=null,e2=!1,SM=!1,t2=!1,Cp=0;function zf(u){u!==z_&&u.next===null&&(z_===null?bM=z_=u:z_=z_.next=u),SM=!0,e2||(e2=!0,Fj())}function gS(u,f){if(!t2&&SM){t2=!0;do for(var g=!1,x=bM;x!==null;){if(u!==0){var A=x.pendingLanes;if(A===0)var C=0;else{var G=x.suspendedLanes,te=x.pingedLanes;C=(1<<31-ue(42|u)+1)-1,C&=A&~(G&~te),C=C&201326741?C&201326741|1:C?C|2:0}C!==0&&(g=!0,kI(x,C))}else C=hi,C=it(x,x===$i?C:0,x.cancelPendingCommit!==null||x.timeoutHandle!==-1),(C&3)===0||Tt(x,C)||(g=!0,kI(x,C));x=x.next}while(g);t2=!1}}function Ij(){zI()}function zI(){SM=e2=!1;var u=0;Cp!==0&&jj()&&(u=Cp);for(var f=k(),g=null,x=bM;x!==null;){var A=x.next,C=VI(x,f);C===0?(x.next=null,g===null?bM=A:g.next=A,A===null&&(z_=g)):(g=x,(u!==0||(C&3)!==0)&&(SM=!0)),x=A}Pr!==0&&Pr!==5||gS(u),Cp!==0&&(Cp=0)}function VI(u,f){for(var g=u.suspendedLanes,x=u.pingedLanes,A=u.expirationTimes,C=u.pendingLanes&-62914561;0<C;){var G=31-ue(C),te=1<<G,_e=A[G];_e===-1?((te&g)===0||(te&x)!==0)&&(A[G]=ln(te,f)):_e<=f&&(u.expiredLanes|=te),C&=~te}if(f=$i,g=hi,g=it(u,u===f?g:0,u.cancelPendingCommit!==null||u.timeoutHandle!==-1),x=u.callbackNode,g===0||u===f&&(On===2||On===9)||u.cancelPendingCommit!==null)return x!==null&&x!==null&&zt(x),u.callbackNode=null,u.callbackPriority=0;if((g&3)===0||Tt(u,g)){if(f=g&-g,f===u.callbackPriority)return f;switch(x!==null&&zt(x),Bi(g)){case 2:case 8:g=He;break;case 32:g=ze;break;case 268435456:g=Ct;break;default:g=ze}return x=GI.bind(null,u),g=Dt(g,x),u.callbackPriority=f,u.callbackNode=g,f}return x!==null&&x!==null&&zt(x),u.callbackPriority=2,u.callbackNode=null,2}function GI(u,f){if(Pr!==0&&Pr!==5)return u.callbackNode=null,u.callbackPriority=0,null;var g=u.callbackNode;if(F_()&&u.callbackNode!==g)return null;var x=hi;return x=it(u,u===$i?x:0,u.cancelPendingCommit!==null||u.timeoutHandle!==-1),x===0?null:(S(u,x,f),VI(u,k()),u.callbackNode!=null&&u.callbackNode===g?GI.bind(null,u):null)}function kI(u,f){if(F_())return null;S(u,f,!0)}function Fj(){Zj(function(){(Mi&6)!==0?Dt(Fe,Ij):zI()})}function n2(){if(Cp===0){var u=Ec;u===0&&(u=Be,Be<<=1,(Be&261888)===0&&(Be=256)),Cp=u}return Cp}function HI(u){return u==null||typeof u=="symbol"||typeof u=="boolean"?null:typeof u=="function"?u:$m(""+u)}function WI(u,f){var g=f.ownerDocument.createElement("input");return g.name=f.name,g.value=f.value,u.id&&g.setAttribute("form",u.id),f.parentNode.insertBefore(g,f),u=new FormData(u),g.parentNode.removeChild(g),u}function zj(u,f,g,x,A){if(f==="submit"&&g&&g.stateNode===A){var C=HI((A[W]||null).action),G=x.submitter;G&&(f=(f=G[W]||null)?HI(f.formAction):G.getAttribute("formAction"),f!==null&&(C=f,G=null));var te=new Km("action","action",null,x,A);u.push({event:te,listeners:[{instance:null,listener:function(){if(x.defaultPrevented){if(Cp!==0){var _e=G?WI(A,G):new FormData(A);oS(g,{pending:!0,data:_e,method:A.method,action:C},null,_e)}}else typeof C=="function"&&(te.preventDefault(),_e=G?WI(A,G):new FormData(A),oS(g,{pending:!0,data:_e,method:A.method,action:C},C,_e))},currentTarget:A}]})}}for(var i2=0;i2<n_.length;i2++){var r2=n_[i2],Vj=r2.toLowerCase(),Gj=r2[0].toUpperCase()+r2.slice(1);aa(Vj,"on"+Gj)}aa(qa,"onAnimationEnd"),aa(Sb,"onAnimationIteration"),aa(Mu,"onAnimationStart"),aa("dblclick","onDoubleClick"),aa("focusin","onFocus"),aa("focusout","onBlur"),aa(lp,"onTransitionRun"),aa(_f,"onTransitionStart"),aa(Tb,"onTransitionCancel"),aa(t_,"onTransitionEnd"),Se("onMouseEnter",["mouseout","mouseover"]),Se("onMouseLeave",["mouseout","mouseover"]),Se("onPointerEnter",["pointerout","pointerover"]),Se("onPointerLeave",["pointerout","pointerover"]),Ae("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),Ae("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),Ae("onBeforeInput",["compositionend","keypress","textInput","paste"]),Ae("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),Ae("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),Ae("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var yS="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),kj=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(yS));function qI(u,f){f=(f&4)!==0;for(var g=0;g<u.length;g++){var x=u[g],A=x.event;x=x.listeners;e:{var C=void 0;if(f)for(var G=x.length-1;0<=G;G--){var te=x[G],_e=te.instance,ke=te.currentTarget;if(te=te.listener,_e!==C&&A.isPropagationStopped())break e;C=te,A.currentTarget=ke;try{C(A)}catch(ot){vf(ot)}A.currentTarget=null,C=_e}else for(G=0;G<x.length;G++){if(te=x[G],_e=te.instance,ke=te.currentTarget,te=te.listener,_e!==C&&A.isPropagationStopped())break e;C=te,A.currentTarget=ke;try{C(A)}catch(ot){vf(ot)}A.currentTarget=null,C=_e}}}}function Si(u,f){var g=f[me];g===void 0&&(g=f[me]=new Set);var x=u+"__bubble";g.has(x)||(XI(f,u,2,!1),g.add(x))}function s2(u,f,g){var x=0;f&&(x|=4),XI(g,u,x,f)}var TM="_reactListening"+Math.random().toString(36).slice(2);function a2(u){if(!u[TM]){u[TM]=!0,ce.forEach(function(g){g!=="selectionchange"&&(kj.has(g)||s2(g,!1,u),s2(g,!0,u))});var f=u.nodeType===9?u:u.ownerDocument;f===null||f[TM]||(f[TM]=!0,s2("selectionchange",!1,f))}}function XI(u,f,g,x){switch(bF(f)){case 2:var A=gY;break;case 8:A=yY;break;default:A=b2}g=A.bind(null,f,g,u),A=void 0,!Gy||f!=="touchstart"&&f!=="touchmove"&&f!=="wheel"||(A=!0),x?A!==void 0?u.addEventListener(f,g,{capture:!0,passive:A}):u.addEventListener(f,g,!0):A!==void 0?u.addEventListener(f,g,{passive:A}):u.addEventListener(f,g,!1)}function o2(u,f,g,x,A){var C=x;if((f&1)===0&&(f&2)===0&&x!==null)e:for(;;){if(x===null)return;var G=x.tag;if(G===3||G===4){var te=x.stateNode.containerInfo;if(te===A)break;if(G===4)for(G=x.return;G!==null;){var _e=G.tag;if((_e===3||_e===4)&&G.stateNode.containerInfo===A)return;G=G.return}for(;te!==null;){if(G=pt(te),G===null)return;if(_e=G.tag,_e===5||_e===6||_e===26||_e===27){x=C=G;continue e}te=te.parentNode}}x=x.return}rb(function(){var ke=C,ot=zy(g),xt=[];e:{var Xe=yc.get(u);if(Xe!==void 0){var Qe=Km,vn=u;switch(u){case"keypress":if(wd(g)===0)break e;case"keydown":case"keyup":Qe=fb;break;case"focusin":vn="focus",Qe=Xy;break;case"focusout":vn="blur",Qe=Xy;break;case"beforeblur":case"afterblur":Qe=Xy;break;case"click":if(g.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":Qe=SE;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":Qe=TE;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":Qe=mc;break;case qa:case Sb:case Mu:Qe=AE;break;case t_:Qe=qN;break;case"scroll":case"scrollend":Qe=Wy;break;case"wheel":Qe=df;break;case"copy":case"cut":case"paste":Qe=ab;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":Qe=$y;break;case"toggle":case"beforetoggle":Qe=hb}var Hn=(f&4)!==0,xr=!Hn&&(u==="scroll"||u==="scrollend"),Ue=Hn?Xe!==null?Xe+"Capture":null:Xe;Hn=[];for(var we=ke,Ge;we!==null;){var yt=we;if(Ge=yt.stateNode,yt=yt.tag,yt!==5&&yt!==26&&yt!==27||Ge===null||Ue===null||(yt=Ad(we,Ue),yt!=null&&Hn.push(_S(we,yt,Ge))),xr)break;we=we.return}0<Hn.length&&(Xe=new Qe(Xe,vn,null,g,ot),xt.push({event:Xe,listeners:Hn}))}}if((f&7)===0){e:{if(Xe=u==="mouseover"||u==="pointerover",Qe=u==="mouseout"||u==="pointerout",Xe&&g!==jm&&(vn=g.relatedTarget||g.fromElement)&&(pt(vn)||vn[J]))break e;if((Qe||Xe)&&(Xe=ot.window===ot?ot:(Xe=ot.ownerDocument)?Xe.defaultView||Xe.parentWindow:window,Qe?(vn=g.relatedTarget||g.toElement,Qe=ke,vn=vn?pt(vn):null,vn!==null&&(xr=s(vn),Hn=vn.tag,vn!==xr||Hn!==5&&Hn!==27&&Hn!==6)&&(vn=null)):(Qe=null,vn=ke),Qe!==vn)){if(Hn=SE,yt="onMouseLeave",Ue="onMouseEnter",we="mouse",(u==="pointerout"||u==="pointerover")&&(Hn=$y,yt="onPointerLeave",Ue="onPointerEnter",we="pointer"),xr=Qe==null?Xe:Lt(Qe),Ge=vn==null?Xe:Lt(vn),Xe=new Hn(yt,we+"leave",Qe,g,ot),Xe.target=xr,Xe.relatedTarget=Ge,yt=null,pt(ot)===ke&&(Hn=new Hn(Ue,we+"enter",vn,g,ot),Hn.target=Ge,Hn.relatedTarget=xr,yt=Hn),xr=yt,Qe&&vn)t:{for(Hn=Hj,Ue=Qe,we=vn,Ge=0,yt=Ue;yt;yt=Hn(yt))Ge++;yt=0;for(var Pn=we;Pn;Pn=Hn(Pn))yt++;for(;0<Ge-yt;)Ue=Hn(Ue),Ge--;for(;0<yt-Ge;)we=Hn(we),yt--;for(;Ge--;){if(Ue===we||we!==null&&Ue===we.alternate){Hn=Ue;break t}Ue=Hn(Ue),we=Hn(we)}Hn=null}else Hn=null;Qe!==null&&$I(xt,Xe,Qe,Hn,!1),vn!==null&&xr!==null&&$I(xt,xr,vn,Hn,!0)}}e:{if(Xe=ke?Lt(ke):window,Qe=Xe.nodeName&&Xe.nodeName.toLowerCase(),Qe==="select"||Qe==="input"&&Xe.type==="file")var Yi=_b;else if(gb(Xe))if(ig)Yi=IE;else{Yi=mf;var An=rg}else Qe=Xe.nodeName,!Qe||Qe.toLowerCase()!=="input"||Xe.type!=="checkbox"&&Xe.type!=="radio"?ke&&To(ke.elementType)&&(Yi=_b):Yi=BE;if(Yi&&(Yi=Yi(u,ke))){Zy(xt,Yi,g,ot);break e}An&&An(u,Xe,ke),u==="focusout"&&ke&&Xe.type==="number"&&ke.memoizedProps.value!=null&&Ii(Xe,"number",Xe.value)}switch(An=ke?Lt(ke):window,u){case"focusin":(gb(An)||An.contentEditable==="true")&&(sp=An,Jy=ke,ap=null);break;case"focusout":ap=Jy=sp=null;break;case"mousedown":Mo=!0;break;case"contextmenu":case"mouseup":case"dragend":Mo=!1,e_(xt,g,ot);break;case"selectionchange":if(FE)break;case"keydown":case"keyup":e_(xt,g,ot)}var li;if(Rd)e:{switch(u){case"compositionstart":var wi="onCompositionStart";break e;case"compositionend":wi="onCompositionEnd";break e;case"compositionupdate":wi="onCompositionUpdate";break e}wi=void 0}else pf?jy(u,g)&&(wi="onCompositionEnd"):u==="keydown"&&g.keyCode===229&&(wi="onCompositionStart");wi&&(Xs&&g.locale!=="ko"&&(pf||wi!=="onCompositionStart"?wi==="onCompositionEnd"&&pf&&(li=Hy()):(uf=ot,ky="value"in uf?uf.value:uf.textContent,pf=!0)),An=EM(ke,wi),0<An.length&&(wi=new ob(wi,u,null,g,ot),xt.push({event:wi,listeners:An}),li?wi.data=li:(li=Jh(g),li!==null&&(wi.data=li)))),(li=Cd?Yy(u,g):UE(u,g))&&(wi=EM(ke,"onBeforeInput"),0<wi.length&&(An=new ob("onBeforeInput","beforeinput",null,g,ot),xt.push({event:An,listeners:wi}),An.data=li)),zj(xt,u,ke,g,ot)}qI(xt,f)})}function _S(u,f,g){return{instance:u,listener:f,currentTarget:g}}function EM(u,f){for(var g=f+"Capture",x=[];u!==null;){var A=u,C=A.stateNode;if(A=A.tag,A!==5&&A!==26&&A!==27||C===null||(A=Ad(u,g),A!=null&&x.unshift(_S(u,A,C)),A=Ad(u,f),A!=null&&x.push(_S(u,A,C))),u.tag===3)return x;u=u.return}return[]}function Hj(u){if(u===null)return null;do u=u.return;while(u&&u.tag!==5&&u.tag!==27);return u||null}function $I(u,f,g,x,A){for(var C=f._reactName,G=[];g!==null&&g!==x;){var te=g,_e=te.alternate,ke=te.stateNode;if(te=te.tag,_e!==null&&_e===x)break;te!==5&&te!==26&&te!==27||ke===null||(_e=ke,A?(ke=Ad(g,C),ke!=null&&G.unshift(_S(g,ke,_e))):A||(ke=Ad(g,C),ke!=null&&G.push(_S(g,ke,_e)))),g=g.return}G.length!==0&&u.push({event:f,listeners:G})}var Wj=/\r\n?/g,qj=/\u0000|\uFFFD/g;function jI(u){return(typeof u=="string"?u:""+u).replace(Wj,`
`).replace(qj,"")}function YI(u,f){return f=jI(f),jI(u)===f}function vr(u,f,g,x,A,C){switch(g){case"children":typeof x=="string"?f==="body"||f==="textarea"&&x===""||hs(u,x):(typeof x=="number"||typeof x=="bigint")&&f!=="body"&&hs(u,""+x);break;case"className":mn(u,"class",x);break;case"tabIndex":mn(u,"tabindex",x);break;case"dir":case"role":case"viewBox":case"width":case"height":mn(u,g,x);break;case"style":Ed(u,x,C);break;case"data":if(f!=="object"){mn(u,"data",x);break}case"src":case"href":if(x===""&&(f!=="a"||g!=="href")){u.removeAttribute(g);break}if(x==null||typeof x=="function"||typeof x=="symbol"||typeof x=="boolean"){u.removeAttribute(g);break}x=$m(""+x),u.setAttribute(g,x);break;case"action":case"formAction":if(typeof x=="function"){u.setAttribute(g,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof C=="function"&&(g==="formAction"?(f!=="input"&&vr(u,f,"name",A.name,A,null),vr(u,f,"formEncType",A.formEncType,A,null),vr(u,f,"formMethod",A.formMethod,A,null),vr(u,f,"formTarget",A.formTarget,A,null)):(vr(u,f,"encType",A.encType,A,null),vr(u,f,"method",A.method,A,null),vr(u,f,"target",A.target,A,null)));if(x==null||typeof x=="symbol"||typeof x=="boolean"){u.removeAttribute(g);break}x=$m(""+x),u.setAttribute(g,x);break;case"onClick":x!=null&&(u.onclick=Tu);break;case"onScroll":x!=null&&Si("scroll",u);break;case"onScrollEnd":x!=null&&Si("scrollend",u);break;case"dangerouslySetInnerHTML":if(x!=null){if(typeof x!="object"||!("__html"in x))throw Error(n(61));if(g=x.__html,g!=null){if(A.children!=null)throw Error(n(60));u.innerHTML=g}}break;case"multiple":u.multiple=x&&typeof x!="function"&&typeof x!="symbol";break;case"muted":u.muted=x&&typeof x!="function"&&typeof x!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(x==null||typeof x=="function"||typeof x=="boolean"||typeof x=="symbol"){u.removeAttribute("xlink:href");break}g=$m(""+x),u.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",g);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":x!=null&&typeof x!="function"&&typeof x!="symbol"?u.setAttribute(g,""+x):u.removeAttribute(g);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":x&&typeof x!="function"&&typeof x!="symbol"?u.setAttribute(g,""):u.removeAttribute(g);break;case"capture":case"download":x===!0?u.setAttribute(g,""):x!==!1&&x!=null&&typeof x!="function"&&typeof x!="symbol"?u.setAttribute(g,x):u.removeAttribute(g);break;case"cols":case"rows":case"size":case"span":x!=null&&typeof x!="function"&&typeof x!="symbol"&&!isNaN(x)&&1<=x?u.setAttribute(g,x):u.removeAttribute(g);break;case"rowSpan":case"start":x==null||typeof x=="function"||typeof x=="symbol"||isNaN(x)?u.removeAttribute(g):u.setAttribute(g,x);break;case"popover":Si("beforetoggle",u),Si("toggle",u),Vt(u,"popover",x);break;case"xlinkActuate":Gt(u,"http://www.w3.org/1999/xlink","xlink:actuate",x);break;case"xlinkArcrole":Gt(u,"http://www.w3.org/1999/xlink","xlink:arcrole",x);break;case"xlinkRole":Gt(u,"http://www.w3.org/1999/xlink","xlink:role",x);break;case"xlinkShow":Gt(u,"http://www.w3.org/1999/xlink","xlink:show",x);break;case"xlinkTitle":Gt(u,"http://www.w3.org/1999/xlink","xlink:title",x);break;case"xlinkType":Gt(u,"http://www.w3.org/1999/xlink","xlink:type",x);break;case"xmlBase":Gt(u,"http://www.w3.org/XML/1998/namespace","xml:base",x);break;case"xmlLang":Gt(u,"http://www.w3.org/XML/1998/namespace","xml:lang",x);break;case"xmlSpace":Gt(u,"http://www.w3.org/XML/1998/namespace","xml:space",x);break;case"is":Vt(u,"is",x);break;case"innerText":case"textContent":break;default:(!(2<g.length)||g[0]!=="o"&&g[0]!=="O"||g[1]!=="n"&&g[1]!=="N")&&(g=xE.get(g)||g,Vt(u,g,x))}}function l2(u,f,g,x,A,C){switch(g){case"style":Ed(u,x,C);break;case"dangerouslySetInnerHTML":if(x!=null){if(typeof x!="object"||!("__html"in x))throw Error(n(61));if(g=x.__html,g!=null){if(A.children!=null)throw Error(n(60));u.innerHTML=g}}break;case"children":typeof x=="string"?hs(u,x):(typeof x=="number"||typeof x=="bigint")&&hs(u,""+x);break;case"onScroll":x!=null&&Si("scroll",u);break;case"onScrollEnd":x!=null&&Si("scrollend",u);break;case"onClick":x!=null&&(u.onclick=Tu);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!Me.hasOwnProperty(g))e:{if(g[0]==="o"&&g[1]==="n"&&(A=g.endsWith("Capture"),f=g.slice(2,A?g.length-7:void 0),C=u[W]||null,C=C!=null?C[g]:null,typeof C=="function"&&u.removeEventListener(f,C,A),typeof x=="function")){typeof C!="function"&&C!==null&&(g in u?u[g]=null:u.hasAttribute(g)&&u.removeAttribute(g)),u.addEventListener(f,x,A);break e}g in u?u[g]=x:x===!0?u.setAttribute(g,""):Vt(u,g,x)}}}function Oa(u,f,g){switch(f){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":Si("error",u),Si("load",u);var x=!1,A=!1,C;for(C in g)if(g.hasOwnProperty(C)){var G=g[C];if(G!=null)switch(C){case"src":x=!0;break;case"srcSet":A=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(n(137,f));default:vr(u,f,C,G,g,null)}}A&&vr(u,f,"srcSet",g.srcSet,g,null),x&&vr(u,f,"src",g.src,g,null);return;case"input":Si("invalid",u);var te=C=G=A=null,_e=null,ke=null;for(x in g)if(g.hasOwnProperty(x)){var ot=g[x];if(ot!=null)switch(x){case"name":A=ot;break;case"type":G=ot;break;case"checked":_e=ot;break;case"defaultChecked":ke=ot;break;case"value":C=ot;break;case"defaultValue":te=ot;break;case"children":case"dangerouslySetInnerHTML":if(ot!=null)throw Error(n(137,f));break;default:vr(u,f,x,ot,g,null)}}Ds(u,C,te,_e,ke,G,A,!1);return;case"select":Si("invalid",u),x=G=C=null;for(A in g)if(g.hasOwnProperty(A)&&(te=g[A],te!=null))switch(A){case"value":C=te;break;case"defaultValue":G=te;break;case"multiple":x=te;default:vr(u,f,A,te,g,null)}f=C,g=G,u.multiple=!!x,f!=null?Jr(u,!!x,f,!1):g!=null&&Jr(u,!!x,g,!0);return;case"textarea":Si("invalid",u),C=A=x=null;for(G in g)if(g.hasOwnProperty(G)&&(te=g[G],te!=null))switch(G){case"value":x=te;break;case"defaultValue":A=te;break;case"children":C=te;break;case"dangerouslySetInnerHTML":if(te!=null)throw Error(n(91));break;default:vr(u,f,G,te,g,null)}Vr(u,x,A,C);return;case"option":for(_e in g)if(g.hasOwnProperty(_e)&&(x=g[_e],x!=null))switch(_e){case"selected":u.selected=x&&typeof x!="function"&&typeof x!="symbol";break;default:vr(u,f,_e,x,g,null)}return;case"dialog":Si("beforetoggle",u),Si("toggle",u),Si("cancel",u),Si("close",u);break;case"iframe":case"object":Si("load",u);break;case"video":case"audio":for(x=0;x<yS.length;x++)Si(yS[x],u);break;case"image":Si("error",u),Si("load",u);break;case"details":Si("toggle",u);break;case"embed":case"source":case"link":Si("error",u),Si("load",u);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(ke in g)if(g.hasOwnProperty(ke)&&(x=g[ke],x!=null))switch(ke){case"children":case"dangerouslySetInnerHTML":throw Error(n(137,f));default:vr(u,f,ke,x,g,null)}return;default:if(To(f)){for(ot in g)g.hasOwnProperty(ot)&&(x=g[ot],x!==void 0&&l2(u,f,ot,x,g,void 0));return}}for(te in g)g.hasOwnProperty(te)&&(x=g[te],x!=null&&vr(u,f,te,x,g,null))}function Xj(u,f,g,x){switch(f){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var A=null,C=null,G=null,te=null,_e=null,ke=null,ot=null;for(Qe in g){var xt=g[Qe];if(g.hasOwnProperty(Qe)&&xt!=null)switch(Qe){case"checked":break;case"value":break;case"defaultValue":_e=xt;default:x.hasOwnProperty(Qe)||vr(u,f,Qe,null,x,xt)}}for(var Xe in x){var Qe=x[Xe];if(xt=g[Xe],x.hasOwnProperty(Xe)&&(Qe!=null||xt!=null))switch(Xe){case"type":C=Qe;break;case"name":A=Qe;break;case"checked":ke=Qe;break;case"defaultChecked":ot=Qe;break;case"value":G=Qe;break;case"defaultValue":te=Qe;break;case"children":case"dangerouslySetInnerHTML":if(Qe!=null)throw Error(n(137,f));break;default:Qe!==xt&&vr(u,f,Xe,Qe,x,xt)}}Vi(u,G,te,_e,ke,ot,C,A);return;case"select":Qe=G=te=Xe=null;for(C in g)if(_e=g[C],g.hasOwnProperty(C)&&_e!=null)switch(C){case"value":break;case"multiple":Qe=_e;default:x.hasOwnProperty(C)||vr(u,f,C,null,x,_e)}for(A in x)if(C=x[A],_e=g[A],x.hasOwnProperty(A)&&(C!=null||_e!=null))switch(A){case"value":Xe=C;break;case"defaultValue":te=C;break;case"multiple":G=C;default:C!==_e&&vr(u,f,A,C,x,_e)}f=te,g=G,x=Qe,Xe!=null?Jr(u,!!g,Xe,!1):!!x!=!!g&&(f!=null?Jr(u,!!g,f,!0):Jr(u,!!g,g?[]:"",!1));return;case"textarea":Qe=Xe=null;for(te in g)if(A=g[te],g.hasOwnProperty(te)&&A!=null&&!x.hasOwnProperty(te))switch(te){case"value":break;case"children":break;default:vr(u,f,te,null,x,A)}for(G in x)if(A=x[G],C=g[G],x.hasOwnProperty(G)&&(A!=null||C!=null))switch(G){case"value":Xe=A;break;case"defaultValue":Qe=A;break;case"children":break;case"dangerouslySetInnerHTML":if(A!=null)throw Error(n(91));break;default:A!==C&&vr(u,f,G,A,x,C)}qi(u,Xe,Qe);return;case"option":for(var vn in g)if(Xe=g[vn],g.hasOwnProperty(vn)&&Xe!=null&&!x.hasOwnProperty(vn))switch(vn){case"selected":u.selected=!1;break;default:vr(u,f,vn,null,x,Xe)}for(_e in x)if(Xe=x[_e],Qe=g[_e],x.hasOwnProperty(_e)&&Xe!==Qe&&(Xe!=null||Qe!=null))switch(_e){case"selected":u.selected=Xe&&typeof Xe!="function"&&typeof Xe!="symbol";break;default:vr(u,f,_e,Xe,x,Qe)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var Hn in g)Xe=g[Hn],g.hasOwnProperty(Hn)&&Xe!=null&&!x.hasOwnProperty(Hn)&&vr(u,f,Hn,null,x,Xe);for(ke in x)if(Xe=x[ke],Qe=g[ke],x.hasOwnProperty(ke)&&Xe!==Qe&&(Xe!=null||Qe!=null))switch(ke){case"children":case"dangerouslySetInnerHTML":if(Xe!=null)throw Error(n(137,f));break;default:vr(u,f,ke,Xe,x,Qe)}return;default:if(To(f)){for(var xr in g)Xe=g[xr],g.hasOwnProperty(xr)&&Xe!==void 0&&!x.hasOwnProperty(xr)&&l2(u,f,xr,void 0,x,Xe);for(ot in x)Xe=x[ot],Qe=g[ot],!x.hasOwnProperty(ot)||Xe===Qe||Xe===void 0&&Qe===void 0||l2(u,f,ot,Xe,x,Qe);return}}for(var Ue in g)Xe=g[Ue],g.hasOwnProperty(Ue)&&Xe!=null&&!x.hasOwnProperty(Ue)&&vr(u,f,Ue,null,x,Xe);for(xt in x)Xe=x[xt],Qe=g[xt],!x.hasOwnProperty(xt)||Xe===Qe||Xe==null&&Qe==null||vr(u,f,xt,Xe,x,Qe)}function ZI(u){switch(u){case"css":case"script":case"font":case"img":case"image":case"input":case"link":return!0;default:return!1}}function $j(){if(typeof performance.getEntriesByType=="function"){for(var u=0,f=0,g=performance.getEntriesByType("resource"),x=0;x<g.length;x++){var A=g[x],C=A.transferSize,G=A.initiatorType,te=A.duration;if(C&&te&&ZI(G)){for(G=0,te=A.responseEnd,x+=1;x<g.length;x++){var _e=g[x],ke=_e.startTime;if(ke>te)break;var ot=_e.transferSize,xt=_e.initiatorType;ot&&ZI(xt)&&(_e=_e.responseEnd,G+=ot*(_e<te?1:(te-ke)/(_e-ke)))}if(--x,f+=8*(C+G)/(A.duration/1e3),u++,10<u)break}}if(0<u)return f/u/1e6}return navigator.connection&&(u=navigator.connection.downlink,typeof u=="number")?u:5}var u2=null,c2=null;function MM(u){return u.nodeType===9?u:u.ownerDocument}function KI(u){switch(u){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function QI(u,f){if(u===0)switch(f){case"svg":return 1;case"math":return 2;default:return 0}return u===1&&f==="foreignObject"?0:u}function f2(u,f){return u==="textarea"||u==="noscript"||typeof f.children=="string"||typeof f.children=="number"||typeof f.children=="bigint"||typeof f.dangerouslySetInnerHTML=="object"&&f.dangerouslySetInnerHTML!==null&&f.dangerouslySetInnerHTML.__html!=null}var d2=null;function jj(){var u=window.event;return u&&u.type==="popstate"?u===d2?!1:(d2=u,!0):(d2=null,!1)}var JI=typeof setTimeout=="function"?setTimeout:void 0,Yj=typeof clearTimeout=="function"?clearTimeout:void 0,eF=typeof Promise=="function"?Promise:void 0,Zj=typeof queueMicrotask=="function"?queueMicrotask:typeof eF<"u"?function(u){return eF.resolve(null).then(u).catch(Kj)}:JI;function Kj(u){setTimeout(function(){throw u})}function Np(u){return u==="head"}function tF(u,f){var g=f,x=0;do{var A=g.nextSibling;if(u.removeChild(g),A&&A.nodeType===8)if(g=A.data,g==="/$"||g==="/&"){if(x===0){u.removeChild(A),H_(f);return}x--}else if(g==="$"||g==="$?"||g==="$~"||g==="$!"||g==="&")x++;else if(g==="html")vS(u.ownerDocument.documentElement);else if(g==="head"){g=u.ownerDocument.head,vS(g);for(var C=g.firstChild;C;){var G=C.nextSibling,te=C.nodeName;C[_t]||te==="SCRIPT"||te==="STYLE"||te==="LINK"&&C.rel.toLowerCase()==="stylesheet"||g.removeChild(C),C=G}}else g==="body"&&vS(u.ownerDocument.body);g=A}while(g);H_(f)}function nF(u,f){var g=u;u=0;do{var x=g.nextSibling;if(g.nodeType===1?f?(g._stashedDisplay=g.style.display,g.style.display="none"):(g.style.display=g._stashedDisplay||"",g.getAttribute("style")===""&&g.removeAttribute("style")):g.nodeType===3&&(f?(g._stashedText=g.nodeValue,g.nodeValue=""):g.nodeValue=g._stashedText||""),x&&x.nodeType===8)if(g=x.data,g==="/$"){if(u===0)break;u--}else g!=="$"&&g!=="$?"&&g!=="$~"&&g!=="$!"||u++;g=x}while(g)}function h2(u){var f=u.firstChild;for(f&&f.nodeType===10&&(f=f.nextSibling);f;){var g=f;switch(f=f.nextSibling,g.nodeName){case"HTML":case"HEAD":case"BODY":h2(g),ct(g);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(g.rel.toLowerCase()==="stylesheet")continue}u.removeChild(g)}}function Qj(u,f,g,x){for(;u.nodeType===1;){var A=g;if(u.nodeName.toLowerCase()!==f.toLowerCase()){if(!x&&(u.nodeName!=="INPUT"||u.type!=="hidden"))break}else if(x){if(!u[_t])switch(f){case"meta":if(!u.hasAttribute("itemprop"))break;return u;case"link":if(C=u.getAttribute("rel"),C==="stylesheet"&&u.hasAttribute("data-precedence"))break;if(C!==A.rel||u.getAttribute("href")!==(A.href==null||A.href===""?null:A.href)||u.getAttribute("crossorigin")!==(A.crossOrigin==null?null:A.crossOrigin)||u.getAttribute("title")!==(A.title==null?null:A.title))break;return u;case"style":if(u.hasAttribute("data-precedence"))break;return u;case"script":if(C=u.getAttribute("src"),(C!==(A.src==null?null:A.src)||u.getAttribute("type")!==(A.type==null?null:A.type)||u.getAttribute("crossorigin")!==(A.crossOrigin==null?null:A.crossOrigin))&&C&&u.hasAttribute("async")&&!u.hasAttribute("itemprop"))break;return u;default:return u}}else if(f==="input"&&u.type==="hidden"){var C=A.name==null?null:""+A.name;if(A.type==="hidden"&&u.getAttribute("name")===C)return u}else return u;if(u=Vu(u.nextSibling),u===null)break}return null}function Jj(u,f,g){if(f==="")return null;for(;u.nodeType!==3;)if((u.nodeType!==1||u.nodeName!=="INPUT"||u.type!=="hidden")&&!g||(u=Vu(u.nextSibling),u===null))return null;return u}function iF(u,f){for(;u.nodeType!==8;)if((u.nodeType!==1||u.nodeName!=="INPUT"||u.type!=="hidden")&&!f||(u=Vu(u.nextSibling),u===null))return null;return u}function p2(u){return u.data==="$?"||u.data==="$~"}function m2(u){return u.data==="$!"||u.data==="$?"&&u.ownerDocument.readyState!=="loading"}function eY(u,f){var g=u.ownerDocument;if(u.data==="$~")u._reactRetry=f;else if(u.data!=="$?"||g.readyState!=="loading")f();else{var x=function(){f(),g.removeEventListener("DOMContentLoaded",x)};g.addEventListener("DOMContentLoaded",x),u._reactRetry=x}}function Vu(u){for(;u!=null;u=u.nextSibling){var f=u.nodeType;if(f===1||f===3)break;if(f===8){if(f=u.data,f==="$"||f==="$!"||f==="$?"||f==="$~"||f==="&"||f==="F!"||f==="F")break;if(f==="/$"||f==="/&")return null}}return u}var g2=null;function rF(u){u=u.nextSibling;for(var f=0;u;){if(u.nodeType===8){var g=u.data;if(g==="/$"||g==="/&"){if(f===0)return Vu(u.nextSibling);f--}else g!=="$"&&g!=="$!"&&g!=="$?"&&g!=="$~"&&g!=="&"||f++}u=u.nextSibling}return null}function sF(u){u=u.previousSibling;for(var f=0;u;){if(u.nodeType===8){var g=u.data;if(g==="$"||g==="$!"||g==="$?"||g==="$~"||g==="&"){if(f===0)return u;f--}else g!=="/$"&&g!=="/&"||f++}u=u.previousSibling}return null}function aF(u,f,g){switch(f=MM(g),u){case"html":if(u=f.documentElement,!u)throw Error(n(452));return u;case"head":if(u=f.head,!u)throw Error(n(453));return u;case"body":if(u=f.body,!u)throw Error(n(454));return u;default:throw Error(n(451))}}function vS(u){for(var f=u.attributes;f.length;)u.removeAttributeNode(f[0]);ct(u)}var Gu=new Map,oF=new Set;function AM(u){return typeof u.getRootNode=="function"?u.getRootNode():u.nodeType===9?u:u.ownerDocument}var Qd=X.d;X.d={f:tY,r:nY,D:iY,C:rY,L:sY,m:aY,X:lY,S:oY,M:uY};function tY(){var u=Qd.f(),f=ie();return u||f}function nY(u){var f=gt(u);f!==null&&f.tag===5&&f.type==="form"?lS(f):Qd.r(u)}var V_=typeof document>"u"?null:document;function lF(u,f,g){var x=V_;if(x&&typeof f=="string"&&f){var A=tn(f);A='link[rel="'+u+'"][href="'+A+'"]',typeof g=="string"&&(A+='[crossorigin="'+g+'"]'),oF.has(A)||(oF.add(A),u={rel:u,crossOrigin:g,href:f},x.querySelector(A)===null&&(f=x.createElement("link"),Oa(f,"link",u),$(f),x.head.appendChild(f)))}}function iY(u){Qd.D(u),lF("dns-prefetch",u,null)}function rY(u,f){Qd.C(u,f),lF("preconnect",u,f)}function sY(u,f,g){Qd.L(u,f,g);var x=V_;if(x&&u&&f){var A='link[rel="preload"][as="'+tn(f)+'"]';f==="image"&&g&&g.imageSrcSet?(A+='[imagesrcset="'+tn(g.imageSrcSet)+'"]',typeof g.imageSizes=="string"&&(A+='[imagesizes="'+tn(g.imageSizes)+'"]')):A+='[href="'+tn(u)+'"]';var C=A;switch(f){case"style":C=G_(u);break;case"script":C=k_(u)}Gu.has(C)||(u=p({rel:"preload",href:f==="image"&&g&&g.imageSrcSet?void 0:u,as:f},g),Gu.set(C,u),x.querySelector(A)!==null||f==="style"&&x.querySelector(xS(C))||f==="script"&&x.querySelector(bS(C))||(f=x.createElement("link"),Oa(f,"link",u),$(f),x.head.appendChild(f)))}}function aY(u,f){Qd.m(u,f);var g=V_;if(g&&u){var x=f&&typeof f.as=="string"?f.as:"script",A='link[rel="modulepreload"][as="'+tn(x)+'"][href="'+tn(u)+'"]',C=A;switch(x){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":C=k_(u)}if(!Gu.has(C)&&(u=p({rel:"modulepreload",href:u},f),Gu.set(C,u),g.querySelector(A)===null)){switch(x){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(g.querySelector(bS(C)))return}x=g.createElement("link"),Oa(x,"link",u),$(x),g.head.appendChild(x)}}}function oY(u,f,g){Qd.S(u,f,g);var x=V_;if(x&&u){var A=bt(x).hoistableStyles,C=G_(u);f=f||"default";var G=A.get(C);if(!G){var te={loading:0,preload:null};if(G=x.querySelector(xS(C)))te.loading=5;else{u=p({rel:"stylesheet",href:u,"data-precedence":f},g),(g=Gu.get(C))&&y2(u,g);var _e=G=x.createElement("link");$(_e),Oa(_e,"link",u),_e._p=new Promise(function(ke,ot){_e.onload=ke,_e.onerror=ot}),_e.addEventListener("load",function(){te.loading|=1}),_e.addEventListener("error",function(){te.loading|=2}),te.loading|=4,wM(G,f,x)}G={type:"stylesheet",instance:G,count:1,state:te},A.set(C,G)}}}function lY(u,f){Qd.X(u,f);var g=V_;if(g&&u){var x=bt(g).hoistableScripts,A=k_(u),C=x.get(A);C||(C=g.querySelector(bS(A)),C||(u=p({src:u,async:!0},f),(f=Gu.get(A))&&_2(u,f),C=g.createElement("script"),$(C),Oa(C,"link",u),g.head.appendChild(C)),C={type:"script",instance:C,count:1,state:null},x.set(A,C))}}function uY(u,f){Qd.M(u,f);var g=V_;if(g&&u){var x=bt(g).hoistableScripts,A=k_(u),C=x.get(A);C||(C=g.querySelector(bS(A)),C||(u=p({src:u,async:!0,type:"module"},f),(f=Gu.get(A))&&_2(u,f),C=g.createElement("script"),$(C),Oa(C,"link",u),g.head.appendChild(C)),C={type:"script",instance:C,count:1,state:null},x.set(A,C))}}function uF(u,f,g,x){var A=(A=Ee.current)?AM(A):null;if(!A)throw Error(n(446));switch(u){case"meta":case"title":return null;case"style":return typeof g.precedence=="string"&&typeof g.href=="string"?(f=G_(g.href),g=bt(A).hoistableStyles,x=g.get(f),x||(x={type:"style",instance:null,count:0,state:null},g.set(f,x)),x):{type:"void",instance:null,count:0,state:null};case"link":if(g.rel==="stylesheet"&&typeof g.href=="string"&&typeof g.precedence=="string"){u=G_(g.href);var C=bt(A).hoistableStyles,G=C.get(u);if(G||(A=A.ownerDocument||A,G={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},C.set(u,G),(C=A.querySelector(xS(u)))&&!C._p&&(G.instance=C,G.state.loading=5),Gu.has(u)||(g={rel:"preload",as:"style",href:g.href,crossOrigin:g.crossOrigin,integrity:g.integrity,media:g.media,hrefLang:g.hrefLang,referrerPolicy:g.referrerPolicy},Gu.set(u,g),C||cY(A,u,g,G.state))),f&&x===null)throw Error(n(528,""));return G}if(f&&x!==null)throw Error(n(529,""));return null;case"script":return f=g.async,g=g.src,typeof g=="string"&&f&&typeof f!="function"&&typeof f!="symbol"?(f=k_(g),g=bt(A).hoistableScripts,x=g.get(f),x||(x={type:"script",instance:null,count:0,state:null},g.set(f,x)),x):{type:"void",instance:null,count:0,state:null};default:throw Error(n(444,u))}}function G_(u){return'href="'+tn(u)+'"'}function xS(u){return'link[rel="stylesheet"]['+u+"]"}function cF(u){return p({},u,{"data-precedence":u.precedence,precedence:null})}function cY(u,f,g,x){u.querySelector('link[rel="preload"][as="style"]['+f+"]")?x.loading=1:(f=u.createElement("link"),x.preload=f,f.addEventListener("load",function(){return x.loading|=1}),f.addEventListener("error",function(){return x.loading|=2}),Oa(f,"link",g),$(f),u.head.appendChild(f))}function k_(u){return'[src="'+tn(u)+'"]'}function bS(u){return"script[async]"+u}function fF(u,f,g){if(f.count++,f.instance===null)switch(f.type){case"style":var x=u.querySelector('style[data-href~="'+tn(g.href)+'"]');if(x)return f.instance=x,$(x),x;var A=p({},g,{"data-href":g.href,"data-precedence":g.precedence,href:null,precedence:null});return x=(u.ownerDocument||u).createElement("style"),$(x),Oa(x,"style",A),wM(x,g.precedence,u),f.instance=x;case"stylesheet":A=G_(g.href);var C=u.querySelector(xS(A));if(C)return f.state.loading|=4,f.instance=C,$(C),C;x=cF(g),(A=Gu.get(A))&&y2(x,A),C=(u.ownerDocument||u).createElement("link"),$(C);var G=C;return G._p=new Promise(function(te,_e){G.onload=te,G.onerror=_e}),Oa(C,"link",x),f.state.loading|=4,wM(C,g.precedence,u),f.instance=C;case"script":return C=k_(g.src),(A=u.querySelector(bS(C)))?(f.instance=A,$(A),A):(x=g,(A=Gu.get(C))&&(x=p({},g),_2(x,A)),u=u.ownerDocument||u,A=u.createElement("script"),$(A),Oa(A,"link",x),u.head.appendChild(A),f.instance=A);case"void":return null;default:throw Error(n(443,f.type))}else f.type==="stylesheet"&&(f.state.loading&4)===0&&(x=f.instance,f.state.loading|=4,wM(x,g.precedence,u));return f.instance}function wM(u,f,g){for(var x=g.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),A=x.length?x[x.length-1]:null,C=A,G=0;G<x.length;G++){var te=x[G];if(te.dataset.precedence===f)C=te;else if(C!==A)break}C?C.parentNode.insertBefore(u,C.nextSibling):(f=g.nodeType===9?g.head:g,f.insertBefore(u,f.firstChild))}function y2(u,f){u.crossOrigin==null&&(u.crossOrigin=f.crossOrigin),u.referrerPolicy==null&&(u.referrerPolicy=f.referrerPolicy),u.title==null&&(u.title=f.title)}function _2(u,f){u.crossOrigin==null&&(u.crossOrigin=f.crossOrigin),u.referrerPolicy==null&&(u.referrerPolicy=f.referrerPolicy),u.integrity==null&&(u.integrity=f.integrity)}var RM=null;function dF(u,f,g){if(RM===null){var x=new Map,A=RM=new Map;A.set(g,x)}else A=RM,x=A.get(g),x||(x=new Map,A.set(g,x));if(x.has(u))return x;for(x.set(u,null),g=g.getElementsByTagName(u),A=0;A<g.length;A++){var C=g[A];if(!(C[_t]||C[pn]||u==="link"&&C.getAttribute("rel")==="stylesheet")&&C.namespaceURI!=="http://www.w3.org/2000/svg"){var G=C.getAttribute(f)||"";G=u+G;var te=x.get(G);te?te.push(C):x.set(G,[C])}}return x}function hF(u,f,g){u=u.ownerDocument||u,u.head.insertBefore(g,f==="title"?u.querySelector("head > title"):null)}function fY(u,f,g){if(g===1||f.itemProp!=null)return!1;switch(u){case"meta":case"title":return!0;case"style":if(typeof f.precedence!="string"||typeof f.href!="string"||f.href==="")break;return!0;case"link":if(typeof f.rel!="string"||typeof f.href!="string"||f.href===""||f.onLoad||f.onError)break;switch(f.rel){case"stylesheet":return u=f.disabled,typeof f.precedence=="string"&&u==null;default:return!0}case"script":if(f.async&&typeof f.async!="function"&&typeof f.async!="symbol"&&!f.onLoad&&!f.onError&&f.src&&typeof f.src=="string")return!0}return!1}function pF(u){return!(u.type==="stylesheet"&&(u.state.loading&3)===0)}function dY(u,f,g,x){if(g.type==="stylesheet"&&(typeof x.media!="string"||matchMedia(x.media).matches!==!1)&&(g.state.loading&4)===0){if(g.instance===null){var A=G_(x.href),C=f.querySelector(xS(A));if(C){f=C._p,f!==null&&typeof f=="object"&&typeof f.then=="function"&&(u.count++,u=CM.bind(u),f.then(u,u)),g.state.loading|=4,g.instance=C,$(C);return}C=f.ownerDocument||f,x=cF(x),(A=Gu.get(A))&&y2(x,A),C=C.createElement("link"),$(C);var G=C;G._p=new Promise(function(te,_e){G.onload=te,G.onerror=_e}),Oa(C,"link",x),g.instance=C}u.stylesheets===null&&(u.stylesheets=new Map),u.stylesheets.set(g,f),(f=g.state.preload)&&(g.state.loading&3)===0&&(u.count++,g=CM.bind(u),f.addEventListener("load",g),f.addEventListener("error",g))}}var v2=0;function hY(u,f){return u.stylesheets&&u.count===0&&DM(u,u.stylesheets),0<u.count||0<u.imgCount?function(g){var x=setTimeout(function(){if(u.stylesheets&&DM(u,u.stylesheets),u.unsuspend){var C=u.unsuspend;u.unsuspend=null,C()}},6e4+f);0<u.imgBytes&&v2===0&&(v2=62500*$j());var A=setTimeout(function(){if(u.waitingForImages=!1,u.count===0&&(u.stylesheets&&DM(u,u.stylesheets),u.unsuspend)){var C=u.unsuspend;u.unsuspend=null,C()}},(u.imgBytes>v2?50:800)+f);return u.unsuspend=g,function(){u.unsuspend=null,clearTimeout(x),clearTimeout(A)}}:null}function CM(){if(this.count--,this.count===0&&(this.imgCount===0||!this.waitingForImages)){if(this.stylesheets)DM(this,this.stylesheets);else if(this.unsuspend){var u=this.unsuspend;this.unsuspend=null,u()}}}var NM=null;function DM(u,f){u.stylesheets=null,u.unsuspend!==null&&(u.count++,NM=new Map,f.forEach(pY,u),NM=null,CM.call(u))}function pY(u,f){if(!(f.state.loading&4)){var g=NM.get(u);if(g)var x=g.get(null);else{g=new Map,NM.set(u,g);for(var A=u.querySelectorAll("link[data-precedence],style[data-precedence]"),C=0;C<A.length;C++){var G=A[C];(G.nodeName==="LINK"||G.getAttribute("media")!=="not all")&&(g.set(G.dataset.precedence,G),x=G)}x&&g.set(null,x)}A=f.instance,G=A.getAttribute("data-precedence"),C=g.get(G)||x,C===x&&g.set(null,A),g.set(G,A),this.count++,x=CM.bind(this),A.addEventListener("load",x),A.addEventListener("error",x),C?C.parentNode.insertBefore(A,C.nextSibling):(u=u.nodeType===9?u.head:u,u.insertBefore(A,u.firstChild)),f.state.loading|=4}}var SS={$$typeof:R,Provider:null,Consumer:null,_currentValue:ee,_currentValue2:ee,_threadCount:0};function mY(u,f,g,x,A,C,G,te,_e){this.tag=1,this.containerInfo=u,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=qt(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=qt(0),this.hiddenUpdates=qt(null),this.identifierPrefix=x,this.onUncaughtError=A,this.onCaughtError=C,this.onRecoverableError=G,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=_e,this.incompleteTransitions=new Map}function mF(u,f,g,x,A,C,G,te,_e,ke,ot,xt){return u=new mY(u,f,g,G,_e,ke,ot,xt,te),f=1,C===!0&&(f|=24),C=Aa(3,null,null,f),u.current=C,C.stateNode=u,f=Nb(),f.refCount++,u.pooledCache=f,f.refCount++,C.memoizedState={element:x,isDehydrated:g,cache:f},Bb(C),u}function gF(u){return u?(u=Sf,u):Sf}function yF(u,f,g,x,A,C){A=gF(A),x.context===null?x.context=A:x.pendingContext=A,x=Du(f),x.payload={element:g},C=C===void 0?null:C,C!==null&&(x.callback=C),g=Mc(u,x,f),g!==null&&(m(g,u,f),Nf(g,u,f))}function _F(u,f){if(u=u.memoizedState,u!==null&&u.dehydrated!==null){var g=u.retryLane;u.retryLane=g!==0&&g<f?g:f}}function x2(u,f){_F(u,f),(u=u.alternate)&&_F(u,f)}function vF(u){if(u.tag===13||u.tag===31){var f=bf(u,67108864);f!==null&&m(f,u,67108864),x2(u,67108864)}}function xF(u){if(u.tag===13||u.tag===31){var f=Da();f=wn(f);var g=bf(u,f);g!==null&&m(g,u,f),x2(u,f)}}var OM=!0;function gY(u,f,g,x){var A=V.T;V.T=null;var C=X.p;try{X.p=2,b2(u,f,g,x)}finally{X.p=C,V.T=A}}function yY(u,f,g,x){var A=V.T;V.T=null;var C=X.p;try{X.p=8,b2(u,f,g,x)}finally{X.p=C,V.T=A}}function b2(u,f,g,x){if(OM){var A=S2(x);if(A===null)o2(u,f,x,UM,g),SF(u,x);else if(vY(A,u,f,g,x))x.stopPropagation();else if(SF(u,x),f&4&&-1<_Y.indexOf(u)){for(;A!==null;){var C=gt(A);if(C!==null)switch(C.tag){case 3:if(C=C.stateNode,C.current.memoizedState.isDehydrated){var G=ht(C.pendingLanes);if(G!==0){var te=C;for(te.pendingLanes|=2,te.entangledLanes|=2;G;){var _e=1<<31-ue(G);te.entanglements[1]|=_e,G&=~_e}zf(C),(Mi&6)===0&&(zo=k()+500,gS(0))}}break;case 31:case 13:te=bf(C,2),te!==null&&m(te,C,2),ie(),x2(C,2)}if(C=S2(x),C===null&&o2(u,f,x,UM,g),C===A)break;A=C}A!==null&&x.stopPropagation()}else o2(u,f,x,null,g)}}function S2(u){return u=zy(u),T2(u)}var UM=null;function T2(u){if(UM=null,u=pt(u),u!==null){var f=s(u);if(f===null)u=null;else{var g=f.tag;if(g===13){if(u=a(f),u!==null)return u;u=null}else if(g===31){if(u=o(f),u!==null)return u;u=null}else if(g===3){if(f.stateNode.current.memoizedState.isDehydrated)return f.tag===3?f.stateNode.containerInfo:null;u=null}else f!==u&&(u=null)}}return UM=u,null}function bF(u){switch(u){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(pe()){case Fe:return 2;case He:return 8;case ze:case Bt:return 32;case Ct:return 268435456;default:return 32}default:return 32}}var E2=!1,Dp=null,Op=null,Up=null,TS=new Map,ES=new Map,Lp=[],_Y="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function SF(u,f){switch(u){case"focusin":case"focusout":Dp=null;break;case"dragenter":case"dragleave":Op=null;break;case"mouseover":case"mouseout":Up=null;break;case"pointerover":case"pointerout":TS.delete(f.pointerId);break;case"gotpointercapture":case"lostpointercapture":ES.delete(f.pointerId)}}function MS(u,f,g,x,A,C){return u===null||u.nativeEvent!==C?(u={blockedOn:f,domEventName:g,eventSystemFlags:x,nativeEvent:C,targetContainers:[A]},f!==null&&(f=gt(f),f!==null&&vF(f)),u):(u.eventSystemFlags|=x,f=u.targetContainers,A!==null&&f.indexOf(A)===-1&&f.push(A),u)}function vY(u,f,g,x,A){switch(f){case"focusin":return Dp=MS(Dp,u,f,g,x,A),!0;case"dragenter":return Op=MS(Op,u,f,g,x,A),!0;case"mouseover":return Up=MS(Up,u,f,g,x,A),!0;case"pointerover":var C=A.pointerId;return TS.set(C,MS(TS.get(C)||null,u,f,g,x,A)),!0;case"gotpointercapture":return C=A.pointerId,ES.set(C,MS(ES.get(C)||null,u,f,g,x,A)),!0}return!1}function TF(u){var f=pt(u.target);if(f!==null){var g=s(f);if(g!==null){if(f=g.tag,f===13){if(f=a(g),f!==null){u.blockedOn=f,Jt(u.priority,function(){xF(g)});return}}else if(f===31){if(f=o(g),f!==null){u.blockedOn=f,Jt(u.priority,function(){xF(g)});return}}else if(f===3&&g.stateNode.current.memoizedState.isDehydrated){u.blockedOn=g.tag===3?g.stateNode.containerInfo:null;return}}}u.blockedOn=null}function LM(u){if(u.blockedOn!==null)return!1;for(var f=u.targetContainers;0<f.length;){var g=S2(u.nativeEvent);if(g===null){g=u.nativeEvent;var x=new g.constructor(g.type,g);jm=x,g.target.dispatchEvent(x),jm=null}else return f=gt(g),f!==null&&vF(f),u.blockedOn=g,!1;f.shift()}return!0}function EF(u,f,g){LM(u)&&g.delete(f)}function xY(){E2=!1,Dp!==null&&LM(Dp)&&(Dp=null),Op!==null&&LM(Op)&&(Op=null),Up!==null&&LM(Up)&&(Up=null),TS.forEach(EF),ES.forEach(EF)}function PM(u,f){u.blockedOn===f&&(u.blockedOn=null,E2||(E2=!0,r.unstable_scheduleCallback(r.unstable_NormalPriority,xY)))}var BM=null;function MF(u){BM!==u&&(BM=u,r.unstable_scheduleCallback(r.unstable_NormalPriority,function(){BM===u&&(BM=null);for(var f=0;f<u.length;f+=3){var g=u[f],x=u[f+1],A=u[f+2];if(typeof x!="function"){if(T2(x||g)===null)continue;break}var C=gt(g);C!==null&&(u.splice(f,3),f-=3,oS(C,{pending:!0,data:A,method:g.method,action:x},x,A))}}))}function H_(u){function f(_e){return PM(_e,u)}Dp!==null&&PM(Dp,u),Op!==null&&PM(Op,u),Up!==null&&PM(Up,u),TS.forEach(f),ES.forEach(f);for(var g=0;g<Lp.length;g++){var x=Lp[g];x.blockedOn===u&&(x.blockedOn=null)}for(;0<Lp.length&&(g=Lp[0],g.blockedOn===null);)TF(g),g.blockedOn===null&&Lp.shift();if(g=(u.ownerDocument||u).$$reactFormReplay,g!=null)for(x=0;x<g.length;x+=3){var A=g[x],C=g[x+1],G=A[W]||null;if(typeof C=="function")G||MF(g);else if(G){var te=null;if(C&&C.hasAttribute("formAction")){if(A=C,G=C[W]||null)te=G.formAction;else if(T2(A)!==null)continue}else te=G.action;typeof te=="function"?g[x+1]=te:(g.splice(x,3),x-=3),MF(g)}}}function AF(){function u(C){C.canIntercept&&C.info==="react-transition"&&C.intercept({handler:function(){return new Promise(function(G){return A=G})},focusReset:"manual",scroll:"manual"})}function f(){A!==null&&(A(),A=null),x||setTimeout(g,20)}function g(){if(!x&&!navigation.transition){var C=navigation.currentEntry;C&&C.url!=null&&navigation.navigate(C.url,{state:C.getState(),info:"react-transition",history:"replace"})}}if(typeof navigation=="object"){var x=!1,A=null;return navigation.addEventListener("navigate",u),navigation.addEventListener("navigatesuccess",f),navigation.addEventListener("navigateerror",f),setTimeout(g,100),function(){x=!0,navigation.removeEventListener("navigate",u),navigation.removeEventListener("navigatesuccess",f),navigation.removeEventListener("navigateerror",f),A!==null&&(A(),A=null)}}}function M2(u){this._internalRoot=u}IM.prototype.render=M2.prototype.render=function(u){var f=this._internalRoot;if(f===null)throw Error(n(409));var g=f.current,x=Da();yF(g,x,u,f,null,null)},IM.prototype.unmount=M2.prototype.unmount=function(){var u=this._internalRoot;if(u!==null){this._internalRoot=null;var f=u.containerInfo;yF(u.current,2,null,u,null,null),ie(),f[J]=null}};function IM(u){this._internalRoot=u}IM.prototype.unstable_scheduleHydration=function(u){if(u){var f=Un();u={blockedOn:null,target:u,priority:f};for(var g=0;g<Lp.length&&f!==0&&f<Lp[g].priority;g++);Lp.splice(g,0,u),g===0&&TF(u)}};var wF=e.version;if(wF!=="19.2.3")throw Error(n(527,wF,"19.2.3"));X.findDOMNode=function(u){var f=u._reactInternals;if(f===void 0)throw typeof u.render=="function"?Error(n(188)):(u=Object.keys(u).join(","),Error(n(268,u)));return u=c(f),u=u!==null?d(u):null,u=u===null?null:u.stateNode,u};var bY={bundleType:0,version:"19.2.3",rendererPackageName:"react-dom",currentDispatcherRef:V,reconcilerVersion:"19.2.3"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var FM=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!FM.isDisabled&&FM.supportsFiber)try{st=FM.inject(bY),nt=FM}catch{}}return wS.createRoot=function(u,f){if(!i(u))throw Error(n(299));var g=!1,x="",A=fS,C=gM,G=A_;return f!=null&&(f.unstable_strictMode===!0&&(g=!0),f.identifierPrefix!==void 0&&(x=f.identifierPrefix),f.onUncaughtError!==void 0&&(A=f.onUncaughtError),f.onCaughtError!==void 0&&(C=f.onCaughtError),f.onRecoverableError!==void 0&&(G=f.onRecoverableError)),f=mF(u,1,!1,null,null,g,x,null,A,C,G,AF),u[J]=f.current,a2(u),new M2(f)},wS.hydrateRoot=function(u,f,g){if(!i(u))throw Error(n(299));var x=!1,A="",C=fS,G=gM,te=A_,_e=null;return g!=null&&(g.unstable_strictMode===!0&&(x=!0),g.identifierPrefix!==void 0&&(A=g.identifierPrefix),g.onUncaughtError!==void 0&&(C=g.onUncaughtError),g.onCaughtError!==void 0&&(G=g.onCaughtError),g.onRecoverableError!==void 0&&(te=g.onRecoverableError),g.formState!==void 0&&(_e=g.formState)),f=mF(u,1,!0,f,g??null,x,A,_e,C,G,te,AF),f.context=gF(null),g=f.current,x=Da(),x=wn(x),A=Du(x),A.callback=null,Mc(g,A,x),g=x,f.current.lanes=g,nn(f,g),zf(f),u[J]=f.current,a2(u),new IM(f)},wS.version="19.2.3",wS}var IF;function DY(){if(IF)return w2.exports;IF=1;function r(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(r)}catch(e){console.error(e)}}return r(),w2.exports=NY(),w2.exports}var Sk=DY(),H=Bx();const ve=Ey(H),XU=TY({__proto__:null,default:ve},[H]);var O2={exports:{}},Jd={};var FF;function OY(){return FF||(FF=1,Jd.ConcurrentRoot=1,Jd.ContinuousEventPriority=8,Jd.DefaultEventPriority=32,Jd.DiscreteEventPriority=2,Jd.IdleEventPriority=268435456,Jd.LegacyRoot=0,Jd.NoEventPriority=0),Jd}var zF;function UY(){return zF||(zF=1,O2.exports=OY()),O2.exports}var Tw=UY();const Lm="182",r0={LEFT:0,MIDDLE:1,RIGHT:2,ROTATE:0,DOLLY:1,PAN:2},s0={ROTATE:0,PAN:1,DOLLY_PAN:2,DOLLY_ROTATE:3},$U=0,$w=1,jU=2,LY=3,YU=0,M0=1,MT=2,$c=3,Cl=0,gr=1,xa=2,yo=0,Nl=1,V0=2,G0=3,k0=4,A0=5,La=100,eC=101,tC=102,ZU=103,KU=104,Qf=200,nC=201,iC=202,rC=203,nx=204,ix=205,sC=206,aC=207,oC=208,lC=209,uC=210,Tk=211,Ek=212,Mk=213,Ak=214,rx=0,sx=1,ax=2,Oh=3,ox=4,lx=5,ux=6,cx=7,Ix=0,QU=1,JU=2,ta=0,cC=1,fC=2,dC=3,L1=4,eL=5,hC=6,pC=7,lO="attached",wk="detached",Uh=300,ol=301,oc=302,Lh=303,ym=304,Ph=306,Bh=1e3,Dr=1001,Ih=1002,Ki=1003,P1=1004,PY=1004,jc=1005,BY=1005,ei=1006,dm=1007,IY=1007,Pa=1008,jw=1008,ir=1009,_h=1010,vh=1011,Zu=1012,Hs=1013,Hi=1014,Ci=1015,vi=1016,B1=1017,I1=1018,Dl=1020,F1=35902,z1=35899,mC=1021,Fx=1022,Qi=1023,ba=1026,ho=1027,Pm=1028,Bm=1029,po=1030,My=1031,Rk=1032,Ay=1033,xh=33776,bh=33777,Sh=33778,Th=33779,fx=35840,dx=35841,hx=35842,px=35843,H0=36196,W0=37492,q0=37496,X0=37488,$0=37489,_m=37490,j0=37491,Y0=37808,Z0=37809,K0=37810,Q0=37811,J0=37812,ey=37813,ty=37814,ny=37815,iy=37816,ry=37817,sy=37818,ay=37819,oy=37820,ly=37821,uy=36492,Yw=36494,Zw=36495,cy=36283,fy=36284,vm=36285,dy=36286,Ck=2200,Nk=2201,Dk=2202,t1=2300,Kw=2301,Ew=2302,h0=2400,p0=2401,n1=2402,gC=2500,tL=2501,FY=0,zY=1,VY=2,Ok=3200,GY=3201,kY=3202,HY=3203,Kc=0,nL=1,Jo="",ea="srgb",vu="srgb-linear",hy="linear",an="srgb",Mw="",iL="rg",Uk="ga",Lk=0,Yp=7680,Pk=7681,Bk=7682,Ik=7683,Fk=34055,zk=34056,Vk=5386,Gk=512,kk=513,Hk=514,Wk=515,qk=516,Xk=517,$k=518,Qw=519,yC=512,zx=513,_C=514,Vx=515,vC=516,xC=517,Gx=518,bC=519,xm=35044,tm=35048,WY=35040,qY=35045,XY=35049,$Y=35041,jY=35046,YY=35050,ZY=35042,KY="100",uO="300 es",Ba=2e3,Il=2001,Yc={COMPUTE:"compute",RENDER:"render"},QY={PERSPECTIVE:"perspective",LINEAR:"linear",FLAT:"flat"},JY={NORMAL:"normal",CENTROID:"centroid",SAMPLE:"sample",FIRST:"first",EITHER:"either"};function rL(r){for(let e=r.length-1;e>=0;--e)if(r[e]>=65535)return!0;return!1}const eZ={Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array};function Uv(r,e){return new eZ[r](e)}function mx(r){return ArrayBuffer.isView(r)&&!(r instanceof DataView)}function i1(r){return document.createElementNS("http://www.w3.org/1999/xhtml",r)}function sL(){const r=i1("canvas");return r.style.display="block",r}const VF={};let bm=null;function tZ(r){bm=r}function nZ(){return bm}function gx(...r){const e="THREE."+r.shift();bm?bm("log",e,...r):console.log(e,...r)}function Ve(...r){const e="THREE."+r.shift();bm?bm("warn",e,...r):console.warn(e,...r)}function Ze(...r){const e="THREE."+r.shift();bm?bm("error",e,...r):console.error(e,...r)}function cr(...r){const e=r.join(" ");e in VF||(VF[e]=!0,Ve(...r))}function iZ(r,e,t){return new Promise(function(n,i){function s(){switch(r.clientWaitSync(e,r.SYNC_FLUSH_COMMANDS_BIT,0)){case r.WAIT_FAILED:i();break;case r.TIMEOUT_EXPIRED:setTimeout(s,t);break;default:n()}}setTimeout(s,t)})}let Gl=class{addEventListener(e,t){this._listeners===void 0&&(this._listeners={});const n=this._listeners;n[e]===void 0&&(n[e]=[]),n[e].indexOf(t)===-1&&n[e].push(t)}hasEventListener(e,t){const n=this._listeners;return n===void 0?!1:n[e]!==void 0&&n[e].indexOf(t)!==-1}removeEventListener(e,t){const n=this._listeners;if(n===void 0)return;const i=n[e];if(i!==void 0){const s=i.indexOf(t);s!==-1&&i.splice(s,1)}}dispatchEvent(e){const t=this._listeners;if(t===void 0)return;const n=t[e.type];if(n!==void 0){e.target=this;const i=n.slice(0);for(let s=0,a=i.length;s<a;s++)i[s].call(this,e);e.target=null}}};const io=["00","01","02","03","04","05","06","07","08","09","0a","0b","0c","0d","0e","0f","10","11","12","13","14","15","16","17","18","19","1a","1b","1c","1d","1e","1f","20","21","22","23","24","25","26","27","28","29","2a","2b","2c","2d","2e","2f","30","31","32","33","34","35","36","37","38","39","3a","3b","3c","3d","3e","3f","40","41","42","43","44","45","46","47","48","49","4a","4b","4c","4d","4e","4f","50","51","52","53","54","55","56","57","58","59","5a","5b","5c","5d","5e","5f","60","61","62","63","64","65","66","67","68","69","6a","6b","6c","6d","6e","6f","70","71","72","73","74","75","76","77","78","79","7a","7b","7c","7d","7e","7f","80","81","82","83","84","85","86","87","88","89","8a","8b","8c","8d","8e","8f","90","91","92","93","94","95","96","97","98","99","9a","9b","9c","9d","9e","9f","a0","a1","a2","a3","a4","a5","a6","a7","a8","a9","aa","ab","ac","ad","ae","af","b0","b1","b2","b3","b4","b5","b6","b7","b8","b9","ba","bb","bc","bd","be","bf","c0","c1","c2","c3","c4","c5","c6","c7","c8","c9","ca","cb","cc","cd","ce","cf","d0","d1","d2","d3","d4","d5","d6","d7","d8","d9","da","db","dc","dd","de","df","e0","e1","e2","e3","e4","e5","e6","e7","e8","e9","ea","eb","ec","ed","ee","ef","f0","f1","f2","f3","f4","f5","f6","f7","f8","f9","fa","fb","fc","fd","fe","ff"];let GF=1234567;const w0=Math.PI/180,py=180/Math.PI;function pu(){const r=Math.random()*4294967295|0,e=Math.random()*4294967295|0,t=Math.random()*4294967295|0,n=Math.random()*4294967295|0;return(io[r&255]+io[r>>8&255]+io[r>>16&255]+io[r>>24&255]+"-"+io[e&255]+io[e>>8&255]+"-"+io[e>>16&15|64]+io[e>>24&255]+"-"+io[t&63|128]+io[t>>8&255]+"-"+io[t>>16&255]+io[t>>24&255]+io[n&255]+io[n>>8&255]+io[n>>16&255]+io[n>>24&255]).toLowerCase()}function Yn(r,e,t){return Math.max(e,Math.min(t,r))}function aL(r,e){return(r%e+e)%e}function rZ(r,e,t,n,i){return n+(r-e)*(i-n)/(t-e)}function sZ(r,e,t){return r!==e?(t-r)/(e-r):0}function AT(r,e,t){return(1-t)*r+t*e}function aZ(r,e,t,n){return AT(r,e,1-Math.exp(-t*n))}function oZ(r,e=1){return e-Math.abs(aL(r,e*2)-e)}function lZ(r,e,t){return r<=e?0:r>=t?1:(r=(r-e)/(t-e),r*r*(3-2*r))}function uZ(r,e,t){return r<=e?0:r>=t?1:(r=(r-e)/(t-e),r*r*r*(r*(r*6-15)+10))}function cZ(r,e){return r+Math.floor(Math.random()*(e-r+1))}function fZ(r,e){return r+Math.random()*(e-r)}function dZ(r){return r*(.5-Math.random())}function hZ(r){r!==void 0&&(GF=r);let e=GF+=1831565813;return e=Math.imul(e^e>>>15,e|1),e^=e+Math.imul(e^e>>>7,e|61),((e^e>>>14)>>>0)/4294967296}function pZ(r){return r*w0}function mZ(r){return r*py}function gZ(r){return(r&r-1)===0&&r!==0}function yZ(r){return Math.pow(2,Math.ceil(Math.log(r)/Math.LN2))}function _Z(r){return Math.pow(2,Math.floor(Math.log(r)/Math.LN2))}function vZ(r,e,t,n,i){const s=Math.cos,a=Math.sin,o=s(t/2),l=a(t/2),c=s((e+n)/2),d=a((e+n)/2),p=s((e-n)/2),y=a((e-n)/2),_=s((n-e)/2),v=a((n-e)/2);switch(i){case"XYX":r.set(o*d,l*p,l*y,o*c);break;case"YZY":r.set(l*y,o*d,l*p,o*c);break;case"ZXZ":r.set(l*p,l*y,o*d,o*c);break;case"XZX":r.set(o*d,l*v,l*_,o*c);break;case"YXY":r.set(l*_,o*d,l*v,o*c);break;case"ZYZ":r.set(l*v,l*_,o*d,o*c);break;default:Ve("MathUtils: .setQuaternionFromProperEuler() encountered an unknown order: "+i)}}function el(r,e){switch(e.constructor){case Float32Array:return r;case Uint32Array:return r/4294967295;case Uint16Array:return r/65535;case Uint8Array:return r/255;case Int32Array:return Math.max(r/2147483647,-1);case Int16Array:return Math.max(r/32767,-1);case Int8Array:return Math.max(r/127,-1);default:throw new Error("Invalid component type.")}}function ai(r,e){switch(e.constructor){case Float32Array:return r;case Uint32Array:return Math.round(r*4294967295);case Uint16Array:return Math.round(r*65535);case Uint8Array:return Math.round(r*255);case Int32Array:return Math.round(r*2147483647);case Int16Array:return Math.round(r*32767);case Int8Array:return Math.round(r*127);default:throw new Error("Invalid component type.")}}const oL={DEG2RAD:w0,RAD2DEG:py,generateUUID:pu,clamp:Yn,euclideanModulo:aL,mapLinear:rZ,inverseLerp:sZ,lerp:AT,damp:aZ,pingpong:oZ,smoothstep:lZ,smootherstep:uZ,randInt:cZ,randFloat:fZ,randFloatSpread:dZ,seededRandom:hZ,degToRad:pZ,radToDeg:mZ,isPowerOfTwo:gZ,ceilPowerOfTwo:yZ,floorPowerOfTwo:_Z,setQuaternionFromProperEuler:vZ,normalize:ai,denormalize:el};class tt{constructor(e=0,t=0){tt.prototype.isVector2=!0,this.x=e,this.y=t}get width(){return this.x}set width(e){this.x=e}get height(){return this.y}set height(e){this.y=e}set(e,t){return this.x=e,this.y=t,this}setScalar(e){return this.x=e,this.y=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y)}copy(e){return this.x=e.x,this.y=e.y,this}add(e){return this.x+=e.x,this.y+=e.y,this}addScalar(e){return this.x+=e,this.y+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this}subScalar(e){return this.x-=e,this.y-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this}multiply(e){return this.x*=e.x,this.y*=e.y,this}multiplyScalar(e){return this.x*=e,this.y*=e,this}divide(e){return this.x/=e.x,this.y/=e.y,this}divideScalar(e){return this.multiplyScalar(1/e)}applyMatrix3(e){const t=this.x,n=this.y,i=e.elements;return this.x=i[0]*t+i[3]*n+i[6],this.y=i[1]*t+i[4]*n+i[7],this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this}clamp(e,t){return this.x=Yn(this.x,e.x,t.x),this.y=Yn(this.y,e.y,t.y),this}clampScalar(e,t){return this.x=Yn(this.x,e,t),this.y=Yn(this.y,e,t),this}clampLength(e,t){const n=this.length();return this.divideScalar(n||1).multiplyScalar(Yn(n,e,t))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this}negate(){return this.x=-this.x,this.y=-this.y,this}dot(e){return this.x*e.x+this.y*e.y}cross(e){return this.x*e.y-this.y*e.x}lengthSq(){return this.x*this.x+this.y*this.y}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)}normalize(){return this.divideScalar(this.length()||1)}angle(){return Math.atan2(-this.y,-this.x)+Math.PI}angleTo(e){const t=Math.sqrt(this.lengthSq()*e.lengthSq());if(t===0)return Math.PI/2;const n=this.dot(e)/t;return Math.acos(Yn(n,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const t=this.x-e.x,n=this.y-e.y;return t*t+n*n}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this}lerpVectors(e,t,n){return this.x=e.x+(t.x-e.x)*n,this.y=e.y+(t.y-e.y)*n,this}equals(e){return e.x===this.x&&e.y===this.y}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this}rotateAround(e,t){const n=Math.cos(t),i=Math.sin(t),s=this.x-e.x,a=this.y-e.y;return this.x=s*n-a*i+e.x,this.y=s*i+a*n+e.y,this}random(){return this.x=Math.random(),this.y=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y}}class Va{constructor(e=0,t=0,n=0,i=1){this.isQuaternion=!0,this._x=e,this._y=t,this._z=n,this._w=i}static slerpFlat(e,t,n,i,s,a,o){let l=n[i+0],c=n[i+1],d=n[i+2],p=n[i+3],y=s[a+0],_=s[a+1],v=s[a+2],b=s[a+3];if(o<=0){e[t+0]=l,e[t+1]=c,e[t+2]=d,e[t+3]=p;return}if(o>=1){e[t+0]=y,e[t+1]=_,e[t+2]=v,e[t+3]=b;return}if(p!==b||l!==y||c!==_||d!==v){let E=l*y+c*_+d*v+p*b;E<0&&(y=-y,_=-_,v=-v,b=-b,E=-E);let T=1-o;if(E<.9995){const M=Math.acos(E),R=Math.sin(M);T=Math.sin(T*M)/R,o=Math.sin(o*M)/R,l=l*T+y*o,c=c*T+_*o,d=d*T+v*o,p=p*T+b*o}else{l=l*T+y*o,c=c*T+_*o,d=d*T+v*o,p=p*T+b*o;const M=1/Math.sqrt(l*l+c*c+d*d+p*p);l*=M,c*=M,d*=M,p*=M}}e[t]=l,e[t+1]=c,e[t+2]=d,e[t+3]=p}static multiplyQuaternionsFlat(e,t,n,i,s,a){const o=n[i],l=n[i+1],c=n[i+2],d=n[i+3],p=s[a],y=s[a+1],_=s[a+2],v=s[a+3];return e[t]=o*v+d*p+l*_-c*y,e[t+1]=l*v+d*y+c*p-o*_,e[t+2]=c*v+d*_+o*y-l*p,e[t+3]=d*v-o*p-l*y-c*_,e}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get w(){return this._w}set w(e){this._w=e,this._onChangeCallback()}set(e,t,n,i){return this._x=e,this._y=t,this._z=n,this._w=i,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._w)}copy(e){return this._x=e.x,this._y=e.y,this._z=e.z,this._w=e.w,this._onChangeCallback(),this}setFromEuler(e,t=!0){const n=e._x,i=e._y,s=e._z,a=e._order,o=Math.cos,l=Math.sin,c=o(n/2),d=o(i/2),p=o(s/2),y=l(n/2),_=l(i/2),v=l(s/2);switch(a){case"XYZ":this._x=y*d*p+c*_*v,this._y=c*_*p-y*d*v,this._z=c*d*v+y*_*p,this._w=c*d*p-y*_*v;break;case"YXZ":this._x=y*d*p+c*_*v,this._y=c*_*p-y*d*v,this._z=c*d*v-y*_*p,this._w=c*d*p+y*_*v;break;case"ZXY":this._x=y*d*p-c*_*v,this._y=c*_*p+y*d*v,this._z=c*d*v+y*_*p,this._w=c*d*p-y*_*v;break;case"ZYX":this._x=y*d*p-c*_*v,this._y=c*_*p+y*d*v,this._z=c*d*v-y*_*p,this._w=c*d*p+y*_*v;break;case"YZX":this._x=y*d*p+c*_*v,this._y=c*_*p+y*d*v,this._z=c*d*v-y*_*p,this._w=c*d*p-y*_*v;break;case"XZY":this._x=y*d*p-c*_*v,this._y=c*_*p-y*d*v,this._z=c*d*v+y*_*p,this._w=c*d*p+y*_*v;break;default:Ve("Quaternion: .setFromEuler() encountered an unknown order: "+a)}return t===!0&&this._onChangeCallback(),this}setFromAxisAngle(e,t){const n=t/2,i=Math.sin(n);return this._x=e.x*i,this._y=e.y*i,this._z=e.z*i,this._w=Math.cos(n),this._onChangeCallback(),this}setFromRotationMatrix(e){const t=e.elements,n=t[0],i=t[4],s=t[8],a=t[1],o=t[5],l=t[9],c=t[2],d=t[6],p=t[10],y=n+o+p;if(y>0){const _=.5/Math.sqrt(y+1);this._w=.25/_,this._x=(d-l)*_,this._y=(s-c)*_,this._z=(a-i)*_}else if(n>o&&n>p){const _=2*Math.sqrt(1+n-o-p);this._w=(d-l)/_,this._x=.25*_,this._y=(i+a)/_,this._z=(s+c)/_}else if(o>p){const _=2*Math.sqrt(1+o-n-p);this._w=(s-c)/_,this._x=(i+a)/_,this._y=.25*_,this._z=(l+d)/_}else{const _=2*Math.sqrt(1+p-n-o);this._w=(a-i)/_,this._x=(s+c)/_,this._y=(l+d)/_,this._z=.25*_}return this._onChangeCallback(),this}setFromUnitVectors(e,t){let n=e.dot(t)+1;return n<1e-8?(n=0,Math.abs(e.x)>Math.abs(e.z)?(this._x=-e.y,this._y=e.x,this._z=0,this._w=n):(this._x=0,this._y=-e.z,this._z=e.y,this._w=n)):(this._x=e.y*t.z-e.z*t.y,this._y=e.z*t.x-e.x*t.z,this._z=e.x*t.y-e.y*t.x,this._w=n),this.normalize()}angleTo(e){return 2*Math.acos(Math.abs(Yn(this.dot(e),-1,1)))}rotateTowards(e,t){const n=this.angleTo(e);if(n===0)return this;const i=Math.min(1,t/n);return this.slerp(e,i),this}identity(){return this.set(0,0,0,1)}invert(){return this.conjugate()}conjugate(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this}dot(e){return this._x*e._x+this._y*e._y+this._z*e._z+this._w*e._w}lengthSq(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w}length(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)}normalize(){let e=this.length();return e===0?(this._x=0,this._y=0,this._z=0,this._w=1):(e=1/e,this._x=this._x*e,this._y=this._y*e,this._z=this._z*e,this._w=this._w*e),this._onChangeCallback(),this}multiply(e){return this.multiplyQuaternions(this,e)}premultiply(e){return this.multiplyQuaternions(e,this)}multiplyQuaternions(e,t){const n=e._x,i=e._y,s=e._z,a=e._w,o=t._x,l=t._y,c=t._z,d=t._w;return this._x=n*d+a*o+i*c-s*l,this._y=i*d+a*l+s*o-n*c,this._z=s*d+a*c+n*l-i*o,this._w=a*d-n*o-i*l-s*c,this._onChangeCallback(),this}slerp(e,t){if(t<=0)return this;if(t>=1)return this.copy(e);let n=e._x,i=e._y,s=e._z,a=e._w,o=this.dot(e);o<0&&(n=-n,i=-i,s=-s,a=-a,o=-o);let l=1-t;if(o<.9995){const c=Math.acos(o),d=Math.sin(c);l=Math.sin(l*c)/d,t=Math.sin(t*c)/d,this._x=this._x*l+n*t,this._y=this._y*l+i*t,this._z=this._z*l+s*t,this._w=this._w*l+a*t,this._onChangeCallback()}else this._x=this._x*l+n*t,this._y=this._y*l+i*t,this._z=this._z*l+s*t,this._w=this._w*l+a*t,this.normalize();return this}slerpQuaternions(e,t,n){return this.copy(e).slerp(t,n)}random(){const e=2*Math.PI*Math.random(),t=2*Math.PI*Math.random(),n=Math.random(),i=Math.sqrt(1-n),s=Math.sqrt(n);return this.set(i*Math.sin(e),i*Math.cos(e),s*Math.sin(t),s*Math.cos(t))}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._w===this._w}fromArray(e,t=0){return this._x=e[t],this._y=e[t+1],this._z=e[t+2],this._w=e[t+3],this._onChangeCallback(),this}toArray(e=[],t=0){return e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._w,e}fromBufferAttribute(e,t){return this._x=e.getX(t),this._y=e.getY(t),this._z=e.getZ(t),this._w=e.getW(t),this._onChangeCallback(),this}toJSON(){return this.toArray()}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._w}}class ne{constructor(e=0,t=0,n=0){ne.prototype.isVector3=!0,this.x=e,this.y=t,this.z=n}set(e,t,n){return n===void 0&&(n=this.z),this.x=e,this.y=t,this.z=n,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this}multiplyVectors(e,t){return this.x=e.x*t.x,this.y=e.y*t.y,this.z=e.z*t.z,this}applyEuler(e){return this.applyQuaternion(kF.setFromEuler(e))}applyAxisAngle(e,t){return this.applyQuaternion(kF.setFromAxisAngle(e,t))}applyMatrix3(e){const t=this.x,n=this.y,i=this.z,s=e.elements;return this.x=s[0]*t+s[3]*n+s[6]*i,this.y=s[1]*t+s[4]*n+s[7]*i,this.z=s[2]*t+s[5]*n+s[8]*i,this}applyNormalMatrix(e){return this.applyMatrix3(e).normalize()}applyMatrix4(e){const t=this.x,n=this.y,i=this.z,s=e.elements,a=1/(s[3]*t+s[7]*n+s[11]*i+s[15]);return this.x=(s[0]*t+s[4]*n+s[8]*i+s[12])*a,this.y=(s[1]*t+s[5]*n+s[9]*i+s[13])*a,this.z=(s[2]*t+s[6]*n+s[10]*i+s[14])*a,this}applyQuaternion(e){const t=this.x,n=this.y,i=this.z,s=e.x,a=e.y,o=e.z,l=e.w,c=2*(a*i-o*n),d=2*(o*t-s*i),p=2*(s*n-a*t);return this.x=t+l*c+a*p-o*d,this.y=n+l*d+o*c-s*p,this.z=i+l*p+s*d-a*c,this}project(e){return this.applyMatrix4(e.matrixWorldInverse).applyMatrix4(e.projectionMatrix)}unproject(e){return this.applyMatrix4(e.projectionMatrixInverse).applyMatrix4(e.matrixWorld)}transformDirection(e){const t=this.x,n=this.y,i=this.z,s=e.elements;return this.x=s[0]*t+s[4]*n+s[8]*i,this.y=s[1]*t+s[5]*n+s[9]*i,this.z=s[2]*t+s[6]*n+s[10]*i,this.normalize()}divide(e){return this.x/=e.x,this.y/=e.y,this.z/=e.z,this}divideScalar(e){return this.multiplyScalar(1/e)}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this}clamp(e,t){return this.x=Yn(this.x,e.x,t.x),this.y=Yn(this.y,e.y,t.y),this.z=Yn(this.z,e.z,t.z),this}clampScalar(e,t){return this.x=Yn(this.x,e,t),this.y=Yn(this.y,e,t),this.z=Yn(this.z,e,t),this}clampLength(e,t){const n=this.length();return this.divideScalar(n||1).multiplyScalar(Yn(n,e,t))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this.z=Math.trunc(this.z),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this}lerpVectors(e,t,n){return this.x=e.x+(t.x-e.x)*n,this.y=e.y+(t.y-e.y)*n,this.z=e.z+(t.z-e.z)*n,this}cross(e){return this.crossVectors(this,e)}crossVectors(e,t){const n=e.x,i=e.y,s=e.z,a=t.x,o=t.y,l=t.z;return this.x=i*l-s*o,this.y=s*a-n*l,this.z=n*o-i*a,this}projectOnVector(e){const t=e.lengthSq();if(t===0)return this.set(0,0,0);const n=e.dot(this)/t;return this.copy(e).multiplyScalar(n)}projectOnPlane(e){return U2.copy(this).projectOnVector(e),this.sub(U2)}reflect(e){return this.sub(U2.copy(e).multiplyScalar(2*this.dot(e)))}angleTo(e){const t=Math.sqrt(this.lengthSq()*e.lengthSq());if(t===0)return Math.PI/2;const n=this.dot(e)/t;return Math.acos(Yn(n,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){const t=this.x-e.x,n=this.y-e.y,i=this.z-e.z;return t*t+n*n+i*i}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)+Math.abs(this.z-e.z)}setFromSpherical(e){return this.setFromSphericalCoords(e.radius,e.phi,e.theta)}setFromSphericalCoords(e,t,n){const i=Math.sin(t)*e;return this.x=i*Math.sin(n),this.y=Math.cos(t)*e,this.z=i*Math.cos(n),this}setFromCylindrical(e){return this.setFromCylindricalCoords(e.radius,e.theta,e.y)}setFromCylindricalCoords(e,t,n){return this.x=e*Math.sin(t),this.y=n,this.z=e*Math.cos(t),this}setFromMatrixPosition(e){const t=e.elements;return this.x=t[12],this.y=t[13],this.z=t[14],this}setFromMatrixScale(e){const t=this.setFromMatrixColumn(e,0).length(),n=this.setFromMatrixColumn(e,1).length(),i=this.setFromMatrixColumn(e,2).length();return this.x=t,this.y=n,this.z=i,this}setFromMatrixColumn(e,t){return this.fromArray(e.elements,t*4)}setFromMatrix3Column(e,t){return this.fromArray(e.elements,t*3)}setFromEuler(e){return this.x=e._x,this.y=e._y,this.z=e._z,this}setFromColor(e){return this.x=e.r,this.y=e.g,this.z=e.b,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this.z=e[t+2],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this}randomDirection(){const e=Math.random()*Math.PI*2,t=Math.random()*2-1,n=Math.sqrt(1-t*t);return this.x=n*Math.cos(e),this.y=t,this.z=n*Math.sin(e),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z}}const U2=new ne,kF=new Va;class Zn{constructor(e,t,n,i,s,a,o,l,c){Zn.prototype.isMatrix3=!0,this.elements=[1,0,0,0,1,0,0,0,1],e!==void 0&&this.set(e,t,n,i,s,a,o,l,c)}set(e,t,n,i,s,a,o,l,c){const d=this.elements;return d[0]=e,d[1]=i,d[2]=o,d[3]=t,d[4]=s,d[5]=l,d[6]=n,d[7]=a,d[8]=c,this}identity(){return this.set(1,0,0,0,1,0,0,0,1),this}copy(e){const t=this.elements,n=e.elements;return t[0]=n[0],t[1]=n[1],t[2]=n[2],t[3]=n[3],t[4]=n[4],t[5]=n[5],t[6]=n[6],t[7]=n[7],t[8]=n[8],this}extractBasis(e,t,n){return e.setFromMatrix3Column(this,0),t.setFromMatrix3Column(this,1),n.setFromMatrix3Column(this,2),this}setFromMatrix4(e){const t=e.elements;return this.set(t[0],t[4],t[8],t[1],t[5],t[9],t[2],t[6],t[10]),this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,t){const n=e.elements,i=t.elements,s=this.elements,a=n[0],o=n[3],l=n[6],c=n[1],d=n[4],p=n[7],y=n[2],_=n[5],v=n[8],b=i[0],E=i[3],T=i[6],M=i[1],R=i[4],N=i[7],P=i[2],U=i[5],L=i[8];return s[0]=a*b+o*M+l*P,s[3]=a*E+o*R+l*U,s[6]=a*T+o*N+l*L,s[1]=c*b+d*M+p*P,s[4]=c*E+d*R+p*U,s[7]=c*T+d*N+p*L,s[2]=y*b+_*M+v*P,s[5]=y*E+_*R+v*U,s[8]=y*T+_*N+v*L,this}multiplyScalar(e){const t=this.elements;return t[0]*=e,t[3]*=e,t[6]*=e,t[1]*=e,t[4]*=e,t[7]*=e,t[2]*=e,t[5]*=e,t[8]*=e,this}determinant(){const e=this.elements,t=e[0],n=e[1],i=e[2],s=e[3],a=e[4],o=e[5],l=e[6],c=e[7],d=e[8];return t*a*d-t*o*c-n*s*d+n*o*l+i*s*c-i*a*l}invert(){const e=this.elements,t=e[0],n=e[1],i=e[2],s=e[3],a=e[4],o=e[5],l=e[6],c=e[7],d=e[8],p=d*a-o*c,y=o*l-d*s,_=c*s-a*l,v=t*p+n*y+i*_;if(v===0)return this.set(0,0,0,0,0,0,0,0,0);const b=1/v;return e[0]=p*b,e[1]=(i*c-d*n)*b,e[2]=(o*n-i*a)*b,e[3]=y*b,e[4]=(d*t-i*l)*b,e[5]=(i*s-o*t)*b,e[6]=_*b,e[7]=(n*l-c*t)*b,e[8]=(a*t-n*s)*b,this}transpose(){let e;const t=this.elements;return e=t[1],t[1]=t[3],t[3]=e,e=t[2],t[2]=t[6],t[6]=e,e=t[5],t[5]=t[7],t[7]=e,this}getNormalMatrix(e){return this.setFromMatrix4(e).invert().transpose()}transposeIntoArray(e){const t=this.elements;return e[0]=t[0],e[1]=t[3],e[2]=t[6],e[3]=t[1],e[4]=t[4],e[5]=t[7],e[6]=t[2],e[7]=t[5],e[8]=t[8],this}setUvTransform(e,t,n,i,s,a,o){const l=Math.cos(s),c=Math.sin(s);return this.set(n*l,n*c,-n*(l*a+c*o)+a+e,-i*c,i*l,-i*(-c*a+l*o)+o+t,0,0,1),this}scale(e,t){return this.premultiply(L2.makeScale(e,t)),this}rotate(e){return this.premultiply(L2.makeRotation(-e)),this}translate(e,t){return this.premultiply(L2.makeTranslation(e,t)),this}makeTranslation(e,t){return e.isVector2?this.set(1,0,e.x,0,1,e.y,0,0,1):this.set(1,0,e,0,1,t,0,0,1),this}makeRotation(e){const t=Math.cos(e),n=Math.sin(e);return this.set(t,-n,0,n,t,0,0,0,1),this}makeScale(e,t){return this.set(e,0,0,0,t,0,0,0,1),this}equals(e){const t=this.elements,n=e.elements;for(let i=0;i<9;i++)if(t[i]!==n[i])return!1;return!0}fromArray(e,t=0){for(let n=0;n<9;n++)this.elements[n]=e[n+t];return this}toArray(e=[],t=0){const n=this.elements;return e[t]=n[0],e[t+1]=n[1],e[t+2]=n[2],e[t+3]=n[3],e[t+4]=n[4],e[t+5]=n[5],e[t+6]=n[6],e[t+7]=n[7],e[t+8]=n[8],e}clone(){return new this.constructor().fromArray(this.elements)}}const L2=new Zn,HF=new Zn().set(.4123908,.3575843,.1804808,.212639,.7151687,.0721923,.0193308,.1191948,.9505322),WF=new Zn().set(3.2409699,-1.5373832,-.4986108,-.9692436,1.8759675,.0415551,.0556301,-.203977,1.0569715);function xZ(){const r={enabled:!0,workingColorSpace:vu,spaces:{},convert:function(i,s,a){return this.enabled===!1||s===a||!s||!a||(this.spaces[s].transfer===an&&(i.r=Eh(i.r),i.g=Eh(i.g),i.b=Eh(i.b)),this.spaces[s].primaries!==this.spaces[a].primaries&&(i.applyMatrix3(this.spaces[s].toXYZ),i.applyMatrix3(this.spaces[a].fromXYZ)),this.spaces[a].transfer===an&&(i.r=Gv(i.r),i.g=Gv(i.g),i.b=Gv(i.b))),i},workingToColorSpace:function(i,s){return this.convert(i,this.workingColorSpace,s)},colorSpaceToWorking:function(i,s){return this.convert(i,s,this.workingColorSpace)},getPrimaries:function(i){return this.spaces[i].primaries},getTransfer:function(i){return i===Jo?hy:this.spaces[i].transfer},getToneMappingMode:function(i){return this.spaces[i].outputColorSpaceConfig.toneMappingMode||"standard"},getLuminanceCoefficients:function(i,s=this.workingColorSpace){return i.fromArray(this.spaces[s].luminanceCoefficients)},define:function(i){Object.assign(this.spaces,i)},_getMatrix:function(i,s,a){return i.copy(this.spaces[s].toXYZ).multiply(this.spaces[a].fromXYZ)},_getDrawingBufferColorSpace:function(i){return this.spaces[i].outputColorSpaceConfig.drawingBufferColorSpace},_getUnpackColorSpace:function(i=this.workingColorSpace){return this.spaces[i].workingColorSpaceConfig.unpackColorSpace},fromWorkingColorSpace:function(i,s){return cr("ColorManagement: .fromWorkingColorSpace() has been renamed to .workingToColorSpace()."),r.workingToColorSpace(i,s)},toWorkingColorSpace:function(i,s){return cr("ColorManagement: .toWorkingColorSpace() has been renamed to .colorSpaceToWorking()."),r.colorSpaceToWorking(i,s)}},e=[.64,.33,.3,.6,.15,.06],t=[.2126,.7152,.0722],n=[.3127,.329];return r.define({[vu]:{primaries:e,whitePoint:n,transfer:hy,toXYZ:HF,fromXYZ:WF,luminanceCoefficients:t,workingColorSpaceConfig:{unpackColorSpace:ea},outputColorSpaceConfig:{drawingBufferColorSpace:ea}},[ea]:{primaries:e,whitePoint:n,transfer:an,toXYZ:HF,fromXYZ:WF,luminanceCoefficients:t,outputColorSpaceConfig:{drawingBufferColorSpace:ea}}}),r}const Nn=xZ();function Eh(r){return r<.04045?r*.0773993808:Math.pow(r*.9478672986+.0521327014,2.4)}function Gv(r){return r<.0031308?r*12.92:1.055*Math.pow(r,.41666)-.055}let W_;class jk{static getDataURL(e,t="image/png"){if(/^data:/i.test(e.src)||typeof HTMLCanvasElement>"u")return e.src;let n;if(e instanceof HTMLCanvasElement)n=e;else{W_===void 0&&(W_=i1("canvas")),W_.width=e.width,W_.height=e.height;const i=W_.getContext("2d");e instanceof ImageData?i.putImageData(e,0,0):i.drawImage(e,0,0,e.width,e.height),n=W_}return n.toDataURL(t)}static sRGBToLinear(e){if(typeof HTMLImageElement<"u"&&e instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&e instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&e instanceof ImageBitmap){const t=i1("canvas");t.width=e.width,t.height=e.height;const n=t.getContext("2d");n.drawImage(e,0,0,e.width,e.height);const i=n.getImageData(0,0,e.width,e.height),s=i.data;for(let a=0;a<s.length;a++)s[a]=Eh(s[a]/255)*255;return n.putImageData(i,0,0),t}else if(e.data){const t=e.data.slice(0);for(let n=0;n<t.length;n++)t instanceof Uint8Array||t instanceof Uint8ClampedArray?t[n]=Math.floor(Eh(t[n]/255)*255):t[n]=Eh(t[n]);return{data:t,width:e.width,height:e.height}}else return Ve("ImageUtils.sRGBToLinear(): Unsupported image type. No color space conversion applied."),e}}let bZ=0;class nm{constructor(e=null){this.isSource=!0,Object.defineProperty(this,"id",{value:bZ++}),this.uuid=pu(),this.data=e,this.dataReady=!0,this.version=0}getSize(e){const t=this.data;return typeof HTMLVideoElement<"u"&&t instanceof HTMLVideoElement?e.set(t.videoWidth,t.videoHeight,0):typeof VideoFrame<"u"&&t instanceof VideoFrame?e.set(t.displayHeight,t.displayWidth,0):t!==null?e.set(t.width,t.height,t.depth||0):e.set(0,0,0),e}set needsUpdate(e){e===!0&&this.version++}toJSON(e){const t=e===void 0||typeof e=="string";if(!t&&e.images[this.uuid]!==void 0)return e.images[this.uuid];const n={uuid:this.uuid,url:""},i=this.data;if(i!==null){let s;if(Array.isArray(i)){s=[];for(let a=0,o=i.length;a<o;a++)i[a].isDataTexture?s.push(P2(i[a].image)):s.push(P2(i[a]))}else s=P2(i);n.url=s}return t||(e.images[this.uuid]=n),n}}function P2(r){return typeof HTMLImageElement<"u"&&r instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&r instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&r instanceof ImageBitmap?jk.getDataURL(r):r.data?{data:Array.from(r.data),width:r.width,height:r.height,type:r.data.constructor.name}:(Ve("Texture: Unable to serialize Texture."),{})}let SZ=0;const B2=new ne;class sr extends Gl{constructor(e=sr.DEFAULT_IMAGE,t=sr.DEFAULT_MAPPING,n=Dr,i=Dr,s=ei,a=Pa,o=Qi,l=ir,c=sr.DEFAULT_ANISOTROPY,d=Jo){super(),this.isTexture=!0,Object.defineProperty(this,"id",{value:SZ++}),this.uuid=pu(),this.name="",this.source=new nm(e),this.mipmaps=[],this.mapping=t,this.channel=0,this.wrapS=n,this.wrapT=i,this.magFilter=s,this.minFilter=a,this.anisotropy=c,this.format=o,this.internalFormat=null,this.type=l,this.offset=new tt(0,0),this.repeat=new tt(1,1),this.center=new tt(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new Zn,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,this.colorSpace=d,this.userData={},this.updateRanges=[],this.version=0,this.onUpdate=null,this.renderTarget=null,this.isRenderTargetTexture=!1,this.isArrayTexture=!!(e&&e.depth&&e.depth>1),this.pmremVersion=0}get width(){return this.source.getSize(B2).x}get height(){return this.source.getSize(B2).y}get depth(){return this.source.getSize(B2).z}get image(){return this.source.data}set image(e=null){this.source.data=e}updateMatrix(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)}addUpdateRange(e,t){this.updateRanges.push({start:e,count:t})}clearUpdateRanges(){this.updateRanges.length=0}clone(){return new this.constructor().copy(this)}copy(e){return this.name=e.name,this.source=e.source,this.mipmaps=e.mipmaps.slice(0),this.mapping=e.mapping,this.channel=e.channel,this.wrapS=e.wrapS,this.wrapT=e.wrapT,this.magFilter=e.magFilter,this.minFilter=e.minFilter,this.anisotropy=e.anisotropy,this.format=e.format,this.internalFormat=e.internalFormat,this.type=e.type,this.offset.copy(e.offset),this.repeat.copy(e.repeat),this.center.copy(e.center),this.rotation=e.rotation,this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrix.copy(e.matrix),this.generateMipmaps=e.generateMipmaps,this.premultiplyAlpha=e.premultiplyAlpha,this.flipY=e.flipY,this.unpackAlignment=e.unpackAlignment,this.colorSpace=e.colorSpace,this.renderTarget=e.renderTarget,this.isRenderTargetTexture=e.isRenderTargetTexture,this.isArrayTexture=e.isArrayTexture,this.userData=JSON.parse(JSON.stringify(e.userData)),this.needsUpdate=!0,this}setValues(e){for(const t in e){const n=e[t];if(n===void 0){Ve(`Texture.setValues(): parameter '${t}' has value of undefined.`);continue}const i=this[t];if(i===void 0){Ve(`Texture.setValues(): property '${t}' does not exist.`);continue}i&&n&&i.isVector2&&n.isVector2||i&&n&&i.isVector3&&n.isVector3||i&&n&&i.isMatrix3&&n.isMatrix3?i.copy(n):this[t]=n}}toJSON(e){const t=e===void 0||typeof e=="string";if(!t&&e.textures[this.uuid]!==void 0)return e.textures[this.uuid];const n={metadata:{version:4.7,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,image:this.source.toJSON(e).uuid,mapping:this.mapping,channel:this.channel,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,internalFormat:this.internalFormat,type:this.type,colorSpace:this.colorSpace,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY,generateMipmaps:this.generateMipmaps,premultiplyAlpha:this.premultiplyAlpha,unpackAlignment:this.unpackAlignment};return Object.keys(this.userData).length>0&&(n.userData=this.userData),t||(e.textures[this.uuid]=n),n}dispose(){this.dispatchEvent({type:"dispose"})}transformUv(e){if(this.mapping!==Uh)return e;if(e.applyMatrix3(this.matrix),e.x<0||e.x>1)switch(this.wrapS){case Bh:e.x=e.x-Math.floor(e.x);break;case Dr:e.x=e.x<0?0:1;break;case Ih:Math.abs(Math.floor(e.x)%2)===1?e.x=Math.ceil(e.x)-e.x:e.x=e.x-Math.floor(e.x);break}if(e.y<0||e.y>1)switch(this.wrapT){case Bh:e.y=e.y-Math.floor(e.y);break;case Dr:e.y=e.y<0?0:1;break;case Ih:Math.abs(Math.floor(e.y)%2)===1?e.y=Math.ceil(e.y)-e.y:e.y=e.y-Math.floor(e.y);break}return this.flipY&&(e.y=1-e.y),e}set needsUpdate(e){e===!0&&(this.version++,this.source.needsUpdate=!0)}set needsPMREMUpdate(e){e===!0&&this.pmremVersion++}}sr.DEFAULT_IMAGE=null;sr.DEFAULT_MAPPING=Uh;sr.DEFAULT_ANISOTROPY=1;class zn{constructor(e=0,t=0,n=0,i=1){zn.prototype.isVector4=!0,this.x=e,this.y=t,this.z=n,this.w=i}get width(){return this.z}set width(e){this.z=e}get height(){return this.w}set height(e){this.w=e}set(e,t,n,i){return this.x=e,this.y=t,this.z=n,this.w=i,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this.w=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setW(e){return this.w=e,this}setComponent(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;case 3:this.w=t;break;default:throw new Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z,this.w)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this.w=e.w!==void 0?e.w:1,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this.w+=e.w,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this.w+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this.w=e.w+t.w,this}addScaledVector(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this.w+=e.w*t,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this.w-=e.w,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this.w-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this.w=e.w-t.w,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this.w*=e.w,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this.w*=e,this}applyMatrix4(e){const t=this.x,n=this.y,i=this.z,s=this.w,a=e.elements;return this.x=a[0]*t+a[4]*n+a[8]*i+a[12]*s,this.y=a[1]*t+a[5]*n+a[9]*i+a[13]*s,this.z=a[2]*t+a[6]*n+a[10]*i+a[14]*s,this.w=a[3]*t+a[7]*n+a[11]*i+a[15]*s,this}divide(e){return this.x/=e.x,this.y/=e.y,this.z/=e.z,this.w/=e.w,this}divideScalar(e){return this.multiplyScalar(1/e)}setAxisAngleFromQuaternion(e){this.w=2*Math.acos(e.w);const t=Math.sqrt(1-e.w*e.w);return t<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=e.x/t,this.y=e.y/t,this.z=e.z/t),this}setAxisAngleFromRotationMatrix(e){let t,n,i,s;const l=e.elements,c=l[0],d=l[4],p=l[8],y=l[1],_=l[5],v=l[9],b=l[2],E=l[6],T=l[10];if(Math.abs(d-y)<.01&&Math.abs(p-b)<.01&&Math.abs(v-E)<.01){if(Math.abs(d+y)<.1&&Math.abs(p+b)<.1&&Math.abs(v+E)<.1&&Math.abs(c+_+T-3)<.1)return this.set(1,0,0,0),this;t=Math.PI;const R=(c+1)/2,N=(_+1)/2,P=(T+1)/2,U=(d+y)/4,L=(p+b)/4,F=(v+E)/4;return R>N&&R>P?R<.01?(n=0,i=.707106781,s=.707106781):(n=Math.sqrt(R),i=U/n,s=L/n):N>P?N<.01?(n=.707106781,i=0,s=.707106781):(i=Math.sqrt(N),n=U/i,s=F/i):P<.01?(n=.707106781,i=.707106781,s=0):(s=Math.sqrt(P),n=L/s,i=F/s),this.set(n,i,s,t),this}let M=Math.sqrt((E-v)*(E-v)+(p-b)*(p-b)+(y-d)*(y-d));return Math.abs(M)<.001&&(M=1),this.x=(E-v)/M,this.y=(p-b)/M,this.z=(y-d)/M,this.w=Math.acos((c+_+T-1)/2),this}setFromMatrixPosition(e){const t=e.elements;return this.x=t[12],this.y=t[13],this.z=t[14],this.w=t[15],this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this.w=Math.min(this.w,e.w),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this.w=Math.max(this.w,e.w),this}clamp(e,t){return this.x=Yn(this.x,e.x,t.x),this.y=Yn(this.y,e.y,t.y),this.z=Yn(this.z,e.z,t.z),this.w=Yn(this.w,e.w,t.w),this}clampScalar(e,t){return this.x=Yn(this.x,e,t),this.y=Yn(this.y,e,t),this.z=Yn(this.z,e,t),this.w=Yn(this.w,e,t),this}clampLength(e,t){const n=this.length();return this.divideScalar(n||1).multiplyScalar(Yn(n,e,t))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this.z=Math.trunc(this.z),this.w=Math.trunc(this.w),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z+this.w*e.w}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this.w+=(e.w-this.w)*t,this}lerpVectors(e,t,n){return this.x=e.x+(t.x-e.x)*n,this.y=e.y+(t.y-e.y)*n,this.z=e.z+(t.z-e.z)*n,this.w=e.w+(t.w-e.w)*n,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z&&e.w===this.w}fromArray(e,t=0){return this.x=e[t],this.y=e[t+1],this.z=e[t+2],this.w=e[t+3],this}toArray(e=[],t=0){return e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e[t+3]=this.w,e}fromBufferAttribute(e,t){return this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this.w=e.getW(t),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this.w=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z,yield this.w}}class sf extends Gl{constructor(e=1,t=1,n={}){super(),n=Object.assign({generateMipmaps:!1,internalFormat:null,minFilter:ei,depthBuffer:!0,stencilBuffer:!1,resolveDepthBuffer:!0,resolveStencilBuffer:!0,depthTexture:null,samples:0,count:1,depth:1,multiview:!1},n),this.isRenderTarget=!0,this.width=e,this.height=t,this.depth=n.depth,this.scissor=new zn(0,0,e,t),this.scissorTest=!1,this.viewport=new zn(0,0,e,t);const i={width:e,height:t,depth:n.depth},s=new sr(i);this.textures=[];const a=n.count;for(let o=0;o<a;o++)this.textures[o]=s.clone(),this.textures[o].isRenderTargetTexture=!0,this.textures[o].renderTarget=this;this._setTextureOptions(n),this.depthBuffer=n.depthBuffer,this.stencilBuffer=n.stencilBuffer,this.resolveDepthBuffer=n.resolveDepthBuffer,this.resolveStencilBuffer=n.resolveStencilBuffer,this._depthTexture=null,this.depthTexture=n.depthTexture,this.samples=n.samples,this.multiview=n.multiview}_setTextureOptions(e={}){const t={minFilter:ei,generateMipmaps:!1,flipY:!1,internalFormat:null};e.mapping!==void 0&&(t.mapping=e.mapping),e.wrapS!==void 0&&(t.wrapS=e.wrapS),e.wrapT!==void 0&&(t.wrapT=e.wrapT),e.wrapR!==void 0&&(t.wrapR=e.wrapR),e.magFilter!==void 0&&(t.magFilter=e.magFilter),e.minFilter!==void 0&&(t.minFilter=e.minFilter),e.format!==void 0&&(t.format=e.format),e.type!==void 0&&(t.type=e.type),e.anisotropy!==void 0&&(t.anisotropy=e.anisotropy),e.colorSpace!==void 0&&(t.colorSpace=e.colorSpace),e.flipY!==void 0&&(t.flipY=e.flipY),e.generateMipmaps!==void 0&&(t.generateMipmaps=e.generateMipmaps),e.internalFormat!==void 0&&(t.internalFormat=e.internalFormat);for(let n=0;n<this.textures.length;n++)this.textures[n].setValues(t)}get texture(){return this.textures[0]}set texture(e){this.textures[0]=e}set depthTexture(e){this._depthTexture!==null&&(this._depthTexture.renderTarget=null),e!==null&&(e.renderTarget=this),this._depthTexture=e}get depthTexture(){return this._depthTexture}setSize(e,t,n=1){if(this.width!==e||this.height!==t||this.depth!==n){this.width=e,this.height=t,this.depth=n;for(let i=0,s=this.textures.length;i<s;i++)this.textures[i].image.width=e,this.textures[i].image.height=t,this.textures[i].image.depth=n,this.textures[i].isData3DTexture!==!0&&(this.textures[i].isArrayTexture=this.textures[i].image.depth>1);this.dispose()}this.viewport.set(0,0,e,t),this.scissor.set(0,0,e,t)}clone(){return new this.constructor().copy(this)}copy(e){this.width=e.width,this.height=e.height,this.depth=e.depth,this.scissor.copy(e.scissor),this.scissorTest=e.scissorTest,this.viewport.copy(e.viewport),this.textures.length=0;for(let t=0,n=e.textures.length;t<n;t++){this.textures[t]=e.textures[t].clone(),this.textures[t].isRenderTargetTexture=!0,this.textures[t].renderTarget=this;const i=Object.assign({},e.textures[t].image);this.textures[t].source=new nm(i)}return this.depthBuffer=e.depthBuffer,this.stencilBuffer=e.stencilBuffer,this.resolveDepthBuffer=e.resolveDepthBuffer,this.resolveStencilBuffer=e.resolveStencilBuffer,e.depthTexture!==null&&(this.depthTexture=e.depthTexture.clone()),this.samples=e.samples,this}dispose(){this.dispatchEvent({type:"dispose"})}}class sl extends sf{constructor(e=1,t=1,n={}){super(e,t,n),this.isWebGLRenderTarget=!0}}class V1 extends sr{constructor(e=null,t=1,n=1,i=1){super(null),this.isDataArrayTexture=!0,this.image={data:e,width:t,height:n,depth:i},this.magFilter=Ki,this.minFilter=Ki,this.wrapR=Dr,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1,this.layerUpdates=new Set}addLayerUpdate(e){this.layerUpdates.add(e)}clearLayerUpdates(){this.layerUpdates.clear()}}class TZ extends sl{constructor(e=1,t=1,n=1,i={}){super(e,t,i),this.isWebGLArrayRenderTarget=!0,this.depth=n,this.texture=new V1(null,e,t,n),this._setTextureOptions(i),this.texture.isRenderTargetTexture=!0}}class SC extends sr{constructor(e=null,t=1,n=1,i=1){super(null),this.isData3DTexture=!0,this.image={data:e,width:t,height:n,depth:i},this.magFilter=Ki,this.minFilter=Ki,this.wrapR=Dr,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}class EZ extends sl{constructor(e=1,t=1,n=1,i={}){super(e,t,i),this.isWebGL3DRenderTarget=!0,this.depth=n,this.texture=new SC(null,e,t,n),this._setTextureOptions(i),this.texture.isRenderTargetTexture=!0}}class _o{constructor(e=new ne(1/0,1/0,1/0),t=new ne(-1/0,-1/0,-1/0)){this.isBox3=!0,this.min=e,this.max=t}set(e,t){return this.min.copy(e),this.max.copy(t),this}setFromArray(e){this.makeEmpty();for(let t=0,n=e.length;t<n;t+=3)this.expandByPoint(Ic.fromArray(e,t));return this}setFromBufferAttribute(e){this.makeEmpty();for(let t=0,n=e.count;t<n;t++)this.expandByPoint(Ic.fromBufferAttribute(e,t));return this}setFromPoints(e){this.makeEmpty();for(let t=0,n=e.length;t<n;t++)this.expandByPoint(e[t]);return this}setFromCenterAndSize(e,t){const n=Ic.copy(t).multiplyScalar(.5);return this.min.copy(e).sub(n),this.max.copy(e).add(n),this}setFromObject(e,t=!1){return this.makeEmpty(),this.expandByObject(e,t)}clone(){return new this.constructor().copy(this)}copy(e){return this.min.copy(e.min),this.max.copy(e.max),this}makeEmpty(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z}getCenter(e){return this.isEmpty()?e.set(0,0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(e){return this.isEmpty()?e.set(0,0,0):e.subVectors(this.max,this.min)}expandByPoint(e){return this.min.min(e),this.max.max(e),this}expandByVector(e){return this.min.sub(e),this.max.add(e),this}expandByScalar(e){return this.min.addScalar(-e),this.max.addScalar(e),this}expandByObject(e,t=!1){e.updateWorldMatrix(!1,!1);const n=e.geometry;if(n!==void 0){const s=n.getAttribute("position");if(t===!0&&s!==void 0&&e.isInstancedMesh!==!0)for(let a=0,o=s.count;a<o;a++)e.isMesh===!0?e.getVertexPosition(a,Ic):Ic.fromBufferAttribute(s,a),Ic.applyMatrix4(e.matrixWorld),this.expandByPoint(Ic);else e.boundingBox!==void 0?(e.boundingBox===null&&e.computeBoundingBox(),zM.copy(e.boundingBox)):(n.boundingBox===null&&n.computeBoundingBox(),zM.copy(n.boundingBox)),zM.applyMatrix4(e.matrixWorld),this.union(zM)}const i=e.children;for(let s=0,a=i.length;s<a;s++)this.expandByObject(i[s],t);return this}containsPoint(e){return e.x>=this.min.x&&e.x<=this.max.x&&e.y>=this.min.y&&e.y<=this.max.y&&e.z>=this.min.z&&e.z<=this.max.z}containsBox(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y&&this.min.z<=e.min.z&&e.max.z<=this.max.z}getParameter(e,t){return t.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y),(e.z-this.min.z)/(this.max.z-this.min.z))}intersectsBox(e){return e.max.x>=this.min.x&&e.min.x<=this.max.x&&e.max.y>=this.min.y&&e.min.y<=this.max.y&&e.max.z>=this.min.z&&e.min.z<=this.max.z}intersectsSphere(e){return this.clampPoint(e.center,Ic),Ic.distanceToSquared(e.center)<=e.radius*e.radius}intersectsPlane(e){let t,n;return e.normal.x>0?(t=e.normal.x*this.min.x,n=e.normal.x*this.max.x):(t=e.normal.x*this.max.x,n=e.normal.x*this.min.x),e.normal.y>0?(t+=e.normal.y*this.min.y,n+=e.normal.y*this.max.y):(t+=e.normal.y*this.max.y,n+=e.normal.y*this.min.y),e.normal.z>0?(t+=e.normal.z*this.min.z,n+=e.normal.z*this.max.z):(t+=e.normal.z*this.max.z,n+=e.normal.z*this.min.z),t<=-e.constant&&n>=-e.constant}intersectsTriangle(e){if(this.isEmpty())return!1;this.getCenter(RS),VM.subVectors(this.max,RS),q_.subVectors(e.a,RS),X_.subVectors(e.b,RS),$_.subVectors(e.c,RS),Bp.subVectors(X_,q_),Ip.subVectors($_,X_),Bg.subVectors(q_,$_);let t=[0,-Bp.z,Bp.y,0,-Ip.z,Ip.y,0,-Bg.z,Bg.y,Bp.z,0,-Bp.x,Ip.z,0,-Ip.x,Bg.z,0,-Bg.x,-Bp.y,Bp.x,0,-Ip.y,Ip.x,0,-Bg.y,Bg.x,0];return!I2(t,q_,X_,$_,VM)||(t=[1,0,0,0,1,0,0,0,1],!I2(t,q_,X_,$_,VM))?!1:(GM.crossVectors(Bp,Ip),t=[GM.x,GM.y,GM.z],I2(t,q_,X_,$_,VM))}clampPoint(e,t){return t.copy(e).clamp(this.min,this.max)}distanceToPoint(e){return this.clampPoint(e,Ic).distanceTo(e)}getBoundingSphere(e){return this.isEmpty()?e.makeEmpty():(this.getCenter(e.center),e.radius=this.getSize(Ic).length()*.5),e}intersect(e){return this.min.max(e.min),this.max.min(e.max),this.isEmpty()&&this.makeEmpty(),this}union(e){return this.min.min(e.min),this.max.max(e.max),this}applyMatrix4(e){return this.isEmpty()?this:(eh[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(e),eh[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(e),eh[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(e),eh[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(e),eh[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(e),eh[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(e),eh[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(e),eh[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(e),this.setFromPoints(eh),this)}translate(e){return this.min.add(e),this.max.add(e),this}equals(e){return e.min.equals(this.min)&&e.max.equals(this.max)}toJSON(){return{min:this.min.toArray(),max:this.max.toArray()}}fromJSON(e){return this.min.fromArray(e.min),this.max.fromArray(e.max),this}}const eh=[new ne,new ne,new ne,new ne,new ne,new ne,new ne,new ne],Ic=new ne,zM=new _o,q_=new ne,X_=new ne,$_=new ne,Bp=new ne,Ip=new ne,Bg=new ne,RS=new ne,VM=new ne,GM=new ne,Ig=new ne;function I2(r,e,t,n,i){for(let s=0,a=r.length-3;s<=a;s+=3){Ig.fromArray(r,s);const o=i.x*Math.abs(Ig.x)+i.y*Math.abs(Ig.y)+i.z*Math.abs(Ig.z),l=e.dot(Ig),c=t.dot(Ig),d=n.dot(Ig);if(Math.max(-Math.max(l,c,d),Math.min(l,c,d))>o)return!1}return!0}const MZ=new _o,CS=new ne,F2=new ne;class Sa{constructor(e=new ne,t=-1){this.isSphere=!0,this.center=e,this.radius=t}set(e,t){return this.center.copy(e),this.radius=t,this}setFromPoints(e,t){const n=this.center;t!==void 0?n.copy(t):MZ.setFromPoints(e).getCenter(n);let i=0;for(let s=0,a=e.length;s<a;s++)i=Math.max(i,n.distanceToSquared(e[s]));return this.radius=Math.sqrt(i),this}copy(e){return this.center.copy(e.center),this.radius=e.radius,this}isEmpty(){return this.radius<0}makeEmpty(){return this.center.set(0,0,0),this.radius=-1,this}containsPoint(e){return e.distanceToSquared(this.center)<=this.radius*this.radius}distanceToPoint(e){return e.distanceTo(this.center)-this.radius}intersectsSphere(e){const t=this.radius+e.radius;return e.center.distanceToSquared(this.center)<=t*t}intersectsBox(e){return e.intersectsSphere(this)}intersectsPlane(e){return Math.abs(e.distanceToPoint(this.center))<=this.radius}clampPoint(e,t){const n=this.center.distanceToSquared(e);return t.copy(e),n>this.radius*this.radius&&(t.sub(this.center).normalize(),t.multiplyScalar(this.radius).add(this.center)),t}getBoundingBox(e){return this.isEmpty()?(e.makeEmpty(),e):(e.set(this.center,this.center),e.expandByScalar(this.radius),e)}applyMatrix4(e){return this.center.applyMatrix4(e),this.radius=this.radius*e.getMaxScaleOnAxis(),this}translate(e){return this.center.add(e),this}expandByPoint(e){if(this.isEmpty())return this.center.copy(e),this.radius=0,this;CS.subVectors(e,this.center);const t=CS.lengthSq();if(t>this.radius*this.radius){const n=Math.sqrt(t),i=(n-this.radius)*.5;this.center.addScaledVector(CS,i/n),this.radius+=i}return this}union(e){return e.isEmpty()?this:this.isEmpty()?(this.copy(e),this):(this.center.equals(e.center)===!0?this.radius=Math.max(this.radius,e.radius):(F2.subVectors(e.center,this.center).setLength(e.radius),this.expandByPoint(CS.copy(e.center).add(F2)),this.expandByPoint(CS.copy(e.center).sub(F2))),this)}equals(e){return e.center.equals(this.center)&&e.radius===this.radius}clone(){return new this.constructor().copy(this)}toJSON(){return{radius:this.radius,center:this.center.toArray()}}fromJSON(e){return this.radius=e.radius,this.center.fromArray(e.center),this}}const th=new ne,z2=new ne,kM=new ne,Fp=new ne,V2=new ne,HM=new ne,G2=new ne;class wy{constructor(e=new ne,t=new ne(0,0,-1)){this.origin=e,this.direction=t}set(e,t){return this.origin.copy(e),this.direction.copy(t),this}copy(e){return this.origin.copy(e.origin),this.direction.copy(e.direction),this}at(e,t){return t.copy(this.origin).addScaledVector(this.direction,e)}lookAt(e){return this.direction.copy(e).sub(this.origin).normalize(),this}recast(e){return this.origin.copy(this.at(e,th)),this}closestPointToPoint(e,t){t.subVectors(e,this.origin);const n=t.dot(this.direction);return n<0?t.copy(this.origin):t.copy(this.origin).addScaledVector(this.direction,n)}distanceToPoint(e){return Math.sqrt(this.distanceSqToPoint(e))}distanceSqToPoint(e){const t=th.subVectors(e,this.origin).dot(this.direction);return t<0?this.origin.distanceToSquared(e):(th.copy(this.origin).addScaledVector(this.direction,t),th.distanceToSquared(e))}distanceSqToSegment(e,t,n,i){z2.copy(e).add(t).multiplyScalar(.5),kM.copy(t).sub(e).normalize(),Fp.copy(this.origin).sub(z2);const s=e.distanceTo(t)*.5,a=-this.direction.dot(kM),o=Fp.dot(this.direction),l=-Fp.dot(kM),c=Fp.lengthSq(),d=Math.abs(1-a*a);let p,y,_,v;if(d>0)if(p=a*l-o,y=a*o-l,v=s*d,p>=0)if(y>=-v)if(y<=v){const b=1/d;p*=b,y*=b,_=p*(p+a*y+2*o)+y*(a*p+y+2*l)+c}else y=s,p=Math.max(0,-(a*y+o)),_=-p*p+y*(y+2*l)+c;else y=-s,p=Math.max(0,-(a*y+o)),_=-p*p+y*(y+2*l)+c;else y<=-v?(p=Math.max(0,-(-a*s+o)),y=p>0?-s:Math.min(Math.max(-s,-l),s),_=-p*p+y*(y+2*l)+c):y<=v?(p=0,y=Math.min(Math.max(-s,-l),s),_=y*(y+2*l)+c):(p=Math.max(0,-(a*s+o)),y=p>0?s:Math.min(Math.max(-s,-l),s),_=-p*p+y*(y+2*l)+c);else y=a>0?-s:s,p=Math.max(0,-(a*y+o)),_=-p*p+y*(y+2*l)+c;return n&&n.copy(this.origin).addScaledVector(this.direction,p),i&&i.copy(z2).addScaledVector(kM,y),_}intersectSphere(e,t){th.subVectors(e.center,this.origin);const n=th.dot(this.direction),i=th.dot(th)-n*n,s=e.radius*e.radius;if(i>s)return null;const a=Math.sqrt(s-i),o=n-a,l=n+a;return l<0?null:o<0?this.at(l,t):this.at(o,t)}intersectsSphere(e){return e.radius<0?!1:this.distanceSqToPoint(e.center)<=e.radius*e.radius}distanceToPlane(e){const t=e.normal.dot(this.direction);if(t===0)return e.distanceToPoint(this.origin)===0?0:null;const n=-(this.origin.dot(e.normal)+e.constant)/t;return n>=0?n:null}intersectPlane(e,t){const n=this.distanceToPlane(e);return n===null?null:this.at(n,t)}intersectsPlane(e){const t=e.distanceToPoint(this.origin);return t===0||e.normal.dot(this.direction)*t<0}intersectBox(e,t){let n,i,s,a,o,l;const c=1/this.direction.x,d=1/this.direction.y,p=1/this.direction.z,y=this.origin;return c>=0?(n=(e.min.x-y.x)*c,i=(e.max.x-y.x)*c):(n=(e.max.x-y.x)*c,i=(e.min.x-y.x)*c),d>=0?(s=(e.min.y-y.y)*d,a=(e.max.y-y.y)*d):(s=(e.max.y-y.y)*d,a=(e.min.y-y.y)*d),n>a||s>i||((s>n||isNaN(n))&&(n=s),(a<i||isNaN(i))&&(i=a),p>=0?(o=(e.min.z-y.z)*p,l=(e.max.z-y.z)*p):(o=(e.max.z-y.z)*p,l=(e.min.z-y.z)*p),n>l||o>i)||((o>n||n!==n)&&(n=o),(l<i||i!==i)&&(i=l),i<0)?null:this.at(n>=0?n:i,t)}intersectsBox(e){return this.intersectBox(e,th)!==null}intersectTriangle(e,t,n,i,s){V2.subVectors(t,e),HM.subVectors(n,e),G2.crossVectors(V2,HM);let a=this.direction.dot(G2),o;if(a>0){if(i)return null;o=1}else if(a<0)o=-1,a=-a;else return null;Fp.subVectors(this.origin,e);const l=o*this.direction.dot(HM.crossVectors(Fp,HM));if(l<0)return null;const c=o*this.direction.dot(V2.cross(Fp));if(c<0||l+c>a)return null;const d=-o*Fp.dot(G2);return d<0?null:this.at(d/a,s)}applyMatrix4(e){return this.origin.applyMatrix4(e),this.direction.transformDirection(e),this}equals(e){return e.origin.equals(this.origin)&&e.direction.equals(this.direction)}clone(){return new this.constructor().copy(this)}}class gn{constructor(e,t,n,i,s,a,o,l,c,d,p,y,_,v,b,E){gn.prototype.isMatrix4=!0,this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],e!==void 0&&this.set(e,t,n,i,s,a,o,l,c,d,p,y,_,v,b,E)}set(e,t,n,i,s,a,o,l,c,d,p,y,_,v,b,E){const T=this.elements;return T[0]=e,T[4]=t,T[8]=n,T[12]=i,T[1]=s,T[5]=a,T[9]=o,T[13]=l,T[2]=c,T[6]=d,T[10]=p,T[14]=y,T[3]=_,T[7]=v,T[11]=b,T[15]=E,this}identity(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this}clone(){return new gn().fromArray(this.elements)}copy(e){const t=this.elements,n=e.elements;return t[0]=n[0],t[1]=n[1],t[2]=n[2],t[3]=n[3],t[4]=n[4],t[5]=n[5],t[6]=n[6],t[7]=n[7],t[8]=n[8],t[9]=n[9],t[10]=n[10],t[11]=n[11],t[12]=n[12],t[13]=n[13],t[14]=n[14],t[15]=n[15],this}copyPosition(e){const t=this.elements,n=e.elements;return t[12]=n[12],t[13]=n[13],t[14]=n[14],this}setFromMatrix3(e){const t=e.elements;return this.set(t[0],t[3],t[6],0,t[1],t[4],t[7],0,t[2],t[5],t[8],0,0,0,0,1),this}extractBasis(e,t,n){return this.determinant()===0?(e.set(1,0,0),t.set(0,1,0),n.set(0,0,1),this):(e.setFromMatrixColumn(this,0),t.setFromMatrixColumn(this,1),n.setFromMatrixColumn(this,2),this)}makeBasis(e,t,n){return this.set(e.x,t.x,n.x,0,e.y,t.y,n.y,0,e.z,t.z,n.z,0,0,0,0,1),this}extractRotation(e){if(e.determinant()===0)return this.identity();const t=this.elements,n=e.elements,i=1/j_.setFromMatrixColumn(e,0).length(),s=1/j_.setFromMatrixColumn(e,1).length(),a=1/j_.setFromMatrixColumn(e,2).length();return t[0]=n[0]*i,t[1]=n[1]*i,t[2]=n[2]*i,t[3]=0,t[4]=n[4]*s,t[5]=n[5]*s,t[6]=n[6]*s,t[7]=0,t[8]=n[8]*a,t[9]=n[9]*a,t[10]=n[10]*a,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}makeRotationFromEuler(e){const t=this.elements,n=e.x,i=e.y,s=e.z,a=Math.cos(n),o=Math.sin(n),l=Math.cos(i),c=Math.sin(i),d=Math.cos(s),p=Math.sin(s);if(e.order==="XYZ"){const y=a*d,_=a*p,v=o*d,b=o*p;t[0]=l*d,t[4]=-l*p,t[8]=c,t[1]=_+v*c,t[5]=y-b*c,t[9]=-o*l,t[2]=b-y*c,t[6]=v+_*c,t[10]=a*l}else if(e.order==="YXZ"){const y=l*d,_=l*p,v=c*d,b=c*p;t[0]=y+b*o,t[4]=v*o-_,t[8]=a*c,t[1]=a*p,t[5]=a*d,t[9]=-o,t[2]=_*o-v,t[6]=b+y*o,t[10]=a*l}else if(e.order==="ZXY"){const y=l*d,_=l*p,v=c*d,b=c*p;t[0]=y-b*o,t[4]=-a*p,t[8]=v+_*o,t[1]=_+v*o,t[5]=a*d,t[9]=b-y*o,t[2]=-a*c,t[6]=o,t[10]=a*l}else if(e.order==="ZYX"){const y=a*d,_=a*p,v=o*d,b=o*p;t[0]=l*d,t[4]=v*c-_,t[8]=y*c+b,t[1]=l*p,t[5]=b*c+y,t[9]=_*c-v,t[2]=-c,t[6]=o*l,t[10]=a*l}else if(e.order==="YZX"){const y=a*l,_=a*c,v=o*l,b=o*c;t[0]=l*d,t[4]=b-y*p,t[8]=v*p+_,t[1]=p,t[5]=a*d,t[9]=-o*d,t[2]=-c*d,t[6]=_*p+v,t[10]=y-b*p}else if(e.order==="XZY"){const y=a*l,_=a*c,v=o*l,b=o*c;t[0]=l*d,t[4]=-p,t[8]=c*d,t[1]=y*p+b,t[5]=a*d,t[9]=_*p-v,t[2]=v*p-_,t[6]=o*d,t[10]=b*p+y}return t[3]=0,t[7]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}makeRotationFromQuaternion(e){return this.compose(AZ,e,wZ)}lookAt(e,t,n){const i=this.elements;return Jl.subVectors(e,t),Jl.lengthSq()===0&&(Jl.z=1),Jl.normalize(),zp.crossVectors(n,Jl),zp.lengthSq()===0&&(Math.abs(n.z)===1?Jl.x+=1e-4:Jl.z+=1e-4,Jl.normalize(),zp.crossVectors(n,Jl)),zp.normalize(),WM.crossVectors(Jl,zp),i[0]=zp.x,i[4]=WM.x,i[8]=Jl.x,i[1]=zp.y,i[5]=WM.y,i[9]=Jl.y,i[2]=zp.z,i[6]=WM.z,i[10]=Jl.z,this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,t){const n=e.elements,i=t.elements,s=this.elements,a=n[0],o=n[4],l=n[8],c=n[12],d=n[1],p=n[5],y=n[9],_=n[13],v=n[2],b=n[6],E=n[10],T=n[14],M=n[3],R=n[7],N=n[11],P=n[15],U=i[0],L=i[4],F=i[8],O=i[12],B=i[1],q=i[5],j=i[9],Q=i[13],se=i[2],ae=i[6],V=i[10],X=i[14],ee=i[3],fe=i[7],Y=i[11],K=i[15];return s[0]=a*U+o*B+l*se+c*ee,s[4]=a*L+o*q+l*ae+c*fe,s[8]=a*F+o*j+l*V+c*Y,s[12]=a*O+o*Q+l*X+c*K,s[1]=d*U+p*B+y*se+_*ee,s[5]=d*L+p*q+y*ae+_*fe,s[9]=d*F+p*j+y*V+_*Y,s[13]=d*O+p*Q+y*X+_*K,s[2]=v*U+b*B+E*se+T*ee,s[6]=v*L+b*q+E*ae+T*fe,s[10]=v*F+b*j+E*V+T*Y,s[14]=v*O+b*Q+E*X+T*K,s[3]=M*U+R*B+N*se+P*ee,s[7]=M*L+R*q+N*ae+P*fe,s[11]=M*F+R*j+N*V+P*Y,s[15]=M*O+R*Q+N*X+P*K,this}multiplyScalar(e){const t=this.elements;return t[0]*=e,t[4]*=e,t[8]*=e,t[12]*=e,t[1]*=e,t[5]*=e,t[9]*=e,t[13]*=e,t[2]*=e,t[6]*=e,t[10]*=e,t[14]*=e,t[3]*=e,t[7]*=e,t[11]*=e,t[15]*=e,this}determinant(){const e=this.elements,t=e[0],n=e[4],i=e[8],s=e[12],a=e[1],o=e[5],l=e[9],c=e[13],d=e[2],p=e[6],y=e[10],_=e[14],v=e[3],b=e[7],E=e[11],T=e[15],M=l*_-c*y,R=o*_-c*p,N=o*y-l*p,P=a*_-c*d,U=a*y-l*d,L=a*p-o*d;return t*(b*M-E*R+T*N)-n*(v*M-E*P+T*U)+i*(v*R-b*P+T*L)-s*(v*N-b*U+E*L)}transpose(){const e=this.elements;let t;return t=e[1],e[1]=e[4],e[4]=t,t=e[2],e[2]=e[8],e[8]=t,t=e[6],e[6]=e[9],e[9]=t,t=e[3],e[3]=e[12],e[12]=t,t=e[7],e[7]=e[13],e[13]=t,t=e[11],e[11]=e[14],e[14]=t,this}setPosition(e,t,n){const i=this.elements;return e.isVector3?(i[12]=e.x,i[13]=e.y,i[14]=e.z):(i[12]=e,i[13]=t,i[14]=n),this}invert(){const e=this.elements,t=e[0],n=e[1],i=e[2],s=e[3],a=e[4],o=e[5],l=e[6],c=e[7],d=e[8],p=e[9],y=e[10],_=e[11],v=e[12],b=e[13],E=e[14],T=e[15],M=p*E*c-b*y*c+b*l*_-o*E*_-p*l*T+o*y*T,R=v*y*c-d*E*c-v*l*_+a*E*_+d*l*T-a*y*T,N=d*b*c-v*p*c+v*o*_-a*b*_-d*o*T+a*p*T,P=v*p*l-d*b*l-v*o*y+a*b*y+d*o*E-a*p*E,U=t*M+n*R+i*N+s*P;if(U===0)return this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);const L=1/U;return e[0]=M*L,e[1]=(b*y*s-p*E*s-b*i*_+n*E*_+p*i*T-n*y*T)*L,e[2]=(o*E*s-b*l*s+b*i*c-n*E*c-o*i*T+n*l*T)*L,e[3]=(p*l*s-o*y*s-p*i*c+n*y*c+o*i*_-n*l*_)*L,e[4]=R*L,e[5]=(d*E*s-v*y*s+v*i*_-t*E*_-d*i*T+t*y*T)*L,e[6]=(v*l*s-a*E*s-v*i*c+t*E*c+a*i*T-t*l*T)*L,e[7]=(a*y*s-d*l*s+d*i*c-t*y*c-a*i*_+t*l*_)*L,e[8]=N*L,e[9]=(v*p*s-d*b*s-v*n*_+t*b*_+d*n*T-t*p*T)*L,e[10]=(a*b*s-v*o*s+v*n*c-t*b*c-a*n*T+t*o*T)*L,e[11]=(d*o*s-a*p*s-d*n*c+t*p*c+a*n*_-t*o*_)*L,e[12]=P*L,e[13]=(d*b*i-v*p*i+v*n*y-t*b*y-d*n*E+t*p*E)*L,e[14]=(v*o*i-a*b*i-v*n*l+t*b*l+a*n*E-t*o*E)*L,e[15]=(a*p*i-d*o*i+d*n*l-t*p*l-a*n*y+t*o*y)*L,this}scale(e){const t=this.elements,n=e.x,i=e.y,s=e.z;return t[0]*=n,t[4]*=i,t[8]*=s,t[1]*=n,t[5]*=i,t[9]*=s,t[2]*=n,t[6]*=i,t[10]*=s,t[3]*=n,t[7]*=i,t[11]*=s,this}getMaxScaleOnAxis(){const e=this.elements,t=e[0]*e[0]+e[1]*e[1]+e[2]*e[2],n=e[4]*e[4]+e[5]*e[5]+e[6]*e[6],i=e[8]*e[8]+e[9]*e[9]+e[10]*e[10];return Math.sqrt(Math.max(t,n,i))}makeTranslation(e,t,n){return e.isVector3?this.set(1,0,0,e.x,0,1,0,e.y,0,0,1,e.z,0,0,0,1):this.set(1,0,0,e,0,1,0,t,0,0,1,n,0,0,0,1),this}makeRotationX(e){const t=Math.cos(e),n=Math.sin(e);return this.set(1,0,0,0,0,t,-n,0,0,n,t,0,0,0,0,1),this}makeRotationY(e){const t=Math.cos(e),n=Math.sin(e);return this.set(t,0,n,0,0,1,0,0,-n,0,t,0,0,0,0,1),this}makeRotationZ(e){const t=Math.cos(e),n=Math.sin(e);return this.set(t,-n,0,0,n,t,0,0,0,0,1,0,0,0,0,1),this}makeRotationAxis(e,t){const n=Math.cos(t),i=Math.sin(t),s=1-n,a=e.x,o=e.y,l=e.z,c=s*a,d=s*o;return this.set(c*a+n,c*o-i*l,c*l+i*o,0,c*o+i*l,d*o+n,d*l-i*a,0,c*l-i*o,d*l+i*a,s*l*l+n,0,0,0,0,1),this}makeScale(e,t,n){return this.set(e,0,0,0,0,t,0,0,0,0,n,0,0,0,0,1),this}makeShear(e,t,n,i,s,a){return this.set(1,n,s,0,e,1,a,0,t,i,1,0,0,0,0,1),this}compose(e,t,n){const i=this.elements,s=t._x,a=t._y,o=t._z,l=t._w,c=s+s,d=a+a,p=o+o,y=s*c,_=s*d,v=s*p,b=a*d,E=a*p,T=o*p,M=l*c,R=l*d,N=l*p,P=n.x,U=n.y,L=n.z;return i[0]=(1-(b+T))*P,i[1]=(_+N)*P,i[2]=(v-R)*P,i[3]=0,i[4]=(_-N)*U,i[5]=(1-(y+T))*U,i[6]=(E+M)*U,i[7]=0,i[8]=(v+R)*L,i[9]=(E-M)*L,i[10]=(1-(y+b))*L,i[11]=0,i[12]=e.x,i[13]=e.y,i[14]=e.z,i[15]=1,this}decompose(e,t,n){const i=this.elements;if(e.x=i[12],e.y=i[13],e.z=i[14],this.determinant()===0)return n.set(1,1,1),t.identity(),this;let s=j_.set(i[0],i[1],i[2]).length();const a=j_.set(i[4],i[5],i[6]).length(),o=j_.set(i[8],i[9],i[10]).length();this.determinant()<0&&(s=-s),Fc.copy(this);const c=1/s,d=1/a,p=1/o;return Fc.elements[0]*=c,Fc.elements[1]*=c,Fc.elements[2]*=c,Fc.elements[4]*=d,Fc.elements[5]*=d,Fc.elements[6]*=d,Fc.elements[8]*=p,Fc.elements[9]*=p,Fc.elements[10]*=p,t.setFromRotationMatrix(Fc),n.x=s,n.y=a,n.z=o,this}makePerspective(e,t,n,i,s,a,o=Ba,l=!1){const c=this.elements,d=2*s/(t-e),p=2*s/(n-i),y=(t+e)/(t-e),_=(n+i)/(n-i);let v,b;if(l)v=s/(a-s),b=a*s/(a-s);else if(o===Ba)v=-(a+s)/(a-s),b=-2*a*s/(a-s);else if(o===Il)v=-a/(a-s),b=-a*s/(a-s);else throw new Error("THREE.Matrix4.makePerspective(): Invalid coordinate system: "+o);return c[0]=d,c[4]=0,c[8]=y,c[12]=0,c[1]=0,c[5]=p,c[9]=_,c[13]=0,c[2]=0,c[6]=0,c[10]=v,c[14]=b,c[3]=0,c[7]=0,c[11]=-1,c[15]=0,this}makeOrthographic(e,t,n,i,s,a,o=Ba,l=!1){const c=this.elements,d=2/(t-e),p=2/(n-i),y=-(t+e)/(t-e),_=-(n+i)/(n-i);let v,b;if(l)v=1/(a-s),b=a/(a-s);else if(o===Ba)v=-2/(a-s),b=-(a+s)/(a-s);else if(o===Il)v=-1/(a-s),b=-s/(a-s);else throw new Error("THREE.Matrix4.makeOrthographic(): Invalid coordinate system: "+o);return c[0]=d,c[4]=0,c[8]=0,c[12]=y,c[1]=0,c[5]=p,c[9]=0,c[13]=_,c[2]=0,c[6]=0,c[10]=v,c[14]=b,c[3]=0,c[7]=0,c[11]=0,c[15]=1,this}equals(e){const t=this.elements,n=e.elements;for(let i=0;i<16;i++)if(t[i]!==n[i])return!1;return!0}fromArray(e,t=0){for(let n=0;n<16;n++)this.elements[n]=e[n+t];return this}toArray(e=[],t=0){const n=this.elements;return e[t]=n[0],e[t+1]=n[1],e[t+2]=n[2],e[t+3]=n[3],e[t+4]=n[4],e[t+5]=n[5],e[t+6]=n[6],e[t+7]=n[7],e[t+8]=n[8],e[t+9]=n[9],e[t+10]=n[10],e[t+11]=n[11],e[t+12]=n[12],e[t+13]=n[13],e[t+14]=n[14],e[t+15]=n[15],e}}const j_=new ne,Fc=new gn,AZ=new ne(0,0,0),wZ=new ne(1,1,1),zp=new ne,WM=new ne,Jl=new ne,qF=new gn,XF=new Va;class ll{constructor(e=0,t=0,n=0,i=ll.DEFAULT_ORDER){this.isEuler=!0,this._x=e,this._y=t,this._z=n,this._order=i}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get order(){return this._order}set order(e){this._order=e,this._onChangeCallback()}set(e,t,n,i=this._order){return this._x=e,this._y=t,this._z=n,this._order=i,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._order)}copy(e){return this._x=e._x,this._y=e._y,this._z=e._z,this._order=e._order,this._onChangeCallback(),this}setFromRotationMatrix(e,t=this._order,n=!0){const i=e.elements,s=i[0],a=i[4],o=i[8],l=i[1],c=i[5],d=i[9],p=i[2],y=i[6],_=i[10];switch(t){case"XYZ":this._y=Math.asin(Yn(o,-1,1)),Math.abs(o)<.9999999?(this._x=Math.atan2(-d,_),this._z=Math.atan2(-a,s)):(this._x=Math.atan2(y,c),this._z=0);break;case"YXZ":this._x=Math.asin(-Yn(d,-1,1)),Math.abs(d)<.9999999?(this._y=Math.atan2(o,_),this._z=Math.atan2(l,c)):(this._y=Math.atan2(-p,s),this._z=0);break;case"ZXY":this._x=Math.asin(Yn(y,-1,1)),Math.abs(y)<.9999999?(this._y=Math.atan2(-p,_),this._z=Math.atan2(-a,c)):(this._y=0,this._z=Math.atan2(l,s));break;case"ZYX":this._y=Math.asin(-Yn(p,-1,1)),Math.abs(p)<.9999999?(this._x=Math.atan2(y,_),this._z=Math.atan2(l,s)):(this._x=0,this._z=Math.atan2(-a,c));break;case"YZX":this._z=Math.asin(Yn(l,-1,1)),Math.abs(l)<.9999999?(this._x=Math.atan2(-d,c),this._y=Math.atan2(-p,s)):(this._x=0,this._y=Math.atan2(o,_));break;case"XZY":this._z=Math.asin(-Yn(a,-1,1)),Math.abs(a)<.9999999?(this._x=Math.atan2(y,c),this._y=Math.atan2(o,s)):(this._x=Math.atan2(-d,_),this._y=0);break;default:Ve("Euler: .setFromRotationMatrix() encountered an unknown order: "+t)}return this._order=t,n===!0&&this._onChangeCallback(),this}setFromQuaternion(e,t,n){return qF.makeRotationFromQuaternion(e),this.setFromRotationMatrix(qF,t,n)}setFromVector3(e,t=this._order){return this.set(e.x,e.y,e.z,t)}reorder(e){return XF.setFromEuler(this),this.setFromQuaternion(XF,e)}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._order===this._order}fromArray(e){return this._x=e[0],this._y=e[1],this._z=e[2],e[3]!==void 0&&(this._order=e[3]),this._onChangeCallback(),this}toArray(e=[],t=0){return e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._order,e}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._order}}ll.DEFAULT_ORDER="XYZ";class yx{constructor(){this.mask=1}set(e){this.mask=(1<<e|0)>>>0}enable(e){this.mask|=1<<e|0}enableAll(){this.mask=-1}toggle(e){this.mask^=1<<e|0}disable(e){this.mask&=~(1<<e|0)}disableAll(){this.mask=0}test(e){return(this.mask&e.mask)!==0}isEnabled(e){return(this.mask&(1<<e|0))!==0}}let RZ=0;const $F=new ne,Y_=new Va,nh=new gn,qM=new ne,NS=new ne,CZ=new ne,NZ=new Va,jF=new ne(1,0,0),YF=new ne(0,1,0),ZF=new ne(0,0,1),KF={type:"added"},DZ={type:"removed"},Z_={type:"childadded",child:null},k2={type:"childremoved",child:null};class Fi extends Gl{constructor(){super(),this.isObject3D=!0,Object.defineProperty(this,"id",{value:RZ++}),this.uuid=pu(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=Fi.DEFAULT_UP.clone();const e=new ne,t=new ll,n=new Va,i=new ne(1,1,1);function s(){n.setFromEuler(t,!1)}function a(){t.setFromQuaternion(n,void 0,!1)}t._onChange(s),n._onChange(a),Object.defineProperties(this,{position:{configurable:!0,enumerable:!0,value:e},rotation:{configurable:!0,enumerable:!0,value:t},quaternion:{configurable:!0,enumerable:!0,value:n},scale:{configurable:!0,enumerable:!0,value:i},modelViewMatrix:{value:new gn},normalMatrix:{value:new Zn}}),this.matrix=new gn,this.matrixWorld=new gn,this.matrixAutoUpdate=Fi.DEFAULT_MATRIX_AUTO_UPDATE,this.matrixWorldAutoUpdate=Fi.DEFAULT_MATRIX_WORLD_AUTO_UPDATE,this.matrixWorldNeedsUpdate=!1,this.layers=new yx,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.animations=[],this.customDepthMaterial=void 0,this.customDistanceMaterial=void 0,this.userData={}}onBeforeShadow(){}onAfterShadow(){}onBeforeRender(){}onAfterRender(){}applyMatrix4(e){this.matrixAutoUpdate&&this.updateMatrix(),this.matrix.premultiply(e),this.matrix.decompose(this.position,this.quaternion,this.scale)}applyQuaternion(e){return this.quaternion.premultiply(e),this}setRotationFromAxisAngle(e,t){this.quaternion.setFromAxisAngle(e,t)}setRotationFromEuler(e){this.quaternion.setFromEuler(e,!0)}setRotationFromMatrix(e){this.quaternion.setFromRotationMatrix(e)}setRotationFromQuaternion(e){this.quaternion.copy(e)}rotateOnAxis(e,t){return Y_.setFromAxisAngle(e,t),this.quaternion.multiply(Y_),this}rotateOnWorldAxis(e,t){return Y_.setFromAxisAngle(e,t),this.quaternion.premultiply(Y_),this}rotateX(e){return this.rotateOnAxis(jF,e)}rotateY(e){return this.rotateOnAxis(YF,e)}rotateZ(e){return this.rotateOnAxis(ZF,e)}translateOnAxis(e,t){return $F.copy(e).applyQuaternion(this.quaternion),this.position.add($F.multiplyScalar(t)),this}translateX(e){return this.translateOnAxis(jF,e)}translateY(e){return this.translateOnAxis(YF,e)}translateZ(e){return this.translateOnAxis(ZF,e)}localToWorld(e){return this.updateWorldMatrix(!0,!1),e.applyMatrix4(this.matrixWorld)}worldToLocal(e){return this.updateWorldMatrix(!0,!1),e.applyMatrix4(nh.copy(this.matrixWorld).invert())}lookAt(e,t,n){e.isVector3?qM.copy(e):qM.set(e,t,n);const i=this.parent;this.updateWorldMatrix(!0,!1),NS.setFromMatrixPosition(this.matrixWorld),this.isCamera||this.isLight?nh.lookAt(NS,qM,this.up):nh.lookAt(qM,NS,this.up),this.quaternion.setFromRotationMatrix(nh),i&&(nh.extractRotation(i.matrixWorld),Y_.setFromRotationMatrix(nh),this.quaternion.premultiply(Y_.invert()))}add(e){if(arguments.length>1){for(let t=0;t<arguments.length;t++)this.add(arguments[t]);return this}return e===this?(Ze("Object3D.add: object can't be added as a child of itself.",e),this):(e&&e.isObject3D?(e.removeFromParent(),e.parent=this,this.children.push(e),e.dispatchEvent(KF),Z_.child=e,this.dispatchEvent(Z_),Z_.child=null):Ze("Object3D.add: object not an instance of THREE.Object3D.",e),this)}remove(e){if(arguments.length>1){for(let n=0;n<arguments.length;n++)this.remove(arguments[n]);return this}const t=this.children.indexOf(e);return t!==-1&&(e.parent=null,this.children.splice(t,1),e.dispatchEvent(DZ),k2.child=e,this.dispatchEvent(k2),k2.child=null),this}removeFromParent(){const e=this.parent;return e!==null&&e.remove(this),this}clear(){return this.remove(...this.children)}attach(e){return this.updateWorldMatrix(!0,!1),nh.copy(this.matrixWorld).invert(),e.parent!==null&&(e.parent.updateWorldMatrix(!0,!1),nh.multiply(e.parent.matrixWorld)),e.applyMatrix4(nh),e.removeFromParent(),e.parent=this,this.children.push(e),e.updateWorldMatrix(!1,!0),e.dispatchEvent(KF),Z_.child=e,this.dispatchEvent(Z_),Z_.child=null,this}getObjectById(e){return this.getObjectByProperty("id",e)}getObjectByName(e){return this.getObjectByProperty("name",e)}getObjectByProperty(e,t){if(this[e]===t)return this;for(let n=0,i=this.children.length;n<i;n++){const a=this.children[n].getObjectByProperty(e,t);if(a!==void 0)return a}}getObjectsByProperty(e,t,n=[]){this[e]===t&&n.push(this);const i=this.children;for(let s=0,a=i.length;s<a;s++)i[s].getObjectsByProperty(e,t,n);return n}getWorldPosition(e){return this.updateWorldMatrix(!0,!1),e.setFromMatrixPosition(this.matrixWorld)}getWorldQuaternion(e){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(NS,e,CZ),e}getWorldScale(e){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(NS,NZ,e),e}getWorldDirection(e){this.updateWorldMatrix(!0,!1);const t=this.matrixWorld.elements;return e.set(t[8],t[9],t[10]).normalize()}raycast(){}traverse(e){e(this);const t=this.children;for(let n=0,i=t.length;n<i;n++)t[n].traverse(e)}traverseVisible(e){if(this.visible===!1)return;e(this);const t=this.children;for(let n=0,i=t.length;n<i;n++)t[n].traverseVisible(e)}traverseAncestors(e){const t=this.parent;t!==null&&(e(t),t.traverseAncestors(e))}updateMatrix(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0}updateMatrixWorld(e){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||e)&&(this.matrixWorldAutoUpdate===!0&&(this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix)),this.matrixWorldNeedsUpdate=!1,e=!0);const t=this.children;for(let n=0,i=t.length;n<i;n++)t[n].updateMatrixWorld(e)}updateWorldMatrix(e,t){const n=this.parent;if(e===!0&&n!==null&&n.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),this.matrixWorldAutoUpdate===!0&&(this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix)),t===!0){const i=this.children;for(let s=0,a=i.length;s<a;s++)i[s].updateWorldMatrix(!1,!0)}}toJSON(e){const t=e===void 0||typeof e=="string",n={};t&&(e={geometries:{},materials:{},textures:{},images:{},shapes:{},skeletons:{},animations:{},nodes:{}},n.metadata={version:4.7,type:"Object",generator:"Object3D.toJSON"});const i={};i.uuid=this.uuid,i.type=this.type,this.name!==""&&(i.name=this.name),this.castShadow===!0&&(i.castShadow=!0),this.receiveShadow===!0&&(i.receiveShadow=!0),this.visible===!1&&(i.visible=!1),this.frustumCulled===!1&&(i.frustumCulled=!1),this.renderOrder!==0&&(i.renderOrder=this.renderOrder),Object.keys(this.userData).length>0&&(i.userData=this.userData),i.layers=this.layers.mask,i.matrix=this.matrix.toArray(),i.up=this.up.toArray(),this.matrixAutoUpdate===!1&&(i.matrixAutoUpdate=!1),this.isInstancedMesh&&(i.type="InstancedMesh",i.count=this.count,i.instanceMatrix=this.instanceMatrix.toJSON(),this.instanceColor!==null&&(i.instanceColor=this.instanceColor.toJSON())),this.isBatchedMesh&&(i.type="BatchedMesh",i.perObjectFrustumCulled=this.perObjectFrustumCulled,i.sortObjects=this.sortObjects,i.drawRanges=this._drawRanges,i.reservedRanges=this._reservedRanges,i.geometryInfo=this._geometryInfo.map(o=>({...o,boundingBox:o.boundingBox?o.boundingBox.toJSON():void 0,boundingSphere:o.boundingSphere?o.boundingSphere.toJSON():void 0})),i.instanceInfo=this._instanceInfo.map(o=>({...o})),i.availableInstanceIds=this._availableInstanceIds.slice(),i.availableGeometryIds=this._availableGeometryIds.slice(),i.nextIndexStart=this._nextIndexStart,i.nextVertexStart=this._nextVertexStart,i.geometryCount=this._geometryCount,i.maxInstanceCount=this._maxInstanceCount,i.maxVertexCount=this._maxVertexCount,i.maxIndexCount=this._maxIndexCount,i.geometryInitialized=this._geometryInitialized,i.matricesTexture=this._matricesTexture.toJSON(e),i.indirectTexture=this._indirectTexture.toJSON(e),this._colorsTexture!==null&&(i.colorsTexture=this._colorsTexture.toJSON(e)),this.boundingSphere!==null&&(i.boundingSphere=this.boundingSphere.toJSON()),this.boundingBox!==null&&(i.boundingBox=this.boundingBox.toJSON()));function s(o,l){return o[l.uuid]===void 0&&(o[l.uuid]=l.toJSON(e)),l.uuid}if(this.isScene)this.background&&(this.background.isColor?i.background=this.background.toJSON():this.background.isTexture&&(i.background=this.background.toJSON(e).uuid)),this.environment&&this.environment.isTexture&&this.environment.isRenderTargetTexture!==!0&&(i.environment=this.environment.toJSON(e).uuid);else if(this.isMesh||this.isLine||this.isPoints){i.geometry=s(e.geometries,this.geometry);const o=this.geometry.parameters;if(o!==void 0&&o.shapes!==void 0){const l=o.shapes;if(Array.isArray(l))for(let c=0,d=l.length;c<d;c++){const p=l[c];s(e.shapes,p)}else s(e.shapes,l)}}if(this.isSkinnedMesh&&(i.bindMode=this.bindMode,i.bindMatrix=this.bindMatrix.toArray(),this.skeleton!==void 0&&(s(e.skeletons,this.skeleton),i.skeleton=this.skeleton.uuid)),this.material!==void 0)if(Array.isArray(this.material)){const o=[];for(let l=0,c=this.material.length;l<c;l++)o.push(s(e.materials,this.material[l]));i.material=o}else i.material=s(e.materials,this.material);if(this.children.length>0){i.children=[];for(let o=0;o<this.children.length;o++)i.children.push(this.children[o].toJSON(e).object)}if(this.animations.length>0){i.animations=[];for(let o=0;o<this.animations.length;o++){const l=this.animations[o];i.animations.push(s(e.animations,l))}}if(t){const o=a(e.geometries),l=a(e.materials),c=a(e.textures),d=a(e.images),p=a(e.shapes),y=a(e.skeletons),_=a(e.animations),v=a(e.nodes);o.length>0&&(n.geometries=o),l.length>0&&(n.materials=l),c.length>0&&(n.textures=c),d.length>0&&(n.images=d),p.length>0&&(n.shapes=p),y.length>0&&(n.skeletons=y),_.length>0&&(n.animations=_),v.length>0&&(n.nodes=v)}return n.object=i,n;function a(o){const l=[];for(const c in o){const d=o[c];delete d.metadata,l.push(d)}return l}}clone(e){return new this.constructor().copy(this,e)}copy(e,t=!0){if(this.name=e.name,this.up.copy(e.up),this.position.copy(e.position),this.rotation.order=e.rotation.order,this.quaternion.copy(e.quaternion),this.scale.copy(e.scale),this.matrix.copy(e.matrix),this.matrixWorld.copy(e.matrixWorld),this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrixWorldAutoUpdate=e.matrixWorldAutoUpdate,this.matrixWorldNeedsUpdate=e.matrixWorldNeedsUpdate,this.layers.mask=e.layers.mask,this.visible=e.visible,this.castShadow=e.castShadow,this.receiveShadow=e.receiveShadow,this.frustumCulled=e.frustumCulled,this.renderOrder=e.renderOrder,this.animations=e.animations.slice(),this.userData=JSON.parse(JSON.stringify(e.userData)),t===!0)for(let n=0;n<e.children.length;n++){const i=e.children[n];this.add(i.clone())}return this}}Fi.DEFAULT_UP=new ne(0,1,0);Fi.DEFAULT_MATRIX_AUTO_UPDATE=!0;Fi.DEFAULT_MATRIX_WORLD_AUTO_UPDATE=!0;const zc=new ne,ih=new ne,H2=new ne,rh=new ne,K_=new ne,Q_=new ne,QF=new ne,W2=new ne,q2=new ne,X2=new ne,$2=new zn,j2=new zn,Y2=new zn;class El{constructor(e=new ne,t=new ne,n=new ne){this.a=e,this.b=t,this.c=n}static getNormal(e,t,n,i){i.subVectors(n,t),zc.subVectors(e,t),i.cross(zc);const s=i.lengthSq();return s>0?i.multiplyScalar(1/Math.sqrt(s)):i.set(0,0,0)}static getBarycoord(e,t,n,i,s){zc.subVectors(i,t),ih.subVectors(n,t),H2.subVectors(e,t);const a=zc.dot(zc),o=zc.dot(ih),l=zc.dot(H2),c=ih.dot(ih),d=ih.dot(H2),p=a*c-o*o;if(p===0)return s.set(0,0,0),null;const y=1/p,_=(c*l-o*d)*y,v=(a*d-o*l)*y;return s.set(1-_-v,v,_)}static containsPoint(e,t,n,i){return this.getBarycoord(e,t,n,i,rh)===null?!1:rh.x>=0&&rh.y>=0&&rh.x+rh.y<=1}static getInterpolation(e,t,n,i,s,a,o,l){return this.getBarycoord(e,t,n,i,rh)===null?(l.x=0,l.y=0,"z"in l&&(l.z=0),"w"in l&&(l.w=0),null):(l.setScalar(0),l.addScaledVector(s,rh.x),l.addScaledVector(a,rh.y),l.addScaledVector(o,rh.z),l)}static getInterpolatedAttribute(e,t,n,i,s,a){return $2.setScalar(0),j2.setScalar(0),Y2.setScalar(0),$2.fromBufferAttribute(e,t),j2.fromBufferAttribute(e,n),Y2.fromBufferAttribute(e,i),a.setScalar(0),a.addScaledVector($2,s.x),a.addScaledVector(j2,s.y),a.addScaledVector(Y2,s.z),a}static isFrontFacing(e,t,n,i){return zc.subVectors(n,t),ih.subVectors(e,t),zc.cross(ih).dot(i)<0}set(e,t,n){return this.a.copy(e),this.b.copy(t),this.c.copy(n),this}setFromPointsAndIndices(e,t,n,i){return this.a.copy(e[t]),this.b.copy(e[n]),this.c.copy(e[i]),this}setFromAttributeAndIndices(e,t,n,i){return this.a.fromBufferAttribute(e,t),this.b.fromBufferAttribute(e,n),this.c.fromBufferAttribute(e,i),this}clone(){return new this.constructor().copy(this)}copy(e){return this.a.copy(e.a),this.b.copy(e.b),this.c.copy(e.c),this}getArea(){return zc.subVectors(this.c,this.b),ih.subVectors(this.a,this.b),zc.cross(ih).length()*.5}getMidpoint(e){return e.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)}getNormal(e){return El.getNormal(this.a,this.b,this.c,e)}getPlane(e){return e.setFromCoplanarPoints(this.a,this.b,this.c)}getBarycoord(e,t){return El.getBarycoord(e,this.a,this.b,this.c,t)}getInterpolation(e,t,n,i,s){return El.getInterpolation(e,this.a,this.b,this.c,t,n,i,s)}containsPoint(e){return El.containsPoint(e,this.a,this.b,this.c)}isFrontFacing(e){return El.isFrontFacing(this.a,this.b,this.c,e)}intersectsBox(e){return e.intersectsTriangle(this)}closestPointToPoint(e,t){const n=this.a,i=this.b,s=this.c;let a,o;K_.subVectors(i,n),Q_.subVectors(s,n),W2.subVectors(e,n);const l=K_.dot(W2),c=Q_.dot(W2);if(l<=0&&c<=0)return t.copy(n);q2.subVectors(e,i);const d=K_.dot(q2),p=Q_.dot(q2);if(d>=0&&p<=d)return t.copy(i);const y=l*p-d*c;if(y<=0&&l>=0&&d<=0)return a=l/(l-d),t.copy(n).addScaledVector(K_,a);X2.subVectors(e,s);const _=K_.dot(X2),v=Q_.dot(X2);if(v>=0&&_<=v)return t.copy(s);const b=_*c-l*v;if(b<=0&&c>=0&&v<=0)return o=c/(c-v),t.copy(n).addScaledVector(Q_,o);const E=d*v-_*p;if(E<=0&&p-d>=0&&_-v>=0)return QF.subVectors(s,i),o=(p-d)/(p-d+(_-v)),t.copy(i).addScaledVector(QF,o);const T=1/(E+b+y);return a=b*T,o=y*T,t.copy(n).addScaledVector(K_,a).addScaledVector(Q_,o)}equals(e){return e.a.equals(this.a)&&e.b.equals(this.b)&&e.c.equals(this.c)}}const Yk={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},Vp={h:0,s:0,l:0},XM={h:0,s:0,l:0};function Z2(r,e,t){return t<0&&(t+=1),t>1&&(t-=1),t<1/6?r+(e-r)*6*t:t<1/2?e:t<2/3?r+(e-r)*6*(2/3-t):r}let Kt=class{constructor(e,t,n){return this.isColor=!0,this.r=1,this.g=1,this.b=1,this.set(e,t,n)}set(e,t,n){if(t===void 0&&n===void 0){const i=e;i&&i.isColor?this.copy(i):typeof i=="number"?this.setHex(i):typeof i=="string"&&this.setStyle(i)}else this.setRGB(e,t,n);return this}setScalar(e){return this.r=e,this.g=e,this.b=e,this}setHex(e,t=ea){return e=Math.floor(e),this.r=(e>>16&255)/255,this.g=(e>>8&255)/255,this.b=(e&255)/255,Nn.colorSpaceToWorking(this,t),this}setRGB(e,t,n,i=Nn.workingColorSpace){return this.r=e,this.g=t,this.b=n,Nn.colorSpaceToWorking(this,i),this}setHSL(e,t,n,i=Nn.workingColorSpace){if(e=aL(e,1),t=Yn(t,0,1),n=Yn(n,0,1),t===0)this.r=this.g=this.b=n;else{const s=n<=.5?n*(1+t):n+t-n*t,a=2*n-s;this.r=Z2(a,s,e+1/3),this.g=Z2(a,s,e),this.b=Z2(a,s,e-1/3)}return Nn.colorSpaceToWorking(this,i),this}setStyle(e,t=ea){function n(s){s!==void 0&&parseFloat(s)<1&&Ve("Color: Alpha component of "+e+" will be ignored.")}let i;if(i=/^(\w+)\(([^\)]*)\)/.exec(e)){let s;const a=i[1],o=i[2];switch(a){case"rgb":case"rgba":if(s=/^\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(o))return n(s[4]),this.setRGB(Math.min(255,parseInt(s[1],10))/255,Math.min(255,parseInt(s[2],10))/255,Math.min(255,parseInt(s[3],10))/255,t);if(s=/^\s*(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(o))return n(s[4]),this.setRGB(Math.min(100,parseInt(s[1],10))/100,Math.min(100,parseInt(s[2],10))/100,Math.min(100,parseInt(s[3],10))/100,t);break;case"hsl":case"hsla":if(s=/^\s*(\d*\.?\d+)\s*,\s*(\d*\.?\d+)\%\s*,\s*(\d*\.?\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(o))return n(s[4]),this.setHSL(parseFloat(s[1])/360,parseFloat(s[2])/100,parseFloat(s[3])/100,t);break;default:Ve("Color: Unknown color model "+e)}}else if(i=/^\#([A-Fa-f\d]+)$/.exec(e)){const s=i[1],a=s.length;if(a===3)return this.setRGB(parseInt(s.charAt(0),16)/15,parseInt(s.charAt(1),16)/15,parseInt(s.charAt(2),16)/15,t);if(a===6)return this.setHex(parseInt(s,16),t);Ve("Color: Invalid hex color "+e)}else if(e&&e.length>0)return this.setColorName(e,t);return this}setColorName(e,t=ea){const n=Yk[e.toLowerCase()];return n!==void 0?this.setHex(n,t):Ve("Color: Unknown color "+e),this}clone(){return new this.constructor(this.r,this.g,this.b)}copy(e){return this.r=e.r,this.g=e.g,this.b=e.b,this}copySRGBToLinear(e){return this.r=Eh(e.r),this.g=Eh(e.g),this.b=Eh(e.b),this}copyLinearToSRGB(e){return this.r=Gv(e.r),this.g=Gv(e.g),this.b=Gv(e.b),this}convertSRGBToLinear(){return this.copySRGBToLinear(this),this}convertLinearToSRGB(){return this.copyLinearToSRGB(this),this}getHex(e=ea){return Nn.workingToColorSpace(ro.copy(this),e),Math.round(Yn(ro.r*255,0,255))*65536+Math.round(Yn(ro.g*255,0,255))*256+Math.round(Yn(ro.b*255,0,255))}getHexString(e=ea){return("000000"+this.getHex(e).toString(16)).slice(-6)}getHSL(e,t=Nn.workingColorSpace){Nn.workingToColorSpace(ro.copy(this),t);const n=ro.r,i=ro.g,s=ro.b,a=Math.max(n,i,s),o=Math.min(n,i,s);let l,c;const d=(o+a)/2;if(o===a)l=0,c=0;else{const p=a-o;switch(c=d<=.5?p/(a+o):p/(2-a-o),a){case n:l=(i-s)/p+(i<s?6:0);break;case i:l=(s-n)/p+2;break;case s:l=(n-i)/p+4;break}l/=6}return e.h=l,e.s=c,e.l=d,e}getRGB(e,t=Nn.workingColorSpace){return Nn.workingToColorSpace(ro.copy(this),t),e.r=ro.r,e.g=ro.g,e.b=ro.b,e}getStyle(e=ea){Nn.workingToColorSpace(ro.copy(this),e);const t=ro.r,n=ro.g,i=ro.b;return e!==ea?`color(${e} ${t.toFixed(3)} ${n.toFixed(3)} ${i.toFixed(3)})`:`rgb(${Math.round(t*255)},${Math.round(n*255)},${Math.round(i*255)})`}offsetHSL(e,t,n){return this.getHSL(Vp),this.setHSL(Vp.h+e,Vp.s+t,Vp.l+n)}add(e){return this.r+=e.r,this.g+=e.g,this.b+=e.b,this}addColors(e,t){return this.r=e.r+t.r,this.g=e.g+t.g,this.b=e.b+t.b,this}addScalar(e){return this.r+=e,this.g+=e,this.b+=e,this}sub(e){return this.r=Math.max(0,this.r-e.r),this.g=Math.max(0,this.g-e.g),this.b=Math.max(0,this.b-e.b),this}multiply(e){return this.r*=e.r,this.g*=e.g,this.b*=e.b,this}multiplyScalar(e){return this.r*=e,this.g*=e,this.b*=e,this}lerp(e,t){return this.r+=(e.r-this.r)*t,this.g+=(e.g-this.g)*t,this.b+=(e.b-this.b)*t,this}lerpColors(e,t,n){return this.r=e.r+(t.r-e.r)*n,this.g=e.g+(t.g-e.g)*n,this.b=e.b+(t.b-e.b)*n,this}lerpHSL(e,t){this.getHSL(Vp),e.getHSL(XM);const n=AT(Vp.h,XM.h,t),i=AT(Vp.s,XM.s,t),s=AT(Vp.l,XM.l,t);return this.setHSL(n,i,s),this}setFromVector3(e){return this.r=e.x,this.g=e.y,this.b=e.z,this}applyMatrix3(e){const t=this.r,n=this.g,i=this.b,s=e.elements;return this.r=s[0]*t+s[3]*n+s[6]*i,this.g=s[1]*t+s[4]*n+s[7]*i,this.b=s[2]*t+s[5]*n+s[8]*i,this}equals(e){return e.r===this.r&&e.g===this.g&&e.b===this.b}fromArray(e,t=0){return this.r=e[t],this.g=e[t+1],this.b=e[t+2],this}toArray(e=[],t=0){return e[t]=this.r,e[t+1]=this.g,e[t+2]=this.b,e}fromBufferAttribute(e,t){return this.r=e.getX(t),this.g=e.getY(t),this.b=e.getZ(t),this}toJSON(){return this.getHex()}*[Symbol.iterator](){yield this.r,yield this.g,yield this.b}};const ro=new Kt;Kt.NAMES=Yk;let OZ=0;class Ta extends Gl{constructor(){super(),this.isMaterial=!0,Object.defineProperty(this,"id",{value:OZ++}),this.uuid=pu(),this.name="",this.type="Material",this.blending=Nl,this.side=Cl,this.vertexColors=!1,this.opacity=1,this.transparent=!1,this.alphaHash=!1,this.blendSrc=nx,this.blendDst=ix,this.blendEquation=La,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.blendColor=new Kt(0,0,0),this.blendAlpha=0,this.depthFunc=Oh,this.depthTest=!0,this.depthWrite=!0,this.stencilWriteMask=255,this.stencilFunc=Qw,this.stencilRef=0,this.stencilFuncMask=255,this.stencilFail=Yp,this.stencilZFail=Yp,this.stencilZPass=Yp,this.stencilWrite=!1,this.clippingPlanes=null,this.clipIntersection=!1,this.clipShadows=!1,this.shadowSide=null,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.dithering=!1,this.alphaToCoverage=!1,this.premultipliedAlpha=!1,this.forceSinglePass=!1,this.allowOverride=!0,this.visible=!0,this.toneMapped=!0,this.userData={},this.version=0,this._alphaTest=0}get alphaTest(){return this._alphaTest}set alphaTest(e){this._alphaTest>0!=e>0&&this.version++,this._alphaTest=e}onBeforeRender(){}onBeforeCompile(){}customProgramCacheKey(){return this.onBeforeCompile.toString()}setValues(e){if(e!==void 0)for(const t in e){const n=e[t];if(n===void 0){Ve(`Material: parameter '${t}' has value of undefined.`);continue}const i=this[t];if(i===void 0){Ve(`Material: '${t}' is not a property of THREE.${this.type}.`);continue}i&&i.isColor?i.set(n):i&&i.isVector3&&n&&n.isVector3?i.copy(n):this[t]=n}}toJSON(e){const t=e===void 0||typeof e=="string";t&&(e={textures:{},images:{}});const n={metadata:{version:4.7,type:"Material",generator:"Material.toJSON"}};n.uuid=this.uuid,n.type=this.type,this.name!==""&&(n.name=this.name),this.color&&this.color.isColor&&(n.color=this.color.getHex()),this.roughness!==void 0&&(n.roughness=this.roughness),this.metalness!==void 0&&(n.metalness=this.metalness),this.sheen!==void 0&&(n.sheen=this.sheen),this.sheenColor&&this.sheenColor.isColor&&(n.sheenColor=this.sheenColor.getHex()),this.sheenRoughness!==void 0&&(n.sheenRoughness=this.sheenRoughness),this.emissive&&this.emissive.isColor&&(n.emissive=this.emissive.getHex()),this.emissiveIntensity!==void 0&&this.emissiveIntensity!==1&&(n.emissiveIntensity=this.emissiveIntensity),this.specular&&this.specular.isColor&&(n.specular=this.specular.getHex()),this.specularIntensity!==void 0&&(n.specularIntensity=this.specularIntensity),this.specularColor&&this.specularColor.isColor&&(n.specularColor=this.specularColor.getHex()),this.shininess!==void 0&&(n.shininess=this.shininess),this.clearcoat!==void 0&&(n.clearcoat=this.clearcoat),this.clearcoatRoughness!==void 0&&(n.clearcoatRoughness=this.clearcoatRoughness),this.clearcoatMap&&this.clearcoatMap.isTexture&&(n.clearcoatMap=this.clearcoatMap.toJSON(e).uuid),this.clearcoatRoughnessMap&&this.clearcoatRoughnessMap.isTexture&&(n.clearcoatRoughnessMap=this.clearcoatRoughnessMap.toJSON(e).uuid),this.clearcoatNormalMap&&this.clearcoatNormalMap.isTexture&&(n.clearcoatNormalMap=this.clearcoatNormalMap.toJSON(e).uuid,n.clearcoatNormalScale=this.clearcoatNormalScale.toArray()),this.sheenColorMap&&this.sheenColorMap.isTexture&&(n.sheenColorMap=this.sheenColorMap.toJSON(e).uuid),this.sheenRoughnessMap&&this.sheenRoughnessMap.isTexture&&(n.sheenRoughnessMap=this.sheenRoughnessMap.toJSON(e).uuid),this.dispersion!==void 0&&(n.dispersion=this.dispersion),this.iridescence!==void 0&&(n.iridescence=this.iridescence),this.iridescenceIOR!==void 0&&(n.iridescenceIOR=this.iridescenceIOR),this.iridescenceThicknessRange!==void 0&&(n.iridescenceThicknessRange=this.iridescenceThicknessRange),this.iridescenceMap&&this.iridescenceMap.isTexture&&(n.iridescenceMap=this.iridescenceMap.toJSON(e).uuid),this.iridescenceThicknessMap&&this.iridescenceThicknessMap.isTexture&&(n.iridescenceThicknessMap=this.iridescenceThicknessMap.toJSON(e).uuid),this.anisotropy!==void 0&&(n.anisotropy=this.anisotropy),this.anisotropyRotation!==void 0&&(n.anisotropyRotation=this.anisotropyRotation),this.anisotropyMap&&this.anisotropyMap.isTexture&&(n.anisotropyMap=this.anisotropyMap.toJSON(e).uuid),this.map&&this.map.isTexture&&(n.map=this.map.toJSON(e).uuid),this.matcap&&this.matcap.isTexture&&(n.matcap=this.matcap.toJSON(e).uuid),this.alphaMap&&this.alphaMap.isTexture&&(n.alphaMap=this.alphaMap.toJSON(e).uuid),this.lightMap&&this.lightMap.isTexture&&(n.lightMap=this.lightMap.toJSON(e).uuid,n.lightMapIntensity=this.lightMapIntensity),this.aoMap&&this.aoMap.isTexture&&(n.aoMap=this.aoMap.toJSON(e).uuid,n.aoMapIntensity=this.aoMapIntensity),this.bumpMap&&this.bumpMap.isTexture&&(n.bumpMap=this.bumpMap.toJSON(e).uuid,n.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(n.normalMap=this.normalMap.toJSON(e).uuid,n.normalMapType=this.normalMapType,n.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(n.displacementMap=this.displacementMap.toJSON(e).uuid,n.displacementScale=this.displacementScale,n.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(n.roughnessMap=this.roughnessMap.toJSON(e).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(n.metalnessMap=this.metalnessMap.toJSON(e).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(n.emissiveMap=this.emissiveMap.toJSON(e).uuid),this.specularMap&&this.specularMap.isTexture&&(n.specularMap=this.specularMap.toJSON(e).uuid),this.specularIntensityMap&&this.specularIntensityMap.isTexture&&(n.specularIntensityMap=this.specularIntensityMap.toJSON(e).uuid),this.specularColorMap&&this.specularColorMap.isTexture&&(n.specularColorMap=this.specularColorMap.toJSON(e).uuid),this.envMap&&this.envMap.isTexture&&(n.envMap=this.envMap.toJSON(e).uuid,this.combine!==void 0&&(n.combine=this.combine)),this.envMapRotation!==void 0&&(n.envMapRotation=this.envMapRotation.toArray()),this.envMapIntensity!==void 0&&(n.envMapIntensity=this.envMapIntensity),this.reflectivity!==void 0&&(n.reflectivity=this.reflectivity),this.refractionRatio!==void 0&&(n.refractionRatio=this.refractionRatio),this.gradientMap&&this.gradientMap.isTexture&&(n.gradientMap=this.gradientMap.toJSON(e).uuid),this.transmission!==void 0&&(n.transmission=this.transmission),this.transmissionMap&&this.transmissionMap.isTexture&&(n.transmissionMap=this.transmissionMap.toJSON(e).uuid),this.thickness!==void 0&&(n.thickness=this.thickness),this.thicknessMap&&this.thicknessMap.isTexture&&(n.thicknessMap=this.thicknessMap.toJSON(e).uuid),this.attenuationDistance!==void 0&&this.attenuationDistance!==1/0&&(n.attenuationDistance=this.attenuationDistance),this.attenuationColor!==void 0&&(n.attenuationColor=this.attenuationColor.getHex()),this.size!==void 0&&(n.size=this.size),this.shadowSide!==null&&(n.shadowSide=this.shadowSide),this.sizeAttenuation!==void 0&&(n.sizeAttenuation=this.sizeAttenuation),this.blending!==Nl&&(n.blending=this.blending),this.side!==Cl&&(n.side=this.side),this.vertexColors===!0&&(n.vertexColors=!0),this.opacity<1&&(n.opacity=this.opacity),this.transparent===!0&&(n.transparent=!0),this.blendSrc!==nx&&(n.blendSrc=this.blendSrc),this.blendDst!==ix&&(n.blendDst=this.blendDst),this.blendEquation!==La&&(n.blendEquation=this.blendEquation),this.blendSrcAlpha!==null&&(n.blendSrcAlpha=this.blendSrcAlpha),this.blendDstAlpha!==null&&(n.blendDstAlpha=this.blendDstAlpha),this.blendEquationAlpha!==null&&(n.blendEquationAlpha=this.blendEquationAlpha),this.blendColor&&this.blendColor.isColor&&(n.blendColor=this.blendColor.getHex()),this.blendAlpha!==0&&(n.blendAlpha=this.blendAlpha),this.depthFunc!==Oh&&(n.depthFunc=this.depthFunc),this.depthTest===!1&&(n.depthTest=this.depthTest),this.depthWrite===!1&&(n.depthWrite=this.depthWrite),this.colorWrite===!1&&(n.colorWrite=this.colorWrite),this.stencilWriteMask!==255&&(n.stencilWriteMask=this.stencilWriteMask),this.stencilFunc!==Qw&&(n.stencilFunc=this.stencilFunc),this.stencilRef!==0&&(n.stencilRef=this.stencilRef),this.stencilFuncMask!==255&&(n.stencilFuncMask=this.stencilFuncMask),this.stencilFail!==Yp&&(n.stencilFail=this.stencilFail),this.stencilZFail!==Yp&&(n.stencilZFail=this.stencilZFail),this.stencilZPass!==Yp&&(n.stencilZPass=this.stencilZPass),this.stencilWrite===!0&&(n.stencilWrite=this.stencilWrite),this.rotation!==void 0&&this.rotation!==0&&(n.rotation=this.rotation),this.polygonOffset===!0&&(n.polygonOffset=!0),this.polygonOffsetFactor!==0&&(n.polygonOffsetFactor=this.polygonOffsetFactor),this.polygonOffsetUnits!==0&&(n.polygonOffsetUnits=this.polygonOffsetUnits),this.linewidth!==void 0&&this.linewidth!==1&&(n.linewidth=this.linewidth),this.dashSize!==void 0&&(n.dashSize=this.dashSize),this.gapSize!==void 0&&(n.gapSize=this.gapSize),this.scale!==void 0&&(n.scale=this.scale),this.dithering===!0&&(n.dithering=!0),this.alphaTest>0&&(n.alphaTest=this.alphaTest),this.alphaHash===!0&&(n.alphaHash=!0),this.alphaToCoverage===!0&&(n.alphaToCoverage=!0),this.premultipliedAlpha===!0&&(n.premultipliedAlpha=!0),this.forceSinglePass===!0&&(n.forceSinglePass=!0),this.allowOverride===!1&&(n.allowOverride=!1),this.wireframe===!0&&(n.wireframe=!0),this.wireframeLinewidth>1&&(n.wireframeLinewidth=this.wireframeLinewidth),this.wireframeLinecap!=="round"&&(n.wireframeLinecap=this.wireframeLinecap),this.wireframeLinejoin!=="round"&&(n.wireframeLinejoin=this.wireframeLinejoin),this.flatShading===!0&&(n.flatShading=!0),this.visible===!1&&(n.visible=!1),this.toneMapped===!1&&(n.toneMapped=!1),this.fog===!1&&(n.fog=!1),Object.keys(this.userData).length>0&&(n.userData=this.userData);function i(s){const a=[];for(const o in s){const l=s[o];delete l.metadata,a.push(l)}return a}if(t){const s=i(e.textures),a=i(e.images);s.length>0&&(n.textures=s),a.length>0&&(n.images=a)}return n}clone(){return new this.constructor().copy(this)}copy(e){this.name=e.name,this.blending=e.blending,this.side=e.side,this.vertexColors=e.vertexColors,this.opacity=e.opacity,this.transparent=e.transparent,this.blendSrc=e.blendSrc,this.blendDst=e.blendDst,this.blendEquation=e.blendEquation,this.blendSrcAlpha=e.blendSrcAlpha,this.blendDstAlpha=e.blendDstAlpha,this.blendEquationAlpha=e.blendEquationAlpha,this.blendColor.copy(e.blendColor),this.blendAlpha=e.blendAlpha,this.depthFunc=e.depthFunc,this.depthTest=e.depthTest,this.depthWrite=e.depthWrite,this.stencilWriteMask=e.stencilWriteMask,this.stencilFunc=e.stencilFunc,this.stencilRef=e.stencilRef,this.stencilFuncMask=e.stencilFuncMask,this.stencilFail=e.stencilFail,this.stencilZFail=e.stencilZFail,this.stencilZPass=e.stencilZPass,this.stencilWrite=e.stencilWrite;const t=e.clippingPlanes;let n=null;if(t!==null){const i=t.length;n=new Array(i);for(let s=0;s!==i;++s)n[s]=t[s].clone()}return this.clippingPlanes=n,this.clipIntersection=e.clipIntersection,this.clipShadows=e.clipShadows,this.shadowSide=e.shadowSide,this.colorWrite=e.colorWrite,this.precision=e.precision,this.polygonOffset=e.polygonOffset,this.polygonOffsetFactor=e.polygonOffsetFactor,this.polygonOffsetUnits=e.polygonOffsetUnits,this.dithering=e.dithering,this.alphaTest=e.alphaTest,this.alphaHash=e.alphaHash,this.alphaToCoverage=e.alphaToCoverage,this.premultipliedAlpha=e.premultipliedAlpha,this.forceSinglePass=e.forceSinglePass,this.allowOverride=e.allowOverride,this.visible=e.visible,this.toneMapped=e.toneMapped,this.userData=JSON.parse(JSON.stringify(e.userData)),this}dispose(){this.dispatchEvent({type:"dispose"})}set needsUpdate(e){e===!0&&this.version++}}class lo extends Ta{constructor(e){super(),this.isMeshBasicMaterial=!0,this.type="MeshBasicMaterial",this.color=new Kt(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new ll,this.combine=Ix,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapRotation.copy(e.envMapRotation),this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.fog=e.fog,this}}const dh=UZ();function UZ(){const r=new ArrayBuffer(4),e=new Float32Array(r),t=new Uint32Array(r),n=new Uint32Array(512),i=new Uint32Array(512);for(let l=0;l<256;++l){const c=l-127;c<-27?(n[l]=0,n[l|256]=32768,i[l]=24,i[l|256]=24):c<-14?(n[l]=1024>>-c-14,n[l|256]=1024>>-c-14|32768,i[l]=-c-1,i[l|256]=-c-1):c<=15?(n[l]=c+15<<10,n[l|256]=c+15<<10|32768,i[l]=13,i[l|256]=13):c<128?(n[l]=31744,n[l|256]=64512,i[l]=24,i[l|256]=24):(n[l]=31744,n[l|256]=64512,i[l]=13,i[l|256]=13)}const s=new Uint32Array(2048),a=new Uint32Array(64),o=new Uint32Array(64);for(let l=1;l<1024;++l){let c=l<<13,d=0;for(;(c&8388608)===0;)c<<=1,d-=8388608;c&=-8388609,d+=947912704,s[l]=c|d}for(let l=1024;l<2048;++l)s[l]=939524096+(l-1024<<13);for(let l=1;l<31;++l)a[l]=l<<23;a[31]=1199570944,a[32]=2147483648;for(let l=33;l<63;++l)a[l]=2147483648+(l-32<<23);a[63]=3347054592;for(let l=1;l<64;++l)l!==32&&(o[l]=1024);return{floatView:e,uint32View:t,baseTable:n,shiftTable:i,mantissaTable:s,exponentTable:a,offsetTable:o}}function bl(r){Math.abs(r)>65504&&Ve("DataUtils.toHalfFloat(): Value out of range."),r=Yn(r,-65504,65504),dh.floatView[0]=r;const e=dh.uint32View[0],t=e>>23&511;return dh.baseTable[t]+((e&8388607)>>dh.shiftTable[t])}function fT(r){const e=r>>10;return dh.uint32View[0]=dh.mantissaTable[dh.offsetTable[e]+(r&1023)]+dh.exponentTable[e],dh.floatView[0]}class m0{static toHalfFloat(e){return bl(e)}static fromHalfFloat(e){return fT(e)}}const Is=new ne,$M=new tt;let LZ=0;class Ji{constructor(e,t,n=!1){if(Array.isArray(e))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.isBufferAttribute=!0,Object.defineProperty(this,"id",{value:LZ++}),this.name="",this.array=e,this.itemSize=t,this.count=e!==void 0?e.length/t:0,this.normalized=n,this.usage=xm,this.updateRanges=[],this.gpuType=Ci,this.version=0}onUploadCallback(){}set needsUpdate(e){e===!0&&this.version++}setUsage(e){return this.usage=e,this}addUpdateRange(e,t){this.updateRanges.push({start:e,count:t})}clearUpdateRanges(){this.updateRanges.length=0}copy(e){return this.name=e.name,this.array=new e.array.constructor(e.array),this.itemSize=e.itemSize,this.count=e.count,this.normalized=e.normalized,this.usage=e.usage,this.gpuType=e.gpuType,this}copyAt(e,t,n){e*=this.itemSize,n*=t.itemSize;for(let i=0,s=this.itemSize;i<s;i++)this.array[e+i]=t.array[n+i];return this}copyArray(e){return this.array.set(e),this}applyMatrix3(e){if(this.itemSize===2)for(let t=0,n=this.count;t<n;t++)$M.fromBufferAttribute(this,t),$M.applyMatrix3(e),this.setXY(t,$M.x,$M.y);else if(this.itemSize===3)for(let t=0,n=this.count;t<n;t++)Is.fromBufferAttribute(this,t),Is.applyMatrix3(e),this.setXYZ(t,Is.x,Is.y,Is.z);return this}applyMatrix4(e){for(let t=0,n=this.count;t<n;t++)Is.fromBufferAttribute(this,t),Is.applyMatrix4(e),this.setXYZ(t,Is.x,Is.y,Is.z);return this}applyNormalMatrix(e){for(let t=0,n=this.count;t<n;t++)Is.fromBufferAttribute(this,t),Is.applyNormalMatrix(e),this.setXYZ(t,Is.x,Is.y,Is.z);return this}transformDirection(e){for(let t=0,n=this.count;t<n;t++)Is.fromBufferAttribute(this,t),Is.transformDirection(e),this.setXYZ(t,Is.x,Is.y,Is.z);return this}set(e,t=0){return this.array.set(e,t),this}getComponent(e,t){let n=this.array[e*this.itemSize+t];return this.normalized&&(n=el(n,this.array)),n}setComponent(e,t,n){return this.normalized&&(n=ai(n,this.array)),this.array[e*this.itemSize+t]=n,this}getX(e){let t=this.array[e*this.itemSize];return this.normalized&&(t=el(t,this.array)),t}setX(e,t){return this.normalized&&(t=ai(t,this.array)),this.array[e*this.itemSize]=t,this}getY(e){let t=this.array[e*this.itemSize+1];return this.normalized&&(t=el(t,this.array)),t}setY(e,t){return this.normalized&&(t=ai(t,this.array)),this.array[e*this.itemSize+1]=t,this}getZ(e){let t=this.array[e*this.itemSize+2];return this.normalized&&(t=el(t,this.array)),t}setZ(e,t){return this.normalized&&(t=ai(t,this.array)),this.array[e*this.itemSize+2]=t,this}getW(e){let t=this.array[e*this.itemSize+3];return this.normalized&&(t=el(t,this.array)),t}setW(e,t){return this.normalized&&(t=ai(t,this.array)),this.array[e*this.itemSize+3]=t,this}setXY(e,t,n){return e*=this.itemSize,this.normalized&&(t=ai(t,this.array),n=ai(n,this.array)),this.array[e+0]=t,this.array[e+1]=n,this}setXYZ(e,t,n,i){return e*=this.itemSize,this.normalized&&(t=ai(t,this.array),n=ai(n,this.array),i=ai(i,this.array)),this.array[e+0]=t,this.array[e+1]=n,this.array[e+2]=i,this}setXYZW(e,t,n,i,s){return e*=this.itemSize,this.normalized&&(t=ai(t,this.array),n=ai(n,this.array),i=ai(i,this.array),s=ai(s,this.array)),this.array[e+0]=t,this.array[e+1]=n,this.array[e+2]=i,this.array[e+3]=s,this}onUpload(e){return this.onUploadCallback=e,this}clone(){return new this.constructor(this.array,this.itemSize).copy(this)}toJSON(){const e={itemSize:this.itemSize,type:this.array.constructor.name,array:Array.from(this.array),normalized:this.normalized};return this.name!==""&&(e.name=this.name),this.usage!==xm&&(e.usage=this.usage),e}}class PZ extends Ji{constructor(e,t,n){super(new Int8Array(e),t,n)}}class BZ extends Ji{constructor(e,t,n){super(new Uint8Array(e),t,n)}}class IZ extends Ji{constructor(e,t,n){super(new Uint8ClampedArray(e),t,n)}}class FZ extends Ji{constructor(e,t,n){super(new Int16Array(e),t,n)}}class TC extends Ji{constructor(e,t,n){super(new Uint16Array(e),t,n)}}class zZ extends Ji{constructor(e,t,n){super(new Int32Array(e),t,n)}}class EC extends Ji{constructor(e,t,n){super(new Uint32Array(e),t,n)}}class lL extends Ji{constructor(e,t,n){super(new Uint16Array(e),t,n),this.isFloat16BufferAttribute=!0}getX(e){let t=fT(this.array[e*this.itemSize]);return this.normalized&&(t=el(t,this.array)),t}setX(e,t){return this.normalized&&(t=ai(t,this.array)),this.array[e*this.itemSize]=bl(t),this}getY(e){let t=fT(this.array[e*this.itemSize+1]);return this.normalized&&(t=el(t,this.array)),t}setY(e,t){return this.normalized&&(t=ai(t,this.array)),this.array[e*this.itemSize+1]=bl(t),this}getZ(e){let t=fT(this.array[e*this.itemSize+2]);return this.normalized&&(t=el(t,this.array)),t}setZ(e,t){return this.normalized&&(t=ai(t,this.array)),this.array[e*this.itemSize+2]=bl(t),this}getW(e){let t=fT(this.array[e*this.itemSize+3]);return this.normalized&&(t=el(t,this.array)),t}setW(e,t){return this.normalized&&(t=ai(t,this.array)),this.array[e*this.itemSize+3]=bl(t),this}setXY(e,t,n){return e*=this.itemSize,this.normalized&&(t=ai(t,this.array),n=ai(n,this.array)),this.array[e+0]=bl(t),this.array[e+1]=bl(n),this}setXYZ(e,t,n,i){return e*=this.itemSize,this.normalized&&(t=ai(t,this.array),n=ai(n,this.array),i=ai(i,this.array)),this.array[e+0]=bl(t),this.array[e+1]=bl(n),this.array[e+2]=bl(i),this}setXYZW(e,t,n,i,s){return e*=this.itemSize,this.normalized&&(t=ai(t,this.array),n=ai(n,this.array),i=ai(i,this.array),s=ai(s,this.array)),this.array[e+0]=bl(t),this.array[e+1]=bl(n),this.array[e+2]=bl(i),this.array[e+3]=bl(s),this}}class hn extends Ji{constructor(e,t,n){super(new Float32Array(e),t,n)}}let VZ=0;const ku=new gn,K2=new Fi,J_=new ne,eu=new _o,DS=new _o,pa=new ne;class Qn extends Gl{constructor(){super(),this.isBufferGeometry=!0,Object.defineProperty(this,"id",{value:VZ++}),this.uuid=pu(),this.name="",this.type="BufferGeometry",this.index=null,this.indirect=null,this.indirectOffset=0,this.attributes={},this.morphAttributes={},this.morphTargetsRelative=!1,this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:1/0},this.userData={}}getIndex(){return this.index}setIndex(e){return Array.isArray(e)?this.index=new(rL(e)?EC:TC)(e,1):this.index=e,this}setIndirect(e,t=0){return this.indirect=e,this.indirectOffset=t,this}getIndirect(){return this.indirect}getAttribute(e){return this.attributes[e]}setAttribute(e,t){return this.attributes[e]=t,this}deleteAttribute(e){return delete this.attributes[e],this}hasAttribute(e){return this.attributes[e]!==void 0}addGroup(e,t,n=0){this.groups.push({start:e,count:t,materialIndex:n})}clearGroups(){this.groups=[]}setDrawRange(e,t){this.drawRange.start=e,this.drawRange.count=t}applyMatrix4(e){const t=this.attributes.position;t!==void 0&&(t.applyMatrix4(e),t.needsUpdate=!0);const n=this.attributes.normal;if(n!==void 0){const s=new Zn().getNormalMatrix(e);n.applyNormalMatrix(s),n.needsUpdate=!0}const i=this.attributes.tangent;return i!==void 0&&(i.transformDirection(e),i.needsUpdate=!0),this.boundingBox!==null&&this.computeBoundingBox(),this.boundingSphere!==null&&this.computeBoundingSphere(),this}applyQuaternion(e){return ku.makeRotationFromQuaternion(e),this.applyMatrix4(ku),this}rotateX(e){return ku.makeRotationX(e),this.applyMatrix4(ku),this}rotateY(e){return ku.makeRotationY(e),this.applyMatrix4(ku),this}rotateZ(e){return ku.makeRotationZ(e),this.applyMatrix4(ku),this}translate(e,t,n){return ku.makeTranslation(e,t,n),this.applyMatrix4(ku),this}scale(e,t,n){return ku.makeScale(e,t,n),this.applyMatrix4(ku),this}lookAt(e){return K2.lookAt(e),K2.updateMatrix(),this.applyMatrix4(K2.matrix),this}center(){return this.computeBoundingBox(),this.boundingBox.getCenter(J_).negate(),this.translate(J_.x,J_.y,J_.z),this}setFromPoints(e){const t=this.getAttribute("position");if(t===void 0){const n=[];for(let i=0,s=e.length;i<s;i++){const a=e[i];n.push(a.x,a.y,a.z||0)}this.setAttribute("position",new hn(n,3))}else{const n=Math.min(e.length,t.count);for(let i=0;i<n;i++){const s=e[i];t.setXYZ(i,s.x,s.y,s.z||0)}e.length>t.count&&Ve("BufferGeometry: Buffer size too small for points data. Use .dispose() and create a new geometry."),t.needsUpdate=!0}return this}computeBoundingBox(){this.boundingBox===null&&(this.boundingBox=new _o);const e=this.attributes.position,t=this.morphAttributes.position;if(e&&e.isGLBufferAttribute){Ze("BufferGeometry.computeBoundingBox(): GLBufferAttribute requires a manual bounding box.",this),this.boundingBox.set(new ne(-1/0,-1/0,-1/0),new ne(1/0,1/0,1/0));return}if(e!==void 0){if(this.boundingBox.setFromBufferAttribute(e),t)for(let n=0,i=t.length;n<i;n++){const s=t[n];eu.setFromBufferAttribute(s),this.morphTargetsRelative?(pa.addVectors(this.boundingBox.min,eu.min),this.boundingBox.expandByPoint(pa),pa.addVectors(this.boundingBox.max,eu.max),this.boundingBox.expandByPoint(pa)):(this.boundingBox.expandByPoint(eu.min),this.boundingBox.expandByPoint(eu.max))}}else this.boundingBox.makeEmpty();(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&Ze('BufferGeometry.computeBoundingBox(): Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)}computeBoundingSphere(){this.boundingSphere===null&&(this.boundingSphere=new Sa);const e=this.attributes.position,t=this.morphAttributes.position;if(e&&e.isGLBufferAttribute){Ze("BufferGeometry.computeBoundingSphere(): GLBufferAttribute requires a manual bounding sphere.",this),this.boundingSphere.set(new ne,1/0);return}if(e){const n=this.boundingSphere.center;if(eu.setFromBufferAttribute(e),t)for(let s=0,a=t.length;s<a;s++){const o=t[s];DS.setFromBufferAttribute(o),this.morphTargetsRelative?(pa.addVectors(eu.min,DS.min),eu.expandByPoint(pa),pa.addVectors(eu.max,DS.max),eu.expandByPoint(pa)):(eu.expandByPoint(DS.min),eu.expandByPoint(DS.max))}eu.getCenter(n);let i=0;for(let s=0,a=e.count;s<a;s++)pa.fromBufferAttribute(e,s),i=Math.max(i,n.distanceToSquared(pa));if(t)for(let s=0,a=t.length;s<a;s++){const o=t[s],l=this.morphTargetsRelative;for(let c=0,d=o.count;c<d;c++)pa.fromBufferAttribute(o,c),l&&(J_.fromBufferAttribute(e,c),pa.add(J_)),i=Math.max(i,n.distanceToSquared(pa))}this.boundingSphere.radius=Math.sqrt(i),isNaN(this.boundingSphere.radius)&&Ze('BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}}computeTangents(){const e=this.index,t=this.attributes;if(e===null||t.position===void 0||t.normal===void 0||t.uv===void 0){Ze("BufferGeometry: .computeTangents() failed. Missing required attributes (index, position, normal or uv)");return}const n=t.position,i=t.normal,s=t.uv;this.hasAttribute("tangent")===!1&&this.setAttribute("tangent",new Ji(new Float32Array(4*n.count),4));const a=this.getAttribute("tangent"),o=[],l=[];for(let F=0;F<n.count;F++)o[F]=new ne,l[F]=new ne;const c=new ne,d=new ne,p=new ne,y=new tt,_=new tt,v=new tt,b=new ne,E=new ne;function T(F,O,B){c.fromBufferAttribute(n,F),d.fromBufferAttribute(n,O),p.fromBufferAttribute(n,B),y.fromBufferAttribute(s,F),_.fromBufferAttribute(s,O),v.fromBufferAttribute(s,B),d.sub(c),p.sub(c),_.sub(y),v.sub(y);const q=1/(_.x*v.y-v.x*_.y);isFinite(q)&&(b.copy(d).multiplyScalar(v.y).addScaledVector(p,-_.y).multiplyScalar(q),E.copy(p).multiplyScalar(_.x).addScaledVector(d,-v.x).multiplyScalar(q),o[F].add(b),o[O].add(b),o[B].add(b),l[F].add(E),l[O].add(E),l[B].add(E))}let M=this.groups;M.length===0&&(M=[{start:0,count:e.count}]);for(let F=0,O=M.length;F<O;++F){const B=M[F],q=B.start,j=B.count;for(let Q=q,se=q+j;Q<se;Q+=3)T(e.getX(Q+0),e.getX(Q+1),e.getX(Q+2))}const R=new ne,N=new ne,P=new ne,U=new ne;function L(F){P.fromBufferAttribute(i,F),U.copy(P);const O=o[F];R.copy(O),R.sub(P.multiplyScalar(P.dot(O))).normalize(),N.crossVectors(U,O);const q=N.dot(l[F])<0?-1:1;a.setXYZW(F,R.x,R.y,R.z,q)}for(let F=0,O=M.length;F<O;++F){const B=M[F],q=B.start,j=B.count;for(let Q=q,se=q+j;Q<se;Q+=3)L(e.getX(Q+0)),L(e.getX(Q+1)),L(e.getX(Q+2))}}computeVertexNormals(){const e=this.index,t=this.getAttribute("position");if(t!==void 0){let n=this.getAttribute("normal");if(n===void 0)n=new Ji(new Float32Array(t.count*3),3),this.setAttribute("normal",n);else for(let y=0,_=n.count;y<_;y++)n.setXYZ(y,0,0,0);const i=new ne,s=new ne,a=new ne,o=new ne,l=new ne,c=new ne,d=new ne,p=new ne;if(e)for(let y=0,_=e.count;y<_;y+=3){const v=e.getX(y+0),b=e.getX(y+1),E=e.getX(y+2);i.fromBufferAttribute(t,v),s.fromBufferAttribute(t,b),a.fromBufferAttribute(t,E),d.subVectors(a,s),p.subVectors(i,s),d.cross(p),o.fromBufferAttribute(n,v),l.fromBufferAttribute(n,b),c.fromBufferAttribute(n,E),o.add(d),l.add(d),c.add(d),n.setXYZ(v,o.x,o.y,o.z),n.setXYZ(b,l.x,l.y,l.z),n.setXYZ(E,c.x,c.y,c.z)}else for(let y=0,_=t.count;y<_;y+=3)i.fromBufferAttribute(t,y+0),s.fromBufferAttribute(t,y+1),a.fromBufferAttribute(t,y+2),d.subVectors(a,s),p.subVectors(i,s),d.cross(p),n.setXYZ(y+0,d.x,d.y,d.z),n.setXYZ(y+1,d.x,d.y,d.z),n.setXYZ(y+2,d.x,d.y,d.z);this.normalizeNormals(),n.needsUpdate=!0}}normalizeNormals(){const e=this.attributes.normal;for(let t=0,n=e.count;t<n;t++)pa.fromBufferAttribute(e,t),pa.normalize(),e.setXYZ(t,pa.x,pa.y,pa.z)}toNonIndexed(){function e(o,l){const c=o.array,d=o.itemSize,p=o.normalized,y=new c.constructor(l.length*d);let _=0,v=0;for(let b=0,E=l.length;b<E;b++){o.isInterleavedBufferAttribute?_=l[b]*o.data.stride+o.offset:_=l[b]*d;for(let T=0;T<d;T++)y[v++]=c[_++]}return new Ji(y,d,p)}if(this.index===null)return Ve("BufferGeometry.toNonIndexed(): BufferGeometry is already non-indexed."),this;const t=new Qn,n=this.index.array,i=this.attributes;for(const o in i){const l=i[o],c=e(l,n);t.setAttribute(o,c)}const s=this.morphAttributes;for(const o in s){const l=[],c=s[o];for(let d=0,p=c.length;d<p;d++){const y=c[d],_=e(y,n);l.push(_)}t.morphAttributes[o]=l}t.morphTargetsRelative=this.morphTargetsRelative;const a=this.groups;for(let o=0,l=a.length;o<l;o++){const c=a[o];t.addGroup(c.start,c.count,c.materialIndex)}return t}toJSON(){const e={metadata:{version:4.7,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(e.uuid=this.uuid,e.type=this.type,this.name!==""&&(e.name=this.name),Object.keys(this.userData).length>0&&(e.userData=this.userData),this.parameters!==void 0){const l=this.parameters;for(const c in l)l[c]!==void 0&&(e[c]=l[c]);return e}e.data={attributes:{}};const t=this.index;t!==null&&(e.data.index={type:t.array.constructor.name,array:Array.prototype.slice.call(t.array)});const n=this.attributes;for(const l in n){const c=n[l];e.data.attributes[l]=c.toJSON(e.data)}const i={};let s=!1;for(const l in this.morphAttributes){const c=this.morphAttributes[l],d=[];for(let p=0,y=c.length;p<y;p++){const _=c[p];d.push(_.toJSON(e.data))}d.length>0&&(i[l]=d,s=!0)}s&&(e.data.morphAttributes=i,e.data.morphTargetsRelative=this.morphTargetsRelative);const a=this.groups;a.length>0&&(e.data.groups=JSON.parse(JSON.stringify(a)));const o=this.boundingSphere;return o!==null&&(e.data.boundingSphere=o.toJSON()),e}clone(){return new this.constructor().copy(this)}copy(e){this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null;const t={};this.name=e.name;const n=e.index;n!==null&&this.setIndex(n.clone());const i=e.attributes;for(const c in i){const d=i[c];this.setAttribute(c,d.clone(t))}const s=e.morphAttributes;for(const c in s){const d=[],p=s[c];for(let y=0,_=p.length;y<_;y++)d.push(p[y].clone(t));this.morphAttributes[c]=d}this.morphTargetsRelative=e.morphTargetsRelative;const a=e.groups;for(let c=0,d=a.length;c<d;c++){const p=a[c];this.addGroup(p.start,p.count,p.materialIndex)}const o=e.boundingBox;o!==null&&(this.boundingBox=o.clone());const l=e.boundingSphere;return l!==null&&(this.boundingSphere=l.clone()),this.drawRange.start=e.drawRange.start,this.drawRange.count=e.drawRange.count,this.userData=e.userData,this}dispose(){this.dispatchEvent({type:"dispose"})}}const JF=new gn,Fg=new wy,jM=new Sa,ez=new ne,YM=new ne,ZM=new ne,KM=new ne,Q2=new ne,QM=new ne,tz=new ne,JM=new ne;class ar extends Fi{constructor(e=new Qn,t=new lo){super(),this.isMesh=!0,this.type="Mesh",this.geometry=e,this.material=t,this.morphTargetDictionary=void 0,this.morphTargetInfluences=void 0,this.count=1,this.updateMorphTargets()}copy(e,t){return super.copy(e,t),e.morphTargetInfluences!==void 0&&(this.morphTargetInfluences=e.morphTargetInfluences.slice()),e.morphTargetDictionary!==void 0&&(this.morphTargetDictionary=Object.assign({},e.morphTargetDictionary)),this.material=Array.isArray(e.material)?e.material.slice():e.material,this.geometry=e.geometry,this}updateMorphTargets(){const t=this.geometry.morphAttributes,n=Object.keys(t);if(n.length>0){const i=t[n[0]];if(i!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let s=0,a=i.length;s<a;s++){const o=i[s].name||String(s);this.morphTargetInfluences.push(0),this.morphTargetDictionary[o]=s}}}}getVertexPosition(e,t){const n=this.geometry,i=n.attributes.position,s=n.morphAttributes.position,a=n.morphTargetsRelative;t.fromBufferAttribute(i,e);const o=this.morphTargetInfluences;if(s&&o){QM.set(0,0,0);for(let l=0,c=s.length;l<c;l++){const d=o[l],p=s[l];d!==0&&(Q2.fromBufferAttribute(p,e),a?QM.addScaledVector(Q2,d):QM.addScaledVector(Q2.sub(t),d))}t.add(QM)}return t}raycast(e,t){const n=this.geometry,i=this.material,s=this.matrixWorld;i!==void 0&&(n.boundingSphere===null&&n.computeBoundingSphere(),jM.copy(n.boundingSphere),jM.applyMatrix4(s),Fg.copy(e.ray).recast(e.near),!(jM.containsPoint(Fg.origin)===!1&&(Fg.intersectSphere(jM,ez)===null||Fg.origin.distanceToSquared(ez)>(e.far-e.near)**2))&&(JF.copy(s).invert(),Fg.copy(e.ray).applyMatrix4(JF),!(n.boundingBox!==null&&Fg.intersectsBox(n.boundingBox)===!1)&&this._computeIntersections(e,t,Fg)))}_computeIntersections(e,t,n){let i;const s=this.geometry,a=this.material,o=s.index,l=s.attributes.position,c=s.attributes.uv,d=s.attributes.uv1,p=s.attributes.normal,y=s.groups,_=s.drawRange;if(o!==null)if(Array.isArray(a))for(let v=0,b=y.length;v<b;v++){const E=y[v],T=a[E.materialIndex],M=Math.max(E.start,_.start),R=Math.min(o.count,Math.min(E.start+E.count,_.start+_.count));for(let N=M,P=R;N<P;N+=3){const U=o.getX(N),L=o.getX(N+1),F=o.getX(N+2);i=eA(this,T,e,n,c,d,p,U,L,F),i&&(i.faceIndex=Math.floor(N/3),i.face.materialIndex=E.materialIndex,t.push(i))}}else{const v=Math.max(0,_.start),b=Math.min(o.count,_.start+_.count);for(let E=v,T=b;E<T;E+=3){const M=o.getX(E),R=o.getX(E+1),N=o.getX(E+2);i=eA(this,a,e,n,c,d,p,M,R,N),i&&(i.faceIndex=Math.floor(E/3),t.push(i))}}else if(l!==void 0)if(Array.isArray(a))for(let v=0,b=y.length;v<b;v++){const E=y[v],T=a[E.materialIndex],M=Math.max(E.start,_.start),R=Math.min(l.count,Math.min(E.start+E.count,_.start+_.count));for(let N=M,P=R;N<P;N+=3){const U=N,L=N+1,F=N+2;i=eA(this,T,e,n,c,d,p,U,L,F),i&&(i.faceIndex=Math.floor(N/3),i.face.materialIndex=E.materialIndex,t.push(i))}}else{const v=Math.max(0,_.start),b=Math.min(l.count,_.start+_.count);for(let E=v,T=b;E<T;E+=3){const M=E,R=E+1,N=E+2;i=eA(this,a,e,n,c,d,p,M,R,N),i&&(i.faceIndex=Math.floor(E/3),t.push(i))}}}}function GZ(r,e,t,n,i,s,a,o){let l;if(e.side===gr?l=n.intersectTriangle(a,s,i,!0,o):l=n.intersectTriangle(i,s,a,e.side===Cl,o),l===null)return null;JM.copy(o),JM.applyMatrix4(r.matrixWorld);const c=t.ray.origin.distanceTo(JM);return c<t.near||c>t.far?null:{distance:c,point:JM.clone(),object:r}}function eA(r,e,t,n,i,s,a,o,l,c){r.getVertexPosition(o,YM),r.getVertexPosition(l,ZM),r.getVertexPosition(c,KM);const d=GZ(r,e,t,n,YM,ZM,KM,tz);if(d){const p=new ne;El.getBarycoord(tz,YM,ZM,KM,p),i&&(d.uv=El.getInterpolatedAttribute(i,o,l,c,p,new tt)),s&&(d.uv1=El.getInterpolatedAttribute(s,o,l,c,p,new tt)),a&&(d.normal=El.getInterpolatedAttribute(a,o,l,c,p,new ne),d.normal.dot(n.direction)>0&&d.normal.multiplyScalar(-1));const y={a:o,b:l,c,normal:new ne,materialIndex:0};El.getNormal(YM,ZM,KM,y.normal),d.face=y,d.barycoord=p}return d}class Xh extends Qn{constructor(e=1,t=1,n=1,i=1,s=1,a=1){super(),this.type="BoxGeometry",this.parameters={width:e,height:t,depth:n,widthSegments:i,heightSegments:s,depthSegments:a};const o=this;i=Math.floor(i),s=Math.floor(s),a=Math.floor(a);const l=[],c=[],d=[],p=[];let y=0,_=0;v("z","y","x",-1,-1,n,t,e,a,s,0),v("z","y","x",1,-1,n,t,-e,a,s,1),v("x","z","y",1,1,e,n,t,i,a,2),v("x","z","y",1,-1,e,n,-t,i,a,3),v("x","y","z",1,-1,e,t,n,i,s,4),v("x","y","z",-1,-1,e,t,-n,i,s,5),this.setIndex(l),this.setAttribute("position",new hn(c,3)),this.setAttribute("normal",new hn(d,3)),this.setAttribute("uv",new hn(p,2));function v(b,E,T,M,R,N,P,U,L,F,O){const B=N/L,q=P/F,j=N/2,Q=P/2,se=U/2,ae=L+1,V=F+1;let X=0,ee=0;const fe=new ne;for(let Y=0;Y<V;Y++){const K=Y*q-Q;for(let he=0;he<ae;he++){const Ce=he*B-j;fe[b]=Ce*M,fe[E]=K*R,fe[T]=se,c.push(fe.x,fe.y,fe.z),fe[b]=0,fe[E]=0,fe[T]=U>0?1:-1,d.push(fe.x,fe.y,fe.z),p.push(he/L),p.push(1-Y/F),X+=1}}for(let Y=0;Y<F;Y++)for(let K=0;K<L;K++){const he=y+K+ae*Y,Ce=y+K+ae*(Y+1),Ie=y+(K+1)+ae*(Y+1),ut=y+(K+1)+ae*Y;l.push(he,Ce,ut),l.push(Ce,Ie,ut),ee+=6}o.addGroup(_,ee,O),_+=ee,y+=X}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new Xh(e.width,e.height,e.depth,e.widthSegments,e.heightSegments,e.depthSegments)}}function _x(r){const e={};for(const t in r){e[t]={};for(const n in r[t]){const i=r[t][n];i&&(i.isColor||i.isMatrix3||i.isMatrix4||i.isVector2||i.isVector3||i.isVector4||i.isTexture||i.isQuaternion)?i.isRenderTargetTexture?(Ve("UniformsUtils: Textures of render targets cannot be cloned via cloneUniforms() or mergeUniforms()."),e[t][n]=null):e[t][n]=i.clone():Array.isArray(i)?e[t][n]=i.slice():e[t][n]=i}}return e}function qo(r){const e={};for(let t=0;t<r.length;t++){const n=_x(r[t]);for(const i in n)e[i]=n[i]}return e}function kZ(r){const e=[];for(let t=0;t<r.length;t++)e.push(r[t].clone());return e}function Zk(r){const e=r.getRenderTarget();return e===null?r.outputColorSpace:e.isXRRenderTarget===!0?e.texture.colorSpace:Nn.workingColorSpace}const Kk={clone:_x,merge:qo};var HZ=`void main() {
	gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
}`,WZ=`void main() {
	gl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );
}`;class ul extends Ta{constructor(e){super(),this.isShaderMaterial=!0,this.type="ShaderMaterial",this.defines={},this.uniforms={},this.uniformsGroups=[],this.vertexShader=HZ,this.fragmentShader=WZ,this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.clipping=!1,this.forceSinglePass=!0,this.extensions={clipCullDistance:!1,multiDraw:!1},this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv1:[0,0]},this.index0AttributeName=void 0,this.uniformsNeedUpdate=!1,this.glslVersion=null,e!==void 0&&this.setValues(e)}copy(e){return super.copy(e),this.fragmentShader=e.fragmentShader,this.vertexShader=e.vertexShader,this.uniforms=_x(e.uniforms),this.uniformsGroups=kZ(e.uniformsGroups),this.defines=Object.assign({},e.defines),this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.fog=e.fog,this.lights=e.lights,this.clipping=e.clipping,this.extensions=Object.assign({},e.extensions),this.glslVersion=e.glslVersion,this.defaultAttributeValues=Object.assign({},e.defaultAttributeValues),this.index0AttributeName=e.index0AttributeName,this.uniformsNeedUpdate=e.uniformsNeedUpdate,this}toJSON(e){const t=super.toJSON(e);t.glslVersion=this.glslVersion,t.uniforms={};for(const i in this.uniforms){const a=this.uniforms[i].value;a&&a.isTexture?t.uniforms[i]={type:"t",value:a.toJSON(e).uuid}:a&&a.isColor?t.uniforms[i]={type:"c",value:a.getHex()}:a&&a.isVector2?t.uniforms[i]={type:"v2",value:a.toArray()}:a&&a.isVector3?t.uniforms[i]={type:"v3",value:a.toArray()}:a&&a.isVector4?t.uniforms[i]={type:"v4",value:a.toArray()}:a&&a.isMatrix3?t.uniforms[i]={type:"m3",value:a.toArray()}:a&&a.isMatrix4?t.uniforms[i]={type:"m4",value:a.toArray()}:t.uniforms[i]={value:a}}Object.keys(this.defines).length>0&&(t.defines=this.defines),t.vertexShader=this.vertexShader,t.fragmentShader=this.fragmentShader,t.lights=this.lights,t.clipping=this.clipping;const n={};for(const i in this.extensions)this.extensions[i]===!0&&(n[i]=!0);return Object.keys(n).length>0&&(t.extensions=n),t}}class G1 extends Fi{constructor(){super(),this.isCamera=!0,this.type="Camera",this.matrixWorldInverse=new gn,this.projectionMatrix=new gn,this.projectionMatrixInverse=new gn,this.coordinateSystem=Ba,this._reversedDepth=!1}get reversedDepth(){return this._reversedDepth}copy(e,t){return super.copy(e,t),this.matrixWorldInverse.copy(e.matrixWorldInverse),this.projectionMatrix.copy(e.projectionMatrix),this.projectionMatrixInverse.copy(e.projectionMatrixInverse),this.coordinateSystem=e.coordinateSystem,this}getWorldDirection(e){return super.getWorldDirection(e).negate()}updateMatrixWorld(e){super.updateMatrixWorld(e),this.matrixWorldInverse.copy(this.matrixWorld).invert()}updateWorldMatrix(e,t){super.updateWorldMatrix(e,t),this.matrixWorldInverse.copy(this.matrixWorld).invert()}clone(){return new this.constructor().copy(this)}}const Gp=new ne,nz=new tt,iz=new tt;class Br extends G1{constructor(e=50,t=1,n=.1,i=2e3){super(),this.isPerspectiveCamera=!0,this.type="PerspectiveCamera",this.fov=e,this.zoom=1,this.near=n,this.far=i,this.focus=10,this.aspect=t,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()}copy(e,t){return super.copy(e,t),this.fov=e.fov,this.zoom=e.zoom,this.near=e.near,this.far=e.far,this.focus=e.focus,this.aspect=e.aspect,this.view=e.view===null?null:Object.assign({},e.view),this.filmGauge=e.filmGauge,this.filmOffset=e.filmOffset,this}setFocalLength(e){const t=.5*this.getFilmHeight()/e;this.fov=py*2*Math.atan(t),this.updateProjectionMatrix()}getFocalLength(){const e=Math.tan(w0*.5*this.fov);return .5*this.getFilmHeight()/e}getEffectiveFOV(){return py*2*Math.atan(Math.tan(w0*.5*this.fov)/this.zoom)}getFilmWidth(){return this.filmGauge*Math.min(this.aspect,1)}getFilmHeight(){return this.filmGauge/Math.max(this.aspect,1)}getViewBounds(e,t,n){Gp.set(-1,-1,.5).applyMatrix4(this.projectionMatrixInverse),t.set(Gp.x,Gp.y).multiplyScalar(-e/Gp.z),Gp.set(1,1,.5).applyMatrix4(this.projectionMatrixInverse),n.set(Gp.x,Gp.y).multiplyScalar(-e/Gp.z)}getViewSize(e,t){return this.getViewBounds(e,nz,iz),t.subVectors(iz,nz)}setViewOffset(e,t,n,i,s,a){this.aspect=e/t,this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=n,this.view.offsetY=i,this.view.width=s,this.view.height=a,this.updateProjectionMatrix()}clearViewOffset(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const e=this.near;let t=e*Math.tan(w0*.5*this.fov)/this.zoom,n=2*t,i=this.aspect*n,s=-.5*i;const a=this.view;if(this.view!==null&&this.view.enabled){const l=a.fullWidth,c=a.fullHeight;s+=a.offsetX*i/l,t-=a.offsetY*n/c,i*=a.width/l,n*=a.height/c}const o=this.filmOffset;o!==0&&(s+=e*o/this.getFilmWidth()),this.projectionMatrix.makePerspective(s,s+i,t,t-n,e,this.far,this.coordinateSystem,this.reversedDepth),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){const t=super.toJSON(e);return t.object.fov=this.fov,t.object.zoom=this.zoom,t.object.near=this.near,t.object.far=this.far,t.object.focus=this.focus,t.object.aspect=this.aspect,this.view!==null&&(t.object.view=Object.assign({},this.view)),t.object.filmGauge=this.filmGauge,t.object.filmOffset=this.filmOffset,t}}const ev=-90,tv=1;class uL extends Fi{constructor(e,t,n){super(),this.type="CubeCamera",this.renderTarget=n,this.coordinateSystem=null,this.activeMipmapLevel=0;const i=new Br(ev,tv,e,t);i.layers=this.layers,this.add(i);const s=new Br(ev,tv,e,t);s.layers=this.layers,this.add(s);const a=new Br(ev,tv,e,t);a.layers=this.layers,this.add(a);const o=new Br(ev,tv,e,t);o.layers=this.layers,this.add(o);const l=new Br(ev,tv,e,t);l.layers=this.layers,this.add(l);const c=new Br(ev,tv,e,t);c.layers=this.layers,this.add(c)}updateCoordinateSystem(){const e=this.coordinateSystem,t=this.children.concat(),[n,i,s,a,o,l]=t;for(const c of t)this.remove(c);if(e===Ba)n.up.set(0,1,0),n.lookAt(1,0,0),i.up.set(0,1,0),i.lookAt(-1,0,0),s.up.set(0,0,-1),s.lookAt(0,1,0),a.up.set(0,0,1),a.lookAt(0,-1,0),o.up.set(0,1,0),o.lookAt(0,0,1),l.up.set(0,1,0),l.lookAt(0,0,-1);else if(e===Il)n.up.set(0,-1,0),n.lookAt(-1,0,0),i.up.set(0,-1,0),i.lookAt(1,0,0),s.up.set(0,0,1),s.lookAt(0,1,0),a.up.set(0,0,-1),a.lookAt(0,-1,0),o.up.set(0,-1,0),o.lookAt(0,0,1),l.up.set(0,-1,0),l.lookAt(0,0,-1);else throw new Error("THREE.CubeCamera.updateCoordinateSystem(): Invalid coordinate system: "+e);for(const c of t)this.add(c),c.updateMatrixWorld()}update(e,t){this.parent===null&&this.updateMatrixWorld();const{renderTarget:n,activeMipmapLevel:i}=this;this.coordinateSystem!==e.coordinateSystem&&(this.coordinateSystem=e.coordinateSystem,this.updateCoordinateSystem());const[s,a,o,l,c,d]=this.children,p=e.getRenderTarget(),y=e.getActiveCubeFace(),_=e.getActiveMipmapLevel(),v=e.xr.enabled;e.xr.enabled=!1;const b=n.texture.generateMipmaps;n.texture.generateMipmaps=!1,e.setRenderTarget(n,0,i),e.render(t,s),e.setRenderTarget(n,1,i),e.render(t,a),e.setRenderTarget(n,2,i),e.render(t,o),e.setRenderTarget(n,3,i),e.render(t,l),e.setRenderTarget(n,4,i),e.render(t,c),n.texture.generateMipmaps=b,e.setRenderTarget(n,5,i),e.render(t,d),e.setRenderTarget(p,y,_),e.xr.enabled=v,n.texture.needsPMREMUpdate=!0}}class Im extends sr{constructor(e=[],t=ol,n,i,s,a,o,l,c,d){super(e,t,n,i,s,a,o,l,c,d),this.isCubeTexture=!0,this.flipY=!1}get images(){return this.image}set images(e){this.image=e}}class k1 extends sl{constructor(e=1,t={}){super(e,e,t),this.isWebGLCubeRenderTarget=!0;const n={width:e,height:e,depth:1},i=[n,n,n,n,n,n];this.texture=new Im(i),this._setTextureOptions(t),this.texture.isRenderTargetTexture=!0}fromEquirectangularTexture(e,t){this.texture.type=t.type,this.texture.colorSpace=t.colorSpace,this.texture.generateMipmaps=t.generateMipmaps,this.texture.minFilter=t.minFilter,this.texture.magFilter=t.magFilter;const n={uniforms:{tEquirect:{value:null}},vertexShader:`

				varying vec3 vWorldDirection;

				vec3 transformDirection( in vec3 dir, in mat4 matrix ) {

					return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );

				}

				void main() {

					vWorldDirection = transformDirection( position, modelMatrix );

					#include <begin_vertex>
					#include <project_vertex>

				}
			`,fragmentShader:`

				uniform sampler2D tEquirect;

				varying vec3 vWorldDirection;

				#include <common>

				void main() {

					vec3 direction = normalize( vWorldDirection );

					vec2 sampleUV = equirectUv( direction );

					gl_FragColor = texture2D( tEquirect, sampleUV );

				}
			`},i=new Xh(5,5,5),s=new ul({name:"CubemapFromEquirect",uniforms:_x(n.uniforms),vertexShader:n.vertexShader,fragmentShader:n.fragmentShader,side:gr,blending:yo});s.uniforms.tEquirect.value=t;const a=new ar(i,s),o=t.minFilter;return t.minFilter===Pa&&(t.minFilter=ei),new uL(1,10,this).update(e,a),t.minFilter=o,a.geometry.dispose(),a.material.dispose(),this}clear(e,t=!0,n=!0,i=!0){const s=e.getRenderTarget();for(let a=0;a<6;a++)e.setRenderTarget(this,a),e.clear(t,n,i);e.setRenderTarget(s)}}class Lv extends Fi{constructor(){super(),this.isGroup=!0,this.type="Group"}}const qZ={type:"move"};class wT{constructor(){this._targetRay=null,this._grip=null,this._hand=null}getHandSpace(){return this._hand===null&&(this._hand=new Lv,this._hand.matrixAutoUpdate=!1,this._hand.visible=!1,this._hand.joints={},this._hand.inputState={pinching:!1}),this._hand}getTargetRaySpace(){return this._targetRay===null&&(this._targetRay=new Lv,this._targetRay.matrixAutoUpdate=!1,this._targetRay.visible=!1,this._targetRay.hasLinearVelocity=!1,this._targetRay.linearVelocity=new ne,this._targetRay.hasAngularVelocity=!1,this._targetRay.angularVelocity=new ne),this._targetRay}getGripSpace(){return this._grip===null&&(this._grip=new Lv,this._grip.matrixAutoUpdate=!1,this._grip.visible=!1,this._grip.hasLinearVelocity=!1,this._grip.linearVelocity=new ne,this._grip.hasAngularVelocity=!1,this._grip.angularVelocity=new ne),this._grip}dispatchEvent(e){return this._targetRay!==null&&this._targetRay.dispatchEvent(e),this._grip!==null&&this._grip.dispatchEvent(e),this._hand!==null&&this._hand.dispatchEvent(e),this}connect(e){if(e&&e.hand){const t=this._hand;if(t)for(const n of e.hand.values())this._getHandJoint(t,n)}return this.dispatchEvent({type:"connected",data:e}),this}disconnect(e){return this.dispatchEvent({type:"disconnected",data:e}),this._targetRay!==null&&(this._targetRay.visible=!1),this._grip!==null&&(this._grip.visible=!1),this._hand!==null&&(this._hand.visible=!1),this}update(e,t,n){let i=null,s=null,a=null;const o=this._targetRay,l=this._grip,c=this._hand;if(e&&t.session.visibilityState!=="visible-blurred"){if(c&&e.hand){a=!0;for(const b of e.hand.values()){const E=t.getJointPose(b,n),T=this._getHandJoint(c,b);E!==null&&(T.matrix.fromArray(E.transform.matrix),T.matrix.decompose(T.position,T.rotation,T.scale),T.matrixWorldNeedsUpdate=!0,T.jointRadius=E.radius),T.visible=E!==null}const d=c.joints["index-finger-tip"],p=c.joints["thumb-tip"],y=d.position.distanceTo(p.position),_=.02,v=.005;c.inputState.pinching&&y>_+v?(c.inputState.pinching=!1,this.dispatchEvent({type:"pinchend",handedness:e.handedness,target:this})):!c.inputState.pinching&&y<=_-v&&(c.inputState.pinching=!0,this.dispatchEvent({type:"pinchstart",handedness:e.handedness,target:this}))}else l!==null&&e.gripSpace&&(s=t.getPose(e.gripSpace,n),s!==null&&(l.matrix.fromArray(s.transform.matrix),l.matrix.decompose(l.position,l.rotation,l.scale),l.matrixWorldNeedsUpdate=!0,s.linearVelocity?(l.hasLinearVelocity=!0,l.linearVelocity.copy(s.linearVelocity)):l.hasLinearVelocity=!1,s.angularVelocity?(l.hasAngularVelocity=!0,l.angularVelocity.copy(s.angularVelocity)):l.hasAngularVelocity=!1));o!==null&&(i=t.getPose(e.targetRaySpace,n),i===null&&s!==null&&(i=s),i!==null&&(o.matrix.fromArray(i.transform.matrix),o.matrix.decompose(o.position,o.rotation,o.scale),o.matrixWorldNeedsUpdate=!0,i.linearVelocity?(o.hasLinearVelocity=!0,o.linearVelocity.copy(i.linearVelocity)):o.hasLinearVelocity=!1,i.angularVelocity?(o.hasAngularVelocity=!0,o.angularVelocity.copy(i.angularVelocity)):o.hasAngularVelocity=!1,this.dispatchEvent(qZ)))}return o!==null&&(o.visible=i!==null),l!==null&&(l.visible=s!==null),c!==null&&(c.visible=a!==null),this}_getHandJoint(e,t){if(e.joints[t.jointName]===void 0){const n=new Lv;n.matrixAutoUpdate=!1,n.visible=!1,e.joints[t.jointName]=n,e.add(n)}return e.joints[t.jointName]}}class MC{constructor(e,t=25e-5){this.isFogExp2=!0,this.name="",this.color=new Kt(e),this.density=t}clone(){return new MC(this.color,this.density)}toJSON(){return{type:"FogExp2",name:this.name,color:this.color.getHex(),density:this.density}}}class AC{constructor(e,t=1,n=1e3){this.isFog=!0,this.name="",this.color=new Kt(e),this.near=t,this.far=n}clone(){return new AC(this.color,this.near,this.far)}toJSON(){return{type:"Fog",name:this.name,color:this.color.getHex(),near:this.near,far:this.far}}}let Fm=class extends Fi{constructor(){super(),this.isScene=!0,this.type="Scene",this.background=null,this.environment=null,this.fog=null,this.backgroundBlurriness=0,this.backgroundIntensity=1,this.backgroundRotation=new ll,this.environmentIntensity=1,this.environmentRotation=new ll,this.overrideMaterial=null,typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}copy(e,t){return super.copy(e,t),e.background!==null&&(this.background=e.background.clone()),e.environment!==null&&(this.environment=e.environment.clone()),e.fog!==null&&(this.fog=e.fog.clone()),this.backgroundBlurriness=e.backgroundBlurriness,this.backgroundIntensity=e.backgroundIntensity,this.backgroundRotation.copy(e.backgroundRotation),this.environmentIntensity=e.environmentIntensity,this.environmentRotation.copy(e.environmentRotation),e.overrideMaterial!==null&&(this.overrideMaterial=e.overrideMaterial.clone()),this.matrixAutoUpdate=e.matrixAutoUpdate,this}toJSON(e){const t=super.toJSON(e);return this.fog!==null&&(t.object.fog=this.fog.toJSON()),this.backgroundBlurriness>0&&(t.object.backgroundBlurriness=this.backgroundBlurriness),this.backgroundIntensity!==1&&(t.object.backgroundIntensity=this.backgroundIntensity),t.object.backgroundRotation=this.backgroundRotation.toArray(),this.environmentIntensity!==1&&(t.object.environmentIntensity=this.environmentIntensity),t.object.environmentRotation=this.environmentRotation.toArray(),t}};class H1{constructor(e,t){this.isInterleavedBuffer=!0,this.array=e,this.stride=t,this.count=e!==void 0?e.length/t:0,this.usage=xm,this.updateRanges=[],this.version=0,this.uuid=pu()}onUploadCallback(){}set needsUpdate(e){e===!0&&this.version++}setUsage(e){return this.usage=e,this}addUpdateRange(e,t){this.updateRanges.push({start:e,count:t})}clearUpdateRanges(){this.updateRanges.length=0}copy(e){return this.array=new e.array.constructor(e.array),this.count=e.count,this.stride=e.stride,this.usage=e.usage,this}copyAt(e,t,n){e*=this.stride,n*=t.stride;for(let i=0,s=this.stride;i<s;i++)this.array[e+i]=t.array[n+i];return this}set(e,t=0){return this.array.set(e,t),this}clone(e){e.arrayBuffers===void 0&&(e.arrayBuffers={}),this.array.buffer._uuid===void 0&&(this.array.buffer._uuid=pu()),e.arrayBuffers[this.array.buffer._uuid]===void 0&&(e.arrayBuffers[this.array.buffer._uuid]=this.array.slice(0).buffer);const t=new this.array.constructor(e.arrayBuffers[this.array.buffer._uuid]),n=new this.constructor(t,this.stride);return n.setUsage(this.usage),n}onUpload(e){return this.onUploadCallback=e,this}toJSON(e){return e.arrayBuffers===void 0&&(e.arrayBuffers={}),this.array.buffer._uuid===void 0&&(this.array.buffer._uuid=pu()),e.arrayBuffers[this.array.buffer._uuid]===void 0&&(e.arrayBuffers[this.array.buffer._uuid]=Array.from(new Uint32Array(this.array.buffer))),{uuid:this.uuid,buffer:this.array.buffer._uuid,type:this.array.constructor.name,stride:this.stride}}}const Go=new ne;class Sm{constructor(e,t,n,i=!1){this.isInterleavedBufferAttribute=!0,this.name="",this.data=e,this.itemSize=t,this.offset=n,this.normalized=i}get count(){return this.data.count}get array(){return this.data.array}set needsUpdate(e){this.data.needsUpdate=e}applyMatrix4(e){for(let t=0,n=this.data.count;t<n;t++)Go.fromBufferAttribute(this,t),Go.applyMatrix4(e),this.setXYZ(t,Go.x,Go.y,Go.z);return this}applyNormalMatrix(e){for(let t=0,n=this.count;t<n;t++)Go.fromBufferAttribute(this,t),Go.applyNormalMatrix(e),this.setXYZ(t,Go.x,Go.y,Go.z);return this}transformDirection(e){for(let t=0,n=this.count;t<n;t++)Go.fromBufferAttribute(this,t),Go.transformDirection(e),this.setXYZ(t,Go.x,Go.y,Go.z);return this}getComponent(e,t){let n=this.array[e*this.data.stride+this.offset+t];return this.normalized&&(n=el(n,this.array)),n}setComponent(e,t,n){return this.normalized&&(n=ai(n,this.array)),this.data.array[e*this.data.stride+this.offset+t]=n,this}setX(e,t){return this.normalized&&(t=ai(t,this.array)),this.data.array[e*this.data.stride+this.offset]=t,this}setY(e,t){return this.normalized&&(t=ai(t,this.array)),this.data.array[e*this.data.stride+this.offset+1]=t,this}setZ(e,t){return this.normalized&&(t=ai(t,this.array)),this.data.array[e*this.data.stride+this.offset+2]=t,this}setW(e,t){return this.normalized&&(t=ai(t,this.array)),this.data.array[e*this.data.stride+this.offset+3]=t,this}getX(e){let t=this.data.array[e*this.data.stride+this.offset];return this.normalized&&(t=el(t,this.array)),t}getY(e){let t=this.data.array[e*this.data.stride+this.offset+1];return this.normalized&&(t=el(t,this.array)),t}getZ(e){let t=this.data.array[e*this.data.stride+this.offset+2];return this.normalized&&(t=el(t,this.array)),t}getW(e){let t=this.data.array[e*this.data.stride+this.offset+3];return this.normalized&&(t=el(t,this.array)),t}setXY(e,t,n){return e=e*this.data.stride+this.offset,this.normalized&&(t=ai(t,this.array),n=ai(n,this.array)),this.data.array[e+0]=t,this.data.array[e+1]=n,this}setXYZ(e,t,n,i){return e=e*this.data.stride+this.offset,this.normalized&&(t=ai(t,this.array),n=ai(n,this.array),i=ai(i,this.array)),this.data.array[e+0]=t,this.data.array[e+1]=n,this.data.array[e+2]=i,this}setXYZW(e,t,n,i,s){return e=e*this.data.stride+this.offset,this.normalized&&(t=ai(t,this.array),n=ai(n,this.array),i=ai(i,this.array),s=ai(s,this.array)),this.data.array[e+0]=t,this.data.array[e+1]=n,this.data.array[e+2]=i,this.data.array[e+3]=s,this}clone(e){if(e===void 0){gx("InterleavedBufferAttribute.clone(): Cloning an interleaved buffer attribute will de-interleave buffer data.");const t=[];for(let n=0;n<this.count;n++){const i=n*this.data.stride+this.offset;for(let s=0;s<this.itemSize;s++)t.push(this.data.array[i+s])}return new Ji(new this.array.constructor(t),this.itemSize,this.normalized)}else return e.interleavedBuffers===void 0&&(e.interleavedBuffers={}),e.interleavedBuffers[this.data.uuid]===void 0&&(e.interleavedBuffers[this.data.uuid]=this.data.clone(e)),new Sm(e.interleavedBuffers[this.data.uuid],this.itemSize,this.offset,this.normalized)}toJSON(e){if(e===void 0){gx("InterleavedBufferAttribute.toJSON(): Serializing an interleaved buffer attribute will de-interleave buffer data.");const t=[];for(let n=0;n<this.count;n++){const i=n*this.data.stride+this.offset;for(let s=0;s<this.itemSize;s++)t.push(this.data.array[i+s])}return{itemSize:this.itemSize,type:this.array.constructor.name,array:t,normalized:this.normalized}}else return e.interleavedBuffers===void 0&&(e.interleavedBuffers={}),e.interleavedBuffers[this.data.uuid]===void 0&&(e.interleavedBuffers[this.data.uuid]=this.data.toJSON(e)),{isInterleavedBufferAttribute:!0,itemSize:this.itemSize,data:this.data.uuid,offset:this.offset,normalized:this.normalized}}}class wC extends Ta{constructor(e){super(),this.isSpriteMaterial=!0,this.type="SpriteMaterial",this.color=new Kt(16777215),this.map=null,this.alphaMap=null,this.rotation=0,this.sizeAttenuation=!0,this.transparent=!0,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.alphaMap=e.alphaMap,this.rotation=e.rotation,this.sizeAttenuation=e.sizeAttenuation,this.fog=e.fog,this}}let nv;const OS=new ne,iv=new ne,rv=new ne,sv=new tt,US=new tt,Qk=new gn,tA=new ne,LS=new ne,nA=new ne,rz=new tt,J2=new tt,sz=new tt;class Jk extends Fi{constructor(e=new wC){if(super(),this.isSprite=!0,this.type="Sprite",nv===void 0){nv=new Qn;const t=new Float32Array([-.5,-.5,0,0,0,.5,-.5,0,1,0,.5,.5,0,1,1,-.5,.5,0,0,1]),n=new H1(t,5);nv.setIndex([0,1,2,0,2,3]),nv.setAttribute("position",new Sm(n,3,0,!1)),nv.setAttribute("uv",new Sm(n,2,3,!1))}this.geometry=nv,this.material=e,this.center=new tt(.5,.5),this.count=1}raycast(e,t){e.camera===null&&Ze('Sprite: "Raycaster.camera" needs to be set in order to raycast against sprites.'),iv.setFromMatrixScale(this.matrixWorld),Qk.copy(e.camera.matrixWorld),this.modelViewMatrix.multiplyMatrices(e.camera.matrixWorldInverse,this.matrixWorld),rv.setFromMatrixPosition(this.modelViewMatrix),e.camera.isPerspectiveCamera&&this.material.sizeAttenuation===!1&&iv.multiplyScalar(-rv.z);const n=this.material.rotation;let i,s;n!==0&&(s=Math.cos(n),i=Math.sin(n));const a=this.center;iA(tA.set(-.5,-.5,0),rv,a,iv,i,s),iA(LS.set(.5,-.5,0),rv,a,iv,i,s),iA(nA.set(.5,.5,0),rv,a,iv,i,s),rz.set(0,0),J2.set(1,0),sz.set(1,1);let o=e.ray.intersectTriangle(tA,LS,nA,!1,OS);if(o===null&&(iA(LS.set(-.5,.5,0),rv,a,iv,i,s),J2.set(0,1),o=e.ray.intersectTriangle(tA,nA,LS,!1,OS),o===null))return;const l=e.ray.origin.distanceTo(OS);l<e.near||l>e.far||t.push({distance:l,point:OS.clone(),uv:El.getInterpolation(OS,tA,LS,nA,rz,J2,sz,new tt),face:null,object:this})}copy(e,t){return super.copy(e,t),e.center!==void 0&&this.center.copy(e.center),this.material=e.material,this}}function iA(r,e,t,n,i,s){sv.subVectors(r,t).addScalar(.5).multiply(n),i!==void 0?(US.x=s*sv.x-i*sv.y,US.y=i*sv.x+s*sv.y):US.copy(sv),r.copy(e),r.x+=US.x,r.y+=US.y,r.applyMatrix4(Qk)}const rA=new ne,az=new ne;class e6 extends Fi{constructor(){super(),this.isLOD=!0,this._currentLevel=0,this.type="LOD",Object.defineProperties(this,{levels:{enumerable:!0,value:[]}}),this.autoUpdate=!0}copy(e){super.copy(e,!1);const t=e.levels;for(let n=0,i=t.length;n<i;n++){const s=t[n];this.addLevel(s.object.clone(),s.distance,s.hysteresis)}return this.autoUpdate=e.autoUpdate,this}addLevel(e,t=0,n=0){t=Math.abs(t);const i=this.levels;let s;for(s=0;s<i.length&&!(t<i[s].distance);s++);return i.splice(s,0,{distance:t,hysteresis:n,object:e}),this.add(e),this}removeLevel(e){const t=this.levels;for(let n=0;n<t.length;n++)if(t[n].distance===e){const i=t.splice(n,1);return this.remove(i[0].object),!0}return!1}getCurrentLevel(){return this._currentLevel}getObjectForDistance(e){const t=this.levels;if(t.length>0){let n,i;for(n=1,i=t.length;n<i;n++){let s=t[n].distance;if(t[n].object.visible&&(s-=s*t[n].hysteresis),e<s)break}return t[n-1].object}return null}raycast(e,t){if(this.levels.length>0){rA.setFromMatrixPosition(this.matrixWorld);const i=e.ray.origin.distanceTo(rA);this.getObjectForDistance(i).raycast(e,t)}}update(e){const t=this.levels;if(t.length>1){rA.setFromMatrixPosition(e.matrixWorld),az.setFromMatrixPosition(this.matrixWorld);const n=rA.distanceTo(az)/e.zoom;t[0].object.visible=!0;let i,s;for(i=1,s=t.length;i<s;i++){let a=t[i].distance;if(t[i].object.visible&&(a-=a*t[i].hysteresis),n>=a)t[i-1].object.visible=!1,t[i].object.visible=!0;else break}for(this._currentLevel=i-1;i<s;i++)t[i].object.visible=!1}}toJSON(e){const t=super.toJSON(e);this.autoUpdate===!1&&(t.object.autoUpdate=!1),t.object.levels=[];const n=this.levels;for(let i=0,s=n.length;i<s;i++){const a=n[i];t.object.levels.push({object:a.object.uuid,distance:a.distance,hysteresis:a.hysteresis})}return t}}const oz=new ne,lz=new zn,uz=new zn,XZ=new ne,cz=new gn,sA=new ne,e3=new Sa,fz=new gn,t3=new wy;class t6 extends ar{constructor(e,t){super(e,t),this.isSkinnedMesh=!0,this.type="SkinnedMesh",this.bindMode=lO,this.bindMatrix=new gn,this.bindMatrixInverse=new gn,this.boundingBox=null,this.boundingSphere=null}computeBoundingBox(){const e=this.geometry;this.boundingBox===null&&(this.boundingBox=new _o),this.boundingBox.makeEmpty();const t=e.getAttribute("position");for(let n=0;n<t.count;n++)this.getVertexPosition(n,sA),this.boundingBox.expandByPoint(sA)}computeBoundingSphere(){const e=this.geometry;this.boundingSphere===null&&(this.boundingSphere=new Sa),this.boundingSphere.makeEmpty();const t=e.getAttribute("position");for(let n=0;n<t.count;n++)this.getVertexPosition(n,sA),this.boundingSphere.expandByPoint(sA)}copy(e,t){return super.copy(e,t),this.bindMode=e.bindMode,this.bindMatrix.copy(e.bindMatrix),this.bindMatrixInverse.copy(e.bindMatrixInverse),this.skeleton=e.skeleton,e.boundingBox!==null&&(this.boundingBox=e.boundingBox.clone()),e.boundingSphere!==null&&(this.boundingSphere=e.boundingSphere.clone()),this}raycast(e,t){const n=this.material,i=this.matrixWorld;n!==void 0&&(this.boundingSphere===null&&this.computeBoundingSphere(),e3.copy(this.boundingSphere),e3.applyMatrix4(i),e.ray.intersectsSphere(e3)!==!1&&(fz.copy(i).invert(),t3.copy(e.ray).applyMatrix4(fz),!(this.boundingBox!==null&&t3.intersectsBox(this.boundingBox)===!1)&&this._computeIntersections(e,t,t3)))}getVertexPosition(e,t){return super.getVertexPosition(e,t),this.applyBoneTransform(e,t),t}bind(e,t){this.skeleton=e,t===void 0&&(this.updateMatrixWorld(!0),this.skeleton.calculateInverses(),t=this.matrixWorld),this.bindMatrix.copy(t),this.bindMatrixInverse.copy(t).invert()}pose(){this.skeleton.pose()}normalizeSkinWeights(){const e=new zn,t=this.geometry.attributes.skinWeight;for(let n=0,i=t.count;n<i;n++){e.fromBufferAttribute(t,n);const s=1/e.manhattanLength();s!==1/0?e.multiplyScalar(s):e.set(1,0,0,0),t.setXYZW(n,e.x,e.y,e.z,e.w)}}updateMatrixWorld(e){super.updateMatrixWorld(e),this.bindMode===lO?this.bindMatrixInverse.copy(this.matrixWorld).invert():this.bindMode===wk?this.bindMatrixInverse.copy(this.bindMatrix).invert():Ve("SkinnedMesh: Unrecognized bindMode: "+this.bindMode)}applyBoneTransform(e,t){const n=this.skeleton,i=this.geometry;lz.fromBufferAttribute(i.attributes.skinIndex,e),uz.fromBufferAttribute(i.attributes.skinWeight,e),oz.copy(t).applyMatrix4(this.bindMatrix),t.set(0,0,0);for(let s=0;s<4;s++){const a=uz.getComponent(s);if(a!==0){const o=lz.getComponent(s);cz.multiplyMatrices(n.bones[o].matrixWorld,n.boneInverses[o]),t.addScaledVector(XZ.copy(oz).applyMatrix4(cz),a)}}return t.applyMatrix4(this.bindMatrixInverse)}}class cL extends Fi{constructor(){super(),this.isBone=!0,this.type="Bone"}}class Ol extends sr{constructor(e=null,t=1,n=1,i,s,a,o,l,c=Ki,d=Ki,p,y){super(null,a,o,l,c,d,i,s,p,y),this.isDataTexture=!0,this.image={data:e,width:t,height:n},this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}const dz=new gn,$Z=new gn;class RC{constructor(e=[],t=[]){this.uuid=pu(),this.bones=e.slice(0),this.boneInverses=t,this.boneMatrices=null,this.previousBoneMatrices=null,this.boneTexture=null,this.init()}init(){const e=this.bones,t=this.boneInverses;if(this.boneMatrices=new Float32Array(e.length*16),t.length===0)this.calculateInverses();else if(e.length!==t.length){Ve("Skeleton: Number of inverse bone matrices does not match amount of bones."),this.boneInverses=[];for(let n=0,i=this.bones.length;n<i;n++)this.boneInverses.push(new gn)}}calculateInverses(){this.boneInverses.length=0;for(let e=0,t=this.bones.length;e<t;e++){const n=new gn;this.bones[e]&&n.copy(this.bones[e].matrixWorld).invert(),this.boneInverses.push(n)}}pose(){for(let e=0,t=this.bones.length;e<t;e++){const n=this.bones[e];n&&n.matrixWorld.copy(this.boneInverses[e]).invert()}for(let e=0,t=this.bones.length;e<t;e++){const n=this.bones[e];n&&(n.parent&&n.parent.isBone?(n.matrix.copy(n.parent.matrixWorld).invert(),n.matrix.multiply(n.matrixWorld)):n.matrix.copy(n.matrixWorld),n.matrix.decompose(n.position,n.quaternion,n.scale))}}update(){const e=this.bones,t=this.boneInverses,n=this.boneMatrices,i=this.boneTexture;for(let s=0,a=e.length;s<a;s++){const o=e[s]?e[s].matrixWorld:$Z;dz.multiplyMatrices(o,t[s]),dz.toArray(n,s*16)}i!==null&&(i.needsUpdate=!0)}clone(){return new RC(this.bones,this.boneInverses)}computeBoneTexture(){let e=Math.sqrt(this.bones.length*4);e=Math.ceil(e/4)*4,e=Math.max(e,4);const t=new Float32Array(e*e*4);t.set(this.boneMatrices);const n=new Ol(t,e,e,Qi,Ci);return n.needsUpdate=!0,this.boneMatrices=t,this.boneTexture=n,this}getBoneByName(e){for(let t=0,n=this.bones.length;t<n;t++){const i=this.bones[t];if(i.name===e)return i}}dispose(){this.boneTexture!==null&&(this.boneTexture.dispose(),this.boneTexture=null)}fromJSON(e,t){this.uuid=e.uuid;for(let n=0,i=e.bones.length;n<i;n++){const s=e.bones[n];let a=t[s];a===void 0&&(Ve("Skeleton: No bone found with UUID:",s),a=new cL),this.bones.push(a),this.boneInverses.push(new gn().fromArray(e.boneInverses[n]))}return this.init(),this}toJSON(){const e={metadata:{version:4.7,type:"Skeleton",generator:"Skeleton.toJSON"},bones:[],boneInverses:[]};e.uuid=this.uuid;const t=this.bones,n=this.boneInverses;for(let i=0,s=t.length;i<s;i++){const a=t[i];e.bones.push(a.uuid);const o=n[i];e.boneInverses.push(o.toArray())}return e}}class ic extends Ji{constructor(e,t,n,i=1){super(e,t,n),this.isInstancedBufferAttribute=!0,this.meshPerAttribute=i}copy(e){return super.copy(e),this.meshPerAttribute=e.meshPerAttribute,this}toJSON(){const e=super.toJSON();return e.meshPerAttribute=this.meshPerAttribute,e.isInstancedBufferAttribute=!0,e}}const av=new gn,hz=new gn,aA=[],pz=new _o,jZ=new gn,PS=new ar,BS=new Sa;class n6 extends ar{constructor(e,t,n){super(e,t),this.isInstancedMesh=!0,this.instanceMatrix=new ic(new Float32Array(n*16),16),this.instanceColor=null,this.morphTexture=null,this.count=n,this.boundingBox=null,this.boundingSphere=null;for(let i=0;i<n;i++)this.setMatrixAt(i,jZ)}computeBoundingBox(){const e=this.geometry,t=this.count;this.boundingBox===null&&(this.boundingBox=new _o),e.boundingBox===null&&e.computeBoundingBox(),this.boundingBox.makeEmpty();for(let n=0;n<t;n++)this.getMatrixAt(n,av),pz.copy(e.boundingBox).applyMatrix4(av),this.boundingBox.union(pz)}computeBoundingSphere(){const e=this.geometry,t=this.count;this.boundingSphere===null&&(this.boundingSphere=new Sa),e.boundingSphere===null&&e.computeBoundingSphere(),this.boundingSphere.makeEmpty();for(let n=0;n<t;n++)this.getMatrixAt(n,av),BS.copy(e.boundingSphere).applyMatrix4(av),this.boundingSphere.union(BS)}copy(e,t){return super.copy(e,t),this.instanceMatrix.copy(e.instanceMatrix),e.morphTexture!==null&&(this.morphTexture=e.morphTexture.clone()),e.instanceColor!==null&&(this.instanceColor=e.instanceColor.clone()),this.count=e.count,e.boundingBox!==null&&(this.boundingBox=e.boundingBox.clone()),e.boundingSphere!==null&&(this.boundingSphere=e.boundingSphere.clone()),this}getColorAt(e,t){t.fromArray(this.instanceColor.array,e*3)}getMatrixAt(e,t){t.fromArray(this.instanceMatrix.array,e*16)}getMorphAt(e,t){const n=t.morphTargetInfluences,i=this.morphTexture.source.data.data,s=n.length+1,a=e*s+1;for(let o=0;o<n.length;o++)n[o]=i[a+o]}raycast(e,t){const n=this.matrixWorld,i=this.count;if(PS.geometry=this.geometry,PS.material=this.material,PS.material!==void 0&&(this.boundingSphere===null&&this.computeBoundingSphere(),BS.copy(this.boundingSphere),BS.applyMatrix4(n),e.ray.intersectsSphere(BS)!==!1))for(let s=0;s<i;s++){this.getMatrixAt(s,av),hz.multiplyMatrices(n,av),PS.matrixWorld=hz,PS.raycast(e,aA);for(let a=0,o=aA.length;a<o;a++){const l=aA[a];l.instanceId=s,l.object=this,t.push(l)}aA.length=0}}setColorAt(e,t){this.instanceColor===null&&(this.instanceColor=new ic(new Float32Array(this.instanceMatrix.count*3).fill(1),3)),t.toArray(this.instanceColor.array,e*3)}setMatrixAt(e,t){t.toArray(this.instanceMatrix.array,e*16)}setMorphAt(e,t){const n=t.morphTargetInfluences,i=n.length+1;this.morphTexture===null&&(this.morphTexture=new Ol(new Float32Array(i*this.count),i,this.count,Pm,Ci));const s=this.morphTexture.source.data.data;let a=0;for(let c=0;c<n.length;c++)a+=n[c];const o=this.geometry.morphTargetsRelative?1:1-a,l=i*e;s[l]=o,s.set(n,l+1)}updateMorphTargets(){}dispose(){this.dispatchEvent({type:"dispose"}),this.morphTexture!==null&&(this.morphTexture.dispose(),this.morphTexture=null)}}const n3=new ne,YZ=new ne,ZZ=new Zn;class Hc{constructor(e=new ne(1,0,0),t=0){this.isPlane=!0,this.normal=e,this.constant=t}set(e,t){return this.normal.copy(e),this.constant=t,this}setComponents(e,t,n,i){return this.normal.set(e,t,n),this.constant=i,this}setFromNormalAndCoplanarPoint(e,t){return this.normal.copy(e),this.constant=-t.dot(this.normal),this}setFromCoplanarPoints(e,t,n){const i=n3.subVectors(n,t).cross(YZ.subVectors(e,t)).normalize();return this.setFromNormalAndCoplanarPoint(i,e),this}copy(e){return this.normal.copy(e.normal),this.constant=e.constant,this}normalize(){const e=1/this.normal.length();return this.normal.multiplyScalar(e),this.constant*=e,this}negate(){return this.constant*=-1,this.normal.negate(),this}distanceToPoint(e){return this.normal.dot(e)+this.constant}distanceToSphere(e){return this.distanceToPoint(e.center)-e.radius}projectPoint(e,t){return t.copy(e).addScaledVector(this.normal,-this.distanceToPoint(e))}intersectLine(e,t){const n=e.delta(n3),i=this.normal.dot(n);if(i===0)return this.distanceToPoint(e.start)===0?t.copy(e.start):null;const s=-(e.start.dot(this.normal)+this.constant)/i;return s<0||s>1?null:t.copy(e.start).addScaledVector(n,s)}intersectsLine(e){const t=this.distanceToPoint(e.start),n=this.distanceToPoint(e.end);return t<0&&n>0||n<0&&t>0}intersectsBox(e){return e.intersectsPlane(this)}intersectsSphere(e){return e.intersectsPlane(this)}coplanarPoint(e){return e.copy(this.normal).multiplyScalar(-this.constant)}applyMatrix4(e,t){const n=t||ZZ.getNormalMatrix(e),i=this.coplanarPoint(n3).applyMatrix4(e),s=this.normal.applyMatrix3(n).normalize();return this.constant=-i.dot(s),this}translate(e){return this.constant-=e.dot(this.normal),this}equals(e){return e.normal.equals(this.normal)&&e.constant===this.constant}clone(){return new this.constructor().copy(this)}}const zg=new Sa,KZ=new tt(.5,.5),oA=new ne;class Ry{constructor(e=new Hc,t=new Hc,n=new Hc,i=new Hc,s=new Hc,a=new Hc){this.planes=[e,t,n,i,s,a]}set(e,t,n,i,s,a){const o=this.planes;return o[0].copy(e),o[1].copy(t),o[2].copy(n),o[3].copy(i),o[4].copy(s),o[5].copy(a),this}copy(e){const t=this.planes;for(let n=0;n<6;n++)t[n].copy(e.planes[n]);return this}setFromProjectionMatrix(e,t=Ba,n=!1){const i=this.planes,s=e.elements,a=s[0],o=s[1],l=s[2],c=s[3],d=s[4],p=s[5],y=s[6],_=s[7],v=s[8],b=s[9],E=s[10],T=s[11],M=s[12],R=s[13],N=s[14],P=s[15];if(i[0].setComponents(c-a,_-d,T-v,P-M).normalize(),i[1].setComponents(c+a,_+d,T+v,P+M).normalize(),i[2].setComponents(c+o,_+p,T+b,P+R).normalize(),i[3].setComponents(c-o,_-p,T-b,P-R).normalize(),n)i[4].setComponents(l,y,E,N).normalize(),i[5].setComponents(c-l,_-y,T-E,P-N).normalize();else if(i[4].setComponents(c-l,_-y,T-E,P-N).normalize(),t===Ba)i[5].setComponents(c+l,_+y,T+E,P+N).normalize();else if(t===Il)i[5].setComponents(l,y,E,N).normalize();else throw new Error("THREE.Frustum.setFromProjectionMatrix(): Invalid coordinate system: "+t);return this}intersectsObject(e){if(e.boundingSphere!==void 0)e.boundingSphere===null&&e.computeBoundingSphere(),zg.copy(e.boundingSphere).applyMatrix4(e.matrixWorld);else{const t=e.geometry;t.boundingSphere===null&&t.computeBoundingSphere(),zg.copy(t.boundingSphere).applyMatrix4(e.matrixWorld)}return this.intersectsSphere(zg)}intersectsSprite(e){zg.center.set(0,0,0);const t=KZ.distanceTo(e.center);return zg.radius=.7071067811865476+t,zg.applyMatrix4(e.matrixWorld),this.intersectsSphere(zg)}intersectsSphere(e){const t=this.planes,n=e.center,i=-e.radius;for(let s=0;s<6;s++)if(t[s].distanceToPoint(n)<i)return!1;return!0}intersectsBox(e){const t=this.planes;for(let n=0;n<6;n++){const i=t[n];if(oA.x=i.normal.x>0?e.max.x:e.min.x,oA.y=i.normal.y>0?e.max.y:e.min.y,oA.z=i.normal.z>0?e.max.z:e.min.z,i.distanceToPoint(oA)<0)return!1}return!0}containsPoint(e){const t=this.planes;for(let n=0;n<6;n++)if(t[n].distanceToPoint(e)<0)return!1;return!0}clone(){return new this.constructor().copy(this)}}const Vf=new gn,Gf=new Ry;class W1{constructor(){this.coordinateSystem=Ba}intersectsObject(e,t){if(!t.isArrayCamera||t.cameras.length===0)return!1;for(let n=0;n<t.cameras.length;n++){const i=t.cameras[n];if(Vf.multiplyMatrices(i.projectionMatrix,i.matrixWorldInverse),Gf.setFromProjectionMatrix(Vf,i.coordinateSystem,i.reversedDepth),Gf.intersectsObject(e))return!0}return!1}intersectsSprite(e,t){if(!t||!t.cameras||t.cameras.length===0)return!1;for(let n=0;n<t.cameras.length;n++){const i=t.cameras[n];if(Vf.multiplyMatrices(i.projectionMatrix,i.matrixWorldInverse),Gf.setFromProjectionMatrix(Vf,i.coordinateSystem,i.reversedDepth),Gf.intersectsSprite(e))return!0}return!1}intersectsSphere(e,t){if(!t||!t.cameras||t.cameras.length===0)return!1;for(let n=0;n<t.cameras.length;n++){const i=t.cameras[n];if(Vf.multiplyMatrices(i.projectionMatrix,i.matrixWorldInverse),Gf.setFromProjectionMatrix(Vf,i.coordinateSystem,i.reversedDepth),Gf.intersectsSphere(e))return!0}return!1}intersectsBox(e,t){if(!t||!t.cameras||t.cameras.length===0)return!1;for(let n=0;n<t.cameras.length;n++){const i=t.cameras[n];if(Vf.multiplyMatrices(i.projectionMatrix,i.matrixWorldInverse),Gf.setFromProjectionMatrix(Vf,i.coordinateSystem,i.reversedDepth),Gf.intersectsBox(e))return!0}return!1}containsPoint(e,t){if(!t||!t.cameras||t.cameras.length===0)return!1;for(let n=0;n<t.cameras.length;n++){const i=t.cameras[n];if(Vf.multiplyMatrices(i.projectionMatrix,i.matrixWorldInverse),Gf.setFromProjectionMatrix(Vf,i.coordinateSystem,i.reversedDepth),Gf.containsPoint(e))return!0}return!1}clone(){return new W1}}function i3(r,e){return r-e}function QZ(r,e){return r.z-e.z}function JZ(r,e){return e.z-r.z}class eK{constructor(){this.index=0,this.pool=[],this.list=[]}push(e,t,n,i){const s=this.pool,a=this.list;this.index>=s.length&&s.push({start:-1,count:-1,z:-1,index:-1});const o=s[this.index];a.push(o),this.index++,o.start=e,o.count=t,o.z=n,o.index=i}reset(){this.list.length=0,this.index=0}}const vl=new gn,tK=new Kt(1,1,1),mz=new Ry,nK=new W1,lA=new _o,Vg=new Sa,IS=new ne,gz=new ne,iK=new ne,r3=new eK,so=new ar,uA=[];function rK(r,e,t=0){const n=e.itemSize;if(r.isInterleavedBufferAttribute||r.array.constructor!==e.array.constructor){const i=r.count;for(let s=0;s<i;s++)for(let a=0;a<n;a++)e.setComponent(s+t,a,r.getComponent(s,a))}else e.array.set(r.array,t*n);e.needsUpdate=!0}function Gg(r,e){if(r.constructor!==e.constructor){const t=Math.min(r.length,e.length);for(let n=0;n<t;n++)e[n]=r[n]}else{const t=Math.min(r.length,e.length);e.set(new r.constructor(r.buffer,0,t))}}class i6 extends ar{constructor(e,t,n=t*2,i){super(new Qn,i),this.isBatchedMesh=!0,this.perObjectFrustumCulled=!0,this.sortObjects=!0,this.boundingBox=null,this.boundingSphere=null,this.customSort=null,this._instanceInfo=[],this._geometryInfo=[],this._availableInstanceIds=[],this._availableGeometryIds=[],this._nextIndexStart=0,this._nextVertexStart=0,this._geometryCount=0,this._visibilityChanged=!0,this._geometryInitialized=!1,this._maxInstanceCount=e,this._maxVertexCount=t,this._maxIndexCount=n,this._multiDrawCounts=new Int32Array(e),this._multiDrawStarts=new Int32Array(e),this._multiDrawCount=0,this._multiDrawInstances=null,this._matricesTexture=null,this._indirectTexture=null,this._colorsTexture=null,this._initMatricesTexture(),this._initIndirectTexture()}get maxInstanceCount(){return this._maxInstanceCount}get instanceCount(){return this._instanceInfo.length-this._availableInstanceIds.length}get unusedVertexCount(){return this._maxVertexCount-this._nextVertexStart}get unusedIndexCount(){return this._maxIndexCount-this._nextIndexStart}_initMatricesTexture(){let e=Math.sqrt(this._maxInstanceCount*4);e=Math.ceil(e/4)*4,e=Math.max(e,4);const t=new Float32Array(e*e*4),n=new Ol(t,e,e,Qi,Ci);this._matricesTexture=n}_initIndirectTexture(){let e=Math.sqrt(this._maxInstanceCount);e=Math.ceil(e);const t=new Uint32Array(e*e),n=new Ol(t,e,e,Bm,Hi);this._indirectTexture=n}_initColorsTexture(){let e=Math.sqrt(this._maxInstanceCount);e=Math.ceil(e);const t=new Float32Array(e*e*4).fill(1),n=new Ol(t,e,e,Qi,Ci);n.colorSpace=Nn.workingColorSpace,this._colorsTexture=n}_initializeGeometry(e){const t=this.geometry,n=this._maxVertexCount,i=this._maxIndexCount;if(this._geometryInitialized===!1){for(const s in e.attributes){const a=e.getAttribute(s),{array:o,itemSize:l,normalized:c}=a,d=new o.constructor(n*l),p=new Ji(d,l,c);t.setAttribute(s,p)}if(e.getIndex()!==null){const s=n>65535?new Uint32Array(i):new Uint16Array(i);t.setIndex(new Ji(s,1))}this._geometryInitialized=!0}}_validateGeometry(e){const t=this.geometry;if(!!e.getIndex()!=!!t.getIndex())throw new Error('THREE.BatchedMesh: All geometries must consistently have "index".');for(const n in t.attributes){if(!e.hasAttribute(n))throw new Error(`THREE.BatchedMesh: Added geometry missing "${n}". All geometries must have consistent attributes.`);const i=e.getAttribute(n),s=t.getAttribute(n);if(i.itemSize!==s.itemSize||i.normalized!==s.normalized)throw new Error("THREE.BatchedMesh: All attributes must have a consistent itemSize and normalized value.")}}validateInstanceId(e){const t=this._instanceInfo;if(e<0||e>=t.length||t[e].active===!1)throw new Error(`THREE.BatchedMesh: Invalid instanceId ${e}. Instance is either out of range or has been deleted.`)}validateGeometryId(e){const t=this._geometryInfo;if(e<0||e>=t.length||t[e].active===!1)throw new Error(`THREE.BatchedMesh: Invalid geometryId ${e}. Geometry is either out of range or has been deleted.`)}setCustomSort(e){return this.customSort=e,this}computeBoundingBox(){this.boundingBox===null&&(this.boundingBox=new _o);const e=this.boundingBox,t=this._instanceInfo;e.makeEmpty();for(let n=0,i=t.length;n<i;n++){if(t[n].active===!1)continue;const s=t[n].geometryIndex;this.getMatrixAt(n,vl),this.getBoundingBoxAt(s,lA).applyMatrix4(vl),e.union(lA)}}computeBoundingSphere(){this.boundingSphere===null&&(this.boundingSphere=new Sa);const e=this.boundingSphere,t=this._instanceInfo;e.makeEmpty();for(let n=0,i=t.length;n<i;n++){if(t[n].active===!1)continue;const s=t[n].geometryIndex;this.getMatrixAt(n,vl),this.getBoundingSphereAt(s,Vg).applyMatrix4(vl),e.union(Vg)}}addInstance(e){if(this._instanceInfo.length>=this.maxInstanceCount&&this._availableInstanceIds.length===0)throw new Error("THREE.BatchedMesh: Maximum item count reached.");const n={visible:!0,active:!0,geometryIndex:e};let i=null;this._availableInstanceIds.length>0?(this._availableInstanceIds.sort(i3),i=this._availableInstanceIds.shift(),this._instanceInfo[i]=n):(i=this._instanceInfo.length,this._instanceInfo.push(n));const s=this._matricesTexture;vl.identity().toArray(s.image.data,i*16),s.needsUpdate=!0;const a=this._colorsTexture;return a&&(tK.toArray(a.image.data,i*4),a.needsUpdate=!0),this._visibilityChanged=!0,i}addGeometry(e,t=-1,n=-1){this._initializeGeometry(e),this._validateGeometry(e);const i={vertexStart:-1,vertexCount:-1,reservedVertexCount:-1,indexStart:-1,indexCount:-1,reservedIndexCount:-1,start:-1,count:-1,boundingBox:null,boundingSphere:null,active:!0},s=this._geometryInfo;i.vertexStart=this._nextVertexStart,i.reservedVertexCount=t===-1?e.getAttribute("position").count:t;const a=e.getIndex();if(a!==null&&(i.indexStart=this._nextIndexStart,i.reservedIndexCount=n===-1?a.count:n),i.indexStart!==-1&&i.indexStart+i.reservedIndexCount>this._maxIndexCount||i.vertexStart+i.reservedVertexCount>this._maxVertexCount)throw new Error("THREE.BatchedMesh: Reserved space request exceeds the maximum buffer size.");let l;return this._availableGeometryIds.length>0?(this._availableGeometryIds.sort(i3),l=this._availableGeometryIds.shift(),s[l]=i):(l=this._geometryCount,this._geometryCount++,s.push(i)),this.setGeometryAt(l,e),this._nextIndexStart=i.indexStart+i.reservedIndexCount,this._nextVertexStart=i.vertexStart+i.reservedVertexCount,l}setGeometryAt(e,t){if(e>=this._geometryCount)throw new Error("THREE.BatchedMesh: Maximum geometry count reached.");this._validateGeometry(t);const n=this.geometry,i=n.getIndex()!==null,s=n.getIndex(),a=t.getIndex(),o=this._geometryInfo[e];if(i&&a.count>o.reservedIndexCount||t.attributes.position.count>o.reservedVertexCount)throw new Error("THREE.BatchedMesh: Reserved space not large enough for provided geometry.");const l=o.vertexStart,c=o.reservedVertexCount;o.vertexCount=t.getAttribute("position").count;for(const d in n.attributes){const p=t.getAttribute(d),y=n.getAttribute(d);rK(p,y,l);const _=p.itemSize;for(let v=p.count,b=c;v<b;v++){const E=l+v;for(let T=0;T<_;T++)y.setComponent(E,T,0)}y.needsUpdate=!0,y.addUpdateRange(l*_,c*_)}if(i){const d=o.indexStart,p=o.reservedIndexCount;o.indexCount=t.getIndex().count;for(let y=0;y<a.count;y++)s.setX(d+y,l+a.getX(y));for(let y=a.count,_=p;y<_;y++)s.setX(d+y,l);s.needsUpdate=!0,s.addUpdateRange(d,o.reservedIndexCount)}return o.start=i?o.indexStart:o.vertexStart,o.count=i?o.indexCount:o.vertexCount,o.boundingBox=null,t.boundingBox!==null&&(o.boundingBox=t.boundingBox.clone()),o.boundingSphere=null,t.boundingSphere!==null&&(o.boundingSphere=t.boundingSphere.clone()),this._visibilityChanged=!0,e}deleteGeometry(e){const t=this._geometryInfo;if(e>=t.length||t[e].active===!1)return this;const n=this._instanceInfo;for(let i=0,s=n.length;i<s;i++)n[i].active&&n[i].geometryIndex===e&&this.deleteInstance(i);return t[e].active=!1,this._availableGeometryIds.push(e),this._visibilityChanged=!0,this}deleteInstance(e){return this.validateInstanceId(e),this._instanceInfo[e].active=!1,this._availableInstanceIds.push(e),this._visibilityChanged=!0,this}optimize(){let e=0,t=0;const n=this._geometryInfo,i=n.map((a,o)=>o).sort((a,o)=>n[a].vertexStart-n[o].vertexStart),s=this.geometry;for(let a=0,o=n.length;a<o;a++){const l=i[a],c=n[l];if(c.active!==!1){if(s.index!==null){if(c.indexStart!==t){const{indexStart:d,vertexStart:p,reservedIndexCount:y}=c,_=s.index,v=_.array,b=e-p;for(let E=d;E<d+y;E++)v[E]=v[E]+b;_.array.copyWithin(t,d,d+y),_.addUpdateRange(t,y),_.needsUpdate=!0,c.indexStart=t}t+=c.reservedIndexCount}if(c.vertexStart!==e){const{vertexStart:d,reservedVertexCount:p}=c,y=s.attributes;for(const _ in y){const v=y[_],{array:b,itemSize:E}=v;b.copyWithin(e*E,d*E,(d+p)*E),v.addUpdateRange(e*E,p*E),v.needsUpdate=!0}c.vertexStart=e}e+=c.reservedVertexCount,c.start=s.index?c.indexStart:c.vertexStart,this._nextIndexStart=s.index?c.indexStart+c.reservedIndexCount:0,this._nextVertexStart=c.vertexStart+c.reservedVertexCount}}return this._visibilityChanged=!0,this}getBoundingBoxAt(e,t){if(e>=this._geometryCount)return null;const n=this.geometry,i=this._geometryInfo[e];if(i.boundingBox===null){const s=new _o,a=n.index,o=n.attributes.position;for(let l=i.start,c=i.start+i.count;l<c;l++){let d=l;a&&(d=a.getX(d)),s.expandByPoint(IS.fromBufferAttribute(o,d))}i.boundingBox=s}return t.copy(i.boundingBox),t}getBoundingSphereAt(e,t){if(e>=this._geometryCount)return null;const n=this.geometry,i=this._geometryInfo[e];if(i.boundingSphere===null){const s=new Sa;this.getBoundingBoxAt(e,lA),lA.getCenter(s.center);const a=n.index,o=n.attributes.position;let l=0;for(let c=i.start,d=i.start+i.count;c<d;c++){let p=c;a&&(p=a.getX(p)),IS.fromBufferAttribute(o,p),l=Math.max(l,s.center.distanceToSquared(IS))}s.radius=Math.sqrt(l),i.boundingSphere=s}return t.copy(i.boundingSphere),t}setMatrixAt(e,t){this.validateInstanceId(e);const n=this._matricesTexture,i=this._matricesTexture.image.data;return t.toArray(i,e*16),n.needsUpdate=!0,this}getMatrixAt(e,t){return this.validateInstanceId(e),t.fromArray(this._matricesTexture.image.data,e*16)}setColorAt(e,t){return this.validateInstanceId(e),this._colorsTexture===null&&this._initColorsTexture(),t.toArray(this._colorsTexture.image.data,e*4),this._colorsTexture.needsUpdate=!0,this}getColorAt(e,t){return this.validateInstanceId(e),t.fromArray(this._colorsTexture.image.data,e*4)}setVisibleAt(e,t){return this.validateInstanceId(e),this._instanceInfo[e].visible===t?this:(this._instanceInfo[e].visible=t,this._visibilityChanged=!0,this)}getVisibleAt(e){return this.validateInstanceId(e),this._instanceInfo[e].visible}setGeometryIdAt(e,t){return this.validateInstanceId(e),this.validateGeometryId(t),this._instanceInfo[e].geometryIndex=t,this}getGeometryIdAt(e){return this.validateInstanceId(e),this._instanceInfo[e].geometryIndex}getGeometryRangeAt(e,t={}){this.validateGeometryId(e);const n=this._geometryInfo[e];return t.vertexStart=n.vertexStart,t.vertexCount=n.vertexCount,t.reservedVertexCount=n.reservedVertexCount,t.indexStart=n.indexStart,t.indexCount=n.indexCount,t.reservedIndexCount=n.reservedIndexCount,t.start=n.start,t.count=n.count,t}setInstanceCount(e){const t=this._availableInstanceIds,n=this._instanceInfo;for(t.sort(i3);t[t.length-1]===n.length-1;)n.pop(),t.pop();if(e<n.length)throw new Error(`BatchedMesh: Instance ids outside the range ${e} are being used. Cannot shrink instance count.`);const i=new Int32Array(e),s=new Int32Array(e);Gg(this._multiDrawCounts,i),Gg(this._multiDrawStarts,s),this._multiDrawCounts=i,this._multiDrawStarts=s,this._maxInstanceCount=e;const a=this._indirectTexture,o=this._matricesTexture,l=this._colorsTexture;a.dispose(),this._initIndirectTexture(),Gg(a.image.data,this._indirectTexture.image.data),o.dispose(),this._initMatricesTexture(),Gg(o.image.data,this._matricesTexture.image.data),l&&(l.dispose(),this._initColorsTexture(),Gg(l.image.data,this._colorsTexture.image.data))}setGeometrySize(e,t){const n=[...this._geometryInfo].filter(o=>o.active);if(Math.max(...n.map(o=>o.vertexStart+o.reservedVertexCount))>e)throw new Error(`BatchedMesh: Geometry vertex values are being used outside the range ${t}. Cannot shrink further.`);if(this.geometry.index&&Math.max(...n.map(l=>l.indexStart+l.reservedIndexCount))>t)throw new Error(`BatchedMesh: Geometry index values are being used outside the range ${t}. Cannot shrink further.`);const s=this.geometry;s.dispose(),this._maxVertexCount=e,this._maxIndexCount=t,this._geometryInitialized&&(this._geometryInitialized=!1,this.geometry=new Qn,this._initializeGeometry(s));const a=this.geometry;s.index&&Gg(s.index.array,a.index.array);for(const o in s.attributes)Gg(s.attributes[o].array,a.attributes[o].array)}raycast(e,t){const n=this._instanceInfo,i=this._geometryInfo,s=this.matrixWorld,a=this.geometry;so.material=this.material,so.geometry.index=a.index,so.geometry.attributes=a.attributes,so.geometry.boundingBox===null&&(so.geometry.boundingBox=new _o),so.geometry.boundingSphere===null&&(so.geometry.boundingSphere=new Sa);for(let o=0,l=n.length;o<l;o++){if(!n[o].visible||!n[o].active)continue;const c=n[o].geometryIndex,d=i[c];so.geometry.setDrawRange(d.start,d.count),this.getMatrixAt(o,so.matrixWorld).premultiply(s),this.getBoundingBoxAt(c,so.geometry.boundingBox),this.getBoundingSphereAt(c,so.geometry.boundingSphere),so.raycast(e,uA);for(let p=0,y=uA.length;p<y;p++){const _=uA[p];_.object=this,_.batchId=o,t.push(_)}uA.length=0}so.material=null,so.geometry.index=null,so.geometry.attributes={},so.geometry.setDrawRange(0,1/0)}copy(e){return super.copy(e),this.geometry=e.geometry.clone(),this.perObjectFrustumCulled=e.perObjectFrustumCulled,this.sortObjects=e.sortObjects,this.boundingBox=e.boundingBox!==null?e.boundingBox.clone():null,this.boundingSphere=e.boundingSphere!==null?e.boundingSphere.clone():null,this._geometryInfo=e._geometryInfo.map(t=>({...t,boundingBox:t.boundingBox!==null?t.boundingBox.clone():null,boundingSphere:t.boundingSphere!==null?t.boundingSphere.clone():null})),this._instanceInfo=e._instanceInfo.map(t=>({...t})),this._availableInstanceIds=e._availableInstanceIds.slice(),this._availableGeometryIds=e._availableGeometryIds.slice(),this._nextIndexStart=e._nextIndexStart,this._nextVertexStart=e._nextVertexStart,this._geometryCount=e._geometryCount,this._maxInstanceCount=e._maxInstanceCount,this._maxVertexCount=e._maxVertexCount,this._maxIndexCount=e._maxIndexCount,this._geometryInitialized=e._geometryInitialized,this._multiDrawCounts=e._multiDrawCounts.slice(),this._multiDrawStarts=e._multiDrawStarts.slice(),this._indirectTexture=e._indirectTexture.clone(),this._indirectTexture.image.data=this._indirectTexture.image.data.slice(),this._matricesTexture=e._matricesTexture.clone(),this._matricesTexture.image.data=this._matricesTexture.image.data.slice(),this._colorsTexture!==null&&(this._colorsTexture=e._colorsTexture.clone(),this._colorsTexture.image.data=this._colorsTexture.image.data.slice()),this}dispose(){this.geometry.dispose(),this._matricesTexture.dispose(),this._matricesTexture=null,this._indirectTexture.dispose(),this._indirectTexture=null,this._colorsTexture!==null&&(this._colorsTexture.dispose(),this._colorsTexture=null)}onBeforeRender(e,t,n,i,s){if(!this._visibilityChanged&&!this.perObjectFrustumCulled&&!this.sortObjects)return;const a=i.getIndex(),o=a===null?1:a.array.BYTES_PER_ELEMENT,l=this._instanceInfo,c=this._multiDrawStarts,d=this._multiDrawCounts,p=this._geometryInfo,y=this.perObjectFrustumCulled,_=this._indirectTexture,v=_.image.data,b=n.isArrayCamera?nK:mz;y&&!n.isArrayCamera&&(vl.multiplyMatrices(n.projectionMatrix,n.matrixWorldInverse).multiply(this.matrixWorld),mz.setFromProjectionMatrix(vl,n.coordinateSystem,n.reversedDepth));let E=0;if(this.sortObjects){vl.copy(this.matrixWorld).invert(),IS.setFromMatrixPosition(n.matrixWorld).applyMatrix4(vl),gz.set(0,0,-1).transformDirection(n.matrixWorld).transformDirection(vl);for(let R=0,N=l.length;R<N;R++)if(l[R].visible&&l[R].active){const P=l[R].geometryIndex;this.getMatrixAt(R,vl),this.getBoundingSphereAt(P,Vg).applyMatrix4(vl);let U=!1;if(y&&(U=!b.intersectsSphere(Vg,n)),!U){const L=p[P],F=iK.subVectors(Vg.center,IS).dot(gz);r3.push(L.start,L.count,F,R)}}const T=r3.list,M=this.customSort;M===null?T.sort(s.transparent?JZ:QZ):M.call(this,T,n);for(let R=0,N=T.length;R<N;R++){const P=T[R];c[E]=P.start*o,d[E]=P.count,v[E]=P.index,E++}r3.reset()}else for(let T=0,M=l.length;T<M;T++)if(l[T].visible&&l[T].active){const R=l[T].geometryIndex;let N=!1;if(y&&(this.getMatrixAt(T,vl),this.getBoundingSphereAt(R,Vg).applyMatrix4(vl),N=!b.intersectsSphere(Vg,n)),!N){const P=p[R];c[E]=P.start*o,d[E]=P.count,v[E]=T,E++}}_.needsUpdate=!0,this._multiDrawCount=E,this._visibilityChanged=!1}onBeforeShadow(e,t,n,i,s,a){this.onBeforeRender(e,null,i,s,a)}}class bo extends Ta{constructor(e){super(),this.isLineBasicMaterial=!0,this.type="LineBasicMaterial",this.color=new Kt(16777215),this.map=null,this.linewidth=1,this.linecap="round",this.linejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.linewidth=e.linewidth,this.linecap=e.linecap,this.linejoin=e.linejoin,this.fog=e.fog,this}}const Jw=new ne,eR=new ne,yz=new gn,FS=new wy,cA=new Sa,s3=new ne,_z=new ne;class Tm extends Fi{constructor(e=new Qn,t=new bo){super(),this.isLine=!0,this.type="Line",this.geometry=e,this.material=t,this.morphTargetDictionary=void 0,this.morphTargetInfluences=void 0,this.updateMorphTargets()}copy(e,t){return super.copy(e,t),this.material=Array.isArray(e.material)?e.material.slice():e.material,this.geometry=e.geometry,this}computeLineDistances(){const e=this.geometry;if(e.index===null){const t=e.attributes.position,n=[0];for(let i=1,s=t.count;i<s;i++)Jw.fromBufferAttribute(t,i-1),eR.fromBufferAttribute(t,i),n[i]=n[i-1],n[i]+=Jw.distanceTo(eR);e.setAttribute("lineDistance",new hn(n,1))}else Ve("Line.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}raycast(e,t){const n=this.geometry,i=this.matrixWorld,s=e.params.Line.threshold,a=n.drawRange;if(n.boundingSphere===null&&n.computeBoundingSphere(),cA.copy(n.boundingSphere),cA.applyMatrix4(i),cA.radius+=s,e.ray.intersectsSphere(cA)===!1)return;yz.copy(i).invert(),FS.copy(e.ray).applyMatrix4(yz);const o=s/((this.scale.x+this.scale.y+this.scale.z)/3),l=o*o,c=this.isLineSegments?2:1,d=n.index,y=n.attributes.position;if(d!==null){const _=Math.max(0,a.start),v=Math.min(d.count,a.start+a.count);for(let b=_,E=v-1;b<E;b+=c){const T=d.getX(b),M=d.getX(b+1),R=fA(this,e,FS,l,T,M,b);R&&t.push(R)}if(this.isLineLoop){const b=d.getX(v-1),E=d.getX(_),T=fA(this,e,FS,l,b,E,v-1);T&&t.push(T)}}else{const _=Math.max(0,a.start),v=Math.min(y.count,a.start+a.count);for(let b=_,E=v-1;b<E;b+=c){const T=fA(this,e,FS,l,b,b+1,b);T&&t.push(T)}if(this.isLineLoop){const b=fA(this,e,FS,l,v-1,_,v-1);b&&t.push(b)}}}updateMorphTargets(){const t=this.geometry.morphAttributes,n=Object.keys(t);if(n.length>0){const i=t[n[0]];if(i!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let s=0,a=i.length;s<a;s++){const o=i[s].name||String(s);this.morphTargetInfluences.push(0),this.morphTargetDictionary[o]=s}}}}}function fA(r,e,t,n,i,s,a){const o=r.geometry.attributes.position;if(Jw.fromBufferAttribute(o,i),eR.fromBufferAttribute(o,s),t.distanceSqToSegment(Jw,eR,s3,_z)>n)return;s3.applyMatrix4(r.matrixWorld);const c=e.ray.origin.distanceTo(s3);if(!(c<e.near||c>e.far))return{distance:c,point:_z.clone().applyMatrix4(r.matrixWorld),index:a,face:null,faceIndex:null,barycoord:null,object:r}}const vz=new ne,xz=new ne;class xd extends Tm{constructor(e,t){super(e,t),this.isLineSegments=!0,this.type="LineSegments"}computeLineDistances(){const e=this.geometry;if(e.index===null){const t=e.attributes.position,n=[];for(let i=0,s=t.count;i<s;i+=2)vz.fromBufferAttribute(t,i),xz.fromBufferAttribute(t,i+1),n[i]=i===0?0:n[i-1],n[i+1]=n[i]+vz.distanceTo(xz);e.setAttribute("lineDistance",new hn(n,1))}else Ve("LineSegments.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}}class r6 extends Tm{constructor(e,t){super(e,t),this.isLineLoop=!0,this.type="LineLoop"}}class CC extends Ta{constructor(e){super(),this.isPointsMaterial=!0,this.type="PointsMaterial",this.color=new Kt(16777215),this.map=null,this.alphaMap=null,this.size=1,this.sizeAttenuation=!0,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.alphaMap=e.alphaMap,this.size=e.size,this.sizeAttenuation=e.sizeAttenuation,this.fog=e.fog,this}}const bz=new gn,cO=new wy,dA=new Sa,hA=new ne;class s6 extends Fi{constructor(e=new Qn,t=new CC){super(),this.isPoints=!0,this.type="Points",this.geometry=e,this.material=t,this.morphTargetDictionary=void 0,this.morphTargetInfluences=void 0,this.updateMorphTargets()}copy(e,t){return super.copy(e,t),this.material=Array.isArray(e.material)?e.material.slice():e.material,this.geometry=e.geometry,this}raycast(e,t){const n=this.geometry,i=this.matrixWorld,s=e.params.Points.threshold,a=n.drawRange;if(n.boundingSphere===null&&n.computeBoundingSphere(),dA.copy(n.boundingSphere),dA.applyMatrix4(i),dA.radius+=s,e.ray.intersectsSphere(dA)===!1)return;bz.copy(i).invert(),cO.copy(e.ray).applyMatrix4(bz);const o=s/((this.scale.x+this.scale.y+this.scale.z)/3),l=o*o,c=n.index,p=n.attributes.position;if(c!==null){const y=Math.max(0,a.start),_=Math.min(c.count,a.start+a.count);for(let v=y,b=_;v<b;v++){const E=c.getX(v);hA.fromBufferAttribute(p,E),Sz(hA,E,l,i,e,t,this)}}else{const y=Math.max(0,a.start),_=Math.min(p.count,a.start+a.count);for(let v=y,b=_;v<b;v++)hA.fromBufferAttribute(p,v),Sz(hA,v,l,i,e,t,this)}}updateMorphTargets(){const t=this.geometry.morphAttributes,n=Object.keys(t);if(n.length>0){const i=t[n[0]];if(i!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let s=0,a=i.length;s<a;s++){const o=i[s].name||String(s);this.morphTargetInfluences.push(0),this.morphTargetDictionary[o]=s}}}}}function Sz(r,e,t,n,i,s,a){const o=cO.distanceSqToPoint(r);if(o<t){const l=new ne;cO.closestPointToPoint(r,l),l.applyMatrix4(n);const c=i.ray.origin.distanceTo(l);if(c<i.near||c>i.far)return;s.push({distance:c,distanceToRay:Math.sqrt(o),point:l,index:e,face:null,faceIndex:null,barycoord:null,object:a})}}class a6 extends sr{constructor(e,t,n,i,s=ei,a=ei,o,l,c){super(e,t,n,i,s,a,o,l,c),this.isVideoTexture=!0,this.generateMipmaps=!1,this._requestVideoFrameCallbackId=0;const d=this;function p(){d.needsUpdate=!0,d._requestVideoFrameCallbackId=e.requestVideoFrameCallback(p)}"requestVideoFrameCallback"in e&&(this._requestVideoFrameCallbackId=e.requestVideoFrameCallback(p))}clone(){return new this.constructor(this.image).copy(this)}update(){const e=this.image;"requestVideoFrameCallback"in e===!1&&e.readyState>=e.HAVE_CURRENT_DATA&&(this.needsUpdate=!0)}dispose(){this._requestVideoFrameCallbackId!==0&&(this.source.data.cancelVideoFrameCallback(this._requestVideoFrameCallbackId),this._requestVideoFrameCallbackId=0),super.dispose()}}class sK extends a6{constructor(e,t,n,i,s,a,o,l){super({},e,t,n,i,s,a,o,l),this.isVideoFrameTexture=!0}update(){}clone(){return new this.constructor().copy(this)}setFrame(e){this.image=e,this.needsUpdate=!0}}class NC extends sr{constructor(e,t){super({width:e,height:t}),this.isFramebufferTexture=!0,this.magFilter=Ki,this.minFilter=Ki,this.generateMipmaps=!1,this.needsUpdate=!0}}class DC extends sr{constructor(e,t,n,i,s,a,o,l,c,d,p,y){super(null,a,o,l,c,d,i,s,p,y),this.isCompressedTexture=!0,this.image={width:t,height:n},this.mipmaps=e,this.flipY=!1,this.generateMipmaps=!1}}class aK extends DC{constructor(e,t,n,i,s,a){super(e,t,n,s,a),this.isCompressedArrayTexture=!0,this.image.depth=i,this.wrapR=Dr,this.layerUpdates=new Set}addLayerUpdate(e){this.layerUpdates.add(e)}clearLayerUpdates(){this.layerUpdates.clear()}}class oK extends DC{constructor(e,t,n){super(void 0,e[0].width,e[0].height,t,n,ol),this.isCompressedCubeTexture=!0,this.isCubeTexture=!0,this.image=e}}class lK extends sr{constructor(e,t,n,i,s,a,o,l,c){super(e,t,n,i,s,a,o,l,c),this.isCanvasTexture=!0,this.needsUpdate=!0}}class Ga extends sr{constructor(e,t,n=Hi,i,s,a,o=Ki,l=Ki,c,d=ba,p=1){if(d!==ba&&d!==ho)throw new Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");const y={width:e,height:t,depth:p};super(y,i,s,a,o,l,d,n,c),this.isDepthTexture=!0,this.flipY=!1,this.generateMipmaps=!1,this.compareFunction=null}copy(e){return super.copy(e),this.source=new nm(Object.assign({},e.image)),this.compareFunction=e.compareFunction,this}toJSON(e){const t=super.toJSON(e);return this.compareFunction!==null&&(t.compareFunction=this.compareFunction),t}}class fL extends Ga{constructor(e,t=Hi,n=ol,i,s,a=Ki,o=Ki,l,c=ba){const d={width:e,height:e,depth:1},p=[d,d,d,d,d,d];super(e,e,t,n,i,s,a,o,l,c),this.image=p,this.isCubeDepthTexture=!0,this.isCubeTexture=!0}get images(){return this.image}set images(e){this.image=e}}class dL extends sr{constructor(e=null){super(),this.sourceTexture=e,this.isExternalTexture=!0}copy(e){return super.copy(e),this.sourceTexture=e.sourceTexture,this}}class OC extends Qn{constructor(e=1,t=1,n=4,i=8,s=1){super(),this.type="CapsuleGeometry",this.parameters={radius:e,height:t,capSegments:n,radialSegments:i,heightSegments:s},t=Math.max(0,t),n=Math.max(1,Math.floor(n)),i=Math.max(3,Math.floor(i)),s=Math.max(1,Math.floor(s));const a=[],o=[],l=[],c=[],d=t/2,p=Math.PI/2*e,y=t,_=2*p+y,v=n*2+s,b=i+1,E=new ne,T=new ne;for(let M=0;M<=v;M++){let R=0,N=0,P=0,U=0;if(M<=n){const O=M/n,B=O*Math.PI/2;N=-d-e*Math.cos(B),P=e*Math.sin(B),U=-e*Math.cos(B),R=O*p}else if(M<=n+s){const O=(M-n)/s;N=-d+O*t,P=e,U=0,R=p+O*y}else{const O=(M-n-s)/n,B=O*Math.PI/2;N=d+e*Math.sin(B),P=e*Math.cos(B),U=e*Math.sin(B),R=p+y+O*p}const L=Math.max(0,Math.min(1,R/_));let F=0;M===0?F=.5/i:M===v&&(F=-.5/i);for(let O=0;O<=i;O++){const B=O/i,q=B*Math.PI*2,j=Math.sin(q),Q=Math.cos(q);T.x=-P*Q,T.y=N,T.z=P*j,o.push(T.x,T.y,T.z),E.set(-P*Q,U,P*j),E.normalize(),l.push(E.x,E.y,E.z),c.push(B+F,L)}if(M>0){const O=(M-1)*b;for(let B=0;B<i;B++){const q=O+B,j=O+B+1,Q=M*b+B,se=M*b+B+1;a.push(q,j,Q),a.push(j,se,Q)}}}this.setIndex(a),this.setAttribute("position",new hn(o,3)),this.setAttribute("normal",new hn(l,3)),this.setAttribute("uv",new hn(c,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new OC(e.radius,e.height,e.capSegments,e.radialSegments,e.heightSegments)}}class UC extends Qn{constructor(e=1,t=32,n=0,i=Math.PI*2){super(),this.type="CircleGeometry",this.parameters={radius:e,segments:t,thetaStart:n,thetaLength:i},t=Math.max(3,t);const s=[],a=[],o=[],l=[],c=new ne,d=new tt;a.push(0,0,0),o.push(0,0,1),l.push(.5,.5);for(let p=0,y=3;p<=t;p++,y+=3){const _=n+p/t*i;c.x=e*Math.cos(_),c.y=e*Math.sin(_),a.push(c.x,c.y,c.z),o.push(0,0,1),d.x=(a[y]/e+1)/2,d.y=(a[y+1]/e+1)/2,l.push(d.x,d.y)}for(let p=1;p<=t;p++)s.push(p,p+1,0);this.setIndex(s),this.setAttribute("position",new hn(a,3)),this.setAttribute("normal",new hn(o,3)),this.setAttribute("uv",new hn(l,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new UC(e.radius,e.segments,e.thetaStart,e.thetaLength)}}class kx extends Qn{constructor(e=1,t=1,n=1,i=32,s=1,a=!1,o=0,l=Math.PI*2){super(),this.type="CylinderGeometry",this.parameters={radiusTop:e,radiusBottom:t,height:n,radialSegments:i,heightSegments:s,openEnded:a,thetaStart:o,thetaLength:l};const c=this;i=Math.floor(i),s=Math.floor(s);const d=[],p=[],y=[],_=[];let v=0;const b=[],E=n/2;let T=0;M(),a===!1&&(e>0&&R(!0),t>0&&R(!1)),this.setIndex(d),this.setAttribute("position",new hn(p,3)),this.setAttribute("normal",new hn(y,3)),this.setAttribute("uv",new hn(_,2));function M(){const N=new ne,P=new ne;let U=0;const L=(t-e)/n;for(let F=0;F<=s;F++){const O=[],B=F/s,q=B*(t-e)+e;for(let j=0;j<=i;j++){const Q=j/i,se=Q*l+o,ae=Math.sin(se),V=Math.cos(se);P.x=q*ae,P.y=-B*n+E,P.z=q*V,p.push(P.x,P.y,P.z),N.set(ae,L,V).normalize(),y.push(N.x,N.y,N.z),_.push(Q,1-B),O.push(v++)}b.push(O)}for(let F=0;F<i;F++)for(let O=0;O<s;O++){const B=b[O][F],q=b[O+1][F],j=b[O+1][F+1],Q=b[O][F+1];(e>0||O!==0)&&(d.push(B,q,Q),U+=3),(t>0||O!==s-1)&&(d.push(q,j,Q),U+=3)}c.addGroup(T,U,0),T+=U}function R(N){const P=v,U=new tt,L=new ne;let F=0;const O=N===!0?e:t,B=N===!0?1:-1;for(let j=1;j<=i;j++)p.push(0,E*B,0),y.push(0,B,0),_.push(.5,.5),v++;const q=v;for(let j=0;j<=i;j++){const se=j/i*l+o,ae=Math.cos(se),V=Math.sin(se);L.x=O*V,L.y=E*B,L.z=O*ae,p.push(L.x,L.y,L.z),y.push(0,B,0),U.x=ae*.5+.5,U.y=V*.5*B+.5,_.push(U.x,U.y),v++}for(let j=0;j<i;j++){const Q=P+j,se=q+j;N===!0?d.push(se,se+1,Q):d.push(se+1,se,Q),F+=3}c.addGroup(T,F,N===!0?1:2),T+=F}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new kx(e.radiusTop,e.radiusBottom,e.height,e.radialSegments,e.heightSegments,e.openEnded,e.thetaStart,e.thetaLength)}}class q1 extends kx{constructor(e=1,t=1,n=32,i=1,s=!1,a=0,o=Math.PI*2){super(0,e,t,n,i,s,a,o),this.type="ConeGeometry",this.parameters={radius:e,height:t,radialSegments:n,heightSegments:i,openEnded:s,thetaStart:a,thetaLength:o}}static fromJSON(e){return new q1(e.radius,e.height,e.radialSegments,e.heightSegments,e.openEnded,e.thetaStart,e.thetaLength)}}class zm extends Qn{constructor(e=[],t=[],n=1,i=0){super(),this.type="PolyhedronGeometry",this.parameters={vertices:e,indices:t,radius:n,detail:i};const s=[],a=[];o(i),c(n),d(),this.setAttribute("position",new hn(s,3)),this.setAttribute("normal",new hn(s.slice(),3)),this.setAttribute("uv",new hn(a,2)),i===0?this.computeVertexNormals():this.normalizeNormals();function o(M){const R=new ne,N=new ne,P=new ne;for(let U=0;U<t.length;U+=3)_(t[U+0],R),_(t[U+1],N),_(t[U+2],P),l(R,N,P,M)}function l(M,R,N,P){const U=P+1,L=[];for(let F=0;F<=U;F++){L[F]=[];const O=M.clone().lerp(N,F/U),B=R.clone().lerp(N,F/U),q=U-F;for(let j=0;j<=q;j++)j===0&&F===U?L[F][j]=O:L[F][j]=O.clone().lerp(B,j/q)}for(let F=0;F<U;F++)for(let O=0;O<2*(U-F)-1;O++){const B=Math.floor(O/2);O%2===0?(y(L[F][B+1]),y(L[F+1][B]),y(L[F][B])):(y(L[F][B+1]),y(L[F+1][B+1]),y(L[F+1][B]))}}function c(M){const R=new ne;for(let N=0;N<s.length;N+=3)R.x=s[N+0],R.y=s[N+1],R.z=s[N+2],R.normalize().multiplyScalar(M),s[N+0]=R.x,s[N+1]=R.y,s[N+2]=R.z}function d(){const M=new ne;for(let R=0;R<s.length;R+=3){M.x=s[R+0],M.y=s[R+1],M.z=s[R+2];const N=E(M)/2/Math.PI+.5,P=T(M)/Math.PI+.5;a.push(N,1-P)}v(),p()}function p(){for(let M=0;M<a.length;M+=6){const R=a[M+0],N=a[M+2],P=a[M+4],U=Math.max(R,N,P),L=Math.min(R,N,P);U>.9&&L<.1&&(R<.2&&(a[M+0]+=1),N<.2&&(a[M+2]+=1),P<.2&&(a[M+4]+=1))}}function y(M){s.push(M.x,M.y,M.z)}function _(M,R){const N=M*3;R.x=e[N+0],R.y=e[N+1],R.z=e[N+2]}function v(){const M=new ne,R=new ne,N=new ne,P=new ne,U=new tt,L=new tt,F=new tt;for(let O=0,B=0;O<s.length;O+=9,B+=6){M.set(s[O+0],s[O+1],s[O+2]),R.set(s[O+3],s[O+4],s[O+5]),N.set(s[O+6],s[O+7],s[O+8]),U.set(a[B+0],a[B+1]),L.set(a[B+2],a[B+3]),F.set(a[B+4],a[B+5]),P.copy(M).add(R).add(N).divideScalar(3);const q=E(P);b(U,B+0,M,q),b(L,B+2,R,q),b(F,B+4,N,q)}}function b(M,R,N,P){P<0&&M.x===1&&(a[R]=M.x-1),N.x===0&&N.z===0&&(a[R]=P/2/Math.PI+.5)}function E(M){return Math.atan2(M.z,-M.x)}function T(M){return Math.atan2(-M.y,Math.sqrt(M.x*M.x+M.z*M.z))}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new zm(e.vertices,e.indices,e.radius,e.detail)}}class LC extends zm{constructor(e=1,t=0){const n=(1+Math.sqrt(5))/2,i=1/n,s=[-1,-1,-1,-1,-1,1,-1,1,-1,-1,1,1,1,-1,-1,1,-1,1,1,1,-1,1,1,1,0,-i,-n,0,-i,n,0,i,-n,0,i,n,-i,-n,0,-i,n,0,i,-n,0,i,n,0,-n,0,-i,n,0,-i,-n,0,i,n,0,i],a=[3,11,7,3,7,15,3,15,13,7,19,17,7,17,6,7,6,15,17,4,8,17,8,10,17,10,6,8,0,16,8,16,2,8,2,10,0,12,1,0,1,18,0,18,16,6,10,2,6,2,13,6,13,15,2,16,18,2,18,3,2,3,13,18,1,9,18,9,11,18,11,3,4,14,12,4,12,0,4,0,8,11,9,5,11,5,19,11,19,7,19,5,14,19,14,4,19,4,17,1,12,14,1,14,5,1,5,9];super(s,a,e,t),this.type="DodecahedronGeometry",this.parameters={radius:e,detail:t}}static fromJSON(e){return new LC(e.radius,e.detail)}}const pA=new ne,mA=new ne,a3=new ne,gA=new El;class o6 extends Qn{constructor(e=null,t=1){if(super(),this.type="EdgesGeometry",this.parameters={geometry:e,thresholdAngle:t},e!==null){const i=Math.pow(10,4),s=Math.cos(w0*t),a=e.getIndex(),o=e.getAttribute("position"),l=a?a.count:o.count,c=[0,0,0],d=["a","b","c"],p=new Array(3),y={},_=[];for(let v=0;v<l;v+=3){a?(c[0]=a.getX(v),c[1]=a.getX(v+1),c[2]=a.getX(v+2)):(c[0]=v,c[1]=v+1,c[2]=v+2);const{a:b,b:E,c:T}=gA;if(b.fromBufferAttribute(o,c[0]),E.fromBufferAttribute(o,c[1]),T.fromBufferAttribute(o,c[2]),gA.getNormal(a3),p[0]=`${Math.round(b.x*i)},${Math.round(b.y*i)},${Math.round(b.z*i)}`,p[1]=`${Math.round(E.x*i)},${Math.round(E.y*i)},${Math.round(E.z*i)}`,p[2]=`${Math.round(T.x*i)},${Math.round(T.y*i)},${Math.round(T.z*i)}`,!(p[0]===p[1]||p[1]===p[2]||p[2]===p[0]))for(let M=0;M<3;M++){const R=(M+1)%3,N=p[M],P=p[R],U=gA[d[M]],L=gA[d[R]],F=`${N}_${P}`,O=`${P}_${N}`;O in y&&y[O]?(a3.dot(y[O].normal)<=s&&(_.push(U.x,U.y,U.z),_.push(L.x,L.y,L.z)),y[O]=null):F in y||(y[F]={index0:c[M],index1:c[R],normal:a3.clone()})}}for(const v in y)if(y[v]){const{index0:b,index1:E}=y[v];pA.fromBufferAttribute(o,b),mA.fromBufferAttribute(o,E),_.push(pA.x,pA.y,pA.z),_.push(mA.x,mA.y,mA.z)}this.setAttribute("position",new hn(_,3))}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}}class af{constructor(){this.type="Curve",this.arcLengthDivisions=200,this.needsUpdate=!1,this.cacheArcLengths=null}getPoint(){Ve("Curve: .getPoint() not implemented.")}getPointAt(e,t){const n=this.getUtoTmapping(e);return this.getPoint(n,t)}getPoints(e=5){const t=[];for(let n=0;n<=e;n++)t.push(this.getPoint(n/e));return t}getSpacedPoints(e=5){const t=[];for(let n=0;n<=e;n++)t.push(this.getPointAt(n/e));return t}getLength(){const e=this.getLengths();return e[e.length-1]}getLengths(e=this.arcLengthDivisions){if(this.cacheArcLengths&&this.cacheArcLengths.length===e+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;const t=[];let n,i=this.getPoint(0),s=0;t.push(0);for(let a=1;a<=e;a++)n=this.getPoint(a/e),s+=n.distanceTo(i),t.push(s),i=n;return this.cacheArcLengths=t,t}updateArcLengths(){this.needsUpdate=!0,this.getLengths()}getUtoTmapping(e,t=null){const n=this.getLengths();let i=0;const s=n.length;let a;t?a=t:a=e*n[s-1];let o=0,l=s-1,c;for(;o<=l;)if(i=Math.floor(o+(l-o)/2),c=n[i]-a,c<0)o=i+1;else if(c>0)l=i-1;else{l=i;break}if(i=l,n[i]===a)return i/(s-1);const d=n[i],y=n[i+1]-d,_=(a-d)/y;return(i+_)/(s-1)}getTangent(e,t){let i=e-1e-4,s=e+1e-4;i<0&&(i=0),s>1&&(s=1);const a=this.getPoint(i),o=this.getPoint(s),l=t||(a.isVector2?new tt:new ne);return l.copy(o).sub(a).normalize(),l}getTangentAt(e,t){const n=this.getUtoTmapping(e);return this.getTangent(n,t)}computeFrenetFrames(e,t=!1){const n=new ne,i=[],s=[],a=[],o=new ne,l=new gn;for(let _=0;_<=e;_++){const v=_/e;i[_]=this.getTangentAt(v,new ne)}s[0]=new ne,a[0]=new ne;let c=Number.MAX_VALUE;const d=Math.abs(i[0].x),p=Math.abs(i[0].y),y=Math.abs(i[0].z);d<=c&&(c=d,n.set(1,0,0)),p<=c&&(c=p,n.set(0,1,0)),y<=c&&n.set(0,0,1),o.crossVectors(i[0],n).normalize(),s[0].crossVectors(i[0],o),a[0].crossVectors(i[0],s[0]);for(let _=1;_<=e;_++){if(s[_]=s[_-1].clone(),a[_]=a[_-1].clone(),o.crossVectors(i[_-1],i[_]),o.length()>Number.EPSILON){o.normalize();const v=Math.acos(Yn(i[_-1].dot(i[_]),-1,1));s[_].applyMatrix4(l.makeRotationAxis(o,v))}a[_].crossVectors(i[_],s[_])}if(t===!0){let _=Math.acos(Yn(s[0].dot(s[e]),-1,1));_/=e,i[0].dot(o.crossVectors(s[0],s[e]))>0&&(_=-_);for(let v=1;v<=e;v++)s[v].applyMatrix4(l.makeRotationAxis(i[v],_*v)),a[v].crossVectors(i[v],s[v])}return{tangents:i,normals:s,binormals:a}}clone(){return new this.constructor().copy(this)}copy(e){return this.arcLengthDivisions=e.arcLengthDivisions,this}toJSON(){const e={metadata:{version:4.7,type:"Curve",generator:"Curve.toJSON"}};return e.arcLengthDivisions=this.arcLengthDivisions,e.type=this.type,e}fromJSON(e){return this.arcLengthDivisions=e.arcLengthDivisions,this}}class PC extends af{constructor(e=0,t=0,n=1,i=1,s=0,a=Math.PI*2,o=!1,l=0){super(),this.isEllipseCurve=!0,this.type="EllipseCurve",this.aX=e,this.aY=t,this.xRadius=n,this.yRadius=i,this.aStartAngle=s,this.aEndAngle=a,this.aClockwise=o,this.aRotation=l}getPoint(e,t=new tt){const n=t,i=Math.PI*2;let s=this.aEndAngle-this.aStartAngle;const a=Math.abs(s)<Number.EPSILON;for(;s<0;)s+=i;for(;s>i;)s-=i;s<Number.EPSILON&&(a?s=0:s=i),this.aClockwise===!0&&!a&&(s===i?s=-i:s=s-i);const o=this.aStartAngle+e*s;let l=this.aX+this.xRadius*Math.cos(o),c=this.aY+this.yRadius*Math.sin(o);if(this.aRotation!==0){const d=Math.cos(this.aRotation),p=Math.sin(this.aRotation),y=l-this.aX,_=c-this.aY;l=y*d-_*p+this.aX,c=y*p+_*d+this.aY}return n.set(l,c)}copy(e){return super.copy(e),this.aX=e.aX,this.aY=e.aY,this.xRadius=e.xRadius,this.yRadius=e.yRadius,this.aStartAngle=e.aStartAngle,this.aEndAngle=e.aEndAngle,this.aClockwise=e.aClockwise,this.aRotation=e.aRotation,this}toJSON(){const e=super.toJSON();return e.aX=this.aX,e.aY=this.aY,e.xRadius=this.xRadius,e.yRadius=this.yRadius,e.aStartAngle=this.aStartAngle,e.aEndAngle=this.aEndAngle,e.aClockwise=this.aClockwise,e.aRotation=this.aRotation,e}fromJSON(e){return super.fromJSON(e),this.aX=e.aX,this.aY=e.aY,this.xRadius=e.xRadius,this.yRadius=e.yRadius,this.aStartAngle=e.aStartAngle,this.aEndAngle=e.aEndAngle,this.aClockwise=e.aClockwise,this.aRotation=e.aRotation,this}}class l6 extends PC{constructor(e,t,n,i,s,a){super(e,t,n,n,i,s,a),this.isArcCurve=!0,this.type="ArcCurve"}}function hL(){let r=0,e=0,t=0,n=0;function i(s,a,o,l){r=s,e=o,t=-3*s+3*a-2*o-l,n=2*s-2*a+o+l}return{initCatmullRom:function(s,a,o,l,c){i(a,o,c*(o-s),c*(l-a))},initNonuniformCatmullRom:function(s,a,o,l,c,d,p){let y=(a-s)/c-(o-s)/(c+d)+(o-a)/d,_=(o-a)/d-(l-a)/(d+p)+(l-o)/p;y*=d,_*=d,i(a,o,y,_)},calc:function(s){const a=s*s,o=a*s;return r+e*s+t*a+n*o}}}const yA=new ne,o3=new hL,l3=new hL,u3=new hL;class u6 extends af{constructor(e=[],t=!1,n="centripetal",i=.5){super(),this.isCatmullRomCurve3=!0,this.type="CatmullRomCurve3",this.points=e,this.closed=t,this.curveType=n,this.tension=i}getPoint(e,t=new ne){const n=t,i=this.points,s=i.length,a=(s-(this.closed?0:1))*e;let o=Math.floor(a),l=a-o;this.closed?o+=o>0?0:(Math.floor(Math.abs(o)/s)+1)*s:l===0&&o===s-1&&(o=s-2,l=1);let c,d;this.closed||o>0?c=i[(o-1)%s]:(yA.subVectors(i[0],i[1]).add(i[0]),c=yA);const p=i[o%s],y=i[(o+1)%s];if(this.closed||o+2<s?d=i[(o+2)%s]:(yA.subVectors(i[s-1],i[s-2]).add(i[s-1]),d=yA),this.curveType==="centripetal"||this.curveType==="chordal"){const _=this.curveType==="chordal"?.5:.25;let v=Math.pow(c.distanceToSquared(p),_),b=Math.pow(p.distanceToSquared(y),_),E=Math.pow(y.distanceToSquared(d),_);b<1e-4&&(b=1),v<1e-4&&(v=b),E<1e-4&&(E=b),o3.initNonuniformCatmullRom(c.x,p.x,y.x,d.x,v,b,E),l3.initNonuniformCatmullRom(c.y,p.y,y.y,d.y,v,b,E),u3.initNonuniformCatmullRom(c.z,p.z,y.z,d.z,v,b,E)}else this.curveType==="catmullrom"&&(o3.initCatmullRom(c.x,p.x,y.x,d.x,this.tension),l3.initCatmullRom(c.y,p.y,y.y,d.y,this.tension),u3.initCatmullRom(c.z,p.z,y.z,d.z,this.tension));return n.set(o3.calc(l),l3.calc(l),u3.calc(l)),n}copy(e){super.copy(e),this.points=[];for(let t=0,n=e.points.length;t<n;t++){const i=e.points[t];this.points.push(i.clone())}return this.closed=e.closed,this.curveType=e.curveType,this.tension=e.tension,this}toJSON(){const e=super.toJSON();e.points=[];for(let t=0,n=this.points.length;t<n;t++){const i=this.points[t];e.points.push(i.toArray())}return e.closed=this.closed,e.curveType=this.curveType,e.tension=this.tension,e}fromJSON(e){super.fromJSON(e),this.points=[];for(let t=0,n=e.points.length;t<n;t++){const i=e.points[t];this.points.push(new ne().fromArray(i))}return this.closed=e.closed,this.curveType=e.curveType,this.tension=e.tension,this}}function Tz(r,e,t,n,i){const s=(n-e)*.5,a=(i-t)*.5,o=r*r,l=r*o;return(2*t-2*n+s+a)*l+(-3*t+3*n-2*s-a)*o+s*r+t}function uK(r,e){const t=1-r;return t*t*e}function cK(r,e){return 2*(1-r)*r*e}function fK(r,e){return r*r*e}function RT(r,e,t,n){return uK(r,e)+cK(r,t)+fK(r,n)}function dK(r,e){const t=1-r;return t*t*t*e}function hK(r,e){const t=1-r;return 3*t*t*r*e}function pK(r,e){return 3*(1-r)*r*r*e}function mK(r,e){return r*r*r*e}function CT(r,e,t,n,i){return dK(r,e)+hK(r,t)+pK(r,n)+mK(r,i)}class pL extends af{constructor(e=new tt,t=new tt,n=new tt,i=new tt){super(),this.isCubicBezierCurve=!0,this.type="CubicBezierCurve",this.v0=e,this.v1=t,this.v2=n,this.v3=i}getPoint(e,t=new tt){const n=t,i=this.v0,s=this.v1,a=this.v2,o=this.v3;return n.set(CT(e,i.x,s.x,a.x,o.x),CT(e,i.y,s.y,a.y,o.y)),n}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this.v3.copy(e.v3),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e.v3=this.v3.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this.v3.fromArray(e.v3),this}}class c6 extends af{constructor(e=new ne,t=new ne,n=new ne,i=new ne){super(),this.isCubicBezierCurve3=!0,this.type="CubicBezierCurve3",this.v0=e,this.v1=t,this.v2=n,this.v3=i}getPoint(e,t=new ne){const n=t,i=this.v0,s=this.v1,a=this.v2,o=this.v3;return n.set(CT(e,i.x,s.x,a.x,o.x),CT(e,i.y,s.y,a.y,o.y),CT(e,i.z,s.z,a.z,o.z)),n}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this.v3.copy(e.v3),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e.v3=this.v3.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this.v3.fromArray(e.v3),this}}class mL extends af{constructor(e=new tt,t=new tt){super(),this.isLineCurve=!0,this.type="LineCurve",this.v1=e,this.v2=t}getPoint(e,t=new tt){const n=t;return e===1?n.copy(this.v2):(n.copy(this.v2).sub(this.v1),n.multiplyScalar(e).add(this.v1)),n}getPointAt(e,t){return this.getPoint(e,t)}getTangent(e,t=new tt){return t.subVectors(this.v2,this.v1).normalize()}getTangentAt(e,t){return this.getTangent(e,t)}copy(e){return super.copy(e),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class f6 extends af{constructor(e=new ne,t=new ne){super(),this.isLineCurve3=!0,this.type="LineCurve3",this.v1=e,this.v2=t}getPoint(e,t=new ne){const n=t;return e===1?n.copy(this.v2):(n.copy(this.v2).sub(this.v1),n.multiplyScalar(e).add(this.v1)),n}getPointAt(e,t){return this.getPoint(e,t)}getTangent(e,t=new ne){return t.subVectors(this.v2,this.v1).normalize()}getTangentAt(e,t){return this.getTangent(e,t)}copy(e){return super.copy(e),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class gL extends af{constructor(e=new tt,t=new tt,n=new tt){super(),this.isQuadraticBezierCurve=!0,this.type="QuadraticBezierCurve",this.v0=e,this.v1=t,this.v2=n}getPoint(e,t=new tt){const n=t,i=this.v0,s=this.v1,a=this.v2;return n.set(RT(e,i.x,s.x,a.x),RT(e,i.y,s.y,a.y)),n}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class yL extends af{constructor(e=new ne,t=new ne,n=new ne){super(),this.isQuadraticBezierCurve3=!0,this.type="QuadraticBezierCurve3",this.v0=e,this.v1=t,this.v2=n}getPoint(e,t=new ne){const n=t,i=this.v0,s=this.v1,a=this.v2;return n.set(RT(e,i.x,s.x,a.x),RT(e,i.y,s.y,a.y),RT(e,i.z,s.z,a.z)),n}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){const e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}class _L extends af{constructor(e=[]){super(),this.isSplineCurve=!0,this.type="SplineCurve",this.points=e}getPoint(e,t=new tt){const n=t,i=this.points,s=(i.length-1)*e,a=Math.floor(s),o=s-a,l=i[a===0?a:a-1],c=i[a],d=i[a>i.length-2?i.length-1:a+1],p=i[a>i.length-3?i.length-1:a+2];return n.set(Tz(o,l.x,c.x,d.x,p.x),Tz(o,l.y,c.y,d.y,p.y)),n}copy(e){super.copy(e),this.points=[];for(let t=0,n=e.points.length;t<n;t++){const i=e.points[t];this.points.push(i.clone())}return this}toJSON(){const e=super.toJSON();e.points=[];for(let t=0,n=this.points.length;t<n;t++){const i=this.points[t];e.points.push(i.toArray())}return e}fromJSON(e){super.fromJSON(e),this.points=[];for(let t=0,n=e.points.length;t<n;t++){const i=e.points[t];this.points.push(new tt().fromArray(i))}return this}}var tR=Object.freeze({__proto__:null,ArcCurve:l6,CatmullRomCurve3:u6,CubicBezierCurve:pL,CubicBezierCurve3:c6,EllipseCurve:PC,LineCurve:mL,LineCurve3:f6,QuadraticBezierCurve:gL,QuadraticBezierCurve3:yL,SplineCurve:_L});class d6 extends af{constructor(){super(),this.type="CurvePath",this.curves=[],this.autoClose=!1}add(e){this.curves.push(e)}closePath(){const e=this.curves[0].getPoint(0),t=this.curves[this.curves.length-1].getPoint(1);if(!e.equals(t)){const n=e.isVector2===!0?"LineCurve":"LineCurve3";this.curves.push(new tR[n](t,e))}return this}getPoint(e,t){const n=e*this.getLength(),i=this.getCurveLengths();let s=0;for(;s<i.length;){if(i[s]>=n){const a=i[s]-n,o=this.curves[s],l=o.getLength(),c=l===0?0:1-a/l;return o.getPointAt(c,t)}s++}return null}getLength(){const e=this.getCurveLengths();return e[e.length-1]}updateArcLengths(){this.needsUpdate=!0,this.cacheLengths=null,this.getCurveLengths()}getCurveLengths(){if(this.cacheLengths&&this.cacheLengths.length===this.curves.length)return this.cacheLengths;const e=[];let t=0;for(let n=0,i=this.curves.length;n<i;n++)t+=this.curves[n].getLength(),e.push(t);return this.cacheLengths=e,e}getSpacedPoints(e=40){const t=[];for(let n=0;n<=e;n++)t.push(this.getPoint(n/e));return this.autoClose&&t.push(t[0]),t}getPoints(e=12){const t=[];let n;for(let i=0,s=this.curves;i<s.length;i++){const a=s[i],o=a.isEllipseCurve?e*2:a.isLineCurve||a.isLineCurve3?1:a.isSplineCurve?e*a.points.length:e,l=a.getPoints(o);for(let c=0;c<l.length;c++){const d=l[c];n&&n.equals(d)||(t.push(d),n=d)}}return this.autoClose&&t.length>1&&!t[t.length-1].equals(t[0])&&t.push(t[0]),t}copy(e){super.copy(e),this.curves=[];for(let t=0,n=e.curves.length;t<n;t++){const i=e.curves[t];this.curves.push(i.clone())}return this.autoClose=e.autoClose,this}toJSON(){const e=super.toJSON();e.autoClose=this.autoClose,e.curves=[];for(let t=0,n=this.curves.length;t<n;t++){const i=this.curves[t];e.curves.push(i.toJSON())}return e}fromJSON(e){super.fromJSON(e),this.autoClose=e.autoClose,this.curves=[];for(let t=0,n=e.curves.length;t<n;t++){const i=e.curves[t];this.curves.push(new tR[i.type]().fromJSON(i))}return this}}class nR extends d6{constructor(e){super(),this.type="Path",this.currentPoint=new tt,e&&this.setFromPoints(e)}setFromPoints(e){this.moveTo(e[0].x,e[0].y);for(let t=1,n=e.length;t<n;t++)this.lineTo(e[t].x,e[t].y);return this}moveTo(e,t){return this.currentPoint.set(e,t),this}lineTo(e,t){const n=new mL(this.currentPoint.clone(),new tt(e,t));return this.curves.push(n),this.currentPoint.set(e,t),this}quadraticCurveTo(e,t,n,i){const s=new gL(this.currentPoint.clone(),new tt(e,t),new tt(n,i));return this.curves.push(s),this.currentPoint.set(n,i),this}bezierCurveTo(e,t,n,i,s,a){const o=new pL(this.currentPoint.clone(),new tt(e,t),new tt(n,i),new tt(s,a));return this.curves.push(o),this.currentPoint.set(s,a),this}splineThru(e){const t=[this.currentPoint.clone()].concat(e),n=new _L(t);return this.curves.push(n),this.currentPoint.copy(e[e.length-1]),this}arc(e,t,n,i,s,a){const o=this.currentPoint.x,l=this.currentPoint.y;return this.absarc(e+o,t+l,n,i,s,a),this}absarc(e,t,n,i,s,a){return this.absellipse(e,t,n,n,i,s,a),this}ellipse(e,t,n,i,s,a,o,l){const c=this.currentPoint.x,d=this.currentPoint.y;return this.absellipse(e+c,t+d,n,i,s,a,o,l),this}absellipse(e,t,n,i,s,a,o,l){const c=new PC(e,t,n,i,s,a,o,l);if(this.curves.length>0){const p=c.getPoint(0);p.equals(this.currentPoint)||this.lineTo(p.x,p.y)}this.curves.push(c);const d=c.getPoint(1);return this.currentPoint.copy(d),this}copy(e){return super.copy(e),this.currentPoint.copy(e.currentPoint),this}toJSON(){const e=super.toJSON();return e.currentPoint=this.currentPoint.toArray(),e}fromJSON(e){return super.fromJSON(e),this.currentPoint.fromArray(e.currentPoint),this}}class R0 extends nR{constructor(e){super(e),this.uuid=pu(),this.type="Shape",this.holes=[]}getPointsHoles(e){const t=[];for(let n=0,i=this.holes.length;n<i;n++)t[n]=this.holes[n].getPoints(e);return t}extractPoints(e){return{shape:this.getPoints(e),holes:this.getPointsHoles(e)}}copy(e){super.copy(e),this.holes=[];for(let t=0,n=e.holes.length;t<n;t++){const i=e.holes[t];this.holes.push(i.clone())}return this}toJSON(){const e=super.toJSON();e.uuid=this.uuid,e.holes=[];for(let t=0,n=this.holes.length;t<n;t++){const i=this.holes[t];e.holes.push(i.toJSON())}return e}fromJSON(e){super.fromJSON(e),this.uuid=e.uuid,this.holes=[];for(let t=0,n=e.holes.length;t<n;t++){const i=e.holes[t];this.holes.push(new nR().fromJSON(i))}return this}}function gK(r,e,t=2){const n=e&&e.length,i=n?e[0]*t:r.length;let s=h6(r,0,i,t,!0);const a=[];if(!s||s.next===s.prev)return a;let o,l,c;if(n&&(s=bK(r,e,s,t)),r.length>80*t){o=r[0],l=r[1];let d=o,p=l;for(let y=t;y<i;y+=t){const _=r[y],v=r[y+1];_<o&&(o=_),v<l&&(l=v),_>d&&(d=_),v>p&&(p=v)}c=Math.max(d-o,p-l),c=c!==0?32767/c:0}return r1(s,a,t,o,l,c,0),a}function h6(r,e,t,n,i){let s;if(i===OK(r,e,t,n)>0)for(let a=e;a<t;a+=n)s=Ez(a/n|0,r[a],r[a+1],s);else for(let a=t-n;a>=e;a-=n)s=Ez(a/n|0,r[a],r[a+1],s);return s&&vx(s,s.next)&&(a1(s),s=s.next),s}function my(r,e){if(!r)return r;e||(e=r);let t=r,n;do if(n=!1,!t.steiner&&(vx(t,t.next)||us(t.prev,t,t.next)===0)){if(a1(t),t=e=t.prev,t===t.next)break;n=!0}else t=t.next;while(n||t!==e);return e}function r1(r,e,t,n,i,s,a){if(!r)return;!a&&s&&AK(r,n,i,s);let o=r;for(;r.prev!==r.next;){const l=r.prev,c=r.next;if(s?_K(r,n,i,s):yK(r)){e.push(l.i,r.i,c.i),a1(r),r=c.next,o=c.next;continue}if(r=c,r===o){a?a===1?(r=vK(my(r),e),r1(r,e,t,n,i,s,2)):a===2&&xK(r,e,t,n,i,s):r1(my(r),e,t,n,i,s,1);break}}}function yK(r){const e=r.prev,t=r,n=r.next;if(us(e,t,n)>=0)return!1;const i=e.x,s=t.x,a=n.x,o=e.y,l=t.y,c=n.y,d=Math.min(i,s,a),p=Math.min(o,l,c),y=Math.max(i,s,a),_=Math.max(o,l,c);let v=n.next;for(;v!==e;){if(v.x>=d&&v.x<=y&&v.y>=p&&v.y<=_&&dT(i,o,s,l,a,c,v.x,v.y)&&us(v.prev,v,v.next)>=0)return!1;v=v.next}return!0}function _K(r,e,t,n){const i=r.prev,s=r,a=r.next;if(us(i,s,a)>=0)return!1;const o=i.x,l=s.x,c=a.x,d=i.y,p=s.y,y=a.y,_=Math.min(o,l,c),v=Math.min(d,p,y),b=Math.max(o,l,c),E=Math.max(d,p,y),T=fO(_,v,e,t,n),M=fO(b,E,e,t,n);let R=r.prevZ,N=r.nextZ;for(;R&&R.z>=T&&N&&N.z<=M;){if(R.x>=_&&R.x<=b&&R.y>=v&&R.y<=E&&R!==i&&R!==a&&dT(o,d,l,p,c,y,R.x,R.y)&&us(R.prev,R,R.next)>=0||(R=R.prevZ,N.x>=_&&N.x<=b&&N.y>=v&&N.y<=E&&N!==i&&N!==a&&dT(o,d,l,p,c,y,N.x,N.y)&&us(N.prev,N,N.next)>=0))return!1;N=N.nextZ}for(;R&&R.z>=T;){if(R.x>=_&&R.x<=b&&R.y>=v&&R.y<=E&&R!==i&&R!==a&&dT(o,d,l,p,c,y,R.x,R.y)&&us(R.prev,R,R.next)>=0)return!1;R=R.prevZ}for(;N&&N.z<=M;){if(N.x>=_&&N.x<=b&&N.y>=v&&N.y<=E&&N!==i&&N!==a&&dT(o,d,l,p,c,y,N.x,N.y)&&us(N.prev,N,N.next)>=0)return!1;N=N.nextZ}return!0}function vK(r,e){let t=r;do{const n=t.prev,i=t.next.next;!vx(n,i)&&m6(n,t,t.next,i)&&s1(n,i)&&s1(i,n)&&(e.push(n.i,t.i,i.i),a1(t),a1(t.next),t=r=i),t=t.next}while(t!==r);return my(t)}function xK(r,e,t,n,i,s){let a=r;do{let o=a.next.next;for(;o!==a.prev;){if(a.i!==o.i&&CK(a,o)){let l=g6(a,o);a=my(a,a.next),l=my(l,l.next),r1(a,e,t,n,i,s,0),r1(l,e,t,n,i,s,0);return}o=o.next}a=a.next}while(a!==r)}function bK(r,e,t,n){const i=[];for(let s=0,a=e.length;s<a;s++){const o=e[s]*n,l=s<a-1?e[s+1]*n:r.length,c=h6(r,o,l,n,!1);c===c.next&&(c.steiner=!0),i.push(RK(c))}i.sort(SK);for(let s=0;s<i.length;s++)t=TK(i[s],t);return t}function SK(r,e){let t=r.x-e.x;if(t===0&&(t=r.y-e.y,t===0)){const n=(r.next.y-r.y)/(r.next.x-r.x),i=(e.next.y-e.y)/(e.next.x-e.x);t=n-i}return t}function TK(r,e){const t=EK(r,e);if(!t)return e;const n=g6(t,r);return my(n,n.next),my(t,t.next)}function EK(r,e){let t=e;const n=r.x,i=r.y;let s=-1/0,a;if(vx(r,t))return t;do{if(vx(r,t.next))return t.next;if(i<=t.y&&i>=t.next.y&&t.next.y!==t.y){const p=t.x+(i-t.y)*(t.next.x-t.x)/(t.next.y-t.y);if(p<=n&&p>s&&(s=p,a=t.x<t.next.x?t:t.next,p===n))return a}t=t.next}while(t!==e);if(!a)return null;const o=a,l=a.x,c=a.y;let d=1/0;t=a;do{if(n>=t.x&&t.x>=l&&n!==t.x&&p6(i<c?n:s,i,l,c,i<c?s:n,i,t.x,t.y)){const p=Math.abs(i-t.y)/(n-t.x);s1(t,r)&&(p<d||p===d&&(t.x>a.x||t.x===a.x&&MK(a,t)))&&(a=t,d=p)}t=t.next}while(t!==o);return a}function MK(r,e){return us(r.prev,r,e.prev)<0&&us(e.next,r,r.next)<0}function AK(r,e,t,n){let i=r;do i.z===0&&(i.z=fO(i.x,i.y,e,t,n)),i.prevZ=i.prev,i.nextZ=i.next,i=i.next;while(i!==r);i.prevZ.nextZ=null,i.prevZ=null,wK(i)}function wK(r){let e,t=1;do{let n=r,i;r=null;let s=null;for(e=0;n;){e++;let a=n,o=0;for(let c=0;c<t&&(o++,a=a.nextZ,!!a);c++);let l=t;for(;o>0||l>0&&a;)o!==0&&(l===0||!a||n.z<=a.z)?(i=n,n=n.nextZ,o--):(i=a,a=a.nextZ,l--),s?s.nextZ=i:r=i,i.prevZ=s,s=i;n=a}s.nextZ=null,t*=2}while(e>1);return r}function fO(r,e,t,n,i){return r=(r-t)*i|0,e=(e-n)*i|0,r=(r|r<<8)&16711935,r=(r|r<<4)&252645135,r=(r|r<<2)&858993459,r=(r|r<<1)&1431655765,e=(e|e<<8)&16711935,e=(e|e<<4)&252645135,e=(e|e<<2)&858993459,e=(e|e<<1)&1431655765,r|e<<1}function RK(r){let e=r,t=r;do(e.x<t.x||e.x===t.x&&e.y<t.y)&&(t=e),e=e.next;while(e!==r);return t}function p6(r,e,t,n,i,s,a,o){return(i-a)*(e-o)>=(r-a)*(s-o)&&(r-a)*(n-o)>=(t-a)*(e-o)&&(t-a)*(s-o)>=(i-a)*(n-o)}function dT(r,e,t,n,i,s,a,o){return!(r===a&&e===o)&&p6(r,e,t,n,i,s,a,o)}function CK(r,e){return r.next.i!==e.i&&r.prev.i!==e.i&&!NK(r,e)&&(s1(r,e)&&s1(e,r)&&DK(r,e)&&(us(r.prev,r,e.prev)||us(r,e.prev,e))||vx(r,e)&&us(r.prev,r,r.next)>0&&us(e.prev,e,e.next)>0)}function us(r,e,t){return(e.y-r.y)*(t.x-e.x)-(e.x-r.x)*(t.y-e.y)}function vx(r,e){return r.x===e.x&&r.y===e.y}function m6(r,e,t,n){const i=vA(us(r,e,t)),s=vA(us(r,e,n)),a=vA(us(t,n,r)),o=vA(us(t,n,e));return!!(i!==s&&a!==o||i===0&&_A(r,t,e)||s===0&&_A(r,n,e)||a===0&&_A(t,r,n)||o===0&&_A(t,e,n))}function _A(r,e,t){return e.x<=Math.max(r.x,t.x)&&e.x>=Math.min(r.x,t.x)&&e.y<=Math.max(r.y,t.y)&&e.y>=Math.min(r.y,t.y)}function vA(r){return r>0?1:r<0?-1:0}function NK(r,e){let t=r;do{if(t.i!==r.i&&t.next.i!==r.i&&t.i!==e.i&&t.next.i!==e.i&&m6(t,t.next,r,e))return!0;t=t.next}while(t!==r);return!1}function s1(r,e){return us(r.prev,r,r.next)<0?us(r,e,r.next)>=0&&us(r,r.prev,e)>=0:us(r,e,r.prev)<0||us(r,r.next,e)<0}function DK(r,e){let t=r,n=!1;const i=(r.x+e.x)/2,s=(r.y+e.y)/2;do t.y>s!=t.next.y>s&&t.next.y!==t.y&&i<(t.next.x-t.x)*(s-t.y)/(t.next.y-t.y)+t.x&&(n=!n),t=t.next;while(t!==r);return n}function g6(r,e){const t=dO(r.i,r.x,r.y),n=dO(e.i,e.x,e.y),i=r.next,s=e.prev;return r.next=e,e.prev=r,t.next=i,i.prev=t,n.next=t,t.prev=n,s.next=n,n.prev=s,n}function Ez(r,e,t,n){const i=dO(r,e,t);return n?(i.next=n.next,i.prev=n,n.next.prev=i,n.next=i):(i.prev=i,i.next=i),i}function a1(r){r.next.prev=r.prev,r.prev.next=r.next,r.prevZ&&(r.prevZ.nextZ=r.nextZ),r.nextZ&&(r.nextZ.prevZ=r.prevZ)}function dO(r,e,t){return{i:r,x:e,y:t,prev:null,next:null,z:0,prevZ:null,nextZ:null,steiner:!1}}function OK(r,e,t,n){let i=0;for(let s=e,a=t-n;s<t;s+=n)i+=(r[a]-r[s])*(r[s+1]+r[a+1]),a=s;return i}class UK{static triangulate(e,t,n=2){return gK(e,t,n)}}class Zc{static area(e){const t=e.length;let n=0;for(let i=t-1,s=0;s<t;i=s++)n+=e[i].x*e[s].y-e[s].x*e[i].y;return n*.5}static isClockWise(e){return Zc.area(e)<0}static triangulateShape(e,t){const n=[],i=[],s=[];Mz(e),Az(n,e);let a=e.length;t.forEach(Mz);for(let l=0;l<t.length;l++)i.push(a),a+=t[l].length,Az(n,t[l]);const o=UK.triangulate(n,i);for(let l=0;l<o.length;l+=3)s.push(o.slice(l,l+3));return s}}function Mz(r){const e=r.length;e>2&&r[e-1].equals(r[0])&&r.pop()}function Az(r,e){for(let t=0;t<e.length;t++)r.push(e[t].x),r.push(e[t].y)}class BC extends Qn{constructor(e=new R0([new tt(.5,.5),new tt(-.5,.5),new tt(-.5,-.5),new tt(.5,-.5)]),t={}){super(),this.type="ExtrudeGeometry",this.parameters={shapes:e,options:t},e=Array.isArray(e)?e:[e];const n=this,i=[],s=[];for(let o=0,l=e.length;o<l;o++){const c=e[o];a(c)}this.setAttribute("position",new hn(i,3)),this.setAttribute("uv",new hn(s,2)),this.computeVertexNormals();function a(o){const l=[],c=t.curveSegments!==void 0?t.curveSegments:12,d=t.steps!==void 0?t.steps:1,p=t.depth!==void 0?t.depth:1;let y=t.bevelEnabled!==void 0?t.bevelEnabled:!0,_=t.bevelThickness!==void 0?t.bevelThickness:.2,v=t.bevelSize!==void 0?t.bevelSize:_-.1,b=t.bevelOffset!==void 0?t.bevelOffset:0,E=t.bevelSegments!==void 0?t.bevelSegments:3;const T=t.extrudePath,M=t.UVGenerator!==void 0?t.UVGenerator:LK;let R,N=!1,P,U,L,F;if(T){R=T.getSpacedPoints(d),N=!0,y=!1;const qe=T.isCatmullRomCurve3?T.closed:!1;P=T.computeFrenetFrames(d,qe),U=new ne,L=new ne,F=new ne}y||(E=0,_=0,v=0,b=0);const O=o.extractPoints(c);let B=O.shape;const q=O.holes;if(!Zc.isClockWise(B)){B=B.reverse();for(let qe=0,at=q.length;qe<at;qe++){const Je=q[qe];Zc.isClockWise(Je)&&(q[qe]=Je.reverse())}}function Q(qe){const Je=10000000000000001e-36;let xe=qe[0];for(let oe=1;oe<=qe.length;oe++){const Qt=oe%qe.length,Dt=qe[Qt],zt=Dt.x-xe.x,wt=Dt.y-xe.y,Z=zt*zt+wt*wt,k=Math.max(Math.abs(Dt.x),Math.abs(Dt.y),Math.abs(xe.x),Math.abs(xe.y)),pe=Je*k*k;if(Z<=pe){qe.splice(Qt,1),oe--;continue}xe=Dt}}Q(B),q.forEach(Q);const se=q.length,ae=B;for(let qe=0;qe<se;qe++){const at=q[qe];B=B.concat(at)}function V(qe,at,Je){return at||Ze("ExtrudeGeometry: vec does not exist"),qe.clone().addScaledVector(at,Je)}const X=B.length;function ee(qe,at,Je){let xe,oe,Qt;const Dt=qe.x-at.x,zt=qe.y-at.y,wt=Je.x-qe.x,Z=Je.y-qe.y,k=Dt*Dt+zt*zt,pe=Dt*Z-zt*wt;if(Math.abs(pe)>Number.EPSILON){const Fe=Math.sqrt(k),He=Math.sqrt(wt*wt+Z*Z),ze=at.x-zt/Fe,Bt=at.y+Dt/Fe,Ct=Je.x-Z/He,Yt=Je.y+wt/He,$t=((Ct-ze)*Z-(Yt-Bt)*wt)/(Dt*Z-zt*wt);xe=ze+Dt*$t-qe.x,oe=Bt+zt*$t-qe.y;const st=xe*xe+oe*oe;if(st<=2)return new tt(xe,oe);Qt=Math.sqrt(st/2)}else{let Fe=!1;Dt>Number.EPSILON?wt>Number.EPSILON&&(Fe=!0):Dt<-Number.EPSILON?wt<-Number.EPSILON&&(Fe=!0):Math.sign(zt)===Math.sign(Z)&&(Fe=!0),Fe?(xe=-zt,oe=Dt,Qt=Math.sqrt(k)):(xe=Dt,oe=zt,Qt=Math.sqrt(k/2))}return new tt(xe/Qt,oe/Qt)}const fe=[];for(let qe=0,at=ae.length,Je=at-1,xe=qe+1;qe<at;qe++,Je++,xe++)Je===at&&(Je=0),xe===at&&(xe=0),fe[qe]=ee(ae[qe],ae[Je],ae[xe]);const Y=[];let K,he=fe.concat();for(let qe=0,at=se;qe<at;qe++){const Je=q[qe];K=[];for(let xe=0,oe=Je.length,Qt=oe-1,Dt=xe+1;xe<oe;xe++,Qt++,Dt++)Qt===oe&&(Qt=0),Dt===oe&&(Dt=0),K[xe]=ee(Je[xe],Je[Qt],Je[Dt]);Y.push(K),he=he.concat(K)}let Ce;if(E===0)Ce=Zc.triangulateShape(ae,q);else{const qe=[],at=[];for(let Je=0;Je<E;Je++){const xe=Je/E,oe=_*Math.cos(xe*Math.PI/2),Qt=v*Math.sin(xe*Math.PI/2)+b;for(let Dt=0,zt=ae.length;Dt<zt;Dt++){const wt=V(ae[Dt],fe[Dt],Qt);Nt(wt.x,wt.y,-oe),xe===0&&qe.push(wt)}for(let Dt=0,zt=se;Dt<zt;Dt++){const wt=q[Dt];K=Y[Dt];const Z=[];for(let k=0,pe=wt.length;k<pe;k++){const Fe=V(wt[k],K[k],Qt);Nt(Fe.x,Fe.y,-oe),xe===0&&Z.push(Fe)}xe===0&&at.push(Z)}}Ce=Zc.triangulateShape(qe,at)}const Ie=Ce.length,ut=v+b;for(let qe=0;qe<X;qe++){const at=y?V(B[qe],he[qe],ut):B[qe];N?(L.copy(P.normals[0]).multiplyScalar(at.x),U.copy(P.binormals[0]).multiplyScalar(at.y),F.copy(R[0]).add(L).add(U),Nt(F.x,F.y,F.z)):Nt(at.x,at.y,0)}for(let qe=1;qe<=d;qe++)for(let at=0;at<X;at++){const Je=y?V(B[at],he[at],ut):B[at];N?(L.copy(P.normals[qe]).multiplyScalar(Je.x),U.copy(P.binormals[qe]).multiplyScalar(Je.y),F.copy(R[qe]).add(L).add(U),Nt(F.x,F.y,F.z)):Nt(Je.x,Je.y,p/d*qe)}for(let qe=E-1;qe>=0;qe--){const at=qe/E,Je=_*Math.cos(at*Math.PI/2),xe=v*Math.sin(at*Math.PI/2)+b;for(let oe=0,Qt=ae.length;oe<Qt;oe++){const Dt=V(ae[oe],fe[oe],xe);Nt(Dt.x,Dt.y,p+Je)}for(let oe=0,Qt=q.length;oe<Qt;oe++){const Dt=q[oe];K=Y[oe];for(let zt=0,wt=Dt.length;zt<wt;zt++){const Z=V(Dt[zt],K[zt],xe);N?Nt(Z.x,Z.y+R[d-1].y,R[d-1].x+Je):Nt(Z.x,Z.y,p+Je)}}}Ee(),Ne();function Ee(){const qe=i.length/3;if(y){let at=0,Je=X*at;for(let xe=0;xe<Ie;xe++){const oe=Ce[xe];Ft(oe[2]+Je,oe[1]+Je,oe[0]+Je)}at=d+E*2,Je=X*at;for(let xe=0;xe<Ie;xe++){const oe=Ce[xe];Ft(oe[0]+Je,oe[1]+Je,oe[2]+Je)}}else{for(let at=0;at<Ie;at++){const Je=Ce[at];Ft(Je[2],Je[1],Je[0])}for(let at=0;at<Ie;at++){const Je=Ce[at];Ft(Je[0]+X*d,Je[1]+X*d,Je[2]+X*d)}}n.addGroup(qe,i.length/3-qe,0)}function Ne(){const qe=i.length/3;let at=0;rt(ae,at),at+=ae.length;for(let Je=0,xe=q.length;Je<xe;Je++){const oe=q[Je];rt(oe,at),at+=oe.length}n.addGroup(qe,i.length/3-qe,1)}function rt(qe,at){let Je=qe.length;for(;--Je>=0;){const xe=Je;let oe=Je-1;oe<0&&(oe=qe.length-1);for(let Qt=0,Dt=d+E*2;Qt<Dt;Qt++){const zt=X*Qt,wt=X*(Qt+1),Z=at+xe+zt,k=at+oe+zt,pe=at+oe+wt,Fe=at+xe+wt;fn(Z,k,pe,Fe)}}}function Nt(qe,at,Je){l.push(qe),l.push(at),l.push(Je)}function Ft(qe,at,Je){Sn(qe),Sn(at),Sn(Je);const xe=i.length/3,oe=M.generateTopUV(n,i,xe-3,xe-2,xe-1);At(oe[0]),At(oe[1]),At(oe[2])}function fn(qe,at,Je,xe){Sn(qe),Sn(at),Sn(xe),Sn(at),Sn(Je),Sn(xe);const oe=i.length/3,Qt=M.generateSideWallUV(n,i,oe-6,oe-3,oe-2,oe-1);At(Qt[0]),At(Qt[1]),At(Qt[3]),At(Qt[1]),At(Qt[2]),At(Qt[3])}function Sn(qe){i.push(l[qe*3+0]),i.push(l[qe*3+1]),i.push(l[qe*3+2])}function At(qe){s.push(qe.x),s.push(qe.y)}}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}toJSON(){const e=super.toJSON(),t=this.parameters.shapes,n=this.parameters.options;return PK(t,n,e)}static fromJSON(e,t){const n=[];for(let s=0,a=e.shapes.length;s<a;s++){const o=t[e.shapes[s]];n.push(o)}const i=e.options.extrudePath;return i!==void 0&&(e.options.extrudePath=new tR[i.type]().fromJSON(i)),new BC(n,e.options)}}const LK={generateTopUV:function(r,e,t,n,i){const s=e[t*3],a=e[t*3+1],o=e[n*3],l=e[n*3+1],c=e[i*3],d=e[i*3+1];return[new tt(s,a),new tt(o,l),new tt(c,d)]},generateSideWallUV:function(r,e,t,n,i,s){const a=e[t*3],o=e[t*3+1],l=e[t*3+2],c=e[n*3],d=e[n*3+1],p=e[n*3+2],y=e[i*3],_=e[i*3+1],v=e[i*3+2],b=e[s*3],E=e[s*3+1],T=e[s*3+2];return Math.abs(o-d)<Math.abs(a-c)?[new tt(a,1-l),new tt(c,1-p),new tt(y,1-v),new tt(b,1-T)]:[new tt(o,1-l),new tt(d,1-p),new tt(_,1-v),new tt(E,1-T)]}};function PK(r,e,t){if(t.shapes=[],Array.isArray(r))for(let n=0,i=r.length;n<i;n++){const s=r[n];t.shapes.push(s.uuid)}else t.shapes.push(r.uuid);return t.options=Object.assign({},e),e.extrudePath!==void 0&&(t.options.extrudePath=e.extrudePath.toJSON()),t}class X1 extends zm{constructor(e=1,t=0){const n=(1+Math.sqrt(5))/2,i=[-1,n,0,1,n,0,-1,-n,0,1,-n,0,0,-1,n,0,1,n,0,-1,-n,0,1,-n,n,0,-1,n,0,1,-n,0,-1,-n,0,1],s=[0,11,5,0,5,1,0,1,7,0,7,10,0,10,11,1,5,9,5,11,4,11,10,2,10,7,6,7,1,8,3,9,4,3,4,2,3,2,6,3,6,8,3,8,9,4,9,5,2,4,11,6,2,10,8,6,7,9,8,1];super(i,s,e,t),this.type="IcosahedronGeometry",this.parameters={radius:e,detail:t}}static fromJSON(e){return new X1(e.radius,e.detail)}}class IC extends Qn{constructor(e=[new tt(0,-.5),new tt(.5,0),new tt(0,.5)],t=12,n=0,i=Math.PI*2){super(),this.type="LatheGeometry",this.parameters={points:e,segments:t,phiStart:n,phiLength:i},t=Math.floor(t),i=Yn(i,0,Math.PI*2);const s=[],a=[],o=[],l=[],c=[],d=1/t,p=new ne,y=new tt,_=new ne,v=new ne,b=new ne;let E=0,T=0;for(let M=0;M<=e.length-1;M++)switch(M){case 0:E=e[M+1].x-e[M].x,T=e[M+1].y-e[M].y,_.x=T*1,_.y=-E,_.z=T*0,b.copy(_),_.normalize(),l.push(_.x,_.y,_.z);break;case e.length-1:l.push(b.x,b.y,b.z);break;default:E=e[M+1].x-e[M].x,T=e[M+1].y-e[M].y,_.x=T*1,_.y=-E,_.z=T*0,v.copy(_),_.x+=b.x,_.y+=b.y,_.z+=b.z,_.normalize(),l.push(_.x,_.y,_.z),b.copy(v)}for(let M=0;M<=t;M++){const R=n+M*d*i,N=Math.sin(R),P=Math.cos(R);for(let U=0;U<=e.length-1;U++){p.x=e[U].x*N,p.y=e[U].y,p.z=e[U].x*P,a.push(p.x,p.y,p.z),y.x=M/t,y.y=U/(e.length-1),o.push(y.x,y.y);const L=l[3*U+0]*N,F=l[3*U+1],O=l[3*U+0]*P;c.push(L,F,O)}}for(let M=0;M<t;M++)for(let R=0;R<e.length-1;R++){const N=R+M*e.length,P=N,U=N+e.length,L=N+e.length+1,F=N+1;s.push(P,U,F),s.push(L,F,U)}this.setIndex(s),this.setAttribute("position",new hn(a,3)),this.setAttribute("uv",new hn(o,2)),this.setAttribute("normal",new hn(c,3))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new IC(e.points,e.segments,e.phiStart,e.phiLength)}}class $1 extends zm{constructor(e=1,t=0){const n=[1,0,0,-1,0,0,0,1,0,0,-1,0,0,0,1,0,0,-1],i=[0,2,4,0,4,3,0,3,5,0,5,2,1,2,5,1,5,3,1,3,4,1,4,2];super(n,i,e,t),this.type="OctahedronGeometry",this.parameters={radius:e,detail:t}}static fromJSON(e){return new $1(e.radius,e.detail)}}class $h extends Qn{constructor(e=1,t=1,n=1,i=1){super(),this.type="PlaneGeometry",this.parameters={width:e,height:t,widthSegments:n,heightSegments:i};const s=e/2,a=t/2,o=Math.floor(n),l=Math.floor(i),c=o+1,d=l+1,p=e/o,y=t/l,_=[],v=[],b=[],E=[];for(let T=0;T<d;T++){const M=T*y-a;for(let R=0;R<c;R++){const N=R*p-s;v.push(N,-M,0),b.push(0,0,1),E.push(R/o),E.push(1-T/l)}}for(let T=0;T<l;T++)for(let M=0;M<o;M++){const R=M+c*T,N=M+c*(T+1),P=M+1+c*(T+1),U=M+1+c*T;_.push(R,N,U),_.push(N,P,U)}this.setIndex(_),this.setAttribute("position",new hn(v,3)),this.setAttribute("normal",new hn(b,3)),this.setAttribute("uv",new hn(E,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new $h(e.width,e.height,e.widthSegments,e.heightSegments)}}class FC extends Qn{constructor(e=.5,t=1,n=32,i=1,s=0,a=Math.PI*2){super(),this.type="RingGeometry",this.parameters={innerRadius:e,outerRadius:t,thetaSegments:n,phiSegments:i,thetaStart:s,thetaLength:a},n=Math.max(3,n),i=Math.max(1,i);const o=[],l=[],c=[],d=[];let p=e;const y=(t-e)/i,_=new ne,v=new tt;for(let b=0;b<=i;b++){for(let E=0;E<=n;E++){const T=s+E/n*a;_.x=p*Math.cos(T),_.y=p*Math.sin(T),l.push(_.x,_.y,_.z),c.push(0,0,1),v.x=(_.x/t+1)/2,v.y=(_.y/t+1)/2,d.push(v.x,v.y)}p+=y}for(let b=0;b<i;b++){const E=b*(n+1);for(let T=0;T<n;T++){const M=T+E,R=M,N=M+n+1,P=M+n+2,U=M+1;o.push(R,N,U),o.push(N,P,U)}}this.setIndex(o),this.setAttribute("position",new hn(l,3)),this.setAttribute("normal",new hn(c,3)),this.setAttribute("uv",new hn(d,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new FC(e.innerRadius,e.outerRadius,e.thetaSegments,e.phiSegments,e.thetaStart,e.thetaLength)}}class zC extends Qn{constructor(e=new R0([new tt(0,.5),new tt(-.5,-.5),new tt(.5,-.5)]),t=12){super(),this.type="ShapeGeometry",this.parameters={shapes:e,curveSegments:t};const n=[],i=[],s=[],a=[];let o=0,l=0;if(Array.isArray(e)===!1)c(e);else for(let d=0;d<e.length;d++)c(e[d]),this.addGroup(o,l,d),o+=l,l=0;this.setIndex(n),this.setAttribute("position",new hn(i,3)),this.setAttribute("normal",new hn(s,3)),this.setAttribute("uv",new hn(a,2));function c(d){const p=i.length/3,y=d.extractPoints(t);let _=y.shape;const v=y.holes;Zc.isClockWise(_)===!1&&(_=_.reverse());for(let E=0,T=v.length;E<T;E++){const M=v[E];Zc.isClockWise(M)===!0&&(v[E]=M.reverse())}const b=Zc.triangulateShape(_,v);for(let E=0,T=v.length;E<T;E++){const M=v[E];_=_.concat(M)}for(let E=0,T=_.length;E<T;E++){const M=_[E];i.push(M.x,M.y,0),s.push(0,0,1),a.push(M.x,M.y)}for(let E=0,T=b.length;E<T;E++){const M=b[E],R=M[0]+p,N=M[1]+p,P=M[2]+p;n.push(R,N,P),l+=3}}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}toJSON(){const e=super.toJSON(),t=this.parameters.shapes;return BK(t,e)}static fromJSON(e,t){const n=[];for(let i=0,s=e.shapes.length;i<s;i++){const a=t[e.shapes[i]];n.push(a)}return new zC(n,e.curveSegments)}}function BK(r,e){if(e.shapes=[],Array.isArray(r))for(let t=0,n=r.length;t<n;t++){const i=r[t];e.shapes.push(i.uuid)}else e.shapes.push(r.uuid);return e}class Hx extends Qn{constructor(e=1,t=32,n=16,i=0,s=Math.PI*2,a=0,o=Math.PI){super(),this.type="SphereGeometry",this.parameters={radius:e,widthSegments:t,heightSegments:n,phiStart:i,phiLength:s,thetaStart:a,thetaLength:o},t=Math.max(3,Math.floor(t)),n=Math.max(2,Math.floor(n));const l=Math.min(a+o,Math.PI);let c=0;const d=[],p=new ne,y=new ne,_=[],v=[],b=[],E=[];for(let T=0;T<=n;T++){const M=[],R=T/n;let N=0;T===0&&a===0?N=.5/t:T===n&&l===Math.PI&&(N=-.5/t);for(let P=0;P<=t;P++){const U=P/t;p.x=-e*Math.cos(i+U*s)*Math.sin(a+R*o),p.y=e*Math.cos(a+R*o),p.z=e*Math.sin(i+U*s)*Math.sin(a+R*o),v.push(p.x,p.y,p.z),y.copy(p).normalize(),b.push(y.x,y.y,y.z),E.push(U+N,1-R),M.push(c++)}d.push(M)}for(let T=0;T<n;T++)for(let M=0;M<t;M++){const R=d[T][M+1],N=d[T][M],P=d[T+1][M],U=d[T+1][M+1];(T!==0||a>0)&&_.push(R,N,U),(T!==n-1||l<Math.PI)&&_.push(N,P,U)}this.setIndex(_),this.setAttribute("position",new hn(v,3)),this.setAttribute("normal",new hn(b,3)),this.setAttribute("uv",new hn(E,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new Hx(e.radius,e.widthSegments,e.heightSegments,e.phiStart,e.phiLength,e.thetaStart,e.thetaLength)}}class VC extends zm{constructor(e=1,t=0){const n=[1,1,1,-1,-1,1,-1,1,-1,1,-1,-1],i=[2,1,0,0,3,2,1,3,0,2,3,1];super(n,i,e,t),this.type="TetrahedronGeometry",this.parameters={radius:e,detail:t}}static fromJSON(e){return new VC(e.radius,e.detail)}}class GC extends Qn{constructor(e=1,t=.4,n=12,i=48,s=Math.PI*2){super(),this.type="TorusGeometry",this.parameters={radius:e,tube:t,radialSegments:n,tubularSegments:i,arc:s},n=Math.floor(n),i=Math.floor(i);const a=[],o=[],l=[],c=[],d=new ne,p=new ne,y=new ne;for(let _=0;_<=n;_++)for(let v=0;v<=i;v++){const b=v/i*s,E=_/n*Math.PI*2;p.x=(e+t*Math.cos(E))*Math.cos(b),p.y=(e+t*Math.cos(E))*Math.sin(b),p.z=t*Math.sin(E),o.push(p.x,p.y,p.z),d.x=e*Math.cos(b),d.y=e*Math.sin(b),y.subVectors(p,d).normalize(),l.push(y.x,y.y,y.z),c.push(v/i),c.push(_/n)}for(let _=1;_<=n;_++)for(let v=1;v<=i;v++){const b=(i+1)*_+v-1,E=(i+1)*(_-1)+v-1,T=(i+1)*(_-1)+v,M=(i+1)*_+v;a.push(b,E,M),a.push(E,T,M)}this.setIndex(a),this.setAttribute("position",new hn(o,3)),this.setAttribute("normal",new hn(l,3)),this.setAttribute("uv",new hn(c,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new GC(e.radius,e.tube,e.radialSegments,e.tubularSegments,e.arc)}}class kC extends Qn{constructor(e=1,t=.4,n=64,i=8,s=2,a=3){super(),this.type="TorusKnotGeometry",this.parameters={radius:e,tube:t,tubularSegments:n,radialSegments:i,p:s,q:a},n=Math.floor(n),i=Math.floor(i);const o=[],l=[],c=[],d=[],p=new ne,y=new ne,_=new ne,v=new ne,b=new ne,E=new ne,T=new ne;for(let R=0;R<=n;++R){const N=R/n*s*Math.PI*2;M(N,s,a,e,_),M(N+.01,s,a,e,v),E.subVectors(v,_),T.addVectors(v,_),b.crossVectors(E,T),T.crossVectors(b,E),b.normalize(),T.normalize();for(let P=0;P<=i;++P){const U=P/i*Math.PI*2,L=-t*Math.cos(U),F=t*Math.sin(U);p.x=_.x+(L*T.x+F*b.x),p.y=_.y+(L*T.y+F*b.y),p.z=_.z+(L*T.z+F*b.z),l.push(p.x,p.y,p.z),y.subVectors(p,_).normalize(),c.push(y.x,y.y,y.z),d.push(R/n),d.push(P/i)}}for(let R=1;R<=n;R++)for(let N=1;N<=i;N++){const P=(i+1)*(R-1)+(N-1),U=(i+1)*R+(N-1),L=(i+1)*R+N,F=(i+1)*(R-1)+N;o.push(P,U,F),o.push(U,L,F)}this.setIndex(o),this.setAttribute("position",new hn(l,3)),this.setAttribute("normal",new hn(c,3)),this.setAttribute("uv",new hn(d,2));function M(R,N,P,U,L){const F=Math.cos(R),O=Math.sin(R),B=P/N*R,q=Math.cos(B);L.x=U*(2+q)*.5*F,L.y=U*(2+q)*O*.5,L.z=U*Math.sin(B)*.5}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}static fromJSON(e){return new kC(e.radius,e.tube,e.tubularSegments,e.radialSegments,e.p,e.q)}}class HC extends Qn{constructor(e=new yL(new ne(-1,-1,0),new ne(-1,1,0),new ne(1,1,0)),t=64,n=1,i=8,s=!1){super(),this.type="TubeGeometry",this.parameters={path:e,tubularSegments:t,radius:n,radialSegments:i,closed:s};const a=e.computeFrenetFrames(t,s);this.tangents=a.tangents,this.normals=a.normals,this.binormals=a.binormals;const o=new ne,l=new ne,c=new tt;let d=new ne;const p=[],y=[],_=[],v=[];b(),this.setIndex(v),this.setAttribute("position",new hn(p,3)),this.setAttribute("normal",new hn(y,3)),this.setAttribute("uv",new hn(_,2));function b(){for(let R=0;R<t;R++)E(R);E(s===!1?t:0),M(),T()}function E(R){d=e.getPointAt(R/t,d);const N=a.normals[R],P=a.binormals[R];for(let U=0;U<=i;U++){const L=U/i*Math.PI*2,F=Math.sin(L),O=-Math.cos(L);l.x=O*N.x+F*P.x,l.y=O*N.y+F*P.y,l.z=O*N.z+F*P.z,l.normalize(),y.push(l.x,l.y,l.z),o.x=d.x+n*l.x,o.y=d.y+n*l.y,o.z=d.z+n*l.z,p.push(o.x,o.y,o.z)}}function T(){for(let R=1;R<=t;R++)for(let N=1;N<=i;N++){const P=(i+1)*(R-1)+(N-1),U=(i+1)*R+(N-1),L=(i+1)*R+N,F=(i+1)*(R-1)+N;v.push(P,U,F),v.push(U,L,F)}}function M(){for(let R=0;R<=t;R++)for(let N=0;N<=i;N++)c.x=R/t,c.y=N/i,_.push(c.x,c.y)}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}toJSON(){const e=super.toJSON();return e.path=this.parameters.path.toJSON(),e}static fromJSON(e){return new HC(new tR[e.path.type]().fromJSON(e.path),e.tubularSegments,e.radius,e.radialSegments,e.closed)}}class y6 extends Qn{constructor(e=null){if(super(),this.type="WireframeGeometry",this.parameters={geometry:e},e!==null){const t=[],n=new Set,i=new ne,s=new ne;if(e.index!==null){const a=e.attributes.position,o=e.index;let l=e.groups;l.length===0&&(l=[{start:0,count:o.count,materialIndex:0}]);for(let c=0,d=l.length;c<d;++c){const p=l[c],y=p.start,_=p.count;for(let v=y,b=y+_;v<b;v+=3)for(let E=0;E<3;E++){const T=o.getX(v+E),M=o.getX(v+(E+1)%3);i.fromBufferAttribute(a,T),s.fromBufferAttribute(a,M),wz(i,s,n)===!0&&(t.push(i.x,i.y,i.z),t.push(s.x,s.y,s.z))}}}else{const a=e.attributes.position;for(let o=0,l=a.count/3;o<l;o++)for(let c=0;c<3;c++){const d=3*o+c,p=3*o+(c+1)%3;i.fromBufferAttribute(a,d),s.fromBufferAttribute(a,p),wz(i,s,n)===!0&&(t.push(i.x,i.y,i.z),t.push(s.x,s.y,s.z))}}this.setAttribute("position",new hn(t,3))}}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}}function wz(r,e,t){const n=`${r.x},${r.y},${r.z}-${e.x},${e.y},${e.z}`,i=`${e.x},${e.y},${e.z}-${r.x},${r.y},${r.z}`;return t.has(n)===!0||t.has(i)===!0?!1:(t.add(n),t.add(i),!0)}var Rz=Object.freeze({__proto__:null,BoxGeometry:Xh,CapsuleGeometry:OC,CircleGeometry:UC,ConeGeometry:q1,CylinderGeometry:kx,DodecahedronGeometry:LC,EdgesGeometry:o6,ExtrudeGeometry:BC,IcosahedronGeometry:X1,LatheGeometry:IC,OctahedronGeometry:$1,PlaneGeometry:$h,PolyhedronGeometry:zm,RingGeometry:FC,ShapeGeometry:zC,SphereGeometry:Hx,TetrahedronGeometry:VC,TorusGeometry:GC,TorusKnotGeometry:kC,TubeGeometry:HC,WireframeGeometry:y6});class vL extends Ta{constructor(e){super(),this.isShadowMaterial=!0,this.type="ShadowMaterial",this.color=new Kt(0),this.transparent=!0,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.fog=e.fog,this}}class xL extends ul{constructor(e){super(e),this.isRawShaderMaterial=!0,this.type="RawShaderMaterial"}}class WC extends Ta{constructor(e){super(),this.isMeshStandardMaterial=!0,this.type="MeshStandardMaterial",this.defines={STANDARD:""},this.color=new Kt(16777215),this.roughness=1,this.metalness=0,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Kt(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Kc,this.normalScale=new tt(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.roughnessMap=null,this.metalnessMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new ll,this.envMapIntensity=1,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.defines={STANDARD:""},this.color.copy(e.color),this.roughness=e.roughness,this.metalness=e.metalness,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.roughnessMap=e.roughnessMap,this.metalnessMap=e.metalnessMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapRotation.copy(e.envMapRotation),this.envMapIntensity=e.envMapIntensity,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}}class bL extends WC{constructor(e){super(),this.isMeshPhysicalMaterial=!0,this.defines={STANDARD:"",PHYSICAL:""},this.type="MeshPhysicalMaterial",this.anisotropyRotation=0,this.anisotropyMap=null,this.clearcoatMap=null,this.clearcoatRoughness=0,this.clearcoatRoughnessMap=null,this.clearcoatNormalScale=new tt(1,1),this.clearcoatNormalMap=null,this.ior=1.5,Object.defineProperty(this,"reflectivity",{get:function(){return Yn(2.5*(this.ior-1)/(this.ior+1),0,1)},set:function(t){this.ior=(1+.4*t)/(1-.4*t)}}),this.iridescenceMap=null,this.iridescenceIOR=1.3,this.iridescenceThicknessRange=[100,400],this.iridescenceThicknessMap=null,this.sheenColor=new Kt(0),this.sheenColorMap=null,this.sheenRoughness=1,this.sheenRoughnessMap=null,this.transmissionMap=null,this.thickness=0,this.thicknessMap=null,this.attenuationDistance=1/0,this.attenuationColor=new Kt(1,1,1),this.specularIntensity=1,this.specularIntensityMap=null,this.specularColor=new Kt(1,1,1),this.specularColorMap=null,this._anisotropy=0,this._clearcoat=0,this._dispersion=0,this._iridescence=0,this._sheen=0,this._transmission=0,this.setValues(e)}get anisotropy(){return this._anisotropy}set anisotropy(e){this._anisotropy>0!=e>0&&this.version++,this._anisotropy=e}get clearcoat(){return this._clearcoat}set clearcoat(e){this._clearcoat>0!=e>0&&this.version++,this._clearcoat=e}get iridescence(){return this._iridescence}set iridescence(e){this._iridescence>0!=e>0&&this.version++,this._iridescence=e}get dispersion(){return this._dispersion}set dispersion(e){this._dispersion>0!=e>0&&this.version++,this._dispersion=e}get sheen(){return this._sheen}set sheen(e){this._sheen>0!=e>0&&this.version++,this._sheen=e}get transmission(){return this._transmission}set transmission(e){this._transmission>0!=e>0&&this.version++,this._transmission=e}copy(e){return super.copy(e),this.defines={STANDARD:"",PHYSICAL:""},this.anisotropy=e.anisotropy,this.anisotropyRotation=e.anisotropyRotation,this.anisotropyMap=e.anisotropyMap,this.clearcoat=e.clearcoat,this.clearcoatMap=e.clearcoatMap,this.clearcoatRoughness=e.clearcoatRoughness,this.clearcoatRoughnessMap=e.clearcoatRoughnessMap,this.clearcoatNormalMap=e.clearcoatNormalMap,this.clearcoatNormalScale.copy(e.clearcoatNormalScale),this.dispersion=e.dispersion,this.ior=e.ior,this.iridescence=e.iridescence,this.iridescenceMap=e.iridescenceMap,this.iridescenceIOR=e.iridescenceIOR,this.iridescenceThicknessRange=[...e.iridescenceThicknessRange],this.iridescenceThicknessMap=e.iridescenceThicknessMap,this.sheen=e.sheen,this.sheenColor.copy(e.sheenColor),this.sheenColorMap=e.sheenColorMap,this.sheenRoughness=e.sheenRoughness,this.sheenRoughnessMap=e.sheenRoughnessMap,this.transmission=e.transmission,this.transmissionMap=e.transmissionMap,this.thickness=e.thickness,this.thicknessMap=e.thicknessMap,this.attenuationDistance=e.attenuationDistance,this.attenuationColor.copy(e.attenuationColor),this.specularIntensity=e.specularIntensity,this.specularIntensityMap=e.specularIntensityMap,this.specularColor.copy(e.specularColor),this.specularColorMap=e.specularColorMap,this}}class SL extends Ta{constructor(e){super(),this.isMeshPhongMaterial=!0,this.type="MeshPhongMaterial",this.color=new Kt(16777215),this.specular=new Kt(1118481),this.shininess=30,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Kt(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Kc,this.normalScale=new tt(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new ll,this.combine=Ix,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.specular.copy(e.specular),this.shininess=e.shininess,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapRotation.copy(e.envMapRotation),this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}}class TL extends Ta{constructor(e){super(),this.isMeshToonMaterial=!0,this.defines={TOON:""},this.type="MeshToonMaterial",this.color=new Kt(16777215),this.map=null,this.gradientMap=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Kt(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Kc,this.normalScale=new tt(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.gradientMap=e.gradientMap,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.alphaMap=e.alphaMap,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.fog=e.fog,this}}class EL extends Ta{constructor(e){super(),this.isMeshNormalMaterial=!0,this.type="MeshNormalMaterial",this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Kc,this.normalScale=new tt(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.flatShading=!1,this.setValues(e)}copy(e){return super.copy(e),this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.flatShading=e.flatShading,this}}class ML extends Ta{constructor(e){super(),this.isMeshLambertMaterial=!0,this.type="MeshLambertMaterial",this.color=new Kt(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Kt(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Kc,this.normalScale=new tt(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new ll,this.combine=Ix,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapRotation.copy(e.envMapRotation),this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}}class AL extends Ta{constructor(e){super(),this.isMeshDepthMaterial=!0,this.type="MeshDepthMaterial",this.depthPacking=Ok,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.setValues(e)}copy(e){return super.copy(e),this.depthPacking=e.depthPacking,this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this}}class wL extends Ta{constructor(e){super(),this.isMeshDistanceMaterial=!0,this.type="MeshDistanceMaterial",this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.setValues(e)}copy(e){return super.copy(e),this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this}}class RL extends Ta{constructor(e){super(),this.isMeshMatcapMaterial=!0,this.defines={MATCAP:""},this.type="MeshMatcapMaterial",this.color=new Kt(16777215),this.matcap=null,this.map=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Kc,this.normalScale=new tt(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.wireframe=!1,this.wireframeLinewidth=1,this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.defines={MATCAP:""},this.color.copy(e.color),this.matcap=e.matcap,this.map=e.map,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.alphaMap=e.alphaMap,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.flatShading=e.flatShading,this.fog=e.fog,this}}class CL extends bo{constructor(e){super(),this.isLineDashedMaterial=!0,this.type="LineDashedMaterial",this.scale=1,this.dashSize=3,this.gapSize=1,this.setValues(e)}copy(e){return super.copy(e),this.scale=e.scale,this.dashSize=e.dashSize,this.gapSize=e.gapSize,this}}function g0(r,e){return!r||r.constructor===e?r:typeof e.BYTES_PER_ELEMENT=="number"?new e(r):Array.prototype.slice.call(r)}function _6(r){function e(i,s){return r[i]-r[s]}const t=r.length,n=new Array(t);for(let i=0;i!==t;++i)n[i]=i;return n.sort(e),n}function hO(r,e,t){const n=r.length,i=new r.constructor(n);for(let s=0,a=0;a!==n;++s){const o=t[s]*e;for(let l=0;l!==e;++l)i[a++]=r[o+l]}return i}function NL(r,e,t,n){let i=1,s=r[0];for(;s!==void 0&&s[n]===void 0;)s=r[i++];if(s===void 0)return;let a=s[n];if(a!==void 0)if(Array.isArray(a))do a=s[n],a!==void 0&&(e.push(s.time),t.push(...a)),s=r[i++];while(s!==void 0);else if(a.toArray!==void 0)do a=s[n],a!==void 0&&(e.push(s.time),a.toArray(t,t.length)),s=r[i++];while(s!==void 0);else do a=s[n],a!==void 0&&(e.push(s.time),t.push(a)),s=r[i++];while(s!==void 0)}function IK(r,e,t,n,i=30){const s=r.clone();s.name=e;const a=[];for(let l=0;l<s.tracks.length;++l){const c=s.tracks[l],d=c.getValueSize(),p=[],y=[];for(let _=0;_<c.times.length;++_){const v=c.times[_]*i;if(!(v<t||v>=n)){p.push(c.times[_]);for(let b=0;b<d;++b)y.push(c.values[_*d+b])}}p.length!==0&&(c.times=g0(p,c.times.constructor),c.values=g0(y,c.values.constructor),a.push(c))}s.tracks=a;let o=1/0;for(let l=0;l<s.tracks.length;++l)o>s.tracks[l].times[0]&&(o=s.tracks[l].times[0]);for(let l=0;l<s.tracks.length;++l)s.tracks[l].shift(-1*o);return s.resetDuration(),s}function FK(r,e=0,t=r,n=30){n<=0&&(n=30);const i=t.tracks.length,s=e/n;for(let a=0;a<i;++a){const o=t.tracks[a],l=o.ValueTypeName;if(l==="bool"||l==="string")continue;const c=r.tracks.find(function(T){return T.name===o.name&&T.ValueTypeName===l});if(c===void 0)continue;let d=0;const p=o.getValueSize();o.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline&&(d=p/3);let y=0;const _=c.getValueSize();c.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline&&(y=_/3);const v=o.times.length-1;let b;if(s<=o.times[0]){const T=d,M=p-d;b=o.values.slice(T,M)}else if(s>=o.times[v]){const T=v*p+d,M=T+p-d;b=o.values.slice(T,M)}else{const T=o.createInterpolant(),M=d,R=p-d;T.evaluate(s),b=T.resultBuffer.slice(M,R)}l==="quaternion"&&new Va().fromArray(b).normalize().conjugate().toArray(b);const E=c.times.length;for(let T=0;T<E;++T){const M=T*_+y;if(l==="quaternion")Va.multiplyQuaternionsFlat(c.values,M,b,0,c.values,M);else{const R=_-y*2;for(let N=0;N<R;++N)c.values[M+N]-=b[N]}}}return r.blendMode=tL,r}class zK{static convertArray(e,t){return g0(e,t)}static isTypedArray(e){return mx(e)}static getKeyframeOrder(e){return _6(e)}static sortedArray(e,t,n){return hO(e,t,n)}static flattenJSON(e,t,n,i){NL(e,t,n,i)}static subclip(e,t,n,i,s=30){return IK(e,t,n,i,s)}static makeClipAdditive(e,t=0,n=e,i=30){return FK(e,t,n,i)}}class j1{constructor(e,t,n,i){this.parameterPositions=e,this._cachedIndex=0,this.resultBuffer=i!==void 0?i:new t.constructor(n),this.sampleValues=t,this.valueSize=n,this.settings=null,this.DefaultSettings_={}}evaluate(e){const t=this.parameterPositions;let n=this._cachedIndex,i=t[n],s=t[n-1];e:{t:{let a;n:{i:if(!(e<i)){for(let o=n+2;;){if(i===void 0){if(e<s)break i;return n=t.length,this._cachedIndex=n,this.copySampleValue_(n-1)}if(n===o)break;if(s=i,i=t[++n],e<i)break t}a=t.length;break n}if(!(e>=s)){const o=t[1];e<o&&(n=2,s=o);for(let l=n-2;;){if(s===void 0)return this._cachedIndex=0,this.copySampleValue_(0);if(n===l)break;if(i=s,s=t[--n-1],e>=s)break t}a=n,n=0;break n}break e}for(;n<a;){const o=n+a>>>1;e<t[o]?a=o:n=o+1}if(i=t[n],s=t[n-1],s===void 0)return this._cachedIndex=0,this.copySampleValue_(0);if(i===void 0)return n=t.length,this._cachedIndex=n,this.copySampleValue_(n-1)}this._cachedIndex=n,this.intervalChanged_(n,s,i)}return this.interpolate_(n,s,e,i)}getSettings_(){return this.settings||this.DefaultSettings_}copySampleValue_(e){const t=this.resultBuffer,n=this.sampleValues,i=this.valueSize,s=e*i;for(let a=0;a!==i;++a)t[a]=n[s+a];return t}interpolate_(){throw new Error("call to abstract method")}intervalChanged_(){}}class v6 extends j1{constructor(e,t,n,i){super(e,t,n,i),this._weightPrev=-0,this._offsetPrev=-0,this._weightNext=-0,this._offsetNext=-0,this.DefaultSettings_={endingStart:h0,endingEnd:h0}}intervalChanged_(e,t,n){const i=this.parameterPositions;let s=e-2,a=e+1,o=i[s],l=i[a];if(o===void 0)switch(this.getSettings_().endingStart){case p0:s=e,o=2*t-n;break;case n1:s=i.length-2,o=t+i[s]-i[s+1];break;default:s=e,o=n}if(l===void 0)switch(this.getSettings_().endingEnd){case p0:a=e,l=2*n-t;break;case n1:a=1,l=n+i[1]-i[0];break;default:a=e-1,l=t}const c=(n-t)*.5,d=this.valueSize;this._weightPrev=c/(t-o),this._weightNext=c/(l-n),this._offsetPrev=s*d,this._offsetNext=a*d}interpolate_(e,t,n,i){const s=this.resultBuffer,a=this.sampleValues,o=this.valueSize,l=e*o,c=l-o,d=this._offsetPrev,p=this._offsetNext,y=this._weightPrev,_=this._weightNext,v=(n-t)/(i-t),b=v*v,E=b*v,T=-y*E+2*y*b-y*v,M=(1+y)*E+(-1.5-2*y)*b+(-.5+y)*v+1,R=(-1-_)*E+(1.5+_)*b+.5*v,N=_*E-_*b;for(let P=0;P!==o;++P)s[P]=T*a[d+P]+M*a[c+P]+R*a[l+P]+N*a[p+P];return s}}class DL extends j1{constructor(e,t,n,i){super(e,t,n,i)}interpolate_(e,t,n,i){const s=this.resultBuffer,a=this.sampleValues,o=this.valueSize,l=e*o,c=l-o,d=(n-t)/(i-t),p=1-d;for(let y=0;y!==o;++y)s[y]=a[c+y]*p+a[l+y]*d;return s}}class x6 extends j1{constructor(e,t,n,i){super(e,t,n,i)}interpolate_(e){return this.copySampleValue_(e-1)}}class fc{constructor(e,t,n,i){if(e===void 0)throw new Error("THREE.KeyframeTrack: track name is undefined");if(t===void 0||t.length===0)throw new Error("THREE.KeyframeTrack: no keyframes in track named "+e);this.name=e,this.times=g0(t,this.TimeBufferType),this.values=g0(n,this.ValueBufferType),this.setInterpolation(i||this.DefaultInterpolation)}static toJSON(e){const t=e.constructor;let n;if(t.toJSON!==this.toJSON)n=t.toJSON(e);else{n={name:e.name,times:g0(e.times,Array),values:g0(e.values,Array)};const i=e.getInterpolation();i!==e.DefaultInterpolation&&(n.interpolation=i)}return n.type=e.ValueTypeName,n}InterpolantFactoryMethodDiscrete(e){return new x6(this.times,this.values,this.getValueSize(),e)}InterpolantFactoryMethodLinear(e){return new DL(this.times,this.values,this.getValueSize(),e)}InterpolantFactoryMethodSmooth(e){return new v6(this.times,this.values,this.getValueSize(),e)}setInterpolation(e){let t;switch(e){case t1:t=this.InterpolantFactoryMethodDiscrete;break;case Kw:t=this.InterpolantFactoryMethodLinear;break;case Ew:t=this.InterpolantFactoryMethodSmooth;break}if(t===void 0){const n="unsupported interpolation for "+this.ValueTypeName+" keyframe track named "+this.name;if(this.createInterpolant===void 0)if(e!==this.DefaultInterpolation)this.setInterpolation(this.DefaultInterpolation);else throw new Error(n);return Ve("KeyframeTrack:",n),this}return this.createInterpolant=t,this}getInterpolation(){switch(this.createInterpolant){case this.InterpolantFactoryMethodDiscrete:return t1;case this.InterpolantFactoryMethodLinear:return Kw;case this.InterpolantFactoryMethodSmooth:return Ew}}getValueSize(){return this.values.length/this.times.length}shift(e){if(e!==0){const t=this.times;for(let n=0,i=t.length;n!==i;++n)t[n]+=e}return this}scale(e){if(e!==1){const t=this.times;for(let n=0,i=t.length;n!==i;++n)t[n]*=e}return this}trim(e,t){const n=this.times,i=n.length;let s=0,a=i-1;for(;s!==i&&n[s]<e;)++s;for(;a!==-1&&n[a]>t;)--a;if(++a,s!==0||a!==i){s>=a&&(a=Math.max(a,1),s=a-1);const o=this.getValueSize();this.times=n.slice(s,a),this.values=this.values.slice(s*o,a*o)}return this}validate(){let e=!0;const t=this.getValueSize();t-Math.floor(t)!==0&&(Ze("KeyframeTrack: Invalid value size in track.",this),e=!1);const n=this.times,i=this.values,s=n.length;s===0&&(Ze("KeyframeTrack: Track is empty.",this),e=!1);let a=null;for(let o=0;o!==s;o++){const l=n[o];if(typeof l=="number"&&isNaN(l)){Ze("KeyframeTrack: Time is not a valid number.",this,o,l),e=!1;break}if(a!==null&&a>l){Ze("KeyframeTrack: Out of order keys.",this,o,l,a),e=!1;break}a=l}if(i!==void 0&&mx(i))for(let o=0,l=i.length;o!==l;++o){const c=i[o];if(isNaN(c)){Ze("KeyframeTrack: Value is not a valid number.",this,o,c),e=!1;break}}return e}optimize(){const e=this.times.slice(),t=this.values.slice(),n=this.getValueSize(),i=this.getInterpolation()===Ew,s=e.length-1;let a=1;for(let o=1;o<s;++o){let l=!1;const c=e[o],d=e[o+1];if(c!==d&&(o!==1||c!==e[0]))if(i)l=!0;else{const p=o*n,y=p-n,_=p+n;for(let v=0;v!==n;++v){const b=t[p+v];if(b!==t[y+v]||b!==t[_+v]){l=!0;break}}}if(l){if(o!==a){e[a]=e[o];const p=o*n,y=a*n;for(let _=0;_!==n;++_)t[y+_]=t[p+_]}++a}}if(s>0){e[a]=e[s];for(let o=s*n,l=a*n,c=0;c!==n;++c)t[l+c]=t[o+c];++a}return a!==e.length?(this.times=e.slice(0,a),this.values=t.slice(0,a*n)):(this.times=e,this.values=t),this}clone(){const e=this.times.slice(),t=this.values.slice(),n=this.constructor,i=new n(this.name,e,t);return i.createInterpolant=this.createInterpolant,i}}fc.prototype.ValueTypeName="";fc.prototype.TimeBufferType=Float32Array;fc.prototype.ValueBufferType=Float32Array;fc.prototype.DefaultInterpolation=Kw;class Cy extends fc{constructor(e,t,n){super(e,t,n)}}Cy.prototype.ValueTypeName="bool";Cy.prototype.ValueBufferType=Array;Cy.prototype.DefaultInterpolation=t1;Cy.prototype.InterpolantFactoryMethodLinear=void 0;Cy.prototype.InterpolantFactoryMethodSmooth=void 0;class OL extends fc{constructor(e,t,n,i){super(e,t,n,i)}}OL.prototype.ValueTypeName="color";class o1 extends fc{constructor(e,t,n,i){super(e,t,n,i)}}o1.prototype.ValueTypeName="number";class b6 extends j1{constructor(e,t,n,i){super(e,t,n,i)}interpolate_(e,t,n,i){const s=this.resultBuffer,a=this.sampleValues,o=this.valueSize,l=(n-t)/(i-t);let c=e*o;for(let d=c+o;c!==d;c+=4)Va.slerpFlat(s,0,a,c-o,a,c,l);return s}}class Y1 extends fc{constructor(e,t,n,i){super(e,t,n,i)}InterpolantFactoryMethodLinear(e){return new b6(this.times,this.values,this.getValueSize(),e)}}Y1.prototype.ValueTypeName="quaternion";Y1.prototype.InterpolantFactoryMethodSmooth=void 0;class Ny extends fc{constructor(e,t,n){super(e,t,n)}}Ny.prototype.ValueTypeName="string";Ny.prototype.ValueBufferType=Array;Ny.prototype.DefaultInterpolation=t1;Ny.prototype.InterpolantFactoryMethodLinear=void 0;Ny.prototype.InterpolantFactoryMethodSmooth=void 0;class l1 extends fc{constructor(e,t,n,i){super(e,t,n,i)}}l1.prototype.ValueTypeName="vector";class u1{constructor(e="",t=-1,n=[],i=gC){this.name=e,this.tracks=n,this.duration=t,this.blendMode=i,this.uuid=pu(),this.userData={},this.duration<0&&this.resetDuration()}static parse(e){const t=[],n=e.tracks,i=1/(e.fps||1);for(let a=0,o=n.length;a!==o;++a)t.push(GK(n[a]).scale(i));const s=new this(e.name,e.duration,t,e.blendMode);return s.uuid=e.uuid,s.userData=JSON.parse(e.userData||"{}"),s}static toJSON(e){const t=[],n=e.tracks,i={name:e.name,duration:e.duration,tracks:t,uuid:e.uuid,blendMode:e.blendMode,userData:JSON.stringify(e.userData)};for(let s=0,a=n.length;s!==a;++s)t.push(fc.toJSON(n[s]));return i}static CreateFromMorphTargetSequence(e,t,n,i){const s=t.length,a=[];for(let o=0;o<s;o++){let l=[],c=[];l.push((o+s-1)%s,o,(o+1)%s),c.push(0,1,0);const d=_6(l);l=hO(l,1,d),c=hO(c,1,d),!i&&l[0]===0&&(l.push(s),c.push(c[0])),a.push(new o1(".morphTargetInfluences["+t[o].name+"]",l,c).scale(1/n))}return new this(e,-1,a)}static findByName(e,t){let n=e;if(!Array.isArray(e)){const i=e;n=i.geometry&&i.geometry.animations||i.animations}for(let i=0;i<n.length;i++)if(n[i].name===t)return n[i];return null}static CreateClipsFromMorphTargetSequences(e,t,n){const i={},s=/^([\w-]*?)([\d]+)$/;for(let o=0,l=e.length;o<l;o++){const c=e[o],d=c.name.match(s);if(d&&d.length>1){const p=d[1];let y=i[p];y||(i[p]=y=[]),y.push(c)}}const a=[];for(const o in i)a.push(this.CreateFromMorphTargetSequence(o,i[o],t,n));return a}static parseAnimation(e,t){if(Ve("AnimationClip: parseAnimation() is deprecated and will be removed with r185"),!e)return Ze("AnimationClip: No animation in JSONLoader data."),null;const n=function(p,y,_,v,b){if(_.length!==0){const E=[],T=[];NL(_,E,T,v),E.length!==0&&b.push(new p(y,E,T))}},i=[],s=e.name||"default",a=e.fps||30,o=e.blendMode;let l=e.length||-1;const c=e.hierarchy||[];for(let p=0;p<c.length;p++){const y=c[p].keys;if(!(!y||y.length===0))if(y[0].morphTargets){const _={};let v;for(v=0;v<y.length;v++)if(y[v].morphTargets)for(let b=0;b<y[v].morphTargets.length;b++)_[y[v].morphTargets[b]]=-1;for(const b in _){const E=[],T=[];for(let M=0;M!==y[v].morphTargets.length;++M){const R=y[v];E.push(R.time),T.push(R.morphTarget===b?1:0)}i.push(new o1(".morphTargetInfluence["+b+"]",E,T))}l=_.length*a}else{const _=".bones["+t[p].name+"]";n(l1,_+".position",y,"pos",i),n(Y1,_+".quaternion",y,"rot",i),n(l1,_+".scale",y,"scl",i)}}return i.length===0?null:new this(s,l,i,o)}resetDuration(){const e=this.tracks;let t=0;for(let n=0,i=e.length;n!==i;++n){const s=this.tracks[n];t=Math.max(t,s.times[s.times.length-1])}return this.duration=t,this}trim(){for(let e=0;e<this.tracks.length;e++)this.tracks[e].trim(0,this.duration);return this}validate(){let e=!0;for(let t=0;t<this.tracks.length;t++)e=e&&this.tracks[t].validate();return e}optimize(){for(let e=0;e<this.tracks.length;e++)this.tracks[e].optimize();return this}clone(){const e=[];for(let n=0;n<this.tracks.length;n++)e.push(this.tracks[n].clone());const t=new this.constructor(this.name,this.duration,e,this.blendMode);return t.userData=JSON.parse(JSON.stringify(this.userData)),t}toJSON(){return this.constructor.toJSON(this)}}function VK(r){switch(r.toLowerCase()){case"scalar":case"double":case"float":case"number":case"integer":return o1;case"vector":case"vector2":case"vector3":case"vector4":return l1;case"color":return OL;case"quaternion":return Y1;case"bool":case"boolean":return Cy;case"string":return Ny}throw new Error("THREE.KeyframeTrack: Unsupported typeName: "+r)}function GK(r){if(r.type===void 0)throw new Error("THREE.KeyframeTrack: track type undefined, can not parse");const e=VK(r.type);if(r.times===void 0){const t=[],n=[];NL(r.keys,t,n,"value"),r.times=t,r.values=n}return e.parse!==void 0?e.parse(r):new e(r.name,r.times,r.values,r.interpolation)}const nd={enabled:!1,files:{},add:function(r,e){this.enabled!==!1&&(this.files[r]=e)},get:function(r){if(this.enabled!==!1)return this.files[r]},remove:function(r){delete this.files[r]},clear:function(){this.files={}}};class qC{constructor(e,t,n){const i=this;let s=!1,a=0,o=0,l;const c=[];this.onStart=void 0,this.onLoad=e,this.onProgress=t,this.onError=n,this._abortController=null,this.itemStart=function(d){o++,s===!1&&i.onStart!==void 0&&i.onStart(d,a,o),s=!0},this.itemEnd=function(d){a++,i.onProgress!==void 0&&i.onProgress(d,a,o),a===o&&(s=!1,i.onLoad!==void 0&&i.onLoad())},this.itemError=function(d){i.onError!==void 0&&i.onError(d)},this.resolveURL=function(d){return l?l(d):d},this.setURLModifier=function(d){return l=d,this},this.addHandler=function(d,p){return c.push(d,p),this},this.removeHandler=function(d){const p=c.indexOf(d);return p!==-1&&c.splice(p,2),this},this.getHandler=function(d){for(let p=0,y=c.length;p<y;p+=2){const _=c[p],v=c[p+1];if(_.global&&(_.lastIndex=0),_.test(d))return v}return null},this.abort=function(){return this.abortController.abort(),this._abortController=null,this}}get abortController(){return this._abortController||(this._abortController=new AbortController),this._abortController}}const S6=new qC;class cl{constructor(e){this.manager=e!==void 0?e:S6,this.crossOrigin="anonymous",this.withCredentials=!1,this.path="",this.resourcePath="",this.requestHeader={}}load(){}loadAsync(e,t){const n=this;return new Promise(function(i,s){n.load(e,i,t,s)})}parse(){}setCrossOrigin(e){return this.crossOrigin=e,this}setWithCredentials(e){return this.withCredentials=e,this}setPath(e){return this.path=e,this}setResourcePath(e){return this.resourcePath=e,this}setRequestHeader(e){return this.requestHeader=e,this}abort(){return this}}cl.DEFAULT_MATERIAL_NAME="__DEFAULT";const sh={};class kK extends Error{constructor(e,t){super(e),this.response=t}}class mu extends cl{constructor(e){super(e),this.mimeType="",this.responseType="",this._abortController=new AbortController}load(e,t,n,i){e===void 0&&(e=""),this.path!==void 0&&(e=this.path+e),e=this.manager.resolveURL(e);const s=nd.get(`file:${e}`);if(s!==void 0)return this.manager.itemStart(e),setTimeout(()=>{t&&t(s),this.manager.itemEnd(e)},0),s;if(sh[e]!==void 0){sh[e].push({onLoad:t,onProgress:n,onError:i});return}sh[e]=[],sh[e].push({onLoad:t,onProgress:n,onError:i});const a=new Request(e,{headers:new Headers(this.requestHeader),credentials:this.withCredentials?"include":"same-origin",signal:typeof AbortSignal.any=="function"?AbortSignal.any([this._abortController.signal,this.manager.abortController.signal]):this._abortController.signal}),o=this.mimeType,l=this.responseType;fetch(a).then(c=>{if(c.status===200||c.status===0){if(c.status===0&&Ve("FileLoader: HTTP Status 0 received."),typeof ReadableStream>"u"||c.body===void 0||c.body.getReader===void 0)return c;const d=sh[e],p=c.body.getReader(),y=c.headers.get("X-File-Size")||c.headers.get("Content-Length"),_=y?parseInt(y):0,v=_!==0;let b=0;const E=new ReadableStream({start(T){M();function M(){p.read().then(({done:R,value:N})=>{if(R)T.close();else{b+=N.byteLength;const P=new ProgressEvent("progress",{lengthComputable:v,loaded:b,total:_});for(let U=0,L=d.length;U<L;U++){const F=d[U];F.onProgress&&F.onProgress(P)}T.enqueue(N),M()}},R=>{T.error(R)})}}});return new Response(E)}else throw new kK(`fetch for "${c.url}" responded with ${c.status}: ${c.statusText}`,c)}).then(c=>{switch(l){case"arraybuffer":return c.arrayBuffer();case"blob":return c.blob();case"document":return c.text().then(d=>new DOMParser().parseFromString(d,o));case"json":return c.json();default:if(o==="")return c.text();{const p=/charset="?([^;"\s]*)"?/i.exec(o),y=p&&p[1]?p[1].toLowerCase():void 0,_=new TextDecoder(y);return c.arrayBuffer().then(v=>_.decode(v))}}}).then(c=>{nd.add(`file:${e}`,c);const d=sh[e];delete sh[e];for(let p=0,y=d.length;p<y;p++){const _=d[p];_.onLoad&&_.onLoad(c)}}).catch(c=>{const d=sh[e];if(d===void 0)throw this.manager.itemError(e),c;delete sh[e];for(let p=0,y=d.length;p<y;p++){const _=d[p];_.onError&&_.onError(c)}this.manager.itemError(e)}).finally(()=>{this.manager.itemEnd(e)}),this.manager.itemStart(e)}setResponseType(e){return this.responseType=e,this}setMimeType(e){return this.mimeType=e,this}abort(){return this._abortController.abort(),this._abortController=new AbortController,this}}class HK extends cl{constructor(e){super(e)}load(e,t,n,i){const s=this,a=new mu(this.manager);a.setPath(this.path),a.setRequestHeader(this.requestHeader),a.setWithCredentials(this.withCredentials),a.load(e,function(o){try{t(s.parse(JSON.parse(o)))}catch(l){i?i(l):Ze(l),s.manager.itemError(e)}},n,i)}parse(e){const t=[];for(let n=0;n<e.length;n++){const i=u1.parse(e[n]);t.push(i)}return t}}class WK extends cl{constructor(e){super(e)}load(e,t,n,i){const s=this,a=[],o=new DC,l=new mu(this.manager);l.setPath(this.path),l.setResponseType("arraybuffer"),l.setRequestHeader(this.requestHeader),l.setWithCredentials(s.withCredentials);let c=0;function d(p){l.load(e[p],function(y){const _=s.parse(y,!0);a[p]={width:_.width,height:_.height,format:_.format,mipmaps:_.mipmaps},c+=1,c===6&&(_.mipmapCount===1&&(o.minFilter=ei),o.image=a,o.format=_.format,o.needsUpdate=!0,t&&t(o))},n,i)}if(Array.isArray(e))for(let p=0,y=e.length;p<y;++p)d(p);else l.load(e,function(p){const y=s.parse(p,!0);if(y.isCubemap){const _=y.mipmaps.length/y.mipmapCount;for(let v=0;v<_;v++){a[v]={mipmaps:[]};for(let b=0;b<y.mipmapCount;b++)a[v].mipmaps.push(y.mipmaps[v*y.mipmapCount+b]),a[v].format=y.format,a[v].width=y.width,a[v].height=y.height}o.image=a}else o.image.width=y.width,o.image.height=y.height,o.mipmaps=y.mipmaps;y.mipmapCount===1&&(o.minFilter=ei),o.format=y.format,o.needsUpdate=!0,t&&t(o)},n,i);return o}}const ov=new WeakMap;class c1 extends cl{constructor(e){super(e)}load(e,t,n,i){this.path!==void 0&&(e=this.path+e),e=this.manager.resolveURL(e);const s=this,a=nd.get(`image:${e}`);if(a!==void 0){if(a.complete===!0)s.manager.itemStart(e),setTimeout(function(){t&&t(a),s.manager.itemEnd(e)},0);else{let p=ov.get(a);p===void 0&&(p=[],ov.set(a,p)),p.push({onLoad:t,onError:i})}return a}const o=i1("img");function l(){d(),t&&t(this);const p=ov.get(this)||[];for(let y=0;y<p.length;y++){const _=p[y];_.onLoad&&_.onLoad(this)}ov.delete(this),s.manager.itemEnd(e)}function c(p){d(),i&&i(p),nd.remove(`image:${e}`);const y=ov.get(this)||[];for(let _=0;_<y.length;_++){const v=y[_];v.onError&&v.onError(p)}ov.delete(this),s.manager.itemError(e),s.manager.itemEnd(e)}function d(){o.removeEventListener("load",l,!1),o.removeEventListener("error",c,!1)}return o.addEventListener("load",l,!1),o.addEventListener("error",c,!1),e.slice(0,5)!=="data:"&&this.crossOrigin!==void 0&&(o.crossOrigin=this.crossOrigin),nd.add(`image:${e}`,o),s.manager.itemStart(e),o.src=e,o}}class T6 extends cl{constructor(e){super(e)}load(e,t,n,i){const s=new Im;s.colorSpace=ea;const a=new c1(this.manager);a.setCrossOrigin(this.crossOrigin),a.setPath(this.path);let o=0;function l(c){a.load(e[c],function(d){s.images[c]=d,o++,o===6&&(s.needsUpdate=!0,t&&t(s))},void 0,i)}for(let c=0;c<e.length;++c)l(c);return s}}class UL extends cl{constructor(e){super(e)}load(e,t,n,i){const s=this,a=new Ol,o=new mu(this.manager);return o.setResponseType("arraybuffer"),o.setRequestHeader(this.requestHeader),o.setPath(this.path),o.setWithCredentials(s.withCredentials),o.load(e,function(l){let c;try{c=s.parse(l)}catch(d){if(i!==void 0)i(d);else{d(d);return}}c.image!==void 0?a.image=c.image:c.data!==void 0&&(a.image.width=c.width,a.image.height=c.height,a.image.data=c.data),a.wrapS=c.wrapS!==void 0?c.wrapS:Dr,a.wrapT=c.wrapT!==void 0?c.wrapT:Dr,a.magFilter=c.magFilter!==void 0?c.magFilter:ei,a.minFilter=c.minFilter!==void 0?c.minFilter:ei,a.anisotropy=c.anisotropy!==void 0?c.anisotropy:1,c.colorSpace!==void 0&&(a.colorSpace=c.colorSpace),c.flipY!==void 0&&(a.flipY=c.flipY),c.format!==void 0&&(a.format=c.format),c.type!==void 0&&(a.type=c.type),c.mipmaps!==void 0&&(a.mipmaps=c.mipmaps,a.minFilter=Pa),c.mipmapCount===1&&(a.minFilter=ei),c.generateMipmaps!==void 0&&(a.generateMipmaps=c.generateMipmaps),a.needsUpdate=!0,t&&t(a,c)},n,i),a}}class qK extends cl{constructor(e){super(e)}load(e,t,n,i){const s=new sr,a=new c1(this.manager);return a.setCrossOrigin(this.crossOrigin),a.setPath(this.path),a.load(e,function(o){s.image=o,s.needsUpdate=!0,t!==void 0&&t(s)},n,i),s}}class Vm extends Fi{constructor(e,t=1){super(),this.isLight=!0,this.type="Light",this.color=new Kt(e),this.intensity=t}dispose(){this.dispatchEvent({type:"dispose"})}copy(e,t){return super.copy(e,t),this.color.copy(e.color),this.intensity=e.intensity,this}toJSON(e){const t=super.toJSON(e);return t.object.color=this.color.getHex(),t.object.intensity=this.intensity,t}}class LL extends Vm{constructor(e,t,n){super(e,n),this.isHemisphereLight=!0,this.type="HemisphereLight",this.position.copy(Fi.DEFAULT_UP),this.updateMatrix(),this.groundColor=new Kt(t)}copy(e,t){return super.copy(e,t),this.groundColor.copy(e.groundColor),this}toJSON(e){const t=super.toJSON(e);return t.object.groundColor=this.groundColor.getHex(),t}}const c3=new gn,Cz=new ne,Nz=new ne;class PL{constructor(e){this.camera=e,this.intensity=1,this.bias=0,this.normalBias=0,this.radius=1,this.blurSamples=8,this.mapSize=new tt(512,512),this.mapType=ir,this.map=null,this.mapPass=null,this.matrix=new gn,this.autoUpdate=!0,this.needsUpdate=!1,this._frustum=new Ry,this._frameExtents=new tt(1,1),this._viewportCount=1,this._viewports=[new zn(0,0,1,1)]}getViewportCount(){return this._viewportCount}getFrustum(){return this._frustum}updateMatrices(e){const t=this.camera,n=this.matrix;Cz.setFromMatrixPosition(e.matrixWorld),t.position.copy(Cz),Nz.setFromMatrixPosition(e.target.matrixWorld),t.lookAt(Nz),t.updateMatrixWorld(),c3.multiplyMatrices(t.projectionMatrix,t.matrixWorldInverse),this._frustum.setFromProjectionMatrix(c3,t.coordinateSystem,t.reversedDepth),t.reversedDepth?n.set(.5,0,0,.5,0,.5,0,.5,0,0,1,0,0,0,0,1):n.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),n.multiply(c3)}getViewport(e){return this._viewports[e]}getFrameExtents(){return this._frameExtents}dispose(){this.map&&this.map.dispose(),this.mapPass&&this.mapPass.dispose()}copy(e){return this.camera=e.camera.clone(),this.intensity=e.intensity,this.bias=e.bias,this.radius=e.radius,this.autoUpdate=e.autoUpdate,this.needsUpdate=e.needsUpdate,this.normalBias=e.normalBias,this.blurSamples=e.blurSamples,this.mapSize.copy(e.mapSize),this}clone(){return new this.constructor().copy(this)}toJSON(){const e={};return this.intensity!==1&&(e.intensity=this.intensity),this.bias!==0&&(e.bias=this.bias),this.normalBias!==0&&(e.normalBias=this.normalBias),this.radius!==1&&(e.radius=this.radius),(this.mapSize.x!==512||this.mapSize.y!==512)&&(e.mapSize=this.mapSize.toArray()),e.camera=this.camera.toJSON(!1).object,delete e.camera.matrix,e}}class XK extends PL{constructor(){super(new Br(50,1,.5,500)),this.isSpotLightShadow=!0,this.focus=1,this.aspect=1}updateMatrices(e){const t=this.camera,n=py*2*e.angle*this.focus,i=this.mapSize.width/this.mapSize.height*this.aspect,s=e.distance||t.far;(n!==t.fov||i!==t.aspect||s!==t.far)&&(t.fov=n,t.aspect=i,t.far=s,t.updateProjectionMatrix()),super.updateMatrices(e)}copy(e){return super.copy(e),this.focus=e.focus,this}}class Z1 extends Vm{constructor(e,t,n=0,i=Math.PI/3,s=0,a=2){super(e,t),this.isSpotLight=!0,this.type="SpotLight",this.position.copy(Fi.DEFAULT_UP),this.updateMatrix(),this.target=new Fi,this.distance=n,this.angle=i,this.penumbra=s,this.decay=a,this.map=null,this.shadow=new XK}get power(){return this.intensity*Math.PI}set power(e){this.intensity=e/Math.PI}dispose(){super.dispose(),this.shadow.dispose()}copy(e,t){return super.copy(e,t),this.distance=e.distance,this.angle=e.angle,this.penumbra=e.penumbra,this.decay=e.decay,this.target=e.target.clone(),this.map=e.map,this.shadow=e.shadow.clone(),this}toJSON(e){const t=super.toJSON(e);return t.object.distance=this.distance,t.object.angle=this.angle,t.object.decay=this.decay,t.object.penumbra=this.penumbra,t.object.target=this.target.uuid,this.map&&this.map.isTexture&&(t.object.map=this.map.toJSON(e).uuid),t.object.shadow=this.shadow.toJSON(),t}}class $K extends PL{constructor(){super(new Br(90,1,.5,500)),this.isPointLightShadow=!0}}class BL extends Vm{constructor(e,t,n=0,i=2){super(e,t),this.isPointLight=!0,this.type="PointLight",this.distance=n,this.decay=i,this.shadow=new $K}get power(){return this.intensity*4*Math.PI}set power(e){this.intensity=e/(4*Math.PI)}dispose(){super.dispose(),this.shadow.dispose()}copy(e,t){return super.copy(e,t),this.distance=e.distance,this.decay=e.decay,this.shadow=e.shadow.clone(),this}toJSON(e){const t=super.toJSON(e);return t.object.distance=this.distance,t.object.decay=this.decay,t.object.shadow=this.shadow.toJSON(),t}}class rc extends G1{constructor(e=-1,t=1,n=1,i=-1,s=.1,a=2e3){super(),this.isOrthographicCamera=!0,this.type="OrthographicCamera",this.zoom=1,this.view=null,this.left=e,this.right=t,this.top=n,this.bottom=i,this.near=s,this.far=a,this.updateProjectionMatrix()}copy(e,t){return super.copy(e,t),this.left=e.left,this.right=e.right,this.top=e.top,this.bottom=e.bottom,this.near=e.near,this.far=e.far,this.zoom=e.zoom,this.view=e.view===null?null:Object.assign({},e.view),this}setViewOffset(e,t,n,i,s,a){this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=n,this.view.offsetY=i,this.view.width=s,this.view.height=a,this.updateProjectionMatrix()}clearViewOffset(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const e=(this.right-this.left)/(2*this.zoom),t=(this.top-this.bottom)/(2*this.zoom),n=(this.right+this.left)/2,i=(this.top+this.bottom)/2;let s=n-e,a=n+e,o=i+t,l=i-t;if(this.view!==null&&this.view.enabled){const c=(this.right-this.left)/this.view.fullWidth/this.zoom,d=(this.top-this.bottom)/this.view.fullHeight/this.zoom;s+=c*this.view.offsetX,a=s+c*this.view.width,o-=d*this.view.offsetY,l=o-d*this.view.height}this.projectionMatrix.makeOrthographic(s,a,o,l,this.near,this.far,this.coordinateSystem,this.reversedDepth),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){const t=super.toJSON(e);return t.object.zoom=this.zoom,t.object.left=this.left,t.object.right=this.right,t.object.top=this.top,t.object.bottom=this.bottom,t.object.near=this.near,t.object.far=this.far,this.view!==null&&(t.object.view=Object.assign({},this.view)),t}}class jK extends PL{constructor(){super(new rc(-5,5,5,-5,.5,500)),this.isDirectionalLightShadow=!0}}class IL extends Vm{constructor(e,t){super(e,t),this.isDirectionalLight=!0,this.type="DirectionalLight",this.position.copy(Fi.DEFAULT_UP),this.updateMatrix(),this.target=new Fi,this.shadow=new jK}dispose(){super.dispose(),this.shadow.dispose()}copy(e){return super.copy(e),this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}toJSON(e){const t=super.toJSON(e);return t.object.shadow=this.shadow.toJSON(),t.object.target=this.target.uuid,t}}class FL extends Vm{constructor(e,t){super(e,t),this.isAmbientLight=!0,this.type="AmbientLight"}}class zL extends Vm{constructor(e,t,n=10,i=10){super(e,t),this.isRectAreaLight=!0,this.type="RectAreaLight",this.width=n,this.height=i}get power(){return this.intensity*this.width*this.height*Math.PI}set power(e){this.intensity=e/(this.width*this.height*Math.PI)}copy(e){return super.copy(e),this.width=e.width,this.height=e.height,this}toJSON(e){const t=super.toJSON(e);return t.object.width=this.width,t.object.height=this.height,t}}class VL{constructor(){this.isSphericalHarmonics3=!0,this.coefficients=[];for(let e=0;e<9;e++)this.coefficients.push(new ne)}set(e){for(let t=0;t<9;t++)this.coefficients[t].copy(e[t]);return this}zero(){for(let e=0;e<9;e++)this.coefficients[e].set(0,0,0);return this}getAt(e,t){const n=e.x,i=e.y,s=e.z,a=this.coefficients;return t.copy(a[0]).multiplyScalar(.282095),t.addScaledVector(a[1],.488603*i),t.addScaledVector(a[2],.488603*s),t.addScaledVector(a[3],.488603*n),t.addScaledVector(a[4],1.092548*(n*i)),t.addScaledVector(a[5],1.092548*(i*s)),t.addScaledVector(a[6],.315392*(3*s*s-1)),t.addScaledVector(a[7],1.092548*(n*s)),t.addScaledVector(a[8],.546274*(n*n-i*i)),t}getIrradianceAt(e,t){const n=e.x,i=e.y,s=e.z,a=this.coefficients;return t.copy(a[0]).multiplyScalar(.886227),t.addScaledVector(a[1],2*.511664*i),t.addScaledVector(a[2],2*.511664*s),t.addScaledVector(a[3],2*.511664*n),t.addScaledVector(a[4],2*.429043*n*i),t.addScaledVector(a[5],2*.429043*i*s),t.addScaledVector(a[6],.743125*s*s-.247708),t.addScaledVector(a[7],2*.429043*n*s),t.addScaledVector(a[8],.429043*(n*n-i*i)),t}add(e){for(let t=0;t<9;t++)this.coefficients[t].add(e.coefficients[t]);return this}addScaledSH(e,t){for(let n=0;n<9;n++)this.coefficients[n].addScaledVector(e.coefficients[n],t);return this}scale(e){for(let t=0;t<9;t++)this.coefficients[t].multiplyScalar(e);return this}lerp(e,t){for(let n=0;n<9;n++)this.coefficients[n].lerp(e.coefficients[n],t);return this}equals(e){for(let t=0;t<9;t++)if(!this.coefficients[t].equals(e.coefficients[t]))return!1;return!0}copy(e){return this.set(e.coefficients)}clone(){return new this.constructor().copy(this)}fromArray(e,t=0){const n=this.coefficients;for(let i=0;i<9;i++)n[i].fromArray(e,t+i*3);return this}toArray(e=[],t=0){const n=this.coefficients;for(let i=0;i<9;i++)n[i].toArray(e,t+i*3);return e}static getBasisAt(e,t){const n=e.x,i=e.y,s=e.z;t[0]=.282095,t[1]=.488603*i,t[2]=.488603*s,t[3]=.488603*n,t[4]=1.092548*n*i,t[5]=1.092548*i*s,t[6]=.315392*(3*s*s-1),t[7]=1.092548*n*s,t[8]=.546274*(n*n-i*i)}}class GL extends Vm{constructor(e=new VL,t=1){super(void 0,t),this.isLightProbe=!0,this.sh=e}copy(e){return super.copy(e),this.sh.copy(e.sh),this}toJSON(e){const t=super.toJSON(e);return t.object.sh=this.sh.toArray(),t}}class XC extends cl{constructor(e){super(e),this.textures={}}load(e,t,n,i){const s=this,a=new mu(s.manager);a.setPath(s.path),a.setRequestHeader(s.requestHeader),a.setWithCredentials(s.withCredentials),a.load(e,function(o){try{t(s.parse(JSON.parse(o)))}catch(l){i?i(l):Ze(l),s.manager.itemError(e)}},n,i)}parse(e){const t=this.textures;function n(s){return t[s]===void 0&&Ve("MaterialLoader: Undefined texture",s),t[s]}const i=this.createMaterialFromType(e.type);if(e.uuid!==void 0&&(i.uuid=e.uuid),e.name!==void 0&&(i.name=e.name),e.color!==void 0&&i.color!==void 0&&i.color.setHex(e.color),e.roughness!==void 0&&(i.roughness=e.roughness),e.metalness!==void 0&&(i.metalness=e.metalness),e.sheen!==void 0&&(i.sheen=e.sheen),e.sheenColor!==void 0&&(i.sheenColor=new Kt().setHex(e.sheenColor)),e.sheenRoughness!==void 0&&(i.sheenRoughness=e.sheenRoughness),e.emissive!==void 0&&i.emissive!==void 0&&i.emissive.setHex(e.emissive),e.specular!==void 0&&i.specular!==void 0&&i.specular.setHex(e.specular),e.specularIntensity!==void 0&&(i.specularIntensity=e.specularIntensity),e.specularColor!==void 0&&i.specularColor!==void 0&&i.specularColor.setHex(e.specularColor),e.shininess!==void 0&&(i.shininess=e.shininess),e.clearcoat!==void 0&&(i.clearcoat=e.clearcoat),e.clearcoatRoughness!==void 0&&(i.clearcoatRoughness=e.clearcoatRoughness),e.dispersion!==void 0&&(i.dispersion=e.dispersion),e.iridescence!==void 0&&(i.iridescence=e.iridescence),e.iridescenceIOR!==void 0&&(i.iridescenceIOR=e.iridescenceIOR),e.iridescenceThicknessRange!==void 0&&(i.iridescenceThicknessRange=e.iridescenceThicknessRange),e.transmission!==void 0&&(i.transmission=e.transmission),e.thickness!==void 0&&(i.thickness=e.thickness),e.attenuationDistance!==void 0&&(i.attenuationDistance=e.attenuationDistance),e.attenuationColor!==void 0&&i.attenuationColor!==void 0&&i.attenuationColor.setHex(e.attenuationColor),e.anisotropy!==void 0&&(i.anisotropy=e.anisotropy),e.anisotropyRotation!==void 0&&(i.anisotropyRotation=e.anisotropyRotation),e.fog!==void 0&&(i.fog=e.fog),e.flatShading!==void 0&&(i.flatShading=e.flatShading),e.blending!==void 0&&(i.blending=e.blending),e.combine!==void 0&&(i.combine=e.combine),e.side!==void 0&&(i.side=e.side),e.shadowSide!==void 0&&(i.shadowSide=e.shadowSide),e.opacity!==void 0&&(i.opacity=e.opacity),e.transparent!==void 0&&(i.transparent=e.transparent),e.alphaTest!==void 0&&(i.alphaTest=e.alphaTest),e.alphaHash!==void 0&&(i.alphaHash=e.alphaHash),e.depthFunc!==void 0&&(i.depthFunc=e.depthFunc),e.depthTest!==void 0&&(i.depthTest=e.depthTest),e.depthWrite!==void 0&&(i.depthWrite=e.depthWrite),e.colorWrite!==void 0&&(i.colorWrite=e.colorWrite),e.blendSrc!==void 0&&(i.blendSrc=e.blendSrc),e.blendDst!==void 0&&(i.blendDst=e.blendDst),e.blendEquation!==void 0&&(i.blendEquation=e.blendEquation),e.blendSrcAlpha!==void 0&&(i.blendSrcAlpha=e.blendSrcAlpha),e.blendDstAlpha!==void 0&&(i.blendDstAlpha=e.blendDstAlpha),e.blendEquationAlpha!==void 0&&(i.blendEquationAlpha=e.blendEquationAlpha),e.blendColor!==void 0&&i.blendColor!==void 0&&i.blendColor.setHex(e.blendColor),e.blendAlpha!==void 0&&(i.blendAlpha=e.blendAlpha),e.stencilWriteMask!==void 0&&(i.stencilWriteMask=e.stencilWriteMask),e.stencilFunc!==void 0&&(i.stencilFunc=e.stencilFunc),e.stencilRef!==void 0&&(i.stencilRef=e.stencilRef),e.stencilFuncMask!==void 0&&(i.stencilFuncMask=e.stencilFuncMask),e.stencilFail!==void 0&&(i.stencilFail=e.stencilFail),e.stencilZFail!==void 0&&(i.stencilZFail=e.stencilZFail),e.stencilZPass!==void 0&&(i.stencilZPass=e.stencilZPass),e.stencilWrite!==void 0&&(i.stencilWrite=e.stencilWrite),e.wireframe!==void 0&&(i.wireframe=e.wireframe),e.wireframeLinewidth!==void 0&&(i.wireframeLinewidth=e.wireframeLinewidth),e.wireframeLinecap!==void 0&&(i.wireframeLinecap=e.wireframeLinecap),e.wireframeLinejoin!==void 0&&(i.wireframeLinejoin=e.wireframeLinejoin),e.rotation!==void 0&&(i.rotation=e.rotation),e.linewidth!==void 0&&(i.linewidth=e.linewidth),e.dashSize!==void 0&&(i.dashSize=e.dashSize),e.gapSize!==void 0&&(i.gapSize=e.gapSize),e.scale!==void 0&&(i.scale=e.scale),e.polygonOffset!==void 0&&(i.polygonOffset=e.polygonOffset),e.polygonOffsetFactor!==void 0&&(i.polygonOffsetFactor=e.polygonOffsetFactor),e.polygonOffsetUnits!==void 0&&(i.polygonOffsetUnits=e.polygonOffsetUnits),e.dithering!==void 0&&(i.dithering=e.dithering),e.alphaToCoverage!==void 0&&(i.alphaToCoverage=e.alphaToCoverage),e.premultipliedAlpha!==void 0&&(i.premultipliedAlpha=e.premultipliedAlpha),e.forceSinglePass!==void 0&&(i.forceSinglePass=e.forceSinglePass),e.allowOverride!==void 0&&(i.allowOverride=e.allowOverride),e.visible!==void 0&&(i.visible=e.visible),e.toneMapped!==void 0&&(i.toneMapped=e.toneMapped),e.userData!==void 0&&(i.userData=e.userData),e.vertexColors!==void 0&&(typeof e.vertexColors=="number"?i.vertexColors=e.vertexColors>0:i.vertexColors=e.vertexColors),e.uniforms!==void 0)for(const s in e.uniforms){const a=e.uniforms[s];switch(i.uniforms[s]={},a.type){case"t":i.uniforms[s].value=n(a.value);break;case"c":i.uniforms[s].value=new Kt().setHex(a.value);break;case"v2":i.uniforms[s].value=new tt().fromArray(a.value);break;case"v3":i.uniforms[s].value=new ne().fromArray(a.value);break;case"v4":i.uniforms[s].value=new zn().fromArray(a.value);break;case"m3":i.uniforms[s].value=new Zn().fromArray(a.value);break;case"m4":i.uniforms[s].value=new gn().fromArray(a.value);break;default:i.uniforms[s].value=a.value}}if(e.defines!==void 0&&(i.defines=e.defines),e.vertexShader!==void 0&&(i.vertexShader=e.vertexShader),e.fragmentShader!==void 0&&(i.fragmentShader=e.fragmentShader),e.glslVersion!==void 0&&(i.glslVersion=e.glslVersion),e.extensions!==void 0)for(const s in e.extensions)i.extensions[s]=e.extensions[s];if(e.lights!==void 0&&(i.lights=e.lights),e.clipping!==void 0&&(i.clipping=e.clipping),e.size!==void 0&&(i.size=e.size),e.sizeAttenuation!==void 0&&(i.sizeAttenuation=e.sizeAttenuation),e.map!==void 0&&(i.map=n(e.map)),e.matcap!==void 0&&(i.matcap=n(e.matcap)),e.alphaMap!==void 0&&(i.alphaMap=n(e.alphaMap)),e.bumpMap!==void 0&&(i.bumpMap=n(e.bumpMap)),e.bumpScale!==void 0&&(i.bumpScale=e.bumpScale),e.normalMap!==void 0&&(i.normalMap=n(e.normalMap)),e.normalMapType!==void 0&&(i.normalMapType=e.normalMapType),e.normalScale!==void 0){let s=e.normalScale;Array.isArray(s)===!1&&(s=[s,s]),i.normalScale=new tt().fromArray(s)}return e.displacementMap!==void 0&&(i.displacementMap=n(e.displacementMap)),e.displacementScale!==void 0&&(i.displacementScale=e.displacementScale),e.displacementBias!==void 0&&(i.displacementBias=e.displacementBias),e.roughnessMap!==void 0&&(i.roughnessMap=n(e.roughnessMap)),e.metalnessMap!==void 0&&(i.metalnessMap=n(e.metalnessMap)),e.emissiveMap!==void 0&&(i.emissiveMap=n(e.emissiveMap)),e.emissiveIntensity!==void 0&&(i.emissiveIntensity=e.emissiveIntensity),e.specularMap!==void 0&&(i.specularMap=n(e.specularMap)),e.specularIntensityMap!==void 0&&(i.specularIntensityMap=n(e.specularIntensityMap)),e.specularColorMap!==void 0&&(i.specularColorMap=n(e.specularColorMap)),e.envMap!==void 0&&(i.envMap=n(e.envMap)),e.envMapRotation!==void 0&&i.envMapRotation.fromArray(e.envMapRotation),e.envMapIntensity!==void 0&&(i.envMapIntensity=e.envMapIntensity),e.reflectivity!==void 0&&(i.reflectivity=e.reflectivity),e.refractionRatio!==void 0&&(i.refractionRatio=e.refractionRatio),e.lightMap!==void 0&&(i.lightMap=n(e.lightMap)),e.lightMapIntensity!==void 0&&(i.lightMapIntensity=e.lightMapIntensity),e.aoMap!==void 0&&(i.aoMap=n(e.aoMap)),e.aoMapIntensity!==void 0&&(i.aoMapIntensity=e.aoMapIntensity),e.gradientMap!==void 0&&(i.gradientMap=n(e.gradientMap)),e.clearcoatMap!==void 0&&(i.clearcoatMap=n(e.clearcoatMap)),e.clearcoatRoughnessMap!==void 0&&(i.clearcoatRoughnessMap=n(e.clearcoatRoughnessMap)),e.clearcoatNormalMap!==void 0&&(i.clearcoatNormalMap=n(e.clearcoatNormalMap)),e.clearcoatNormalScale!==void 0&&(i.clearcoatNormalScale=new tt().fromArray(e.clearcoatNormalScale)),e.iridescenceMap!==void 0&&(i.iridescenceMap=n(e.iridescenceMap)),e.iridescenceThicknessMap!==void 0&&(i.iridescenceThicknessMap=n(e.iridescenceThicknessMap)),e.transmissionMap!==void 0&&(i.transmissionMap=n(e.transmissionMap)),e.thicknessMap!==void 0&&(i.thicknessMap=n(e.thicknessMap)),e.anisotropyMap!==void 0&&(i.anisotropyMap=n(e.anisotropyMap)),e.sheenColorMap!==void 0&&(i.sheenColorMap=n(e.sheenColorMap)),e.sheenRoughnessMap!==void 0&&(i.sheenRoughnessMap=n(e.sheenRoughnessMap)),i}setTextures(e){return this.textures=e,this}createMaterialFromType(e){return XC.createMaterialFromType(e)}static createMaterialFromType(e){const t={ShadowMaterial:vL,SpriteMaterial:wC,RawShaderMaterial:xL,ShaderMaterial:ul,PointsMaterial:CC,MeshPhysicalMaterial:bL,MeshStandardMaterial:WC,MeshPhongMaterial:SL,MeshToonMaterial:TL,MeshNormalMaterial:EL,MeshLambertMaterial:ML,MeshDepthMaterial:AL,MeshDistanceMaterial:wL,MeshBasicMaterial:lo,MeshMatcapMaterial:RL,LineDashedMaterial:CL,LineBasicMaterial:bo,Material:Ta};return new t[e]}}class pO{static extractUrlBase(e){const t=e.lastIndexOf("/");return t===-1?"./":e.slice(0,t+1)}static resolveURL(e,t){return typeof e!="string"||e===""?"":(/^https?:\/\//i.test(t)&&/^\//.test(e)&&(t=t.replace(/(^https?:\/\/[^\/]+).*/i,"$1")),/^(https?:)?\/\//i.test(e)||/^data:.*,.*$/i.test(e)||/^blob:.*$/i.test(e)?e:t+e)}}class E6 extends Qn{constructor(){super(),this.isInstancedBufferGeometry=!0,this.type="InstancedBufferGeometry",this.instanceCount=1/0}copy(e){return super.copy(e),this.instanceCount=e.instanceCount,this}toJSON(){const e=super.toJSON();return e.instanceCount=this.instanceCount,e.isInstancedBufferGeometry=!0,e}}class M6 extends cl{constructor(e){super(e)}load(e,t,n,i){const s=this,a=new mu(s.manager);a.setPath(s.path),a.setRequestHeader(s.requestHeader),a.setWithCredentials(s.withCredentials),a.load(e,function(o){try{t(s.parse(JSON.parse(o)))}catch(l){i?i(l):Ze(l),s.manager.itemError(e)}},n,i)}parse(e){const t={},n={};function i(_,v){if(t[v]!==void 0)return t[v];const E=_.interleavedBuffers[v],T=s(_,E.buffer),M=Uv(E.type,T),R=new H1(M,E.stride);return R.uuid=E.uuid,t[v]=R,R}function s(_,v){if(n[v]!==void 0)return n[v];const E=_.arrayBuffers[v],T=new Uint32Array(E).buffer;return n[v]=T,T}const a=e.isInstancedBufferGeometry?new E6:new Qn,o=e.data.index;if(o!==void 0){const _=Uv(o.type,o.array);a.setIndex(new Ji(_,1))}const l=e.data.attributes;for(const _ in l){const v=l[_];let b;if(v.isInterleavedBufferAttribute){const E=i(e.data,v.data);b=new Sm(E,v.itemSize,v.offset,v.normalized)}else{const E=Uv(v.type,v.array),T=v.isInstancedBufferAttribute?ic:Ji;b=new T(E,v.itemSize,v.normalized)}v.name!==void 0&&(b.name=v.name),v.usage!==void 0&&b.setUsage(v.usage),a.setAttribute(_,b)}const c=e.data.morphAttributes;if(c)for(const _ in c){const v=c[_],b=[];for(let E=0,T=v.length;E<T;E++){const M=v[E];let R;if(M.isInterleavedBufferAttribute){const N=i(e.data,M.data);R=new Sm(N,M.itemSize,M.offset,M.normalized)}else{const N=Uv(M.type,M.array);R=new Ji(N,M.itemSize,M.normalized)}M.name!==void 0&&(R.name=M.name),b.push(R)}a.morphAttributes[_]=b}e.data.morphTargetsRelative&&(a.morphTargetsRelative=!0);const p=e.data.groups||e.data.drawcalls||e.data.offsets;if(p!==void 0)for(let _=0,v=p.length;_!==v;++_){const b=p[_];a.addGroup(b.start,b.count,b.materialIndex)}const y=e.data.boundingSphere;return y!==void 0&&(a.boundingSphere=new Sa().fromJSON(y)),e.name&&(a.name=e.name),e.userData&&(a.userData=e.userData),a}}class YK extends cl{constructor(e){super(e)}load(e,t,n,i){const s=this,a=this.path===""?pO.extractUrlBase(e):this.path;this.resourcePath=this.resourcePath||a;const o=new mu(this.manager);o.setPath(this.path),o.setRequestHeader(this.requestHeader),o.setWithCredentials(this.withCredentials),o.load(e,function(l){let c=null;try{c=JSON.parse(l)}catch(p){i!==void 0&&i(p),p("ObjectLoader: Can't parse "+e+".",p.message);return}const d=c.metadata;if(d===void 0||d.type===void 0||d.type.toLowerCase()==="geometry"){i!==void 0&&i(new Error("THREE.ObjectLoader: Can't load "+e)),Ze("ObjectLoader: Can't load "+e);return}s.parse(c,t)},n,i)}async loadAsync(e,t){const n=this,i=this.path===""?pO.extractUrlBase(e):this.path;this.resourcePath=this.resourcePath||i;const s=new mu(this.manager);s.setPath(this.path),s.setRequestHeader(this.requestHeader),s.setWithCredentials(this.withCredentials);const a=await s.loadAsync(e,t),o=JSON.parse(a),l=o.metadata;if(l===void 0||l.type===void 0||l.type.toLowerCase()==="geometry")throw new Error("THREE.ObjectLoader: Can't load "+e);return await n.parseAsync(o)}parse(e,t){const n=this.parseAnimations(e.animations),i=this.parseShapes(e.shapes),s=this.parseGeometries(e.geometries,i),a=this.parseImages(e.images,function(){t!==void 0&&t(c)}),o=this.parseTextures(e.textures,a),l=this.parseMaterials(e.materials,o),c=this.parseObject(e.object,s,l,o,n),d=this.parseSkeletons(e.skeletons,c);if(this.bindSkeletons(c,d),this.bindLightTargets(c),t!==void 0){let p=!1;for(const y in a)if(a[y].data instanceof HTMLImageElement){p=!0;break}p===!1&&t(c)}return c}async parseAsync(e){const t=this.parseAnimations(e.animations),n=this.parseShapes(e.shapes),i=this.parseGeometries(e.geometries,n),s=await this.parseImagesAsync(e.images),a=this.parseTextures(e.textures,s),o=this.parseMaterials(e.materials,a),l=this.parseObject(e.object,i,o,a,t),c=this.parseSkeletons(e.skeletons,l);return this.bindSkeletons(l,c),this.bindLightTargets(l),l}parseShapes(e){const t={};if(e!==void 0)for(let n=0,i=e.length;n<i;n++){const s=new R0().fromJSON(e[n]);t[s.uuid]=s}return t}parseSkeletons(e,t){const n={},i={};if(t.traverse(function(s){s.isBone&&(i[s.uuid]=s)}),e!==void 0)for(let s=0,a=e.length;s<a;s++){const o=new RC().fromJSON(e[s],i);n[o.uuid]=o}return n}parseGeometries(e,t){const n={};if(e!==void 0){const i=new M6;for(let s=0,a=e.length;s<a;s++){let o;const l=e[s];switch(l.type){case"BufferGeometry":case"InstancedBufferGeometry":o=i.parse(l);break;default:l.type in Rz?o=Rz[l.type].fromJSON(l,t):Ve(`ObjectLoader: Unsupported geometry type "${l.type}"`)}o.uuid=l.uuid,l.name!==void 0&&(o.name=l.name),l.userData!==void 0&&(o.userData=l.userData),n[l.uuid]=o}}return n}parseMaterials(e,t){const n={},i={};if(e!==void 0){const s=new XC;s.setTextures(t);for(let a=0,o=e.length;a<o;a++){const l=e[a];n[l.uuid]===void 0&&(n[l.uuid]=s.parse(l)),i[l.uuid]=n[l.uuid]}}return i}parseAnimations(e){const t={};if(e!==void 0)for(let n=0;n<e.length;n++){const i=e[n],s=u1.parse(i);t[s.uuid]=s}return t}parseImages(e,t){const n=this,i={};let s;function a(l){return n.manager.itemStart(l),s.load(l,function(){n.manager.itemEnd(l)},void 0,function(){n.manager.itemError(l),n.manager.itemEnd(l)})}function o(l){if(typeof l=="string"){const c=l,d=/^(\/\/)|([a-z]+:(\/\/)?)/i.test(c)?c:n.resourcePath+c;return a(d)}else return l.data?{data:Uv(l.type,l.data),width:l.width,height:l.height}:null}if(e!==void 0&&e.length>0){const l=new qC(t);s=new c1(l),s.setCrossOrigin(this.crossOrigin);for(let c=0,d=e.length;c<d;c++){const p=e[c],y=p.url;if(Array.isArray(y)){const _=[];for(let v=0,b=y.length;v<b;v++){const E=y[v],T=o(E);T!==null&&(T instanceof HTMLImageElement?_.push(T):_.push(new Ol(T.data,T.width,T.height)))}i[p.uuid]=new nm(_)}else{const _=o(p.url);i[p.uuid]=new nm(_)}}}return i}async parseImagesAsync(e){const t=this,n={};let i;async function s(a){if(typeof a=="string"){const o=a,l=/^(\/\/)|([a-z]+:(\/\/)?)/i.test(o)?o:t.resourcePath+o;return await i.loadAsync(l)}else return a.data?{data:Uv(a.type,a.data),width:a.width,height:a.height}:null}if(e!==void 0&&e.length>0){i=new c1(this.manager),i.setCrossOrigin(this.crossOrigin);for(let a=0,o=e.length;a<o;a++){const l=e[a],c=l.url;if(Array.isArray(c)){const d=[];for(let p=0,y=c.length;p<y;p++){const _=c[p],v=await s(_);v!==null&&(v instanceof HTMLImageElement?d.push(v):d.push(new Ol(v.data,v.width,v.height)))}n[l.uuid]=new nm(d)}else{const d=await s(l.url);n[l.uuid]=new nm(d)}}}return n}parseTextures(e,t){function n(s,a){return typeof s=="number"?s:(Ve("ObjectLoader.parseTexture: Constant should be in numeric form.",s),a[s])}const i={};if(e!==void 0)for(let s=0,a=e.length;s<a;s++){const o=e[s];o.image===void 0&&Ve('ObjectLoader: No "image" specified for',o.uuid),t[o.image]===void 0&&Ve("ObjectLoader: Undefined image",o.image);const l=t[o.image],c=l.data;let d;Array.isArray(c)?(d=new Im,c.length===6&&(d.needsUpdate=!0)):(c&&c.data?d=new Ol:d=new sr,c&&(d.needsUpdate=!0)),d.source=l,d.uuid=o.uuid,o.name!==void 0&&(d.name=o.name),o.mapping!==void 0&&(d.mapping=n(o.mapping,ZK)),o.channel!==void 0&&(d.channel=o.channel),o.offset!==void 0&&d.offset.fromArray(o.offset),o.repeat!==void 0&&d.repeat.fromArray(o.repeat),o.center!==void 0&&d.center.fromArray(o.center),o.rotation!==void 0&&(d.rotation=o.rotation),o.wrap!==void 0&&(d.wrapS=n(o.wrap[0],Dz),d.wrapT=n(o.wrap[1],Dz)),o.format!==void 0&&(d.format=o.format),o.internalFormat!==void 0&&(d.internalFormat=o.internalFormat),o.type!==void 0&&(d.type=o.type),o.colorSpace!==void 0&&(d.colorSpace=o.colorSpace),o.minFilter!==void 0&&(d.minFilter=n(o.minFilter,Oz)),o.magFilter!==void 0&&(d.magFilter=n(o.magFilter,Oz)),o.anisotropy!==void 0&&(d.anisotropy=o.anisotropy),o.flipY!==void 0&&(d.flipY=o.flipY),o.generateMipmaps!==void 0&&(d.generateMipmaps=o.generateMipmaps),o.premultiplyAlpha!==void 0&&(d.premultiplyAlpha=o.premultiplyAlpha),o.unpackAlignment!==void 0&&(d.unpackAlignment=o.unpackAlignment),o.compareFunction!==void 0&&(d.compareFunction=o.compareFunction),o.userData!==void 0&&(d.userData=o.userData),i[o.uuid]=d}return i}parseObject(e,t,n,i,s){let a;function o(y){return t[y]===void 0&&Ve("ObjectLoader: Undefined geometry",y),t[y]}function l(y){if(y!==void 0){if(Array.isArray(y)){const _=[];for(let v=0,b=y.length;v<b;v++){const E=y[v];n[E]===void 0&&Ve("ObjectLoader: Undefined material",E),_.push(n[E])}return _}return n[y]===void 0&&Ve("ObjectLoader: Undefined material",y),n[y]}}function c(y){return i[y]===void 0&&Ve("ObjectLoader: Undefined texture",y),i[y]}let d,p;switch(e.type){case"Scene":a=new Fm,e.background!==void 0&&(Number.isInteger(e.background)?a.background=new Kt(e.background):a.background=c(e.background)),e.environment!==void 0&&(a.environment=c(e.environment)),e.fog!==void 0&&(e.fog.type==="Fog"?a.fog=new AC(e.fog.color,e.fog.near,e.fog.far):e.fog.type==="FogExp2"&&(a.fog=new MC(e.fog.color,e.fog.density)),e.fog.name!==""&&(a.fog.name=e.fog.name)),e.backgroundBlurriness!==void 0&&(a.backgroundBlurriness=e.backgroundBlurriness),e.backgroundIntensity!==void 0&&(a.backgroundIntensity=e.backgroundIntensity),e.backgroundRotation!==void 0&&a.backgroundRotation.fromArray(e.backgroundRotation),e.environmentIntensity!==void 0&&(a.environmentIntensity=e.environmentIntensity),e.environmentRotation!==void 0&&a.environmentRotation.fromArray(e.environmentRotation);break;case"PerspectiveCamera":a=new Br(e.fov,e.aspect,e.near,e.far),e.focus!==void 0&&(a.focus=e.focus),e.zoom!==void 0&&(a.zoom=e.zoom),e.filmGauge!==void 0&&(a.filmGauge=e.filmGauge),e.filmOffset!==void 0&&(a.filmOffset=e.filmOffset),e.view!==void 0&&(a.view=Object.assign({},e.view));break;case"OrthographicCamera":a=new rc(e.left,e.right,e.top,e.bottom,e.near,e.far),e.zoom!==void 0&&(a.zoom=e.zoom),e.view!==void 0&&(a.view=Object.assign({},e.view));break;case"AmbientLight":a=new FL(e.color,e.intensity);break;case"DirectionalLight":a=new IL(e.color,e.intensity),a.target=e.target||"";break;case"PointLight":a=new BL(e.color,e.intensity,e.distance,e.decay);break;case"RectAreaLight":a=new zL(e.color,e.intensity,e.width,e.height);break;case"SpotLight":a=new Z1(e.color,e.intensity,e.distance,e.angle,e.penumbra,e.decay),a.target=e.target||"";break;case"HemisphereLight":a=new LL(e.color,e.groundColor,e.intensity);break;case"LightProbe":const y=new VL().fromArray(e.sh);a=new GL(y,e.intensity);break;case"SkinnedMesh":d=o(e.geometry),p=l(e.material),a=new t6(d,p),e.bindMode!==void 0&&(a.bindMode=e.bindMode),e.bindMatrix!==void 0&&a.bindMatrix.fromArray(e.bindMatrix),e.skeleton!==void 0&&(a.skeleton=e.skeleton);break;case"Mesh":d=o(e.geometry),p=l(e.material),a=new ar(d,p);break;case"InstancedMesh":d=o(e.geometry),p=l(e.material);const _=e.count,v=e.instanceMatrix,b=e.instanceColor;a=new n6(d,p,_),a.instanceMatrix=new ic(new Float32Array(v.array),16),b!==void 0&&(a.instanceColor=new ic(new Float32Array(b.array),b.itemSize));break;case"BatchedMesh":d=o(e.geometry),p=l(e.material),a=new i6(e.maxInstanceCount,e.maxVertexCount,e.maxIndexCount,p),a.geometry=d,a.perObjectFrustumCulled=e.perObjectFrustumCulled,a.sortObjects=e.sortObjects,a._drawRanges=e.drawRanges,a._reservedRanges=e.reservedRanges,a._geometryInfo=e.geometryInfo.map(E=>{let T=null,M=null;return E.boundingBox!==void 0&&(T=new _o().fromJSON(E.boundingBox)),E.boundingSphere!==void 0&&(M=new Sa().fromJSON(E.boundingSphere)),{...E,boundingBox:T,boundingSphere:M}}),a._instanceInfo=e.instanceInfo,a._availableInstanceIds=e._availableInstanceIds,a._availableGeometryIds=e._availableGeometryIds,a._nextIndexStart=e.nextIndexStart,a._nextVertexStart=e.nextVertexStart,a._geometryCount=e.geometryCount,a._maxInstanceCount=e.maxInstanceCount,a._maxVertexCount=e.maxVertexCount,a._maxIndexCount=e.maxIndexCount,a._geometryInitialized=e.geometryInitialized,a._matricesTexture=c(e.matricesTexture.uuid),a._indirectTexture=c(e.indirectTexture.uuid),e.colorsTexture!==void 0&&(a._colorsTexture=c(e.colorsTexture.uuid)),e.boundingSphere!==void 0&&(a.boundingSphere=new Sa().fromJSON(e.boundingSphere)),e.boundingBox!==void 0&&(a.boundingBox=new _o().fromJSON(e.boundingBox));break;case"LOD":a=new e6;break;case"Line":a=new Tm(o(e.geometry),l(e.material));break;case"LineLoop":a=new r6(o(e.geometry),l(e.material));break;case"LineSegments":a=new xd(o(e.geometry),l(e.material));break;case"PointCloud":case"Points":a=new s6(o(e.geometry),l(e.material));break;case"Sprite":a=new Jk(l(e.material));break;case"Group":a=new Lv;break;case"Bone":a=new cL;break;default:a=new Fi}if(a.uuid=e.uuid,e.name!==void 0&&(a.name=e.name),e.matrix!==void 0?(a.matrix.fromArray(e.matrix),e.matrixAutoUpdate!==void 0&&(a.matrixAutoUpdate=e.matrixAutoUpdate),a.matrixAutoUpdate&&a.matrix.decompose(a.position,a.quaternion,a.scale)):(e.position!==void 0&&a.position.fromArray(e.position),e.rotation!==void 0&&a.rotation.fromArray(e.rotation),e.quaternion!==void 0&&a.quaternion.fromArray(e.quaternion),e.scale!==void 0&&a.scale.fromArray(e.scale)),e.up!==void 0&&a.up.fromArray(e.up),e.castShadow!==void 0&&(a.castShadow=e.castShadow),e.receiveShadow!==void 0&&(a.receiveShadow=e.receiveShadow),e.shadow&&(e.shadow.intensity!==void 0&&(a.shadow.intensity=e.shadow.intensity),e.shadow.bias!==void 0&&(a.shadow.bias=e.shadow.bias),e.shadow.normalBias!==void 0&&(a.shadow.normalBias=e.shadow.normalBias),e.shadow.radius!==void 0&&(a.shadow.radius=e.shadow.radius),e.shadow.mapSize!==void 0&&a.shadow.mapSize.fromArray(e.shadow.mapSize),e.shadow.camera!==void 0&&(a.shadow.camera=this.parseObject(e.shadow.camera))),e.visible!==void 0&&(a.visible=e.visible),e.frustumCulled!==void 0&&(a.frustumCulled=e.frustumCulled),e.renderOrder!==void 0&&(a.renderOrder=e.renderOrder),e.userData!==void 0&&(a.userData=e.userData),e.layers!==void 0&&(a.layers.mask=e.layers),e.children!==void 0){const y=e.children;for(let _=0;_<y.length;_++)a.add(this.parseObject(y[_],t,n,i,s))}if(e.animations!==void 0){const y=e.animations;for(let _=0;_<y.length;_++){const v=y[_];a.animations.push(s[v])}}if(e.type==="LOD"){e.autoUpdate!==void 0&&(a.autoUpdate=e.autoUpdate);const y=e.levels;for(let _=0;_<y.length;_++){const v=y[_],b=a.getObjectByProperty("uuid",v.object);b!==void 0&&a.addLevel(b,v.distance,v.hysteresis)}}return a}bindSkeletons(e,t){Object.keys(t).length!==0&&e.traverse(function(n){if(n.isSkinnedMesh===!0&&n.skeleton!==void 0){const i=t[n.skeleton];i===void 0?Ve("ObjectLoader: No skeleton found with UUID:",n.skeleton):n.bind(i,n.bindMatrix)}})}bindLightTargets(e){e.traverse(function(t){if(t.isDirectionalLight||t.isSpotLight){const n=t.target,i=e.getObjectByProperty("uuid",n);i!==void 0?t.target=i:t.target=new Fi}})}}const ZK={UVMapping:Uh,CubeReflectionMapping:ol,CubeRefractionMapping:oc,EquirectangularReflectionMapping:Lh,EquirectangularRefractionMapping:ym,CubeUVReflectionMapping:Ph},Dz={RepeatWrapping:Bh,ClampToEdgeWrapping:Dr,MirroredRepeatWrapping:Ih},Oz={NearestFilter:Ki,NearestMipmapNearestFilter:P1,NearestMipmapLinearFilter:jc,LinearFilter:ei,LinearMipmapNearestFilter:dm,LinearMipmapLinearFilter:Pa},f3=new WeakMap;class KK extends cl{constructor(e){super(e),this.isImageBitmapLoader=!0,typeof createImageBitmap>"u"&&Ve("ImageBitmapLoader: createImageBitmap() not supported."),typeof fetch>"u"&&Ve("ImageBitmapLoader: fetch() not supported."),this.options={premultiplyAlpha:"none"},this._abortController=new AbortController}setOptions(e){return this.options=e,this}load(e,t,n,i){e===void 0&&(e=""),this.path!==void 0&&(e=this.path+e),e=this.manager.resolveURL(e);const s=this,a=nd.get(`image-bitmap:${e}`);if(a!==void 0){if(s.manager.itemStart(e),a.then){a.then(c=>{if(f3.has(a)===!0)i&&i(f3.get(a)),s.manager.itemError(e),s.manager.itemEnd(e);else return t&&t(c),s.manager.itemEnd(e),c});return}return setTimeout(function(){t&&t(a),s.manager.itemEnd(e)},0),a}const o={};o.credentials=this.crossOrigin==="anonymous"?"same-origin":"include",o.headers=this.requestHeader,o.signal=typeof AbortSignal.any=="function"?AbortSignal.any([this._abortController.signal,this.manager.abortController.signal]):this._abortController.signal;const l=fetch(e,o).then(function(c){return c.blob()}).then(function(c){return createImageBitmap(c,Object.assign(s.options,{colorSpaceConversion:"none"}))}).then(function(c){return nd.add(`image-bitmap:${e}`,c),t&&t(c),s.manager.itemEnd(e),c}).catch(function(c){i&&i(c),f3.set(l,c),nd.remove(`image-bitmap:${e}`),s.manager.itemError(e),s.manager.itemEnd(e)});nd.add(`image-bitmap:${e}`,l),s.manager.itemStart(e)}abort(){return this._abortController.abort(),this._abortController=new AbortController,this}}let xA;class kL{static getContext(){return xA===void 0&&(xA=new(window.AudioContext||window.webkitAudioContext)),xA}static setContext(e){xA=e}}class QK extends cl{constructor(e){super(e)}load(e,t,n,i){const s=this,a=new mu(this.manager);a.setResponseType("arraybuffer"),a.setPath(this.path),a.setRequestHeader(this.requestHeader),a.setWithCredentials(this.withCredentials),a.load(e,function(l){try{const c=l.slice(0);kL.getContext().decodeAudioData(c,function(p){t(p)}).catch(o)}catch(c){o(c)}},n,i);function o(l){i?i(l):Ze(l),s.manager.itemError(e)}}}const Uz=new gn,Lz=new gn,kg=new gn;class JK{constructor(){this.type="StereoCamera",this.aspect=1,this.eyeSep=.064,this.cameraL=new Br,this.cameraL.layers.enable(1),this.cameraL.matrixAutoUpdate=!1,this.cameraR=new Br,this.cameraR.layers.enable(2),this.cameraR.matrixAutoUpdate=!1,this._cache={focus:null,fov:null,aspect:null,near:null,far:null,zoom:null,eyeSep:null}}update(e){const t=this._cache;if(t.focus!==e.focus||t.fov!==e.fov||t.aspect!==e.aspect*this.aspect||t.near!==e.near||t.far!==e.far||t.zoom!==e.zoom||t.eyeSep!==this.eyeSep){t.focus=e.focus,t.fov=e.fov,t.aspect=e.aspect*this.aspect,t.near=e.near,t.far=e.far,t.zoom=e.zoom,t.eyeSep=this.eyeSep,kg.copy(e.projectionMatrix);const i=t.eyeSep/2,s=i*t.near/t.focus,a=t.near*Math.tan(w0*t.fov*.5)/t.zoom;let o,l;Lz.elements[12]=-i,Uz.elements[12]=i,o=-a*t.aspect+s,l=a*t.aspect+s,kg.elements[0]=2*t.near/(l-o),kg.elements[8]=(l+o)/(l-o),this.cameraL.projectionMatrix.copy(kg),o=-a*t.aspect-s,l=a*t.aspect-s,kg.elements[0]=2*t.near/(l-o),kg.elements[8]=(l+o)/(l-o),this.cameraR.projectionMatrix.copy(kg)}this.cameraL.matrixWorld.copy(e.matrixWorld).multiply(Lz),this.cameraR.matrixWorld.copy(e.matrixWorld).multiply(Uz)}}class HL extends Br{constructor(e=[]){super(),this.isArrayCamera=!0,this.isMultiViewCamera=!1,this.cameras=e}}class WL{constructor(e=!0){this.autoStart=e,this.startTime=0,this.oldTime=0,this.elapsedTime=0,this.running=!1}start(){this.startTime=performance.now(),this.oldTime=this.startTime,this.elapsedTime=0,this.running=!0}stop(){this.getElapsedTime(),this.running=!1,this.autoStart=!1}getElapsedTime(){return this.getDelta(),this.elapsedTime}getDelta(){let e=0;if(this.autoStart&&!this.running)return this.start(),0;if(this.running){const t=performance.now();e=(t-this.oldTime)/1e3,this.oldTime=t,this.elapsedTime+=e}return e}}const Hg=new ne,d3=new Va,eQ=new ne,Wg=new ne,qg=new ne;class tQ extends Fi{constructor(){super(),this.type="AudioListener",this.context=kL.getContext(),this.gain=this.context.createGain(),this.gain.connect(this.context.destination),this.filter=null,this.timeDelta=0,this._clock=new WL}getInput(){return this.gain}removeFilter(){return this.filter!==null&&(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination),this.gain.connect(this.context.destination),this.filter=null),this}getFilter(){return this.filter}setFilter(e){return this.filter!==null?(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination)):this.gain.disconnect(this.context.destination),this.filter=e,this.gain.connect(this.filter),this.filter.connect(this.context.destination),this}getMasterVolume(){return this.gain.gain.value}setMasterVolume(e){return this.gain.gain.setTargetAtTime(e,this.context.currentTime,.01),this}updateMatrixWorld(e){super.updateMatrixWorld(e);const t=this.context.listener;if(this.timeDelta=this._clock.getDelta(),this.matrixWorld.decompose(Hg,d3,eQ),Wg.set(0,0,-1).applyQuaternion(d3),qg.set(0,1,0).applyQuaternion(d3),t.positionX){const n=this.context.currentTime+this.timeDelta;t.positionX.linearRampToValueAtTime(Hg.x,n),t.positionY.linearRampToValueAtTime(Hg.y,n),t.positionZ.linearRampToValueAtTime(Hg.z,n),t.forwardX.linearRampToValueAtTime(Wg.x,n),t.forwardY.linearRampToValueAtTime(Wg.y,n),t.forwardZ.linearRampToValueAtTime(Wg.z,n),t.upX.linearRampToValueAtTime(qg.x,n),t.upY.linearRampToValueAtTime(qg.y,n),t.upZ.linearRampToValueAtTime(qg.z,n)}else t.setPosition(Hg.x,Hg.y,Hg.z),t.setOrientation(Wg.x,Wg.y,Wg.z,qg.x,qg.y,qg.z)}}class A6 extends Fi{constructor(e){super(),this.type="Audio",this.listener=e,this.context=e.context,this.gain=this.context.createGain(),this.gain.connect(e.getInput()),this.autoplay=!1,this.buffer=null,this.detune=0,this.loop=!1,this.loopStart=0,this.loopEnd=0,this.offset=0,this.duration=void 0,this.playbackRate=1,this.isPlaying=!1,this.hasPlaybackControl=!0,this.source=null,this.sourceType="empty",this._startedAt=0,this._progress=0,this._connected=!1,this.filters=[]}getOutput(){return this.gain}setNodeSource(e){return this.hasPlaybackControl=!1,this.sourceType="audioNode",this.source=e,this.connect(),this}setMediaElementSource(e){return this.hasPlaybackControl=!1,this.sourceType="mediaNode",this.source=this.context.createMediaElementSource(e),this.connect(),this}setMediaStreamSource(e){return this.hasPlaybackControl=!1,this.sourceType="mediaStreamNode",this.source=this.context.createMediaStreamSource(e),this.connect(),this}setBuffer(e){return this.buffer=e,this.sourceType="buffer",this.autoplay&&this.play(),this}play(e=0){if(this.isPlaying===!0){Ve("Audio: Audio is already playing.");return}if(this.hasPlaybackControl===!1){Ve("Audio: this Audio has no playback control.");return}this._startedAt=this.context.currentTime+e;const t=this.context.createBufferSource();return t.buffer=this.buffer,t.loop=this.loop,t.loopStart=this.loopStart,t.loopEnd=this.loopEnd,t.onended=this.onEnded.bind(this),t.start(this._startedAt,this._progress+this.offset,this.duration),this.isPlaying=!0,this.source=t,this.setDetune(this.detune),this.setPlaybackRate(this.playbackRate),this.connect()}pause(){if(this.hasPlaybackControl===!1){Ve("Audio: this Audio has no playback control.");return}return this.isPlaying===!0&&(this._progress+=Math.max(this.context.currentTime-this._startedAt,0)*this.playbackRate,this.loop===!0&&(this._progress=this._progress%(this.duration||this.buffer.duration)),this.source.stop(),this.source.onended=null,this.isPlaying=!1),this}stop(e=0){if(this.hasPlaybackControl===!1){Ve("Audio: this Audio has no playback control.");return}return this._progress=0,this.source!==null&&(this.source.stop(this.context.currentTime+e),this.source.onended=null),this.isPlaying=!1,this}connect(){if(this.filters.length>0){this.source.connect(this.filters[0]);for(let e=1,t=this.filters.length;e<t;e++)this.filters[e-1].connect(this.filters[e]);this.filters[this.filters.length-1].connect(this.getOutput())}else this.source.connect(this.getOutput());return this._connected=!0,this}disconnect(){if(this._connected!==!1){if(this.filters.length>0){this.source.disconnect(this.filters[0]);for(let e=1,t=this.filters.length;e<t;e++)this.filters[e-1].disconnect(this.filters[e]);this.filters[this.filters.length-1].disconnect(this.getOutput())}else this.source.disconnect(this.getOutput());return this._connected=!1,this}}getFilters(){return this.filters}setFilters(e){return e||(e=[]),this._connected===!0?(this.disconnect(),this.filters=e.slice(),this.connect()):this.filters=e.slice(),this}setDetune(e){return this.detune=e,this.isPlaying===!0&&this.source.detune!==void 0&&this.source.detune.setTargetAtTime(this.detune,this.context.currentTime,.01),this}getDetune(){return this.detune}getFilter(){return this.getFilters()[0]}setFilter(e){return this.setFilters(e?[e]:[])}setPlaybackRate(e){if(this.hasPlaybackControl===!1){Ve("Audio: this Audio has no playback control.");return}return this.playbackRate=e,this.isPlaying===!0&&this.source.playbackRate.setTargetAtTime(this.playbackRate,this.context.currentTime,.01),this}getPlaybackRate(){return this.playbackRate}onEnded(){this.isPlaying=!1,this._progress=0}getLoop(){return this.hasPlaybackControl===!1?(Ve("Audio: this Audio has no playback control."),!1):this.loop}setLoop(e){if(this.hasPlaybackControl===!1){Ve("Audio: this Audio has no playback control.");return}return this.loop=e,this.isPlaying===!0&&(this.source.loop=this.loop),this}setLoopStart(e){return this.loopStart=e,this}setLoopEnd(e){return this.loopEnd=e,this}getVolume(){return this.gain.gain.value}setVolume(e){return this.gain.gain.setTargetAtTime(e,this.context.currentTime,.01),this}copy(e,t){return super.copy(e,t),e.sourceType!=="buffer"?(Ve("Audio: Audio source type cannot be copied."),this):(this.autoplay=e.autoplay,this.buffer=e.buffer,this.detune=e.detune,this.loop=e.loop,this.loopStart=e.loopStart,this.loopEnd=e.loopEnd,this.offset=e.offset,this.duration=e.duration,this.playbackRate=e.playbackRate,this.hasPlaybackControl=e.hasPlaybackControl,this.sourceType=e.sourceType,this.filters=e.filters.slice(),this)}clone(e){return new this.constructor(this.listener).copy(this,e)}}const Xg=new ne,Pz=new Va,nQ=new ne,$g=new ne;class iQ extends A6{constructor(e){super(e),this.panner=this.context.createPanner(),this.panner.panningModel="HRTF",this.panner.connect(this.gain)}connect(){return super.connect(),this.panner.connect(this.gain),this}disconnect(){return super.disconnect(),this.panner.disconnect(this.gain),this}getOutput(){return this.panner}getRefDistance(){return this.panner.refDistance}setRefDistance(e){return this.panner.refDistance=e,this}getRolloffFactor(){return this.panner.rolloffFactor}setRolloffFactor(e){return this.panner.rolloffFactor=e,this}getDistanceModel(){return this.panner.distanceModel}setDistanceModel(e){return this.panner.distanceModel=e,this}getMaxDistance(){return this.panner.maxDistance}setMaxDistance(e){return this.panner.maxDistance=e,this}setDirectionalCone(e,t,n){return this.panner.coneInnerAngle=e,this.panner.coneOuterAngle=t,this.panner.coneOuterGain=n,this}updateMatrixWorld(e){if(super.updateMatrixWorld(e),this.hasPlaybackControl===!0&&this.isPlaying===!1)return;this.matrixWorld.decompose(Xg,Pz,nQ),$g.set(0,0,1).applyQuaternion(Pz);const t=this.panner;if(t.positionX){const n=this.context.currentTime+this.listener.timeDelta;t.positionX.linearRampToValueAtTime(Xg.x,n),t.positionY.linearRampToValueAtTime(Xg.y,n),t.positionZ.linearRampToValueAtTime(Xg.z,n),t.orientationX.linearRampToValueAtTime($g.x,n),t.orientationY.linearRampToValueAtTime($g.y,n),t.orientationZ.linearRampToValueAtTime($g.z,n)}else t.setPosition(Xg.x,Xg.y,Xg.z),t.setOrientation($g.x,$g.y,$g.z)}}class rQ{constructor(e,t=2048){this.analyser=e.context.createAnalyser(),this.analyser.fftSize=t,this.data=new Uint8Array(this.analyser.frequencyBinCount),e.getOutput().connect(this.analyser)}getFrequencyData(){return this.analyser.getByteFrequencyData(this.data),this.data}getAverageFrequency(){let e=0;const t=this.getFrequencyData();for(let n=0;n<t.length;n++)e+=t[n];return e/t.length}}class w6{constructor(e,t,n){this.binding=e,this.valueSize=n;let i,s,a;switch(t){case"quaternion":i=this._slerp,s=this._slerpAdditive,a=this._setAdditiveIdentityQuaternion,this.buffer=new Float64Array(n*6),this._workIndex=5;break;case"string":case"bool":i=this._select,s=this._select,a=this._setAdditiveIdentityOther,this.buffer=new Array(n*5);break;default:i=this._lerp,s=this._lerpAdditive,a=this._setAdditiveIdentityNumeric,this.buffer=new Float64Array(n*5)}this._mixBufferRegion=i,this._mixBufferRegionAdditive=s,this._setIdentity=a,this._origIndex=3,this._addIndex=4,this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,this.useCount=0,this.referenceCount=0}accumulate(e,t){const n=this.buffer,i=this.valueSize,s=e*i+i;let a=this.cumulativeWeight;if(a===0){for(let o=0;o!==i;++o)n[s+o]=n[o];a=t}else{a+=t;const o=t/a;this._mixBufferRegion(n,s,0,o,i)}this.cumulativeWeight=a}accumulateAdditive(e){const t=this.buffer,n=this.valueSize,i=n*this._addIndex;this.cumulativeWeightAdditive===0&&this._setIdentity(),this._mixBufferRegionAdditive(t,i,0,e,n),this.cumulativeWeightAdditive+=e}apply(e){const t=this.valueSize,n=this.buffer,i=e*t+t,s=this.cumulativeWeight,a=this.cumulativeWeightAdditive,o=this.binding;if(this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,s<1){const l=t*this._origIndex;this._mixBufferRegion(n,i,l,1-s,t)}a>0&&this._mixBufferRegionAdditive(n,i,this._addIndex*t,1,t);for(let l=t,c=t+t;l!==c;++l)if(n[l]!==n[l+t]){o.setValue(n,i);break}}saveOriginalState(){const e=this.binding,t=this.buffer,n=this.valueSize,i=n*this._origIndex;e.getValue(t,i);for(let s=n,a=i;s!==a;++s)t[s]=t[i+s%n];this._setIdentity(),this.cumulativeWeight=0,this.cumulativeWeightAdditive=0}restoreOriginalState(){const e=this.valueSize*3;this.binding.setValue(this.buffer,e)}_setAdditiveIdentityNumeric(){const e=this._addIndex*this.valueSize,t=e+this.valueSize;for(let n=e;n<t;n++)this.buffer[n]=0}_setAdditiveIdentityQuaternion(){this._setAdditiveIdentityNumeric(),this.buffer[this._addIndex*this.valueSize+3]=1}_setAdditiveIdentityOther(){const e=this._origIndex*this.valueSize,t=this._addIndex*this.valueSize;for(let n=0;n<this.valueSize;n++)this.buffer[t+n]=this.buffer[e+n]}_select(e,t,n,i,s){if(i>=.5)for(let a=0;a!==s;++a)e[t+a]=e[n+a]}_slerp(e,t,n,i){Va.slerpFlat(e,t,e,t,e,n,i)}_slerpAdditive(e,t,n,i,s){const a=this._workIndex*s;Va.multiplyQuaternionsFlat(e,a,e,t,e,n),Va.slerpFlat(e,t,e,t,e,a,i)}_lerp(e,t,n,i,s){const a=1-i;for(let o=0;o!==s;++o){const l=t+o;e[l]=e[l]*a+e[n+o]*i}}_lerpAdditive(e,t,n,i,s){for(let a=0;a!==s;++a){const o=t+a;e[o]=e[o]+e[n+a]*i}}}const qL="\\[\\]\\.:\\/",sQ=new RegExp("["+qL+"]","g"),XL="[^"+qL+"]",aQ="[^"+qL.replace("\\.","")+"]",oQ=/((?:WC+[\/:])*)/.source.replace("WC",XL),lQ=/(WCOD+)?/.source.replace("WCOD",aQ),uQ=/(?:\.(WC+)(?:\[(.+)\])?)?/.source.replace("WC",XL),cQ=/\.(WC+)(?:\[(.+)\])?/.source.replace("WC",XL),fQ=new RegExp("^"+oQ+lQ+uQ+cQ+"$"),dQ=["material","materials","bones","map"];class hQ{constructor(e,t,n){const i=n||ki.parseTrackName(t);this._targetGroup=e,this._bindings=e.subscribe_(t,i)}getValue(e,t){this.bind();const n=this._targetGroup.nCachedObjects_,i=this._bindings[n];i!==void 0&&i.getValue(e,t)}setValue(e,t){const n=this._bindings;for(let i=this._targetGroup.nCachedObjects_,s=n.length;i!==s;++i)n[i].setValue(e,t)}bind(){const e=this._bindings;for(let t=this._targetGroup.nCachedObjects_,n=e.length;t!==n;++t)e[t].bind()}unbind(){const e=this._bindings;for(let t=this._targetGroup.nCachedObjects_,n=e.length;t!==n;++t)e[t].unbind()}}class ki{constructor(e,t,n){this.path=t,this.parsedPath=n||ki.parseTrackName(t),this.node=ki.findNode(e,this.parsedPath.nodeName),this.rootNode=e,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}static create(e,t,n){return e&&e.isAnimationObjectGroup?new ki.Composite(e,t,n):new ki(e,t,n)}static sanitizeNodeName(e){return e.replace(/\s/g,"_").replace(sQ,"")}static parseTrackName(e){const t=fQ.exec(e);if(t===null)throw new Error("PropertyBinding: Cannot parse trackName: "+e);const n={nodeName:t[2],objectName:t[3],objectIndex:t[4],propertyName:t[5],propertyIndex:t[6]},i=n.nodeName&&n.nodeName.lastIndexOf(".");if(i!==void 0&&i!==-1){const s=n.nodeName.substring(i+1);dQ.indexOf(s)!==-1&&(n.nodeName=n.nodeName.substring(0,i),n.objectName=s)}if(n.propertyName===null||n.propertyName.length===0)throw new Error("PropertyBinding: can not parse propertyName from trackName: "+e);return n}static findNode(e,t){if(t===void 0||t===""||t==="."||t===-1||t===e.name||t===e.uuid)return e;if(e.skeleton){const n=e.skeleton.getBoneByName(t);if(n!==void 0)return n}if(e.children){const n=function(s){for(let a=0;a<s.length;a++){const o=s[a];if(o.name===t||o.uuid===t)return o;const l=n(o.children);if(l)return l}return null},i=n(e.children);if(i)return i}return null}_getValue_unavailable(){}_setValue_unavailable(){}_getValue_direct(e,t){e[t]=this.targetObject[this.propertyName]}_getValue_array(e,t){const n=this.resolvedProperty;for(let i=0,s=n.length;i!==s;++i)e[t++]=n[i]}_getValue_arrayElement(e,t){e[t]=this.resolvedProperty[this.propertyIndex]}_getValue_toArray(e,t){this.resolvedProperty.toArray(e,t)}_setValue_direct(e,t){this.targetObject[this.propertyName]=e[t]}_setValue_direct_setNeedsUpdate(e,t){this.targetObject[this.propertyName]=e[t],this.targetObject.needsUpdate=!0}_setValue_direct_setMatrixWorldNeedsUpdate(e,t){this.targetObject[this.propertyName]=e[t],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_array(e,t){const n=this.resolvedProperty;for(let i=0,s=n.length;i!==s;++i)n[i]=e[t++]}_setValue_array_setNeedsUpdate(e,t){const n=this.resolvedProperty;for(let i=0,s=n.length;i!==s;++i)n[i]=e[t++];this.targetObject.needsUpdate=!0}_setValue_array_setMatrixWorldNeedsUpdate(e,t){const n=this.resolvedProperty;for(let i=0,s=n.length;i!==s;++i)n[i]=e[t++];this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_arrayElement(e,t){this.resolvedProperty[this.propertyIndex]=e[t]}_setValue_arrayElement_setNeedsUpdate(e,t){this.resolvedProperty[this.propertyIndex]=e[t],this.targetObject.needsUpdate=!0}_setValue_arrayElement_setMatrixWorldNeedsUpdate(e,t){this.resolvedProperty[this.propertyIndex]=e[t],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_fromArray(e,t){this.resolvedProperty.fromArray(e,t)}_setValue_fromArray_setNeedsUpdate(e,t){this.resolvedProperty.fromArray(e,t),this.targetObject.needsUpdate=!0}_setValue_fromArray_setMatrixWorldNeedsUpdate(e,t){this.resolvedProperty.fromArray(e,t),this.targetObject.matrixWorldNeedsUpdate=!0}_getValue_unbound(e,t){this.bind(),this.getValue(e,t)}_setValue_unbound(e,t){this.bind(),this.setValue(e,t)}bind(){let e=this.node;const t=this.parsedPath,n=t.objectName,i=t.propertyName;let s=t.propertyIndex;if(e||(e=ki.findNode(this.rootNode,t.nodeName),this.node=e),this.getValue=this._getValue_unavailable,this.setValue=this._setValue_unavailable,!e){Ve("PropertyBinding: No target node found for track: "+this.path+".");return}if(n){let c=t.objectIndex;switch(n){case"materials":if(!e.material){Ze("PropertyBinding: Can not bind to material as node does not have a material.",this);return}if(!e.material.materials){Ze("PropertyBinding: Can not bind to material.materials as node.material does not have a materials array.",this);return}e=e.material.materials;break;case"bones":if(!e.skeleton){Ze("PropertyBinding: Can not bind to bones as node does not have a skeleton.",this);return}e=e.skeleton.bones;for(let d=0;d<e.length;d++)if(e[d].name===c){c=d;break}break;case"map":if("map"in e){e=e.map;break}if(!e.material){Ze("PropertyBinding: Can not bind to material as node does not have a material.",this);return}if(!e.material.map){Ze("PropertyBinding: Can not bind to material.map as node.material does not have a map.",this);return}e=e.material.map;break;default:if(e[n]===void 0){Ze("PropertyBinding: Can not bind to objectName of node undefined.",this);return}e=e[n]}if(c!==void 0){if(e[c]===void 0){Ze("PropertyBinding: Trying to bind to objectIndex of objectName, but is undefined.",this,e);return}e=e[c]}}const a=e[i];if(a===void 0){const c=t.nodeName;Ze("PropertyBinding: Trying to update property for track: "+c+"."+i+" but it wasn't found.",e);return}let o=this.Versioning.None;this.targetObject=e,e.isMaterial===!0?o=this.Versioning.NeedsUpdate:e.isObject3D===!0&&(o=this.Versioning.MatrixWorldNeedsUpdate);let l=this.BindingType.Direct;if(s!==void 0){if(i==="morphTargetInfluences"){if(!e.geometry){Ze("PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.",this);return}if(!e.geometry.morphAttributes){Ze("PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphAttributes.",this);return}e.morphTargetDictionary[s]!==void 0&&(s=e.morphTargetDictionary[s])}l=this.BindingType.ArrayElement,this.resolvedProperty=a,this.propertyIndex=s}else a.fromArray!==void 0&&a.toArray!==void 0?(l=this.BindingType.HasFromToArray,this.resolvedProperty=a):Array.isArray(a)?(l=this.BindingType.EntireArray,this.resolvedProperty=a):this.propertyName=i;this.getValue=this.GetterByBindingType[l],this.setValue=this.SetterByBindingTypeAndVersioning[l][o]}unbind(){this.node=null,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}}ki.Composite=hQ;ki.prototype.BindingType={Direct:0,EntireArray:1,ArrayElement:2,HasFromToArray:3};ki.prototype.Versioning={None:0,NeedsUpdate:1,MatrixWorldNeedsUpdate:2};ki.prototype.GetterByBindingType=[ki.prototype._getValue_direct,ki.prototype._getValue_array,ki.prototype._getValue_arrayElement,ki.prototype._getValue_toArray];ki.prototype.SetterByBindingTypeAndVersioning=[[ki.prototype._setValue_direct,ki.prototype._setValue_direct_setNeedsUpdate,ki.prototype._setValue_direct_setMatrixWorldNeedsUpdate],[ki.prototype._setValue_array,ki.prototype._setValue_array_setNeedsUpdate,ki.prototype._setValue_array_setMatrixWorldNeedsUpdate],[ki.prototype._setValue_arrayElement,ki.prototype._setValue_arrayElement_setNeedsUpdate,ki.prototype._setValue_arrayElement_setMatrixWorldNeedsUpdate],[ki.prototype._setValue_fromArray,ki.prototype._setValue_fromArray_setNeedsUpdate,ki.prototype._setValue_fromArray_setMatrixWorldNeedsUpdate]];class pQ{constructor(){this.isAnimationObjectGroup=!0,this.uuid=pu(),this._objects=Array.prototype.slice.call(arguments),this.nCachedObjects_=0;const e={};this._indicesByUUID=e;for(let n=0,i=arguments.length;n!==i;++n)e[arguments[n].uuid]=n;this._paths=[],this._parsedPaths=[],this._bindings=[],this._bindingsIndicesByPath={};const t=this;this.stats={objects:{get total(){return t._objects.length},get inUse(){return this.total-t.nCachedObjects_}},get bindingsPerObject(){return t._bindings.length}}}add(){const e=this._objects,t=this._indicesByUUID,n=this._paths,i=this._parsedPaths,s=this._bindings,a=s.length;let o,l=e.length,c=this.nCachedObjects_;for(let d=0,p=arguments.length;d!==p;++d){const y=arguments[d],_=y.uuid;let v=t[_];if(v===void 0){v=l++,t[_]=v,e.push(y);for(let b=0,E=a;b!==E;++b)s[b].push(new ki(y,n[b],i[b]))}else if(v<c){o=e[v];const b=--c,E=e[b];t[E.uuid]=v,e[v]=E,t[_]=b,e[b]=y;for(let T=0,M=a;T!==M;++T){const R=s[T],N=R[b];let P=R[v];R[v]=N,P===void 0&&(P=new ki(y,n[T],i[T])),R[b]=P}}else e[v]!==o&&Ze("AnimationObjectGroup: Different objects with the same UUID detected. Clean the caches or recreate your infrastructure when reloading scenes.")}this.nCachedObjects_=c}remove(){const e=this._objects,t=this._indicesByUUID,n=this._bindings,i=n.length;let s=this.nCachedObjects_;for(let a=0,o=arguments.length;a!==o;++a){const l=arguments[a],c=l.uuid,d=t[c];if(d!==void 0&&d>=s){const p=s++,y=e[p];t[y.uuid]=d,e[d]=y,t[c]=p,e[p]=l;for(let _=0,v=i;_!==v;++_){const b=n[_],E=b[p],T=b[d];b[d]=E,b[p]=T}}}this.nCachedObjects_=s}uncache(){const e=this._objects,t=this._indicesByUUID,n=this._bindings,i=n.length;let s=this.nCachedObjects_,a=e.length;for(let o=0,l=arguments.length;o!==l;++o){const c=arguments[o],d=c.uuid,p=t[d];if(p!==void 0)if(delete t[d],p<s){const y=--s,_=e[y],v=--a,b=e[v];t[_.uuid]=p,e[p]=_,t[b.uuid]=y,e[y]=b,e.pop();for(let E=0,T=i;E!==T;++E){const M=n[E],R=M[y],N=M[v];M[p]=R,M[y]=N,M.pop()}}else{const y=--a,_=e[y];y>0&&(t[_.uuid]=p),e[p]=_,e.pop();for(let v=0,b=i;v!==b;++v){const E=n[v];E[p]=E[y],E.pop()}}}this.nCachedObjects_=s}subscribe_(e,t){const n=this._bindingsIndicesByPath;let i=n[e];const s=this._bindings;if(i!==void 0)return s[i];const a=this._paths,o=this._parsedPaths,l=this._objects,c=l.length,d=this.nCachedObjects_,p=new Array(c);i=s.length,n[e]=i,a.push(e),o.push(t),s.push(p);for(let y=d,_=l.length;y!==_;++y){const v=l[y];p[y]=new ki(v,e,t)}return p}unsubscribe_(e){const t=this._bindingsIndicesByPath,n=t[e];if(n!==void 0){const i=this._paths,s=this._parsedPaths,a=this._bindings,o=a.length-1,l=a[o],c=e[o];t[c]=n,a[n]=l,a.pop(),s[n]=s[o],s.pop(),i[n]=i[o],i.pop()}}}class R6{constructor(e,t,n=null,i=t.blendMode){this._mixer=e,this._clip=t,this._localRoot=n,this.blendMode=i;const s=t.tracks,a=s.length,o=new Array(a),l={endingStart:h0,endingEnd:h0};for(let c=0;c!==a;++c){const d=s[c].createInterpolant(null);o[c]=d,d.settings=l}this._interpolantSettings=l,this._interpolants=o,this._propertyBindings=new Array(a),this._cacheIndex=null,this._byClipCacheIndex=null,this._timeScaleInterpolant=null,this._weightInterpolant=null,this.loop=Nk,this._loopCount=-1,this._startTime=null,this.time=0,this.timeScale=1,this._effectiveTimeScale=1,this.weight=1,this._effectiveWeight=1,this.repetitions=1/0,this.paused=!1,this.enabled=!0,this.clampWhenFinished=!1,this.zeroSlopeAtStart=!0,this.zeroSlopeAtEnd=!0}play(){return this._mixer._activateAction(this),this}stop(){return this._mixer._deactivateAction(this),this.reset()}reset(){return this.paused=!1,this.enabled=!0,this.time=0,this._loopCount=-1,this._startTime=null,this.stopFading().stopWarping()}isRunning(){return this.enabled&&!this.paused&&this.timeScale!==0&&this._startTime===null&&this._mixer._isActiveAction(this)}isScheduled(){return this._mixer._isActiveAction(this)}startAt(e){return this._startTime=e,this}setLoop(e,t){return this.loop=e,this.repetitions=t,this}setEffectiveWeight(e){return this.weight=e,this._effectiveWeight=this.enabled?e:0,this.stopFading()}getEffectiveWeight(){return this._effectiveWeight}fadeIn(e){return this._scheduleFading(e,0,1)}fadeOut(e){return this._scheduleFading(e,1,0)}crossFadeFrom(e,t,n=!1){if(e.fadeOut(t),this.fadeIn(t),n===!0){const i=this._clip.duration,s=e._clip.duration,a=s/i,o=i/s;e.warp(1,a,t),this.warp(o,1,t)}return this}crossFadeTo(e,t,n=!1){return e.crossFadeFrom(this,t,n)}stopFading(){const e=this._weightInterpolant;return e!==null&&(this._weightInterpolant=null,this._mixer._takeBackControlInterpolant(e)),this}setEffectiveTimeScale(e){return this.timeScale=e,this._effectiveTimeScale=this.paused?0:e,this.stopWarping()}getEffectiveTimeScale(){return this._effectiveTimeScale}setDuration(e){return this.timeScale=this._clip.duration/e,this.stopWarping()}syncWith(e){return this.time=e.time,this.timeScale=e.timeScale,this.stopWarping()}halt(e){return this.warp(this._effectiveTimeScale,0,e)}warp(e,t,n){const i=this._mixer,s=i.time,a=this.timeScale;let o=this._timeScaleInterpolant;o===null&&(o=i._lendControlInterpolant(),this._timeScaleInterpolant=o);const l=o.parameterPositions,c=o.sampleValues;return l[0]=s,l[1]=s+n,c[0]=e/a,c[1]=t/a,this}stopWarping(){const e=this._timeScaleInterpolant;return e!==null&&(this._timeScaleInterpolant=null,this._mixer._takeBackControlInterpolant(e)),this}getMixer(){return this._mixer}getClip(){return this._clip}getRoot(){return this._localRoot||this._mixer._root}_update(e,t,n,i){if(!this.enabled){this._updateWeight(e);return}const s=this._startTime;if(s!==null){const l=(e-s)*n;l<0||n===0?t=0:(this._startTime=null,t=n*l)}t*=this._updateTimeScale(e);const a=this._updateTime(t),o=this._updateWeight(e);if(o>0){const l=this._interpolants,c=this._propertyBindings;switch(this.blendMode){case tL:for(let d=0,p=l.length;d!==p;++d)l[d].evaluate(a),c[d].accumulateAdditive(o);break;case gC:default:for(let d=0,p=l.length;d!==p;++d)l[d].evaluate(a),c[d].accumulate(i,o)}}}_updateWeight(e){let t=0;if(this.enabled){t=this.weight;const n=this._weightInterpolant;if(n!==null){const i=n.evaluate(e)[0];t*=i,e>n.parameterPositions[1]&&(this.stopFading(),i===0&&(this.enabled=!1))}}return this._effectiveWeight=t,t}_updateTimeScale(e){let t=0;if(!this.paused){t=this.timeScale;const n=this._timeScaleInterpolant;if(n!==null){const i=n.evaluate(e)[0];t*=i,e>n.parameterPositions[1]&&(this.stopWarping(),t===0?this.paused=!0:this.timeScale=t)}}return this._effectiveTimeScale=t,t}_updateTime(e){const t=this._clip.duration,n=this.loop;let i=this.time+e,s=this._loopCount;const a=n===Dk;if(e===0)return s===-1?i:a&&(s&1)===1?t-i:i;if(n===Ck){s===-1&&(this._loopCount=0,this._setEndings(!0,!0,!1));e:{if(i>=t)i=t;else if(i<0)i=0;else{this.time=i;break e}this.clampWhenFinished?this.paused=!0:this.enabled=!1,this.time=i,this._mixer.dispatchEvent({type:"finished",action:this,direction:e<0?-1:1})}}else{if(s===-1&&(e>=0?(s=0,this._setEndings(!0,this.repetitions===0,a)):this._setEndings(this.repetitions===0,!0,a)),i>=t||i<0){const o=Math.floor(i/t);i-=t*o,s+=Math.abs(o);const l=this.repetitions-s;if(l<=0)this.clampWhenFinished?this.paused=!0:this.enabled=!1,i=e>0?t:0,this.time=i,this._mixer.dispatchEvent({type:"finished",action:this,direction:e>0?1:-1});else{if(l===1){const c=e<0;this._setEndings(c,!c,a)}else this._setEndings(!1,!1,a);this._loopCount=s,this.time=i,this._mixer.dispatchEvent({type:"loop",action:this,loopDelta:o})}}else this.time=i;if(a&&(s&1)===1)return t-i}return i}_setEndings(e,t,n){const i=this._interpolantSettings;n?(i.endingStart=p0,i.endingEnd=p0):(e?i.endingStart=this.zeroSlopeAtStart?p0:h0:i.endingStart=n1,t?i.endingEnd=this.zeroSlopeAtEnd?p0:h0:i.endingEnd=n1)}_scheduleFading(e,t,n){const i=this._mixer,s=i.time;let a=this._weightInterpolant;a===null&&(a=i._lendControlInterpolant(),this._weightInterpolant=a);const o=a.parameterPositions,l=a.sampleValues;return o[0]=s,l[0]=t,o[1]=s+e,l[1]=n,this}}const mQ=new Float32Array(1);class gQ extends Gl{constructor(e){super(),this._root=e,this._initMemoryManager(),this._accuIndex=0,this.time=0,this.timeScale=1}_bindAction(e,t){const n=e._localRoot||this._root,i=e._clip.tracks,s=i.length,a=e._propertyBindings,o=e._interpolants,l=n.uuid,c=this._bindingsByRootAndName;let d=c[l];d===void 0&&(d={},c[l]=d);for(let p=0;p!==s;++p){const y=i[p],_=y.name;let v=d[_];if(v!==void 0)++v.referenceCount,a[p]=v;else{if(v=a[p],v!==void 0){v._cacheIndex===null&&(++v.referenceCount,this._addInactiveBinding(v,l,_));continue}const b=t&&t._propertyBindings[p].binding.parsedPath;v=new w6(ki.create(n,_,b),y.ValueTypeName,y.getValueSize()),++v.referenceCount,this._addInactiveBinding(v,l,_),a[p]=v}o[p].resultBuffer=v.buffer}}_activateAction(e){if(!this._isActiveAction(e)){if(e._cacheIndex===null){const n=(e._localRoot||this._root).uuid,i=e._clip.uuid,s=this._actionsByClip[i];this._bindAction(e,s&&s.knownActions[0]),this._addInactiveAction(e,i,n)}const t=e._propertyBindings;for(let n=0,i=t.length;n!==i;++n){const s=t[n];s.useCount++===0&&(this._lendBinding(s),s.saveOriginalState())}this._lendAction(e)}}_deactivateAction(e){if(this._isActiveAction(e)){const t=e._propertyBindings;for(let n=0,i=t.length;n!==i;++n){const s=t[n];--s.useCount===0&&(s.restoreOriginalState(),this._takeBackBinding(s))}this._takeBackAction(e)}}_initMemoryManager(){this._actions=[],this._nActiveActions=0,this._actionsByClip={},this._bindings=[],this._nActiveBindings=0,this._bindingsByRootAndName={},this._controlInterpolants=[],this._nActiveControlInterpolants=0;const e=this;this.stats={actions:{get total(){return e._actions.length},get inUse(){return e._nActiveActions}},bindings:{get total(){return e._bindings.length},get inUse(){return e._nActiveBindings}},controlInterpolants:{get total(){return e._controlInterpolants.length},get inUse(){return e._nActiveControlInterpolants}}}}_isActiveAction(e){const t=e._cacheIndex;return t!==null&&t<this._nActiveActions}_addInactiveAction(e,t,n){const i=this._actions,s=this._actionsByClip;let a=s[t];if(a===void 0)a={knownActions:[e],actionByRoot:{}},e._byClipCacheIndex=0,s[t]=a;else{const o=a.knownActions;e._byClipCacheIndex=o.length,o.push(e)}e._cacheIndex=i.length,i.push(e),a.actionByRoot[n]=e}_removeInactiveAction(e){const t=this._actions,n=t[t.length-1],i=e._cacheIndex;n._cacheIndex=i,t[i]=n,t.pop(),e._cacheIndex=null;const s=e._clip.uuid,a=this._actionsByClip,o=a[s],l=o.knownActions,c=l[l.length-1],d=e._byClipCacheIndex;c._byClipCacheIndex=d,l[d]=c,l.pop(),e._byClipCacheIndex=null;const p=o.actionByRoot,y=(e._localRoot||this._root).uuid;delete p[y],l.length===0&&delete a[s],this._removeInactiveBindingsForAction(e)}_removeInactiveBindingsForAction(e){const t=e._propertyBindings;for(let n=0,i=t.length;n!==i;++n){const s=t[n];--s.referenceCount===0&&this._removeInactiveBinding(s)}}_lendAction(e){const t=this._actions,n=e._cacheIndex,i=this._nActiveActions++,s=t[i];e._cacheIndex=i,t[i]=e,s._cacheIndex=n,t[n]=s}_takeBackAction(e){const t=this._actions,n=e._cacheIndex,i=--this._nActiveActions,s=t[i];e._cacheIndex=i,t[i]=e,s._cacheIndex=n,t[n]=s}_addInactiveBinding(e,t,n){const i=this._bindingsByRootAndName,s=this._bindings;let a=i[t];a===void 0&&(a={},i[t]=a),a[n]=e,e._cacheIndex=s.length,s.push(e)}_removeInactiveBinding(e){const t=this._bindings,n=e.binding,i=n.rootNode.uuid,s=n.path,a=this._bindingsByRootAndName,o=a[i],l=t[t.length-1],c=e._cacheIndex;l._cacheIndex=c,t[c]=l,t.pop(),delete o[s],Object.keys(o).length===0&&delete a[i]}_lendBinding(e){const t=this._bindings,n=e._cacheIndex,i=this._nActiveBindings++,s=t[i];e._cacheIndex=i,t[i]=e,s._cacheIndex=n,t[n]=s}_takeBackBinding(e){const t=this._bindings,n=e._cacheIndex,i=--this._nActiveBindings,s=t[i];e._cacheIndex=i,t[i]=e,s._cacheIndex=n,t[n]=s}_lendControlInterpolant(){const e=this._controlInterpolants,t=this._nActiveControlInterpolants++;let n=e[t];return n===void 0&&(n=new DL(new Float32Array(2),new Float32Array(2),1,mQ),n.__cacheIndex=t,e[t]=n),n}_takeBackControlInterpolant(e){const t=this._controlInterpolants,n=e.__cacheIndex,i=--this._nActiveControlInterpolants,s=t[i];e.__cacheIndex=i,t[i]=e,s.__cacheIndex=n,t[n]=s}clipAction(e,t,n){const i=t||this._root,s=i.uuid;let a=typeof e=="string"?u1.findByName(i,e):e;const o=a!==null?a.uuid:e,l=this._actionsByClip[o];let c=null;if(n===void 0&&(a!==null?n=a.blendMode:n=gC),l!==void 0){const p=l.actionByRoot[s];if(p!==void 0&&p.blendMode===n)return p;c=l.knownActions[0],a===null&&(a=c._clip)}if(a===null)return null;const d=new R6(this,a,t,n);return this._bindAction(d,c),this._addInactiveAction(d,o,s),d}existingAction(e,t){const n=t||this._root,i=n.uuid,s=typeof e=="string"?u1.findByName(n,e):e,a=s?s.uuid:e,o=this._actionsByClip[a];return o!==void 0&&o.actionByRoot[i]||null}stopAllAction(){const e=this._actions,t=this._nActiveActions;for(let n=t-1;n>=0;--n)e[n].stop();return this}update(e){e*=this.timeScale;const t=this._actions,n=this._nActiveActions,i=this.time+=e,s=Math.sign(e),a=this._accuIndex^=1;for(let c=0;c!==n;++c)t[c]._update(i,e,s,a);const o=this._bindings,l=this._nActiveBindings;for(let c=0;c!==l;++c)o[c].apply(a);return this}setTime(e){this.time=0;for(let t=0;t<this._actions.length;t++)this._actions[t].time=0;return this.update(e)}getRoot(){return this._root}uncacheClip(e){const t=this._actions,n=e.uuid,i=this._actionsByClip,s=i[n];if(s!==void 0){const a=s.knownActions;for(let o=0,l=a.length;o!==l;++o){const c=a[o];this._deactivateAction(c);const d=c._cacheIndex,p=t[t.length-1];c._cacheIndex=null,c._byClipCacheIndex=null,p._cacheIndex=d,t[d]=p,t.pop(),this._removeInactiveBindingsForAction(c)}delete i[n]}}uncacheRoot(e){const t=e.uuid,n=this._actionsByClip;for(const a in n){const o=n[a].actionByRoot,l=o[t];l!==void 0&&(this._deactivateAction(l),this._removeInactiveAction(l))}const i=this._bindingsByRootAndName,s=i[t];if(s!==void 0)for(const a in s){const o=s[a];o.restoreOriginalState(),this._removeInactiveBinding(o)}}uncacheAction(e,t){const n=this.existingAction(e,t);n!==null&&(this._deactivateAction(n),this._removeInactiveAction(n))}}class yQ extends sf{constructor(e=1,t=1,n=1,i={}){super(e,t,i),this.isRenderTarget3D=!0,this.depth=n,this.texture=new SC(null,e,t,n),this._setTextureOptions(i),this.texture.isRenderTargetTexture=!0}}let _Q=class C6{constructor(e){this.value=e}clone(){return new C6(this.value.clone===void 0?this.value:this.value.clone())}},vQ=0,xQ=class extends Gl{constructor(){super(),this.isUniformsGroup=!0,Object.defineProperty(this,"id",{value:vQ++}),this.name="",this.usage=xm,this.uniforms=[]}add(e){return this.uniforms.push(e),this}remove(e){const t=this.uniforms.indexOf(e);return t!==-1&&this.uniforms.splice(t,1),this}setName(e){return this.name=e,this}setUsage(e){return this.usage=e,this}dispose(){this.dispatchEvent({type:"dispose"})}copy(e){this.name=e.name,this.usage=e.usage;const t=e.uniforms;this.uniforms.length=0;for(let n=0,i=t.length;n<i;n++){const s=Array.isArray(t[n])?t[n]:[t[n]];for(let a=0;a<s.length;a++)this.uniforms.push(s[a].clone())}return this}clone(){return new this.constructor().copy(this)}};class N6 extends H1{constructor(e,t,n=1){super(e,t),this.isInstancedInterleavedBuffer=!0,this.meshPerAttribute=n}copy(e){return super.copy(e),this.meshPerAttribute=e.meshPerAttribute,this}clone(e){const t=super.clone(e);return t.meshPerAttribute=this.meshPerAttribute,t}toJSON(e){const t=super.toJSON(e);return t.isInstancedInterleavedBuffer=!0,t.meshPerAttribute=this.meshPerAttribute,t}}class bQ{constructor(e,t,n,i,s,a=!1){this.isGLBufferAttribute=!0,this.name="",this.buffer=e,this.type=t,this.itemSize=n,this.elementSize=i,this.count=s,this.normalized=a,this.version=0}set needsUpdate(e){e===!0&&this.version++}setBuffer(e){return this.buffer=e,this}setType(e,t){return this.type=e,this.elementSize=t,this}setItemSize(e){return this.itemSize=e,this}setCount(e){return this.count=e,this}}const Bz=new gn;class $L{constructor(e,t,n=0,i=1/0){this.ray=new wy(e,t),this.near=n,this.far=i,this.camera=null,this.layers=new yx,this.params={Mesh:{},Line:{threshold:1},LOD:{},Points:{threshold:1},Sprite:{}}}set(e,t){this.ray.set(e,t)}setFromCamera(e,t){t.isPerspectiveCamera?(this.ray.origin.setFromMatrixPosition(t.matrixWorld),this.ray.direction.set(e.x,e.y,.5).unproject(t).sub(this.ray.origin).normalize(),this.camera=t):t.isOrthographicCamera?(this.ray.origin.set(e.x,e.y,(t.near+t.far)/(t.near-t.far)).unproject(t),this.ray.direction.set(0,0,-1).transformDirection(t.matrixWorld),this.camera=t):Ze("Raycaster: Unsupported camera type: "+t.type)}setFromXRController(e){return Bz.identity().extractRotation(e.matrixWorld),this.ray.origin.setFromMatrixPosition(e.matrixWorld),this.ray.direction.set(0,0,-1).applyMatrix4(Bz),this}intersectObject(e,t=!0,n=[]){return mO(e,this,n,t),n.sort(Iz),n}intersectObjects(e,t=!0,n=[]){for(let i=0,s=e.length;i<s;i++)mO(e[i],this,n,t);return n.sort(Iz),n}}function Iz(r,e){return r.distance-e.distance}function mO(r,e,t,n){let i=!0;if(r.layers.test(e.layers)&&r.raycast(e,t)===!1&&(i=!1),i===!0&&n===!0){const s=r.children;for(let a=0,o=s.length;a<o;a++)mO(s[a],e,t,!0)}}class SQ{constructor(){this._previousTime=0,this._currentTime=0,this._startTime=performance.now(),this._delta=0,this._elapsed=0,this._timescale=1,this._document=null,this._pageVisibilityHandler=null}connect(e){this._document=e,e.hidden!==void 0&&(this._pageVisibilityHandler=TQ.bind(this),e.addEventListener("visibilitychange",this._pageVisibilityHandler,!1))}disconnect(){this._pageVisibilityHandler!==null&&(this._document.removeEventListener("visibilitychange",this._pageVisibilityHandler),this._pageVisibilityHandler=null),this._document=null}getDelta(){return this._delta/1e3}getElapsed(){return this._elapsed/1e3}getTimescale(){return this._timescale}setTimescale(e){return this._timescale=e,this}reset(){return this._currentTime=performance.now()-this._startTime,this}dispose(){this.disconnect()}update(e){return this._pageVisibilityHandler!==null&&this._document.hidden===!0?this._delta=0:(this._previousTime=this._currentTime,this._currentTime=(e!==void 0?e:performance.now())-this._startTime,this._delta=(this._currentTime-this._previousTime)*this._timescale,this._elapsed+=this._delta),this}}function TQ(){this._document.hidden===!1&&this.reset()}class gO{constructor(e=1,t=0,n=0){this.radius=e,this.phi=t,this.theta=n}set(e,t,n){return this.radius=e,this.phi=t,this.theta=n,this}copy(e){return this.radius=e.radius,this.phi=e.phi,this.theta=e.theta,this}makeSafe(){return this.phi=Yn(this.phi,1e-6,Math.PI-1e-6),this}setFromVector3(e){return this.setFromCartesianCoords(e.x,e.y,e.z)}setFromCartesianCoords(e,t,n){return this.radius=Math.sqrt(e*e+t*t+n*n),this.radius===0?(this.theta=0,this.phi=0):(this.theta=Math.atan2(e,n),this.phi=Math.acos(Yn(t/this.radius,-1,1))),this}clone(){return new this.constructor().copy(this)}}class EQ{constructor(e=1,t=0,n=0){this.radius=e,this.theta=t,this.y=n}set(e,t,n){return this.radius=e,this.theta=t,this.y=n,this}copy(e){return this.radius=e.radius,this.theta=e.theta,this.y=e.y,this}setFromVector3(e){return this.setFromCartesianCoords(e.x,e.y,e.z)}setFromCartesianCoords(e,t,n){return this.radius=Math.sqrt(e*e+n*n),this.theta=Math.atan2(e,n),this.y=t,this}clone(){return new this.constructor().copy(this)}}class K1{constructor(e,t,n,i){K1.prototype.isMatrix2=!0,this.elements=[1,0,0,1],e!==void 0&&this.set(e,t,n,i)}identity(){return this.set(1,0,0,1),this}fromArray(e,t=0){for(let n=0;n<4;n++)this.elements[n]=e[n+t];return this}set(e,t,n,i){const s=this.elements;return s[0]=e,s[2]=t,s[1]=n,s[3]=i,this}}const Fz=new tt;class MQ{constructor(e=new tt(1/0,1/0),t=new tt(-1/0,-1/0)){this.isBox2=!0,this.min=e,this.max=t}set(e,t){return this.min.copy(e),this.max.copy(t),this}setFromPoints(e){this.makeEmpty();for(let t=0,n=e.length;t<n;t++)this.expandByPoint(e[t]);return this}setFromCenterAndSize(e,t){const n=Fz.copy(t).multiplyScalar(.5);return this.min.copy(e).sub(n),this.max.copy(e).add(n),this}clone(){return new this.constructor().copy(this)}copy(e){return this.min.copy(e.min),this.max.copy(e.max),this}makeEmpty(){return this.min.x=this.min.y=1/0,this.max.x=this.max.y=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y}getCenter(e){return this.isEmpty()?e.set(0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(e){return this.isEmpty()?e.set(0,0):e.subVectors(this.max,this.min)}expandByPoint(e){return this.min.min(e),this.max.max(e),this}expandByVector(e){return this.min.sub(e),this.max.add(e),this}expandByScalar(e){return this.min.addScalar(-e),this.max.addScalar(e),this}containsPoint(e){return e.x>=this.min.x&&e.x<=this.max.x&&e.y>=this.min.y&&e.y<=this.max.y}containsBox(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y}getParameter(e,t){return t.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y))}intersectsBox(e){return e.max.x>=this.min.x&&e.min.x<=this.max.x&&e.max.y>=this.min.y&&e.min.y<=this.max.y}clampPoint(e,t){return t.copy(e).clamp(this.min,this.max)}distanceToPoint(e){return this.clampPoint(e,Fz).distanceTo(e)}intersect(e){return this.min.max(e.min),this.max.min(e.max),this.isEmpty()&&this.makeEmpty(),this}union(e){return this.min.min(e.min),this.max.max(e.max),this}translate(e){return this.min.add(e),this.max.add(e),this}equals(e){return e.min.equals(this.min)&&e.max.equals(this.max)}}const zz=new ne,bA=new ne,lv=new ne,uv=new ne,h3=new ne,AQ=new ne,wQ=new ne;class RQ{constructor(e=new ne,t=new ne){this.start=e,this.end=t}set(e,t){return this.start.copy(e),this.end.copy(t),this}copy(e){return this.start.copy(e.start),this.end.copy(e.end),this}getCenter(e){return e.addVectors(this.start,this.end).multiplyScalar(.5)}delta(e){return e.subVectors(this.end,this.start)}distanceSq(){return this.start.distanceToSquared(this.end)}distance(){return this.start.distanceTo(this.end)}at(e,t){return this.delta(t).multiplyScalar(e).add(this.start)}closestPointToPointParameter(e,t){zz.subVectors(e,this.start),bA.subVectors(this.end,this.start);const n=bA.dot(bA);let s=bA.dot(zz)/n;return t&&(s=Yn(s,0,1)),s}closestPointToPoint(e,t,n){const i=this.closestPointToPointParameter(e,t);return this.delta(n).multiplyScalar(i).add(this.start)}distanceSqToLine3(e,t=AQ,n=wQ){const i=10000000000000001e-32;let s,a;const o=this.start,l=e.start,c=this.end,d=e.end;lv.subVectors(c,o),uv.subVectors(d,l),h3.subVectors(o,l);const p=lv.dot(lv),y=uv.dot(uv),_=uv.dot(h3);if(p<=i&&y<=i)return t.copy(o),n.copy(l),t.sub(n),t.dot(t);if(p<=i)s=0,a=_/y,a=Yn(a,0,1);else{const v=lv.dot(h3);if(y<=i)a=0,s=Yn(-v/p,0,1);else{const b=lv.dot(uv),E=p*y-b*b;E!==0?s=Yn((b*_-v*y)/E,0,1):s=0,a=(b*s+_)/y,a<0?(a=0,s=Yn(-v/p,0,1)):a>1&&(a=1,s=Yn((b-v)/p,0,1))}}return t.copy(o).add(lv.multiplyScalar(s)),n.copy(l).add(uv.multiplyScalar(a)),t.sub(n),t.dot(t)}applyMatrix4(e){return this.start.applyMatrix4(e),this.end.applyMatrix4(e),this}equals(e){return e.start.equals(this.start)&&e.end.equals(this.end)}clone(){return new this.constructor().copy(this)}}const Vz=new ne;class CQ extends Fi{constructor(e,t){super(),this.light=e,this.matrixAutoUpdate=!1,this.color=t,this.type="SpotLightHelper";const n=new Qn,i=[0,0,0,0,0,1,0,0,0,1,0,1,0,0,0,-1,0,1,0,0,0,0,1,1,0,0,0,0,-1,1];for(let a=0,o=1,l=32;a<l;a++,o++){const c=a/l*Math.PI*2,d=o/l*Math.PI*2;i.push(Math.cos(c),Math.sin(c),1,Math.cos(d),Math.sin(d),1)}n.setAttribute("position",new hn(i,3));const s=new bo({fog:!1,toneMapped:!1});this.cone=new xd(n,s),this.add(this.cone),this.update()}dispose(){this.cone.geometry.dispose(),this.cone.material.dispose()}update(){this.light.updateWorldMatrix(!0,!1),this.light.target.updateWorldMatrix(!0,!1),this.parent?(this.parent.updateWorldMatrix(!0),this.matrix.copy(this.parent.matrixWorld).invert().multiply(this.light.matrixWorld)):this.matrix.copy(this.light.matrixWorld),this.matrixWorld.copy(this.light.matrixWorld);const e=this.light.distance?this.light.distance:1e3,t=e*Math.tan(this.light.angle);this.cone.scale.set(t,t,e),Vz.setFromMatrixPosition(this.light.target.matrixWorld),this.cone.lookAt(Vz),this.color!==void 0?this.cone.material.color.set(this.color):this.cone.material.color.copy(this.light.color)}}const kp=new ne,SA=new gn,p3=new gn;class NQ extends xd{constructor(e){const t=D6(e),n=new Qn,i=[],s=[];for(let c=0;c<t.length;c++){const d=t[c];d.parent&&d.parent.isBone&&(i.push(0,0,0),i.push(0,0,0),s.push(0,0,0),s.push(0,0,0))}n.setAttribute("position",new hn(i,3)),n.setAttribute("color",new hn(s,3));const a=new bo({vertexColors:!0,depthTest:!1,depthWrite:!1,toneMapped:!1,transparent:!0});super(n,a),this.isSkeletonHelper=!0,this.type="SkeletonHelper",this.root=e,this.bones=t,this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1;const o=new Kt(255),l=new Kt(65280);this.setColors(o,l)}updateMatrixWorld(e){const t=this.bones,n=this.geometry,i=n.getAttribute("position");p3.copy(this.root.matrixWorld).invert();for(let s=0,a=0;s<t.length;s++){const o=t[s];o.parent&&o.parent.isBone&&(SA.multiplyMatrices(p3,o.matrixWorld),kp.setFromMatrixPosition(SA),i.setXYZ(a,kp.x,kp.y,kp.z),SA.multiplyMatrices(p3,o.parent.matrixWorld),kp.setFromMatrixPosition(SA),i.setXYZ(a+1,kp.x,kp.y,kp.z),a+=2)}n.getAttribute("position").needsUpdate=!0,super.updateMatrixWorld(e)}setColors(e,t){const i=this.geometry.getAttribute("color");for(let s=0;s<i.count;s+=2)i.setXYZ(s,e.r,e.g,e.b),i.setXYZ(s+1,t.r,t.g,t.b);return i.needsUpdate=!0,this}dispose(){this.geometry.dispose(),this.material.dispose()}}function D6(r){const e=[];r.isBone===!0&&e.push(r);for(let t=0;t<r.children.length;t++)e.push(...D6(r.children[t]));return e}class DQ extends ar{constructor(e,t,n){const i=new Hx(t,4,2),s=new lo({wireframe:!0,fog:!1,toneMapped:!1});super(i,s),this.light=e,this.color=n,this.type="PointLightHelper",this.matrix=this.light.matrixWorld,this.matrixAutoUpdate=!1,this.update()}dispose(){this.geometry.dispose(),this.material.dispose()}update(){this.light.updateWorldMatrix(!0,!1),this.color!==void 0?this.material.color.set(this.color):this.material.color.copy(this.light.color)}}const OQ=new ne,Gz=new Kt,kz=new Kt;class UQ extends Fi{constructor(e,t,n){super(),this.light=e,this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.color=n,this.type="HemisphereLightHelper";const i=new $1(t);i.rotateY(Math.PI*.5),this.material=new lo({wireframe:!0,fog:!1,toneMapped:!1}),this.color===void 0&&(this.material.vertexColors=!0);const s=i.getAttribute("position"),a=new Float32Array(s.count*3);i.setAttribute("color",new Ji(a,3)),this.add(new ar(i,this.material)),this.update()}dispose(){this.children[0].geometry.dispose(),this.children[0].material.dispose()}update(){const e=this.children[0];if(this.color!==void 0)this.material.color.set(this.color);else{const t=e.geometry.getAttribute("color");Gz.copy(this.light.color),kz.copy(this.light.groundColor);for(let n=0,i=t.count;n<i;n++){const s=n<i/2?Gz:kz;t.setXYZ(n,s.r,s.g,s.b)}t.needsUpdate=!0}this.light.updateWorldMatrix(!0,!1),e.lookAt(OQ.setFromMatrixPosition(this.light.matrixWorld).negate())}}class LQ extends xd{constructor(e=10,t=10,n=4473924,i=8947848){n=new Kt(n),i=new Kt(i);const s=t/2,a=e/t,o=e/2,l=[],c=[];for(let y=0,_=0,v=-o;y<=t;y++,v+=a){l.push(-o,0,v,o,0,v),l.push(v,0,-o,v,0,o);const b=y===s?n:i;b.toArray(c,_),_+=3,b.toArray(c,_),_+=3,b.toArray(c,_),_+=3,b.toArray(c,_),_+=3}const d=new Qn;d.setAttribute("position",new hn(l,3)),d.setAttribute("color",new hn(c,3));const p=new bo({vertexColors:!0,toneMapped:!1});super(d,p),this.type="GridHelper"}dispose(){this.geometry.dispose(),this.material.dispose()}}class PQ extends xd{constructor(e=10,t=16,n=8,i=64,s=4473924,a=8947848){s=new Kt(s),a=new Kt(a);const o=[],l=[];if(t>1)for(let p=0;p<t;p++){const y=p/t*(Math.PI*2),_=Math.sin(y)*e,v=Math.cos(y)*e;o.push(0,0,0),o.push(_,0,v);const b=p&1?s:a;l.push(b.r,b.g,b.b),l.push(b.r,b.g,b.b)}for(let p=0;p<n;p++){const y=p&1?s:a,_=e-e/n*p;for(let v=0;v<i;v++){let b=v/i*(Math.PI*2),E=Math.sin(b)*_,T=Math.cos(b)*_;o.push(E,0,T),l.push(y.r,y.g,y.b),b=(v+1)/i*(Math.PI*2),E=Math.sin(b)*_,T=Math.cos(b)*_,o.push(E,0,T),l.push(y.r,y.g,y.b)}}const c=new Qn;c.setAttribute("position",new hn(o,3)),c.setAttribute("color",new hn(l,3));const d=new bo({vertexColors:!0,toneMapped:!1});super(c,d),this.type="PolarGridHelper"}dispose(){this.geometry.dispose(),this.material.dispose()}}const Hz=new ne,TA=new ne,Wz=new ne;class BQ extends Fi{constructor(e,t,n){super(),this.light=e,this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.color=n,this.type="DirectionalLightHelper",t===void 0&&(t=1);let i=new Qn;i.setAttribute("position",new hn([-t,t,0,t,t,0,t,-t,0,-t,-t,0,-t,t,0],3));const s=new bo({fog:!1,toneMapped:!1});this.lightPlane=new Tm(i,s),this.add(this.lightPlane),i=new Qn,i.setAttribute("position",new hn([0,0,0,0,0,1],3)),this.targetLine=new Tm(i,s),this.add(this.targetLine),this.update()}dispose(){this.lightPlane.geometry.dispose(),this.lightPlane.material.dispose(),this.targetLine.geometry.dispose(),this.targetLine.material.dispose()}update(){this.light.updateWorldMatrix(!0,!1),this.light.target.updateWorldMatrix(!0,!1),Hz.setFromMatrixPosition(this.light.matrixWorld),TA.setFromMatrixPosition(this.light.target.matrixWorld),Wz.subVectors(TA,Hz),this.lightPlane.lookAt(TA),this.color!==void 0?(this.lightPlane.material.color.set(this.color),this.targetLine.material.color.set(this.color)):(this.lightPlane.material.color.copy(this.light.color),this.targetLine.material.color.copy(this.light.color)),this.targetLine.lookAt(TA),this.targetLine.scale.z=Wz.length()}}const EA=new ne,vs=new G1;class IQ extends xd{constructor(e){const t=new Qn,n=new bo({color:16777215,vertexColors:!0,toneMapped:!1}),i=[],s=[],a={};o("n1","n2"),o("n2","n4"),o("n4","n3"),o("n3","n1"),o("f1","f2"),o("f2","f4"),o("f4","f3"),o("f3","f1"),o("n1","f1"),o("n2","f2"),o("n3","f3"),o("n4","f4"),o("p","n1"),o("p","n2"),o("p","n3"),o("p","n4"),o("u1","u2"),o("u2","u3"),o("u3","u1"),o("c","t"),o("p","c"),o("cn1","cn2"),o("cn3","cn4"),o("cf1","cf2"),o("cf3","cf4");function o(v,b){l(v),l(b)}function l(v){i.push(0,0,0),s.push(0,0,0),a[v]===void 0&&(a[v]=[]),a[v].push(i.length/3-1)}t.setAttribute("position",new hn(i,3)),t.setAttribute("color",new hn(s,3)),super(t,n),this.type="CameraHelper",this.camera=e,this.camera.updateProjectionMatrix&&this.camera.updateProjectionMatrix(),this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.pointMap=a,this.update();const c=new Kt(16755200),d=new Kt(16711680),p=new Kt(43775),y=new Kt(16777215),_=new Kt(3355443);this.setColors(c,d,p,y,_)}setColors(e,t,n,i,s){const o=this.geometry.getAttribute("color");return o.setXYZ(0,e.r,e.g,e.b),o.setXYZ(1,e.r,e.g,e.b),o.setXYZ(2,e.r,e.g,e.b),o.setXYZ(3,e.r,e.g,e.b),o.setXYZ(4,e.r,e.g,e.b),o.setXYZ(5,e.r,e.g,e.b),o.setXYZ(6,e.r,e.g,e.b),o.setXYZ(7,e.r,e.g,e.b),o.setXYZ(8,e.r,e.g,e.b),o.setXYZ(9,e.r,e.g,e.b),o.setXYZ(10,e.r,e.g,e.b),o.setXYZ(11,e.r,e.g,e.b),o.setXYZ(12,e.r,e.g,e.b),o.setXYZ(13,e.r,e.g,e.b),o.setXYZ(14,e.r,e.g,e.b),o.setXYZ(15,e.r,e.g,e.b),o.setXYZ(16,e.r,e.g,e.b),o.setXYZ(17,e.r,e.g,e.b),o.setXYZ(18,e.r,e.g,e.b),o.setXYZ(19,e.r,e.g,e.b),o.setXYZ(20,e.r,e.g,e.b),o.setXYZ(21,e.r,e.g,e.b),o.setXYZ(22,e.r,e.g,e.b),o.setXYZ(23,e.r,e.g,e.b),o.setXYZ(24,t.r,t.g,t.b),o.setXYZ(25,t.r,t.g,t.b),o.setXYZ(26,t.r,t.g,t.b),o.setXYZ(27,t.r,t.g,t.b),o.setXYZ(28,t.r,t.g,t.b),o.setXYZ(29,t.r,t.g,t.b),o.setXYZ(30,t.r,t.g,t.b),o.setXYZ(31,t.r,t.g,t.b),o.setXYZ(32,n.r,n.g,n.b),o.setXYZ(33,n.r,n.g,n.b),o.setXYZ(34,n.r,n.g,n.b),o.setXYZ(35,n.r,n.g,n.b),o.setXYZ(36,n.r,n.g,n.b),o.setXYZ(37,n.r,n.g,n.b),o.setXYZ(38,i.r,i.g,i.b),o.setXYZ(39,i.r,i.g,i.b),o.setXYZ(40,s.r,s.g,s.b),o.setXYZ(41,s.r,s.g,s.b),o.setXYZ(42,s.r,s.g,s.b),o.setXYZ(43,s.r,s.g,s.b),o.setXYZ(44,s.r,s.g,s.b),o.setXYZ(45,s.r,s.g,s.b),o.setXYZ(46,s.r,s.g,s.b),o.setXYZ(47,s.r,s.g,s.b),o.setXYZ(48,s.r,s.g,s.b),o.setXYZ(49,s.r,s.g,s.b),o.needsUpdate=!0,this}update(){const e=this.geometry,t=this.pointMap,n=1,i=1;let s,a;if(vs.projectionMatrixInverse.copy(this.camera.projectionMatrixInverse),this.camera.reversedDepth===!0)s=1,a=0;else if(this.camera.coordinateSystem===Ba)s=-1,a=1;else if(this.camera.coordinateSystem===Il)s=0,a=1;else throw new Error("THREE.CameraHelper.update(): Invalid coordinate system: "+this.camera.coordinateSystem);As("c",t,e,vs,0,0,s),As("t",t,e,vs,0,0,a),As("n1",t,e,vs,-n,-i,s),As("n2",t,e,vs,n,-i,s),As("n3",t,e,vs,-n,i,s),As("n4",t,e,vs,n,i,s),As("f1",t,e,vs,-n,-i,a),As("f2",t,e,vs,n,-i,a),As("f3",t,e,vs,-n,i,a),As("f4",t,e,vs,n,i,a),As("u1",t,e,vs,n*.7,i*1.1,s),As("u2",t,e,vs,-n*.7,i*1.1,s),As("u3",t,e,vs,0,i*2,s),As("cf1",t,e,vs,-n,0,a),As("cf2",t,e,vs,n,0,a),As("cf3",t,e,vs,0,-i,a),As("cf4",t,e,vs,0,i,a),As("cn1",t,e,vs,-n,0,s),As("cn2",t,e,vs,n,0,s),As("cn3",t,e,vs,0,-i,s),As("cn4",t,e,vs,0,i,s),e.getAttribute("position").needsUpdate=!0}dispose(){this.geometry.dispose(),this.material.dispose()}}function As(r,e,t,n,i,s,a){EA.set(i,s,a).unproject(n);const o=e[r];if(o!==void 0){const l=t.getAttribute("position");for(let c=0,d=o.length;c<d;c++)l.setXYZ(o[c],EA.x,EA.y,EA.z)}}const MA=new _o;class FQ extends xd{constructor(e,t=16776960){const n=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),i=new Float32Array(24),s=new Qn;s.setIndex(new Ji(n,1)),s.setAttribute("position",new Ji(i,3)),super(s,new bo({color:t,toneMapped:!1})),this.object=e,this.type="BoxHelper",this.matrixAutoUpdate=!1,this.update()}update(){if(this.object!==void 0&&MA.setFromObject(this.object),MA.isEmpty())return;const e=MA.min,t=MA.max,n=this.geometry.attributes.position,i=n.array;i[0]=t.x,i[1]=t.y,i[2]=t.z,i[3]=e.x,i[4]=t.y,i[5]=t.z,i[6]=e.x,i[7]=e.y,i[8]=t.z,i[9]=t.x,i[10]=e.y,i[11]=t.z,i[12]=t.x,i[13]=t.y,i[14]=e.z,i[15]=e.x,i[16]=t.y,i[17]=e.z,i[18]=e.x,i[19]=e.y,i[20]=e.z,i[21]=t.x,i[22]=e.y,i[23]=e.z,n.needsUpdate=!0,this.geometry.computeBoundingSphere()}setFromObject(e){return this.object=e,this.update(),this}copy(e,t){return super.copy(e,t),this.object=e.object,this}dispose(){this.geometry.dispose(),this.material.dispose()}}class zQ extends xd{constructor(e,t=16776960){const n=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),i=[1,1,1,-1,1,1,-1,-1,1,1,-1,1,1,1,-1,-1,1,-1,-1,-1,-1,1,-1,-1],s=new Qn;s.setIndex(new Ji(n,1)),s.setAttribute("position",new hn(i,3)),super(s,new bo({color:t,toneMapped:!1})),this.box=e,this.type="Box3Helper",this.geometry.computeBoundingSphere()}updateMatrixWorld(e){const t=this.box;t.isEmpty()||(t.getCenter(this.position),t.getSize(this.scale),this.scale.multiplyScalar(.5),super.updateMatrixWorld(e))}dispose(){this.geometry.dispose(),this.material.dispose()}}class VQ extends Tm{constructor(e,t=1,n=16776960){const i=n,s=[1,-1,0,-1,1,0,-1,-1,0,1,1,0,-1,1,0,-1,-1,0,1,-1,0,1,1,0],a=new Qn;a.setAttribute("position",new hn(s,3)),a.computeBoundingSphere(),super(a,new bo({color:i,toneMapped:!1})),this.type="PlaneHelper",this.plane=e,this.size=t;const o=[1,1,0,-1,1,0,-1,-1,0,1,1,0,-1,-1,0,1,-1,0],l=new Qn;l.setAttribute("position",new hn(o,3)),l.computeBoundingSphere(),this.add(new ar(l,new lo({color:i,opacity:.2,transparent:!0,depthWrite:!1,toneMapped:!1})))}updateMatrixWorld(e){this.position.set(0,0,0),this.scale.set(.5*this.size,.5*this.size,1),this.lookAt(this.plane.normal),this.translateZ(-this.plane.constant),super.updateMatrixWorld(e)}dispose(){this.geometry.dispose(),this.material.dispose(),this.children[0].geometry.dispose(),this.children[0].material.dispose()}}const qz=new ne;let AA,m3;class GQ extends Fi{constructor(e=new ne(0,0,1),t=new ne(0,0,0),n=1,i=16776960,s=n*.2,a=s*.2){super(),this.type="ArrowHelper",AA===void 0&&(AA=new Qn,AA.setAttribute("position",new hn([0,0,0,0,1,0],3)),m3=new q1(.5,1,5,1),m3.translate(0,-.5,0)),this.position.copy(t),this.line=new Tm(AA,new bo({color:i,toneMapped:!1})),this.line.matrixAutoUpdate=!1,this.add(this.line),this.cone=new ar(m3,new lo({color:i,toneMapped:!1})),this.cone.matrixAutoUpdate=!1,this.add(this.cone),this.setDirection(e),this.setLength(n,s,a)}setDirection(e){if(e.y>.99999)this.quaternion.set(0,0,0,1);else if(e.y<-.99999)this.quaternion.set(1,0,0,0);else{qz.set(e.z,0,-e.x).normalize();const t=Math.acos(e.y);this.quaternion.setFromAxisAngle(qz,t)}}setLength(e,t=e*.2,n=t*.2){this.line.scale.set(1,Math.max(1e-4,e-t),1),this.line.updateMatrix(),this.cone.scale.set(n,t,n),this.cone.position.y=e,this.cone.updateMatrix()}setColor(e){this.line.material.color.set(e),this.cone.material.color.set(e)}copy(e){return super.copy(e,!1),this.line.copy(e.line),this.cone.copy(e.cone),this}dispose(){this.line.geometry.dispose(),this.line.material.dispose(),this.cone.geometry.dispose(),this.cone.material.dispose()}}class kQ extends xd{constructor(e=1){const t=[0,0,0,e,0,0,0,0,0,0,e,0,0,0,0,0,0,e],n=[1,0,0,1,.6,0,0,1,0,.6,1,0,0,0,1,0,.6,1],i=new Qn;i.setAttribute("position",new hn(t,3)),i.setAttribute("color",new hn(n,3));const s=new bo({vertexColors:!0,toneMapped:!1});super(i,s),this.type="AxesHelper"}setColors(e,t,n){const i=new Kt,s=this.geometry.attributes.color.array;return i.set(e),i.toArray(s,0),i.toArray(s,3),i.set(t),i.toArray(s,6),i.toArray(s,9),i.set(n),i.toArray(s,12),i.toArray(s,15),this.geometry.attributes.color.needsUpdate=!0,this}dispose(){this.geometry.dispose(),this.material.dispose()}}class HQ{constructor(){this.type="ShapePath",this.color=new Kt,this.subPaths=[],this.currentPath=null}moveTo(e,t){return this.currentPath=new nR,this.subPaths.push(this.currentPath),this.currentPath.moveTo(e,t),this}lineTo(e,t){return this.currentPath.lineTo(e,t),this}quadraticCurveTo(e,t,n,i){return this.currentPath.quadraticCurveTo(e,t,n,i),this}bezierCurveTo(e,t,n,i,s,a){return this.currentPath.bezierCurveTo(e,t,n,i,s,a),this}splineThru(e){return this.currentPath.splineThru(e),this}toShapes(e){function t(T){const M=[];for(let R=0,N=T.length;R<N;R++){const P=T[R],U=new R0;U.curves=P.curves,M.push(U)}return M}function n(T,M){const R=M.length;let N=!1;for(let P=R-1,U=0;U<R;P=U++){let L=M[P],F=M[U],O=F.x-L.x,B=F.y-L.y;if(Math.abs(B)>Number.EPSILON){if(B<0&&(L=M[U],O=-O,F=M[P],B=-B),T.y<L.y||T.y>F.y)continue;if(T.y===L.y){if(T.x===L.x)return!0}else{const q=B*(T.x-L.x)-O*(T.y-L.y);if(q===0)return!0;if(q<0)continue;N=!N}}else{if(T.y!==L.y)continue;if(F.x<=T.x&&T.x<=L.x||L.x<=T.x&&T.x<=F.x)return!0}}return N}const i=Zc.isClockWise,s=this.subPaths;if(s.length===0)return[];let a,o,l;const c=[];if(s.length===1)return o=s[0],l=new R0,l.curves=o.curves,c.push(l),c;let d=!i(s[0].getPoints());d=e?!d:d;const p=[],y=[];let _=[],v=0,b;y[v]=void 0,_[v]=[];for(let T=0,M=s.length;T<M;T++)o=s[T],b=o.getPoints(),a=i(b),a=e?!a:a,a?(!d&&y[v]&&v++,y[v]={s:new R0,p:b},y[v].s.curves=o.curves,d&&v++,_[v]=[]):_[v].push({h:o,p:b[0]});if(!y[0])return t(s);if(y.length>1){let T=!1,M=0;for(let R=0,N=y.length;R<N;R++)p[R]=[];for(let R=0,N=y.length;R<N;R++){const P=_[R];for(let U=0;U<P.length;U++){const L=P[U];let F=!0;for(let O=0;O<y.length;O++)n(L.p,y[O].p)&&(R!==O&&M++,F?(F=!1,p[O].push(L)):T=!0);F&&p[R].push(L)}}M>0&&T===!1&&(_=p)}let E;for(let T=0,M=y.length;T<M;T++){l=y[T].s,c.push(l),E=_[T];for(let R=0,N=E.length;R<N;R++)l.holes.push(E[R].h)}return c}}class WQ extends Gl{constructor(e,t=null){super(),this.object=e,this.domElement=t,this.enabled=!0,this.state=-1,this.keys={},this.mouseButtons={LEFT:null,MIDDLE:null,RIGHT:null},this.touches={ONE:null,TWO:null}}connect(e){if(e===void 0){Ve("Controls: connect() now requires an element.");return}this.domElement!==null&&this.disconnect(),this.domElement=e}disconnect(){}dispose(){}update(){}}function qQ(r,e){const t=r.image&&r.image.width?r.image.width/r.image.height:1;return t>e?(r.repeat.x=1,r.repeat.y=t/e,r.offset.x=0,r.offset.y=(1-r.repeat.y)/2):(r.repeat.x=e/t,r.repeat.y=1,r.offset.x=(1-r.repeat.x)/2,r.offset.y=0),r}function XQ(r,e){const t=r.image&&r.image.width?r.image.width/r.image.height:1;return t>e?(r.repeat.x=e/t,r.repeat.y=1,r.offset.x=(1-r.repeat.x)/2,r.offset.y=0):(r.repeat.x=1,r.repeat.y=t/e,r.offset.x=0,r.offset.y=(1-r.repeat.y)/2),r}function $Q(r){return r.repeat.x=1,r.repeat.y=1,r.offset.x=0,r.offset.y=0,r}function iR(r,e,t,n){const i=jQ(n);switch(t){case mC:return r*e;case Pm:return r*e/i.components*i.byteLength;case Bm:return r*e/i.components*i.byteLength;case po:return r*e*2/i.components*i.byteLength;case My:return r*e*2/i.components*i.byteLength;case Fx:return r*e*3/i.components*i.byteLength;case Qi:return r*e*4/i.components*i.byteLength;case Ay:return r*e*4/i.components*i.byteLength;case xh:case bh:return Math.floor((r+3)/4)*Math.floor((e+3)/4)*8;case Sh:case Th:return Math.floor((r+3)/4)*Math.floor((e+3)/4)*16;case dx:case px:return Math.max(r,16)*Math.max(e,8)/4;case fx:case hx:return Math.max(r,8)*Math.max(e,8)/2;case H0:case W0:case X0:case $0:return Math.floor((r+3)/4)*Math.floor((e+3)/4)*8;case q0:case _m:case j0:return Math.floor((r+3)/4)*Math.floor((e+3)/4)*16;case Y0:return Math.floor((r+3)/4)*Math.floor((e+3)/4)*16;case Z0:return Math.floor((r+4)/5)*Math.floor((e+3)/4)*16;case K0:return Math.floor((r+4)/5)*Math.floor((e+4)/5)*16;case Q0:return Math.floor((r+5)/6)*Math.floor((e+4)/5)*16;case J0:return Math.floor((r+5)/6)*Math.floor((e+5)/6)*16;case ey:return Math.floor((r+7)/8)*Math.floor((e+4)/5)*16;case ty:return Math.floor((r+7)/8)*Math.floor((e+5)/6)*16;case ny:return Math.floor((r+7)/8)*Math.floor((e+7)/8)*16;case iy:return Math.floor((r+9)/10)*Math.floor((e+4)/5)*16;case ry:return Math.floor((r+9)/10)*Math.floor((e+5)/6)*16;case sy:return Math.floor((r+9)/10)*Math.floor((e+7)/8)*16;case ay:return Math.floor((r+9)/10)*Math.floor((e+9)/10)*16;case oy:return Math.floor((r+11)/12)*Math.floor((e+9)/10)*16;case ly:return Math.floor((r+11)/12)*Math.floor((e+11)/12)*16;case uy:case Yw:case Zw:return Math.ceil(r/4)*Math.ceil(e/4)*16;case cy:case fy:return Math.ceil(r/4)*Math.ceil(e/4)*8;case vm:case dy:return Math.ceil(r/4)*Math.ceil(e/4)*16}throw new Error(`Unable to determine texture byte length for ${t} format.`)}function jQ(r){switch(r){case ir:case _h:return{byteLength:1,components:1};case Zu:case vh:case vi:return{byteLength:2,components:1};case B1:case I1:return{byteLength:2,components:4};case Hi:case Hs:case Ci:return{byteLength:4,components:1};case F1:case z1:return{byteLength:4,components:3}}throw new Error(`Unknown texture type ${r}.`)}class YQ{static contain(e,t){return qQ(e,t)}static cover(e,t){return XQ(e,t)}static fill(e){return $Q(e)}static getByteLength(e,t,n,i){return iR(e,t,n,i)}}typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("register",{detail:{revision:Lm}}));typeof window<"u"&&(window.__THREE__?Ve("WARNING: Multiple instances of Three.js being imported."):window.__THREE__=Lm);function O6(){let r=null,e=!1,t=null,n=null;function i(s,a){t(s,a),n=r.requestAnimationFrame(i)}return{start:function(){e!==!0&&t!==null&&(n=r.requestAnimationFrame(i),e=!0)},stop:function(){r.cancelAnimationFrame(n),e=!1},setAnimationLoop:function(s){t=s},setContext:function(s){r=s}}}function ZQ(r){const e=new WeakMap;function t(o,l){const c=o.array,d=o.usage,p=c.byteLength,y=r.createBuffer();r.bindBuffer(l,y),r.bufferData(l,c,d),o.onUploadCallback();let _;if(c instanceof Float32Array)_=r.FLOAT;else if(typeof Float16Array<"u"&&c instanceof Float16Array)_=r.HALF_FLOAT;else if(c instanceof Uint16Array)o.isFloat16BufferAttribute?_=r.HALF_FLOAT:_=r.UNSIGNED_SHORT;else if(c instanceof Int16Array)_=r.SHORT;else if(c instanceof Uint32Array)_=r.UNSIGNED_INT;else if(c instanceof Int32Array)_=r.INT;else if(c instanceof Int8Array)_=r.BYTE;else if(c instanceof Uint8Array)_=r.UNSIGNED_BYTE;else if(c instanceof Uint8ClampedArray)_=r.UNSIGNED_BYTE;else throw new Error("THREE.WebGLAttributes: Unsupported buffer data format: "+c);return{buffer:y,type:_,bytesPerElement:c.BYTES_PER_ELEMENT,version:o.version,size:p}}function n(o,l,c){const d=l.array,p=l.updateRanges;if(r.bindBuffer(c,o),p.length===0)r.bufferSubData(c,0,d);else{p.sort((_,v)=>_.start-v.start);let y=0;for(let _=1;_<p.length;_++){const v=p[y],b=p[_];b.start<=v.start+v.count+1?v.count=Math.max(v.count,b.start+b.count-v.start):(++y,p[y]=b)}p.length=y+1;for(let _=0,v=p.length;_<v;_++){const b=p[_];r.bufferSubData(c,b.start*d.BYTES_PER_ELEMENT,d,b.start,b.count)}l.clearUpdateRanges()}l.onUploadCallback()}function i(o){return o.isInterleavedBufferAttribute&&(o=o.data),e.get(o)}function s(o){o.isInterleavedBufferAttribute&&(o=o.data);const l=e.get(o);l&&(r.deleteBuffer(l.buffer),e.delete(o))}function a(o,l){if(o.isInterleavedBufferAttribute&&(o=o.data),o.isGLBufferAttribute){const d=e.get(o);(!d||d.version<o.version)&&e.set(o,{buffer:o.buffer,type:o.type,bytesPerElement:o.elementSize,version:o.version});return}const c=e.get(o);if(c===void 0)e.set(o,t(o,l));else if(c.version<o.version){if(c.size!==o.array.byteLength)throw new Error("THREE.WebGLAttributes: The size of the buffer attribute's array buffer does not match the original size. Resizing buffer attributes is not supported.");n(c.buffer,o,l),c.version=o.version}}return{get:i,remove:s,update:a}}var KQ=`#ifdef USE_ALPHAHASH
	if ( diffuseColor.a < getAlphaHashThreshold( vPosition ) ) discard;
#endif`,QQ=`#ifdef USE_ALPHAHASH
	const float ALPHA_HASH_SCALE = 0.05;
	float hash2D( vec2 value ) {
		return fract( 1.0e4 * sin( 17.0 * value.x + 0.1 * value.y ) * ( 0.1 + abs( sin( 13.0 * value.y + value.x ) ) ) );
	}
	float hash3D( vec3 value ) {
		return hash2D( vec2( hash2D( value.xy ), value.z ) );
	}
	float getAlphaHashThreshold( vec3 position ) {
		float maxDeriv = max(
			length( dFdx( position.xyz ) ),
			length( dFdy( position.xyz ) )
		);
		float pixScale = 1.0 / ( ALPHA_HASH_SCALE * maxDeriv );
		vec2 pixScales = vec2(
			exp2( floor( log2( pixScale ) ) ),
			exp2( ceil( log2( pixScale ) ) )
		);
		vec2 alpha = vec2(
			hash3D( floor( pixScales.x * position.xyz ) ),
			hash3D( floor( pixScales.y * position.xyz ) )
		);
		float lerpFactor = fract( log2( pixScale ) );
		float x = ( 1.0 - lerpFactor ) * alpha.x + lerpFactor * alpha.y;
		float a = min( lerpFactor, 1.0 - lerpFactor );
		vec3 cases = vec3(
			x * x / ( 2.0 * a * ( 1.0 - a ) ),
			( x - 0.5 * a ) / ( 1.0 - a ),
			1.0 - ( ( 1.0 - x ) * ( 1.0 - x ) / ( 2.0 * a * ( 1.0 - a ) ) )
		);
		float threshold = ( x < ( 1.0 - a ) )
			? ( ( x < a ) ? cases.x : cases.y )
			: cases.z;
		return clamp( threshold , 1.0e-6, 1.0 );
	}
#endif`,JQ=`#ifdef USE_ALPHAMAP
	diffuseColor.a *= texture2D( alphaMap, vAlphaMapUv ).g;
#endif`,eJ=`#ifdef USE_ALPHAMAP
	uniform sampler2D alphaMap;
#endif`,tJ=`#ifdef USE_ALPHATEST
	#ifdef ALPHA_TO_COVERAGE
	diffuseColor.a = smoothstep( alphaTest, alphaTest + fwidth( diffuseColor.a ), diffuseColor.a );
	if ( diffuseColor.a == 0.0 ) discard;
	#else
	if ( diffuseColor.a < alphaTest ) discard;
	#endif
#endif`,nJ=`#ifdef USE_ALPHATEST
	uniform float alphaTest;
#endif`,iJ=`#ifdef USE_AOMAP
	float ambientOcclusion = ( texture2D( aoMap, vAoMapUv ).r - 1.0 ) * aoMapIntensity + 1.0;
	reflectedLight.indirectDiffuse *= ambientOcclusion;
	#if defined( USE_CLEARCOAT ) 
		clearcoatSpecularIndirect *= ambientOcclusion;
	#endif
	#if defined( USE_SHEEN ) 
		sheenSpecularIndirect *= ambientOcclusion;
	#endif
	#if defined( USE_ENVMAP ) && defined( STANDARD )
		float dotNV = saturate( dot( geometryNormal, geometryViewDir ) );
		reflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.roughness );
	#endif
#endif`,rJ=`#ifdef USE_AOMAP
	uniform sampler2D aoMap;
	uniform float aoMapIntensity;
#endif`,sJ=`#ifdef USE_BATCHING
	#if ! defined( GL_ANGLE_multi_draw )
	#define gl_DrawID _gl_DrawID
	uniform int _gl_DrawID;
	#endif
	uniform highp sampler2D batchingTexture;
	uniform highp usampler2D batchingIdTexture;
	mat4 getBatchingMatrix( const in float i ) {
		int size = textureSize( batchingTexture, 0 ).x;
		int j = int( i ) * 4;
		int x = j % size;
		int y = j / size;
		vec4 v1 = texelFetch( batchingTexture, ivec2( x, y ), 0 );
		vec4 v2 = texelFetch( batchingTexture, ivec2( x + 1, y ), 0 );
		vec4 v3 = texelFetch( batchingTexture, ivec2( x + 2, y ), 0 );
		vec4 v4 = texelFetch( batchingTexture, ivec2( x + 3, y ), 0 );
		return mat4( v1, v2, v3, v4 );
	}
	float getIndirectIndex( const in int i ) {
		int size = textureSize( batchingIdTexture, 0 ).x;
		int x = i % size;
		int y = i / size;
		return float( texelFetch( batchingIdTexture, ivec2( x, y ), 0 ).r );
	}
#endif
#ifdef USE_BATCHING_COLOR
	uniform sampler2D batchingColorTexture;
	vec3 getBatchingColor( const in float i ) {
		int size = textureSize( batchingColorTexture, 0 ).x;
		int j = int( i );
		int x = j % size;
		int y = j / size;
		return texelFetch( batchingColorTexture, ivec2( x, y ), 0 ).rgb;
	}
#endif`,aJ=`#ifdef USE_BATCHING
	mat4 batchingMatrix = getBatchingMatrix( getIndirectIndex( gl_DrawID ) );
#endif`,oJ=`vec3 transformed = vec3( position );
#ifdef USE_ALPHAHASH
	vPosition = vec3( position );
#endif`,lJ=`vec3 objectNormal = vec3( normal );
#ifdef USE_TANGENT
	vec3 objectTangent = vec3( tangent.xyz );
#endif`,uJ=`float G_BlinnPhong_Implicit( ) {
	return 0.25;
}
float D_BlinnPhong( const in float shininess, const in float dotNH ) {
	return RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );
}
vec3 BRDF_BlinnPhong( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float shininess ) {
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNH = saturate( dot( normal, halfDir ) );
	float dotVH = saturate( dot( viewDir, halfDir ) );
	vec3 F = F_Schlick( specularColor, 1.0, dotVH );
	float G = G_BlinnPhong_Implicit( );
	float D = D_BlinnPhong( shininess, dotNH );
	return F * ( G * D );
} // validated`,cJ=`#ifdef USE_IRIDESCENCE
	const mat3 XYZ_TO_REC709 = mat3(
		 3.2404542, -0.9692660,  0.0556434,
		-1.5371385,  1.8760108, -0.2040259,
		-0.4985314,  0.0415560,  1.0572252
	);
	vec3 Fresnel0ToIor( vec3 fresnel0 ) {
		vec3 sqrtF0 = sqrt( fresnel0 );
		return ( vec3( 1.0 ) + sqrtF0 ) / ( vec3( 1.0 ) - sqrtF0 );
	}
	vec3 IorToFresnel0( vec3 transmittedIor, float incidentIor ) {
		return pow2( ( transmittedIor - vec3( incidentIor ) ) / ( transmittedIor + vec3( incidentIor ) ) );
	}
	float IorToFresnel0( float transmittedIor, float incidentIor ) {
		return pow2( ( transmittedIor - incidentIor ) / ( transmittedIor + incidentIor ));
	}
	vec3 evalSensitivity( float OPD, vec3 shift ) {
		float phase = 2.0 * PI * OPD * 1.0e-9;
		vec3 val = vec3( 5.4856e-13, 4.4201e-13, 5.2481e-13 );
		vec3 pos = vec3( 1.6810e+06, 1.7953e+06, 2.2084e+06 );
		vec3 var = vec3( 4.3278e+09, 9.3046e+09, 6.6121e+09 );
		vec3 xyz = val * sqrt( 2.0 * PI * var ) * cos( pos * phase + shift ) * exp( - pow2( phase ) * var );
		xyz.x += 9.7470e-14 * sqrt( 2.0 * PI * 4.5282e+09 ) * cos( 2.2399e+06 * phase + shift[ 0 ] ) * exp( - 4.5282e+09 * pow2( phase ) );
		xyz /= 1.0685e-7;
		vec3 rgb = XYZ_TO_REC709 * xyz;
		return rgb;
	}
	vec3 evalIridescence( float outsideIOR, float eta2, float cosTheta1, float thinFilmThickness, vec3 baseF0 ) {
		vec3 I;
		float iridescenceIOR = mix( outsideIOR, eta2, smoothstep( 0.0, 0.03, thinFilmThickness ) );
		float sinTheta2Sq = pow2( outsideIOR / iridescenceIOR ) * ( 1.0 - pow2( cosTheta1 ) );
		float cosTheta2Sq = 1.0 - sinTheta2Sq;
		if ( cosTheta2Sq < 0.0 ) {
			return vec3( 1.0 );
		}
		float cosTheta2 = sqrt( cosTheta2Sq );
		float R0 = IorToFresnel0( iridescenceIOR, outsideIOR );
		float R12 = F_Schlick( R0, 1.0, cosTheta1 );
		float T121 = 1.0 - R12;
		float phi12 = 0.0;
		if ( iridescenceIOR < outsideIOR ) phi12 = PI;
		float phi21 = PI - phi12;
		vec3 baseIOR = Fresnel0ToIor( clamp( baseF0, 0.0, 0.9999 ) );		vec3 R1 = IorToFresnel0( baseIOR, iridescenceIOR );
		vec3 R23 = F_Schlick( R1, 1.0, cosTheta2 );
		vec3 phi23 = vec3( 0.0 );
		if ( baseIOR[ 0 ] < iridescenceIOR ) phi23[ 0 ] = PI;
		if ( baseIOR[ 1 ] < iridescenceIOR ) phi23[ 1 ] = PI;
		if ( baseIOR[ 2 ] < iridescenceIOR ) phi23[ 2 ] = PI;
		float OPD = 2.0 * iridescenceIOR * thinFilmThickness * cosTheta2;
		vec3 phi = vec3( phi21 ) + phi23;
		vec3 R123 = clamp( R12 * R23, 1e-5, 0.9999 );
		vec3 r123 = sqrt( R123 );
		vec3 Rs = pow2( T121 ) * R23 / ( vec3( 1.0 ) - R123 );
		vec3 C0 = R12 + Rs;
		I = C0;
		vec3 Cm = Rs - T121;
		for ( int m = 1; m <= 2; ++ m ) {
			Cm *= r123;
			vec3 Sm = 2.0 * evalSensitivity( float( m ) * OPD, float( m ) * phi );
			I += Cm * Sm;
		}
		return max( I, vec3( 0.0 ) );
	}
#endif`,fJ=`#ifdef USE_BUMPMAP
	uniform sampler2D bumpMap;
	uniform float bumpScale;
	vec2 dHdxy_fwd() {
		vec2 dSTdx = dFdx( vBumpMapUv );
		vec2 dSTdy = dFdy( vBumpMapUv );
		float Hll = bumpScale * texture2D( bumpMap, vBumpMapUv ).x;
		float dBx = bumpScale * texture2D( bumpMap, vBumpMapUv + dSTdx ).x - Hll;
		float dBy = bumpScale * texture2D( bumpMap, vBumpMapUv + dSTdy ).x - Hll;
		return vec2( dBx, dBy );
	}
	vec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy, float faceDirection ) {
		vec3 vSigmaX = normalize( dFdx( surf_pos.xyz ) );
		vec3 vSigmaY = normalize( dFdy( surf_pos.xyz ) );
		vec3 vN = surf_norm;
		vec3 R1 = cross( vSigmaY, vN );
		vec3 R2 = cross( vN, vSigmaX );
		float fDet = dot( vSigmaX, R1 ) * faceDirection;
		vec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );
		return normalize( abs( fDet ) * surf_norm - vGrad );
	}
#endif`,dJ=`#if NUM_CLIPPING_PLANES > 0
	vec4 plane;
	#ifdef ALPHA_TO_COVERAGE
		float distanceToPlane, distanceGradient;
		float clipOpacity = 1.0;
		#pragma unroll_loop_start
		for ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {
			plane = clippingPlanes[ i ];
			distanceToPlane = - dot( vClipPosition, plane.xyz ) + plane.w;
			distanceGradient = fwidth( distanceToPlane ) / 2.0;
			clipOpacity *= smoothstep( - distanceGradient, distanceGradient, distanceToPlane );
			if ( clipOpacity == 0.0 ) discard;
		}
		#pragma unroll_loop_end
		#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES
			float unionClipOpacity = 1.0;
			#pragma unroll_loop_start
			for ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {
				plane = clippingPlanes[ i ];
				distanceToPlane = - dot( vClipPosition, plane.xyz ) + plane.w;
				distanceGradient = fwidth( distanceToPlane ) / 2.0;
				unionClipOpacity *= 1.0 - smoothstep( - distanceGradient, distanceGradient, distanceToPlane );
			}
			#pragma unroll_loop_end
			clipOpacity *= 1.0 - unionClipOpacity;
		#endif
		diffuseColor.a *= clipOpacity;
		if ( diffuseColor.a == 0.0 ) discard;
	#else
		#pragma unroll_loop_start
		for ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {
			plane = clippingPlanes[ i ];
			if ( dot( vClipPosition, plane.xyz ) > plane.w ) discard;
		}
		#pragma unroll_loop_end
		#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES
			bool clipped = true;
			#pragma unroll_loop_start
			for ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {
				plane = clippingPlanes[ i ];
				clipped = ( dot( vClipPosition, plane.xyz ) > plane.w ) && clipped;
			}
			#pragma unroll_loop_end
			if ( clipped ) discard;
		#endif
	#endif
#endif`,hJ=`#if NUM_CLIPPING_PLANES > 0
	varying vec3 vClipPosition;
	uniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];
#endif`,pJ=`#if NUM_CLIPPING_PLANES > 0
	varying vec3 vClipPosition;
#endif`,mJ=`#if NUM_CLIPPING_PLANES > 0
	vClipPosition = - mvPosition.xyz;
#endif`,gJ=`#if defined( USE_COLOR_ALPHA )
	diffuseColor *= vColor;
#elif defined( USE_COLOR )
	diffuseColor.rgb *= vColor;
#endif`,yJ=`#if defined( USE_COLOR_ALPHA )
	varying vec4 vColor;
#elif defined( USE_COLOR )
	varying vec3 vColor;
#endif`,_J=`#if defined( USE_COLOR_ALPHA )
	varying vec4 vColor;
#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR ) || defined( USE_BATCHING_COLOR )
	varying vec3 vColor;
#endif`,vJ=`#if defined( USE_COLOR_ALPHA )
	vColor = vec4( 1.0 );
#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR ) || defined( USE_BATCHING_COLOR )
	vColor = vec3( 1.0 );
#endif
#ifdef USE_COLOR
	vColor *= color;
#endif
#ifdef USE_INSTANCING_COLOR
	vColor.xyz *= instanceColor.xyz;
#endif
#ifdef USE_BATCHING_COLOR
	vec3 batchingColor = getBatchingColor( getIndirectIndex( gl_DrawID ) );
	vColor.xyz *= batchingColor.xyz;
#endif`,xJ=`#define PI 3.141592653589793
#define PI2 6.283185307179586
#define PI_HALF 1.5707963267948966
#define RECIPROCAL_PI 0.3183098861837907
#define RECIPROCAL_PI2 0.15915494309189535
#define EPSILON 1e-6
#ifndef saturate
#define saturate( a ) clamp( a, 0.0, 1.0 )
#endif
#define whiteComplement( a ) ( 1.0 - saturate( a ) )
float pow2( const in float x ) { return x*x; }
vec3 pow2( const in vec3 x ) { return x*x; }
float pow3( const in float x ) { return x*x*x; }
float pow4( const in float x ) { float x2 = x*x; return x2*x2; }
float max3( const in vec3 v ) { return max( max( v.x, v.y ), v.z ); }
float average( const in vec3 v ) { return dot( v, vec3( 0.3333333 ) ); }
highp float rand( const in vec2 uv ) {
	const highp float a = 12.9898, b = 78.233, c = 43758.5453;
	highp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );
	return fract( sin( sn ) * c );
}
#ifdef HIGH_PRECISION
	float precisionSafeLength( vec3 v ) { return length( v ); }
#else
	float precisionSafeLength( vec3 v ) {
		float maxComponent = max3( abs( v ) );
		return length( v / maxComponent ) * maxComponent;
	}
#endif
struct IncidentLight {
	vec3 color;
	vec3 direction;
	bool visible;
};
struct ReflectedLight {
	vec3 directDiffuse;
	vec3 directSpecular;
	vec3 indirectDiffuse;
	vec3 indirectSpecular;
};
#ifdef USE_ALPHAHASH
	varying vec3 vPosition;
#endif
vec3 transformDirection( in vec3 dir, in mat4 matrix ) {
	return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );
}
vec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {
	return normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );
}
bool isPerspectiveMatrix( mat4 m ) {
	return m[ 2 ][ 3 ] == - 1.0;
}
vec2 equirectUv( in vec3 dir ) {
	float u = atan( dir.z, dir.x ) * RECIPROCAL_PI2 + 0.5;
	float v = asin( clamp( dir.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;
	return vec2( u, v );
}
vec3 BRDF_Lambert( const in vec3 diffuseColor ) {
	return RECIPROCAL_PI * diffuseColor;
}
vec3 F_Schlick( const in vec3 f0, const in float f90, const in float dotVH ) {
	float fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );
	return f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );
}
float F_Schlick( const in float f0, const in float f90, const in float dotVH ) {
	float fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );
	return f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );
} // validated`,bJ=`#ifdef ENVMAP_TYPE_CUBE_UV
	#define cubeUV_minMipLevel 4.0
	#define cubeUV_minTileSize 16.0
	float getFace( vec3 direction ) {
		vec3 absDirection = abs( direction );
		float face = - 1.0;
		if ( absDirection.x > absDirection.z ) {
			if ( absDirection.x > absDirection.y )
				face = direction.x > 0.0 ? 0.0 : 3.0;
			else
				face = direction.y > 0.0 ? 1.0 : 4.0;
		} else {
			if ( absDirection.z > absDirection.y )
				face = direction.z > 0.0 ? 2.0 : 5.0;
			else
				face = direction.y > 0.0 ? 1.0 : 4.0;
		}
		return face;
	}
	vec2 getUV( vec3 direction, float face ) {
		vec2 uv;
		if ( face == 0.0 ) {
			uv = vec2( direction.z, direction.y ) / abs( direction.x );
		} else if ( face == 1.0 ) {
			uv = vec2( - direction.x, - direction.z ) / abs( direction.y );
		} else if ( face == 2.0 ) {
			uv = vec2( - direction.x, direction.y ) / abs( direction.z );
		} else if ( face == 3.0 ) {
			uv = vec2( - direction.z, direction.y ) / abs( direction.x );
		} else if ( face == 4.0 ) {
			uv = vec2( - direction.x, direction.z ) / abs( direction.y );
		} else {
			uv = vec2( direction.x, direction.y ) / abs( direction.z );
		}
		return 0.5 * ( uv + 1.0 );
	}
	vec3 bilinearCubeUV( sampler2D envMap, vec3 direction, float mipInt ) {
		float face = getFace( direction );
		float filterInt = max( cubeUV_minMipLevel - mipInt, 0.0 );
		mipInt = max( mipInt, cubeUV_minMipLevel );
		float faceSize = exp2( mipInt );
		highp vec2 uv = getUV( direction, face ) * ( faceSize - 2.0 ) + 1.0;
		if ( face > 2.0 ) {
			uv.y += faceSize;
			face -= 3.0;
		}
		uv.x += face * faceSize;
		uv.x += filterInt * 3.0 * cubeUV_minTileSize;
		uv.y += 4.0 * ( exp2( CUBEUV_MAX_MIP ) - faceSize );
		uv.x *= CUBEUV_TEXEL_WIDTH;
		uv.y *= CUBEUV_TEXEL_HEIGHT;
		#ifdef texture2DGradEXT
			return texture2DGradEXT( envMap, uv, vec2( 0.0 ), vec2( 0.0 ) ).rgb;
		#else
			return texture2D( envMap, uv ).rgb;
		#endif
	}
	#define cubeUV_r0 1.0
	#define cubeUV_m0 - 2.0
	#define cubeUV_r1 0.8
	#define cubeUV_m1 - 1.0
	#define cubeUV_r4 0.4
	#define cubeUV_m4 2.0
	#define cubeUV_r5 0.305
	#define cubeUV_m5 3.0
	#define cubeUV_r6 0.21
	#define cubeUV_m6 4.0
	float roughnessToMip( float roughness ) {
		float mip = 0.0;
		if ( roughness >= cubeUV_r1 ) {
			mip = ( cubeUV_r0 - roughness ) * ( cubeUV_m1 - cubeUV_m0 ) / ( cubeUV_r0 - cubeUV_r1 ) + cubeUV_m0;
		} else if ( roughness >= cubeUV_r4 ) {
			mip = ( cubeUV_r1 - roughness ) * ( cubeUV_m4 - cubeUV_m1 ) / ( cubeUV_r1 - cubeUV_r4 ) + cubeUV_m1;
		} else if ( roughness >= cubeUV_r5 ) {
			mip = ( cubeUV_r4 - roughness ) * ( cubeUV_m5 - cubeUV_m4 ) / ( cubeUV_r4 - cubeUV_r5 ) + cubeUV_m4;
		} else if ( roughness >= cubeUV_r6 ) {
			mip = ( cubeUV_r5 - roughness ) * ( cubeUV_m6 - cubeUV_m5 ) / ( cubeUV_r5 - cubeUV_r6 ) + cubeUV_m5;
		} else {
			mip = - 2.0 * log2( 1.16 * roughness );		}
		return mip;
	}
	vec4 textureCubeUV( sampler2D envMap, vec3 sampleDir, float roughness ) {
		float mip = clamp( roughnessToMip( roughness ), cubeUV_m0, CUBEUV_MAX_MIP );
		float mipF = fract( mip );
		float mipInt = floor( mip );
		vec3 color0 = bilinearCubeUV( envMap, sampleDir, mipInt );
		if ( mipF == 0.0 ) {
			return vec4( color0, 1.0 );
		} else {
			vec3 color1 = bilinearCubeUV( envMap, sampleDir, mipInt + 1.0 );
			return vec4( mix( color0, color1, mipF ), 1.0 );
		}
	}
#endif`,SJ=`vec3 transformedNormal = objectNormal;
#ifdef USE_TANGENT
	vec3 transformedTangent = objectTangent;
#endif
#ifdef USE_BATCHING
	mat3 bm = mat3( batchingMatrix );
	transformedNormal /= vec3( dot( bm[ 0 ], bm[ 0 ] ), dot( bm[ 1 ], bm[ 1 ] ), dot( bm[ 2 ], bm[ 2 ] ) );
	transformedNormal = bm * transformedNormal;
	#ifdef USE_TANGENT
		transformedTangent = bm * transformedTangent;
	#endif
#endif
#ifdef USE_INSTANCING
	mat3 im = mat3( instanceMatrix );
	transformedNormal /= vec3( dot( im[ 0 ], im[ 0 ] ), dot( im[ 1 ], im[ 1 ] ), dot( im[ 2 ], im[ 2 ] ) );
	transformedNormal = im * transformedNormal;
	#ifdef USE_TANGENT
		transformedTangent = im * transformedTangent;
	#endif
#endif
transformedNormal = normalMatrix * transformedNormal;
#ifdef FLIP_SIDED
	transformedNormal = - transformedNormal;
#endif
#ifdef USE_TANGENT
	transformedTangent = ( modelViewMatrix * vec4( transformedTangent, 0.0 ) ).xyz;
	#ifdef FLIP_SIDED
		transformedTangent = - transformedTangent;
	#endif
#endif`,TJ=`#ifdef USE_DISPLACEMENTMAP
	uniform sampler2D displacementMap;
	uniform float displacementScale;
	uniform float displacementBias;
#endif`,EJ=`#ifdef USE_DISPLACEMENTMAP
	transformed += normalize( objectNormal ) * ( texture2D( displacementMap, vDisplacementMapUv ).x * displacementScale + displacementBias );
#endif`,MJ=`#ifdef USE_EMISSIVEMAP
	vec4 emissiveColor = texture2D( emissiveMap, vEmissiveMapUv );
	#ifdef DECODE_VIDEO_TEXTURE_EMISSIVE
		emissiveColor = sRGBTransferEOTF( emissiveColor );
	#endif
	totalEmissiveRadiance *= emissiveColor.rgb;
#endif`,AJ=`#ifdef USE_EMISSIVEMAP
	uniform sampler2D emissiveMap;
#endif`,wJ="gl_FragColor = linearToOutputTexel( gl_FragColor );",RJ=`vec4 LinearTransferOETF( in vec4 value ) {
	return value;
}
vec4 sRGBTransferEOTF( in vec4 value ) {
	return vec4( mix( pow( value.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), value.rgb * 0.0773993808, vec3( lessThanEqual( value.rgb, vec3( 0.04045 ) ) ) ), value.a );
}
vec4 sRGBTransferOETF( in vec4 value ) {
	return vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.a );
}`,CJ=`#ifdef USE_ENVMAP
	#ifdef ENV_WORLDPOS
		vec3 cameraToFrag;
		if ( isOrthographic ) {
			cameraToFrag = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );
		} else {
			cameraToFrag = normalize( vWorldPosition - cameraPosition );
		}
		vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
		#ifdef ENVMAP_MODE_REFLECTION
			vec3 reflectVec = reflect( cameraToFrag, worldNormal );
		#else
			vec3 reflectVec = refract( cameraToFrag, worldNormal, refractionRatio );
		#endif
	#else
		vec3 reflectVec = vReflect;
	#endif
	#ifdef ENVMAP_TYPE_CUBE
		vec4 envColor = textureCube( envMap, envMapRotation * vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );
	#else
		vec4 envColor = vec4( 0.0 );
	#endif
	#ifdef ENVMAP_BLENDING_MULTIPLY
		outgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );
	#elif defined( ENVMAP_BLENDING_MIX )
		outgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );
	#elif defined( ENVMAP_BLENDING_ADD )
		outgoingLight += envColor.xyz * specularStrength * reflectivity;
	#endif
#endif`,NJ=`#ifdef USE_ENVMAP
	uniform float envMapIntensity;
	uniform float flipEnvMap;
	uniform mat3 envMapRotation;
	#ifdef ENVMAP_TYPE_CUBE
		uniform samplerCube envMap;
	#else
		uniform sampler2D envMap;
	#endif
#endif`,DJ=`#ifdef USE_ENVMAP
	uniform float reflectivity;
	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )
		#define ENV_WORLDPOS
	#endif
	#ifdef ENV_WORLDPOS
		varying vec3 vWorldPosition;
		uniform float refractionRatio;
	#else
		varying vec3 vReflect;
	#endif
#endif`,OJ=`#ifdef USE_ENVMAP
	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )
		#define ENV_WORLDPOS
	#endif
	#ifdef ENV_WORLDPOS
		
		varying vec3 vWorldPosition;
	#else
		varying vec3 vReflect;
		uniform float refractionRatio;
	#endif
#endif`,UJ=`#ifdef USE_ENVMAP
	#ifdef ENV_WORLDPOS
		vWorldPosition = worldPosition.xyz;
	#else
		vec3 cameraToVertex;
		if ( isOrthographic ) {
			cameraToVertex = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );
		} else {
			cameraToVertex = normalize( worldPosition.xyz - cameraPosition );
		}
		vec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );
		#ifdef ENVMAP_MODE_REFLECTION
			vReflect = reflect( cameraToVertex, worldNormal );
		#else
			vReflect = refract( cameraToVertex, worldNormal, refractionRatio );
		#endif
	#endif
#endif`,LJ=`#ifdef USE_FOG
	vFogDepth = - mvPosition.z;
#endif`,PJ=`#ifdef USE_FOG
	varying float vFogDepth;
#endif`,BJ=`#ifdef USE_FOG
	#ifdef FOG_EXP2
		float fogFactor = 1.0 - exp( - fogDensity * fogDensity * vFogDepth * vFogDepth );
	#else
		float fogFactor = smoothstep( fogNear, fogFar, vFogDepth );
	#endif
	gl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );
#endif`,IJ=`#ifdef USE_FOG
	uniform vec3 fogColor;
	varying float vFogDepth;
	#ifdef FOG_EXP2
		uniform float fogDensity;
	#else
		uniform float fogNear;
		uniform float fogFar;
	#endif
#endif`,FJ=`#ifdef USE_GRADIENTMAP
	uniform sampler2D gradientMap;
#endif
vec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {
	float dotNL = dot( normal, lightDirection );
	vec2 coord = vec2( dotNL * 0.5 + 0.5, 0.0 );
	#ifdef USE_GRADIENTMAP
		return vec3( texture2D( gradientMap, coord ).r );
	#else
		vec2 fw = fwidth( coord ) * 0.5;
		return mix( vec3( 0.7 ), vec3( 1.0 ), smoothstep( 0.7 - fw.x, 0.7 + fw.x, coord.x ) );
	#endif
}`,zJ=`#ifdef USE_LIGHTMAP
	uniform sampler2D lightMap;
	uniform float lightMapIntensity;
#endif`,VJ=`LambertMaterial material;
material.diffuseColor = diffuseColor.rgb;
material.specularStrength = specularStrength;`,GJ=`varying vec3 vViewPosition;
struct LambertMaterial {
	vec3 diffuseColor;
	float specularStrength;
};
void RE_Direct_Lambert( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometryNormal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Lambert( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_Lambert
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Lambert`,kJ=`uniform bool receiveShadow;
uniform vec3 ambientLightColor;
#if defined( USE_LIGHT_PROBES )
	uniform vec3 lightProbe[ 9 ];
#endif
vec3 shGetIrradianceAt( in vec3 normal, in vec3 shCoefficients[ 9 ] ) {
	float x = normal.x, y = normal.y, z = normal.z;
	vec3 result = shCoefficients[ 0 ] * 0.886227;
	result += shCoefficients[ 1 ] * 2.0 * 0.511664 * y;
	result += shCoefficients[ 2 ] * 2.0 * 0.511664 * z;
	result += shCoefficients[ 3 ] * 2.0 * 0.511664 * x;
	result += shCoefficients[ 4 ] * 2.0 * 0.429043 * x * y;
	result += shCoefficients[ 5 ] * 2.0 * 0.429043 * y * z;
	result += shCoefficients[ 6 ] * ( 0.743125 * z * z - 0.247708 );
	result += shCoefficients[ 7 ] * 2.0 * 0.429043 * x * z;
	result += shCoefficients[ 8 ] * 0.429043 * ( x * x - y * y );
	return result;
}
vec3 getLightProbeIrradiance( const in vec3 lightProbe[ 9 ], const in vec3 normal ) {
	vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
	vec3 irradiance = shGetIrradianceAt( worldNormal, lightProbe );
	return irradiance;
}
vec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {
	vec3 irradiance = ambientLightColor;
	return irradiance;
}
float getDistanceAttenuation( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {
	float distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );
	if ( cutoffDistance > 0.0 ) {
		distanceFalloff *= pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );
	}
	return distanceFalloff;
}
float getSpotAttenuation( const in float coneCosine, const in float penumbraCosine, const in float angleCosine ) {
	return smoothstep( coneCosine, penumbraCosine, angleCosine );
}
#if NUM_DIR_LIGHTS > 0
	struct DirectionalLight {
		vec3 direction;
		vec3 color;
	};
	uniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];
	void getDirectionalLightInfo( const in DirectionalLight directionalLight, out IncidentLight light ) {
		light.color = directionalLight.color;
		light.direction = directionalLight.direction;
		light.visible = true;
	}
#endif
#if NUM_POINT_LIGHTS > 0
	struct PointLight {
		vec3 position;
		vec3 color;
		float distance;
		float decay;
	};
	uniform PointLight pointLights[ NUM_POINT_LIGHTS ];
	void getPointLightInfo( const in PointLight pointLight, const in vec3 geometryPosition, out IncidentLight light ) {
		vec3 lVector = pointLight.position - geometryPosition;
		light.direction = normalize( lVector );
		float lightDistance = length( lVector );
		light.color = pointLight.color;
		light.color *= getDistanceAttenuation( lightDistance, pointLight.distance, pointLight.decay );
		light.visible = ( light.color != vec3( 0.0 ) );
	}
#endif
#if NUM_SPOT_LIGHTS > 0
	struct SpotLight {
		vec3 position;
		vec3 direction;
		vec3 color;
		float distance;
		float decay;
		float coneCos;
		float penumbraCos;
	};
	uniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];
	void getSpotLightInfo( const in SpotLight spotLight, const in vec3 geometryPosition, out IncidentLight light ) {
		vec3 lVector = spotLight.position - geometryPosition;
		light.direction = normalize( lVector );
		float angleCos = dot( light.direction, spotLight.direction );
		float spotAttenuation = getSpotAttenuation( spotLight.coneCos, spotLight.penumbraCos, angleCos );
		if ( spotAttenuation > 0.0 ) {
			float lightDistance = length( lVector );
			light.color = spotLight.color * spotAttenuation;
			light.color *= getDistanceAttenuation( lightDistance, spotLight.distance, spotLight.decay );
			light.visible = ( light.color != vec3( 0.0 ) );
		} else {
			light.color = vec3( 0.0 );
			light.visible = false;
		}
	}
#endif
#if NUM_RECT_AREA_LIGHTS > 0
	struct RectAreaLight {
		vec3 color;
		vec3 position;
		vec3 halfWidth;
		vec3 halfHeight;
	};
	uniform sampler2D ltc_1;	uniform sampler2D ltc_2;
	uniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];
#endif
#if NUM_HEMI_LIGHTS > 0
	struct HemisphereLight {
		vec3 direction;
		vec3 skyColor;
		vec3 groundColor;
	};
	uniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];
	vec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in vec3 normal ) {
		float dotNL = dot( normal, hemiLight.direction );
		float hemiDiffuseWeight = 0.5 * dotNL + 0.5;
		vec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );
		return irradiance;
	}
#endif`,HJ=`#ifdef USE_ENVMAP
	vec3 getIBLIrradiance( const in vec3 normal ) {
		#ifdef ENVMAP_TYPE_CUBE_UV
			vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
			vec4 envMapColor = textureCubeUV( envMap, envMapRotation * worldNormal, 1.0 );
			return PI * envMapColor.rgb * envMapIntensity;
		#else
			return vec3( 0.0 );
		#endif
	}
	vec3 getIBLRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness ) {
		#ifdef ENVMAP_TYPE_CUBE_UV
			vec3 reflectVec = reflect( - viewDir, normal );
			reflectVec = normalize( mix( reflectVec, normal, pow4( roughness ) ) );
			reflectVec = inverseTransformDirection( reflectVec, viewMatrix );
			vec4 envMapColor = textureCubeUV( envMap, envMapRotation * reflectVec, roughness );
			return envMapColor.rgb * envMapIntensity;
		#else
			return vec3( 0.0 );
		#endif
	}
	#ifdef USE_ANISOTROPY
		vec3 getIBLAnisotropyRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness, const in vec3 bitangent, const in float anisotropy ) {
			#ifdef ENVMAP_TYPE_CUBE_UV
				vec3 bentNormal = cross( bitangent, viewDir );
				bentNormal = normalize( cross( bentNormal, bitangent ) );
				bentNormal = normalize( mix( bentNormal, normal, pow2( pow2( 1.0 - anisotropy * ( 1.0 - roughness ) ) ) ) );
				return getIBLRadiance( viewDir, bentNormal, roughness );
			#else
				return vec3( 0.0 );
			#endif
		}
	#endif
#endif`,WJ=`ToonMaterial material;
material.diffuseColor = diffuseColor.rgb;`,qJ=`varying vec3 vViewPosition;
struct ToonMaterial {
	vec3 diffuseColor;
};
void RE_Direct_Toon( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
	vec3 irradiance = getGradientIrradiance( geometryNormal, directLight.direction ) * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Toon( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_Toon
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Toon`,XJ=`BlinnPhongMaterial material;
material.diffuseColor = diffuseColor.rgb;
material.specularColor = specular;
material.specularShininess = shininess;
material.specularStrength = specularStrength;`,$J=`varying vec3 vViewPosition;
struct BlinnPhongMaterial {
	vec3 diffuseColor;
	vec3 specularColor;
	float specularShininess;
	float specularStrength;
};
void RE_Direct_BlinnPhong( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometryNormal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
	reflectedLight.directSpecular += irradiance * BRDF_BlinnPhong( directLight.direction, geometryViewDir, geometryNormal, material.specularColor, material.specularShininess ) * material.specularStrength;
}
void RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_BlinnPhong
#define RE_IndirectDiffuse		RE_IndirectDiffuse_BlinnPhong`,jJ=`PhysicalMaterial material;
material.diffuseColor = diffuseColor.rgb;
material.diffuseContribution = diffuseColor.rgb * ( 1.0 - metalnessFactor );
material.metalness = metalnessFactor;
vec3 dxy = max( abs( dFdx( nonPerturbedNormal ) ), abs( dFdy( nonPerturbedNormal ) ) );
float geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );
material.roughness = max( roughnessFactor, 0.0525 );material.roughness += geometryRoughness;
material.roughness = min( material.roughness, 1.0 );
#ifdef IOR
	material.ior = ior;
	#ifdef USE_SPECULAR
		float specularIntensityFactor = specularIntensity;
		vec3 specularColorFactor = specularColor;
		#ifdef USE_SPECULAR_COLORMAP
			specularColorFactor *= texture2D( specularColorMap, vSpecularColorMapUv ).rgb;
		#endif
		#ifdef USE_SPECULAR_INTENSITYMAP
			specularIntensityFactor *= texture2D( specularIntensityMap, vSpecularIntensityMapUv ).a;
		#endif
		material.specularF90 = mix( specularIntensityFactor, 1.0, metalnessFactor );
	#else
		float specularIntensityFactor = 1.0;
		vec3 specularColorFactor = vec3( 1.0 );
		material.specularF90 = 1.0;
	#endif
	material.specularColor = min( pow2( ( material.ior - 1.0 ) / ( material.ior + 1.0 ) ) * specularColorFactor, vec3( 1.0 ) ) * specularIntensityFactor;
	material.specularColorBlended = mix( material.specularColor, diffuseColor.rgb, metalnessFactor );
#else
	material.specularColor = vec3( 0.04 );
	material.specularColorBlended = mix( material.specularColor, diffuseColor.rgb, metalnessFactor );
	material.specularF90 = 1.0;
#endif
#ifdef USE_CLEARCOAT
	material.clearcoat = clearcoat;
	material.clearcoatRoughness = clearcoatRoughness;
	material.clearcoatF0 = vec3( 0.04 );
	material.clearcoatF90 = 1.0;
	#ifdef USE_CLEARCOATMAP
		material.clearcoat *= texture2D( clearcoatMap, vClearcoatMapUv ).x;
	#endif
	#ifdef USE_CLEARCOAT_ROUGHNESSMAP
		material.clearcoatRoughness *= texture2D( clearcoatRoughnessMap, vClearcoatRoughnessMapUv ).y;
	#endif
	material.clearcoat = saturate( material.clearcoat );	material.clearcoatRoughness = max( material.clearcoatRoughness, 0.0525 );
	material.clearcoatRoughness += geometryRoughness;
	material.clearcoatRoughness = min( material.clearcoatRoughness, 1.0 );
#endif
#ifdef USE_DISPERSION
	material.dispersion = dispersion;
#endif
#ifdef USE_IRIDESCENCE
	material.iridescence = iridescence;
	material.iridescenceIOR = iridescenceIOR;
	#ifdef USE_IRIDESCENCEMAP
		material.iridescence *= texture2D( iridescenceMap, vIridescenceMapUv ).r;
	#endif
	#ifdef USE_IRIDESCENCE_THICKNESSMAP
		material.iridescenceThickness = (iridescenceThicknessMaximum - iridescenceThicknessMinimum) * texture2D( iridescenceThicknessMap, vIridescenceThicknessMapUv ).g + iridescenceThicknessMinimum;
	#else
		material.iridescenceThickness = iridescenceThicknessMaximum;
	#endif
#endif
#ifdef USE_SHEEN
	material.sheenColor = sheenColor;
	#ifdef USE_SHEEN_COLORMAP
		material.sheenColor *= texture2D( sheenColorMap, vSheenColorMapUv ).rgb;
	#endif
	material.sheenRoughness = clamp( sheenRoughness, 0.0001, 1.0 );
	#ifdef USE_SHEEN_ROUGHNESSMAP
		material.sheenRoughness *= texture2D( sheenRoughnessMap, vSheenRoughnessMapUv ).a;
	#endif
#endif
#ifdef USE_ANISOTROPY
	#ifdef USE_ANISOTROPYMAP
		mat2 anisotropyMat = mat2( anisotropyVector.x, anisotropyVector.y, - anisotropyVector.y, anisotropyVector.x );
		vec3 anisotropyPolar = texture2D( anisotropyMap, vAnisotropyMapUv ).rgb;
		vec2 anisotropyV = anisotropyMat * normalize( 2.0 * anisotropyPolar.rg - vec2( 1.0 ) ) * anisotropyPolar.b;
	#else
		vec2 anisotropyV = anisotropyVector;
	#endif
	material.anisotropy = length( anisotropyV );
	if( material.anisotropy == 0.0 ) {
		anisotropyV = vec2( 1.0, 0.0 );
	} else {
		anisotropyV /= material.anisotropy;
		material.anisotropy = saturate( material.anisotropy );
	}
	material.alphaT = mix( pow2( material.roughness ), 1.0, pow2( material.anisotropy ) );
	material.anisotropyT = tbn[ 0 ] * anisotropyV.x + tbn[ 1 ] * anisotropyV.y;
	material.anisotropyB = tbn[ 1 ] * anisotropyV.x - tbn[ 0 ] * anisotropyV.y;
#endif`,YJ=`uniform sampler2D dfgLUT;
struct PhysicalMaterial {
	vec3 diffuseColor;
	vec3 diffuseContribution;
	vec3 specularColor;
	vec3 specularColorBlended;
	float roughness;
	float metalness;
	float specularF90;
	float dispersion;
	#ifdef USE_CLEARCOAT
		float clearcoat;
		float clearcoatRoughness;
		vec3 clearcoatF0;
		float clearcoatF90;
	#endif
	#ifdef USE_IRIDESCENCE
		float iridescence;
		float iridescenceIOR;
		float iridescenceThickness;
		vec3 iridescenceFresnel;
		vec3 iridescenceF0;
		vec3 iridescenceFresnelDielectric;
		vec3 iridescenceFresnelMetallic;
	#endif
	#ifdef USE_SHEEN
		vec3 sheenColor;
		float sheenRoughness;
	#endif
	#ifdef IOR
		float ior;
	#endif
	#ifdef USE_TRANSMISSION
		float transmission;
		float transmissionAlpha;
		float thickness;
		float attenuationDistance;
		vec3 attenuationColor;
	#endif
	#ifdef USE_ANISOTROPY
		float anisotropy;
		float alphaT;
		vec3 anisotropyT;
		vec3 anisotropyB;
	#endif
};
vec3 clearcoatSpecularDirect = vec3( 0.0 );
vec3 clearcoatSpecularIndirect = vec3( 0.0 );
vec3 sheenSpecularDirect = vec3( 0.0 );
vec3 sheenSpecularIndirect = vec3(0.0 );
vec3 Schlick_to_F0( const in vec3 f, const in float f90, const in float dotVH ) {
    float x = clamp( 1.0 - dotVH, 0.0, 1.0 );
    float x2 = x * x;
    float x5 = clamp( x * x2 * x2, 0.0, 0.9999 );
    return ( f - vec3( f90 ) * x5 ) / ( 1.0 - x5 );
}
float V_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {
	float a2 = pow2( alpha );
	float gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );
	float gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );
	return 0.5 / max( gv + gl, EPSILON );
}
float D_GGX( const in float alpha, const in float dotNH ) {
	float a2 = pow2( alpha );
	float denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;
	return RECIPROCAL_PI * a2 / pow2( denom );
}
#ifdef USE_ANISOTROPY
	float V_GGX_SmithCorrelated_Anisotropic( const in float alphaT, const in float alphaB, const in float dotTV, const in float dotBV, const in float dotTL, const in float dotBL, const in float dotNV, const in float dotNL ) {
		float gv = dotNL * length( vec3( alphaT * dotTV, alphaB * dotBV, dotNV ) );
		float gl = dotNV * length( vec3( alphaT * dotTL, alphaB * dotBL, dotNL ) );
		float v = 0.5 / ( gv + gl );
		return v;
	}
	float D_GGX_Anisotropic( const in float alphaT, const in float alphaB, const in float dotNH, const in float dotTH, const in float dotBH ) {
		float a2 = alphaT * alphaB;
		highp vec3 v = vec3( alphaB * dotTH, alphaT * dotBH, a2 * dotNH );
		highp float v2 = dot( v, v );
		float w2 = a2 / v2;
		return RECIPROCAL_PI * a2 * pow2 ( w2 );
	}
#endif
#ifdef USE_CLEARCOAT
	vec3 BRDF_GGX_Clearcoat( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in PhysicalMaterial material) {
		vec3 f0 = material.clearcoatF0;
		float f90 = material.clearcoatF90;
		float roughness = material.clearcoatRoughness;
		float alpha = pow2( roughness );
		vec3 halfDir = normalize( lightDir + viewDir );
		float dotNL = saturate( dot( normal, lightDir ) );
		float dotNV = saturate( dot( normal, viewDir ) );
		float dotNH = saturate( dot( normal, halfDir ) );
		float dotVH = saturate( dot( viewDir, halfDir ) );
		vec3 F = F_Schlick( f0, f90, dotVH );
		float V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );
		float D = D_GGX( alpha, dotNH );
		return F * ( V * D );
	}
#endif
vec3 BRDF_GGX( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in PhysicalMaterial material ) {
	vec3 f0 = material.specularColorBlended;
	float f90 = material.specularF90;
	float roughness = material.roughness;
	float alpha = pow2( roughness );
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNL = saturate( dot( normal, lightDir ) );
	float dotNV = saturate( dot( normal, viewDir ) );
	float dotNH = saturate( dot( normal, halfDir ) );
	float dotVH = saturate( dot( viewDir, halfDir ) );
	vec3 F = F_Schlick( f0, f90, dotVH );
	#ifdef USE_IRIDESCENCE
		F = mix( F, material.iridescenceFresnel, material.iridescence );
	#endif
	#ifdef USE_ANISOTROPY
		float dotTL = dot( material.anisotropyT, lightDir );
		float dotTV = dot( material.anisotropyT, viewDir );
		float dotTH = dot( material.anisotropyT, halfDir );
		float dotBL = dot( material.anisotropyB, lightDir );
		float dotBV = dot( material.anisotropyB, viewDir );
		float dotBH = dot( material.anisotropyB, halfDir );
		float V = V_GGX_SmithCorrelated_Anisotropic( material.alphaT, alpha, dotTV, dotBV, dotTL, dotBL, dotNV, dotNL );
		float D = D_GGX_Anisotropic( material.alphaT, alpha, dotNH, dotTH, dotBH );
	#else
		float V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );
		float D = D_GGX( alpha, dotNH );
	#endif
	return F * ( V * D );
}
vec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {
	const float LUT_SIZE = 64.0;
	const float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;
	const float LUT_BIAS = 0.5 / LUT_SIZE;
	float dotNV = saturate( dot( N, V ) );
	vec2 uv = vec2( roughness, sqrt( 1.0 - dotNV ) );
	uv = uv * LUT_SCALE + LUT_BIAS;
	return uv;
}
float LTC_ClippedSphereFormFactor( const in vec3 f ) {
	float l = length( f );
	return max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );
}
vec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {
	float x = dot( v1, v2 );
	float y = abs( x );
	float a = 0.8543985 + ( 0.4965155 + 0.0145206 * y ) * y;
	float b = 3.4175940 + ( 4.1616724 + y ) * y;
	float v = a / b;
	float theta_sintheta = ( x > 0.0 ) ? v : 0.5 * inversesqrt( max( 1.0 - x * x, 1e-7 ) ) - v;
	return cross( v1, v2 ) * theta_sintheta;
}
vec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {
	vec3 v1 = rectCoords[ 1 ] - rectCoords[ 0 ];
	vec3 v2 = rectCoords[ 3 ] - rectCoords[ 0 ];
	vec3 lightNormal = cross( v1, v2 );
	if( dot( lightNormal, P - rectCoords[ 0 ] ) < 0.0 ) return vec3( 0.0 );
	vec3 T1, T2;
	T1 = normalize( V - N * dot( V, N ) );
	T2 = - cross( N, T1 );
	mat3 mat = mInv * transpose( mat3( T1, T2, N ) );
	vec3 coords[ 4 ];
	coords[ 0 ] = mat * ( rectCoords[ 0 ] - P );
	coords[ 1 ] = mat * ( rectCoords[ 1 ] - P );
	coords[ 2 ] = mat * ( rectCoords[ 2 ] - P );
	coords[ 3 ] = mat * ( rectCoords[ 3 ] - P );
	coords[ 0 ] = normalize( coords[ 0 ] );
	coords[ 1 ] = normalize( coords[ 1 ] );
	coords[ 2 ] = normalize( coords[ 2 ] );
	coords[ 3 ] = normalize( coords[ 3 ] );
	vec3 vectorFormFactor = vec3( 0.0 );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );
	float result = LTC_ClippedSphereFormFactor( vectorFormFactor );
	return vec3( result );
}
#if defined( USE_SHEEN )
float D_Charlie( float roughness, float dotNH ) {
	float alpha = pow2( roughness );
	float invAlpha = 1.0 / alpha;
	float cos2h = dotNH * dotNH;
	float sin2h = max( 1.0 - cos2h, 0.0078125 );
	return ( 2.0 + invAlpha ) * pow( sin2h, invAlpha * 0.5 ) / ( 2.0 * PI );
}
float V_Neubelt( float dotNV, float dotNL ) {
	return saturate( 1.0 / ( 4.0 * ( dotNL + dotNV - dotNL * dotNV ) ) );
}
vec3 BRDF_Sheen( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, vec3 sheenColor, const in float sheenRoughness ) {
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNL = saturate( dot( normal, lightDir ) );
	float dotNV = saturate( dot( normal, viewDir ) );
	float dotNH = saturate( dot( normal, halfDir ) );
	float D = D_Charlie( sheenRoughness, dotNH );
	float V = V_Neubelt( dotNV, dotNL );
	return sheenColor * ( D * V );
}
#endif
float IBLSheenBRDF( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {
	float dotNV = saturate( dot( normal, viewDir ) );
	float r2 = roughness * roughness;
	float rInv = 1.0 / ( roughness + 0.1 );
	float a = -1.9362 + 1.0678 * roughness + 0.4573 * r2 - 0.8469 * rInv;
	float b = -0.6014 + 0.5538 * roughness - 0.4670 * r2 - 0.1255 * rInv;
	float DG = exp( a * dotNV + b );
	return saturate( DG );
}
vec3 EnvironmentBRDF( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness ) {
	float dotNV = saturate( dot( normal, viewDir ) );
	vec2 fab = texture2D( dfgLUT, vec2( roughness, dotNV ) ).rg;
	return specularColor * fab.x + specularF90 * fab.y;
}
#ifdef USE_IRIDESCENCE
void computeMultiscatteringIridescence( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float iridescence, const in vec3 iridescenceF0, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {
#else
void computeMultiscattering( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {
#endif
	float dotNV = saturate( dot( normal, viewDir ) );
	vec2 fab = texture2D( dfgLUT, vec2( roughness, dotNV ) ).rg;
	#ifdef USE_IRIDESCENCE
		vec3 Fr = mix( specularColor, iridescenceF0, iridescence );
	#else
		vec3 Fr = specularColor;
	#endif
	vec3 FssEss = Fr * fab.x + specularF90 * fab.y;
	float Ess = fab.x + fab.y;
	float Ems = 1.0 - Ess;
	vec3 Favg = Fr + ( 1.0 - Fr ) * 0.047619;	vec3 Fms = FssEss * Favg / ( 1.0 - Ems * Favg );
	singleScatter += FssEss;
	multiScatter += Fms * Ems;
}
vec3 BRDF_GGX_Multiscatter( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in PhysicalMaterial material ) {
	vec3 singleScatter = BRDF_GGX( lightDir, viewDir, normal, material );
	float dotNL = saturate( dot( normal, lightDir ) );
	float dotNV = saturate( dot( normal, viewDir ) );
	vec2 dfgV = texture2D( dfgLUT, vec2( material.roughness, dotNV ) ).rg;
	vec2 dfgL = texture2D( dfgLUT, vec2( material.roughness, dotNL ) ).rg;
	vec3 FssEss_V = material.specularColorBlended * dfgV.x + material.specularF90 * dfgV.y;
	vec3 FssEss_L = material.specularColorBlended * dfgL.x + material.specularF90 * dfgL.y;
	float Ess_V = dfgV.x + dfgV.y;
	float Ess_L = dfgL.x + dfgL.y;
	float Ems_V = 1.0 - Ess_V;
	float Ems_L = 1.0 - Ess_L;
	vec3 Favg = material.specularColorBlended + ( 1.0 - material.specularColorBlended ) * 0.047619;
	vec3 Fms = FssEss_V * FssEss_L * Favg / ( 1.0 - Ems_V * Ems_L * Favg + EPSILON );
	float compensationFactor = Ems_V * Ems_L;
	vec3 multiScatter = Fms * compensationFactor;
	return singleScatter + multiScatter;
}
#if NUM_RECT_AREA_LIGHTS > 0
	void RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
		vec3 normal = geometryNormal;
		vec3 viewDir = geometryViewDir;
		vec3 position = geometryPosition;
		vec3 lightPos = rectAreaLight.position;
		vec3 halfWidth = rectAreaLight.halfWidth;
		vec3 halfHeight = rectAreaLight.halfHeight;
		vec3 lightColor = rectAreaLight.color;
		float roughness = material.roughness;
		vec3 rectCoords[ 4 ];
		rectCoords[ 0 ] = lightPos + halfWidth - halfHeight;		rectCoords[ 1 ] = lightPos - halfWidth - halfHeight;
		rectCoords[ 2 ] = lightPos - halfWidth + halfHeight;
		rectCoords[ 3 ] = lightPos + halfWidth + halfHeight;
		vec2 uv = LTC_Uv( normal, viewDir, roughness );
		vec4 t1 = texture2D( ltc_1, uv );
		vec4 t2 = texture2D( ltc_2, uv );
		mat3 mInv = mat3(
			vec3( t1.x, 0, t1.y ),
			vec3(    0, 1,    0 ),
			vec3( t1.z, 0, t1.w )
		);
		vec3 fresnel = ( material.specularColorBlended * t2.x + ( vec3( 1.0 ) - material.specularColorBlended ) * t2.y );
		reflectedLight.directSpecular += lightColor * fresnel * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords );
		reflectedLight.directDiffuse += lightColor * material.diffuseContribution * LTC_Evaluate( normal, viewDir, position, mat3( 1.0 ), rectCoords );
	}
#endif
void RE_Direct_Physical( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometryNormal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	#ifdef USE_CLEARCOAT
		float dotNLcc = saturate( dot( geometryClearcoatNormal, directLight.direction ) );
		vec3 ccIrradiance = dotNLcc * directLight.color;
		clearcoatSpecularDirect += ccIrradiance * BRDF_GGX_Clearcoat( directLight.direction, geometryViewDir, geometryClearcoatNormal, material );
	#endif
	#ifdef USE_SHEEN
 
 		sheenSpecularDirect += irradiance * BRDF_Sheen( directLight.direction, geometryViewDir, geometryNormal, material.sheenColor, material.sheenRoughness );
 
 		float sheenAlbedoV = IBLSheenBRDF( geometryNormal, geometryViewDir, material.sheenRoughness );
 		float sheenAlbedoL = IBLSheenBRDF( geometryNormal, directLight.direction, material.sheenRoughness );
 
 		float sheenEnergyComp = 1.0 - max3( material.sheenColor ) * max( sheenAlbedoV, sheenAlbedoL );
 
 		irradiance *= sheenEnergyComp;
 
 	#endif
	reflectedLight.directSpecular += irradiance * BRDF_GGX_Multiscatter( directLight.direction, geometryViewDir, geometryNormal, material );
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseContribution );
}
void RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
	vec3 diffuse = irradiance * BRDF_Lambert( material.diffuseContribution );
	#ifdef USE_SHEEN
		float sheenAlbedo = IBLSheenBRDF( geometryNormal, geometryViewDir, material.sheenRoughness );
		float sheenEnergyComp = 1.0 - max3( material.sheenColor ) * sheenAlbedo;
		diffuse *= sheenEnergyComp;
	#endif
	reflectedLight.indirectDiffuse += diffuse;
}
void RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 irradiance, const in vec3 clearcoatRadiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight) {
	#ifdef USE_CLEARCOAT
		clearcoatSpecularIndirect += clearcoatRadiance * EnvironmentBRDF( geometryClearcoatNormal, geometryViewDir, material.clearcoatF0, material.clearcoatF90, material.clearcoatRoughness );
	#endif
	#ifdef USE_SHEEN
		sheenSpecularIndirect += irradiance * material.sheenColor * IBLSheenBRDF( geometryNormal, geometryViewDir, material.sheenRoughness ) * RECIPROCAL_PI;
 	#endif
	vec3 singleScatteringDielectric = vec3( 0.0 );
	vec3 multiScatteringDielectric = vec3( 0.0 );
	vec3 singleScatteringMetallic = vec3( 0.0 );
	vec3 multiScatteringMetallic = vec3( 0.0 );
	#ifdef USE_IRIDESCENCE
		computeMultiscatteringIridescence( geometryNormal, geometryViewDir, material.specularColor, material.specularF90, material.iridescence, material.iridescenceFresnelDielectric, material.roughness, singleScatteringDielectric, multiScatteringDielectric );
		computeMultiscatteringIridescence( geometryNormal, geometryViewDir, material.diffuseColor, material.specularF90, material.iridescence, material.iridescenceFresnelMetallic, material.roughness, singleScatteringMetallic, multiScatteringMetallic );
	#else
		computeMultiscattering( geometryNormal, geometryViewDir, material.specularColor, material.specularF90, material.roughness, singleScatteringDielectric, multiScatteringDielectric );
		computeMultiscattering( geometryNormal, geometryViewDir, material.diffuseColor, material.specularF90, material.roughness, singleScatteringMetallic, multiScatteringMetallic );
	#endif
	vec3 singleScattering = mix( singleScatteringDielectric, singleScatteringMetallic, material.metalness );
	vec3 multiScattering = mix( multiScatteringDielectric, multiScatteringMetallic, material.metalness );
	vec3 totalScatteringDielectric = singleScatteringDielectric + multiScatteringDielectric;
	vec3 diffuse = material.diffuseContribution * ( 1.0 - totalScatteringDielectric );
	vec3 cosineWeightedIrradiance = irradiance * RECIPROCAL_PI;
	vec3 indirectSpecular = radiance * singleScattering;
	indirectSpecular += multiScattering * cosineWeightedIrradiance;
	vec3 indirectDiffuse = diffuse * cosineWeightedIrradiance;
	#ifdef USE_SHEEN
		float sheenAlbedo = IBLSheenBRDF( geometryNormal, geometryViewDir, material.sheenRoughness );
		float sheenEnergyComp = 1.0 - max3( material.sheenColor ) * sheenAlbedo;
		indirectSpecular *= sheenEnergyComp;
		indirectDiffuse *= sheenEnergyComp;
	#endif
	reflectedLight.indirectSpecular += indirectSpecular;
	reflectedLight.indirectDiffuse += indirectDiffuse;
}
#define RE_Direct				RE_Direct_Physical
#define RE_Direct_RectArea		RE_Direct_RectArea_Physical
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Physical
#define RE_IndirectSpecular		RE_IndirectSpecular_Physical
float computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {
	return saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );
}`,ZJ=`
vec3 geometryPosition = - vViewPosition;
vec3 geometryNormal = normal;
vec3 geometryViewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( vViewPosition );
vec3 geometryClearcoatNormal = vec3( 0.0 );
#ifdef USE_CLEARCOAT
	geometryClearcoatNormal = clearcoatNormal;
#endif
#ifdef USE_IRIDESCENCE
	float dotNVi = saturate( dot( normal, geometryViewDir ) );
	if ( material.iridescenceThickness == 0.0 ) {
		material.iridescence = 0.0;
	} else {
		material.iridescence = saturate( material.iridescence );
	}
	if ( material.iridescence > 0.0 ) {
		material.iridescenceFresnelDielectric = evalIridescence( 1.0, material.iridescenceIOR, dotNVi, material.iridescenceThickness, material.specularColor );
		material.iridescenceFresnelMetallic = evalIridescence( 1.0, material.iridescenceIOR, dotNVi, material.iridescenceThickness, material.diffuseColor );
		material.iridescenceFresnel = mix( material.iridescenceFresnelDielectric, material.iridescenceFresnelMetallic, material.metalness );
		material.iridescenceF0 = Schlick_to_F0( material.iridescenceFresnel, 1.0, dotNVi );
	}
#endif
IncidentLight directLight;
#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )
	PointLight pointLight;
	#if defined( USE_SHADOWMAP ) && NUM_POINT_LIGHT_SHADOWS > 0
	PointLightShadow pointLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {
		pointLight = pointLights[ i ];
		getPointLightInfo( pointLight, geometryPosition, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_POINT_LIGHT_SHADOWS ) && ( defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_BASIC ) )
		pointLightShadow = pointLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getPointShadow( pointShadowMap[ i ], pointLightShadow.shadowMapSize, pointLightShadow.shadowIntensity, pointLightShadow.shadowBias, pointLightShadow.shadowRadius, vPointShadowCoord[ i ], pointLightShadow.shadowCameraNear, pointLightShadow.shadowCameraFar ) : 1.0;
		#endif
		RE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )
	SpotLight spotLight;
	vec4 spotColor;
	vec3 spotLightCoord;
	bool inSpotLightMap;
	#if defined( USE_SHADOWMAP ) && NUM_SPOT_LIGHT_SHADOWS > 0
	SpotLightShadow spotLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {
		spotLight = spotLights[ i ];
		getSpotLightInfo( spotLight, geometryPosition, directLight );
		#if ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )
		#define SPOT_LIGHT_MAP_INDEX UNROLLED_LOOP_INDEX
		#elif ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
		#define SPOT_LIGHT_MAP_INDEX NUM_SPOT_LIGHT_MAPS
		#else
		#define SPOT_LIGHT_MAP_INDEX ( UNROLLED_LOOP_INDEX - NUM_SPOT_LIGHT_SHADOWS + NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )
		#endif
		#if ( SPOT_LIGHT_MAP_INDEX < NUM_SPOT_LIGHT_MAPS )
			spotLightCoord = vSpotLightCoord[ i ].xyz / vSpotLightCoord[ i ].w;
			inSpotLightMap = all( lessThan( abs( spotLightCoord * 2. - 1. ), vec3( 1.0 ) ) );
			spotColor = texture2D( spotLightMap[ SPOT_LIGHT_MAP_INDEX ], spotLightCoord.xy );
			directLight.color = inSpotLightMap ? directLight.color * spotColor.rgb : directLight.color;
		#endif
		#undef SPOT_LIGHT_MAP_INDEX
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
		spotLightShadow = spotLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( spotShadowMap[ i ], spotLightShadow.shadowMapSize, spotLightShadow.shadowIntensity, spotLightShadow.shadowBias, spotLightShadow.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;
		#endif
		RE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )
	DirectionalLight directionalLight;
	#if defined( USE_SHADOWMAP ) && NUM_DIR_LIGHT_SHADOWS > 0
	DirectionalLightShadow directionalLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {
		directionalLight = directionalLights[ i ];
		getDirectionalLightInfo( directionalLight, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_DIR_LIGHT_SHADOWS )
		directionalLightShadow = directionalLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( directionalShadowMap[ i ], directionalLightShadow.shadowMapSize, directionalLightShadow.shadowIntensity, directionalLightShadow.shadowBias, directionalLightShadow.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;
		#endif
		RE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )
	RectAreaLight rectAreaLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {
		rectAreaLight = rectAreaLights[ i ];
		RE_Direct_RectArea( rectAreaLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if defined( RE_IndirectDiffuse )
	vec3 iblIrradiance = vec3( 0.0 );
	vec3 irradiance = getAmbientLightIrradiance( ambientLightColor );
	#if defined( USE_LIGHT_PROBES )
		irradiance += getLightProbeIrradiance( lightProbe, geometryNormal );
	#endif
	#if ( NUM_HEMI_LIGHTS > 0 )
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {
			irradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometryNormal );
		}
		#pragma unroll_loop_end
	#endif
#endif
#if defined( RE_IndirectSpecular )
	vec3 radiance = vec3( 0.0 );
	vec3 clearcoatRadiance = vec3( 0.0 );
#endif`,KJ=`#if defined( RE_IndirectDiffuse )
	#ifdef USE_LIGHTMAP
		vec4 lightMapTexel = texture2D( lightMap, vLightMapUv );
		vec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;
		irradiance += lightMapIrradiance;
	#endif
	#if defined( USE_ENVMAP ) && defined( STANDARD ) && defined( ENVMAP_TYPE_CUBE_UV )
		iblIrradiance += getIBLIrradiance( geometryNormal );
	#endif
#endif
#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )
	#ifdef USE_ANISOTROPY
		radiance += getIBLAnisotropyRadiance( geometryViewDir, geometryNormal, material.roughness, material.anisotropyB, material.anisotropy );
	#else
		radiance += getIBLRadiance( geometryViewDir, geometryNormal, material.roughness );
	#endif
	#ifdef USE_CLEARCOAT
		clearcoatRadiance += getIBLRadiance( geometryViewDir, geometryClearcoatNormal, material.clearcoatRoughness );
	#endif
#endif`,QJ=`#if defined( RE_IndirectDiffuse )
	RE_IndirectDiffuse( irradiance, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
#endif
#if defined( RE_IndirectSpecular )
	RE_IndirectSpecular( radiance, iblIrradiance, clearcoatRadiance, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
#endif`,JJ=`#if defined( USE_LOGARITHMIC_DEPTH_BUFFER )
	gl_FragDepth = vIsPerspective == 0.0 ? gl_FragCoord.z : log2( vFragDepth ) * logDepthBufFC * 0.5;
#endif`,eee=`#if defined( USE_LOGARITHMIC_DEPTH_BUFFER )
	uniform float logDepthBufFC;
	varying float vFragDepth;
	varying float vIsPerspective;
#endif`,tee=`#ifdef USE_LOGARITHMIC_DEPTH_BUFFER
	varying float vFragDepth;
	varying float vIsPerspective;
#endif`,nee=`#ifdef USE_LOGARITHMIC_DEPTH_BUFFER
	vFragDepth = 1.0 + gl_Position.w;
	vIsPerspective = float( isPerspectiveMatrix( projectionMatrix ) );
#endif`,iee=`#ifdef USE_MAP
	vec4 sampledDiffuseColor = texture2D( map, vMapUv );
	#ifdef DECODE_VIDEO_TEXTURE
		sampledDiffuseColor = sRGBTransferEOTF( sampledDiffuseColor );
	#endif
	diffuseColor *= sampledDiffuseColor;
#endif`,ree=`#ifdef USE_MAP
	uniform sampler2D map;
#endif`,see=`#if defined( USE_MAP ) || defined( USE_ALPHAMAP )
	#if defined( USE_POINTS_UV )
		vec2 uv = vUv;
	#else
		vec2 uv = ( uvTransform * vec3( gl_PointCoord.x, 1.0 - gl_PointCoord.y, 1 ) ).xy;
	#endif
#endif
#ifdef USE_MAP
	diffuseColor *= texture2D( map, uv );
#endif
#ifdef USE_ALPHAMAP
	diffuseColor.a *= texture2D( alphaMap, uv ).g;
#endif`,aee=`#if defined( USE_POINTS_UV )
	varying vec2 vUv;
#else
	#if defined( USE_MAP ) || defined( USE_ALPHAMAP )
		uniform mat3 uvTransform;
	#endif
#endif
#ifdef USE_MAP
	uniform sampler2D map;
#endif
#ifdef USE_ALPHAMAP
	uniform sampler2D alphaMap;
#endif`,oee=`float metalnessFactor = metalness;
#ifdef USE_METALNESSMAP
	vec4 texelMetalness = texture2D( metalnessMap, vMetalnessMapUv );
	metalnessFactor *= texelMetalness.b;
#endif`,lee=`#ifdef USE_METALNESSMAP
	uniform sampler2D metalnessMap;
#endif`,uee=`#ifdef USE_INSTANCING_MORPH
	float morphTargetInfluences[ MORPHTARGETS_COUNT ];
	float morphTargetBaseInfluence = texelFetch( morphTexture, ivec2( 0, gl_InstanceID ), 0 ).r;
	for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
		morphTargetInfluences[i] =  texelFetch( morphTexture, ivec2( i + 1, gl_InstanceID ), 0 ).r;
	}
#endif`,cee=`#if defined( USE_MORPHCOLORS )
	vColor *= morphTargetBaseInfluence;
	for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
		#if defined( USE_COLOR_ALPHA )
			if ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ) * morphTargetInfluences[ i ];
		#elif defined( USE_COLOR )
			if ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ).rgb * morphTargetInfluences[ i ];
		#endif
	}
#endif`,fee=`#ifdef USE_MORPHNORMALS
	objectNormal *= morphTargetBaseInfluence;
	for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
		if ( morphTargetInfluences[ i ] != 0.0 ) objectNormal += getMorph( gl_VertexID, i, 1 ).xyz * morphTargetInfluences[ i ];
	}
#endif`,dee=`#ifdef USE_MORPHTARGETS
	#ifndef USE_INSTANCING_MORPH
		uniform float morphTargetBaseInfluence;
		uniform float morphTargetInfluences[ MORPHTARGETS_COUNT ];
	#endif
	uniform sampler2DArray morphTargetsTexture;
	uniform ivec2 morphTargetsTextureSize;
	vec4 getMorph( const in int vertexIndex, const in int morphTargetIndex, const in int offset ) {
		int texelIndex = vertexIndex * MORPHTARGETS_TEXTURE_STRIDE + offset;
		int y = texelIndex / morphTargetsTextureSize.x;
		int x = texelIndex - y * morphTargetsTextureSize.x;
		ivec3 morphUV = ivec3( x, y, morphTargetIndex );
		return texelFetch( morphTargetsTexture, morphUV, 0 );
	}
#endif`,hee=`#ifdef USE_MORPHTARGETS
	transformed *= morphTargetBaseInfluence;
	for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
		if ( morphTargetInfluences[ i ] != 0.0 ) transformed += getMorph( gl_VertexID, i, 0 ).xyz * morphTargetInfluences[ i ];
	}
#endif`,pee=`float faceDirection = gl_FrontFacing ? 1.0 : - 1.0;
#ifdef FLAT_SHADED
	vec3 fdx = dFdx( vViewPosition );
	vec3 fdy = dFdy( vViewPosition );
	vec3 normal = normalize( cross( fdx, fdy ) );
#else
	vec3 normal = normalize( vNormal );
	#ifdef DOUBLE_SIDED
		normal *= faceDirection;
	#endif
#endif
#if defined( USE_NORMALMAP_TANGENTSPACE ) || defined( USE_CLEARCOAT_NORMALMAP ) || defined( USE_ANISOTROPY )
	#ifdef USE_TANGENT
		mat3 tbn = mat3( normalize( vTangent ), normalize( vBitangent ), normal );
	#else
		mat3 tbn = getTangentFrame( - vViewPosition, normal,
		#if defined( USE_NORMALMAP )
			vNormalMapUv
		#elif defined( USE_CLEARCOAT_NORMALMAP )
			vClearcoatNormalMapUv
		#else
			vUv
		#endif
		);
	#endif
	#if defined( DOUBLE_SIDED ) && ! defined( FLAT_SHADED )
		tbn[0] *= faceDirection;
		tbn[1] *= faceDirection;
	#endif
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	#ifdef USE_TANGENT
		mat3 tbn2 = mat3( normalize( vTangent ), normalize( vBitangent ), normal );
	#else
		mat3 tbn2 = getTangentFrame( - vViewPosition, normal, vClearcoatNormalMapUv );
	#endif
	#if defined( DOUBLE_SIDED ) && ! defined( FLAT_SHADED )
		tbn2[0] *= faceDirection;
		tbn2[1] *= faceDirection;
	#endif
#endif
vec3 nonPerturbedNormal = normal;`,mee=`#ifdef USE_NORMALMAP_OBJECTSPACE
	normal = texture2D( normalMap, vNormalMapUv ).xyz * 2.0 - 1.0;
	#ifdef FLIP_SIDED
		normal = - normal;
	#endif
	#ifdef DOUBLE_SIDED
		normal = normal * faceDirection;
	#endif
	normal = normalize( normalMatrix * normal );
#elif defined( USE_NORMALMAP_TANGENTSPACE )
	vec3 mapN = texture2D( normalMap, vNormalMapUv ).xyz * 2.0 - 1.0;
	mapN.xy *= normalScale;
	normal = normalize( tbn * mapN );
#elif defined( USE_BUMPMAP )
	normal = perturbNormalArb( - vViewPosition, normal, dHdxy_fwd(), faceDirection );
#endif`,gee=`#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif`,yee=`#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif`,_ee=`#ifndef FLAT_SHADED
	vNormal = normalize( transformedNormal );
	#ifdef USE_TANGENT
		vTangent = normalize( transformedTangent );
		vBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );
	#endif
#endif`,vee=`#ifdef USE_NORMALMAP
	uniform sampler2D normalMap;
	uniform vec2 normalScale;
#endif
#ifdef USE_NORMALMAP_OBJECTSPACE
	uniform mat3 normalMatrix;
#endif
#if ! defined ( USE_TANGENT ) && ( defined ( USE_NORMALMAP_TANGENTSPACE ) || defined ( USE_CLEARCOAT_NORMALMAP ) || defined( USE_ANISOTROPY ) )
	mat3 getTangentFrame( vec3 eye_pos, vec3 surf_norm, vec2 uv ) {
		vec3 q0 = dFdx( eye_pos.xyz );
		vec3 q1 = dFdy( eye_pos.xyz );
		vec2 st0 = dFdx( uv.st );
		vec2 st1 = dFdy( uv.st );
		vec3 N = surf_norm;
		vec3 q1perp = cross( q1, N );
		vec3 q0perp = cross( N, q0 );
		vec3 T = q1perp * st0.x + q0perp * st1.x;
		vec3 B = q1perp * st0.y + q0perp * st1.y;
		float det = max( dot( T, T ), dot( B, B ) );
		float scale = ( det == 0.0 ) ? 0.0 : inversesqrt( det );
		return mat3( T * scale, B * scale, N );
	}
#endif`,xee=`#ifdef USE_CLEARCOAT
	vec3 clearcoatNormal = nonPerturbedNormal;
#endif`,bee=`#ifdef USE_CLEARCOAT_NORMALMAP
	vec3 clearcoatMapN = texture2D( clearcoatNormalMap, vClearcoatNormalMapUv ).xyz * 2.0 - 1.0;
	clearcoatMapN.xy *= clearcoatNormalScale;
	clearcoatNormal = normalize( tbn2 * clearcoatMapN );
#endif`,See=`#ifdef USE_CLEARCOATMAP
	uniform sampler2D clearcoatMap;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	uniform sampler2D clearcoatNormalMap;
	uniform vec2 clearcoatNormalScale;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	uniform sampler2D clearcoatRoughnessMap;
#endif`,Tee=`#ifdef USE_IRIDESCENCEMAP
	uniform sampler2D iridescenceMap;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	uniform sampler2D iridescenceThicknessMap;
#endif`,Eee=`#ifdef OPAQUE
diffuseColor.a = 1.0;
#endif
#ifdef USE_TRANSMISSION
diffuseColor.a *= material.transmissionAlpha;
#endif
gl_FragColor = vec4( outgoingLight, diffuseColor.a );`,Mee=`vec3 packNormalToRGB( const in vec3 normal ) {
	return normalize( normal ) * 0.5 + 0.5;
}
vec3 unpackRGBToNormal( const in vec3 rgb ) {
	return 2.0 * rgb.xyz - 1.0;
}
const float PackUpscale = 256. / 255.;const float UnpackDownscale = 255. / 256.;const float ShiftRight8 = 1. / 256.;
const float Inv255 = 1. / 255.;
const vec4 PackFactors = vec4( 1.0, 256.0, 256.0 * 256.0, 256.0 * 256.0 * 256.0 );
const vec2 UnpackFactors2 = vec2( UnpackDownscale, 1.0 / PackFactors.g );
const vec3 UnpackFactors3 = vec3( UnpackDownscale / PackFactors.rg, 1.0 / PackFactors.b );
const vec4 UnpackFactors4 = vec4( UnpackDownscale / PackFactors.rgb, 1.0 / PackFactors.a );
vec4 packDepthToRGBA( const in float v ) {
	if( v <= 0.0 )
		return vec4( 0., 0., 0., 0. );
	if( v >= 1.0 )
		return vec4( 1., 1., 1., 1. );
	float vuf;
	float af = modf( v * PackFactors.a, vuf );
	float bf = modf( vuf * ShiftRight8, vuf );
	float gf = modf( vuf * ShiftRight8, vuf );
	return vec4( vuf * Inv255, gf * PackUpscale, bf * PackUpscale, af );
}
vec3 packDepthToRGB( const in float v ) {
	if( v <= 0.0 )
		return vec3( 0., 0., 0. );
	if( v >= 1.0 )
		return vec3( 1., 1., 1. );
	float vuf;
	float bf = modf( v * PackFactors.b, vuf );
	float gf = modf( vuf * ShiftRight8, vuf );
	return vec3( vuf * Inv255, gf * PackUpscale, bf );
}
vec2 packDepthToRG( const in float v ) {
	if( v <= 0.0 )
		return vec2( 0., 0. );
	if( v >= 1.0 )
		return vec2( 1., 1. );
	float vuf;
	float gf = modf( v * 256., vuf );
	return vec2( vuf * Inv255, gf );
}
float unpackRGBAToDepth( const in vec4 v ) {
	return dot( v, UnpackFactors4 );
}
float unpackRGBToDepth( const in vec3 v ) {
	return dot( v, UnpackFactors3 );
}
float unpackRGToDepth( const in vec2 v ) {
	return v.r * UnpackFactors2.r + v.g * UnpackFactors2.g;
}
vec4 pack2HalfToRGBA( const in vec2 v ) {
	vec4 r = vec4( v.x, fract( v.x * 255.0 ), v.y, fract( v.y * 255.0 ) );
	return vec4( r.x - r.y / 255.0, r.y, r.z - r.w / 255.0, r.w );
}
vec2 unpackRGBATo2Half( const in vec4 v ) {
	return vec2( v.x + ( v.y / 255.0 ), v.z + ( v.w / 255.0 ) );
}
float viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {
	return ( viewZ + near ) / ( near - far );
}
float orthographicDepthToViewZ( const in float depth, const in float near, const in float far ) {
	return depth * ( near - far ) - near;
}
float viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {
	return ( ( near + viewZ ) * far ) / ( ( far - near ) * viewZ );
}
float perspectiveDepthToViewZ( const in float depth, const in float near, const in float far ) {
	return ( near * far ) / ( ( far - near ) * depth - far );
}`,Aee=`#ifdef PREMULTIPLIED_ALPHA
	gl_FragColor.rgb *= gl_FragColor.a;
#endif`,wee=`vec4 mvPosition = vec4( transformed, 1.0 );
#ifdef USE_BATCHING
	mvPosition = batchingMatrix * mvPosition;
#endif
#ifdef USE_INSTANCING
	mvPosition = instanceMatrix * mvPosition;
#endif
mvPosition = modelViewMatrix * mvPosition;
gl_Position = projectionMatrix * mvPosition;`,Ree=`#ifdef DITHERING
	gl_FragColor.rgb = dithering( gl_FragColor.rgb );
#endif`,Cee=`#ifdef DITHERING
	vec3 dithering( vec3 color ) {
		float grid_position = rand( gl_FragCoord.xy );
		vec3 dither_shift_RGB = vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );
		dither_shift_RGB = mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );
		return color + dither_shift_RGB;
	}
#endif`,Nee=`float roughnessFactor = roughness;
#ifdef USE_ROUGHNESSMAP
	vec4 texelRoughness = texture2D( roughnessMap, vRoughnessMapUv );
	roughnessFactor *= texelRoughness.g;
#endif`,Dee=`#ifdef USE_ROUGHNESSMAP
	uniform sampler2D roughnessMap;
#endif`,Oee=`#if NUM_SPOT_LIGHT_COORDS > 0
	varying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];
#endif
#if NUM_SPOT_LIGHT_MAPS > 0
	uniform sampler2D spotLightMap[ NUM_SPOT_LIGHT_MAPS ];
#endif
#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
		#if defined( SHADOWMAP_TYPE_PCF )
			uniform sampler2DShadow directionalShadowMap[ NUM_DIR_LIGHT_SHADOWS ];
		#else
			uniform sampler2D directionalShadowMap[ NUM_DIR_LIGHT_SHADOWS ];
		#endif
		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];
		struct DirectionalLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
		#if defined( SHADOWMAP_TYPE_PCF )
			uniform sampler2DShadow spotShadowMap[ NUM_SPOT_LIGHT_SHADOWS ];
		#else
			uniform sampler2D spotShadowMap[ NUM_SPOT_LIGHT_SHADOWS ];
		#endif
		struct SpotLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		#if defined( SHADOWMAP_TYPE_PCF )
			uniform samplerCubeShadow pointShadowMap[ NUM_POINT_LIGHT_SHADOWS ];
		#elif defined( SHADOWMAP_TYPE_BASIC )
			uniform samplerCube pointShadowMap[ NUM_POINT_LIGHT_SHADOWS ];
		#endif
		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];
		struct PointLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
			float shadowCameraNear;
			float shadowCameraFar;
		};
		uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];
	#endif
	#if defined( SHADOWMAP_TYPE_PCF )
		float interleavedGradientNoise( vec2 position ) {
			return fract( 52.9829189 * fract( dot( position, vec2( 0.06711056, 0.00583715 ) ) ) );
		}
		vec2 vogelDiskSample( int sampleIndex, int samplesCount, float phi ) {
			const float goldenAngle = 2.399963229728653;
			float r = sqrt( ( float( sampleIndex ) + 0.5 ) / float( samplesCount ) );
			float theta = float( sampleIndex ) * goldenAngle + phi;
			return vec2( cos( theta ), sin( theta ) ) * r;
		}
	#endif
	#if defined( SHADOWMAP_TYPE_PCF )
		float getShadow( sampler2DShadow shadowMap, vec2 shadowMapSize, float shadowIntensity, float shadowBias, float shadowRadius, vec4 shadowCoord ) {
			float shadow = 1.0;
			shadowCoord.xyz /= shadowCoord.w;
			shadowCoord.z += shadowBias;
			bool inFrustum = shadowCoord.x >= 0.0 && shadowCoord.x <= 1.0 && shadowCoord.y >= 0.0 && shadowCoord.y <= 1.0;
			bool frustumTest = inFrustum && shadowCoord.z <= 1.0;
			if ( frustumTest ) {
				vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
				float radius = shadowRadius * texelSize.x;
				float phi = interleavedGradientNoise( gl_FragCoord.xy ) * 6.28318530718;
				shadow = (
					texture( shadowMap, vec3( shadowCoord.xy + vogelDiskSample( 0, 5, phi ) * radius, shadowCoord.z ) ) +
					texture( shadowMap, vec3( shadowCoord.xy + vogelDiskSample( 1, 5, phi ) * radius, shadowCoord.z ) ) +
					texture( shadowMap, vec3( shadowCoord.xy + vogelDiskSample( 2, 5, phi ) * radius, shadowCoord.z ) ) +
					texture( shadowMap, vec3( shadowCoord.xy + vogelDiskSample( 3, 5, phi ) * radius, shadowCoord.z ) ) +
					texture( shadowMap, vec3( shadowCoord.xy + vogelDiskSample( 4, 5, phi ) * radius, shadowCoord.z ) )
				) * 0.2;
			}
			return mix( 1.0, shadow, shadowIntensity );
		}
	#elif defined( SHADOWMAP_TYPE_VSM )
		float getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowIntensity, float shadowBias, float shadowRadius, vec4 shadowCoord ) {
			float shadow = 1.0;
			shadowCoord.xyz /= shadowCoord.w;
			shadowCoord.z += shadowBias;
			bool inFrustum = shadowCoord.x >= 0.0 && shadowCoord.x <= 1.0 && shadowCoord.y >= 0.0 && shadowCoord.y <= 1.0;
			bool frustumTest = inFrustum && shadowCoord.z <= 1.0;
			if ( frustumTest ) {
				vec2 distribution = texture2D( shadowMap, shadowCoord.xy ).rg;
				float mean = distribution.x;
				float variance = distribution.y * distribution.y;
				#ifdef USE_REVERSED_DEPTH_BUFFER
					float hard_shadow = step( mean, shadowCoord.z );
				#else
					float hard_shadow = step( shadowCoord.z, mean );
				#endif
				if ( hard_shadow == 1.0 ) {
					shadow = 1.0;
				} else {
					variance = max( variance, 0.0000001 );
					float d = shadowCoord.z - mean;
					float p_max = variance / ( variance + d * d );
					p_max = clamp( ( p_max - 0.3 ) / 0.65, 0.0, 1.0 );
					shadow = max( hard_shadow, p_max );
				}
			}
			return mix( 1.0, shadow, shadowIntensity );
		}
	#else
		float getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowIntensity, float shadowBias, float shadowRadius, vec4 shadowCoord ) {
			float shadow = 1.0;
			shadowCoord.xyz /= shadowCoord.w;
			shadowCoord.z += shadowBias;
			bool inFrustum = shadowCoord.x >= 0.0 && shadowCoord.x <= 1.0 && shadowCoord.y >= 0.0 && shadowCoord.y <= 1.0;
			bool frustumTest = inFrustum && shadowCoord.z <= 1.0;
			if ( frustumTest ) {
				float depth = texture2D( shadowMap, shadowCoord.xy ).r;
				#ifdef USE_REVERSED_DEPTH_BUFFER
					shadow = step( depth, shadowCoord.z );
				#else
					shadow = step( shadowCoord.z, depth );
				#endif
			}
			return mix( 1.0, shadow, shadowIntensity );
		}
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
	#if defined( SHADOWMAP_TYPE_PCF )
	float getPointShadow( samplerCubeShadow shadowMap, vec2 shadowMapSize, float shadowIntensity, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {
		float shadow = 1.0;
		vec3 lightToPosition = shadowCoord.xyz;
		vec3 bd3D = normalize( lightToPosition );
		vec3 absVec = abs( lightToPosition );
		float viewSpaceZ = max( max( absVec.x, absVec.y ), absVec.z );
		if ( viewSpaceZ - shadowCameraFar <= 0.0 && viewSpaceZ - shadowCameraNear >= 0.0 ) {
			float dp = ( shadowCameraFar * ( viewSpaceZ - shadowCameraNear ) ) / ( viewSpaceZ * ( shadowCameraFar - shadowCameraNear ) );
			dp += shadowBias;
			float texelSize = shadowRadius / shadowMapSize.x;
			vec3 absDir = abs( bd3D );
			vec3 tangent = absDir.x > absDir.z ? vec3( 0.0, 1.0, 0.0 ) : vec3( 1.0, 0.0, 0.0 );
			tangent = normalize( cross( bd3D, tangent ) );
			vec3 bitangent = cross( bd3D, tangent );
			float phi = interleavedGradientNoise( gl_FragCoord.xy ) * 6.28318530718;
			shadow = (
				texture( shadowMap, vec4( bd3D + ( tangent * vogelDiskSample( 0, 5, phi ).x + bitangent * vogelDiskSample( 0, 5, phi ).y ) * texelSize, dp ) ) +
				texture( shadowMap, vec4( bd3D + ( tangent * vogelDiskSample( 1, 5, phi ).x + bitangent * vogelDiskSample( 1, 5, phi ).y ) * texelSize, dp ) ) +
				texture( shadowMap, vec4( bd3D + ( tangent * vogelDiskSample( 2, 5, phi ).x + bitangent * vogelDiskSample( 2, 5, phi ).y ) * texelSize, dp ) ) +
				texture( shadowMap, vec4( bd3D + ( tangent * vogelDiskSample( 3, 5, phi ).x + bitangent * vogelDiskSample( 3, 5, phi ).y ) * texelSize, dp ) ) +
				texture( shadowMap, vec4( bd3D + ( tangent * vogelDiskSample( 4, 5, phi ).x + bitangent * vogelDiskSample( 4, 5, phi ).y ) * texelSize, dp ) )
			) * 0.2;
		}
		return mix( 1.0, shadow, shadowIntensity );
	}
	#elif defined( SHADOWMAP_TYPE_BASIC )
	float getPointShadow( samplerCube shadowMap, vec2 shadowMapSize, float shadowIntensity, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {
		float shadow = 1.0;
		vec3 lightToPosition = shadowCoord.xyz;
		vec3 bd3D = normalize( lightToPosition );
		vec3 absVec = abs( lightToPosition );
		float viewSpaceZ = max( max( absVec.x, absVec.y ), absVec.z );
		if ( viewSpaceZ - shadowCameraFar <= 0.0 && viewSpaceZ - shadowCameraNear >= 0.0 ) {
			float dp = ( shadowCameraFar * ( viewSpaceZ - shadowCameraNear ) ) / ( viewSpaceZ * ( shadowCameraFar - shadowCameraNear ) );
			dp += shadowBias;
			float depth = textureCube( shadowMap, bd3D ).r;
			#ifdef USE_REVERSED_DEPTH_BUFFER
				shadow = step( depth, dp );
			#else
				shadow = step( dp, depth );
			#endif
		}
		return mix( 1.0, shadow, shadowIntensity );
	}
	#endif
	#endif
#endif`,Uee=`#if NUM_SPOT_LIGHT_COORDS > 0
	uniform mat4 spotLightMatrix[ NUM_SPOT_LIGHT_COORDS ];
	varying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];
#endif
#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
		uniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHT_SHADOWS ];
		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];
		struct DirectionalLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
		struct SpotLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		uniform mat4 pointShadowMatrix[ NUM_POINT_LIGHT_SHADOWS ];
		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];
		struct PointLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
			float shadowCameraNear;
			float shadowCameraFar;
		};
		uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];
	#endif
#endif`,Lee=`#if ( defined( USE_SHADOWMAP ) && ( NUM_DIR_LIGHT_SHADOWS > 0 || NUM_POINT_LIGHT_SHADOWS > 0 ) ) || ( NUM_SPOT_LIGHT_COORDS > 0 )
	vec3 shadowWorldNormal = inverseTransformDirection( transformedNormal, viewMatrix );
	vec4 shadowWorldPosition;
#endif
#if defined( USE_SHADOWMAP )
	#if NUM_DIR_LIGHT_SHADOWS > 0
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {
			shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * directionalLightShadows[ i ].shadowNormalBias, 0 );
			vDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * shadowWorldPosition;
		}
		#pragma unroll_loop_end
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {
			shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * pointLightShadows[ i ].shadowNormalBias, 0 );
			vPointShadowCoord[ i ] = pointShadowMatrix[ i ] * shadowWorldPosition;
		}
		#pragma unroll_loop_end
	#endif
#endif
#if NUM_SPOT_LIGHT_COORDS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHT_COORDS; i ++ ) {
		shadowWorldPosition = worldPosition;
		#if ( defined( USE_SHADOWMAP ) && UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
			shadowWorldPosition.xyz += shadowWorldNormal * spotLightShadows[ i ].shadowNormalBias;
		#endif
		vSpotLightCoord[ i ] = spotLightMatrix[ i ] * shadowWorldPosition;
	}
	#pragma unroll_loop_end
#endif`,Pee=`float getShadowMask() {
	float shadow = 1.0;
	#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
	DirectionalLightShadow directionalLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {
		directionalLight = directionalLightShadows[ i ];
		shadow *= receiveShadow ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowIntensity, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
	SpotLightShadow spotLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {
		spotLight = spotLightShadows[ i ];
		shadow *= receiveShadow ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowIntensity, spotLight.shadowBias, spotLight.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0 && ( defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_BASIC ) )
	PointLightShadow pointLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {
		pointLight = pointLightShadows[ i ];
		shadow *= receiveShadow ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowIntensity, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#endif
	return shadow;
}`,Bee=`#ifdef USE_SKINNING
	mat4 boneMatX = getBoneMatrix( skinIndex.x );
	mat4 boneMatY = getBoneMatrix( skinIndex.y );
	mat4 boneMatZ = getBoneMatrix( skinIndex.z );
	mat4 boneMatW = getBoneMatrix( skinIndex.w );
#endif`,Iee=`#ifdef USE_SKINNING
	uniform mat4 bindMatrix;
	uniform mat4 bindMatrixInverse;
	uniform highp sampler2D boneTexture;
	mat4 getBoneMatrix( const in float i ) {
		int size = textureSize( boneTexture, 0 ).x;
		int j = int( i ) * 4;
		int x = j % size;
		int y = j / size;
		vec4 v1 = texelFetch( boneTexture, ivec2( x, y ), 0 );
		vec4 v2 = texelFetch( boneTexture, ivec2( x + 1, y ), 0 );
		vec4 v3 = texelFetch( boneTexture, ivec2( x + 2, y ), 0 );
		vec4 v4 = texelFetch( boneTexture, ivec2( x + 3, y ), 0 );
		return mat4( v1, v2, v3, v4 );
	}
#endif`,Fee=`#ifdef USE_SKINNING
	vec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );
	vec4 skinned = vec4( 0.0 );
	skinned += boneMatX * skinVertex * skinWeight.x;
	skinned += boneMatY * skinVertex * skinWeight.y;
	skinned += boneMatZ * skinVertex * skinWeight.z;
	skinned += boneMatW * skinVertex * skinWeight.w;
	transformed = ( bindMatrixInverse * skinned ).xyz;
#endif`,zee=`#ifdef USE_SKINNING
	mat4 skinMatrix = mat4( 0.0 );
	skinMatrix += skinWeight.x * boneMatX;
	skinMatrix += skinWeight.y * boneMatY;
	skinMatrix += skinWeight.z * boneMatZ;
	skinMatrix += skinWeight.w * boneMatW;
	skinMatrix = bindMatrixInverse * skinMatrix * bindMatrix;
	objectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;
	#ifdef USE_TANGENT
		objectTangent = vec4( skinMatrix * vec4( objectTangent, 0.0 ) ).xyz;
	#endif
#endif`,Vee=`float specularStrength;
#ifdef USE_SPECULARMAP
	vec4 texelSpecular = texture2D( specularMap, vSpecularMapUv );
	specularStrength = texelSpecular.r;
#else
	specularStrength = 1.0;
#endif`,Gee=`#ifdef USE_SPECULARMAP
	uniform sampler2D specularMap;
#endif`,kee=`#if defined( TONE_MAPPING )
	gl_FragColor.rgb = toneMapping( gl_FragColor.rgb );
#endif`,Hee=`#ifndef saturate
#define saturate( a ) clamp( a, 0.0, 1.0 )
#endif
uniform float toneMappingExposure;
vec3 LinearToneMapping( vec3 color ) {
	return saturate( toneMappingExposure * color );
}
vec3 ReinhardToneMapping( vec3 color ) {
	color *= toneMappingExposure;
	return saturate( color / ( vec3( 1.0 ) + color ) );
}
vec3 CineonToneMapping( vec3 color ) {
	color *= toneMappingExposure;
	color = max( vec3( 0.0 ), color - 0.004 );
	return pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );
}
vec3 RRTAndODTFit( vec3 v ) {
	vec3 a = v * ( v + 0.0245786 ) - 0.000090537;
	vec3 b = v * ( 0.983729 * v + 0.4329510 ) + 0.238081;
	return a / b;
}
vec3 ACESFilmicToneMapping( vec3 color ) {
	const mat3 ACESInputMat = mat3(
		vec3( 0.59719, 0.07600, 0.02840 ),		vec3( 0.35458, 0.90834, 0.13383 ),
		vec3( 0.04823, 0.01566, 0.83777 )
	);
	const mat3 ACESOutputMat = mat3(
		vec3(  1.60475, -0.10208, -0.00327 ),		vec3( -0.53108,  1.10813, -0.07276 ),
		vec3( -0.07367, -0.00605,  1.07602 )
	);
	color *= toneMappingExposure / 0.6;
	color = ACESInputMat * color;
	color = RRTAndODTFit( color );
	color = ACESOutputMat * color;
	return saturate( color );
}
const mat3 LINEAR_REC2020_TO_LINEAR_SRGB = mat3(
	vec3( 1.6605, - 0.1246, - 0.0182 ),
	vec3( - 0.5876, 1.1329, - 0.1006 ),
	vec3( - 0.0728, - 0.0083, 1.1187 )
);
const mat3 LINEAR_SRGB_TO_LINEAR_REC2020 = mat3(
	vec3( 0.6274, 0.0691, 0.0164 ),
	vec3( 0.3293, 0.9195, 0.0880 ),
	vec3( 0.0433, 0.0113, 0.8956 )
);
vec3 agxDefaultContrastApprox( vec3 x ) {
	vec3 x2 = x * x;
	vec3 x4 = x2 * x2;
	return + 15.5 * x4 * x2
		- 40.14 * x4 * x
		+ 31.96 * x4
		- 6.868 * x2 * x
		+ 0.4298 * x2
		+ 0.1191 * x
		- 0.00232;
}
vec3 AgXToneMapping( vec3 color ) {
	const mat3 AgXInsetMatrix = mat3(
		vec3( 0.856627153315983, 0.137318972929847, 0.11189821299995 ),
		vec3( 0.0951212405381588, 0.761241990602591, 0.0767994186031903 ),
		vec3( 0.0482516061458583, 0.101439036467562, 0.811302368396859 )
	);
	const mat3 AgXOutsetMatrix = mat3(
		vec3( 1.1271005818144368, - 0.1413297634984383, - 0.14132976349843826 ),
		vec3( - 0.11060664309660323, 1.157823702216272, - 0.11060664309660294 ),
		vec3( - 0.016493938717834573, - 0.016493938717834257, 1.2519364065950405 )
	);
	const float AgxMinEv = - 12.47393;	const float AgxMaxEv = 4.026069;
	color *= toneMappingExposure;
	color = LINEAR_SRGB_TO_LINEAR_REC2020 * color;
	color = AgXInsetMatrix * color;
	color = max( color, 1e-10 );	color = log2( color );
	color = ( color - AgxMinEv ) / ( AgxMaxEv - AgxMinEv );
	color = clamp( color, 0.0, 1.0 );
	color = agxDefaultContrastApprox( color );
	color = AgXOutsetMatrix * color;
	color = pow( max( vec3( 0.0 ), color ), vec3( 2.2 ) );
	color = LINEAR_REC2020_TO_LINEAR_SRGB * color;
	color = clamp( color, 0.0, 1.0 );
	return color;
}
vec3 NeutralToneMapping( vec3 color ) {
	const float StartCompression = 0.8 - 0.04;
	const float Desaturation = 0.15;
	color *= toneMappingExposure;
	float x = min( color.r, min( color.g, color.b ) );
	float offset = x < 0.08 ? x - 6.25 * x * x : 0.04;
	color -= offset;
	float peak = max( color.r, max( color.g, color.b ) );
	if ( peak < StartCompression ) return color;
	float d = 1. - StartCompression;
	float newPeak = 1. - d * d / ( peak + d - StartCompression );
	color *= newPeak / peak;
	float g = 1. - 1. / ( Desaturation * ( peak - newPeak ) + 1. );
	return mix( color, vec3( newPeak ), g );
}
vec3 CustomToneMapping( vec3 color ) { return color; }`,Wee=`#ifdef USE_TRANSMISSION
	material.transmission = transmission;
	material.transmissionAlpha = 1.0;
	material.thickness = thickness;
	material.attenuationDistance = attenuationDistance;
	material.attenuationColor = attenuationColor;
	#ifdef USE_TRANSMISSIONMAP
		material.transmission *= texture2D( transmissionMap, vTransmissionMapUv ).r;
	#endif
	#ifdef USE_THICKNESSMAP
		material.thickness *= texture2D( thicknessMap, vThicknessMapUv ).g;
	#endif
	vec3 pos = vWorldPosition;
	vec3 v = normalize( cameraPosition - pos );
	vec3 n = inverseTransformDirection( normal, viewMatrix );
	vec4 transmitted = getIBLVolumeRefraction(
		n, v, material.roughness, material.diffuseContribution, material.specularColorBlended, material.specularF90,
		pos, modelMatrix, viewMatrix, projectionMatrix, material.dispersion, material.ior, material.thickness,
		material.attenuationColor, material.attenuationDistance );
	material.transmissionAlpha = mix( material.transmissionAlpha, transmitted.a, material.transmission );
	totalDiffuse = mix( totalDiffuse, transmitted.rgb, material.transmission );
#endif`,qee=`#ifdef USE_TRANSMISSION
	uniform float transmission;
	uniform float thickness;
	uniform float attenuationDistance;
	uniform vec3 attenuationColor;
	#ifdef USE_TRANSMISSIONMAP
		uniform sampler2D transmissionMap;
	#endif
	#ifdef USE_THICKNESSMAP
		uniform sampler2D thicknessMap;
	#endif
	uniform vec2 transmissionSamplerSize;
	uniform sampler2D transmissionSamplerMap;
	uniform mat4 modelMatrix;
	uniform mat4 projectionMatrix;
	varying vec3 vWorldPosition;
	float w0( float a ) {
		return ( 1.0 / 6.0 ) * ( a * ( a * ( - a + 3.0 ) - 3.0 ) + 1.0 );
	}
	float w1( float a ) {
		return ( 1.0 / 6.0 ) * ( a *  a * ( 3.0 * a - 6.0 ) + 4.0 );
	}
	float w2( float a ){
		return ( 1.0 / 6.0 ) * ( a * ( a * ( - 3.0 * a + 3.0 ) + 3.0 ) + 1.0 );
	}
	float w3( float a ) {
		return ( 1.0 / 6.0 ) * ( a * a * a );
	}
	float g0( float a ) {
		return w0( a ) + w1( a );
	}
	float g1( float a ) {
		return w2( a ) + w3( a );
	}
	float h0( float a ) {
		return - 1.0 + w1( a ) / ( w0( a ) + w1( a ) );
	}
	float h1( float a ) {
		return 1.0 + w3( a ) / ( w2( a ) + w3( a ) );
	}
	vec4 bicubic( sampler2D tex, vec2 uv, vec4 texelSize, float lod ) {
		uv = uv * texelSize.zw + 0.5;
		vec2 iuv = floor( uv );
		vec2 fuv = fract( uv );
		float g0x = g0( fuv.x );
		float g1x = g1( fuv.x );
		float h0x = h0( fuv.x );
		float h1x = h1( fuv.x );
		float h0y = h0( fuv.y );
		float h1y = h1( fuv.y );
		vec2 p0 = ( vec2( iuv.x + h0x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;
		vec2 p1 = ( vec2( iuv.x + h1x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;
		vec2 p2 = ( vec2( iuv.x + h0x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;
		vec2 p3 = ( vec2( iuv.x + h1x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;
		return g0( fuv.y ) * ( g0x * textureLod( tex, p0, lod ) + g1x * textureLod( tex, p1, lod ) ) +
			g1( fuv.y ) * ( g0x * textureLod( tex, p2, lod ) + g1x * textureLod( tex, p3, lod ) );
	}
	vec4 textureBicubic( sampler2D sampler, vec2 uv, float lod ) {
		vec2 fLodSize = vec2( textureSize( sampler, int( lod ) ) );
		vec2 cLodSize = vec2( textureSize( sampler, int( lod + 1.0 ) ) );
		vec2 fLodSizeInv = 1.0 / fLodSize;
		vec2 cLodSizeInv = 1.0 / cLodSize;
		vec4 fSample = bicubic( sampler, uv, vec4( fLodSizeInv, fLodSize ), floor( lod ) );
		vec4 cSample = bicubic( sampler, uv, vec4( cLodSizeInv, cLodSize ), ceil( lod ) );
		return mix( fSample, cSample, fract( lod ) );
	}
	vec3 getVolumeTransmissionRay( const in vec3 n, const in vec3 v, const in float thickness, const in float ior, const in mat4 modelMatrix ) {
		vec3 refractionVector = refract( - v, normalize( n ), 1.0 / ior );
		vec3 modelScale;
		modelScale.x = length( vec3( modelMatrix[ 0 ].xyz ) );
		modelScale.y = length( vec3( modelMatrix[ 1 ].xyz ) );
		modelScale.z = length( vec3( modelMatrix[ 2 ].xyz ) );
		return normalize( refractionVector ) * thickness * modelScale;
	}
	float applyIorToRoughness( const in float roughness, const in float ior ) {
		return roughness * clamp( ior * 2.0 - 2.0, 0.0, 1.0 );
	}
	vec4 getTransmissionSample( const in vec2 fragCoord, const in float roughness, const in float ior ) {
		float lod = log2( transmissionSamplerSize.x ) * applyIorToRoughness( roughness, ior );
		return textureBicubic( transmissionSamplerMap, fragCoord.xy, lod );
	}
	vec3 volumeAttenuation( const in float transmissionDistance, const in vec3 attenuationColor, const in float attenuationDistance ) {
		if ( isinf( attenuationDistance ) ) {
			return vec3( 1.0 );
		} else {
			vec3 attenuationCoefficient = -log( attenuationColor ) / attenuationDistance;
			vec3 transmittance = exp( - attenuationCoefficient * transmissionDistance );			return transmittance;
		}
	}
	vec4 getIBLVolumeRefraction( const in vec3 n, const in vec3 v, const in float roughness, const in vec3 diffuseColor,
		const in vec3 specularColor, const in float specularF90, const in vec3 position, const in mat4 modelMatrix,
		const in mat4 viewMatrix, const in mat4 projMatrix, const in float dispersion, const in float ior, const in float thickness,
		const in vec3 attenuationColor, const in float attenuationDistance ) {
		vec4 transmittedLight;
		vec3 transmittance;
		#ifdef USE_DISPERSION
			float halfSpread = ( ior - 1.0 ) * 0.025 * dispersion;
			vec3 iors = vec3( ior - halfSpread, ior, ior + halfSpread );
			for ( int i = 0; i < 3; i ++ ) {
				vec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, iors[ i ], modelMatrix );
				vec3 refractedRayExit = position + transmissionRay;
				vec4 ndcPos = projMatrix * viewMatrix * vec4( refractedRayExit, 1.0 );
				vec2 refractionCoords = ndcPos.xy / ndcPos.w;
				refractionCoords += 1.0;
				refractionCoords /= 2.0;
				vec4 transmissionSample = getTransmissionSample( refractionCoords, roughness, iors[ i ] );
				transmittedLight[ i ] = transmissionSample[ i ];
				transmittedLight.a += transmissionSample.a;
				transmittance[ i ] = diffuseColor[ i ] * volumeAttenuation( length( transmissionRay ), attenuationColor, attenuationDistance )[ i ];
			}
			transmittedLight.a /= 3.0;
		#else
			vec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, ior, modelMatrix );
			vec3 refractedRayExit = position + transmissionRay;
			vec4 ndcPos = projMatrix * viewMatrix * vec4( refractedRayExit, 1.0 );
			vec2 refractionCoords = ndcPos.xy / ndcPos.w;
			refractionCoords += 1.0;
			refractionCoords /= 2.0;
			transmittedLight = getTransmissionSample( refractionCoords, roughness, ior );
			transmittance = diffuseColor * volumeAttenuation( length( transmissionRay ), attenuationColor, attenuationDistance );
		#endif
		vec3 attenuatedColor = transmittance * transmittedLight.rgb;
		vec3 F = EnvironmentBRDF( n, v, specularColor, specularF90, roughness );
		float transmittanceFactor = ( transmittance.r + transmittance.g + transmittance.b ) / 3.0;
		return vec4( ( 1.0 - F ) * attenuatedColor, 1.0 - ( 1.0 - transmittedLight.a ) * transmittanceFactor );
	}
#endif`,Xee=`#if defined( USE_UV ) || defined( USE_ANISOTROPY )
	varying vec2 vUv;
#endif
#ifdef USE_MAP
	varying vec2 vMapUv;
#endif
#ifdef USE_ALPHAMAP
	varying vec2 vAlphaMapUv;
#endif
#ifdef USE_LIGHTMAP
	varying vec2 vLightMapUv;
#endif
#ifdef USE_AOMAP
	varying vec2 vAoMapUv;
#endif
#ifdef USE_BUMPMAP
	varying vec2 vBumpMapUv;
#endif
#ifdef USE_NORMALMAP
	varying vec2 vNormalMapUv;
#endif
#ifdef USE_EMISSIVEMAP
	varying vec2 vEmissiveMapUv;
#endif
#ifdef USE_METALNESSMAP
	varying vec2 vMetalnessMapUv;
#endif
#ifdef USE_ROUGHNESSMAP
	varying vec2 vRoughnessMapUv;
#endif
#ifdef USE_ANISOTROPYMAP
	varying vec2 vAnisotropyMapUv;
#endif
#ifdef USE_CLEARCOATMAP
	varying vec2 vClearcoatMapUv;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	varying vec2 vClearcoatNormalMapUv;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	varying vec2 vClearcoatRoughnessMapUv;
#endif
#ifdef USE_IRIDESCENCEMAP
	varying vec2 vIridescenceMapUv;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	varying vec2 vIridescenceThicknessMapUv;
#endif
#ifdef USE_SHEEN_COLORMAP
	varying vec2 vSheenColorMapUv;
#endif
#ifdef USE_SHEEN_ROUGHNESSMAP
	varying vec2 vSheenRoughnessMapUv;
#endif
#ifdef USE_SPECULARMAP
	varying vec2 vSpecularMapUv;
#endif
#ifdef USE_SPECULAR_COLORMAP
	varying vec2 vSpecularColorMapUv;
#endif
#ifdef USE_SPECULAR_INTENSITYMAP
	varying vec2 vSpecularIntensityMapUv;
#endif
#ifdef USE_TRANSMISSIONMAP
	uniform mat3 transmissionMapTransform;
	varying vec2 vTransmissionMapUv;
#endif
#ifdef USE_THICKNESSMAP
	uniform mat3 thicknessMapTransform;
	varying vec2 vThicknessMapUv;
#endif`,$ee=`#if defined( USE_UV ) || defined( USE_ANISOTROPY )
	varying vec2 vUv;
#endif
#ifdef USE_MAP
	uniform mat3 mapTransform;
	varying vec2 vMapUv;
#endif
#ifdef USE_ALPHAMAP
	uniform mat3 alphaMapTransform;
	varying vec2 vAlphaMapUv;
#endif
#ifdef USE_LIGHTMAP
	uniform mat3 lightMapTransform;
	varying vec2 vLightMapUv;
#endif
#ifdef USE_AOMAP
	uniform mat3 aoMapTransform;
	varying vec2 vAoMapUv;
#endif
#ifdef USE_BUMPMAP
	uniform mat3 bumpMapTransform;
	varying vec2 vBumpMapUv;
#endif
#ifdef USE_NORMALMAP
	uniform mat3 normalMapTransform;
	varying vec2 vNormalMapUv;
#endif
#ifdef USE_DISPLACEMENTMAP
	uniform mat3 displacementMapTransform;
	varying vec2 vDisplacementMapUv;
#endif
#ifdef USE_EMISSIVEMAP
	uniform mat3 emissiveMapTransform;
	varying vec2 vEmissiveMapUv;
#endif
#ifdef USE_METALNESSMAP
	uniform mat3 metalnessMapTransform;
	varying vec2 vMetalnessMapUv;
#endif
#ifdef USE_ROUGHNESSMAP
	uniform mat3 roughnessMapTransform;
	varying vec2 vRoughnessMapUv;
#endif
#ifdef USE_ANISOTROPYMAP
	uniform mat3 anisotropyMapTransform;
	varying vec2 vAnisotropyMapUv;
#endif
#ifdef USE_CLEARCOATMAP
	uniform mat3 clearcoatMapTransform;
	varying vec2 vClearcoatMapUv;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	uniform mat3 clearcoatNormalMapTransform;
	varying vec2 vClearcoatNormalMapUv;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	uniform mat3 clearcoatRoughnessMapTransform;
	varying vec2 vClearcoatRoughnessMapUv;
#endif
#ifdef USE_SHEEN_COLORMAP
	uniform mat3 sheenColorMapTransform;
	varying vec2 vSheenColorMapUv;
#endif
#ifdef USE_SHEEN_ROUGHNESSMAP
	uniform mat3 sheenRoughnessMapTransform;
	varying vec2 vSheenRoughnessMapUv;
#endif
#ifdef USE_IRIDESCENCEMAP
	uniform mat3 iridescenceMapTransform;
	varying vec2 vIridescenceMapUv;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	uniform mat3 iridescenceThicknessMapTransform;
	varying vec2 vIridescenceThicknessMapUv;
#endif
#ifdef USE_SPECULARMAP
	uniform mat3 specularMapTransform;
	varying vec2 vSpecularMapUv;
#endif
#ifdef USE_SPECULAR_COLORMAP
	uniform mat3 specularColorMapTransform;
	varying vec2 vSpecularColorMapUv;
#endif
#ifdef USE_SPECULAR_INTENSITYMAP
	uniform mat3 specularIntensityMapTransform;
	varying vec2 vSpecularIntensityMapUv;
#endif
#ifdef USE_TRANSMISSIONMAP
	uniform mat3 transmissionMapTransform;
	varying vec2 vTransmissionMapUv;
#endif
#ifdef USE_THICKNESSMAP
	uniform mat3 thicknessMapTransform;
	varying vec2 vThicknessMapUv;
#endif`,jee=`#if defined( USE_UV ) || defined( USE_ANISOTROPY )
	vUv = vec3( uv, 1 ).xy;
#endif
#ifdef USE_MAP
	vMapUv = ( mapTransform * vec3( MAP_UV, 1 ) ).xy;
#endif
#ifdef USE_ALPHAMAP
	vAlphaMapUv = ( alphaMapTransform * vec3( ALPHAMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_LIGHTMAP
	vLightMapUv = ( lightMapTransform * vec3( LIGHTMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_AOMAP
	vAoMapUv = ( aoMapTransform * vec3( AOMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_BUMPMAP
	vBumpMapUv = ( bumpMapTransform * vec3( BUMPMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_NORMALMAP
	vNormalMapUv = ( normalMapTransform * vec3( NORMALMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_DISPLACEMENTMAP
	vDisplacementMapUv = ( displacementMapTransform * vec3( DISPLACEMENTMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_EMISSIVEMAP
	vEmissiveMapUv = ( emissiveMapTransform * vec3( EMISSIVEMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_METALNESSMAP
	vMetalnessMapUv = ( metalnessMapTransform * vec3( METALNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_ROUGHNESSMAP
	vRoughnessMapUv = ( roughnessMapTransform * vec3( ROUGHNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_ANISOTROPYMAP
	vAnisotropyMapUv = ( anisotropyMapTransform * vec3( ANISOTROPYMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_CLEARCOATMAP
	vClearcoatMapUv = ( clearcoatMapTransform * vec3( CLEARCOATMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	vClearcoatNormalMapUv = ( clearcoatNormalMapTransform * vec3( CLEARCOAT_NORMALMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	vClearcoatRoughnessMapUv = ( clearcoatRoughnessMapTransform * vec3( CLEARCOAT_ROUGHNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_IRIDESCENCEMAP
	vIridescenceMapUv = ( iridescenceMapTransform * vec3( IRIDESCENCEMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	vIridescenceThicknessMapUv = ( iridescenceThicknessMapTransform * vec3( IRIDESCENCE_THICKNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SHEEN_COLORMAP
	vSheenColorMapUv = ( sheenColorMapTransform * vec3( SHEEN_COLORMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SHEEN_ROUGHNESSMAP
	vSheenRoughnessMapUv = ( sheenRoughnessMapTransform * vec3( SHEEN_ROUGHNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SPECULARMAP
	vSpecularMapUv = ( specularMapTransform * vec3( SPECULARMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SPECULAR_COLORMAP
	vSpecularColorMapUv = ( specularColorMapTransform * vec3( SPECULAR_COLORMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SPECULAR_INTENSITYMAP
	vSpecularIntensityMapUv = ( specularIntensityMapTransform * vec3( SPECULAR_INTENSITYMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_TRANSMISSIONMAP
	vTransmissionMapUv = ( transmissionMapTransform * vec3( TRANSMISSIONMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_THICKNESSMAP
	vThicknessMapUv = ( thicknessMapTransform * vec3( THICKNESSMAP_UV, 1 ) ).xy;
#endif`,Yee=`#if defined( USE_ENVMAP ) || defined( DISTANCE ) || defined ( USE_SHADOWMAP ) || defined ( USE_TRANSMISSION ) || NUM_SPOT_LIGHT_COORDS > 0
	vec4 worldPosition = vec4( transformed, 1.0 );
	#ifdef USE_BATCHING
		worldPosition = batchingMatrix * worldPosition;
	#endif
	#ifdef USE_INSTANCING
		worldPosition = instanceMatrix * worldPosition;
	#endif
	worldPosition = modelMatrix * worldPosition;
#endif`;const Zee=`varying vec2 vUv;
uniform mat3 uvTransform;
void main() {
	vUv = ( uvTransform * vec3( uv, 1 ) ).xy;
	gl_Position = vec4( position.xy, 1.0, 1.0 );
}`,Kee=`uniform sampler2D t2D;
uniform float backgroundIntensity;
varying vec2 vUv;
void main() {
	vec4 texColor = texture2D( t2D, vUv );
	#ifdef DECODE_VIDEO_TEXTURE
		texColor = vec4( mix( pow( texColor.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), texColor.rgb * 0.0773993808, vec3( lessThanEqual( texColor.rgb, vec3( 0.04045 ) ) ) ), texColor.w );
	#endif
	texColor.rgb *= backgroundIntensity;
	gl_FragColor = texColor;
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,Qee=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
	gl_Position.z = gl_Position.w;
}`,Jee=`#ifdef ENVMAP_TYPE_CUBE
	uniform samplerCube envMap;
#elif defined( ENVMAP_TYPE_CUBE_UV )
	uniform sampler2D envMap;
#endif
uniform float flipEnvMap;
uniform float backgroundBlurriness;
uniform float backgroundIntensity;
uniform mat3 backgroundRotation;
varying vec3 vWorldDirection;
#include <cube_uv_reflection_fragment>
void main() {
	#ifdef ENVMAP_TYPE_CUBE
		vec4 texColor = textureCube( envMap, backgroundRotation * vec3( flipEnvMap * vWorldDirection.x, vWorldDirection.yz ) );
	#elif defined( ENVMAP_TYPE_CUBE_UV )
		vec4 texColor = textureCubeUV( envMap, backgroundRotation * vWorldDirection, backgroundBlurriness );
	#else
		vec4 texColor = vec4( 0.0, 0.0, 0.0, 1.0 );
	#endif
	texColor.rgb *= backgroundIntensity;
	gl_FragColor = texColor;
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,ete=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
	gl_Position.z = gl_Position.w;
}`,tte=`uniform samplerCube tCube;
uniform float tFlip;
uniform float opacity;
varying vec3 vWorldDirection;
void main() {
	vec4 texColor = textureCube( tCube, vec3( tFlip * vWorldDirection.x, vWorldDirection.yz ) );
	gl_FragColor = texColor;
	gl_FragColor.a *= opacity;
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,nte=`#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
varying vec2 vHighPrecisionZW;
void main() {
	#include <uv_vertex>
	#include <batching_vertex>
	#include <skinbase_vertex>
	#include <morphinstance_vertex>
	#ifdef USE_DISPLACEMENTMAP
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vHighPrecisionZW = gl_Position.zw;
}`,ite=`#if DEPTH_PACKING == 3200
	uniform float opacity;
#endif
#include <common>
#include <packing>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
varying vec2 vHighPrecisionZW;
void main() {
	vec4 diffuseColor = vec4( 1.0 );
	#include <clipping_planes_fragment>
	#if DEPTH_PACKING == 3200
		diffuseColor.a = opacity;
	#endif
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <logdepthbuf_fragment>
	#ifdef USE_REVERSED_DEPTH_BUFFER
		float fragCoordZ = vHighPrecisionZW[ 0 ] / vHighPrecisionZW[ 1 ];
	#else
		float fragCoordZ = 0.5 * vHighPrecisionZW[ 0 ] / vHighPrecisionZW[ 1 ] + 0.5;
	#endif
	#if DEPTH_PACKING == 3200
		gl_FragColor = vec4( vec3( 1.0 - fragCoordZ ), opacity );
	#elif DEPTH_PACKING == 3201
		gl_FragColor = packDepthToRGBA( fragCoordZ );
	#elif DEPTH_PACKING == 3202
		gl_FragColor = vec4( packDepthToRGB( fragCoordZ ), 1.0 );
	#elif DEPTH_PACKING == 3203
		gl_FragColor = vec4( packDepthToRG( fragCoordZ ), 0.0, 1.0 );
	#endif
}`,rte=`#define DISTANCE
varying vec3 vWorldPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <batching_vertex>
	#include <skinbase_vertex>
	#include <morphinstance_vertex>
	#ifdef USE_DISPLACEMENTMAP
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <worldpos_vertex>
	#include <clipping_planes_vertex>
	vWorldPosition = worldPosition.xyz;
}`,ste=`#define DISTANCE
uniform vec3 referencePosition;
uniform float nearDistance;
uniform float farDistance;
varying vec3 vWorldPosition;
#include <common>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <clipping_planes_pars_fragment>
void main () {
	vec4 diffuseColor = vec4( 1.0 );
	#include <clipping_planes_fragment>
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	float dist = length( vWorldPosition - referencePosition );
	dist = ( dist - nearDistance ) / ( farDistance - nearDistance );
	dist = saturate( dist );
	gl_FragColor = vec4( dist, 0.0, 0.0, 1.0 );
}`,ate=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
}`,ote=`uniform sampler2D tEquirect;
varying vec3 vWorldDirection;
#include <common>
void main() {
	vec3 direction = normalize( vWorldDirection );
	vec2 sampleUV = equirectUv( direction );
	gl_FragColor = texture2D( tEquirect, sampleUV );
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,lte=`uniform float scale;
attribute float lineDistance;
varying float vLineDistance;
#include <common>
#include <uv_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	vLineDistance = scale * lineDistance;
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
}`,ute=`uniform vec3 diffuse;
uniform float opacity;
uniform float dashSize;
uniform float totalSize;
varying float vLineDistance;
#include <common>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	if ( mod( vLineDistance, totalSize ) > dashSize ) {
		discard;
	}
	vec3 outgoingLight = vec3( 0.0 );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
}`,cte=`#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#if defined ( USE_ENVMAP ) || defined ( USE_SKINNING )
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinbase_vertex>
		#include <skinnormal_vertex>
		#include <defaultnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <fog_vertex>
}`,fte=`uniform vec3 diffuse;
uniform float opacity;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
#endif
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <specularmap_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	#ifdef USE_LIGHTMAP
		vec4 lightMapTexel = texture2D( lightMap, vLightMapUv );
		reflectedLight.indirectDiffuse += lightMapTexel.rgb * lightMapIntensity * RECIPROCAL_PI;
	#else
		reflectedLight.indirectDiffuse += vec3( 1.0 );
	#endif
	#include <aomap_fragment>
	reflectedLight.indirectDiffuse *= diffuseColor.rgb;
	vec3 outgoingLight = reflectedLight.indirectDiffuse;
	#include <envmap_fragment>
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,dte=`#define LAMBERT
varying vec3 vViewPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,hte=`#define LAMBERT
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float opacity;
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_lambert_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <specularmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_lambert_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;
	#include <envmap_fragment>
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,pte=`#define MATCAP
varying vec3 vViewPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <color_pars_vertex>
#include <displacementmap_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
	vViewPosition = - mvPosition.xyz;
}`,mte=`#define MATCAP
uniform vec3 diffuse;
uniform float opacity;
uniform sampler2D matcap;
varying vec3 vViewPosition;
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <fog_pars_fragment>
#include <normal_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	vec3 viewDir = normalize( vViewPosition );
	vec3 x = normalize( vec3( viewDir.z, 0.0, - viewDir.x ) );
	vec3 y = cross( viewDir, x );
	vec2 uv = vec2( dot( x, normal ), dot( y, normal ) ) * 0.495 + 0.5;
	#ifdef USE_MATCAP
		vec4 matcapColor = texture2D( matcap, uv );
	#else
		vec4 matcapColor = vec4( vec3( mix( 0.2, 0.8, uv.y ) ), 1.0 );
	#endif
	vec3 outgoingLight = diffuseColor.rgb * matcapColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,gte=`#define NORMAL
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )
	varying vec3 vViewPosition;
#endif
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphinstance_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )
	vViewPosition = - mvPosition.xyz;
#endif
}`,yte=`#define NORMAL
uniform float opacity;
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )
	varying vec3 vViewPosition;
#endif
#include <uv_pars_fragment>
#include <normal_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( 0.0, 0.0, 0.0, opacity );
	#include <clipping_planes_fragment>
	#include <logdepthbuf_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	gl_FragColor = vec4( normalize( normal ) * 0.5 + 0.5, diffuseColor.a );
	#ifdef OPAQUE
		gl_FragColor.a = 1.0;
	#endif
}`,_te=`#define PHONG
varying vec3 vViewPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphinstance_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,vte=`#define PHONG
uniform vec3 diffuse;
uniform vec3 emissive;
uniform vec3 specular;
uniform float shininess;
uniform float opacity;
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_phong_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <specularmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_phong_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;
	#include <envmap_fragment>
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,xte=`#define STANDARD
varying vec3 vViewPosition;
#ifdef USE_TRANSMISSION
	varying vec3 vWorldPosition;
#endif
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
#ifdef USE_TRANSMISSION
	vWorldPosition = worldPosition.xyz;
#endif
}`,bte=`#define STANDARD
#ifdef PHYSICAL
	#define IOR
	#define USE_SPECULAR
#endif
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float roughness;
uniform float metalness;
uniform float opacity;
#ifdef IOR
	uniform float ior;
#endif
#ifdef USE_SPECULAR
	uniform float specularIntensity;
	uniform vec3 specularColor;
	#ifdef USE_SPECULAR_COLORMAP
		uniform sampler2D specularColorMap;
	#endif
	#ifdef USE_SPECULAR_INTENSITYMAP
		uniform sampler2D specularIntensityMap;
	#endif
#endif
#ifdef USE_CLEARCOAT
	uniform float clearcoat;
	uniform float clearcoatRoughness;
#endif
#ifdef USE_DISPERSION
	uniform float dispersion;
#endif
#ifdef USE_IRIDESCENCE
	uniform float iridescence;
	uniform float iridescenceIOR;
	uniform float iridescenceThicknessMinimum;
	uniform float iridescenceThicknessMaximum;
#endif
#ifdef USE_SHEEN
	uniform vec3 sheenColor;
	uniform float sheenRoughness;
	#ifdef USE_SHEEN_COLORMAP
		uniform sampler2D sheenColorMap;
	#endif
	#ifdef USE_SHEEN_ROUGHNESSMAP
		uniform sampler2D sheenRoughnessMap;
	#endif
#endif
#ifdef USE_ANISOTROPY
	uniform vec2 anisotropyVector;
	#ifdef USE_ANISOTROPYMAP
		uniform sampler2D anisotropyMap;
	#endif
#endif
varying vec3 vViewPosition;
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <iridescence_fragment>
#include <cube_uv_reflection_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_physical_pars_fragment>
#include <fog_pars_fragment>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_physical_pars_fragment>
#include <transmission_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <clearcoat_pars_fragment>
#include <iridescence_pars_fragment>
#include <roughnessmap_pars_fragment>
#include <metalnessmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <roughnessmap_fragment>
	#include <metalnessmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <clearcoat_normal_fragment_begin>
	#include <clearcoat_normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_physical_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 totalDiffuse = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse;
	vec3 totalSpecular = reflectedLight.directSpecular + reflectedLight.indirectSpecular;
	#include <transmission_fragment>
	vec3 outgoingLight = totalDiffuse + totalSpecular + totalEmissiveRadiance;
	#ifdef USE_SHEEN
 
		outgoingLight = outgoingLight + sheenSpecularDirect + sheenSpecularIndirect;
 
 	#endif
	#ifdef USE_CLEARCOAT
		float dotNVcc = saturate( dot( geometryClearcoatNormal, geometryViewDir ) );
		vec3 Fcc = F_Schlick( material.clearcoatF0, material.clearcoatF90, dotNVcc );
		outgoingLight = outgoingLight * ( 1.0 - material.clearcoat * Fcc ) + ( clearcoatSpecularDirect + clearcoatSpecularIndirect ) * material.clearcoat;
	#endif
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,Ste=`#define TOON
varying vec3 vViewPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,Tte=`#define TOON
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float opacity;
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <gradientmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_toon_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_toon_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,Ete=`uniform float size;
uniform float scale;
#include <common>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
#ifdef USE_POINTS_UV
	varying vec2 vUv;
	uniform mat3 uvTransform;
#endif
void main() {
	#ifdef USE_POINTS_UV
		vUv = ( uvTransform * vec3( uv, 1 ) ).xy;
	#endif
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <project_vertex>
	gl_PointSize = size;
	#ifdef USE_SIZEATTENUATION
		bool isPerspective = isPerspectiveMatrix( projectionMatrix );
		if ( isPerspective ) gl_PointSize *= ( scale / - mvPosition.z );
	#endif
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <worldpos_vertex>
	#include <fog_vertex>
}`,Mte=`uniform vec3 diffuse;
uniform float opacity;
#include <common>
#include <color_pars_fragment>
#include <map_particle_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	vec3 outgoingLight = vec3( 0.0 );
	#include <logdepthbuf_fragment>
	#include <map_particle_fragment>
	#include <color_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
}`,Ate=`#include <common>
#include <batching_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <shadowmap_pars_vertex>
void main() {
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphinstance_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,wte=`uniform vec3 color;
uniform float opacity;
#include <common>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <logdepthbuf_pars_fragment>
#include <shadowmap_pars_fragment>
#include <shadowmask_pars_fragment>
void main() {
	#include <logdepthbuf_fragment>
	gl_FragColor = vec4( color, opacity * ( 1.0 - getShadowMask() ) );
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
}`,Rte=`uniform float rotation;
uniform vec2 center;
#include <common>
#include <uv_pars_vertex>
#include <fog_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	vec4 mvPosition = modelViewMatrix[ 3 ];
	vec2 scale = vec2( length( modelMatrix[ 0 ].xyz ), length( modelMatrix[ 1 ].xyz ) );
	#ifndef USE_SIZEATTENUATION
		bool isPerspective = isPerspectiveMatrix( projectionMatrix );
		if ( isPerspective ) scale *= - mvPosition.z;
	#endif
	vec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale;
	vec2 rotatedPosition;
	rotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;
	rotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;
	mvPosition.xy += rotatedPosition;
	gl_Position = projectionMatrix * mvPosition;
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
}`,Cte=`uniform vec3 diffuse;
uniform float opacity;
#include <common>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	vec3 outgoingLight = vec3( 0.0 );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
}`,ui={alphahash_fragment:KQ,alphahash_pars_fragment:QQ,alphamap_fragment:JQ,alphamap_pars_fragment:eJ,alphatest_fragment:tJ,alphatest_pars_fragment:nJ,aomap_fragment:iJ,aomap_pars_fragment:rJ,batching_pars_vertex:sJ,batching_vertex:aJ,begin_vertex:oJ,beginnormal_vertex:lJ,bsdfs:uJ,iridescence_fragment:cJ,bumpmap_pars_fragment:fJ,clipping_planes_fragment:dJ,clipping_planes_pars_fragment:hJ,clipping_planes_pars_vertex:pJ,clipping_planes_vertex:mJ,color_fragment:gJ,color_pars_fragment:yJ,color_pars_vertex:_J,color_vertex:vJ,common:xJ,cube_uv_reflection_fragment:bJ,defaultnormal_vertex:SJ,displacementmap_pars_vertex:TJ,displacementmap_vertex:EJ,emissivemap_fragment:MJ,emissivemap_pars_fragment:AJ,colorspace_fragment:wJ,colorspace_pars_fragment:RJ,envmap_fragment:CJ,envmap_common_pars_fragment:NJ,envmap_pars_fragment:DJ,envmap_pars_vertex:OJ,envmap_physical_pars_fragment:HJ,envmap_vertex:UJ,fog_vertex:LJ,fog_pars_vertex:PJ,fog_fragment:BJ,fog_pars_fragment:IJ,gradientmap_pars_fragment:FJ,lightmap_pars_fragment:zJ,lights_lambert_fragment:VJ,lights_lambert_pars_fragment:GJ,lights_pars_begin:kJ,lights_toon_fragment:WJ,lights_toon_pars_fragment:qJ,lights_phong_fragment:XJ,lights_phong_pars_fragment:$J,lights_physical_fragment:jJ,lights_physical_pars_fragment:YJ,lights_fragment_begin:ZJ,lights_fragment_maps:KJ,lights_fragment_end:QJ,logdepthbuf_fragment:JJ,logdepthbuf_pars_fragment:eee,logdepthbuf_pars_vertex:tee,logdepthbuf_vertex:nee,map_fragment:iee,map_pars_fragment:ree,map_particle_fragment:see,map_particle_pars_fragment:aee,metalnessmap_fragment:oee,metalnessmap_pars_fragment:lee,morphinstance_vertex:uee,morphcolor_vertex:cee,morphnormal_vertex:fee,morphtarget_pars_vertex:dee,morphtarget_vertex:hee,normal_fragment_begin:pee,normal_fragment_maps:mee,normal_pars_fragment:gee,normal_pars_vertex:yee,normal_vertex:_ee,normalmap_pars_fragment:vee,clearcoat_normal_fragment_begin:xee,clearcoat_normal_fragment_maps:bee,clearcoat_pars_fragment:See,iridescence_pars_fragment:Tee,opaque_fragment:Eee,packing:Mee,premultiplied_alpha_fragment:Aee,project_vertex:wee,dithering_fragment:Ree,dithering_pars_fragment:Cee,roughnessmap_fragment:Nee,roughnessmap_pars_fragment:Dee,shadowmap_pars_fragment:Oee,shadowmap_pars_vertex:Uee,shadowmap_vertex:Lee,shadowmask_pars_fragment:Pee,skinbase_vertex:Bee,skinning_pars_vertex:Iee,skinning_vertex:Fee,skinnormal_vertex:zee,specularmap_fragment:Vee,specularmap_pars_fragment:Gee,tonemapping_fragment:kee,tonemapping_pars_fragment:Hee,transmission_fragment:Wee,transmission_pars_fragment:qee,uv_pars_fragment:Xee,uv_pars_vertex:$ee,uv_vertex:jee,worldpos_vertex:Yee,background_vert:Zee,background_frag:Kee,backgroundCube_vert:Qee,backgroundCube_frag:Jee,cube_vert:ete,cube_frag:tte,depth_vert:nte,depth_frag:ite,distance_vert:rte,distance_frag:ste,equirect_vert:ate,equirect_frag:ote,linedashed_vert:lte,linedashed_frag:ute,meshbasic_vert:cte,meshbasic_frag:fte,meshlambert_vert:dte,meshlambert_frag:hte,meshmatcap_vert:pte,meshmatcap_frag:mte,meshnormal_vert:gte,meshnormal_frag:yte,meshphong_vert:_te,meshphong_frag:vte,meshphysical_vert:xte,meshphysical_frag:bte,meshtoon_vert:Ste,meshtoon_frag:Tte,points_vert:Ete,points_frag:Mte,shadow_vert:Ate,shadow_frag:wte,sprite_vert:Rte,sprite_frag:Cte},sn={common:{diffuse:{value:new Kt(16777215)},opacity:{value:1},map:{value:null},mapTransform:{value:new Zn},alphaMap:{value:null},alphaMapTransform:{value:new Zn},alphaTest:{value:0}},specularmap:{specularMap:{value:null},specularMapTransform:{value:new Zn}},envmap:{envMap:{value:null},envMapRotation:{value:new Zn},flipEnvMap:{value:-1},reflectivity:{value:1},ior:{value:1.5},refractionRatio:{value:.98},dfgLUT:{value:null}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1},aoMapTransform:{value:new Zn}},lightmap:{lightMap:{value:null},lightMapIntensity:{value:1},lightMapTransform:{value:new Zn}},bumpmap:{bumpMap:{value:null},bumpMapTransform:{value:new Zn},bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalMapTransform:{value:new Zn},normalScale:{value:new tt(1,1)}},displacementmap:{displacementMap:{value:null},displacementMapTransform:{value:new Zn},displacementScale:{value:1},displacementBias:{value:0}},emissivemap:{emissiveMap:{value:null},emissiveMapTransform:{value:new Zn}},metalnessmap:{metalnessMap:{value:null},metalnessMapTransform:{value:new Zn}},roughnessmap:{roughnessMap:{value:null},roughnessMapTransform:{value:new Zn}},gradientmap:{gradientMap:{value:null}},fog:{fogDensity:{value:25e-5},fogNear:{value:1},fogFar:{value:2e3},fogColor:{value:new Kt(16777215)}},lights:{ambientLightColor:{value:[]},lightProbe:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{}}},directionalLightShadows:{value:[],properties:{shadowIntensity:1,shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},directionalShadowMap:{value:[]},directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{}}},spotLightShadows:{value:[],properties:{shadowIntensity:1,shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},spotLightMap:{value:[]},spotShadowMap:{value:[]},spotLightMatrix:{value:[]},pointLights:{value:[],properties:{color:{},position:{},decay:{},distance:{}}},pointLightShadows:{value:[],properties:{shadowIntensity:1,shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{},shadowCameraNear:{},shadowCameraFar:{}}},pointShadowMap:{value:[]},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},skyColor:{},groundColor:{}}},rectAreaLights:{value:[],properties:{color:{},position:{},width:{},height:{}}},ltc_1:{value:null},ltc_2:{value:null}},points:{diffuse:{value:new Kt(16777215)},opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},alphaMap:{value:null},alphaMapTransform:{value:new Zn},alphaTest:{value:0},uvTransform:{value:new Zn}},sprite:{diffuse:{value:new Kt(16777215)},opacity:{value:1},center:{value:new tt(.5,.5)},rotation:{value:0},map:{value:null},mapTransform:{value:new Zn},alphaMap:{value:null},alphaMapTransform:{value:new Zn},alphaTest:{value:0}}},Wc={basic:{uniforms:qo([sn.common,sn.specularmap,sn.envmap,sn.aomap,sn.lightmap,sn.fog]),vertexShader:ui.meshbasic_vert,fragmentShader:ui.meshbasic_frag},lambert:{uniforms:qo([sn.common,sn.specularmap,sn.envmap,sn.aomap,sn.lightmap,sn.emissivemap,sn.bumpmap,sn.normalmap,sn.displacementmap,sn.fog,sn.lights,{emissive:{value:new Kt(0)}}]),vertexShader:ui.meshlambert_vert,fragmentShader:ui.meshlambert_frag},phong:{uniforms:qo([sn.common,sn.specularmap,sn.envmap,sn.aomap,sn.lightmap,sn.emissivemap,sn.bumpmap,sn.normalmap,sn.displacementmap,sn.fog,sn.lights,{emissive:{value:new Kt(0)},specular:{value:new Kt(1118481)},shininess:{value:30}}]),vertexShader:ui.meshphong_vert,fragmentShader:ui.meshphong_frag},standard:{uniforms:qo([sn.common,sn.envmap,sn.aomap,sn.lightmap,sn.emissivemap,sn.bumpmap,sn.normalmap,sn.displacementmap,sn.roughnessmap,sn.metalnessmap,sn.fog,sn.lights,{emissive:{value:new Kt(0)},roughness:{value:1},metalness:{value:0},envMapIntensity:{value:1}}]),vertexShader:ui.meshphysical_vert,fragmentShader:ui.meshphysical_frag},toon:{uniforms:qo([sn.common,sn.aomap,sn.lightmap,sn.emissivemap,sn.bumpmap,sn.normalmap,sn.displacementmap,sn.gradientmap,sn.fog,sn.lights,{emissive:{value:new Kt(0)}}]),vertexShader:ui.meshtoon_vert,fragmentShader:ui.meshtoon_frag},matcap:{uniforms:qo([sn.common,sn.bumpmap,sn.normalmap,sn.displacementmap,sn.fog,{matcap:{value:null}}]),vertexShader:ui.meshmatcap_vert,fragmentShader:ui.meshmatcap_frag},points:{uniforms:qo([sn.points,sn.fog]),vertexShader:ui.points_vert,fragmentShader:ui.points_frag},dashed:{uniforms:qo([sn.common,sn.fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:ui.linedashed_vert,fragmentShader:ui.linedashed_frag},depth:{uniforms:qo([sn.common,sn.displacementmap]),vertexShader:ui.depth_vert,fragmentShader:ui.depth_frag},normal:{uniforms:qo([sn.common,sn.bumpmap,sn.normalmap,sn.displacementmap,{opacity:{value:1}}]),vertexShader:ui.meshnormal_vert,fragmentShader:ui.meshnormal_frag},sprite:{uniforms:qo([sn.sprite,sn.fog]),vertexShader:ui.sprite_vert,fragmentShader:ui.sprite_frag},background:{uniforms:{uvTransform:{value:new Zn},t2D:{value:null},backgroundIntensity:{value:1}},vertexShader:ui.background_vert,fragmentShader:ui.background_frag},backgroundCube:{uniforms:{envMap:{value:null},flipEnvMap:{value:-1},backgroundBlurriness:{value:0},backgroundIntensity:{value:1},backgroundRotation:{value:new Zn}},vertexShader:ui.backgroundCube_vert,fragmentShader:ui.backgroundCube_frag},cube:{uniforms:{tCube:{value:null},tFlip:{value:-1},opacity:{value:1}},vertexShader:ui.cube_vert,fragmentShader:ui.cube_frag},equirect:{uniforms:{tEquirect:{value:null}},vertexShader:ui.equirect_vert,fragmentShader:ui.equirect_frag},distance:{uniforms:qo([sn.common,sn.displacementmap,{referencePosition:{value:new ne},nearDistance:{value:1},farDistance:{value:1e3}}]),vertexShader:ui.distance_vert,fragmentShader:ui.distance_frag},shadow:{uniforms:qo([sn.lights,sn.fog,{color:{value:new Kt(0)},opacity:{value:1}}]),vertexShader:ui.shadow_vert,fragmentShader:ui.shadow_frag}};Wc.physical={uniforms:qo([Wc.standard.uniforms,{clearcoat:{value:0},clearcoatMap:{value:null},clearcoatMapTransform:{value:new Zn},clearcoatNormalMap:{value:null},clearcoatNormalMapTransform:{value:new Zn},clearcoatNormalScale:{value:new tt(1,1)},clearcoatRoughness:{value:0},clearcoatRoughnessMap:{value:null},clearcoatRoughnessMapTransform:{value:new Zn},dispersion:{value:0},iridescence:{value:0},iridescenceMap:{value:null},iridescenceMapTransform:{value:new Zn},iridescenceIOR:{value:1.3},iridescenceThicknessMinimum:{value:100},iridescenceThicknessMaximum:{value:400},iridescenceThicknessMap:{value:null},iridescenceThicknessMapTransform:{value:new Zn},sheen:{value:0},sheenColor:{value:new Kt(0)},sheenColorMap:{value:null},sheenColorMapTransform:{value:new Zn},sheenRoughness:{value:1},sheenRoughnessMap:{value:null},sheenRoughnessMapTransform:{value:new Zn},transmission:{value:0},transmissionMap:{value:null},transmissionMapTransform:{value:new Zn},transmissionSamplerSize:{value:new tt},transmissionSamplerMap:{value:null},thickness:{value:0},thicknessMap:{value:null},thicknessMapTransform:{value:new Zn},attenuationDistance:{value:0},attenuationColor:{value:new Kt(0)},specularColor:{value:new Kt(1,1,1)},specularColorMap:{value:null},specularColorMapTransform:{value:new Zn},specularIntensity:{value:1},specularIntensityMap:{value:null},specularIntensityMapTransform:{value:new Zn},anisotropyVector:{value:new tt},anisotropyMap:{value:null},anisotropyMapTransform:{value:new Zn}}]),vertexShader:ui.meshphysical_vert,fragmentShader:ui.meshphysical_frag};const wA={r:0,b:0,g:0},jg=new ll,Nte=new gn;function Dte(r,e,t,n,i,s,a){const o=new Kt(0);let l=s===!0?0:1,c,d,p=null,y=0,_=null;function v(R){let N=R.isScene===!0?R.background:null;return N&&N.isTexture&&(N=(R.backgroundBlurriness>0?t:e).get(N)),N}function b(R){let N=!1;const P=v(R);P===null?T(o,l):P&&P.isColor&&(T(P,1),N=!0);const U=r.xr.getEnvironmentBlendMode();U==="additive"?n.buffers.color.setClear(0,0,0,1,a):U==="alpha-blend"&&n.buffers.color.setClear(0,0,0,0,a),(r.autoClear||N)&&(n.buffers.depth.setTest(!0),n.buffers.depth.setMask(!0),n.buffers.color.setMask(!0),r.clear(r.autoClearColor,r.autoClearDepth,r.autoClearStencil))}function E(R,N){const P=v(N);P&&(P.isCubeTexture||P.mapping===Ph)?(d===void 0&&(d=new ar(new Xh(1,1,1),new ul({name:"BackgroundCubeMaterial",uniforms:_x(Wc.backgroundCube.uniforms),vertexShader:Wc.backgroundCube.vertexShader,fragmentShader:Wc.backgroundCube.fragmentShader,side:gr,depthTest:!1,depthWrite:!1,fog:!1,allowOverride:!1})),d.geometry.deleteAttribute("normal"),d.geometry.deleteAttribute("uv"),d.onBeforeRender=function(U,L,F){this.matrixWorld.copyPosition(F.matrixWorld)},Object.defineProperty(d.material,"envMap",{get:function(){return this.uniforms.envMap.value}}),i.update(d)),jg.copy(N.backgroundRotation),jg.x*=-1,jg.y*=-1,jg.z*=-1,P.isCubeTexture&&P.isRenderTargetTexture===!1&&(jg.y*=-1,jg.z*=-1),d.material.uniforms.envMap.value=P,d.material.uniforms.flipEnvMap.value=P.isCubeTexture&&P.isRenderTargetTexture===!1?-1:1,d.material.uniforms.backgroundBlurriness.value=N.backgroundBlurriness,d.material.uniforms.backgroundIntensity.value=N.backgroundIntensity,d.material.uniforms.backgroundRotation.value.setFromMatrix4(Nte.makeRotationFromEuler(jg)),d.material.toneMapped=Nn.getTransfer(P.colorSpace)!==an,(p!==P||y!==P.version||_!==r.toneMapping)&&(d.material.needsUpdate=!0,p=P,y=P.version,_=r.toneMapping),d.layers.enableAll(),R.unshift(d,d.geometry,d.material,0,0,null)):P&&P.isTexture&&(c===void 0&&(c=new ar(new $h(2,2),new ul({name:"BackgroundMaterial",uniforms:_x(Wc.background.uniforms),vertexShader:Wc.background.vertexShader,fragmentShader:Wc.background.fragmentShader,side:Cl,depthTest:!1,depthWrite:!1,fog:!1,allowOverride:!1})),c.geometry.deleteAttribute("normal"),Object.defineProperty(c.material,"map",{get:function(){return this.uniforms.t2D.value}}),i.update(c)),c.material.uniforms.t2D.value=P,c.material.uniforms.backgroundIntensity.value=N.backgroundIntensity,c.material.toneMapped=Nn.getTransfer(P.colorSpace)!==an,P.matrixAutoUpdate===!0&&P.updateMatrix(),c.material.uniforms.uvTransform.value.copy(P.matrix),(p!==P||y!==P.version||_!==r.toneMapping)&&(c.material.needsUpdate=!0,p=P,y=P.version,_=r.toneMapping),c.layers.enableAll(),R.unshift(c,c.geometry,c.material,0,0,null))}function T(R,N){R.getRGB(wA,Zk(r)),n.buffers.color.setClear(wA.r,wA.g,wA.b,N,a)}function M(){d!==void 0&&(d.geometry.dispose(),d.material.dispose(),d=void 0),c!==void 0&&(c.geometry.dispose(),c.material.dispose(),c=void 0)}return{getClearColor:function(){return o},setClearColor:function(R,N=1){o.set(R),l=N,T(o,l)},getClearAlpha:function(){return l},setClearAlpha:function(R){l=R,T(o,l)},render:b,addToRenderList:E,dispose:M}}function Ote(r,e){const t=r.getParameter(r.MAX_VERTEX_ATTRIBS),n={},i=y(null);let s=i,a=!1;function o(B,q,j,Q,se){let ae=!1;const V=p(Q,j,q);s!==V&&(s=V,c(s.object)),ae=_(B,Q,j,se),ae&&v(B,Q,j,se),se!==null&&e.update(se,r.ELEMENT_ARRAY_BUFFER),(ae||a)&&(a=!1,N(B,q,j,Q),se!==null&&r.bindBuffer(r.ELEMENT_ARRAY_BUFFER,e.get(se).buffer))}function l(){return r.createVertexArray()}function c(B){return r.bindVertexArray(B)}function d(B){return r.deleteVertexArray(B)}function p(B,q,j){const Q=j.wireframe===!0;let se=n[B.id];se===void 0&&(se={},n[B.id]=se);let ae=se[q.id];ae===void 0&&(ae={},se[q.id]=ae);let V=ae[Q];return V===void 0&&(V=y(l()),ae[Q]=V),V}function y(B){const q=[],j=[],Q=[];for(let se=0;se<t;se++)q[se]=0,j[se]=0,Q[se]=0;return{geometry:null,program:null,wireframe:!1,newAttributes:q,enabledAttributes:j,attributeDivisors:Q,object:B,attributes:{},index:null}}function _(B,q,j,Q){const se=s.attributes,ae=q.attributes;let V=0;const X=j.getAttributes();for(const ee in X)if(X[ee].location>=0){const Y=se[ee];let K=ae[ee];if(K===void 0&&(ee==="instanceMatrix"&&B.instanceMatrix&&(K=B.instanceMatrix),ee==="instanceColor"&&B.instanceColor&&(K=B.instanceColor)),Y===void 0||Y.attribute!==K||K&&Y.data!==K.data)return!0;V++}return s.attributesNum!==V||s.index!==Q}function v(B,q,j,Q){const se={},ae=q.attributes;let V=0;const X=j.getAttributes();for(const ee in X)if(X[ee].location>=0){let Y=ae[ee];Y===void 0&&(ee==="instanceMatrix"&&B.instanceMatrix&&(Y=B.instanceMatrix),ee==="instanceColor"&&B.instanceColor&&(Y=B.instanceColor));const K={};K.attribute=Y,Y&&Y.data&&(K.data=Y.data),se[ee]=K,V++}s.attributes=se,s.attributesNum=V,s.index=Q}function b(){const B=s.newAttributes;for(let q=0,j=B.length;q<j;q++)B[q]=0}function E(B){T(B,0)}function T(B,q){const j=s.newAttributes,Q=s.enabledAttributes,se=s.attributeDivisors;j[B]=1,Q[B]===0&&(r.enableVertexAttribArray(B),Q[B]=1),se[B]!==q&&(r.vertexAttribDivisor(B,q),se[B]=q)}function M(){const B=s.newAttributes,q=s.enabledAttributes;for(let j=0,Q=q.length;j<Q;j++)q[j]!==B[j]&&(r.disableVertexAttribArray(j),q[j]=0)}function R(B,q,j,Q,se,ae,V){V===!0?r.vertexAttribIPointer(B,q,j,se,ae):r.vertexAttribPointer(B,q,j,Q,se,ae)}function N(B,q,j,Q){b();const se=Q.attributes,ae=j.getAttributes(),V=q.defaultAttributeValues;for(const X in ae){const ee=ae[X];if(ee.location>=0){let fe=se[X];if(fe===void 0&&(X==="instanceMatrix"&&B.instanceMatrix&&(fe=B.instanceMatrix),X==="instanceColor"&&B.instanceColor&&(fe=B.instanceColor)),fe!==void 0){const Y=fe.normalized,K=fe.itemSize,he=e.get(fe);if(he===void 0)continue;const Ce=he.buffer,Ie=he.type,ut=he.bytesPerElement,Ee=Ie===r.INT||Ie===r.UNSIGNED_INT||fe.gpuType===Hs;if(fe.isInterleavedBufferAttribute){const Ne=fe.data,rt=Ne.stride,Nt=fe.offset;if(Ne.isInstancedInterleavedBuffer){for(let Ft=0;Ft<ee.locationSize;Ft++)T(ee.location+Ft,Ne.meshPerAttribute);B.isInstancedMesh!==!0&&Q._maxInstanceCount===void 0&&(Q._maxInstanceCount=Ne.meshPerAttribute*Ne.count)}else for(let Ft=0;Ft<ee.locationSize;Ft++)E(ee.location+Ft);r.bindBuffer(r.ARRAY_BUFFER,Ce);for(let Ft=0;Ft<ee.locationSize;Ft++)R(ee.location+Ft,K/ee.locationSize,Ie,Y,rt*ut,(Nt+K/ee.locationSize*Ft)*ut,Ee)}else{if(fe.isInstancedBufferAttribute){for(let Ne=0;Ne<ee.locationSize;Ne++)T(ee.location+Ne,fe.meshPerAttribute);B.isInstancedMesh!==!0&&Q._maxInstanceCount===void 0&&(Q._maxInstanceCount=fe.meshPerAttribute*fe.count)}else for(let Ne=0;Ne<ee.locationSize;Ne++)E(ee.location+Ne);r.bindBuffer(r.ARRAY_BUFFER,Ce);for(let Ne=0;Ne<ee.locationSize;Ne++)R(ee.location+Ne,K/ee.locationSize,Ie,Y,K*ut,K/ee.locationSize*Ne*ut,Ee)}}else if(V!==void 0){const Y=V[X];if(Y!==void 0)switch(Y.length){case 2:r.vertexAttrib2fv(ee.location,Y);break;case 3:r.vertexAttrib3fv(ee.location,Y);break;case 4:r.vertexAttrib4fv(ee.location,Y);break;default:r.vertexAttrib1fv(ee.location,Y)}}}}M()}function P(){F();for(const B in n){const q=n[B];for(const j in q){const Q=q[j];for(const se in Q)d(Q[se].object),delete Q[se];delete q[j]}delete n[B]}}function U(B){if(n[B.id]===void 0)return;const q=n[B.id];for(const j in q){const Q=q[j];for(const se in Q)d(Q[se].object),delete Q[se];delete q[j]}delete n[B.id]}function L(B){for(const q in n){const j=n[q];if(j[B.id]===void 0)continue;const Q=j[B.id];for(const se in Q)d(Q[se].object),delete Q[se];delete j[B.id]}}function F(){O(),a=!0,s!==i&&(s=i,c(s.object))}function O(){i.geometry=null,i.program=null,i.wireframe=!1}return{setup:o,reset:F,resetDefaultState:O,dispose:P,releaseStatesOfGeometry:U,releaseStatesOfProgram:L,initAttributes:b,enableAttribute:E,disableUnusedAttributes:M}}function Ute(r,e,t){let n;function i(c){n=c}function s(c,d){r.drawArrays(n,c,d),t.update(d,n,1)}function a(c,d,p){p!==0&&(r.drawArraysInstanced(n,c,d,p),t.update(d,n,p))}function o(c,d,p){if(p===0)return;e.get("WEBGL_multi_draw").multiDrawArraysWEBGL(n,c,0,d,0,p);let _=0;for(let v=0;v<p;v++)_+=d[v];t.update(_,n,1)}function l(c,d,p,y){if(p===0)return;const _=e.get("WEBGL_multi_draw");if(_===null)for(let v=0;v<c.length;v++)a(c[v],d[v],y[v]);else{_.multiDrawArraysInstancedWEBGL(n,c,0,d,0,y,0,p);let v=0;for(let b=0;b<p;b++)v+=d[b]*y[b];t.update(v,n,1)}}this.setMode=i,this.render=s,this.renderInstances=a,this.renderMultiDraw=o,this.renderMultiDrawInstances=l}function Lte(r,e,t,n){let i;function s(){if(i!==void 0)return i;if(e.has("EXT_texture_filter_anisotropic")===!0){const L=e.get("EXT_texture_filter_anisotropic");i=r.getParameter(L.MAX_TEXTURE_MAX_ANISOTROPY_EXT)}else i=0;return i}function a(L){return!(L!==Qi&&n.convert(L)!==r.getParameter(r.IMPLEMENTATION_COLOR_READ_FORMAT))}function o(L){const F=L===vi&&(e.has("EXT_color_buffer_half_float")||e.has("EXT_color_buffer_float"));return!(L!==ir&&n.convert(L)!==r.getParameter(r.IMPLEMENTATION_COLOR_READ_TYPE)&&L!==Ci&&!F)}function l(L){if(L==="highp"){if(r.getShaderPrecisionFormat(r.VERTEX_SHADER,r.HIGH_FLOAT).precision>0&&r.getShaderPrecisionFormat(r.FRAGMENT_SHADER,r.HIGH_FLOAT).precision>0)return"highp";L="mediump"}return L==="mediump"&&r.getShaderPrecisionFormat(r.VERTEX_SHADER,r.MEDIUM_FLOAT).precision>0&&r.getShaderPrecisionFormat(r.FRAGMENT_SHADER,r.MEDIUM_FLOAT).precision>0?"mediump":"lowp"}let c=t.precision!==void 0?t.precision:"highp";const d=l(c);d!==c&&(Ve("WebGLRenderer:",c,"not supported, using",d,"instead."),c=d);const p=t.logarithmicDepthBuffer===!0,y=t.reversedDepthBuffer===!0&&e.has("EXT_clip_control"),_=r.getParameter(r.MAX_TEXTURE_IMAGE_UNITS),v=r.getParameter(r.MAX_VERTEX_TEXTURE_IMAGE_UNITS),b=r.getParameter(r.MAX_TEXTURE_SIZE),E=r.getParameter(r.MAX_CUBE_MAP_TEXTURE_SIZE),T=r.getParameter(r.MAX_VERTEX_ATTRIBS),M=r.getParameter(r.MAX_VERTEX_UNIFORM_VECTORS),R=r.getParameter(r.MAX_VARYING_VECTORS),N=r.getParameter(r.MAX_FRAGMENT_UNIFORM_VECTORS),P=r.getParameter(r.MAX_SAMPLES),U=r.getParameter(r.SAMPLES);return{isWebGL2:!0,getMaxAnisotropy:s,getMaxPrecision:l,textureFormatReadable:a,textureTypeReadable:o,precision:c,logarithmicDepthBuffer:p,reversedDepthBuffer:y,maxTextures:_,maxVertexTextures:v,maxTextureSize:b,maxCubemapSize:E,maxAttributes:T,maxVertexUniforms:M,maxVaryings:R,maxFragmentUniforms:N,maxSamples:P,samples:U}}function Pte(r){const e=this;let t=null,n=0,i=!1,s=!1;const a=new Hc,o=new Zn,l={value:null,needsUpdate:!1};this.uniform=l,this.numPlanes=0,this.numIntersection=0,this.init=function(p,y){const _=p.length!==0||y||n!==0||i;return i=y,n=p.length,_},this.beginShadows=function(){s=!0,d(null)},this.endShadows=function(){s=!1},this.setGlobalState=function(p,y){t=d(p,y,0)},this.setState=function(p,y,_){const v=p.clippingPlanes,b=p.clipIntersection,E=p.clipShadows,T=r.get(p);if(!i||v===null||v.length===0||s&&!E)s?d(null):c();else{const M=s?0:n,R=M*4;let N=T.clippingState||null;l.value=N,N=d(v,y,R,_);for(let P=0;P!==R;++P)N[P]=t[P];T.clippingState=N,this.numIntersection=b?this.numPlanes:0,this.numPlanes+=M}};function c(){l.value!==t&&(l.value=t,l.needsUpdate=n>0),e.numPlanes=n,e.numIntersection=0}function d(p,y,_,v){const b=p!==null?p.length:0;let E=null;if(b!==0){if(E=l.value,v!==!0||E===null){const T=_+b*4,M=y.matrixWorldInverse;o.getNormalMatrix(M),(E===null||E.length<T)&&(E=new Float32Array(T));for(let R=0,N=_;R!==b;++R,N+=4)a.copy(p[R]).applyMatrix4(M,o),a.normal.toArray(E,N),E[N+3]=a.constant}l.value=E,l.needsUpdate=!0}return e.numPlanes=b,e.numIntersection=0,E}}function Bte(r){let e=new WeakMap;function t(a,o){return o===Lh?a.mapping=ol:o===ym&&(a.mapping=oc),a}function n(a){if(a&&a.isTexture){const o=a.mapping;if(o===Lh||o===ym)if(e.has(a)){const l=e.get(a).texture;return t(l,a.mapping)}else{const l=a.image;if(l&&l.height>0){const c=new k1(l.height);return c.fromEquirectangularTexture(r,a),e.set(a,c),a.addEventListener("dispose",i),t(c.texture,a.mapping)}else return null}}return a}function i(a){const o=a.target;o.removeEventListener("dispose",i);const l=e.get(o);l!==void 0&&(e.delete(o),l.dispose())}function s(){e=new WeakMap}return{get:n,dispose:s}}const im=4,Xz=[.125,.215,.35,.446,.526,.582],u0=20,Ite=256,zS=new rc,$z=new Kt;let g3=null,y3=0,_3=0,v3=!1;const Fte=new ne;let yO=class{constructor(e){this._renderer=e,this._pingPongRenderTarget=null,this._lodMax=0,this._cubeSize=0,this._sizeLods=[],this._sigmas=[],this._lodMeshes=[],this._backgroundBox=null,this._cubemapMaterial=null,this._equirectMaterial=null,this._blurMaterial=null,this._ggxMaterial=null}fromScene(e,t=0,n=.1,i=100,s={}){const{size:a=256,position:o=Fte}=s;g3=this._renderer.getRenderTarget(),y3=this._renderer.getActiveCubeFace(),_3=this._renderer.getActiveMipmapLevel(),v3=this._renderer.xr.enabled,this._renderer.xr.enabled=!1,this._setSize(a);const l=this._allocateTargets();return l.depthBuffer=!0,this._sceneToCubeUV(e,n,i,l,o),t>0&&this._blur(l,0,0,t),this._applyPMREM(l),this._cleanup(l),l}fromEquirectangular(e,t=null){return this._fromTexture(e,t)}fromCubemap(e,t=null){return this._fromTexture(e,t)}compileCubemapShader(){this._cubemapMaterial===null&&(this._cubemapMaterial=Zz(),this._compileMaterial(this._cubemapMaterial))}compileEquirectangularShader(){this._equirectMaterial===null&&(this._equirectMaterial=Yz(),this._compileMaterial(this._equirectMaterial))}dispose(){this._dispose(),this._cubemapMaterial!==null&&this._cubemapMaterial.dispose(),this._equirectMaterial!==null&&this._equirectMaterial.dispose(),this._backgroundBox!==null&&(this._backgroundBox.geometry.dispose(),this._backgroundBox.material.dispose())}_setSize(e){this._lodMax=Math.floor(Math.log2(e)),this._cubeSize=Math.pow(2,this._lodMax)}_dispose(){this._blurMaterial!==null&&this._blurMaterial.dispose(),this._ggxMaterial!==null&&this._ggxMaterial.dispose(),this._pingPongRenderTarget!==null&&this._pingPongRenderTarget.dispose();for(let e=0;e<this._lodMeshes.length;e++)this._lodMeshes[e].geometry.dispose()}_cleanup(e){this._renderer.setRenderTarget(g3,y3,_3),this._renderer.xr.enabled=v3,e.scissorTest=!1,cv(e,0,0,e.width,e.height)}_fromTexture(e,t){e.mapping===ol||e.mapping===oc?this._setSize(e.image.length===0?16:e.image[0].width||e.image[0].image.width):this._setSize(e.image.width/4),g3=this._renderer.getRenderTarget(),y3=this._renderer.getActiveCubeFace(),_3=this._renderer.getActiveMipmapLevel(),v3=this._renderer.xr.enabled,this._renderer.xr.enabled=!1;const n=t||this._allocateTargets();return this._textureToCubeUV(e,n),this._applyPMREM(n),this._cleanup(n),n}_allocateTargets(){const e=3*Math.max(this._cubeSize,112),t=4*this._cubeSize,n={magFilter:ei,minFilter:ei,generateMipmaps:!1,type:vi,format:Qi,colorSpace:vu,depthBuffer:!1},i=jz(e,t,n);if(this._pingPongRenderTarget===null||this._pingPongRenderTarget.width!==e||this._pingPongRenderTarget.height!==t){this._pingPongRenderTarget!==null&&this._dispose(),this._pingPongRenderTarget=jz(e,t,n);const{_lodMax:s}=this;({lodMeshes:this._lodMeshes,sizeLods:this._sizeLods,sigmas:this._sigmas}=zte(s)),this._blurMaterial=Gte(s,e,t),this._ggxMaterial=Vte(s,e,t)}return i}_compileMaterial(e){const t=new ar(new Qn,e);this._renderer.compile(t,zS)}_sceneToCubeUV(e,t,n,i,s){const l=new Br(90,1,t,n),c=[1,-1,1,1,1,1],d=[1,1,1,-1,-1,-1],p=this._renderer,y=p.autoClear,_=p.toneMapping;p.getClearColor($z),p.toneMapping=ta,p.autoClear=!1,p.state.buffers.depth.getReversed()&&(p.setRenderTarget(i),p.clearDepth(),p.setRenderTarget(null)),this._backgroundBox===null&&(this._backgroundBox=new ar(new Xh,new lo({name:"PMREM.Background",side:gr,depthWrite:!1,depthTest:!1})));const b=this._backgroundBox,E=b.material;let T=!1;const M=e.background;M?M.isColor&&(E.color.copy(M),e.background=null,T=!0):(E.color.copy($z),T=!0);for(let R=0;R<6;R++){const N=R%3;N===0?(l.up.set(0,c[R],0),l.position.set(s.x,s.y,s.z),l.lookAt(s.x+d[R],s.y,s.z)):N===1?(l.up.set(0,0,c[R]),l.position.set(s.x,s.y,s.z),l.lookAt(s.x,s.y+d[R],s.z)):(l.up.set(0,c[R],0),l.position.set(s.x,s.y,s.z),l.lookAt(s.x,s.y,s.z+d[R]));const P=this._cubeSize;cv(i,N*P,R>2?P:0,P,P),p.setRenderTarget(i),T&&p.render(b,l),p.render(e,l)}p.toneMapping=_,p.autoClear=y,e.background=M}_textureToCubeUV(e,t){const n=this._renderer,i=e.mapping===ol||e.mapping===oc;i?(this._cubemapMaterial===null&&(this._cubemapMaterial=Zz()),this._cubemapMaterial.uniforms.flipEnvMap.value=e.isRenderTargetTexture===!1?-1:1):this._equirectMaterial===null&&(this._equirectMaterial=Yz());const s=i?this._cubemapMaterial:this._equirectMaterial,a=this._lodMeshes[0];a.material=s;const o=s.uniforms;o.envMap.value=e;const l=this._cubeSize;cv(t,0,0,3*l,2*l),n.setRenderTarget(t),n.render(a,zS)}_applyPMREM(e){const t=this._renderer,n=t.autoClear;t.autoClear=!1;const i=this._lodMeshes.length;for(let s=1;s<i;s++)this._applyGGXFilter(e,s-1,s);t.autoClear=n}_applyGGXFilter(e,t,n){const i=this._renderer,s=this._pingPongRenderTarget,a=this._ggxMaterial,o=this._lodMeshes[n];o.material=a;const l=a.uniforms,c=n/(this._lodMeshes.length-1),d=t/(this._lodMeshes.length-1),p=Math.sqrt(c*c-d*d),y=0+c*1.25,_=p*y,{_lodMax:v}=this,b=this._sizeLods[n],E=3*b*(n>v-im?n-v+im:0),T=4*(this._cubeSize-b);l.envMap.value=e.texture,l.roughness.value=_,l.mipInt.value=v-t,cv(s,E,T,3*b,2*b),i.setRenderTarget(s),i.render(o,zS),l.envMap.value=s.texture,l.roughness.value=0,l.mipInt.value=v-n,cv(e,E,T,3*b,2*b),i.setRenderTarget(e),i.render(o,zS)}_blur(e,t,n,i,s){const a=this._pingPongRenderTarget;this._halfBlur(e,a,t,n,i,"latitudinal",s),this._halfBlur(a,e,n,n,i,"longitudinal",s)}_halfBlur(e,t,n,i,s,a,o){const l=this._renderer,c=this._blurMaterial;a!=="latitudinal"&&a!=="longitudinal"&&Ze("blur direction must be either latitudinal or longitudinal!");const d=3,p=this._lodMeshes[i];p.material=c;const y=c.uniforms,_=this._sizeLods[n]-1,v=isFinite(s)?Math.PI/(2*_):2*Math.PI/(2*u0-1),b=s/v,E=isFinite(s)?1+Math.floor(d*b):u0;E>u0&&Ve(`sigmaRadians, ${s}, is too large and will clip, as it requested ${E} samples when the maximum is set to ${u0}`);const T=[];let M=0;for(let L=0;L<u0;++L){const F=L/b,O=Math.exp(-F*F/2);T.push(O),L===0?M+=O:L<E&&(M+=2*O)}for(let L=0;L<T.length;L++)T[L]=T[L]/M;y.envMap.value=e.texture,y.samples.value=E,y.weights.value=T,y.latitudinal.value=a==="latitudinal",o&&(y.poleAxis.value=o);const{_lodMax:R}=this;y.dTheta.value=v,y.mipInt.value=R-n;const N=this._sizeLods[i],P=3*N*(i>R-im?i-R+im:0),U=4*(this._cubeSize-N);cv(t,P,U,3*N,2*N),l.setRenderTarget(t),l.render(p,zS)}};function zte(r){const e=[],t=[],n=[];let i=r;const s=r-im+1+Xz.length;for(let a=0;a<s;a++){const o=Math.pow(2,i);e.push(o);let l=1/o;a>r-im?l=Xz[a-r+im-1]:a===0&&(l=0),t.push(l);const c=1/(o-2),d=-c,p=1+c,y=[d,d,p,d,p,p,d,d,p,p,d,p],_=6,v=6,b=3,E=2,T=1,M=new Float32Array(b*v*_),R=new Float32Array(E*v*_),N=new Float32Array(T*v*_);for(let U=0;U<_;U++){const L=U%3*2/3-1,F=U>2?0:-1,O=[L,F,0,L+2/3,F,0,L+2/3,F+1,0,L,F,0,L+2/3,F+1,0,L,F+1,0];M.set(O,b*v*U),R.set(y,E*v*U);const B=[U,U,U,U,U,U];N.set(B,T*v*U)}const P=new Qn;P.setAttribute("position",new Ji(M,b)),P.setAttribute("uv",new Ji(R,E)),P.setAttribute("faceIndex",new Ji(N,T)),n.push(new ar(P,null)),i>im&&i--}return{lodMeshes:n,sizeLods:e,sigmas:t}}function jz(r,e,t){const n=new sl(r,e,t);return n.texture.mapping=Ph,n.texture.name="PMREM.cubeUv",n.scissorTest=!0,n}function cv(r,e,t,n,i){r.viewport.set(e,t,n,i),r.scissor.set(e,t,n,i)}function Vte(r,e,t){return new ul({name:"PMREMGGXConvolution",defines:{GGX_SAMPLES:Ite,CUBEUV_TEXEL_WIDTH:1/e,CUBEUV_TEXEL_HEIGHT:1/t,CUBEUV_MAX_MIP:`${r}.0`},uniforms:{envMap:{value:null},roughness:{value:0},mipInt:{value:0}},vertexShader:$C(),fragmentShader:`

			precision highp float;
			precision highp int;

			varying vec3 vOutputDirection;

			uniform sampler2D envMap;
			uniform float roughness;
			uniform float mipInt;

			#define ENVMAP_TYPE_CUBE_UV
			#include <cube_uv_reflection_fragment>

			#define PI 3.14159265359

			// Van der Corput radical inverse
			float radicalInverse_VdC(uint bits) {
				bits = (bits << 16u) | (bits >> 16u);
				bits = ((bits & 0x55555555u) << 1u) | ((bits & 0xAAAAAAAAu) >> 1u);
				bits = ((bits & 0x33333333u) << 2u) | ((bits & 0xCCCCCCCCu) >> 2u);
				bits = ((bits & 0x0F0F0F0Fu) << 4u) | ((bits & 0xF0F0F0F0u) >> 4u);
				bits = ((bits & 0x00FF00FFu) << 8u) | ((bits & 0xFF00FF00u) >> 8u);
				return float(bits) * 2.3283064365386963e-10; // / 0x100000000
			}

			// Hammersley sequence
			vec2 hammersley(uint i, uint N) {
				return vec2(float(i) / float(N), radicalInverse_VdC(i));
			}

			// GGX VNDF importance sampling (Eric Heitz 2018)
			// "Sampling the GGX Distribution of Visible Normals"
			// https://jcgt.org/published/0007/04/01/
			vec3 importanceSampleGGX_VNDF(vec2 Xi, vec3 V, float roughness) {
				float alpha = roughness * roughness;

				// Section 3.2: Transform view direction to hemisphere configuration
				vec3 Vh = normalize(vec3(alpha * V.x, alpha * V.y, V.z));

				// Section 4.1: Orthonormal basis
				float lensq = Vh.x * Vh.x + Vh.y * Vh.y;
				vec3 T1 = lensq > 0.0 ? vec3(-Vh.y, Vh.x, 0.0) / sqrt(lensq) : vec3(1.0, 0.0, 0.0);
				vec3 T2 = cross(Vh, T1);

				// Section 4.2: Parameterization of projected area
				float r = sqrt(Xi.x);
				float phi = 2.0 * PI * Xi.y;
				float t1 = r * cos(phi);
				float t2 = r * sin(phi);
				float s = 0.5 * (1.0 + Vh.z);
				t2 = (1.0 - s) * sqrt(1.0 - t1 * t1) + s * t2;

				// Section 4.3: Reprojection onto hemisphere
				vec3 Nh = t1 * T1 + t2 * T2 + sqrt(max(0.0, 1.0 - t1 * t1 - t2 * t2)) * Vh;

				// Section 3.4: Transform back to ellipsoid configuration
				return normalize(vec3(alpha * Nh.x, alpha * Nh.y, max(0.0, Nh.z)));
			}

			void main() {
				vec3 N = normalize(vOutputDirection);
				vec3 V = N; // Assume view direction equals normal for pre-filtering

				vec3 prefilteredColor = vec3(0.0);
				float totalWeight = 0.0;

				// For very low roughness, just sample the environment directly
				if (roughness < 0.001) {
					gl_FragColor = vec4(bilinearCubeUV(envMap, N, mipInt), 1.0);
					return;
				}

				// Tangent space basis for VNDF sampling
				vec3 up = abs(N.z) < 0.999 ? vec3(0.0, 0.0, 1.0) : vec3(1.0, 0.0, 0.0);
				vec3 tangent = normalize(cross(up, N));
				vec3 bitangent = cross(N, tangent);

				for(uint i = 0u; i < uint(GGX_SAMPLES); i++) {
					vec2 Xi = hammersley(i, uint(GGX_SAMPLES));

					// For PMREM, V = N, so in tangent space V is always (0, 0, 1)
					vec3 H_tangent = importanceSampleGGX_VNDF(Xi, vec3(0.0, 0.0, 1.0), roughness);

					// Transform H back to world space
					vec3 H = normalize(tangent * H_tangent.x + bitangent * H_tangent.y + N * H_tangent.z);
					vec3 L = normalize(2.0 * dot(V, H) * H - V);

					float NdotL = max(dot(N, L), 0.0);

					if(NdotL > 0.0) {
						// Sample environment at fixed mip level
						// VNDF importance sampling handles the distribution filtering
						vec3 sampleColor = bilinearCubeUV(envMap, L, mipInt);

						// Weight by NdotL for the split-sum approximation
						// VNDF PDF naturally accounts for the visible microfacet distribution
						prefilteredColor += sampleColor * NdotL;
						totalWeight += NdotL;
					}
				}

				if (totalWeight > 0.0) {
					prefilteredColor = prefilteredColor / totalWeight;
				}

				gl_FragColor = vec4(prefilteredColor, 1.0);
			}
		`,blending:yo,depthTest:!1,depthWrite:!1})}function Gte(r,e,t){const n=new Float32Array(u0),i=new ne(0,1,0);return new ul({name:"SphericalGaussianBlur",defines:{n:u0,CUBEUV_TEXEL_WIDTH:1/e,CUBEUV_TEXEL_HEIGHT:1/t,CUBEUV_MAX_MIP:`${r}.0`},uniforms:{envMap:{value:null},samples:{value:1},weights:{value:n},latitudinal:{value:!1},dTheta:{value:0},mipInt:{value:0},poleAxis:{value:i}},vertexShader:$C(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			varying vec3 vOutputDirection;

			uniform sampler2D envMap;
			uniform int samples;
			uniform float weights[ n ];
			uniform bool latitudinal;
			uniform float dTheta;
			uniform float mipInt;
			uniform vec3 poleAxis;

			#define ENVMAP_TYPE_CUBE_UV
			#include <cube_uv_reflection_fragment>

			vec3 getSample( float theta, vec3 axis ) {

				float cosTheta = cos( theta );
				// Rodrigues' axis-angle rotation
				vec3 sampleDirection = vOutputDirection * cosTheta
					+ cross( axis, vOutputDirection ) * sin( theta )
					+ axis * dot( axis, vOutputDirection ) * ( 1.0 - cosTheta );

				return bilinearCubeUV( envMap, sampleDirection, mipInt );

			}

			void main() {

				vec3 axis = latitudinal ? poleAxis : cross( poleAxis, vOutputDirection );

				if ( all( equal( axis, vec3( 0.0 ) ) ) ) {

					axis = vec3( vOutputDirection.z, 0.0, - vOutputDirection.x );

				}

				axis = normalize( axis );

				gl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );
				gl_FragColor.rgb += weights[ 0 ] * getSample( 0.0, axis );

				for ( int i = 1; i < n; i++ ) {

					if ( i >= samples ) {

						break;

					}

					float theta = dTheta * float( i );
					gl_FragColor.rgb += weights[ i ] * getSample( -1.0 * theta, axis );
					gl_FragColor.rgb += weights[ i ] * getSample( theta, axis );

				}

			}
		`,blending:yo,depthTest:!1,depthWrite:!1})}function Yz(){return new ul({name:"EquirectangularToCubeUV",uniforms:{envMap:{value:null}},vertexShader:$C(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			varying vec3 vOutputDirection;

			uniform sampler2D envMap;

			#include <common>

			void main() {

				vec3 outputDirection = normalize( vOutputDirection );
				vec2 uv = equirectUv( outputDirection );

				gl_FragColor = vec4( texture2D ( envMap, uv ).rgb, 1.0 );

			}
		`,blending:yo,depthTest:!1,depthWrite:!1})}function Zz(){return new ul({name:"CubemapToCubeUV",uniforms:{envMap:{value:null},flipEnvMap:{value:-1}},vertexShader:$C(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			uniform float flipEnvMap;

			varying vec3 vOutputDirection;

			uniform samplerCube envMap;

			void main() {

				gl_FragColor = textureCube( envMap, vec3( flipEnvMap * vOutputDirection.x, vOutputDirection.yz ) );

			}
		`,blending:yo,depthTest:!1,depthWrite:!1})}function $C(){return`

		precision mediump float;
		precision mediump int;

		attribute float faceIndex;

		varying vec3 vOutputDirection;

		// RH coordinate system; PMREM face-indexing convention
		vec3 getDirection( vec2 uv, float face ) {

			uv = 2.0 * uv - 1.0;

			vec3 direction = vec3( uv, 1.0 );

			if ( face == 0.0 ) {

				direction = direction.zyx; // ( 1, v, u ) pos x

			} else if ( face == 1.0 ) {

				direction = direction.xzy;
				direction.xz *= -1.0; // ( -u, 1, -v ) pos y

			} else if ( face == 2.0 ) {

				direction.x *= -1.0; // ( -u, v, 1 ) pos z

			} else if ( face == 3.0 ) {

				direction = direction.zyx;
				direction.xz *= -1.0; // ( -1, v, -u ) neg x

			} else if ( face == 4.0 ) {

				direction = direction.xzy;
				direction.xy *= -1.0; // ( -u, -1, v ) neg y

			} else if ( face == 5.0 ) {

				direction.z *= -1.0; // ( u, v, -1 ) neg z

			}

			return direction;

		}

		void main() {

			vOutputDirection = getDirection( uv, faceIndex );
			gl_Position = vec4( position, 1.0 );

		}
	`}function kte(r){let e=new WeakMap,t=null;function n(o){if(o&&o.isTexture){const l=o.mapping,c=l===Lh||l===ym,d=l===ol||l===oc;if(c||d){let p=e.get(o);const y=p!==void 0?p.texture.pmremVersion:0;if(o.isRenderTargetTexture&&o.pmremVersion!==y)return t===null&&(t=new yO(r)),p=c?t.fromEquirectangular(o,p):t.fromCubemap(o,p),p.texture.pmremVersion=o.pmremVersion,e.set(o,p),p.texture;if(p!==void 0)return p.texture;{const _=o.image;return c&&_&&_.height>0||d&&_&&i(_)?(t===null&&(t=new yO(r)),p=c?t.fromEquirectangular(o):t.fromCubemap(o),p.texture.pmremVersion=o.pmremVersion,e.set(o,p),o.addEventListener("dispose",s),p.texture):null}}}return o}function i(o){let l=0;const c=6;for(let d=0;d<c;d++)o[d]!==void 0&&l++;return l===c}function s(o){const l=o.target;l.removeEventListener("dispose",s);const c=e.get(l);c!==void 0&&(e.delete(l),c.dispose())}function a(){e=new WeakMap,t!==null&&(t.dispose(),t=null)}return{get:n,dispose:a}}function Hte(r){const e={};function t(n){if(e[n]!==void 0)return e[n];const i=r.getExtension(n);return e[n]=i,i}return{has:function(n){return t(n)!==null},init:function(){t("EXT_color_buffer_float"),t("WEBGL_clip_cull_distance"),t("OES_texture_float_linear"),t("EXT_color_buffer_half_float"),t("WEBGL_multisampled_render_to_texture"),t("WEBGL_render_shared_exponent")},get:function(n){const i=t(n);return i===null&&cr("WebGLRenderer: "+n+" extension not supported."),i}}}function Wte(r,e,t,n){const i={},s=new WeakMap;function a(p){const y=p.target;y.index!==null&&e.remove(y.index);for(const v in y.attributes)e.remove(y.attributes[v]);y.removeEventListener("dispose",a),delete i[y.id];const _=s.get(y);_&&(e.remove(_),s.delete(y)),n.releaseStatesOfGeometry(y),y.isInstancedBufferGeometry===!0&&delete y._maxInstanceCount,t.memory.geometries--}function o(p,y){return i[y.id]===!0||(y.addEventListener("dispose",a),i[y.id]=!0,t.memory.geometries++),y}function l(p){const y=p.attributes;for(const _ in y)e.update(y[_],r.ARRAY_BUFFER)}function c(p){const y=[],_=p.index,v=p.attributes.position;let b=0;if(_!==null){const M=_.array;b=_.version;for(let R=0,N=M.length;R<N;R+=3){const P=M[R+0],U=M[R+1],L=M[R+2];y.push(P,U,U,L,L,P)}}else if(v!==void 0){const M=v.array;b=v.version;for(let R=0,N=M.length/3-1;R<N;R+=3){const P=R+0,U=R+1,L=R+2;y.push(P,U,U,L,L,P)}}else return;const E=new(rL(y)?EC:TC)(y,1);E.version=b;const T=s.get(p);T&&e.remove(T),s.set(p,E)}function d(p){const y=s.get(p);if(y){const _=p.index;_!==null&&y.version<_.version&&c(p)}else c(p);return s.get(p)}return{get:o,update:l,getWireframeAttribute:d}}function qte(r,e,t){let n;function i(y){n=y}let s,a;function o(y){s=y.type,a=y.bytesPerElement}function l(y,_){r.drawElements(n,_,s,y*a),t.update(_,n,1)}function c(y,_,v){v!==0&&(r.drawElementsInstanced(n,_,s,y*a,v),t.update(_,n,v))}function d(y,_,v){if(v===0)return;e.get("WEBGL_multi_draw").multiDrawElementsWEBGL(n,_,0,s,y,0,v);let E=0;for(let T=0;T<v;T++)E+=_[T];t.update(E,n,1)}function p(y,_,v,b){if(v===0)return;const E=e.get("WEBGL_multi_draw");if(E===null)for(let T=0;T<y.length;T++)c(y[T]/a,_[T],b[T]);else{E.multiDrawElementsInstancedWEBGL(n,_,0,s,y,0,b,0,v);let T=0;for(let M=0;M<v;M++)T+=_[M]*b[M];t.update(T,n,1)}}this.setMode=i,this.setIndex=o,this.render=l,this.renderInstances=c,this.renderMultiDraw=d,this.renderMultiDrawInstances=p}function Xte(r){const e={geometries:0,textures:0},t={frame:0,calls:0,triangles:0,points:0,lines:0};function n(s,a,o){switch(t.calls++,a){case r.TRIANGLES:t.triangles+=o*(s/3);break;case r.LINES:t.lines+=o*(s/2);break;case r.LINE_STRIP:t.lines+=o*(s-1);break;case r.LINE_LOOP:t.lines+=o*s;break;case r.POINTS:t.points+=o*s;break;default:Ze("WebGLInfo: Unknown draw mode:",a);break}}function i(){t.calls=0,t.triangles=0,t.points=0,t.lines=0}return{memory:e,render:t,programs:null,autoReset:!0,reset:i,update:n}}function $te(r,e,t){const n=new WeakMap,i=new zn;function s(a,o,l){const c=a.morphTargetInfluences,d=o.morphAttributes.position||o.morphAttributes.normal||o.morphAttributes.color,p=d!==void 0?d.length:0;let y=n.get(o);if(y===void 0||y.count!==p){let B=function(){F.dispose(),n.delete(o),o.removeEventListener("dispose",B)};var _=B;y!==void 0&&y.texture.dispose();const v=o.morphAttributes.position!==void 0,b=o.morphAttributes.normal!==void 0,E=o.morphAttributes.color!==void 0,T=o.morphAttributes.position||[],M=o.morphAttributes.normal||[],R=o.morphAttributes.color||[];let N=0;v===!0&&(N=1),b===!0&&(N=2),E===!0&&(N=3);let P=o.attributes.position.count*N,U=1;P>e.maxTextureSize&&(U=Math.ceil(P/e.maxTextureSize),P=e.maxTextureSize);const L=new Float32Array(P*U*4*p),F=new V1(L,P,U,p);F.type=Ci,F.needsUpdate=!0;const O=N*4;for(let q=0;q<p;q++){const j=T[q],Q=M[q],se=R[q],ae=P*U*4*q;for(let V=0;V<j.count;V++){const X=V*O;v===!0&&(i.fromBufferAttribute(j,V),L[ae+X+0]=i.x,L[ae+X+1]=i.y,L[ae+X+2]=i.z,L[ae+X+3]=0),b===!0&&(i.fromBufferAttribute(Q,V),L[ae+X+4]=i.x,L[ae+X+5]=i.y,L[ae+X+6]=i.z,L[ae+X+7]=0),E===!0&&(i.fromBufferAttribute(se,V),L[ae+X+8]=i.x,L[ae+X+9]=i.y,L[ae+X+10]=i.z,L[ae+X+11]=se.itemSize===4?i.w:1)}}y={count:p,texture:F,size:new tt(P,U)},n.set(o,y),o.addEventListener("dispose",B)}if(a.isInstancedMesh===!0&&a.morphTexture!==null)l.getUniforms().setValue(r,"morphTexture",a.morphTexture,t);else{let v=0;for(let E=0;E<c.length;E++)v+=c[E];const b=o.morphTargetsRelative?1:1-v;l.getUniforms().setValue(r,"morphTargetBaseInfluence",b),l.getUniforms().setValue(r,"morphTargetInfluences",c)}l.getUniforms().setValue(r,"morphTargetsTexture",y.texture,t),l.getUniforms().setValue(r,"morphTargetsTextureSize",y.size)}return{update:s}}function jte(r,e,t,n){let i=new WeakMap;function s(l){const c=n.render.frame,d=l.geometry,p=e.get(l,d);if(i.get(p)!==c&&(e.update(p),i.set(p,c)),l.isInstancedMesh&&(l.hasEventListener("dispose",o)===!1&&l.addEventListener("dispose",o),i.get(l)!==c&&(t.update(l.instanceMatrix,r.ARRAY_BUFFER),l.instanceColor!==null&&t.update(l.instanceColor,r.ARRAY_BUFFER),i.set(l,c))),l.isSkinnedMesh){const y=l.skeleton;i.get(y)!==c&&(y.update(),i.set(y,c))}return p}function a(){i=new WeakMap}function o(l){const c=l.target;c.removeEventListener("dispose",o),t.remove(c.instanceMatrix),c.instanceColor!==null&&t.remove(c.instanceColor)}return{update:s,dispose:a}}const Yte={[cC]:"LINEAR_TONE_MAPPING",[fC]:"REINHARD_TONE_MAPPING",[dC]:"CINEON_TONE_MAPPING",[L1]:"ACES_FILMIC_TONE_MAPPING",[hC]:"AGX_TONE_MAPPING",[pC]:"NEUTRAL_TONE_MAPPING",[eL]:"CUSTOM_TONE_MAPPING"};function Zte(r,e,t,n,i){const s=new sl(e,t,{type:r,depthBuffer:n,stencilBuffer:i}),a=new sl(e,t,{type:vi,depthBuffer:!1,stencilBuffer:!1}),o=new Qn;o.setAttribute("position",new hn([-1,3,0,-1,-1,0,3,-1,0],3)),o.setAttribute("uv",new hn([0,2,0,0,2,0],2));const l=new xL({uniforms:{tDiffuse:{value:null}},vertexShader:`
			precision highp float;

			uniform mat4 modelViewMatrix;
			uniform mat4 projectionMatrix;

			attribute vec3 position;
			attribute vec2 uv;

			varying vec2 vUv;

			void main() {
				vUv = uv;
				gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
			}`,fragmentShader:`
			precision highp float;

			uniform sampler2D tDiffuse;

			varying vec2 vUv;

			#include <tonemapping_pars_fragment>
			#include <colorspace_pars_fragment>

			void main() {
				gl_FragColor = texture2D( tDiffuse, vUv );

				#ifdef LINEAR_TONE_MAPPING
					gl_FragColor.rgb = LinearToneMapping( gl_FragColor.rgb );
				#elif defined( REINHARD_TONE_MAPPING )
					gl_FragColor.rgb = ReinhardToneMapping( gl_FragColor.rgb );
				#elif defined( CINEON_TONE_MAPPING )
					gl_FragColor.rgb = CineonToneMapping( gl_FragColor.rgb );
				#elif defined( ACES_FILMIC_TONE_MAPPING )
					gl_FragColor.rgb = ACESFilmicToneMapping( gl_FragColor.rgb );
				#elif defined( AGX_TONE_MAPPING )
					gl_FragColor.rgb = AgXToneMapping( gl_FragColor.rgb );
				#elif defined( NEUTRAL_TONE_MAPPING )
					gl_FragColor.rgb = NeutralToneMapping( gl_FragColor.rgb );
				#elif defined( CUSTOM_TONE_MAPPING )
					gl_FragColor.rgb = CustomToneMapping( gl_FragColor.rgb );
				#endif

				#ifdef SRGB_TRANSFER
					gl_FragColor = sRGBTransferOETF( gl_FragColor );
				#endif
			}`,depthTest:!1,depthWrite:!1}),c=new ar(o,l),d=new rc(-1,1,1,-1,0,1);let p=null,y=null,_=!1,v,b=null,E=[],T=!1;this.setSize=function(M,R){s.setSize(M,R),a.setSize(M,R);for(let N=0;N<E.length;N++){const P=E[N];P.setSize&&P.setSize(M,R)}},this.setEffects=function(M){E=M,T=E.length>0&&E[0].isRenderPass===!0;const R=s.width,N=s.height;for(let P=0;P<E.length;P++){const U=E[P];U.setSize&&U.setSize(R,N)}},this.begin=function(M,R){if(_||M.toneMapping===ta&&E.length===0)return!1;if(b=R,R!==null){const N=R.width,P=R.height;(s.width!==N||s.height!==P)&&this.setSize(N,P)}return T===!1&&M.setRenderTarget(s),v=M.toneMapping,M.toneMapping=ta,!0},this.hasRenderPass=function(){return T},this.end=function(M,R){M.toneMapping=v,_=!0;let N=s,P=a;for(let U=0;U<E.length;U++){const L=E[U];if(L.enabled!==!1&&(L.render(M,P,N,R),L.needsSwap!==!1)){const F=N;N=P,P=F}}if(p!==M.outputColorSpace||y!==M.toneMapping){p=M.outputColorSpace,y=M.toneMapping,l.defines={},Nn.getTransfer(p)===an&&(l.defines.SRGB_TRANSFER="");const U=Yte[y];U&&(l.defines[U]=""),l.needsUpdate=!0}l.uniforms.tDiffuse.value=N.texture,M.setRenderTarget(b),M.render(c,d),b=null,_=!1},this.isCompositing=function(){return _},this.dispose=function(){s.dispose(),a.dispose(),o.dispose(),l.dispose()}}const U6=new sr,_O=new Ga(1,1),L6=new V1,P6=new SC,B6=new Im,Kz=[],Qz=[],Jz=new Float32Array(16),eV=new Float32Array(9),tV=new Float32Array(4);function Wx(r,e,t){const n=r[0];if(n<=0||n>0)return r;const i=e*t;let s=Kz[i];if(s===void 0&&(s=new Float32Array(i),Kz[i]=s),e!==0){n.toArray(s,0);for(let a=1,o=0;a!==e;++a)o+=t,r[a].toArray(s,o)}return s}function na(r,e){if(r.length!==e.length)return!1;for(let t=0,n=r.length;t<n;t++)if(r[t]!==e[t])return!1;return!0}function ia(r,e){for(let t=0,n=e.length;t<n;t++)r[t]=e[t]}function jC(r,e){let t=Qz[e];t===void 0&&(t=new Int32Array(e),Qz[e]=t);for(let n=0;n!==e;++n)t[n]=r.allocateTextureUnit();return t}function Kte(r,e){const t=this.cache;t[0]!==e&&(r.uniform1f(this.addr,e),t[0]=e)}function Qte(r,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y)&&(r.uniform2f(this.addr,e.x,e.y),t[0]=e.x,t[1]=e.y);else{if(na(t,e))return;r.uniform2fv(this.addr,e),ia(t,e)}}function Jte(r,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z)&&(r.uniform3f(this.addr,e.x,e.y,e.z),t[0]=e.x,t[1]=e.y,t[2]=e.z);else if(e.r!==void 0)(t[0]!==e.r||t[1]!==e.g||t[2]!==e.b)&&(r.uniform3f(this.addr,e.r,e.g,e.b),t[0]=e.r,t[1]=e.g,t[2]=e.b);else{if(na(t,e))return;r.uniform3fv(this.addr,e),ia(t,e)}}function ene(r,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z||t[3]!==e.w)&&(r.uniform4f(this.addr,e.x,e.y,e.z,e.w),t[0]=e.x,t[1]=e.y,t[2]=e.z,t[3]=e.w);else{if(na(t,e))return;r.uniform4fv(this.addr,e),ia(t,e)}}function tne(r,e){const t=this.cache,n=e.elements;if(n===void 0){if(na(t,e))return;r.uniformMatrix2fv(this.addr,!1,e),ia(t,e)}else{if(na(t,n))return;tV.set(n),r.uniformMatrix2fv(this.addr,!1,tV),ia(t,n)}}function nne(r,e){const t=this.cache,n=e.elements;if(n===void 0){if(na(t,e))return;r.uniformMatrix3fv(this.addr,!1,e),ia(t,e)}else{if(na(t,n))return;eV.set(n),r.uniformMatrix3fv(this.addr,!1,eV),ia(t,n)}}function ine(r,e){const t=this.cache,n=e.elements;if(n===void 0){if(na(t,e))return;r.uniformMatrix4fv(this.addr,!1,e),ia(t,e)}else{if(na(t,n))return;Jz.set(n),r.uniformMatrix4fv(this.addr,!1,Jz),ia(t,n)}}function rne(r,e){const t=this.cache;t[0]!==e&&(r.uniform1i(this.addr,e),t[0]=e)}function sne(r,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y)&&(r.uniform2i(this.addr,e.x,e.y),t[0]=e.x,t[1]=e.y);else{if(na(t,e))return;r.uniform2iv(this.addr,e),ia(t,e)}}function ane(r,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z)&&(r.uniform3i(this.addr,e.x,e.y,e.z),t[0]=e.x,t[1]=e.y,t[2]=e.z);else{if(na(t,e))return;r.uniform3iv(this.addr,e),ia(t,e)}}function one(r,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z||t[3]!==e.w)&&(r.uniform4i(this.addr,e.x,e.y,e.z,e.w),t[0]=e.x,t[1]=e.y,t[2]=e.z,t[3]=e.w);else{if(na(t,e))return;r.uniform4iv(this.addr,e),ia(t,e)}}function lne(r,e){const t=this.cache;t[0]!==e&&(r.uniform1ui(this.addr,e),t[0]=e)}function une(r,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y)&&(r.uniform2ui(this.addr,e.x,e.y),t[0]=e.x,t[1]=e.y);else{if(na(t,e))return;r.uniform2uiv(this.addr,e),ia(t,e)}}function cne(r,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z)&&(r.uniform3ui(this.addr,e.x,e.y,e.z),t[0]=e.x,t[1]=e.y,t[2]=e.z);else{if(na(t,e))return;r.uniform3uiv(this.addr,e),ia(t,e)}}function fne(r,e){const t=this.cache;if(e.x!==void 0)(t[0]!==e.x||t[1]!==e.y||t[2]!==e.z||t[3]!==e.w)&&(r.uniform4ui(this.addr,e.x,e.y,e.z,e.w),t[0]=e.x,t[1]=e.y,t[2]=e.z,t[3]=e.w);else{if(na(t,e))return;r.uniform4uiv(this.addr,e),ia(t,e)}}function dne(r,e,t){const n=this.cache,i=t.allocateTextureUnit();n[0]!==i&&(r.uniform1i(this.addr,i),n[0]=i);let s;this.type===r.SAMPLER_2D_SHADOW?(_O.compareFunction=t.isReversedDepthBuffer()?Gx:Vx,s=_O):s=U6,t.setTexture2D(e||s,i)}function hne(r,e,t){const n=this.cache,i=t.allocateTextureUnit();n[0]!==i&&(r.uniform1i(this.addr,i),n[0]=i),t.setTexture3D(e||P6,i)}function pne(r,e,t){const n=this.cache,i=t.allocateTextureUnit();n[0]!==i&&(r.uniform1i(this.addr,i),n[0]=i),t.setTextureCube(e||B6,i)}function mne(r,e,t){const n=this.cache,i=t.allocateTextureUnit();n[0]!==i&&(r.uniform1i(this.addr,i),n[0]=i),t.setTexture2DArray(e||L6,i)}function gne(r){switch(r){case 5126:return Kte;case 35664:return Qte;case 35665:return Jte;case 35666:return ene;case 35674:return tne;case 35675:return nne;case 35676:return ine;case 5124:case 35670:return rne;case 35667:case 35671:return sne;case 35668:case 35672:return ane;case 35669:case 35673:return one;case 5125:return lne;case 36294:return une;case 36295:return cne;case 36296:return fne;case 35678:case 36198:case 36298:case 36306:case 35682:return dne;case 35679:case 36299:case 36307:return hne;case 35680:case 36300:case 36308:case 36293:return pne;case 36289:case 36303:case 36311:case 36292:return mne}}function yne(r,e){r.uniform1fv(this.addr,e)}function _ne(r,e){const t=Wx(e,this.size,2);r.uniform2fv(this.addr,t)}function vne(r,e){const t=Wx(e,this.size,3);r.uniform3fv(this.addr,t)}function xne(r,e){const t=Wx(e,this.size,4);r.uniform4fv(this.addr,t)}function bne(r,e){const t=Wx(e,this.size,4);r.uniformMatrix2fv(this.addr,!1,t)}function Sne(r,e){const t=Wx(e,this.size,9);r.uniformMatrix3fv(this.addr,!1,t)}function Tne(r,e){const t=Wx(e,this.size,16);r.uniformMatrix4fv(this.addr,!1,t)}function Ene(r,e){r.uniform1iv(this.addr,e)}function Mne(r,e){r.uniform2iv(this.addr,e)}function Ane(r,e){r.uniform3iv(this.addr,e)}function wne(r,e){r.uniform4iv(this.addr,e)}function Rne(r,e){r.uniform1uiv(this.addr,e)}function Cne(r,e){r.uniform2uiv(this.addr,e)}function Nne(r,e){r.uniform3uiv(this.addr,e)}function Dne(r,e){r.uniform4uiv(this.addr,e)}function One(r,e,t){const n=this.cache,i=e.length,s=jC(t,i);na(n,s)||(r.uniform1iv(this.addr,s),ia(n,s));let a;this.type===r.SAMPLER_2D_SHADOW?a=_O:a=U6;for(let o=0;o!==i;++o)t.setTexture2D(e[o]||a,s[o])}function Une(r,e,t){const n=this.cache,i=e.length,s=jC(t,i);na(n,s)||(r.uniform1iv(this.addr,s),ia(n,s));for(let a=0;a!==i;++a)t.setTexture3D(e[a]||P6,s[a])}function Lne(r,e,t){const n=this.cache,i=e.length,s=jC(t,i);na(n,s)||(r.uniform1iv(this.addr,s),ia(n,s));for(let a=0;a!==i;++a)t.setTextureCube(e[a]||B6,s[a])}function Pne(r,e,t){const n=this.cache,i=e.length,s=jC(t,i);na(n,s)||(r.uniform1iv(this.addr,s),ia(n,s));for(let a=0;a!==i;++a)t.setTexture2DArray(e[a]||L6,s[a])}function Bne(r){switch(r){case 5126:return yne;case 35664:return _ne;case 35665:return vne;case 35666:return xne;case 35674:return bne;case 35675:return Sne;case 35676:return Tne;case 5124:case 35670:return Ene;case 35667:case 35671:return Mne;case 35668:case 35672:return Ane;case 35669:case 35673:return wne;case 5125:return Rne;case 36294:return Cne;case 36295:return Nne;case 36296:return Dne;case 35678:case 36198:case 36298:case 36306:case 35682:return One;case 35679:case 36299:case 36307:return Une;case 35680:case 36300:case 36308:case 36293:return Lne;case 36289:case 36303:case 36311:case 36292:return Pne}}class Ine{constructor(e,t,n){this.id=e,this.addr=n,this.cache=[],this.type=t.type,this.setValue=gne(t.type)}}class Fne{constructor(e,t,n){this.id=e,this.addr=n,this.cache=[],this.type=t.type,this.size=t.size,this.setValue=Bne(t.type)}}class zne{constructor(e){this.id=e,this.seq=[],this.map={}}setValue(e,t,n){const i=this.seq;for(let s=0,a=i.length;s!==a;++s){const o=i[s];o.setValue(e,t[o.id],n)}}}const x3=/(\w+)(\])?(\[|\.)?/g;function nV(r,e){r.seq.push(e),r.map[e.id]=e}function Vne(r,e,t){const n=r.name,i=n.length;for(x3.lastIndex=0;;){const s=x3.exec(n),a=x3.lastIndex;let o=s[1];const l=s[2]==="]",c=s[3];if(l&&(o=o|0),c===void 0||c==="["&&a+2===i){nV(t,c===void 0?new Ine(o,r,e):new Fne(o,r,e));break}else{let p=t.map[o];p===void 0&&(p=new zne(o),nV(t,p)),t=p}}}class Aw{constructor(e,t){this.seq=[],this.map={};const n=e.getProgramParameter(t,e.ACTIVE_UNIFORMS);for(let a=0;a<n;++a){const o=e.getActiveUniform(t,a),l=e.getUniformLocation(t,o.name);Vne(o,l,this)}const i=[],s=[];for(const a of this.seq)a.type===e.SAMPLER_2D_SHADOW||a.type===e.SAMPLER_CUBE_SHADOW||a.type===e.SAMPLER_2D_ARRAY_SHADOW?i.push(a):s.push(a);i.length>0&&(this.seq=i.concat(s))}setValue(e,t,n,i){const s=this.map[t];s!==void 0&&s.setValue(e,n,i)}setOptional(e,t,n){const i=t[n];i!==void 0&&this.setValue(e,n,i)}static upload(e,t,n,i){for(let s=0,a=t.length;s!==a;++s){const o=t[s],l=n[o.id];l.needsUpdate!==!1&&o.setValue(e,l.value,i)}}static seqWithValue(e,t){const n=[];for(let i=0,s=e.length;i!==s;++i){const a=e[i];a.id in t&&n.push(a)}return n}}function iV(r,e,t){const n=r.createShader(e);return r.shaderSource(n,t),r.compileShader(n),n}const Gne=37297;let kne=0;function Hne(r,e){const t=r.split(`
`),n=[],i=Math.max(e-6,0),s=Math.min(e+6,t.length);for(let a=i;a<s;a++){const o=a+1;n.push(`${o===e?">":" "} ${o}: ${t[a]}`)}return n.join(`
`)}const rV=new Zn;function Wne(r){Nn._getMatrix(rV,Nn.workingColorSpace,r);const e=`mat3( ${rV.elements.map(t=>t.toFixed(4))} )`;switch(Nn.getTransfer(r)){case hy:return[e,"LinearTransferOETF"];case an:return[e,"sRGBTransferOETF"];default:return Ve("WebGLProgram: Unsupported color space: ",r),[e,"LinearTransferOETF"]}}function sV(r,e,t){const n=r.getShaderParameter(e,r.COMPILE_STATUS),s=(r.getShaderInfoLog(e)||"").trim();if(n&&s==="")return"";const a=/ERROR: 0:(\d+)/.exec(s);if(a){const o=parseInt(a[1]);return t.toUpperCase()+`

`+s+`

`+Hne(r.getShaderSource(e),o)}else return s}function qne(r,e){const t=Wne(e);return[`vec4 ${r}( vec4 value ) {`,`	return ${t[1]}( vec4( value.rgb * ${t[0]}, value.a ) );`,"}"].join(`
`)}const Xne={[cC]:"Linear",[fC]:"Reinhard",[dC]:"Cineon",[L1]:"ACESFilmic",[hC]:"AgX",[pC]:"Neutral",[eL]:"Custom"};function $ne(r,e){const t=Xne[e];return t===void 0?(Ve("WebGLProgram: Unsupported toneMapping:",e),"vec3 "+r+"( vec3 color ) { return LinearToneMapping( color ); }"):"vec3 "+r+"( vec3 color ) { return "+t+"ToneMapping( color ); }"}const RA=new ne;function jne(){Nn.getLuminanceCoefficients(RA);const r=RA.x.toFixed(4),e=RA.y.toFixed(4),t=RA.z.toFixed(4);return["float luminance( const in vec3 rgb ) {",`	const vec3 weights = vec3( ${r}, ${e}, ${t} );`,"	return dot( weights, rgb );","}"].join(`
`)}function Yne(r){return[r.extensionClipCullDistance?"#extension GL_ANGLE_clip_cull_distance : require":"",r.extensionMultiDraw?"#extension GL_ANGLE_multi_draw : require":""].filter(hT).join(`
`)}function Zne(r){const e=[];for(const t in r){const n=r[t];n!==!1&&e.push("#define "+t+" "+n)}return e.join(`
`)}function Kne(r,e){const t={},n=r.getProgramParameter(e,r.ACTIVE_ATTRIBUTES);for(let i=0;i<n;i++){const s=r.getActiveAttrib(e,i),a=s.name;let o=1;s.type===r.FLOAT_MAT2&&(o=2),s.type===r.FLOAT_MAT3&&(o=3),s.type===r.FLOAT_MAT4&&(o=4),t[a]={type:s.type,location:r.getAttribLocation(e,a),locationSize:o}}return t}function hT(r){return r!==""}function aV(r,e){const t=e.numSpotLightShadows+e.numSpotLightMaps-e.numSpotLightShadowsWithMaps;return r.replace(/NUM_DIR_LIGHTS/g,e.numDirLights).replace(/NUM_SPOT_LIGHTS/g,e.numSpotLights).replace(/NUM_SPOT_LIGHT_MAPS/g,e.numSpotLightMaps).replace(/NUM_SPOT_LIGHT_COORDS/g,t).replace(/NUM_RECT_AREA_LIGHTS/g,e.numRectAreaLights).replace(/NUM_POINT_LIGHTS/g,e.numPointLights).replace(/NUM_HEMI_LIGHTS/g,e.numHemiLights).replace(/NUM_DIR_LIGHT_SHADOWS/g,e.numDirLightShadows).replace(/NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS/g,e.numSpotLightShadowsWithMaps).replace(/NUM_SPOT_LIGHT_SHADOWS/g,e.numSpotLightShadows).replace(/NUM_POINT_LIGHT_SHADOWS/g,e.numPointLightShadows)}function oV(r,e){return r.replace(/NUM_CLIPPING_PLANES/g,e.numClippingPlanes).replace(/UNION_CLIPPING_PLANES/g,e.numClippingPlanes-e.numClipIntersection)}const Qne=/^[ \t]*#include +<([\w\d./]+)>/gm;function vO(r){return r.replace(Qne,eie)}const Jne=new Map;function eie(r,e){let t=ui[e];if(t===void 0){const n=Jne.get(e);if(n!==void 0)t=ui[n],Ve('WebGLRenderer: Shader chunk "%s" has been deprecated. Use "%s" instead.',e,n);else throw new Error("Can not resolve #include <"+e+">")}return vO(t)}const tie=/#pragma unroll_loop_start\s+for\s*\(\s*int\s+i\s*=\s*(\d+)\s*;\s*i\s*<\s*(\d+)\s*;\s*i\s*\+\+\s*\)\s*{([\s\S]+?)}\s+#pragma unroll_loop_end/g;function lV(r){return r.replace(tie,nie)}function nie(r,e,t,n){let i="";for(let s=parseInt(e);s<parseInt(t);s++)i+=n.replace(/\[\s*i\s*\]/g,"[ "+s+" ]").replace(/UNROLLED_LOOP_INDEX/g,s);return i}function uV(r){let e=`precision ${r.precision} float;
	precision ${r.precision} int;
	precision ${r.precision} sampler2D;
	precision ${r.precision} samplerCube;
	precision ${r.precision} sampler3D;
	precision ${r.precision} sampler2DArray;
	precision ${r.precision} sampler2DShadow;
	precision ${r.precision} samplerCubeShadow;
	precision ${r.precision} sampler2DArrayShadow;
	precision ${r.precision} isampler2D;
	precision ${r.precision} isampler3D;
	precision ${r.precision} isamplerCube;
	precision ${r.precision} isampler2DArray;
	precision ${r.precision} usampler2D;
	precision ${r.precision} usampler3D;
	precision ${r.precision} usamplerCube;
	precision ${r.precision} usampler2DArray;
	`;return r.precision==="highp"?e+=`
#define HIGH_PRECISION`:r.precision==="mediump"?e+=`
#define MEDIUM_PRECISION`:r.precision==="lowp"&&(e+=`
#define LOW_PRECISION`),e}const iie={[M0]:"SHADOWMAP_TYPE_PCF",[$c]:"SHADOWMAP_TYPE_VSM"};function rie(r){return iie[r.shadowMapType]||"SHADOWMAP_TYPE_BASIC"}const sie={[ol]:"ENVMAP_TYPE_CUBE",[oc]:"ENVMAP_TYPE_CUBE",[Ph]:"ENVMAP_TYPE_CUBE_UV"};function aie(r){return r.envMap===!1?"ENVMAP_TYPE_CUBE":sie[r.envMapMode]||"ENVMAP_TYPE_CUBE"}const oie={[oc]:"ENVMAP_MODE_REFRACTION"};function lie(r){return r.envMap===!1?"ENVMAP_MODE_REFLECTION":oie[r.envMapMode]||"ENVMAP_MODE_REFLECTION"}const uie={[Ix]:"ENVMAP_BLENDING_MULTIPLY",[QU]:"ENVMAP_BLENDING_MIX",[JU]:"ENVMAP_BLENDING_ADD"};function cie(r){return r.envMap===!1?"ENVMAP_BLENDING_NONE":uie[r.combine]||"ENVMAP_BLENDING_NONE"}function fie(r){const e=r.envMapCubeUVHeight;if(e===null)return null;const t=Math.log2(e)-2,n=1/e;return{texelWidth:1/(3*Math.max(Math.pow(2,t),112)),texelHeight:n,maxMip:t}}function die(r,e,t,n){const i=r.getContext(),s=t.defines;let a=t.vertexShader,o=t.fragmentShader;const l=rie(t),c=aie(t),d=lie(t),p=cie(t),y=fie(t),_=Yne(t),v=Zne(s),b=i.createProgram();let E,T,M=t.glslVersion?"#version "+t.glslVersion+`
`:"";t.isRawShaderMaterial?(E=["#define SHADER_TYPE "+t.shaderType,"#define SHADER_NAME "+t.shaderName,v].filter(hT).join(`
`),E.length>0&&(E+=`
`),T=["#define SHADER_TYPE "+t.shaderType,"#define SHADER_NAME "+t.shaderName,v].filter(hT).join(`
`),T.length>0&&(T+=`
`)):(E=[uV(t),"#define SHADER_TYPE "+t.shaderType,"#define SHADER_NAME "+t.shaderName,v,t.extensionClipCullDistance?"#define USE_CLIP_DISTANCE":"",t.batching?"#define USE_BATCHING":"",t.batchingColor?"#define USE_BATCHING_COLOR":"",t.instancing?"#define USE_INSTANCING":"",t.instancingColor?"#define USE_INSTANCING_COLOR":"",t.instancingMorph?"#define USE_INSTANCING_MORPH":"",t.useFog&&t.fog?"#define USE_FOG":"",t.useFog&&t.fogExp2?"#define FOG_EXP2":"",t.map?"#define USE_MAP":"",t.envMap?"#define USE_ENVMAP":"",t.envMap?"#define "+d:"",t.lightMap?"#define USE_LIGHTMAP":"",t.aoMap?"#define USE_AOMAP":"",t.bumpMap?"#define USE_BUMPMAP":"",t.normalMap?"#define USE_NORMALMAP":"",t.normalMapObjectSpace?"#define USE_NORMALMAP_OBJECTSPACE":"",t.normalMapTangentSpace?"#define USE_NORMALMAP_TANGENTSPACE":"",t.displacementMap?"#define USE_DISPLACEMENTMAP":"",t.emissiveMap?"#define USE_EMISSIVEMAP":"",t.anisotropy?"#define USE_ANISOTROPY":"",t.anisotropyMap?"#define USE_ANISOTROPYMAP":"",t.clearcoatMap?"#define USE_CLEARCOATMAP":"",t.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",t.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",t.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",t.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",t.specularMap?"#define USE_SPECULARMAP":"",t.specularColorMap?"#define USE_SPECULAR_COLORMAP":"",t.specularIntensityMap?"#define USE_SPECULAR_INTENSITYMAP":"",t.roughnessMap?"#define USE_ROUGHNESSMAP":"",t.metalnessMap?"#define USE_METALNESSMAP":"",t.alphaMap?"#define USE_ALPHAMAP":"",t.alphaHash?"#define USE_ALPHAHASH":"",t.transmission?"#define USE_TRANSMISSION":"",t.transmissionMap?"#define USE_TRANSMISSIONMAP":"",t.thicknessMap?"#define USE_THICKNESSMAP":"",t.sheenColorMap?"#define USE_SHEEN_COLORMAP":"",t.sheenRoughnessMap?"#define USE_SHEEN_ROUGHNESSMAP":"",t.mapUv?"#define MAP_UV "+t.mapUv:"",t.alphaMapUv?"#define ALPHAMAP_UV "+t.alphaMapUv:"",t.lightMapUv?"#define LIGHTMAP_UV "+t.lightMapUv:"",t.aoMapUv?"#define AOMAP_UV "+t.aoMapUv:"",t.emissiveMapUv?"#define EMISSIVEMAP_UV "+t.emissiveMapUv:"",t.bumpMapUv?"#define BUMPMAP_UV "+t.bumpMapUv:"",t.normalMapUv?"#define NORMALMAP_UV "+t.normalMapUv:"",t.displacementMapUv?"#define DISPLACEMENTMAP_UV "+t.displacementMapUv:"",t.metalnessMapUv?"#define METALNESSMAP_UV "+t.metalnessMapUv:"",t.roughnessMapUv?"#define ROUGHNESSMAP_UV "+t.roughnessMapUv:"",t.anisotropyMapUv?"#define ANISOTROPYMAP_UV "+t.anisotropyMapUv:"",t.clearcoatMapUv?"#define CLEARCOATMAP_UV "+t.clearcoatMapUv:"",t.clearcoatNormalMapUv?"#define CLEARCOAT_NORMALMAP_UV "+t.clearcoatNormalMapUv:"",t.clearcoatRoughnessMapUv?"#define CLEARCOAT_ROUGHNESSMAP_UV "+t.clearcoatRoughnessMapUv:"",t.iridescenceMapUv?"#define IRIDESCENCEMAP_UV "+t.iridescenceMapUv:"",t.iridescenceThicknessMapUv?"#define IRIDESCENCE_THICKNESSMAP_UV "+t.iridescenceThicknessMapUv:"",t.sheenColorMapUv?"#define SHEEN_COLORMAP_UV "+t.sheenColorMapUv:"",t.sheenRoughnessMapUv?"#define SHEEN_ROUGHNESSMAP_UV "+t.sheenRoughnessMapUv:"",t.specularMapUv?"#define SPECULARMAP_UV "+t.specularMapUv:"",t.specularColorMapUv?"#define SPECULAR_COLORMAP_UV "+t.specularColorMapUv:"",t.specularIntensityMapUv?"#define SPECULAR_INTENSITYMAP_UV "+t.specularIntensityMapUv:"",t.transmissionMapUv?"#define TRANSMISSIONMAP_UV "+t.transmissionMapUv:"",t.thicknessMapUv?"#define THICKNESSMAP_UV "+t.thicknessMapUv:"",t.vertexTangents&&t.flatShading===!1?"#define USE_TANGENT":"",t.vertexColors?"#define USE_COLOR":"",t.vertexAlphas?"#define USE_COLOR_ALPHA":"",t.vertexUv1s?"#define USE_UV1":"",t.vertexUv2s?"#define USE_UV2":"",t.vertexUv3s?"#define USE_UV3":"",t.pointsUvs?"#define USE_POINTS_UV":"",t.flatShading?"#define FLAT_SHADED":"",t.skinning?"#define USE_SKINNING":"",t.morphTargets?"#define USE_MORPHTARGETS":"",t.morphNormals&&t.flatShading===!1?"#define USE_MORPHNORMALS":"",t.morphColors?"#define USE_MORPHCOLORS":"",t.morphTargetsCount>0?"#define MORPHTARGETS_TEXTURE_STRIDE "+t.morphTextureStride:"",t.morphTargetsCount>0?"#define MORPHTARGETS_COUNT "+t.morphTargetsCount:"",t.doubleSided?"#define DOUBLE_SIDED":"",t.flipSided?"#define FLIP_SIDED":"",t.shadowMapEnabled?"#define USE_SHADOWMAP":"",t.shadowMapEnabled?"#define "+l:"",t.sizeAttenuation?"#define USE_SIZEATTENUATION":"",t.numLightProbes>0?"#define USE_LIGHT_PROBES":"",t.logarithmicDepthBuffer?"#define USE_LOGARITHMIC_DEPTH_BUFFER":"",t.reversedDepthBuffer?"#define USE_REVERSED_DEPTH_BUFFER":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;","#ifdef USE_INSTANCING","	attribute mat4 instanceMatrix;","#endif","#ifdef USE_INSTANCING_COLOR","	attribute vec3 instanceColor;","#endif","#ifdef USE_INSTANCING_MORPH","	uniform sampler2D morphTexture;","#endif","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_UV1","	attribute vec2 uv1;","#endif","#ifdef USE_UV2","	attribute vec2 uv2;","#endif","#ifdef USE_UV3","	attribute vec2 uv3;","#endif","#ifdef USE_TANGENT","	attribute vec4 tangent;","#endif","#if defined( USE_COLOR_ALPHA )","	attribute vec4 color;","#elif defined( USE_COLOR )","	attribute vec3 color;","#endif","#ifdef USE_SKINNING","	attribute vec4 skinIndex;","	attribute vec4 skinWeight;","#endif",`
`].filter(hT).join(`
`),T=[uV(t),"#define SHADER_TYPE "+t.shaderType,"#define SHADER_NAME "+t.shaderName,v,t.useFog&&t.fog?"#define USE_FOG":"",t.useFog&&t.fogExp2?"#define FOG_EXP2":"",t.alphaToCoverage?"#define ALPHA_TO_COVERAGE":"",t.map?"#define USE_MAP":"",t.matcap?"#define USE_MATCAP":"",t.envMap?"#define USE_ENVMAP":"",t.envMap?"#define "+c:"",t.envMap?"#define "+d:"",t.envMap?"#define "+p:"",y?"#define CUBEUV_TEXEL_WIDTH "+y.texelWidth:"",y?"#define CUBEUV_TEXEL_HEIGHT "+y.texelHeight:"",y?"#define CUBEUV_MAX_MIP "+y.maxMip+".0":"",t.lightMap?"#define USE_LIGHTMAP":"",t.aoMap?"#define USE_AOMAP":"",t.bumpMap?"#define USE_BUMPMAP":"",t.normalMap?"#define USE_NORMALMAP":"",t.normalMapObjectSpace?"#define USE_NORMALMAP_OBJECTSPACE":"",t.normalMapTangentSpace?"#define USE_NORMALMAP_TANGENTSPACE":"",t.emissiveMap?"#define USE_EMISSIVEMAP":"",t.anisotropy?"#define USE_ANISOTROPY":"",t.anisotropyMap?"#define USE_ANISOTROPYMAP":"",t.clearcoat?"#define USE_CLEARCOAT":"",t.clearcoatMap?"#define USE_CLEARCOATMAP":"",t.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",t.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",t.dispersion?"#define USE_DISPERSION":"",t.iridescence?"#define USE_IRIDESCENCE":"",t.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",t.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",t.specularMap?"#define USE_SPECULARMAP":"",t.specularColorMap?"#define USE_SPECULAR_COLORMAP":"",t.specularIntensityMap?"#define USE_SPECULAR_INTENSITYMAP":"",t.roughnessMap?"#define USE_ROUGHNESSMAP":"",t.metalnessMap?"#define USE_METALNESSMAP":"",t.alphaMap?"#define USE_ALPHAMAP":"",t.alphaTest?"#define USE_ALPHATEST":"",t.alphaHash?"#define USE_ALPHAHASH":"",t.sheen?"#define USE_SHEEN":"",t.sheenColorMap?"#define USE_SHEEN_COLORMAP":"",t.sheenRoughnessMap?"#define USE_SHEEN_ROUGHNESSMAP":"",t.transmission?"#define USE_TRANSMISSION":"",t.transmissionMap?"#define USE_TRANSMISSIONMAP":"",t.thicknessMap?"#define USE_THICKNESSMAP":"",t.vertexTangents&&t.flatShading===!1?"#define USE_TANGENT":"",t.vertexColors||t.instancingColor||t.batchingColor?"#define USE_COLOR":"",t.vertexAlphas?"#define USE_COLOR_ALPHA":"",t.vertexUv1s?"#define USE_UV1":"",t.vertexUv2s?"#define USE_UV2":"",t.vertexUv3s?"#define USE_UV3":"",t.pointsUvs?"#define USE_POINTS_UV":"",t.gradientMap?"#define USE_GRADIENTMAP":"",t.flatShading?"#define FLAT_SHADED":"",t.doubleSided?"#define DOUBLE_SIDED":"",t.flipSided?"#define FLIP_SIDED":"",t.shadowMapEnabled?"#define USE_SHADOWMAP":"",t.shadowMapEnabled?"#define "+l:"",t.premultipliedAlpha?"#define PREMULTIPLIED_ALPHA":"",t.numLightProbes>0?"#define USE_LIGHT_PROBES":"",t.decodeVideoTexture?"#define DECODE_VIDEO_TEXTURE":"",t.decodeVideoTextureEmissive?"#define DECODE_VIDEO_TEXTURE_EMISSIVE":"",t.logarithmicDepthBuffer?"#define USE_LOGARITHMIC_DEPTH_BUFFER":"",t.reversedDepthBuffer?"#define USE_REVERSED_DEPTH_BUFFER":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;",t.toneMapping!==ta?"#define TONE_MAPPING":"",t.toneMapping!==ta?ui.tonemapping_pars_fragment:"",t.toneMapping!==ta?$ne("toneMapping",t.toneMapping):"",t.dithering?"#define DITHERING":"",t.opaque?"#define OPAQUE":"",ui.colorspace_pars_fragment,qne("linearToOutputTexel",t.outputColorSpace),jne(),t.useDepthPacking?"#define DEPTH_PACKING "+t.depthPacking:"",`
`].filter(hT).join(`
`)),a=vO(a),a=aV(a,t),a=oV(a,t),o=vO(o),o=aV(o,t),o=oV(o,t),a=lV(a),o=lV(o),t.isRawShaderMaterial!==!0&&(M=`#version 300 es
`,E=[_,"#define attribute in","#define varying out","#define texture2D texture"].join(`
`)+`
`+E,T=["#define varying in",t.glslVersion===uO?"":"layout(location = 0) out highp vec4 pc_fragColor;",t.glslVersion===uO?"":"#define gl_FragColor pc_fragColor","#define gl_FragDepthEXT gl_FragDepth","#define texture2D texture","#define textureCube texture","#define texture2DProj textureProj","#define texture2DLodEXT textureLod","#define texture2DProjLodEXT textureProjLod","#define textureCubeLodEXT textureLod","#define texture2DGradEXT textureGrad","#define texture2DProjGradEXT textureProjGrad","#define textureCubeGradEXT textureGrad"].join(`
`)+`
`+T);const R=M+E+a,N=M+T+o,P=iV(i,i.VERTEX_SHADER,R),U=iV(i,i.FRAGMENT_SHADER,N);i.attachShader(b,P),i.attachShader(b,U),t.index0AttributeName!==void 0?i.bindAttribLocation(b,0,t.index0AttributeName):t.morphTargets===!0&&i.bindAttribLocation(b,0,"position"),i.linkProgram(b);function L(q){if(r.debug.checkShaderErrors){const j=i.getProgramInfoLog(b)||"",Q=i.getShaderInfoLog(P)||"",se=i.getShaderInfoLog(U)||"",ae=j.trim(),V=Q.trim(),X=se.trim();let ee=!0,fe=!0;if(i.getProgramParameter(b,i.LINK_STATUS)===!1)if(ee=!1,typeof r.debug.onShaderError=="function")r.debug.onShaderError(i,b,P,U);else{const Y=sV(i,P,"vertex"),K=sV(i,U,"fragment");Ze("THREE.WebGLProgram: Shader Error "+i.getError()+" - VALIDATE_STATUS "+i.getProgramParameter(b,i.VALIDATE_STATUS)+`

Material Name: `+q.name+`
Material Type: `+q.type+`

Program Info Log: `+ae+`
`+Y+`
`+K)}else ae!==""?Ve("WebGLProgram: Program Info Log:",ae):(V===""||X==="")&&(fe=!1);fe&&(q.diagnostics={runnable:ee,programLog:ae,vertexShader:{log:V,prefix:E},fragmentShader:{log:X,prefix:T}})}i.deleteShader(P),i.deleteShader(U),F=new Aw(i,b),O=Kne(i,b)}let F;this.getUniforms=function(){return F===void 0&&L(this),F};let O;this.getAttributes=function(){return O===void 0&&L(this),O};let B=t.rendererExtensionParallelShaderCompile===!1;return this.isReady=function(){return B===!1&&(B=i.getProgramParameter(b,Gne)),B},this.destroy=function(){n.releaseStatesOfProgram(this),i.deleteProgram(b),this.program=void 0},this.type=t.shaderType,this.name=t.shaderName,this.id=kne++,this.cacheKey=e,this.usedTimes=1,this.program=b,this.vertexShader=P,this.fragmentShader=U,this}let hie=0;class pie{constructor(){this.shaderCache=new Map,this.materialCache=new Map}update(e){const t=e.vertexShader,n=e.fragmentShader,i=this._getShaderStage(t),s=this._getShaderStage(n),a=this._getShaderCacheForMaterial(e);return a.has(i)===!1&&(a.add(i),i.usedTimes++),a.has(s)===!1&&(a.add(s),s.usedTimes++),this}remove(e){const t=this.materialCache.get(e);for(const n of t)n.usedTimes--,n.usedTimes===0&&this.shaderCache.delete(n.code);return this.materialCache.delete(e),this}getVertexShaderID(e){return this._getShaderStage(e.vertexShader).id}getFragmentShaderID(e){return this._getShaderStage(e.fragmentShader).id}dispose(){this.shaderCache.clear(),this.materialCache.clear()}_getShaderCacheForMaterial(e){const t=this.materialCache;let n=t.get(e);return n===void 0&&(n=new Set,t.set(e,n)),n}_getShaderStage(e){const t=this.shaderCache;let n=t.get(e);return n===void 0&&(n=new mie(e),t.set(e,n)),n}}class mie{constructor(e){this.id=hie++,this.code=e,this.usedTimes=0}}function gie(r,e,t,n,i,s,a){const o=new yx,l=new pie,c=new Set,d=[],p=new Map,y=i.logarithmicDepthBuffer;let _=i.precision;const v={MeshDepthMaterial:"depth",MeshDistanceMaterial:"distance",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshToonMaterial:"toon",MeshStandardMaterial:"physical",MeshPhysicalMaterial:"physical",MeshMatcapMaterial:"matcap",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points",ShadowMaterial:"shadow",SpriteMaterial:"sprite"};function b(O){return c.add(O),O===0?"uv":`uv${O}`}function E(O,B,q,j,Q){const se=j.fog,ae=Q.geometry,V=O.isMeshStandardMaterial?j.environment:null,X=(O.isMeshStandardMaterial?t:e).get(O.envMap||V),ee=X&&X.mapping===Ph?X.image.height:null,fe=v[O.type];O.precision!==null&&(_=i.getMaxPrecision(O.precision),_!==O.precision&&Ve("WebGLProgram.getParameters:",O.precision,"not supported, using",_,"instead."));const Y=ae.morphAttributes.position||ae.morphAttributes.normal||ae.morphAttributes.color,K=Y!==void 0?Y.length:0;let he=0;ae.morphAttributes.position!==void 0&&(he=1),ae.morphAttributes.normal!==void 0&&(he=2),ae.morphAttributes.color!==void 0&&(he=3);let Ce,Ie,ut,Ee;if(fe){const qt=Wc[fe];Ce=qt.vertexShader,Ie=qt.fragmentShader}else Ce=O.vertexShader,Ie=O.fragmentShader,l.update(O),ut=l.getVertexShaderID(O),Ee=l.getFragmentShaderID(O);const Ne=r.getRenderTarget(),rt=r.state.buffers.depth.getReversed(),Nt=Q.isInstancedMesh===!0,Ft=Q.isBatchedMesh===!0,fn=!!O.map,Sn=!!O.matcap,At=!!X,qe=!!O.aoMap,at=!!O.lightMap,Je=!!O.bumpMap,xe=!!O.normalMap,oe=!!O.displacementMap,Qt=!!O.emissiveMap,Dt=!!O.metalnessMap,zt=!!O.roughnessMap,wt=O.anisotropy>0,Z=O.clearcoat>0,k=O.dispersion>0,pe=O.iridescence>0,Fe=O.sheen>0,He=O.transmission>0,ze=wt&&!!O.anisotropyMap,Bt=Z&&!!O.clearcoatMap,Ct=Z&&!!O.clearcoatNormalMap,Yt=Z&&!!O.clearcoatRoughnessMap,$t=pe&&!!O.iridescenceMap,st=pe&&!!O.iridescenceThicknessMap,nt=Fe&&!!O.sheenColorMap,Pt=Fe&&!!O.sheenRoughnessMap,ue=!!O.specularMap,Re=!!O.specularColorMap,dt=!!O.specularIntensityMap,le=He&&!!O.transmissionMap,Be=He&&!!O.thicknessMap,lt=!!O.gradientMap,Ot=!!O.alphaMap,ht=O.alphaTest>0,it=!!O.alphaHash,Tt=!!O.extensions;let ln=ta;O.toneMapped&&(Ne===null||Ne.isXRRenderTarget===!0)&&(ln=r.toneMapping);const jn={shaderID:fe,shaderType:O.type,shaderName:O.name,vertexShader:Ce,fragmentShader:Ie,defines:O.defines,customVertexShaderID:ut,customFragmentShaderID:Ee,isRawShaderMaterial:O.isRawShaderMaterial===!0,glslVersion:O.glslVersion,precision:_,batching:Ft,batchingColor:Ft&&Q._colorsTexture!==null,instancing:Nt,instancingColor:Nt&&Q.instanceColor!==null,instancingMorph:Nt&&Q.morphTexture!==null,outputColorSpace:Ne===null?r.outputColorSpace:Ne.isXRRenderTarget===!0?Ne.texture.colorSpace:vu,alphaToCoverage:!!O.alphaToCoverage,map:fn,matcap:Sn,envMap:At,envMapMode:At&&X.mapping,envMapCubeUVHeight:ee,aoMap:qe,lightMap:at,bumpMap:Je,normalMap:xe,displacementMap:oe,emissiveMap:Qt,normalMapObjectSpace:xe&&O.normalMapType===nL,normalMapTangentSpace:xe&&O.normalMapType===Kc,metalnessMap:Dt,roughnessMap:zt,anisotropy:wt,anisotropyMap:ze,clearcoat:Z,clearcoatMap:Bt,clearcoatNormalMap:Ct,clearcoatRoughnessMap:Yt,dispersion:k,iridescence:pe,iridescenceMap:$t,iridescenceThicknessMap:st,sheen:Fe,sheenColorMap:nt,sheenRoughnessMap:Pt,specularMap:ue,specularColorMap:Re,specularIntensityMap:dt,transmission:He,transmissionMap:le,thicknessMap:Be,gradientMap:lt,opaque:O.transparent===!1&&O.blending===Nl&&O.alphaToCoverage===!1,alphaMap:Ot,alphaTest:ht,alphaHash:it,combine:O.combine,mapUv:fn&&b(O.map.channel),aoMapUv:qe&&b(O.aoMap.channel),lightMapUv:at&&b(O.lightMap.channel),bumpMapUv:Je&&b(O.bumpMap.channel),normalMapUv:xe&&b(O.normalMap.channel),displacementMapUv:oe&&b(O.displacementMap.channel),emissiveMapUv:Qt&&b(O.emissiveMap.channel),metalnessMapUv:Dt&&b(O.metalnessMap.channel),roughnessMapUv:zt&&b(O.roughnessMap.channel),anisotropyMapUv:ze&&b(O.anisotropyMap.channel),clearcoatMapUv:Bt&&b(O.clearcoatMap.channel),clearcoatNormalMapUv:Ct&&b(O.clearcoatNormalMap.channel),clearcoatRoughnessMapUv:Yt&&b(O.clearcoatRoughnessMap.channel),iridescenceMapUv:$t&&b(O.iridescenceMap.channel),iridescenceThicknessMapUv:st&&b(O.iridescenceThicknessMap.channel),sheenColorMapUv:nt&&b(O.sheenColorMap.channel),sheenRoughnessMapUv:Pt&&b(O.sheenRoughnessMap.channel),specularMapUv:ue&&b(O.specularMap.channel),specularColorMapUv:Re&&b(O.specularColorMap.channel),specularIntensityMapUv:dt&&b(O.specularIntensityMap.channel),transmissionMapUv:le&&b(O.transmissionMap.channel),thicknessMapUv:Be&&b(O.thicknessMap.channel),alphaMapUv:Ot&&b(O.alphaMap.channel),vertexTangents:!!ae.attributes.tangent&&(xe||wt),vertexColors:O.vertexColors,vertexAlphas:O.vertexColors===!0&&!!ae.attributes.color&&ae.attributes.color.itemSize===4,pointsUvs:Q.isPoints===!0&&!!ae.attributes.uv&&(fn||Ot),fog:!!se,useFog:O.fog===!0,fogExp2:!!se&&se.isFogExp2,flatShading:O.flatShading===!0&&O.wireframe===!1,sizeAttenuation:O.sizeAttenuation===!0,logarithmicDepthBuffer:y,reversedDepthBuffer:rt,skinning:Q.isSkinnedMesh===!0,morphTargets:ae.morphAttributes.position!==void 0,morphNormals:ae.morphAttributes.normal!==void 0,morphColors:ae.morphAttributes.color!==void 0,morphTargetsCount:K,morphTextureStride:he,numDirLights:B.directional.length,numPointLights:B.point.length,numSpotLights:B.spot.length,numSpotLightMaps:B.spotLightMap.length,numRectAreaLights:B.rectArea.length,numHemiLights:B.hemi.length,numDirLightShadows:B.directionalShadowMap.length,numPointLightShadows:B.pointShadowMap.length,numSpotLightShadows:B.spotShadowMap.length,numSpotLightShadowsWithMaps:B.numSpotLightShadowsWithMaps,numLightProbes:B.numLightProbes,numClippingPlanes:a.numPlanes,numClipIntersection:a.numIntersection,dithering:O.dithering,shadowMapEnabled:r.shadowMap.enabled&&q.length>0,shadowMapType:r.shadowMap.type,toneMapping:ln,decodeVideoTexture:fn&&O.map.isVideoTexture===!0&&Nn.getTransfer(O.map.colorSpace)===an,decodeVideoTextureEmissive:Qt&&O.emissiveMap.isVideoTexture===!0&&Nn.getTransfer(O.emissiveMap.colorSpace)===an,premultipliedAlpha:O.premultipliedAlpha,doubleSided:O.side===xa,flipSided:O.side===gr,useDepthPacking:O.depthPacking>=0,depthPacking:O.depthPacking||0,index0AttributeName:O.index0AttributeName,extensionClipCullDistance:Tt&&O.extensions.clipCullDistance===!0&&n.has("WEBGL_clip_cull_distance"),extensionMultiDraw:(Tt&&O.extensions.multiDraw===!0||Ft)&&n.has("WEBGL_multi_draw"),rendererExtensionParallelShaderCompile:n.has("KHR_parallel_shader_compile"),customProgramCacheKey:O.customProgramCacheKey()};return jn.vertexUv1s=c.has(1),jn.vertexUv2s=c.has(2),jn.vertexUv3s=c.has(3),c.clear(),jn}function T(O){const B=[];if(O.shaderID?B.push(O.shaderID):(B.push(O.customVertexShaderID),B.push(O.customFragmentShaderID)),O.defines!==void 0)for(const q in O.defines)B.push(q),B.push(O.defines[q]);return O.isRawShaderMaterial===!1&&(M(B,O),R(B,O),B.push(r.outputColorSpace)),B.push(O.customProgramCacheKey),B.join()}function M(O,B){O.push(B.precision),O.push(B.outputColorSpace),O.push(B.envMapMode),O.push(B.envMapCubeUVHeight),O.push(B.mapUv),O.push(B.alphaMapUv),O.push(B.lightMapUv),O.push(B.aoMapUv),O.push(B.bumpMapUv),O.push(B.normalMapUv),O.push(B.displacementMapUv),O.push(B.emissiveMapUv),O.push(B.metalnessMapUv),O.push(B.roughnessMapUv),O.push(B.anisotropyMapUv),O.push(B.clearcoatMapUv),O.push(B.clearcoatNormalMapUv),O.push(B.clearcoatRoughnessMapUv),O.push(B.iridescenceMapUv),O.push(B.iridescenceThicknessMapUv),O.push(B.sheenColorMapUv),O.push(B.sheenRoughnessMapUv),O.push(B.specularMapUv),O.push(B.specularColorMapUv),O.push(B.specularIntensityMapUv),O.push(B.transmissionMapUv),O.push(B.thicknessMapUv),O.push(B.combine),O.push(B.fogExp2),O.push(B.sizeAttenuation),O.push(B.morphTargetsCount),O.push(B.morphAttributeCount),O.push(B.numDirLights),O.push(B.numPointLights),O.push(B.numSpotLights),O.push(B.numSpotLightMaps),O.push(B.numHemiLights),O.push(B.numRectAreaLights),O.push(B.numDirLightShadows),O.push(B.numPointLightShadows),O.push(B.numSpotLightShadows),O.push(B.numSpotLightShadowsWithMaps),O.push(B.numLightProbes),O.push(B.shadowMapType),O.push(B.toneMapping),O.push(B.numClippingPlanes),O.push(B.numClipIntersection),O.push(B.depthPacking)}function R(O,B){o.disableAll(),B.instancing&&o.enable(0),B.instancingColor&&o.enable(1),B.instancingMorph&&o.enable(2),B.matcap&&o.enable(3),B.envMap&&o.enable(4),B.normalMapObjectSpace&&o.enable(5),B.normalMapTangentSpace&&o.enable(6),B.clearcoat&&o.enable(7),B.iridescence&&o.enable(8),B.alphaTest&&o.enable(9),B.vertexColors&&o.enable(10),B.vertexAlphas&&o.enable(11),B.vertexUv1s&&o.enable(12),B.vertexUv2s&&o.enable(13),B.vertexUv3s&&o.enable(14),B.vertexTangents&&o.enable(15),B.anisotropy&&o.enable(16),B.alphaHash&&o.enable(17),B.batching&&o.enable(18),B.dispersion&&o.enable(19),B.batchingColor&&o.enable(20),B.gradientMap&&o.enable(21),O.push(o.mask),o.disableAll(),B.fog&&o.enable(0),B.useFog&&o.enable(1),B.flatShading&&o.enable(2),B.logarithmicDepthBuffer&&o.enable(3),B.reversedDepthBuffer&&o.enable(4),B.skinning&&o.enable(5),B.morphTargets&&o.enable(6),B.morphNormals&&o.enable(7),B.morphColors&&o.enable(8),B.premultipliedAlpha&&o.enable(9),B.shadowMapEnabled&&o.enable(10),B.doubleSided&&o.enable(11),B.flipSided&&o.enable(12),B.useDepthPacking&&o.enable(13),B.dithering&&o.enable(14),B.transmission&&o.enable(15),B.sheen&&o.enable(16),B.opaque&&o.enable(17),B.pointsUvs&&o.enable(18),B.decodeVideoTexture&&o.enable(19),B.decodeVideoTextureEmissive&&o.enable(20),B.alphaToCoverage&&o.enable(21),O.push(o.mask)}function N(O){const B=v[O.type];let q;if(B){const j=Wc[B];q=Kk.clone(j.uniforms)}else q=O.uniforms;return q}function P(O,B){let q=p.get(B);return q!==void 0?++q.usedTimes:(q=new die(r,B,O,s),d.push(q),p.set(B,q)),q}function U(O){if(--O.usedTimes===0){const B=d.indexOf(O);d[B]=d[d.length-1],d.pop(),p.delete(O.cacheKey),O.destroy()}}function L(O){l.remove(O)}function F(){l.dispose()}return{getParameters:E,getProgramCacheKey:T,getUniforms:N,acquireProgram:P,releaseProgram:U,releaseShaderCache:L,programs:d,dispose:F}}function yie(){let r=new WeakMap;function e(a){return r.has(a)}function t(a){let o=r.get(a);return o===void 0&&(o={},r.set(a,o)),o}function n(a){r.delete(a)}function i(a,o,l){r.get(a)[o]=l}function s(){r=new WeakMap}return{has:e,get:t,remove:n,update:i,dispose:s}}function _ie(r,e){return r.groupOrder!==e.groupOrder?r.groupOrder-e.groupOrder:r.renderOrder!==e.renderOrder?r.renderOrder-e.renderOrder:r.material.id!==e.material.id?r.material.id-e.material.id:r.z!==e.z?r.z-e.z:r.id-e.id}function cV(r,e){return r.groupOrder!==e.groupOrder?r.groupOrder-e.groupOrder:r.renderOrder!==e.renderOrder?r.renderOrder-e.renderOrder:r.z!==e.z?e.z-r.z:r.id-e.id}function fV(){const r=[];let e=0;const t=[],n=[],i=[];function s(){e=0,t.length=0,n.length=0,i.length=0}function a(p,y,_,v,b,E){let T=r[e];return T===void 0?(T={id:p.id,object:p,geometry:y,material:_,groupOrder:v,renderOrder:p.renderOrder,z:b,group:E},r[e]=T):(T.id=p.id,T.object=p,T.geometry=y,T.material=_,T.groupOrder=v,T.renderOrder=p.renderOrder,T.z=b,T.group=E),e++,T}function o(p,y,_,v,b,E){const T=a(p,y,_,v,b,E);_.transmission>0?n.push(T):_.transparent===!0?i.push(T):t.push(T)}function l(p,y,_,v,b,E){const T=a(p,y,_,v,b,E);_.transmission>0?n.unshift(T):_.transparent===!0?i.unshift(T):t.unshift(T)}function c(p,y){t.length>1&&t.sort(p||_ie),n.length>1&&n.sort(y||cV),i.length>1&&i.sort(y||cV)}function d(){for(let p=e,y=r.length;p<y;p++){const _=r[p];if(_.id===null)break;_.id=null,_.object=null,_.geometry=null,_.material=null,_.group=null}}return{opaque:t,transmissive:n,transparent:i,init:s,push:o,unshift:l,finish:d,sort:c}}function vie(){let r=new WeakMap;function e(n,i){const s=r.get(n);let a;return s===void 0?(a=new fV,r.set(n,[a])):i>=s.length?(a=new fV,s.push(a)):a=s[i],a}function t(){r=new WeakMap}return{get:e,dispose:t}}function xie(){const r={};return{get:function(e){if(r[e.id]!==void 0)return r[e.id];let t;switch(e.type){case"DirectionalLight":t={direction:new ne,color:new Kt};break;case"SpotLight":t={position:new ne,direction:new ne,color:new Kt,distance:0,coneCos:0,penumbraCos:0,decay:0};break;case"PointLight":t={position:new ne,color:new Kt,distance:0,decay:0};break;case"HemisphereLight":t={direction:new ne,skyColor:new Kt,groundColor:new Kt};break;case"RectAreaLight":t={color:new Kt,position:new ne,halfWidth:new ne,halfHeight:new ne};break}return r[e.id]=t,t}}}function bie(){const r={};return{get:function(e){if(r[e.id]!==void 0)return r[e.id];let t;switch(e.type){case"DirectionalLight":t={shadowIntensity:1,shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new tt};break;case"SpotLight":t={shadowIntensity:1,shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new tt};break;case"PointLight":t={shadowIntensity:1,shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new tt,shadowCameraNear:1,shadowCameraFar:1e3};break}return r[e.id]=t,t}}}let Sie=0;function Tie(r,e){return(e.castShadow?2:0)-(r.castShadow?2:0)+(e.map?1:0)-(r.map?1:0)}function Eie(r){const e=new xie,t=bie(),n={version:0,hash:{directionalLength:-1,pointLength:-1,spotLength:-1,rectAreaLength:-1,hemiLength:-1,numDirectionalShadows:-1,numPointShadows:-1,numSpotShadows:-1,numSpotMaps:-1,numLightProbes:-1},ambient:[0,0,0],probe:[],directional:[],directionalShadow:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotLightMap:[],spotShadow:[],spotShadowMap:[],spotLightMatrix:[],rectArea:[],rectAreaLTC1:null,rectAreaLTC2:null,point:[],pointShadow:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[],numSpotLightShadowsWithMaps:0,numLightProbes:0};for(let c=0;c<9;c++)n.probe.push(new ne);const i=new ne,s=new gn,a=new gn;function o(c){let d=0,p=0,y=0;for(let O=0;O<9;O++)n.probe[O].set(0,0,0);let _=0,v=0,b=0,E=0,T=0,M=0,R=0,N=0,P=0,U=0,L=0;c.sort(Tie);for(let O=0,B=c.length;O<B;O++){const q=c[O],j=q.color,Q=q.intensity,se=q.distance;let ae=null;if(q.shadow&&q.shadow.map&&(q.shadow.map.texture.format===po?ae=q.shadow.map.texture:ae=q.shadow.map.depthTexture||q.shadow.map.texture),q.isAmbientLight)d+=j.r*Q,p+=j.g*Q,y+=j.b*Q;else if(q.isLightProbe){for(let V=0;V<9;V++)n.probe[V].addScaledVector(q.sh.coefficients[V],Q);L++}else if(q.isDirectionalLight){const V=e.get(q);if(V.color.copy(q.color).multiplyScalar(q.intensity),q.castShadow){const X=q.shadow,ee=t.get(q);ee.shadowIntensity=X.intensity,ee.shadowBias=X.bias,ee.shadowNormalBias=X.normalBias,ee.shadowRadius=X.radius,ee.shadowMapSize=X.mapSize,n.directionalShadow[_]=ee,n.directionalShadowMap[_]=ae,n.directionalShadowMatrix[_]=q.shadow.matrix,M++}n.directional[_]=V,_++}else if(q.isSpotLight){const V=e.get(q);V.position.setFromMatrixPosition(q.matrixWorld),V.color.copy(j).multiplyScalar(Q),V.distance=se,V.coneCos=Math.cos(q.angle),V.penumbraCos=Math.cos(q.angle*(1-q.penumbra)),V.decay=q.decay,n.spot[b]=V;const X=q.shadow;if(q.map&&(n.spotLightMap[P]=q.map,P++,X.updateMatrices(q),q.castShadow&&U++),n.spotLightMatrix[b]=X.matrix,q.castShadow){const ee=t.get(q);ee.shadowIntensity=X.intensity,ee.shadowBias=X.bias,ee.shadowNormalBias=X.normalBias,ee.shadowRadius=X.radius,ee.shadowMapSize=X.mapSize,n.spotShadow[b]=ee,n.spotShadowMap[b]=ae,N++}b++}else if(q.isRectAreaLight){const V=e.get(q);V.color.copy(j).multiplyScalar(Q),V.halfWidth.set(q.width*.5,0,0),V.halfHeight.set(0,q.height*.5,0),n.rectArea[E]=V,E++}else if(q.isPointLight){const V=e.get(q);if(V.color.copy(q.color).multiplyScalar(q.intensity),V.distance=q.distance,V.decay=q.decay,q.castShadow){const X=q.shadow,ee=t.get(q);ee.shadowIntensity=X.intensity,ee.shadowBias=X.bias,ee.shadowNormalBias=X.normalBias,ee.shadowRadius=X.radius,ee.shadowMapSize=X.mapSize,ee.shadowCameraNear=X.camera.near,ee.shadowCameraFar=X.camera.far,n.pointShadow[v]=ee,n.pointShadowMap[v]=ae,n.pointShadowMatrix[v]=q.shadow.matrix,R++}n.point[v]=V,v++}else if(q.isHemisphereLight){const V=e.get(q);V.skyColor.copy(q.color).multiplyScalar(Q),V.groundColor.copy(q.groundColor).multiplyScalar(Q),n.hemi[T]=V,T++}}E>0&&(r.has("OES_texture_float_linear")===!0?(n.rectAreaLTC1=sn.LTC_FLOAT_1,n.rectAreaLTC2=sn.LTC_FLOAT_2):(n.rectAreaLTC1=sn.LTC_HALF_1,n.rectAreaLTC2=sn.LTC_HALF_2)),n.ambient[0]=d,n.ambient[1]=p,n.ambient[2]=y;const F=n.hash;(F.directionalLength!==_||F.pointLength!==v||F.spotLength!==b||F.rectAreaLength!==E||F.hemiLength!==T||F.numDirectionalShadows!==M||F.numPointShadows!==R||F.numSpotShadows!==N||F.numSpotMaps!==P||F.numLightProbes!==L)&&(n.directional.length=_,n.spot.length=b,n.rectArea.length=E,n.point.length=v,n.hemi.length=T,n.directionalShadow.length=M,n.directionalShadowMap.length=M,n.pointShadow.length=R,n.pointShadowMap.length=R,n.spotShadow.length=N,n.spotShadowMap.length=N,n.directionalShadowMatrix.length=M,n.pointShadowMatrix.length=R,n.spotLightMatrix.length=N+P-U,n.spotLightMap.length=P,n.numSpotLightShadowsWithMaps=U,n.numLightProbes=L,F.directionalLength=_,F.pointLength=v,F.spotLength=b,F.rectAreaLength=E,F.hemiLength=T,F.numDirectionalShadows=M,F.numPointShadows=R,F.numSpotShadows=N,F.numSpotMaps=P,F.numLightProbes=L,n.version=Sie++)}function l(c,d){let p=0,y=0,_=0,v=0,b=0;const E=d.matrixWorldInverse;for(let T=0,M=c.length;T<M;T++){const R=c[T];if(R.isDirectionalLight){const N=n.directional[p];N.direction.setFromMatrixPosition(R.matrixWorld),i.setFromMatrixPosition(R.target.matrixWorld),N.direction.sub(i),N.direction.transformDirection(E),p++}else if(R.isSpotLight){const N=n.spot[_];N.position.setFromMatrixPosition(R.matrixWorld),N.position.applyMatrix4(E),N.direction.setFromMatrixPosition(R.matrixWorld),i.setFromMatrixPosition(R.target.matrixWorld),N.direction.sub(i),N.direction.transformDirection(E),_++}else if(R.isRectAreaLight){const N=n.rectArea[v];N.position.setFromMatrixPosition(R.matrixWorld),N.position.applyMatrix4(E),a.identity(),s.copy(R.matrixWorld),s.premultiply(E),a.extractRotation(s),N.halfWidth.set(R.width*.5,0,0),N.halfHeight.set(0,R.height*.5,0),N.halfWidth.applyMatrix4(a),N.halfHeight.applyMatrix4(a),v++}else if(R.isPointLight){const N=n.point[y];N.position.setFromMatrixPosition(R.matrixWorld),N.position.applyMatrix4(E),y++}else if(R.isHemisphereLight){const N=n.hemi[b];N.direction.setFromMatrixPosition(R.matrixWorld),N.direction.transformDirection(E),b++}}}return{setup:o,setupView:l,state:n}}function dV(r){const e=new Eie(r),t=[],n=[];function i(d){c.camera=d,t.length=0,n.length=0}function s(d){t.push(d)}function a(d){n.push(d)}function o(){e.setup(t)}function l(d){e.setupView(t,d)}const c={lightsArray:t,shadowsArray:n,camera:null,lights:e,transmissionRenderTarget:{}};return{init:i,state:c,setupLights:o,setupLightsView:l,pushLight:s,pushShadow:a}}function Mie(r){let e=new WeakMap;function t(i,s=0){const a=e.get(i);let o;return a===void 0?(o=new dV(r),e.set(i,[o])):s>=a.length?(o=new dV(r),a.push(o)):o=a[s],o}function n(){e=new WeakMap}return{get:t,dispose:n}}const Aie=`void main() {
	gl_Position = vec4( position, 1.0 );
}`,wie=`uniform sampler2D shadow_pass;
uniform vec2 resolution;
uniform float radius;
void main() {
	const float samples = float( VSM_SAMPLES );
	float mean = 0.0;
	float squared_mean = 0.0;
	float uvStride = samples <= 1.0 ? 0.0 : 2.0 / ( samples - 1.0 );
	float uvStart = samples <= 1.0 ? 0.0 : - 1.0;
	for ( float i = 0.0; i < samples; i ++ ) {
		float uvOffset = uvStart + i * uvStride;
		#ifdef HORIZONTAL_PASS
			vec2 distribution = texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( uvOffset, 0.0 ) * radius ) / resolution ).rg;
			mean += distribution.x;
			squared_mean += distribution.y * distribution.y + distribution.x * distribution.x;
		#else
			float depth = texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( 0.0, uvOffset ) * radius ) / resolution ).r;
			mean += depth;
			squared_mean += depth * depth;
		#endif
	}
	mean = mean / samples;
	squared_mean = squared_mean / samples;
	float std_dev = sqrt( max( 0.0, squared_mean - mean * mean ) );
	gl_FragColor = vec4( mean, std_dev, 0.0, 1.0 );
}`,Rie=[new ne(1,0,0),new ne(-1,0,0),new ne(0,1,0),new ne(0,-1,0),new ne(0,0,1),new ne(0,0,-1)],Cie=[new ne(0,-1,0),new ne(0,-1,0),new ne(0,0,1),new ne(0,0,-1),new ne(0,-1,0),new ne(0,-1,0)],hV=new gn,VS=new ne,b3=new ne;function Nie(r,e,t){let n=new Ry;const i=new tt,s=new tt,a=new zn,o=new AL,l=new wL,c={},d=t.maxTextureSize,p={[Cl]:gr,[gr]:Cl,[xa]:xa},y=new ul({defines:{VSM_SAMPLES:8},uniforms:{shadow_pass:{value:null},resolution:{value:new tt},radius:{value:4}},vertexShader:Aie,fragmentShader:wie}),_=y.clone();_.defines.HORIZONTAL_PASS=1;const v=new Qn;v.setAttribute("position",new Ji(new Float32Array([-1,-1,.5,3,-1,.5,-1,3,.5]),3));const b=new ar(v,y),E=this;this.enabled=!1,this.autoUpdate=!0,this.needsUpdate=!1,this.type=M0;let T=this.type;this.render=function(U,L,F){if(E.enabled===!1||E.autoUpdate===!1&&E.needsUpdate===!1||U.length===0)return;U.type===MT&&(Ve("WebGLShadowMap: PCFSoftShadowMap has been deprecated. Using PCFShadowMap instead."),U.type=M0);const O=r.getRenderTarget(),B=r.getActiveCubeFace(),q=r.getActiveMipmapLevel(),j=r.state;j.setBlending(yo),j.buffers.depth.getReversed()===!0?j.buffers.color.setClear(0,0,0,0):j.buffers.color.setClear(1,1,1,1),j.buffers.depth.setTest(!0),j.setScissorTest(!1);const Q=T!==this.type;Q&&L.traverse(function(se){se.material&&(Array.isArray(se.material)?se.material.forEach(ae=>ae.needsUpdate=!0):se.material.needsUpdate=!0)});for(let se=0,ae=U.length;se<ae;se++){const V=U[se],X=V.shadow;if(X===void 0){Ve("WebGLShadowMap:",V,"has no shadow.");continue}if(X.autoUpdate===!1&&X.needsUpdate===!1)continue;i.copy(X.mapSize);const ee=X.getFrameExtents();if(i.multiply(ee),s.copy(X.mapSize),(i.x>d||i.y>d)&&(i.x>d&&(s.x=Math.floor(d/ee.x),i.x=s.x*ee.x,X.mapSize.x=s.x),i.y>d&&(s.y=Math.floor(d/ee.y),i.y=s.y*ee.y,X.mapSize.y=s.y)),X.map===null||Q===!0){if(X.map!==null&&(X.map.depthTexture!==null&&(X.map.depthTexture.dispose(),X.map.depthTexture=null),X.map.dispose()),this.type===$c){if(V.isPointLight){Ve("WebGLShadowMap: VSM shadow maps are not supported for PointLights. Use PCF or BasicShadowMap instead.");continue}X.map=new sl(i.x,i.y,{format:po,type:vi,minFilter:ei,magFilter:ei,generateMipmaps:!1}),X.map.texture.name=V.name+".shadowMap",X.map.depthTexture=new Ga(i.x,i.y,Ci),X.map.depthTexture.name=V.name+".shadowMapDepth",X.map.depthTexture.format=ba,X.map.depthTexture.compareFunction=null,X.map.depthTexture.minFilter=Ki,X.map.depthTexture.magFilter=Ki}else{V.isPointLight?(X.map=new k1(i.x),X.map.depthTexture=new fL(i.x,Hi)):(X.map=new sl(i.x,i.y),X.map.depthTexture=new Ga(i.x,i.y,Hi)),X.map.depthTexture.name=V.name+".shadowMap",X.map.depthTexture.format=ba;const Y=r.state.buffers.depth.getReversed();this.type===M0?(X.map.depthTexture.compareFunction=Y?Gx:Vx,X.map.depthTexture.minFilter=ei,X.map.depthTexture.magFilter=ei):(X.map.depthTexture.compareFunction=null,X.map.depthTexture.minFilter=Ki,X.map.depthTexture.magFilter=Ki)}X.camera.updateProjectionMatrix()}const fe=X.map.isWebGLCubeRenderTarget?6:1;for(let Y=0;Y<fe;Y++){if(X.map.isWebGLCubeRenderTarget)r.setRenderTarget(X.map,Y),r.clear();else{Y===0&&(r.setRenderTarget(X.map),r.clear());const K=X.getViewport(Y);a.set(s.x*K.x,s.y*K.y,s.x*K.z,s.y*K.w),j.viewport(a)}if(V.isPointLight){const K=X.camera,he=X.matrix,Ce=V.distance||K.far;Ce!==K.far&&(K.far=Ce,K.updateProjectionMatrix()),VS.setFromMatrixPosition(V.matrixWorld),K.position.copy(VS),b3.copy(K.position),b3.add(Rie[Y]),K.up.copy(Cie[Y]),K.lookAt(b3),K.updateMatrixWorld(),he.makeTranslation(-VS.x,-VS.y,-VS.z),hV.multiplyMatrices(K.projectionMatrix,K.matrixWorldInverse),X._frustum.setFromProjectionMatrix(hV,K.coordinateSystem,K.reversedDepth)}else X.updateMatrices(V);n=X.getFrustum(),N(L,F,X.camera,V,this.type)}X.isPointLightShadow!==!0&&this.type===$c&&M(X,F),X.needsUpdate=!1}T=this.type,E.needsUpdate=!1,r.setRenderTarget(O,B,q)};function M(U,L){const F=e.update(b);y.defines.VSM_SAMPLES!==U.blurSamples&&(y.defines.VSM_SAMPLES=U.blurSamples,_.defines.VSM_SAMPLES=U.blurSamples,y.needsUpdate=!0,_.needsUpdate=!0),U.mapPass===null&&(U.mapPass=new sl(i.x,i.y,{format:po,type:vi})),y.uniforms.shadow_pass.value=U.map.depthTexture,y.uniforms.resolution.value=U.mapSize,y.uniforms.radius.value=U.radius,r.setRenderTarget(U.mapPass),r.clear(),r.renderBufferDirect(L,null,F,y,b,null),_.uniforms.shadow_pass.value=U.mapPass.texture,_.uniforms.resolution.value=U.mapSize,_.uniforms.radius.value=U.radius,r.setRenderTarget(U.map),r.clear(),r.renderBufferDirect(L,null,F,_,b,null)}function R(U,L,F,O){let B=null;const q=F.isPointLight===!0?U.customDistanceMaterial:U.customDepthMaterial;if(q!==void 0)B=q;else if(B=F.isPointLight===!0?l:o,r.localClippingEnabled&&L.clipShadows===!0&&Array.isArray(L.clippingPlanes)&&L.clippingPlanes.length!==0||L.displacementMap&&L.displacementScale!==0||L.alphaMap&&L.alphaTest>0||L.map&&L.alphaTest>0||L.alphaToCoverage===!0){const j=B.uuid,Q=L.uuid;let se=c[j];se===void 0&&(se={},c[j]=se);let ae=se[Q];ae===void 0&&(ae=B.clone(),se[Q]=ae,L.addEventListener("dispose",P)),B=ae}if(B.visible=L.visible,B.wireframe=L.wireframe,O===$c?B.side=L.shadowSide!==null?L.shadowSide:L.side:B.side=L.shadowSide!==null?L.shadowSide:p[L.side],B.alphaMap=L.alphaMap,B.alphaTest=L.alphaToCoverage===!0?.5:L.alphaTest,B.map=L.map,B.clipShadows=L.clipShadows,B.clippingPlanes=L.clippingPlanes,B.clipIntersection=L.clipIntersection,B.displacementMap=L.displacementMap,B.displacementScale=L.displacementScale,B.displacementBias=L.displacementBias,B.wireframeLinewidth=L.wireframeLinewidth,B.linewidth=L.linewidth,F.isPointLight===!0&&B.isMeshDistanceMaterial===!0){const j=r.properties.get(B);j.light=F}return B}function N(U,L,F,O,B){if(U.visible===!1)return;if(U.layers.test(L.layers)&&(U.isMesh||U.isLine||U.isPoints)&&(U.castShadow||U.receiveShadow&&B===$c)&&(!U.frustumCulled||n.intersectsObject(U))){U.modelViewMatrix.multiplyMatrices(F.matrixWorldInverse,U.matrixWorld);const Q=e.update(U),se=U.material;if(Array.isArray(se)){const ae=Q.groups;for(let V=0,X=ae.length;V<X;V++){const ee=ae[V],fe=se[ee.materialIndex];if(fe&&fe.visible){const Y=R(U,fe,O,B);U.onBeforeShadow(r,U,L,F,Q,Y,ee),r.renderBufferDirect(F,null,Q,Y,U,ee),U.onAfterShadow(r,U,L,F,Q,Y,ee)}}}else if(se.visible){const ae=R(U,se,O,B);U.onBeforeShadow(r,U,L,F,Q,ae,null),r.renderBufferDirect(F,null,Q,ae,U,null),U.onAfterShadow(r,U,L,F,Q,ae,null)}}const j=U.children;for(let Q=0,se=j.length;Q<se;Q++)N(j[Q],L,F,O,B)}function P(U){U.target.removeEventListener("dispose",P);for(const F in c){const O=c[F],B=U.target.uuid;B in O&&(O[B].dispose(),delete O[B])}}}const Die={[rx]:sx,[ax]:ux,[ox]:cx,[Oh]:lx,[sx]:rx,[ux]:ax,[cx]:ox,[lx]:Oh};function Oie(r,e){function t(){let le=!1;const Be=new zn;let lt=null;const Ot=new zn(0,0,0,0);return{setMask:function(ht){lt!==ht&&!le&&(r.colorMask(ht,ht,ht,ht),lt=ht)},setLocked:function(ht){le=ht},setClear:function(ht,it,Tt,ln,jn){jn===!0&&(ht*=ln,it*=ln,Tt*=ln),Be.set(ht,it,Tt,ln),Ot.equals(Be)===!1&&(r.clearColor(ht,it,Tt,ln),Ot.copy(Be))},reset:function(){le=!1,lt=null,Ot.set(-1,0,0,0)}}}function n(){let le=!1,Be=!1,lt=null,Ot=null,ht=null;return{setReversed:function(it){if(Be!==it){const Tt=e.get("EXT_clip_control");it?Tt.clipControlEXT(Tt.LOWER_LEFT_EXT,Tt.ZERO_TO_ONE_EXT):Tt.clipControlEXT(Tt.LOWER_LEFT_EXT,Tt.NEGATIVE_ONE_TO_ONE_EXT),Be=it;const ln=ht;ht=null,this.setClear(ln)}},getReversed:function(){return Be},setTest:function(it){it?Ne(r.DEPTH_TEST):rt(r.DEPTH_TEST)},setMask:function(it){lt!==it&&!le&&(r.depthMask(it),lt=it)},setFunc:function(it){if(Be&&(it=Die[it]),Ot!==it){switch(it){case rx:r.depthFunc(r.NEVER);break;case sx:r.depthFunc(r.ALWAYS);break;case ax:r.depthFunc(r.LESS);break;case Oh:r.depthFunc(r.LEQUAL);break;case ox:r.depthFunc(r.EQUAL);break;case lx:r.depthFunc(r.GEQUAL);break;case ux:r.depthFunc(r.GREATER);break;case cx:r.depthFunc(r.NOTEQUAL);break;default:r.depthFunc(r.LEQUAL)}Ot=it}},setLocked:function(it){le=it},setClear:function(it){ht!==it&&(Be&&(it=1-it),r.clearDepth(it),ht=it)},reset:function(){le=!1,lt=null,Ot=null,ht=null,Be=!1}}}function i(){let le=!1,Be=null,lt=null,Ot=null,ht=null,it=null,Tt=null,ln=null,jn=null;return{setTest:function(qt){le||(qt?Ne(r.STENCIL_TEST):rt(r.STENCIL_TEST))},setMask:function(qt){Be!==qt&&!le&&(r.stencilMask(qt),Be=qt)},setFunc:function(qt,nn,Bn){(lt!==qt||Ot!==nn||ht!==Bn)&&(r.stencilFunc(qt,nn,Bn),lt=qt,Ot=nn,ht=Bn)},setOp:function(qt,nn,Bn){(it!==qt||Tt!==nn||ln!==Bn)&&(r.stencilOp(qt,nn,Bn),it=qt,Tt=nn,ln=Bn)},setLocked:function(qt){le=qt},setClear:function(qt){jn!==qt&&(r.clearStencil(qt),jn=qt)},reset:function(){le=!1,Be=null,lt=null,Ot=null,ht=null,it=null,Tt=null,ln=null,jn=null}}}const s=new t,a=new n,o=new i,l=new WeakMap,c=new WeakMap;let d={},p={},y=new WeakMap,_=[],v=null,b=!1,E=null,T=null,M=null,R=null,N=null,P=null,U=null,L=new Kt(0,0,0),F=0,O=!1,B=null,q=null,j=null,Q=null,se=null;const ae=r.getParameter(r.MAX_COMBINED_TEXTURE_IMAGE_UNITS);let V=!1,X=0;const ee=r.getParameter(r.VERSION);ee.indexOf("WebGL")!==-1?(X=parseFloat(/^WebGL (\d)/.exec(ee)[1]),V=X>=1):ee.indexOf("OpenGL ES")!==-1&&(X=parseFloat(/^OpenGL ES (\d)/.exec(ee)[1]),V=X>=2);let fe=null,Y={};const K=r.getParameter(r.SCISSOR_BOX),he=r.getParameter(r.VIEWPORT),Ce=new zn().fromArray(K),Ie=new zn().fromArray(he);function ut(le,Be,lt,Ot){const ht=new Uint8Array(4),it=r.createTexture();r.bindTexture(le,it),r.texParameteri(le,r.TEXTURE_MIN_FILTER,r.NEAREST),r.texParameteri(le,r.TEXTURE_MAG_FILTER,r.NEAREST);for(let Tt=0;Tt<lt;Tt++)le===r.TEXTURE_3D||le===r.TEXTURE_2D_ARRAY?r.texImage3D(Be,0,r.RGBA,1,1,Ot,0,r.RGBA,r.UNSIGNED_BYTE,ht):r.texImage2D(Be+Tt,0,r.RGBA,1,1,0,r.RGBA,r.UNSIGNED_BYTE,ht);return it}const Ee={};Ee[r.TEXTURE_2D]=ut(r.TEXTURE_2D,r.TEXTURE_2D,1),Ee[r.TEXTURE_CUBE_MAP]=ut(r.TEXTURE_CUBE_MAP,r.TEXTURE_CUBE_MAP_POSITIVE_X,6),Ee[r.TEXTURE_2D_ARRAY]=ut(r.TEXTURE_2D_ARRAY,r.TEXTURE_2D_ARRAY,1,1),Ee[r.TEXTURE_3D]=ut(r.TEXTURE_3D,r.TEXTURE_3D,1,1),s.setClear(0,0,0,1),a.setClear(1),o.setClear(0),Ne(r.DEPTH_TEST),a.setFunc(Oh),Je(!1),xe($w),Ne(r.CULL_FACE),qe(yo);function Ne(le){d[le]!==!0&&(r.enable(le),d[le]=!0)}function rt(le){d[le]!==!1&&(r.disable(le),d[le]=!1)}function Nt(le,Be){return p[le]!==Be?(r.bindFramebuffer(le,Be),p[le]=Be,le===r.DRAW_FRAMEBUFFER&&(p[r.FRAMEBUFFER]=Be),le===r.FRAMEBUFFER&&(p[r.DRAW_FRAMEBUFFER]=Be),!0):!1}function Ft(le,Be){let lt=_,Ot=!1;if(le){lt=y.get(Be),lt===void 0&&(lt=[],y.set(Be,lt));const ht=le.textures;if(lt.length!==ht.length||lt[0]!==r.COLOR_ATTACHMENT0){for(let it=0,Tt=ht.length;it<Tt;it++)lt[it]=r.COLOR_ATTACHMENT0+it;lt.length=ht.length,Ot=!0}}else lt[0]!==r.BACK&&(lt[0]=r.BACK,Ot=!0);Ot&&r.drawBuffers(lt)}function fn(le){return v!==le?(r.useProgram(le),v=le,!0):!1}const Sn={[La]:r.FUNC_ADD,[eC]:r.FUNC_SUBTRACT,[tC]:r.FUNC_REVERSE_SUBTRACT};Sn[ZU]=r.MIN,Sn[KU]=r.MAX;const At={[Qf]:r.ZERO,[nC]:r.ONE,[iC]:r.SRC_COLOR,[nx]:r.SRC_ALPHA,[uC]:r.SRC_ALPHA_SATURATE,[oC]:r.DST_COLOR,[sC]:r.DST_ALPHA,[rC]:r.ONE_MINUS_SRC_COLOR,[ix]:r.ONE_MINUS_SRC_ALPHA,[lC]:r.ONE_MINUS_DST_COLOR,[aC]:r.ONE_MINUS_DST_ALPHA,[Tk]:r.CONSTANT_COLOR,[Ek]:r.ONE_MINUS_CONSTANT_COLOR,[Mk]:r.CONSTANT_ALPHA,[Ak]:r.ONE_MINUS_CONSTANT_ALPHA};function qe(le,Be,lt,Ot,ht,it,Tt,ln,jn,qt){if(le===yo){b===!0&&(rt(r.BLEND),b=!1);return}if(b===!1&&(Ne(r.BLEND),b=!0),le!==A0){if(le!==E||qt!==O){if((T!==La||N!==La)&&(r.blendEquation(r.FUNC_ADD),T=La,N=La),qt)switch(le){case Nl:r.blendFuncSeparate(r.ONE,r.ONE_MINUS_SRC_ALPHA,r.ONE,r.ONE_MINUS_SRC_ALPHA);break;case V0:r.blendFunc(r.ONE,r.ONE);break;case G0:r.blendFuncSeparate(r.ZERO,r.ONE_MINUS_SRC_COLOR,r.ZERO,r.ONE);break;case k0:r.blendFuncSeparate(r.DST_COLOR,r.ONE_MINUS_SRC_ALPHA,r.ZERO,r.ONE);break;default:Ze("WebGLState: Invalid blending: ",le);break}else switch(le){case Nl:r.blendFuncSeparate(r.SRC_ALPHA,r.ONE_MINUS_SRC_ALPHA,r.ONE,r.ONE_MINUS_SRC_ALPHA);break;case V0:r.blendFuncSeparate(r.SRC_ALPHA,r.ONE,r.ONE,r.ONE);break;case G0:Ze("WebGLState: SubtractiveBlending requires material.premultipliedAlpha = true");break;case k0:Ze("WebGLState: MultiplyBlending requires material.premultipliedAlpha = true");break;default:Ze("WebGLState: Invalid blending: ",le);break}M=null,R=null,P=null,U=null,L.set(0,0,0),F=0,E=le,O=qt}return}ht=ht||Be,it=it||lt,Tt=Tt||Ot,(Be!==T||ht!==N)&&(r.blendEquationSeparate(Sn[Be],Sn[ht]),T=Be,N=ht),(lt!==M||Ot!==R||it!==P||Tt!==U)&&(r.blendFuncSeparate(At[lt],At[Ot],At[it],At[Tt]),M=lt,R=Ot,P=it,U=Tt),(ln.equals(L)===!1||jn!==F)&&(r.blendColor(ln.r,ln.g,ln.b,jn),L.copy(ln),F=jn),E=le,O=!1}function at(le,Be){le.side===xa?rt(r.CULL_FACE):Ne(r.CULL_FACE);let lt=le.side===gr;Be&&(lt=!lt),Je(lt),le.blending===Nl&&le.transparent===!1?qe(yo):qe(le.blending,le.blendEquation,le.blendSrc,le.blendDst,le.blendEquationAlpha,le.blendSrcAlpha,le.blendDstAlpha,le.blendColor,le.blendAlpha,le.premultipliedAlpha),a.setFunc(le.depthFunc),a.setTest(le.depthTest),a.setMask(le.depthWrite),s.setMask(le.colorWrite);const Ot=le.stencilWrite;o.setTest(Ot),Ot&&(o.setMask(le.stencilWriteMask),o.setFunc(le.stencilFunc,le.stencilRef,le.stencilFuncMask),o.setOp(le.stencilFail,le.stencilZFail,le.stencilZPass)),Qt(le.polygonOffset,le.polygonOffsetFactor,le.polygonOffsetUnits),le.alphaToCoverage===!0?Ne(r.SAMPLE_ALPHA_TO_COVERAGE):rt(r.SAMPLE_ALPHA_TO_COVERAGE)}function Je(le){B!==le&&(le?r.frontFace(r.CW):r.frontFace(r.CCW),B=le)}function xe(le){le!==$U?(Ne(r.CULL_FACE),le!==q&&(le===$w?r.cullFace(r.BACK):le===jU?r.cullFace(r.FRONT):r.cullFace(r.FRONT_AND_BACK))):rt(r.CULL_FACE),q=le}function oe(le){le!==j&&(V&&r.lineWidth(le),j=le)}function Qt(le,Be,lt){le?(Ne(r.POLYGON_OFFSET_FILL),(Q!==Be||se!==lt)&&(r.polygonOffset(Be,lt),Q=Be,se=lt)):rt(r.POLYGON_OFFSET_FILL)}function Dt(le){le?Ne(r.SCISSOR_TEST):rt(r.SCISSOR_TEST)}function zt(le){le===void 0&&(le=r.TEXTURE0+ae-1),fe!==le&&(r.activeTexture(le),fe=le)}function wt(le,Be,lt){lt===void 0&&(fe===null?lt=r.TEXTURE0+ae-1:lt=fe);let Ot=Y[lt];Ot===void 0&&(Ot={type:void 0,texture:void 0},Y[lt]=Ot),(Ot.type!==le||Ot.texture!==Be)&&(fe!==lt&&(r.activeTexture(lt),fe=lt),r.bindTexture(le,Be||Ee[le]),Ot.type=le,Ot.texture=Be)}function Z(){const le=Y[fe];le!==void 0&&le.type!==void 0&&(r.bindTexture(le.type,null),le.type=void 0,le.texture=void 0)}function k(){try{r.compressedTexImage2D(...arguments)}catch(le){Ze("WebGLState:",le)}}function pe(){try{r.compressedTexImage3D(...arguments)}catch(le){Ze("WebGLState:",le)}}function Fe(){try{r.texSubImage2D(...arguments)}catch(le){Ze("WebGLState:",le)}}function He(){try{r.texSubImage3D(...arguments)}catch(le){Ze("WebGLState:",le)}}function ze(){try{r.compressedTexSubImage2D(...arguments)}catch(le){Ze("WebGLState:",le)}}function Bt(){try{r.compressedTexSubImage3D(...arguments)}catch(le){Ze("WebGLState:",le)}}function Ct(){try{r.texStorage2D(...arguments)}catch(le){Ze("WebGLState:",le)}}function Yt(){try{r.texStorage3D(...arguments)}catch(le){Ze("WebGLState:",le)}}function $t(){try{r.texImage2D(...arguments)}catch(le){Ze("WebGLState:",le)}}function st(){try{r.texImage3D(...arguments)}catch(le){Ze("WebGLState:",le)}}function nt(le){Ce.equals(le)===!1&&(r.scissor(le.x,le.y,le.z,le.w),Ce.copy(le))}function Pt(le){Ie.equals(le)===!1&&(r.viewport(le.x,le.y,le.z,le.w),Ie.copy(le))}function ue(le,Be){let lt=c.get(Be);lt===void 0&&(lt=new WeakMap,c.set(Be,lt));let Ot=lt.get(le);Ot===void 0&&(Ot=r.getUniformBlockIndex(Be,le.name),lt.set(le,Ot))}function Re(le,Be){const Ot=c.get(Be).get(le);l.get(Be)!==Ot&&(r.uniformBlockBinding(Be,Ot,le.__bindingPointIndex),l.set(Be,Ot))}function dt(){r.disable(r.BLEND),r.disable(r.CULL_FACE),r.disable(r.DEPTH_TEST),r.disable(r.POLYGON_OFFSET_FILL),r.disable(r.SCISSOR_TEST),r.disable(r.STENCIL_TEST),r.disable(r.SAMPLE_ALPHA_TO_COVERAGE),r.blendEquation(r.FUNC_ADD),r.blendFunc(r.ONE,r.ZERO),r.blendFuncSeparate(r.ONE,r.ZERO,r.ONE,r.ZERO),r.blendColor(0,0,0,0),r.colorMask(!0,!0,!0,!0),r.clearColor(0,0,0,0),r.depthMask(!0),r.depthFunc(r.LESS),a.setReversed(!1),r.clearDepth(1),r.stencilMask(4294967295),r.stencilFunc(r.ALWAYS,0,4294967295),r.stencilOp(r.KEEP,r.KEEP,r.KEEP),r.clearStencil(0),r.cullFace(r.BACK),r.frontFace(r.CCW),r.polygonOffset(0,0),r.activeTexture(r.TEXTURE0),r.bindFramebuffer(r.FRAMEBUFFER,null),r.bindFramebuffer(r.DRAW_FRAMEBUFFER,null),r.bindFramebuffer(r.READ_FRAMEBUFFER,null),r.useProgram(null),r.lineWidth(1),r.scissor(0,0,r.canvas.width,r.canvas.height),r.viewport(0,0,r.canvas.width,r.canvas.height),d={},fe=null,Y={},p={},y=new WeakMap,_=[],v=null,b=!1,E=null,T=null,M=null,R=null,N=null,P=null,U=null,L=new Kt(0,0,0),F=0,O=!1,B=null,q=null,j=null,Q=null,se=null,Ce.set(0,0,r.canvas.width,r.canvas.height),Ie.set(0,0,r.canvas.width,r.canvas.height),s.reset(),a.reset(),o.reset()}return{buffers:{color:s,depth:a,stencil:o},enable:Ne,disable:rt,bindFramebuffer:Nt,drawBuffers:Ft,useProgram:fn,setBlending:qe,setMaterial:at,setFlipSided:Je,setCullFace:xe,setLineWidth:oe,setPolygonOffset:Qt,setScissorTest:Dt,activeTexture:zt,bindTexture:wt,unbindTexture:Z,compressedTexImage2D:k,compressedTexImage3D:pe,texImage2D:$t,texImage3D:st,updateUBOMapping:ue,uniformBlockBinding:Re,texStorage2D:Ct,texStorage3D:Yt,texSubImage2D:Fe,texSubImage3D:He,compressedTexSubImage2D:ze,compressedTexSubImage3D:Bt,scissor:nt,viewport:Pt,reset:dt}}function Uie(r,e,t,n,i,s,a){const o=e.has("WEBGL_multisampled_render_to_texture")?e.get("WEBGL_multisampled_render_to_texture"):null,l=typeof navigator>"u"?!1:/OculusBrowser/g.test(navigator.userAgent),c=new tt,d=new WeakMap;let p;const y=new WeakMap;let _=!1;try{_=typeof OffscreenCanvas<"u"&&new OffscreenCanvas(1,1).getContext("2d")!==null}catch{}function v(Z,k){return _?new OffscreenCanvas(Z,k):i1("canvas")}function b(Z,k,pe){let Fe=1;const He=wt(Z);if((He.width>pe||He.height>pe)&&(Fe=pe/Math.max(He.width,He.height)),Fe<1)if(typeof HTMLImageElement<"u"&&Z instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&Z instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&Z instanceof ImageBitmap||typeof VideoFrame<"u"&&Z instanceof VideoFrame){const ze=Math.floor(Fe*He.width),Bt=Math.floor(Fe*He.height);p===void 0&&(p=v(ze,Bt));const Ct=k?v(ze,Bt):p;return Ct.width=ze,Ct.height=Bt,Ct.getContext("2d").drawImage(Z,0,0,ze,Bt),Ve("WebGLRenderer: Texture has been resized from ("+He.width+"x"+He.height+") to ("+ze+"x"+Bt+")."),Ct}else return"data"in Z&&Ve("WebGLRenderer: Image in DataTexture is too big ("+He.width+"x"+He.height+")."),Z;return Z}function E(Z){return Z.generateMipmaps}function T(Z){r.generateMipmap(Z)}function M(Z){return Z.isWebGLCubeRenderTarget?r.TEXTURE_CUBE_MAP:Z.isWebGL3DRenderTarget?r.TEXTURE_3D:Z.isWebGLArrayRenderTarget||Z.isCompressedArrayTexture?r.TEXTURE_2D_ARRAY:r.TEXTURE_2D}function R(Z,k,pe,Fe,He=!1){if(Z!==null){if(r[Z]!==void 0)return r[Z];Ve("WebGLRenderer: Attempt to use non-existing WebGL internal format '"+Z+"'")}let ze=k;if(k===r.RED&&(pe===r.FLOAT&&(ze=r.R32F),pe===r.HALF_FLOAT&&(ze=r.R16F),pe===r.UNSIGNED_BYTE&&(ze=r.R8)),k===r.RED_INTEGER&&(pe===r.UNSIGNED_BYTE&&(ze=r.R8UI),pe===r.UNSIGNED_SHORT&&(ze=r.R16UI),pe===r.UNSIGNED_INT&&(ze=r.R32UI),pe===r.BYTE&&(ze=r.R8I),pe===r.SHORT&&(ze=r.R16I),pe===r.INT&&(ze=r.R32I)),k===r.RG&&(pe===r.FLOAT&&(ze=r.RG32F),pe===r.HALF_FLOAT&&(ze=r.RG16F),pe===r.UNSIGNED_BYTE&&(ze=r.RG8)),k===r.RG_INTEGER&&(pe===r.UNSIGNED_BYTE&&(ze=r.RG8UI),pe===r.UNSIGNED_SHORT&&(ze=r.RG16UI),pe===r.UNSIGNED_INT&&(ze=r.RG32UI),pe===r.BYTE&&(ze=r.RG8I),pe===r.SHORT&&(ze=r.RG16I),pe===r.INT&&(ze=r.RG32I)),k===r.RGB_INTEGER&&(pe===r.UNSIGNED_BYTE&&(ze=r.RGB8UI),pe===r.UNSIGNED_SHORT&&(ze=r.RGB16UI),pe===r.UNSIGNED_INT&&(ze=r.RGB32UI),pe===r.BYTE&&(ze=r.RGB8I),pe===r.SHORT&&(ze=r.RGB16I),pe===r.INT&&(ze=r.RGB32I)),k===r.RGBA_INTEGER&&(pe===r.UNSIGNED_BYTE&&(ze=r.RGBA8UI),pe===r.UNSIGNED_SHORT&&(ze=r.RGBA16UI),pe===r.UNSIGNED_INT&&(ze=r.RGBA32UI),pe===r.BYTE&&(ze=r.RGBA8I),pe===r.SHORT&&(ze=r.RGBA16I),pe===r.INT&&(ze=r.RGBA32I)),k===r.RGB&&(pe===r.UNSIGNED_INT_5_9_9_9_REV&&(ze=r.RGB9_E5),pe===r.UNSIGNED_INT_10F_11F_11F_REV&&(ze=r.R11F_G11F_B10F)),k===r.RGBA){const Bt=He?hy:Nn.getTransfer(Fe);pe===r.FLOAT&&(ze=r.RGBA32F),pe===r.HALF_FLOAT&&(ze=r.RGBA16F),pe===r.UNSIGNED_BYTE&&(ze=Bt===an?r.SRGB8_ALPHA8:r.RGBA8),pe===r.UNSIGNED_SHORT_4_4_4_4&&(ze=r.RGBA4),pe===r.UNSIGNED_SHORT_5_5_5_1&&(ze=r.RGB5_A1)}return(ze===r.R16F||ze===r.R32F||ze===r.RG16F||ze===r.RG32F||ze===r.RGBA16F||ze===r.RGBA32F)&&e.get("EXT_color_buffer_float"),ze}function N(Z,k){let pe;return Z?k===null||k===Hi||k===Dl?pe=r.DEPTH24_STENCIL8:k===Ci?pe=r.DEPTH32F_STENCIL8:k===Zu&&(pe=r.DEPTH24_STENCIL8,Ve("DepthTexture: 16 bit depth attachment is not supported with stencil. Using 24-bit attachment.")):k===null||k===Hi||k===Dl?pe=r.DEPTH_COMPONENT24:k===Ci?pe=r.DEPTH_COMPONENT32F:k===Zu&&(pe=r.DEPTH_COMPONENT16),pe}function P(Z,k){return E(Z)===!0||Z.isFramebufferTexture&&Z.minFilter!==Ki&&Z.minFilter!==ei?Math.log2(Math.max(k.width,k.height))+1:Z.mipmaps!==void 0&&Z.mipmaps.length>0?Z.mipmaps.length:Z.isCompressedTexture&&Array.isArray(Z.image)?k.mipmaps.length:1}function U(Z){const k=Z.target;k.removeEventListener("dispose",U),F(k),k.isVideoTexture&&d.delete(k)}function L(Z){const k=Z.target;k.removeEventListener("dispose",L),B(k)}function F(Z){const k=n.get(Z);if(k.__webglInit===void 0)return;const pe=Z.source,Fe=y.get(pe);if(Fe){const He=Fe[k.__cacheKey];He.usedTimes--,He.usedTimes===0&&O(Z),Object.keys(Fe).length===0&&y.delete(pe)}n.remove(Z)}function O(Z){const k=n.get(Z);r.deleteTexture(k.__webglTexture);const pe=Z.source,Fe=y.get(pe);delete Fe[k.__cacheKey],a.memory.textures--}function B(Z){const k=n.get(Z);if(Z.depthTexture&&(Z.depthTexture.dispose(),n.remove(Z.depthTexture)),Z.isWebGLCubeRenderTarget)for(let Fe=0;Fe<6;Fe++){if(Array.isArray(k.__webglFramebuffer[Fe]))for(let He=0;He<k.__webglFramebuffer[Fe].length;He++)r.deleteFramebuffer(k.__webglFramebuffer[Fe][He]);else r.deleteFramebuffer(k.__webglFramebuffer[Fe]);k.__webglDepthbuffer&&r.deleteRenderbuffer(k.__webglDepthbuffer[Fe])}else{if(Array.isArray(k.__webglFramebuffer))for(let Fe=0;Fe<k.__webglFramebuffer.length;Fe++)r.deleteFramebuffer(k.__webglFramebuffer[Fe]);else r.deleteFramebuffer(k.__webglFramebuffer);if(k.__webglDepthbuffer&&r.deleteRenderbuffer(k.__webglDepthbuffer),k.__webglMultisampledFramebuffer&&r.deleteFramebuffer(k.__webglMultisampledFramebuffer),k.__webglColorRenderbuffer)for(let Fe=0;Fe<k.__webglColorRenderbuffer.length;Fe++)k.__webglColorRenderbuffer[Fe]&&r.deleteRenderbuffer(k.__webglColorRenderbuffer[Fe]);k.__webglDepthRenderbuffer&&r.deleteRenderbuffer(k.__webglDepthRenderbuffer)}const pe=Z.textures;for(let Fe=0,He=pe.length;Fe<He;Fe++){const ze=n.get(pe[Fe]);ze.__webglTexture&&(r.deleteTexture(ze.__webglTexture),a.memory.textures--),n.remove(pe[Fe])}n.remove(Z)}let q=0;function j(){q=0}function Q(){const Z=q;return Z>=i.maxTextures&&Ve("WebGLTextures: Trying to use "+Z+" texture units while this GPU supports only "+i.maxTextures),q+=1,Z}function se(Z){const k=[];return k.push(Z.wrapS),k.push(Z.wrapT),k.push(Z.wrapR||0),k.push(Z.magFilter),k.push(Z.minFilter),k.push(Z.anisotropy),k.push(Z.internalFormat),k.push(Z.format),k.push(Z.type),k.push(Z.generateMipmaps),k.push(Z.premultiplyAlpha),k.push(Z.flipY),k.push(Z.unpackAlignment),k.push(Z.colorSpace),k.join()}function ae(Z,k){const pe=n.get(Z);if(Z.isVideoTexture&&Dt(Z),Z.isRenderTargetTexture===!1&&Z.isExternalTexture!==!0&&Z.version>0&&pe.__version!==Z.version){const Fe=Z.image;if(Fe===null)Ve("WebGLRenderer: Texture marked for update but no image data found.");else if(Fe.complete===!1)Ve("WebGLRenderer: Texture marked for update but image is incomplete");else{Ee(pe,Z,k);return}}else Z.isExternalTexture&&(pe.__webglTexture=Z.sourceTexture?Z.sourceTexture:null);t.bindTexture(r.TEXTURE_2D,pe.__webglTexture,r.TEXTURE0+k)}function V(Z,k){const pe=n.get(Z);if(Z.isRenderTargetTexture===!1&&Z.version>0&&pe.__version!==Z.version){Ee(pe,Z,k);return}else Z.isExternalTexture&&(pe.__webglTexture=Z.sourceTexture?Z.sourceTexture:null);t.bindTexture(r.TEXTURE_2D_ARRAY,pe.__webglTexture,r.TEXTURE0+k)}function X(Z,k){const pe=n.get(Z);if(Z.isRenderTargetTexture===!1&&Z.version>0&&pe.__version!==Z.version){Ee(pe,Z,k);return}t.bindTexture(r.TEXTURE_3D,pe.__webglTexture,r.TEXTURE0+k)}function ee(Z,k){const pe=n.get(Z);if(Z.isCubeDepthTexture!==!0&&Z.version>0&&pe.__version!==Z.version){Ne(pe,Z,k);return}t.bindTexture(r.TEXTURE_CUBE_MAP,pe.__webglTexture,r.TEXTURE0+k)}const fe={[Bh]:r.REPEAT,[Dr]:r.CLAMP_TO_EDGE,[Ih]:r.MIRRORED_REPEAT},Y={[Ki]:r.NEAREST,[P1]:r.NEAREST_MIPMAP_NEAREST,[jc]:r.NEAREST_MIPMAP_LINEAR,[ei]:r.LINEAR,[dm]:r.LINEAR_MIPMAP_NEAREST,[Pa]:r.LINEAR_MIPMAP_LINEAR},K={[yC]:r.NEVER,[bC]:r.ALWAYS,[zx]:r.LESS,[Vx]:r.LEQUAL,[_C]:r.EQUAL,[Gx]:r.GEQUAL,[vC]:r.GREATER,[xC]:r.NOTEQUAL};function he(Z,k){if(k.type===Ci&&e.has("OES_texture_float_linear")===!1&&(k.magFilter===ei||k.magFilter===dm||k.magFilter===jc||k.magFilter===Pa||k.minFilter===ei||k.minFilter===dm||k.minFilter===jc||k.minFilter===Pa)&&Ve("WebGLRenderer: Unable to use linear filtering with floating point textures. OES_texture_float_linear not supported on this device."),r.texParameteri(Z,r.TEXTURE_WRAP_S,fe[k.wrapS]),r.texParameteri(Z,r.TEXTURE_WRAP_T,fe[k.wrapT]),(Z===r.TEXTURE_3D||Z===r.TEXTURE_2D_ARRAY)&&r.texParameteri(Z,r.TEXTURE_WRAP_R,fe[k.wrapR]),r.texParameteri(Z,r.TEXTURE_MAG_FILTER,Y[k.magFilter]),r.texParameteri(Z,r.TEXTURE_MIN_FILTER,Y[k.minFilter]),k.compareFunction&&(r.texParameteri(Z,r.TEXTURE_COMPARE_MODE,r.COMPARE_REF_TO_TEXTURE),r.texParameteri(Z,r.TEXTURE_COMPARE_FUNC,K[k.compareFunction])),e.has("EXT_texture_filter_anisotropic")===!0){if(k.magFilter===Ki||k.minFilter!==jc&&k.minFilter!==Pa||k.type===Ci&&e.has("OES_texture_float_linear")===!1)return;if(k.anisotropy>1||n.get(k).__currentAnisotropy){const pe=e.get("EXT_texture_filter_anisotropic");r.texParameterf(Z,pe.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(k.anisotropy,i.getMaxAnisotropy())),n.get(k).__currentAnisotropy=k.anisotropy}}}function Ce(Z,k){let pe=!1;Z.__webglInit===void 0&&(Z.__webglInit=!0,k.addEventListener("dispose",U));const Fe=k.source;let He=y.get(Fe);He===void 0&&(He={},y.set(Fe,He));const ze=se(k);if(ze!==Z.__cacheKey){He[ze]===void 0&&(He[ze]={texture:r.createTexture(),usedTimes:0},a.memory.textures++,pe=!0),He[ze].usedTimes++;const Bt=He[Z.__cacheKey];Bt!==void 0&&(He[Z.__cacheKey].usedTimes--,Bt.usedTimes===0&&O(k)),Z.__cacheKey=ze,Z.__webglTexture=He[ze].texture}return pe}function Ie(Z,k,pe){return Math.floor(Math.floor(Z/pe)/k)}function ut(Z,k,pe,Fe){const ze=Z.updateRanges;if(ze.length===0)t.texSubImage2D(r.TEXTURE_2D,0,0,0,k.width,k.height,pe,Fe,k.data);else{ze.sort((st,nt)=>st.start-nt.start);let Bt=0;for(let st=1;st<ze.length;st++){const nt=ze[Bt],Pt=ze[st],ue=nt.start+nt.count,Re=Ie(Pt.start,k.width,4),dt=Ie(nt.start,k.width,4);Pt.start<=ue+1&&Re===dt&&Ie(Pt.start+Pt.count-1,k.width,4)===Re?nt.count=Math.max(nt.count,Pt.start+Pt.count-nt.start):(++Bt,ze[Bt]=Pt)}ze.length=Bt+1;const Ct=r.getParameter(r.UNPACK_ROW_LENGTH),Yt=r.getParameter(r.UNPACK_SKIP_PIXELS),$t=r.getParameter(r.UNPACK_SKIP_ROWS);r.pixelStorei(r.UNPACK_ROW_LENGTH,k.width);for(let st=0,nt=ze.length;st<nt;st++){const Pt=ze[st],ue=Math.floor(Pt.start/4),Re=Math.ceil(Pt.count/4),dt=ue%k.width,le=Math.floor(ue/k.width),Be=Re,lt=1;r.pixelStorei(r.UNPACK_SKIP_PIXELS,dt),r.pixelStorei(r.UNPACK_SKIP_ROWS,le),t.texSubImage2D(r.TEXTURE_2D,0,dt,le,Be,lt,pe,Fe,k.data)}Z.clearUpdateRanges(),r.pixelStorei(r.UNPACK_ROW_LENGTH,Ct),r.pixelStorei(r.UNPACK_SKIP_PIXELS,Yt),r.pixelStorei(r.UNPACK_SKIP_ROWS,$t)}}function Ee(Z,k,pe){let Fe=r.TEXTURE_2D;(k.isDataArrayTexture||k.isCompressedArrayTexture)&&(Fe=r.TEXTURE_2D_ARRAY),k.isData3DTexture&&(Fe=r.TEXTURE_3D);const He=Ce(Z,k),ze=k.source;t.bindTexture(Fe,Z.__webglTexture,r.TEXTURE0+pe);const Bt=n.get(ze);if(ze.version!==Bt.__version||He===!0){t.activeTexture(r.TEXTURE0+pe);const Ct=Nn.getPrimaries(Nn.workingColorSpace),Yt=k.colorSpace===Jo?null:Nn.getPrimaries(k.colorSpace),$t=k.colorSpace===Jo||Ct===Yt?r.NONE:r.BROWSER_DEFAULT_WEBGL;r.pixelStorei(r.UNPACK_FLIP_Y_WEBGL,k.flipY),r.pixelStorei(r.UNPACK_PREMULTIPLY_ALPHA_WEBGL,k.premultiplyAlpha),r.pixelStorei(r.UNPACK_ALIGNMENT,k.unpackAlignment),r.pixelStorei(r.UNPACK_COLORSPACE_CONVERSION_WEBGL,$t);let st=b(k.image,!1,i.maxTextureSize);st=zt(k,st);const nt=s.convert(k.format,k.colorSpace),Pt=s.convert(k.type);let ue=R(k.internalFormat,nt,Pt,k.colorSpace,k.isVideoTexture);he(Fe,k);let Re;const dt=k.mipmaps,le=k.isVideoTexture!==!0,Be=Bt.__version===void 0||He===!0,lt=ze.dataReady,Ot=P(k,st);if(k.isDepthTexture)ue=N(k.format===ho,k.type),Be&&(le?t.texStorage2D(r.TEXTURE_2D,1,ue,st.width,st.height):t.texImage2D(r.TEXTURE_2D,0,ue,st.width,st.height,0,nt,Pt,null));else if(k.isDataTexture)if(dt.length>0){le&&Be&&t.texStorage2D(r.TEXTURE_2D,Ot,ue,dt[0].width,dt[0].height);for(let ht=0,it=dt.length;ht<it;ht++)Re=dt[ht],le?lt&&t.texSubImage2D(r.TEXTURE_2D,ht,0,0,Re.width,Re.height,nt,Pt,Re.data):t.texImage2D(r.TEXTURE_2D,ht,ue,Re.width,Re.height,0,nt,Pt,Re.data);k.generateMipmaps=!1}else le?(Be&&t.texStorage2D(r.TEXTURE_2D,Ot,ue,st.width,st.height),lt&&ut(k,st,nt,Pt)):t.texImage2D(r.TEXTURE_2D,0,ue,st.width,st.height,0,nt,Pt,st.data);else if(k.isCompressedTexture)if(k.isCompressedArrayTexture){le&&Be&&t.texStorage3D(r.TEXTURE_2D_ARRAY,Ot,ue,dt[0].width,dt[0].height,st.depth);for(let ht=0,it=dt.length;ht<it;ht++)if(Re=dt[ht],k.format!==Qi)if(nt!==null)if(le){if(lt)if(k.layerUpdates.size>0){const Tt=iR(Re.width,Re.height,k.format,k.type);for(const ln of k.layerUpdates){const jn=Re.data.subarray(ln*Tt/Re.data.BYTES_PER_ELEMENT,(ln+1)*Tt/Re.data.BYTES_PER_ELEMENT);t.compressedTexSubImage3D(r.TEXTURE_2D_ARRAY,ht,0,0,ln,Re.width,Re.height,1,nt,jn)}k.clearLayerUpdates()}else t.compressedTexSubImage3D(r.TEXTURE_2D_ARRAY,ht,0,0,0,Re.width,Re.height,st.depth,nt,Re.data)}else t.compressedTexImage3D(r.TEXTURE_2D_ARRAY,ht,ue,Re.width,Re.height,st.depth,0,Re.data,0,0);else Ve("WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()");else le?lt&&t.texSubImage3D(r.TEXTURE_2D_ARRAY,ht,0,0,0,Re.width,Re.height,st.depth,nt,Pt,Re.data):t.texImage3D(r.TEXTURE_2D_ARRAY,ht,ue,Re.width,Re.height,st.depth,0,nt,Pt,Re.data)}else{le&&Be&&t.texStorage2D(r.TEXTURE_2D,Ot,ue,dt[0].width,dt[0].height);for(let ht=0,it=dt.length;ht<it;ht++)Re=dt[ht],k.format!==Qi?nt!==null?le?lt&&t.compressedTexSubImage2D(r.TEXTURE_2D,ht,0,0,Re.width,Re.height,nt,Re.data):t.compressedTexImage2D(r.TEXTURE_2D,ht,ue,Re.width,Re.height,0,Re.data):Ve("WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):le?lt&&t.texSubImage2D(r.TEXTURE_2D,ht,0,0,Re.width,Re.height,nt,Pt,Re.data):t.texImage2D(r.TEXTURE_2D,ht,ue,Re.width,Re.height,0,nt,Pt,Re.data)}else if(k.isDataArrayTexture)if(le){if(Be&&t.texStorage3D(r.TEXTURE_2D_ARRAY,Ot,ue,st.width,st.height,st.depth),lt)if(k.layerUpdates.size>0){const ht=iR(st.width,st.height,k.format,k.type);for(const it of k.layerUpdates){const Tt=st.data.subarray(it*ht/st.data.BYTES_PER_ELEMENT,(it+1)*ht/st.data.BYTES_PER_ELEMENT);t.texSubImage3D(r.TEXTURE_2D_ARRAY,0,0,0,it,st.width,st.height,1,nt,Pt,Tt)}k.clearLayerUpdates()}else t.texSubImage3D(r.TEXTURE_2D_ARRAY,0,0,0,0,st.width,st.height,st.depth,nt,Pt,st.data)}else t.texImage3D(r.TEXTURE_2D_ARRAY,0,ue,st.width,st.height,st.depth,0,nt,Pt,st.data);else if(k.isData3DTexture)le?(Be&&t.texStorage3D(r.TEXTURE_3D,Ot,ue,st.width,st.height,st.depth),lt&&t.texSubImage3D(r.TEXTURE_3D,0,0,0,0,st.width,st.height,st.depth,nt,Pt,st.data)):t.texImage3D(r.TEXTURE_3D,0,ue,st.width,st.height,st.depth,0,nt,Pt,st.data);else if(k.isFramebufferTexture){if(Be)if(le)t.texStorage2D(r.TEXTURE_2D,Ot,ue,st.width,st.height);else{let ht=st.width,it=st.height;for(let Tt=0;Tt<Ot;Tt++)t.texImage2D(r.TEXTURE_2D,Tt,ue,ht,it,0,nt,Pt,null),ht>>=1,it>>=1}}else if(dt.length>0){if(le&&Be){const ht=wt(dt[0]);t.texStorage2D(r.TEXTURE_2D,Ot,ue,ht.width,ht.height)}for(let ht=0,it=dt.length;ht<it;ht++)Re=dt[ht],le?lt&&t.texSubImage2D(r.TEXTURE_2D,ht,0,0,nt,Pt,Re):t.texImage2D(r.TEXTURE_2D,ht,ue,nt,Pt,Re);k.generateMipmaps=!1}else if(le){if(Be){const ht=wt(st);t.texStorage2D(r.TEXTURE_2D,Ot,ue,ht.width,ht.height)}lt&&t.texSubImage2D(r.TEXTURE_2D,0,0,0,nt,Pt,st)}else t.texImage2D(r.TEXTURE_2D,0,ue,nt,Pt,st);E(k)&&T(Fe),Bt.__version=ze.version,k.onUpdate&&k.onUpdate(k)}Z.__version=k.version}function Ne(Z,k,pe){if(k.image.length!==6)return;const Fe=Ce(Z,k),He=k.source;t.bindTexture(r.TEXTURE_CUBE_MAP,Z.__webglTexture,r.TEXTURE0+pe);const ze=n.get(He);if(He.version!==ze.__version||Fe===!0){t.activeTexture(r.TEXTURE0+pe);const Bt=Nn.getPrimaries(Nn.workingColorSpace),Ct=k.colorSpace===Jo?null:Nn.getPrimaries(k.colorSpace),Yt=k.colorSpace===Jo||Bt===Ct?r.NONE:r.BROWSER_DEFAULT_WEBGL;r.pixelStorei(r.UNPACK_FLIP_Y_WEBGL,k.flipY),r.pixelStorei(r.UNPACK_PREMULTIPLY_ALPHA_WEBGL,k.premultiplyAlpha),r.pixelStorei(r.UNPACK_ALIGNMENT,k.unpackAlignment),r.pixelStorei(r.UNPACK_COLORSPACE_CONVERSION_WEBGL,Yt);const $t=k.isCompressedTexture||k.image[0].isCompressedTexture,st=k.image[0]&&k.image[0].isDataTexture,nt=[];for(let it=0;it<6;it++)!$t&&!st?nt[it]=b(k.image[it],!0,i.maxCubemapSize):nt[it]=st?k.image[it].image:k.image[it],nt[it]=zt(k,nt[it]);const Pt=nt[0],ue=s.convert(k.format,k.colorSpace),Re=s.convert(k.type),dt=R(k.internalFormat,ue,Re,k.colorSpace),le=k.isVideoTexture!==!0,Be=ze.__version===void 0||Fe===!0,lt=He.dataReady;let Ot=P(k,Pt);he(r.TEXTURE_CUBE_MAP,k);let ht;if($t){le&&Be&&t.texStorage2D(r.TEXTURE_CUBE_MAP,Ot,dt,Pt.width,Pt.height);for(let it=0;it<6;it++){ht=nt[it].mipmaps;for(let Tt=0;Tt<ht.length;Tt++){const ln=ht[Tt];k.format!==Qi?ue!==null?le?lt&&t.compressedTexSubImage2D(r.TEXTURE_CUBE_MAP_POSITIVE_X+it,Tt,0,0,ln.width,ln.height,ue,ln.data):t.compressedTexImage2D(r.TEXTURE_CUBE_MAP_POSITIVE_X+it,Tt,dt,ln.width,ln.height,0,ln.data):Ve("WebGLRenderer: Attempt to load unsupported compressed texture format in .setTextureCube()"):le?lt&&t.texSubImage2D(r.TEXTURE_CUBE_MAP_POSITIVE_X+it,Tt,0,0,ln.width,ln.height,ue,Re,ln.data):t.texImage2D(r.TEXTURE_CUBE_MAP_POSITIVE_X+it,Tt,dt,ln.width,ln.height,0,ue,Re,ln.data)}}}else{if(ht=k.mipmaps,le&&Be){ht.length>0&&Ot++;const it=wt(nt[0]);t.texStorage2D(r.TEXTURE_CUBE_MAP,Ot,dt,it.width,it.height)}for(let it=0;it<6;it++)if(st){le?lt&&t.texSubImage2D(r.TEXTURE_CUBE_MAP_POSITIVE_X+it,0,0,0,nt[it].width,nt[it].height,ue,Re,nt[it].data):t.texImage2D(r.TEXTURE_CUBE_MAP_POSITIVE_X+it,0,dt,nt[it].width,nt[it].height,0,ue,Re,nt[it].data);for(let Tt=0;Tt<ht.length;Tt++){const jn=ht[Tt].image[it].image;le?lt&&t.texSubImage2D(r.TEXTURE_CUBE_MAP_POSITIVE_X+it,Tt+1,0,0,jn.width,jn.height,ue,Re,jn.data):t.texImage2D(r.TEXTURE_CUBE_MAP_POSITIVE_X+it,Tt+1,dt,jn.width,jn.height,0,ue,Re,jn.data)}}else{le?lt&&t.texSubImage2D(r.TEXTURE_CUBE_MAP_POSITIVE_X+it,0,0,0,ue,Re,nt[it]):t.texImage2D(r.TEXTURE_CUBE_MAP_POSITIVE_X+it,0,dt,ue,Re,nt[it]);for(let Tt=0;Tt<ht.length;Tt++){const ln=ht[Tt];le?lt&&t.texSubImage2D(r.TEXTURE_CUBE_MAP_POSITIVE_X+it,Tt+1,0,0,ue,Re,ln.image[it]):t.texImage2D(r.TEXTURE_CUBE_MAP_POSITIVE_X+it,Tt+1,dt,ue,Re,ln.image[it])}}}E(k)&&T(r.TEXTURE_CUBE_MAP),ze.__version=He.version,k.onUpdate&&k.onUpdate(k)}Z.__version=k.version}function rt(Z,k,pe,Fe,He,ze){const Bt=s.convert(pe.format,pe.colorSpace),Ct=s.convert(pe.type),Yt=R(pe.internalFormat,Bt,Ct,pe.colorSpace),$t=n.get(k),st=n.get(pe);if(st.__renderTarget=k,!$t.__hasExternalTextures){const nt=Math.max(1,k.width>>ze),Pt=Math.max(1,k.height>>ze);He===r.TEXTURE_3D||He===r.TEXTURE_2D_ARRAY?t.texImage3D(He,ze,Yt,nt,Pt,k.depth,0,Bt,Ct,null):t.texImage2D(He,ze,Yt,nt,Pt,0,Bt,Ct,null)}t.bindFramebuffer(r.FRAMEBUFFER,Z),Qt(k)?o.framebufferTexture2DMultisampleEXT(r.FRAMEBUFFER,Fe,He,st.__webglTexture,0,oe(k)):(He===r.TEXTURE_2D||He>=r.TEXTURE_CUBE_MAP_POSITIVE_X&&He<=r.TEXTURE_CUBE_MAP_NEGATIVE_Z)&&r.framebufferTexture2D(r.FRAMEBUFFER,Fe,He,st.__webglTexture,ze),t.bindFramebuffer(r.FRAMEBUFFER,null)}function Nt(Z,k,pe){if(r.bindRenderbuffer(r.RENDERBUFFER,Z),k.depthBuffer){const Fe=k.depthTexture,He=Fe&&Fe.isDepthTexture?Fe.type:null,ze=N(k.stencilBuffer,He),Bt=k.stencilBuffer?r.DEPTH_STENCIL_ATTACHMENT:r.DEPTH_ATTACHMENT;Qt(k)?o.renderbufferStorageMultisampleEXT(r.RENDERBUFFER,oe(k),ze,k.width,k.height):pe?r.renderbufferStorageMultisample(r.RENDERBUFFER,oe(k),ze,k.width,k.height):r.renderbufferStorage(r.RENDERBUFFER,ze,k.width,k.height),r.framebufferRenderbuffer(r.FRAMEBUFFER,Bt,r.RENDERBUFFER,Z)}else{const Fe=k.textures;for(let He=0;He<Fe.length;He++){const ze=Fe[He],Bt=s.convert(ze.format,ze.colorSpace),Ct=s.convert(ze.type),Yt=R(ze.internalFormat,Bt,Ct,ze.colorSpace);Qt(k)?o.renderbufferStorageMultisampleEXT(r.RENDERBUFFER,oe(k),Yt,k.width,k.height):pe?r.renderbufferStorageMultisample(r.RENDERBUFFER,oe(k),Yt,k.width,k.height):r.renderbufferStorage(r.RENDERBUFFER,Yt,k.width,k.height)}}r.bindRenderbuffer(r.RENDERBUFFER,null)}function Ft(Z,k,pe){const Fe=k.isWebGLCubeRenderTarget===!0;if(t.bindFramebuffer(r.FRAMEBUFFER,Z),!(k.depthTexture&&k.depthTexture.isDepthTexture))throw new Error("renderTarget.depthTexture must be an instance of THREE.DepthTexture");const He=n.get(k.depthTexture);if(He.__renderTarget=k,(!He.__webglTexture||k.depthTexture.image.width!==k.width||k.depthTexture.image.height!==k.height)&&(k.depthTexture.image.width=k.width,k.depthTexture.image.height=k.height,k.depthTexture.needsUpdate=!0),Fe){if(He.__webglInit===void 0&&(He.__webglInit=!0,k.depthTexture.addEventListener("dispose",U)),He.__webglTexture===void 0){He.__webglTexture=r.createTexture(),t.bindTexture(r.TEXTURE_CUBE_MAP,He.__webglTexture),he(r.TEXTURE_CUBE_MAP,k.depthTexture);const $t=s.convert(k.depthTexture.format),st=s.convert(k.depthTexture.type);let nt;k.depthTexture.format===ba?nt=r.DEPTH_COMPONENT24:k.depthTexture.format===ho&&(nt=r.DEPTH24_STENCIL8);for(let Pt=0;Pt<6;Pt++)r.texImage2D(r.TEXTURE_CUBE_MAP_POSITIVE_X+Pt,0,nt,k.width,k.height,0,$t,st,null)}}else ae(k.depthTexture,0);const ze=He.__webglTexture,Bt=oe(k),Ct=Fe?r.TEXTURE_CUBE_MAP_POSITIVE_X+pe:r.TEXTURE_2D,Yt=k.depthTexture.format===ho?r.DEPTH_STENCIL_ATTACHMENT:r.DEPTH_ATTACHMENT;if(k.depthTexture.format===ba)Qt(k)?o.framebufferTexture2DMultisampleEXT(r.FRAMEBUFFER,Yt,Ct,ze,0,Bt):r.framebufferTexture2D(r.FRAMEBUFFER,Yt,Ct,ze,0);else if(k.depthTexture.format===ho)Qt(k)?o.framebufferTexture2DMultisampleEXT(r.FRAMEBUFFER,Yt,Ct,ze,0,Bt):r.framebufferTexture2D(r.FRAMEBUFFER,Yt,Ct,ze,0);else throw new Error("Unknown depthTexture format")}function fn(Z){const k=n.get(Z),pe=Z.isWebGLCubeRenderTarget===!0;if(k.__boundDepthTexture!==Z.depthTexture){const Fe=Z.depthTexture;if(k.__depthDisposeCallback&&k.__depthDisposeCallback(),Fe){const He=()=>{delete k.__boundDepthTexture,delete k.__depthDisposeCallback,Fe.removeEventListener("dispose",He)};Fe.addEventListener("dispose",He),k.__depthDisposeCallback=He}k.__boundDepthTexture=Fe}if(Z.depthTexture&&!k.__autoAllocateDepthBuffer)if(pe)for(let Fe=0;Fe<6;Fe++)Ft(k.__webglFramebuffer[Fe],Z,Fe);else{const Fe=Z.texture.mipmaps;Fe&&Fe.length>0?Ft(k.__webglFramebuffer[0],Z,0):Ft(k.__webglFramebuffer,Z,0)}else if(pe){k.__webglDepthbuffer=[];for(let Fe=0;Fe<6;Fe++)if(t.bindFramebuffer(r.FRAMEBUFFER,k.__webglFramebuffer[Fe]),k.__webglDepthbuffer[Fe]===void 0)k.__webglDepthbuffer[Fe]=r.createRenderbuffer(),Nt(k.__webglDepthbuffer[Fe],Z,!1);else{const He=Z.stencilBuffer?r.DEPTH_STENCIL_ATTACHMENT:r.DEPTH_ATTACHMENT,ze=k.__webglDepthbuffer[Fe];r.bindRenderbuffer(r.RENDERBUFFER,ze),r.framebufferRenderbuffer(r.FRAMEBUFFER,He,r.RENDERBUFFER,ze)}}else{const Fe=Z.texture.mipmaps;if(Fe&&Fe.length>0?t.bindFramebuffer(r.FRAMEBUFFER,k.__webglFramebuffer[0]):t.bindFramebuffer(r.FRAMEBUFFER,k.__webglFramebuffer),k.__webglDepthbuffer===void 0)k.__webglDepthbuffer=r.createRenderbuffer(),Nt(k.__webglDepthbuffer,Z,!1);else{const He=Z.stencilBuffer?r.DEPTH_STENCIL_ATTACHMENT:r.DEPTH_ATTACHMENT,ze=k.__webglDepthbuffer;r.bindRenderbuffer(r.RENDERBUFFER,ze),r.framebufferRenderbuffer(r.FRAMEBUFFER,He,r.RENDERBUFFER,ze)}}t.bindFramebuffer(r.FRAMEBUFFER,null)}function Sn(Z,k,pe){const Fe=n.get(Z);k!==void 0&&rt(Fe.__webglFramebuffer,Z,Z.texture,r.COLOR_ATTACHMENT0,r.TEXTURE_2D,0),pe!==void 0&&fn(Z)}function At(Z){const k=Z.texture,pe=n.get(Z),Fe=n.get(k);Z.addEventListener("dispose",L);const He=Z.textures,ze=Z.isWebGLCubeRenderTarget===!0,Bt=He.length>1;if(Bt||(Fe.__webglTexture===void 0&&(Fe.__webglTexture=r.createTexture()),Fe.__version=k.version,a.memory.textures++),ze){pe.__webglFramebuffer=[];for(let Ct=0;Ct<6;Ct++)if(k.mipmaps&&k.mipmaps.length>0){pe.__webglFramebuffer[Ct]=[];for(let Yt=0;Yt<k.mipmaps.length;Yt++)pe.__webglFramebuffer[Ct][Yt]=r.createFramebuffer()}else pe.__webglFramebuffer[Ct]=r.createFramebuffer()}else{if(k.mipmaps&&k.mipmaps.length>0){pe.__webglFramebuffer=[];for(let Ct=0;Ct<k.mipmaps.length;Ct++)pe.__webglFramebuffer[Ct]=r.createFramebuffer()}else pe.__webglFramebuffer=r.createFramebuffer();if(Bt)for(let Ct=0,Yt=He.length;Ct<Yt;Ct++){const $t=n.get(He[Ct]);$t.__webglTexture===void 0&&($t.__webglTexture=r.createTexture(),a.memory.textures++)}if(Z.samples>0&&Qt(Z)===!1){pe.__webglMultisampledFramebuffer=r.createFramebuffer(),pe.__webglColorRenderbuffer=[],t.bindFramebuffer(r.FRAMEBUFFER,pe.__webglMultisampledFramebuffer);for(let Ct=0;Ct<He.length;Ct++){const Yt=He[Ct];pe.__webglColorRenderbuffer[Ct]=r.createRenderbuffer(),r.bindRenderbuffer(r.RENDERBUFFER,pe.__webglColorRenderbuffer[Ct]);const $t=s.convert(Yt.format,Yt.colorSpace),st=s.convert(Yt.type),nt=R(Yt.internalFormat,$t,st,Yt.colorSpace,Z.isXRRenderTarget===!0),Pt=oe(Z);r.renderbufferStorageMultisample(r.RENDERBUFFER,Pt,nt,Z.width,Z.height),r.framebufferRenderbuffer(r.FRAMEBUFFER,r.COLOR_ATTACHMENT0+Ct,r.RENDERBUFFER,pe.__webglColorRenderbuffer[Ct])}r.bindRenderbuffer(r.RENDERBUFFER,null),Z.depthBuffer&&(pe.__webglDepthRenderbuffer=r.createRenderbuffer(),Nt(pe.__webglDepthRenderbuffer,Z,!0)),t.bindFramebuffer(r.FRAMEBUFFER,null)}}if(ze){t.bindTexture(r.TEXTURE_CUBE_MAP,Fe.__webglTexture),he(r.TEXTURE_CUBE_MAP,k);for(let Ct=0;Ct<6;Ct++)if(k.mipmaps&&k.mipmaps.length>0)for(let Yt=0;Yt<k.mipmaps.length;Yt++)rt(pe.__webglFramebuffer[Ct][Yt],Z,k,r.COLOR_ATTACHMENT0,r.TEXTURE_CUBE_MAP_POSITIVE_X+Ct,Yt);else rt(pe.__webglFramebuffer[Ct],Z,k,r.COLOR_ATTACHMENT0,r.TEXTURE_CUBE_MAP_POSITIVE_X+Ct,0);E(k)&&T(r.TEXTURE_CUBE_MAP),t.unbindTexture()}else if(Bt){for(let Ct=0,Yt=He.length;Ct<Yt;Ct++){const $t=He[Ct],st=n.get($t);let nt=r.TEXTURE_2D;(Z.isWebGL3DRenderTarget||Z.isWebGLArrayRenderTarget)&&(nt=Z.isWebGL3DRenderTarget?r.TEXTURE_3D:r.TEXTURE_2D_ARRAY),t.bindTexture(nt,st.__webglTexture),he(nt,$t),rt(pe.__webglFramebuffer,Z,$t,r.COLOR_ATTACHMENT0+Ct,nt,0),E($t)&&T(nt)}t.unbindTexture()}else{let Ct=r.TEXTURE_2D;if((Z.isWebGL3DRenderTarget||Z.isWebGLArrayRenderTarget)&&(Ct=Z.isWebGL3DRenderTarget?r.TEXTURE_3D:r.TEXTURE_2D_ARRAY),t.bindTexture(Ct,Fe.__webglTexture),he(Ct,k),k.mipmaps&&k.mipmaps.length>0)for(let Yt=0;Yt<k.mipmaps.length;Yt++)rt(pe.__webglFramebuffer[Yt],Z,k,r.COLOR_ATTACHMENT0,Ct,Yt);else rt(pe.__webglFramebuffer,Z,k,r.COLOR_ATTACHMENT0,Ct,0);E(k)&&T(Ct),t.unbindTexture()}Z.depthBuffer&&fn(Z)}function qe(Z){const k=Z.textures;for(let pe=0,Fe=k.length;pe<Fe;pe++){const He=k[pe];if(E(He)){const ze=M(Z),Bt=n.get(He).__webglTexture;t.bindTexture(ze,Bt),T(ze),t.unbindTexture()}}}const at=[],Je=[];function xe(Z){if(Z.samples>0){if(Qt(Z)===!1){const k=Z.textures,pe=Z.width,Fe=Z.height;let He=r.COLOR_BUFFER_BIT;const ze=Z.stencilBuffer?r.DEPTH_STENCIL_ATTACHMENT:r.DEPTH_ATTACHMENT,Bt=n.get(Z),Ct=k.length>1;if(Ct)for(let $t=0;$t<k.length;$t++)t.bindFramebuffer(r.FRAMEBUFFER,Bt.__webglMultisampledFramebuffer),r.framebufferRenderbuffer(r.FRAMEBUFFER,r.COLOR_ATTACHMENT0+$t,r.RENDERBUFFER,null),t.bindFramebuffer(r.FRAMEBUFFER,Bt.__webglFramebuffer),r.framebufferTexture2D(r.DRAW_FRAMEBUFFER,r.COLOR_ATTACHMENT0+$t,r.TEXTURE_2D,null,0);t.bindFramebuffer(r.READ_FRAMEBUFFER,Bt.__webglMultisampledFramebuffer);const Yt=Z.texture.mipmaps;Yt&&Yt.length>0?t.bindFramebuffer(r.DRAW_FRAMEBUFFER,Bt.__webglFramebuffer[0]):t.bindFramebuffer(r.DRAW_FRAMEBUFFER,Bt.__webglFramebuffer);for(let $t=0;$t<k.length;$t++){if(Z.resolveDepthBuffer&&(Z.depthBuffer&&(He|=r.DEPTH_BUFFER_BIT),Z.stencilBuffer&&Z.resolveStencilBuffer&&(He|=r.STENCIL_BUFFER_BIT)),Ct){r.framebufferRenderbuffer(r.READ_FRAMEBUFFER,r.COLOR_ATTACHMENT0,r.RENDERBUFFER,Bt.__webglColorRenderbuffer[$t]);const st=n.get(k[$t]).__webglTexture;r.framebufferTexture2D(r.DRAW_FRAMEBUFFER,r.COLOR_ATTACHMENT0,r.TEXTURE_2D,st,0)}r.blitFramebuffer(0,0,pe,Fe,0,0,pe,Fe,He,r.NEAREST),l===!0&&(at.length=0,Je.length=0,at.push(r.COLOR_ATTACHMENT0+$t),Z.depthBuffer&&Z.resolveDepthBuffer===!1&&(at.push(ze),Je.push(ze),r.invalidateFramebuffer(r.DRAW_FRAMEBUFFER,Je)),r.invalidateFramebuffer(r.READ_FRAMEBUFFER,at))}if(t.bindFramebuffer(r.READ_FRAMEBUFFER,null),t.bindFramebuffer(r.DRAW_FRAMEBUFFER,null),Ct)for(let $t=0;$t<k.length;$t++){t.bindFramebuffer(r.FRAMEBUFFER,Bt.__webglMultisampledFramebuffer),r.framebufferRenderbuffer(r.FRAMEBUFFER,r.COLOR_ATTACHMENT0+$t,r.RENDERBUFFER,Bt.__webglColorRenderbuffer[$t]);const st=n.get(k[$t]).__webglTexture;t.bindFramebuffer(r.FRAMEBUFFER,Bt.__webglFramebuffer),r.framebufferTexture2D(r.DRAW_FRAMEBUFFER,r.COLOR_ATTACHMENT0+$t,r.TEXTURE_2D,st,0)}t.bindFramebuffer(r.DRAW_FRAMEBUFFER,Bt.__webglMultisampledFramebuffer)}else if(Z.depthBuffer&&Z.resolveDepthBuffer===!1&&l){const k=Z.stencilBuffer?r.DEPTH_STENCIL_ATTACHMENT:r.DEPTH_ATTACHMENT;r.invalidateFramebuffer(r.DRAW_FRAMEBUFFER,[k])}}}function oe(Z){return Math.min(i.maxSamples,Z.samples)}function Qt(Z){const k=n.get(Z);return Z.samples>0&&e.has("WEBGL_multisampled_render_to_texture")===!0&&k.__useRenderToTexture!==!1}function Dt(Z){const k=a.render.frame;d.get(Z)!==k&&(d.set(Z,k),Z.update())}function zt(Z,k){const pe=Z.colorSpace,Fe=Z.format,He=Z.type;return Z.isCompressedTexture===!0||Z.isVideoTexture===!0||pe!==vu&&pe!==Jo&&(Nn.getTransfer(pe)===an?(Fe!==Qi||He!==ir)&&Ve("WebGLTextures: sRGB encoded textures have to use RGBAFormat and UnsignedByteType."):Ze("WebGLTextures: Unsupported texture color space:",pe)),k}function wt(Z){return typeof HTMLImageElement<"u"&&Z instanceof HTMLImageElement?(c.width=Z.naturalWidth||Z.width,c.height=Z.naturalHeight||Z.height):typeof VideoFrame<"u"&&Z instanceof VideoFrame?(c.width=Z.displayWidth,c.height=Z.displayHeight):(c.width=Z.width,c.height=Z.height),c}this.allocateTextureUnit=Q,this.resetTextureUnits=j,this.setTexture2D=ae,this.setTexture2DArray=V,this.setTexture3D=X,this.setTextureCube=ee,this.rebindTextures=Sn,this.setupRenderTarget=At,this.updateRenderTargetMipmap=qe,this.updateMultisampleRenderTarget=xe,this.setupDepthRenderbuffer=fn,this.setupFrameBufferTexture=rt,this.useMultisampledRTT=Qt,this.isReversedDepthBuffer=function(){return t.buffers.depth.getReversed()}}function I6(r,e){function t(n,i=Jo){let s;const a=Nn.getTransfer(i);if(n===ir)return r.UNSIGNED_BYTE;if(n===B1)return r.UNSIGNED_SHORT_4_4_4_4;if(n===I1)return r.UNSIGNED_SHORT_5_5_5_1;if(n===F1)return r.UNSIGNED_INT_5_9_9_9_REV;if(n===z1)return r.UNSIGNED_INT_10F_11F_11F_REV;if(n===_h)return r.BYTE;if(n===vh)return r.SHORT;if(n===Zu)return r.UNSIGNED_SHORT;if(n===Hs)return r.INT;if(n===Hi)return r.UNSIGNED_INT;if(n===Ci)return r.FLOAT;if(n===vi)return r.HALF_FLOAT;if(n===mC)return r.ALPHA;if(n===Fx)return r.RGB;if(n===Qi)return r.RGBA;if(n===ba)return r.DEPTH_COMPONENT;if(n===ho)return r.DEPTH_STENCIL;if(n===Pm)return r.RED;if(n===Bm)return r.RED_INTEGER;if(n===po)return r.RG;if(n===My)return r.RG_INTEGER;if(n===Ay)return r.RGBA_INTEGER;if(n===xh||n===bh||n===Sh||n===Th)if(a===an)if(s=e.get("WEBGL_compressed_texture_s3tc_srgb"),s!==null){if(n===xh)return s.COMPRESSED_SRGB_S3TC_DXT1_EXT;if(n===bh)return s.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT;if(n===Sh)return s.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT;if(n===Th)return s.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT}else return null;else if(s=e.get("WEBGL_compressed_texture_s3tc"),s!==null){if(n===xh)return s.COMPRESSED_RGB_S3TC_DXT1_EXT;if(n===bh)return s.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(n===Sh)return s.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(n===Th)return s.COMPRESSED_RGBA_S3TC_DXT5_EXT}else return null;if(n===fx||n===dx||n===hx||n===px)if(s=e.get("WEBGL_compressed_texture_pvrtc"),s!==null){if(n===fx)return s.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(n===dx)return s.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(n===hx)return s.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(n===px)return s.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}else return null;if(n===H0||n===W0||n===q0||n===X0||n===$0||n===_m||n===j0)if(s=e.get("WEBGL_compressed_texture_etc"),s!==null){if(n===H0||n===W0)return a===an?s.COMPRESSED_SRGB8_ETC2:s.COMPRESSED_RGB8_ETC2;if(n===q0)return a===an?s.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC:s.COMPRESSED_RGBA8_ETC2_EAC;if(n===X0)return s.COMPRESSED_R11_EAC;if(n===$0)return s.COMPRESSED_SIGNED_R11_EAC;if(n===_m)return s.COMPRESSED_RG11_EAC;if(n===j0)return s.COMPRESSED_SIGNED_RG11_EAC}else return null;if(n===Y0||n===Z0||n===K0||n===Q0||n===J0||n===ey||n===ty||n===ny||n===iy||n===ry||n===sy||n===ay||n===oy||n===ly)if(s=e.get("WEBGL_compressed_texture_astc"),s!==null){if(n===Y0)return a===an?s.COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR:s.COMPRESSED_RGBA_ASTC_4x4_KHR;if(n===Z0)return a===an?s.COMPRESSED_SRGB8_ALPHA8_ASTC_5x4_KHR:s.COMPRESSED_RGBA_ASTC_5x4_KHR;if(n===K0)return a===an?s.COMPRESSED_SRGB8_ALPHA8_ASTC_5x5_KHR:s.COMPRESSED_RGBA_ASTC_5x5_KHR;if(n===Q0)return a===an?s.COMPRESSED_SRGB8_ALPHA8_ASTC_6x5_KHR:s.COMPRESSED_RGBA_ASTC_6x5_KHR;if(n===J0)return a===an?s.COMPRESSED_SRGB8_ALPHA8_ASTC_6x6_KHR:s.COMPRESSED_RGBA_ASTC_6x6_KHR;if(n===ey)return a===an?s.COMPRESSED_SRGB8_ALPHA8_ASTC_8x5_KHR:s.COMPRESSED_RGBA_ASTC_8x5_KHR;if(n===ty)return a===an?s.COMPRESSED_SRGB8_ALPHA8_ASTC_8x6_KHR:s.COMPRESSED_RGBA_ASTC_8x6_KHR;if(n===ny)return a===an?s.COMPRESSED_SRGB8_ALPHA8_ASTC_8x8_KHR:s.COMPRESSED_RGBA_ASTC_8x8_KHR;if(n===iy)return a===an?s.COMPRESSED_SRGB8_ALPHA8_ASTC_10x5_KHR:s.COMPRESSED_RGBA_ASTC_10x5_KHR;if(n===ry)return a===an?s.COMPRESSED_SRGB8_ALPHA8_ASTC_10x6_KHR:s.COMPRESSED_RGBA_ASTC_10x6_KHR;if(n===sy)return a===an?s.COMPRESSED_SRGB8_ALPHA8_ASTC_10x8_KHR:s.COMPRESSED_RGBA_ASTC_10x8_KHR;if(n===ay)return a===an?s.COMPRESSED_SRGB8_ALPHA8_ASTC_10x10_KHR:s.COMPRESSED_RGBA_ASTC_10x10_KHR;if(n===oy)return a===an?s.COMPRESSED_SRGB8_ALPHA8_ASTC_12x10_KHR:s.COMPRESSED_RGBA_ASTC_12x10_KHR;if(n===ly)return a===an?s.COMPRESSED_SRGB8_ALPHA8_ASTC_12x12_KHR:s.COMPRESSED_RGBA_ASTC_12x12_KHR}else return null;if(n===uy||n===Yw||n===Zw)if(s=e.get("EXT_texture_compression_bptc"),s!==null){if(n===uy)return a===an?s.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT:s.COMPRESSED_RGBA_BPTC_UNORM_EXT;if(n===Yw)return s.COMPRESSED_RGB_BPTC_SIGNED_FLOAT_EXT;if(n===Zw)return s.COMPRESSED_RGB_BPTC_UNSIGNED_FLOAT_EXT}else return null;if(n===cy||n===fy||n===vm||n===dy)if(s=e.get("EXT_texture_compression_rgtc"),s!==null){if(n===cy)return s.COMPRESSED_RED_RGTC1_EXT;if(n===fy)return s.COMPRESSED_SIGNED_RED_RGTC1_EXT;if(n===vm)return s.COMPRESSED_RED_GREEN_RGTC2_EXT;if(n===dy)return s.COMPRESSED_SIGNED_RED_GREEN_RGTC2_EXT}else return null;return n===Dl?r.UNSIGNED_INT_24_8:r[n]!==void 0?r[n]:null}return{convert:t}}const Lie=`
void main() {

	gl_Position = vec4( position, 1.0 );

}`,Pie=`
uniform sampler2DArray depthColor;
uniform float depthWidth;
uniform float depthHeight;

void main() {

	vec2 coord = vec2( gl_FragCoord.x / depthWidth, gl_FragCoord.y / depthHeight );

	if ( coord.x >= 1.0 ) {

		gl_FragDepth = texture( depthColor, vec3( coord.x - 1.0, coord.y, 1 ) ).r;

	} else {

		gl_FragDepth = texture( depthColor, vec3( coord.x, coord.y, 0 ) ).r;

	}

}`;class Bie{constructor(){this.texture=null,this.mesh=null,this.depthNear=0,this.depthFar=0}init(e,t){if(this.texture===null){const n=new dL(e.texture);(e.depthNear!==t.depthNear||e.depthFar!==t.depthFar)&&(this.depthNear=e.depthNear,this.depthFar=e.depthFar),this.texture=n}}getMesh(e){if(this.texture!==null&&this.mesh===null){const t=e.cameras[0].viewport,n=new ul({vertexShader:Lie,fragmentShader:Pie,uniforms:{depthColor:{value:this.texture},depthWidth:{value:t.z},depthHeight:{value:t.w}}});this.mesh=new ar(new $h(20,20),n)}return this.mesh}reset(){this.texture=null,this.mesh=null}getDepthTexture(){return this.texture}}class Iie extends Gl{constructor(e,t){super();const n=this;let i=null,s=1,a=null,o="local-floor",l=1,c=null,d=null,p=null,y=null,_=null,v=null;const b=typeof XRWebGLBinding<"u",E=new Bie,T={},M=t.getContextAttributes();let R=null,N=null;const P=[],U=[],L=new tt;let F=null;const O=new Br;O.viewport=new zn;const B=new Br;B.viewport=new zn;const q=[O,B],j=new HL;let Q=null,se=null;this.cameraAutoUpdate=!0,this.enabled=!1,this.isPresenting=!1,this.getController=function(Ee){let Ne=P[Ee];return Ne===void 0&&(Ne=new wT,P[Ee]=Ne),Ne.getTargetRaySpace()},this.getControllerGrip=function(Ee){let Ne=P[Ee];return Ne===void 0&&(Ne=new wT,P[Ee]=Ne),Ne.getGripSpace()},this.getHand=function(Ee){let Ne=P[Ee];return Ne===void 0&&(Ne=new wT,P[Ee]=Ne),Ne.getHandSpace()};function ae(Ee){const Ne=U.indexOf(Ee.inputSource);if(Ne===-1)return;const rt=P[Ne];rt!==void 0&&(rt.update(Ee.inputSource,Ee.frame,c||a),rt.dispatchEvent({type:Ee.type,data:Ee.inputSource}))}function V(){i.removeEventListener("select",ae),i.removeEventListener("selectstart",ae),i.removeEventListener("selectend",ae),i.removeEventListener("squeeze",ae),i.removeEventListener("squeezestart",ae),i.removeEventListener("squeezeend",ae),i.removeEventListener("end",V),i.removeEventListener("inputsourceschange",X);for(let Ee=0;Ee<P.length;Ee++){const Ne=U[Ee];Ne!==null&&(U[Ee]=null,P[Ee].disconnect(Ne))}Q=null,se=null,E.reset();for(const Ee in T)delete T[Ee];e.setRenderTarget(R),_=null,y=null,p=null,i=null,N=null,ut.stop(),n.isPresenting=!1,e.setPixelRatio(F),e.setSize(L.width,L.height,!1),n.dispatchEvent({type:"sessionend"})}this.setFramebufferScaleFactor=function(Ee){s=Ee,n.isPresenting===!0&&Ve("WebXRManager: Cannot change framebuffer scale while presenting.")},this.setReferenceSpaceType=function(Ee){o=Ee,n.isPresenting===!0&&Ve("WebXRManager: Cannot change reference space type while presenting.")},this.getReferenceSpace=function(){return c||a},this.setReferenceSpace=function(Ee){c=Ee},this.getBaseLayer=function(){return y!==null?y:_},this.getBinding=function(){return p===null&&b&&(p=new XRWebGLBinding(i,t)),p},this.getFrame=function(){return v},this.getSession=function(){return i},this.setSession=async function(Ee){if(i=Ee,i!==null){if(R=e.getRenderTarget(),i.addEventListener("select",ae),i.addEventListener("selectstart",ae),i.addEventListener("selectend",ae),i.addEventListener("squeeze",ae),i.addEventListener("squeezestart",ae),i.addEventListener("squeezeend",ae),i.addEventListener("end",V),i.addEventListener("inputsourceschange",X),M.xrCompatible!==!0&&await t.makeXRCompatible(),F=e.getPixelRatio(),e.getSize(L),b&&"createProjectionLayer"in XRWebGLBinding.prototype){let rt=null,Nt=null,Ft=null;M.depth&&(Ft=M.stencil?t.DEPTH24_STENCIL8:t.DEPTH_COMPONENT24,rt=M.stencil?ho:ba,Nt=M.stencil?Dl:Hi);const fn={colorFormat:t.RGBA8,depthFormat:Ft,scaleFactor:s};p=this.getBinding(),y=p.createProjectionLayer(fn),i.updateRenderState({layers:[y]}),e.setPixelRatio(1),e.setSize(y.textureWidth,y.textureHeight,!1),N=new sl(y.textureWidth,y.textureHeight,{format:Qi,type:ir,depthTexture:new Ga(y.textureWidth,y.textureHeight,Nt,void 0,void 0,void 0,void 0,void 0,void 0,rt),stencilBuffer:M.stencil,colorSpace:e.outputColorSpace,samples:M.antialias?4:0,resolveDepthBuffer:y.ignoreDepthValues===!1,resolveStencilBuffer:y.ignoreDepthValues===!1})}else{const rt={antialias:M.antialias,alpha:!0,depth:M.depth,stencil:M.stencil,framebufferScaleFactor:s};_=new XRWebGLLayer(i,t,rt),i.updateRenderState({baseLayer:_}),e.setPixelRatio(1),e.setSize(_.framebufferWidth,_.framebufferHeight,!1),N=new sl(_.framebufferWidth,_.framebufferHeight,{format:Qi,type:ir,colorSpace:e.outputColorSpace,stencilBuffer:M.stencil,resolveDepthBuffer:_.ignoreDepthValues===!1,resolveStencilBuffer:_.ignoreDepthValues===!1})}N.isXRRenderTarget=!0,this.setFoveation(l),c=null,a=await i.requestReferenceSpace(o),ut.setContext(i),ut.start(),n.isPresenting=!0,n.dispatchEvent({type:"sessionstart"})}},this.getEnvironmentBlendMode=function(){if(i!==null)return i.environmentBlendMode},this.getDepthTexture=function(){return E.getDepthTexture()};function X(Ee){for(let Ne=0;Ne<Ee.removed.length;Ne++){const rt=Ee.removed[Ne],Nt=U.indexOf(rt);Nt>=0&&(U[Nt]=null,P[Nt].disconnect(rt))}for(let Ne=0;Ne<Ee.added.length;Ne++){const rt=Ee.added[Ne];let Nt=U.indexOf(rt);if(Nt===-1){for(let fn=0;fn<P.length;fn++)if(fn>=U.length){U.push(rt),Nt=fn;break}else if(U[fn]===null){U[fn]=rt,Nt=fn;break}if(Nt===-1)break}const Ft=P[Nt];Ft&&Ft.connect(rt)}}const ee=new ne,fe=new ne;function Y(Ee,Ne,rt){ee.setFromMatrixPosition(Ne.matrixWorld),fe.setFromMatrixPosition(rt.matrixWorld);const Nt=ee.distanceTo(fe),Ft=Ne.projectionMatrix.elements,fn=rt.projectionMatrix.elements,Sn=Ft[14]/(Ft[10]-1),At=Ft[14]/(Ft[10]+1),qe=(Ft[9]+1)/Ft[5],at=(Ft[9]-1)/Ft[5],Je=(Ft[8]-1)/Ft[0],xe=(fn[8]+1)/fn[0],oe=Sn*Je,Qt=Sn*xe,Dt=Nt/(-Je+xe),zt=Dt*-Je;if(Ne.matrixWorld.decompose(Ee.position,Ee.quaternion,Ee.scale),Ee.translateX(zt),Ee.translateZ(Dt),Ee.matrixWorld.compose(Ee.position,Ee.quaternion,Ee.scale),Ee.matrixWorldInverse.copy(Ee.matrixWorld).invert(),Ft[10]===-1)Ee.projectionMatrix.copy(Ne.projectionMatrix),Ee.projectionMatrixInverse.copy(Ne.projectionMatrixInverse);else{const wt=Sn+Dt,Z=At+Dt,k=oe-zt,pe=Qt+(Nt-zt),Fe=qe*At/Z*wt,He=at*At/Z*wt;Ee.projectionMatrix.makePerspective(k,pe,Fe,He,wt,Z),Ee.projectionMatrixInverse.copy(Ee.projectionMatrix).invert()}}function K(Ee,Ne){Ne===null?Ee.matrixWorld.copy(Ee.matrix):Ee.matrixWorld.multiplyMatrices(Ne.matrixWorld,Ee.matrix),Ee.matrixWorldInverse.copy(Ee.matrixWorld).invert()}this.updateCamera=function(Ee){if(i===null)return;let Ne=Ee.near,rt=Ee.far;E.texture!==null&&(E.depthNear>0&&(Ne=E.depthNear),E.depthFar>0&&(rt=E.depthFar)),j.near=B.near=O.near=Ne,j.far=B.far=O.far=rt,(Q!==j.near||se!==j.far)&&(i.updateRenderState({depthNear:j.near,depthFar:j.far}),Q=j.near,se=j.far),j.layers.mask=Ee.layers.mask|6,O.layers.mask=j.layers.mask&3,B.layers.mask=j.layers.mask&5;const Nt=Ee.parent,Ft=j.cameras;K(j,Nt);for(let fn=0;fn<Ft.length;fn++)K(Ft[fn],Nt);Ft.length===2?Y(j,O,B):j.projectionMatrix.copy(O.projectionMatrix),he(Ee,j,Nt)};function he(Ee,Ne,rt){rt===null?Ee.matrix.copy(Ne.matrixWorld):(Ee.matrix.copy(rt.matrixWorld),Ee.matrix.invert(),Ee.matrix.multiply(Ne.matrixWorld)),Ee.matrix.decompose(Ee.position,Ee.quaternion,Ee.scale),Ee.updateMatrixWorld(!0),Ee.projectionMatrix.copy(Ne.projectionMatrix),Ee.projectionMatrixInverse.copy(Ne.projectionMatrixInverse),Ee.isPerspectiveCamera&&(Ee.fov=py*2*Math.atan(1/Ee.projectionMatrix.elements[5]),Ee.zoom=1)}this.getCamera=function(){return j},this.getFoveation=function(){if(!(y===null&&_===null))return l},this.setFoveation=function(Ee){l=Ee,y!==null&&(y.fixedFoveation=Ee),_!==null&&_.fixedFoveation!==void 0&&(_.fixedFoveation=Ee)},this.hasDepthSensing=function(){return E.texture!==null},this.getDepthSensingMesh=function(){return E.getMesh(j)},this.getCameraTexture=function(Ee){return T[Ee]};let Ce=null;function Ie(Ee,Ne){if(d=Ne.getViewerPose(c||a),v=Ne,d!==null){const rt=d.views;_!==null&&(e.setRenderTargetFramebuffer(N,_.framebuffer),e.setRenderTarget(N));let Nt=!1;rt.length!==j.cameras.length&&(j.cameras.length=0,Nt=!0);for(let At=0;At<rt.length;At++){const qe=rt[At];let at=null;if(_!==null)at=_.getViewport(qe);else{const xe=p.getViewSubImage(y,qe);at=xe.viewport,At===0&&(e.setRenderTargetTextures(N,xe.colorTexture,xe.depthStencilTexture),e.setRenderTarget(N))}let Je=q[At];Je===void 0&&(Je=new Br,Je.layers.enable(At),Je.viewport=new zn,q[At]=Je),Je.matrix.fromArray(qe.transform.matrix),Je.matrix.decompose(Je.position,Je.quaternion,Je.scale),Je.projectionMatrix.fromArray(qe.projectionMatrix),Je.projectionMatrixInverse.copy(Je.projectionMatrix).invert(),Je.viewport.set(at.x,at.y,at.width,at.height),At===0&&(j.matrix.copy(Je.matrix),j.matrix.decompose(j.position,j.quaternion,j.scale)),Nt===!0&&j.cameras.push(Je)}const Ft=i.enabledFeatures;if(Ft&&Ft.includes("depth-sensing")&&i.depthUsage=="gpu-optimized"&&b){p=n.getBinding();const At=p.getDepthInformation(rt[0]);At&&At.isValid&&At.texture&&E.init(At,i.renderState)}if(Ft&&Ft.includes("camera-access")&&b){e.state.unbindTexture(),p=n.getBinding();for(let At=0;At<rt.length;At++){const qe=rt[At].camera;if(qe){let at=T[qe];at||(at=new dL,T[qe]=at);const Je=p.getCameraImage(qe);at.sourceTexture=Je}}}}for(let rt=0;rt<P.length;rt++){const Nt=U[rt],Ft=P[rt];Nt!==null&&Ft!==void 0&&Ft.update(Nt,Ne,c||a)}Ce&&Ce(Ee,Ne),Ne.detectedPlanes&&n.dispatchEvent({type:"planesdetected",data:Ne}),v=null}const ut=new O6;ut.setAnimationLoop(Ie),this.setAnimationLoop=function(Ee){Ce=Ee},this.dispose=function(){}}}const Yg=new ll,Fie=new gn;function zie(r,e){function t(E,T){E.matrixAutoUpdate===!0&&E.updateMatrix(),T.value.copy(E.matrix)}function n(E,T){T.color.getRGB(E.fogColor.value,Zk(r)),T.isFog?(E.fogNear.value=T.near,E.fogFar.value=T.far):T.isFogExp2&&(E.fogDensity.value=T.density)}function i(E,T,M,R,N){T.isMeshBasicMaterial||T.isMeshLambertMaterial?s(E,T):T.isMeshToonMaterial?(s(E,T),p(E,T)):T.isMeshPhongMaterial?(s(E,T),d(E,T)):T.isMeshStandardMaterial?(s(E,T),y(E,T),T.isMeshPhysicalMaterial&&_(E,T,N)):T.isMeshMatcapMaterial?(s(E,T),v(E,T)):T.isMeshDepthMaterial?s(E,T):T.isMeshDistanceMaterial?(s(E,T),b(E,T)):T.isMeshNormalMaterial?s(E,T):T.isLineBasicMaterial?(a(E,T),T.isLineDashedMaterial&&o(E,T)):T.isPointsMaterial?l(E,T,M,R):T.isSpriteMaterial?c(E,T):T.isShadowMaterial?(E.color.value.copy(T.color),E.opacity.value=T.opacity):T.isShaderMaterial&&(T.uniformsNeedUpdate=!1)}function s(E,T){E.opacity.value=T.opacity,T.color&&E.diffuse.value.copy(T.color),T.emissive&&E.emissive.value.copy(T.emissive).multiplyScalar(T.emissiveIntensity),T.map&&(E.map.value=T.map,t(T.map,E.mapTransform)),T.alphaMap&&(E.alphaMap.value=T.alphaMap,t(T.alphaMap,E.alphaMapTransform)),T.bumpMap&&(E.bumpMap.value=T.bumpMap,t(T.bumpMap,E.bumpMapTransform),E.bumpScale.value=T.bumpScale,T.side===gr&&(E.bumpScale.value*=-1)),T.normalMap&&(E.normalMap.value=T.normalMap,t(T.normalMap,E.normalMapTransform),E.normalScale.value.copy(T.normalScale),T.side===gr&&E.normalScale.value.negate()),T.displacementMap&&(E.displacementMap.value=T.displacementMap,t(T.displacementMap,E.displacementMapTransform),E.displacementScale.value=T.displacementScale,E.displacementBias.value=T.displacementBias),T.emissiveMap&&(E.emissiveMap.value=T.emissiveMap,t(T.emissiveMap,E.emissiveMapTransform)),T.specularMap&&(E.specularMap.value=T.specularMap,t(T.specularMap,E.specularMapTransform)),T.alphaTest>0&&(E.alphaTest.value=T.alphaTest);const M=e.get(T),R=M.envMap,N=M.envMapRotation;R&&(E.envMap.value=R,Yg.copy(N),Yg.x*=-1,Yg.y*=-1,Yg.z*=-1,R.isCubeTexture&&R.isRenderTargetTexture===!1&&(Yg.y*=-1,Yg.z*=-1),E.envMapRotation.value.setFromMatrix4(Fie.makeRotationFromEuler(Yg)),E.flipEnvMap.value=R.isCubeTexture&&R.isRenderTargetTexture===!1?-1:1,E.reflectivity.value=T.reflectivity,E.ior.value=T.ior,E.refractionRatio.value=T.refractionRatio),T.lightMap&&(E.lightMap.value=T.lightMap,E.lightMapIntensity.value=T.lightMapIntensity,t(T.lightMap,E.lightMapTransform)),T.aoMap&&(E.aoMap.value=T.aoMap,E.aoMapIntensity.value=T.aoMapIntensity,t(T.aoMap,E.aoMapTransform))}function a(E,T){E.diffuse.value.copy(T.color),E.opacity.value=T.opacity,T.map&&(E.map.value=T.map,t(T.map,E.mapTransform))}function o(E,T){E.dashSize.value=T.dashSize,E.totalSize.value=T.dashSize+T.gapSize,E.scale.value=T.scale}function l(E,T,M,R){E.diffuse.value.copy(T.color),E.opacity.value=T.opacity,E.size.value=T.size*M,E.scale.value=R*.5,T.map&&(E.map.value=T.map,t(T.map,E.uvTransform)),T.alphaMap&&(E.alphaMap.value=T.alphaMap,t(T.alphaMap,E.alphaMapTransform)),T.alphaTest>0&&(E.alphaTest.value=T.alphaTest)}function c(E,T){E.diffuse.value.copy(T.color),E.opacity.value=T.opacity,E.rotation.value=T.rotation,T.map&&(E.map.value=T.map,t(T.map,E.mapTransform)),T.alphaMap&&(E.alphaMap.value=T.alphaMap,t(T.alphaMap,E.alphaMapTransform)),T.alphaTest>0&&(E.alphaTest.value=T.alphaTest)}function d(E,T){E.specular.value.copy(T.specular),E.shininess.value=Math.max(T.shininess,1e-4)}function p(E,T){T.gradientMap&&(E.gradientMap.value=T.gradientMap)}function y(E,T){E.metalness.value=T.metalness,T.metalnessMap&&(E.metalnessMap.value=T.metalnessMap,t(T.metalnessMap,E.metalnessMapTransform)),E.roughness.value=T.roughness,T.roughnessMap&&(E.roughnessMap.value=T.roughnessMap,t(T.roughnessMap,E.roughnessMapTransform)),T.envMap&&(E.envMapIntensity.value=T.envMapIntensity)}function _(E,T,M){E.ior.value=T.ior,T.sheen>0&&(E.sheenColor.value.copy(T.sheenColor).multiplyScalar(T.sheen),E.sheenRoughness.value=T.sheenRoughness,T.sheenColorMap&&(E.sheenColorMap.value=T.sheenColorMap,t(T.sheenColorMap,E.sheenColorMapTransform)),T.sheenRoughnessMap&&(E.sheenRoughnessMap.value=T.sheenRoughnessMap,t(T.sheenRoughnessMap,E.sheenRoughnessMapTransform))),T.clearcoat>0&&(E.clearcoat.value=T.clearcoat,E.clearcoatRoughness.value=T.clearcoatRoughness,T.clearcoatMap&&(E.clearcoatMap.value=T.clearcoatMap,t(T.clearcoatMap,E.clearcoatMapTransform)),T.clearcoatRoughnessMap&&(E.clearcoatRoughnessMap.value=T.clearcoatRoughnessMap,t(T.clearcoatRoughnessMap,E.clearcoatRoughnessMapTransform)),T.clearcoatNormalMap&&(E.clearcoatNormalMap.value=T.clearcoatNormalMap,t(T.clearcoatNormalMap,E.clearcoatNormalMapTransform),E.clearcoatNormalScale.value.copy(T.clearcoatNormalScale),T.side===gr&&E.clearcoatNormalScale.value.negate())),T.dispersion>0&&(E.dispersion.value=T.dispersion),T.iridescence>0&&(E.iridescence.value=T.iridescence,E.iridescenceIOR.value=T.iridescenceIOR,E.iridescenceThicknessMinimum.value=T.iridescenceThicknessRange[0],E.iridescenceThicknessMaximum.value=T.iridescenceThicknessRange[1],T.iridescenceMap&&(E.iridescenceMap.value=T.iridescenceMap,t(T.iridescenceMap,E.iridescenceMapTransform)),T.iridescenceThicknessMap&&(E.iridescenceThicknessMap.value=T.iridescenceThicknessMap,t(T.iridescenceThicknessMap,E.iridescenceThicknessMapTransform))),T.transmission>0&&(E.transmission.value=T.transmission,E.transmissionSamplerMap.value=M.texture,E.transmissionSamplerSize.value.set(M.width,M.height),T.transmissionMap&&(E.transmissionMap.value=T.transmissionMap,t(T.transmissionMap,E.transmissionMapTransform)),E.thickness.value=T.thickness,T.thicknessMap&&(E.thicknessMap.value=T.thicknessMap,t(T.thicknessMap,E.thicknessMapTransform)),E.attenuationDistance.value=T.attenuationDistance,E.attenuationColor.value.copy(T.attenuationColor)),T.anisotropy>0&&(E.anisotropyVector.value.set(T.anisotropy*Math.cos(T.anisotropyRotation),T.anisotropy*Math.sin(T.anisotropyRotation)),T.anisotropyMap&&(E.anisotropyMap.value=T.anisotropyMap,t(T.anisotropyMap,E.anisotropyMapTransform))),E.specularIntensity.value=T.specularIntensity,E.specularColor.value.copy(T.specularColor),T.specularColorMap&&(E.specularColorMap.value=T.specularColorMap,t(T.specularColorMap,E.specularColorMapTransform)),T.specularIntensityMap&&(E.specularIntensityMap.value=T.specularIntensityMap,t(T.specularIntensityMap,E.specularIntensityMapTransform))}function v(E,T){T.matcap&&(E.matcap.value=T.matcap)}function b(E,T){const M=e.get(T).light;E.referencePosition.value.setFromMatrixPosition(M.matrixWorld),E.nearDistance.value=M.shadow.camera.near,E.farDistance.value=M.shadow.camera.far}return{refreshFogUniforms:n,refreshMaterialUniforms:i}}function Vie(r,e,t,n){let i={},s={},a=[];const o=r.getParameter(r.MAX_UNIFORM_BUFFER_BINDINGS);function l(M,R){const N=R.program;n.uniformBlockBinding(M,N)}function c(M,R){let N=i[M.id];N===void 0&&(v(M),N=d(M),i[M.id]=N,M.addEventListener("dispose",E));const P=R.program;n.updateUBOMapping(M,P);const U=e.render.frame;s[M.id]!==U&&(y(M),s[M.id]=U)}function d(M){const R=p();M.__bindingPointIndex=R;const N=r.createBuffer(),P=M.__size,U=M.usage;return r.bindBuffer(r.UNIFORM_BUFFER,N),r.bufferData(r.UNIFORM_BUFFER,P,U),r.bindBuffer(r.UNIFORM_BUFFER,null),r.bindBufferBase(r.UNIFORM_BUFFER,R,N),N}function p(){for(let M=0;M<o;M++)if(a.indexOf(M)===-1)return a.push(M),M;return Ze("WebGLRenderer: Maximum number of simultaneously usable uniforms groups reached."),0}function y(M){const R=i[M.id],N=M.uniforms,P=M.__cache;r.bindBuffer(r.UNIFORM_BUFFER,R);for(let U=0,L=N.length;U<L;U++){const F=Array.isArray(N[U])?N[U]:[N[U]];for(let O=0,B=F.length;O<B;O++){const q=F[O];if(_(q,U,O,P)===!0){const j=q.__offset,Q=Array.isArray(q.value)?q.value:[q.value];let se=0;for(let ae=0;ae<Q.length;ae++){const V=Q[ae],X=b(V);typeof V=="number"||typeof V=="boolean"?(q.__data[0]=V,r.bufferSubData(r.UNIFORM_BUFFER,j+se,q.__data)):V.isMatrix3?(q.__data[0]=V.elements[0],q.__data[1]=V.elements[1],q.__data[2]=V.elements[2],q.__data[3]=0,q.__data[4]=V.elements[3],q.__data[5]=V.elements[4],q.__data[6]=V.elements[5],q.__data[7]=0,q.__data[8]=V.elements[6],q.__data[9]=V.elements[7],q.__data[10]=V.elements[8],q.__data[11]=0):(V.toArray(q.__data,se),se+=X.storage/Float32Array.BYTES_PER_ELEMENT)}r.bufferSubData(r.UNIFORM_BUFFER,j,q.__data)}}}r.bindBuffer(r.UNIFORM_BUFFER,null)}function _(M,R,N,P){const U=M.value,L=R+"_"+N;if(P[L]===void 0)return typeof U=="number"||typeof U=="boolean"?P[L]=U:P[L]=U.clone(),!0;{const F=P[L];if(typeof U=="number"||typeof U=="boolean"){if(F!==U)return P[L]=U,!0}else if(F.equals(U)===!1)return F.copy(U),!0}return!1}function v(M){const R=M.uniforms;let N=0;const P=16;for(let L=0,F=R.length;L<F;L++){const O=Array.isArray(R[L])?R[L]:[R[L]];for(let B=0,q=O.length;B<q;B++){const j=O[B],Q=Array.isArray(j.value)?j.value:[j.value];for(let se=0,ae=Q.length;se<ae;se++){const V=Q[se],X=b(V),ee=N%P,fe=ee%X.boundary,Y=ee+fe;N+=fe,Y!==0&&P-Y<X.storage&&(N+=P-Y),j.__data=new Float32Array(X.storage/Float32Array.BYTES_PER_ELEMENT),j.__offset=N,N+=X.storage}}}const U=N%P;return U>0&&(N+=P-U),M.__size=N,M.__cache={},this}function b(M){const R={boundary:0,storage:0};return typeof M=="number"||typeof M=="boolean"?(R.boundary=4,R.storage=4):M.isVector2?(R.boundary=8,R.storage=8):M.isVector3||M.isColor?(R.boundary=16,R.storage=12):M.isVector4?(R.boundary=16,R.storage=16):M.isMatrix3?(R.boundary=48,R.storage=48):M.isMatrix4?(R.boundary=64,R.storage=64):M.isTexture?Ve("WebGLRenderer: Texture samplers can not be part of an uniforms group."):Ve("WebGLRenderer: Unsupported uniform value type.",M),R}function E(M){const R=M.target;R.removeEventListener("dispose",E);const N=a.indexOf(R.__bindingPointIndex);a.splice(N,1),r.deleteBuffer(i[R.id]),delete i[R.id],delete s[R.id]}function T(){for(const M in i)r.deleteBuffer(i[M]);a=[],i={},s={}}return{bind:l,update:c,dispose:T}}const Gie=new Uint16Array([12469,15057,12620,14925,13266,14620,13807,14376,14323,13990,14545,13625,14713,13328,14840,12882,14931,12528,14996,12233,15039,11829,15066,11525,15080,11295,15085,10976,15082,10705,15073,10495,13880,14564,13898,14542,13977,14430,14158,14124,14393,13732,14556,13410,14702,12996,14814,12596,14891,12291,14937,11834,14957,11489,14958,11194,14943,10803,14921,10506,14893,10278,14858,9960,14484,14039,14487,14025,14499,13941,14524,13740,14574,13468,14654,13106,14743,12678,14818,12344,14867,11893,14889,11509,14893,11180,14881,10751,14852,10428,14812,10128,14765,9754,14712,9466,14764,13480,14764,13475,14766,13440,14766,13347,14769,13070,14786,12713,14816,12387,14844,11957,14860,11549,14868,11215,14855,10751,14825,10403,14782,10044,14729,9651,14666,9352,14599,9029,14967,12835,14966,12831,14963,12804,14954,12723,14936,12564,14917,12347,14900,11958,14886,11569,14878,11247,14859,10765,14828,10401,14784,10011,14727,9600,14660,9289,14586,8893,14508,8533,15111,12234,15110,12234,15104,12216,15092,12156,15067,12010,15028,11776,14981,11500,14942,11205,14902,10752,14861,10393,14812,9991,14752,9570,14682,9252,14603,8808,14519,8445,14431,8145,15209,11449,15208,11451,15202,11451,15190,11438,15163,11384,15117,11274,15055,10979,14994,10648,14932,10343,14871,9936,14803,9532,14729,9218,14645,8742,14556,8381,14461,8020,14365,7603,15273,10603,15272,10607,15267,10619,15256,10631,15231,10614,15182,10535,15118,10389,15042,10167,14963,9787,14883,9447,14800,9115,14710,8665,14615,8318,14514,7911,14411,7507,14279,7198,15314,9675,15313,9683,15309,9712,15298,9759,15277,9797,15229,9773,15166,9668,15084,9487,14995,9274,14898,8910,14800,8539,14697,8234,14590,7790,14479,7409,14367,7067,14178,6621,15337,8619,15337,8631,15333,8677,15325,8769,15305,8871,15264,8940,15202,8909,15119,8775,15022,8565,14916,8328,14804,8009,14688,7614,14569,7287,14448,6888,14321,6483,14088,6171,15350,7402,15350,7419,15347,7480,15340,7613,15322,7804,15287,7973,15229,8057,15148,8012,15046,7846,14933,7611,14810,7357,14682,7069,14552,6656,14421,6316,14251,5948,14007,5528,15356,5942,15356,5977,15353,6119,15348,6294,15332,6551,15302,6824,15249,7044,15171,7122,15070,7050,14949,6861,14818,6611,14679,6349,14538,6067,14398,5651,14189,5311,13935,4958,15359,4123,15359,4153,15356,4296,15353,4646,15338,5160,15311,5508,15263,5829,15188,6042,15088,6094,14966,6001,14826,5796,14678,5543,14527,5287,14377,4985,14133,4586,13869,4257,15360,1563,15360,1642,15358,2076,15354,2636,15341,3350,15317,4019,15273,4429,15203,4732,15105,4911,14981,4932,14836,4818,14679,4621,14517,4386,14359,4156,14083,3795,13808,3437,15360,122,15360,137,15358,285,15355,636,15344,1274,15322,2177,15281,2765,15215,3223,15120,3451,14995,3569,14846,3567,14681,3466,14511,3305,14344,3121,14037,2800,13753,2467,15360,0,15360,1,15359,21,15355,89,15346,253,15325,479,15287,796,15225,1148,15133,1492,15008,1749,14856,1882,14685,1886,14506,1783,14324,1608,13996,1398,13702,1183]);let kf=null;function kie(){return kf===null&&(kf=new Ol(Gie,16,16,po,vi),kf.name="DFG_LUT",kf.minFilter=ei,kf.magFilter=ei,kf.wrapS=Dr,kf.wrapT=Dr,kf.generateMipmaps=!1,kf.needsUpdate=!0),kf}class jL{constructor(e={}){const{canvas:t=sL(),context:n=null,depth:i=!0,stencil:s=!1,alpha:a=!1,antialias:o=!1,premultipliedAlpha:l=!0,preserveDrawingBuffer:c=!1,powerPreference:d="default",failIfMajorPerformanceCaveat:p=!1,reversedDepthBuffer:y=!1,outputBufferType:_=ir}=e;this.isWebGLRenderer=!0;let v;if(n!==null){if(typeof WebGLRenderingContext<"u"&&n instanceof WebGLRenderingContext)throw new Error("THREE.WebGLRenderer: WebGL 1 is not supported since r163.");v=n.getContextAttributes().alpha}else v=a;const b=_,E=new Set([Ay,My,Bm]),T=new Set([ir,Hi,Zu,Dl,B1,I1]),M=new Uint32Array(4),R=new Int32Array(4);let N=null,P=null;const U=[],L=[];let F=null;this.domElement=t,this.debug={checkShaderErrors:!0,onShaderError:null},this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.sortObjects=!0,this.clippingPlanes=[],this.localClippingEnabled=!1,this.toneMapping=ta,this.toneMappingExposure=1,this.transmissionResolutionScale=1;const O=this;let B=!1;this._outputColorSpace=ea;let q=0,j=0,Q=null,se=-1,ae=null;const V=new zn,X=new zn;let ee=null;const fe=new Kt(0);let Y=0,K=t.width,he=t.height,Ce=1,Ie=null,ut=null;const Ee=new zn(0,0,K,he),Ne=new zn(0,0,K,he);let rt=!1;const Nt=new Ry;let Ft=!1,fn=!1;const Sn=new gn,At=new ne,qe=new zn,at={background:null,fog:null,environment:null,overrideMaterial:null,isScene:!0};let Je=!1;function xe(){return Q===null?Ce:1}let oe=n;function Qt($,ce){return t.getContext($,ce)}try{const $={alpha:!0,depth:i,stencil:s,antialias:o,premultipliedAlpha:l,preserveDrawingBuffer:c,powerPreference:d,failIfMajorPerformanceCaveat:p};if("setAttribute"in t&&t.setAttribute("data-engine",`three.js r${Lm}`),t.addEventListener("webglcontextlost",ln,!1),t.addEventListener("webglcontextrestored",jn,!1),t.addEventListener("webglcontextcreationerror",qt,!1),oe===null){const ce="webgl2";if(oe=Qt(ce,$),oe===null)throw Qt(ce)?new Error("Error creating WebGL context with your selected attributes."):new Error("Error creating WebGL context.")}}catch($){throw Ze("WebGLRenderer: "+$.message),$}let Dt,zt,wt,Z,k,pe,Fe,He,ze,Bt,Ct,Yt,$t,st,nt,Pt,ue,Re,dt,le,Be,lt,Ot,ht;function it(){Dt=new Hte(oe),Dt.init(),lt=new I6(oe,Dt),zt=new Lte(oe,Dt,e,lt),wt=new Oie(oe,Dt),zt.reversedDepthBuffer&&y&&wt.buffers.depth.setReversed(!0),Z=new Xte(oe),k=new yie,pe=new Uie(oe,Dt,wt,k,zt,lt,Z),Fe=new Bte(O),He=new kte(O),ze=new ZQ(oe),Ot=new Ote(oe,ze),Bt=new Wte(oe,ze,Z,Ot),Ct=new jte(oe,Bt,ze,Z),dt=new $te(oe,zt,pe),Pt=new Pte(k),Yt=new gie(O,Fe,He,Dt,zt,Ot,Pt),$t=new zie(O,k),st=new vie,nt=new Mie(Dt),Re=new Dte(O,Fe,He,wt,Ct,v,l),ue=new Nie(O,Ct,zt),ht=new Vie(oe,Z,zt,wt),le=new Ute(oe,Dt,Z),Be=new qte(oe,Dt,Z),Z.programs=Yt.programs,O.capabilities=zt,O.extensions=Dt,O.properties=k,O.renderLists=st,O.shadowMap=ue,O.state=wt,O.info=Z}it(),b!==ir&&(F=new Zte(b,t.width,t.height,i,s));const Tt=new Iie(O,oe);this.xr=Tt,this.getContext=function(){return oe},this.getContextAttributes=function(){return oe.getContextAttributes()},this.forceContextLoss=function(){const $=Dt.get("WEBGL_lose_context");$&&$.loseContext()},this.forceContextRestore=function(){const $=Dt.get("WEBGL_lose_context");$&&$.restoreContext()},this.getPixelRatio=function(){return Ce},this.setPixelRatio=function($){$!==void 0&&(Ce=$,this.setSize(K,he,!1))},this.getSize=function($){return $.set(K,he)},this.setSize=function($,ce,Me=!0){if(Tt.isPresenting){Ve("WebGLRenderer: Can't change size while VR device is presenting.");return}K=$,he=ce,t.width=Math.floor($*Ce),t.height=Math.floor(ce*Ce),Me===!0&&(t.style.width=$+"px",t.style.height=ce+"px"),F!==null&&F.setSize(t.width,t.height),this.setViewport(0,0,$,ce)},this.getDrawingBufferSize=function($){return $.set(K*Ce,he*Ce).floor()},this.setDrawingBufferSize=function($,ce,Me){K=$,he=ce,Ce=Me,t.width=Math.floor($*Me),t.height=Math.floor(ce*Me),this.setViewport(0,0,$,ce)},this.setEffects=function($){if(b===ir){console.error("THREE.WebGLRenderer: setEffects() requires outputBufferType set to HalfFloatType or FloatType.");return}if($){for(let ce=0;ce<$.length;ce++)if($[ce].isOutputPass===!0){console.warn("THREE.WebGLRenderer: OutputPass is not needed in setEffects(). Tone mapping and color space conversion are applied automatically.");break}}F.setEffects($||[])},this.getCurrentViewport=function($){return $.copy(V)},this.getViewport=function($){return $.copy(Ee)},this.setViewport=function($,ce,Me,Ae){$.isVector4?Ee.set($.x,$.y,$.z,$.w):Ee.set($,ce,Me,Ae),wt.viewport(V.copy(Ee).multiplyScalar(Ce).round())},this.getScissor=function($){return $.copy(Ne)},this.setScissor=function($,ce,Me,Ae){$.isVector4?Ne.set($.x,$.y,$.z,$.w):Ne.set($,ce,Me,Ae),wt.scissor(X.copy(Ne).multiplyScalar(Ce).round())},this.getScissorTest=function(){return rt},this.setScissorTest=function($){wt.setScissorTest(rt=$)},this.setOpaqueSort=function($){Ie=$},this.setTransparentSort=function($){ut=$},this.getClearColor=function($){return $.copy(Re.getClearColor())},this.setClearColor=function(){Re.setClearColor(...arguments)},this.getClearAlpha=function(){return Re.getClearAlpha()},this.setClearAlpha=function(){Re.setClearAlpha(...arguments)},this.clear=function($=!0,ce=!0,Me=!0){let Ae=0;if($){let Se=!1;if(Q!==null){const mt=Q.texture.format;Se=E.has(mt)}if(Se){const mt=Q.texture.type,Et=T.has(mt),Rt=Re.getClearColor(),It=Re.getClearAlpha(),Vt=Rt.r,mn=Rt.g,Gt=Rt.b;Et?(M[0]=Vt,M[1]=mn,M[2]=Gt,M[3]=It,oe.clearBufferuiv(oe.COLOR,0,M)):(R[0]=Vt,R[1]=mn,R[2]=Gt,R[3]=It,oe.clearBufferiv(oe.COLOR,0,R))}else Ae|=oe.COLOR_BUFFER_BIT}ce&&(Ae|=oe.DEPTH_BUFFER_BIT),Me&&(Ae|=oe.STENCIL_BUFFER_BIT,this.state.buffers.stencil.setMask(4294967295)),oe.clear(Ae)},this.clearColor=function(){this.clear(!0,!1,!1)},this.clearDepth=function(){this.clear(!1,!0,!1)},this.clearStencil=function(){this.clear(!1,!1,!0)},this.dispose=function(){t.removeEventListener("webglcontextlost",ln,!1),t.removeEventListener("webglcontextrestored",jn,!1),t.removeEventListener("webglcontextcreationerror",qt,!1),Re.dispose(),st.dispose(),nt.dispose(),k.dispose(),Fe.dispose(),He.dispose(),Ct.dispose(),Ot.dispose(),ht.dispose(),Yt.dispose(),Tt.dispose(),Tt.removeEventListener("sessionstart",Bi),Tt.removeEventListener("sessionend",Un),Jt.stop()};function ln($){$.preventDefault(),gx("WebGLRenderer: Context Lost."),B=!0}function jn(){gx("WebGLRenderer: Context Restored."),B=!1;const $=Z.autoReset,ce=ue.enabled,Me=ue.autoUpdate,Ae=ue.needsUpdate,Se=ue.type;it(),Z.autoReset=$,ue.enabled=ce,ue.autoUpdate=Me,ue.needsUpdate=Ae,ue.type=Se}function qt($){Ze("WebGLRenderer: A WebGL context could not be created. Reason: ",$.statusMessage)}function nn($){const ce=$.target;ce.removeEventListener("dispose",nn),Bn(ce)}function Bn($){Zt($),k.remove($)}function Zt($){const ce=k.get($).programs;ce!==void 0&&(ce.forEach(function(Me){Yt.releaseProgram(Me)}),$.isShaderMaterial&&Yt.releaseShaderCache($))}this.renderBufferDirect=function($,ce,Me,Ae,Se,mt){ce===null&&(ce=at);const Et=Se.isMesh&&Se.matrixWorld.determinant()<0,Rt=_t($,ce,Me,Ae,Se);wt.setMaterial(Ae,Et);let It=Me.index,Vt=1;if(Ae.wireframe===!0){if(It=Bt.getWireframeAttribute(Me),It===void 0)return;Vt=2}const mn=Me.drawRange,Gt=Me.attributes.position;let un=mn.start*Vt,ni=(mn.start+mn.count)*Vt;mt!==null&&(un=Math.max(un,mt.start*Vt),ni=Math.min(ni,(mt.start+mt.count)*Vt)),It!==null?(un=Math.max(un,0),ni=Math.min(ni,It.count)):Gt!=null&&(un=Math.max(un,0),ni=Math.min(ni,Gt.count));const zi=ni-un;if(zi<0||zi===1/0)return;Ot.setup(Se,Ae,Rt,Me,It);let si,Mn=le;if(It!==null&&(si=ze.get(It),Mn=Be,Mn.setIndex(si)),Se.isMesh)Ae.wireframe===!0?(wt.setLineWidth(Ae.wireframeLinewidth*xe()),Mn.setMode(oe.LINES)):Mn.setMode(oe.TRIANGLES);else if(Se.isLine){let en=Ae.linewidth;en===void 0&&(en=1),wt.setLineWidth(en*xe()),Se.isLineSegments?Mn.setMode(oe.LINES):Se.isLineLoop?Mn.setMode(oe.LINE_LOOP):Mn.setMode(oe.LINE_STRIP)}else Se.isPoints?Mn.setMode(oe.POINTS):Se.isSprite&&Mn.setMode(oe.TRIANGLES);if(Se.isBatchedMesh)if(Se._multiDrawInstances!==null)cr("WebGLRenderer: renderMultiDrawInstances has been deprecated and will be removed in r184. Append to renderMultiDraw arguments and use indirection."),Mn.renderMultiDrawInstances(Se._multiDrawStarts,Se._multiDrawCounts,Se._multiDrawCount,Se._multiDrawInstances);else if(Dt.get("WEBGL_multi_draw"))Mn.renderMultiDraw(Se._multiDrawStarts,Se._multiDrawCounts,Se._multiDrawCount);else{const en=Se._multiDrawStarts,Cn=Se._multiDrawCounts,tn=Se._multiDrawCount,Vi=It?ze.get(It).bytesPerElement:1,Ds=k.get(Ae).currentProgram.getUniforms();for(let Ii=0;Ii<tn;Ii++)Ds.setValue(oe,"_gl_DrawID",Ii),Mn.render(en[Ii]/Vi,Cn[Ii])}else if(Se.isInstancedMesh)Mn.renderInstances(un,zi,Se.count);else if(Me.isInstancedBufferGeometry){const en=Me._maxInstanceCount!==void 0?Me._maxInstanceCount:1/0,Cn=Math.min(Me.instanceCount,en);Mn.renderInstances(un,zi,Cn)}else Mn.render(un,zi)};function Ln($,ce,Me){$.transparent===!0&&$.side===xa&&$.forceSinglePass===!1?($.side=gr,$.needsUpdate=!0,De($,ce,Me),$.side=Cl,$.needsUpdate=!0,De($,ce,Me),$.side=xa):De($,ce,Me)}this.compile=function($,ce,Me=null){Me===null&&(Me=$),P=nt.get(Me),P.init(ce),L.push(P),Me.traverseVisible(function(Se){Se.isLight&&Se.layers.test(ce.layers)&&(P.pushLight(Se),Se.castShadow&&P.pushShadow(Se))}),$!==Me&&$.traverseVisible(function(Se){Se.isLight&&Se.layers.test(ce.layers)&&(P.pushLight(Se),Se.castShadow&&P.pushShadow(Se))}),P.setupLights();const Ae=new Set;return $.traverse(function(Se){if(!(Se.isMesh||Se.isPoints||Se.isLine||Se.isSprite))return;const mt=Se.material;if(mt)if(Array.isArray(mt))for(let Et=0;Et<mt.length;Et++){const Rt=mt[Et];Ln(Rt,Me,Se),Ae.add(Rt)}else Ln(mt,Me,Se),Ae.add(mt)}),P=L.pop(),Ae},this.compileAsync=function($,ce,Me=null){const Ae=this.compile($,ce,Me);return new Promise(Se=>{function mt(){if(Ae.forEach(function(Et){k.get(Et).currentProgram.isReady()&&Ae.delete(Et)}),Ae.size===0){Se($);return}setTimeout(mt,10)}Dt.get("KHR_parallel_shader_compile")!==null?mt():setTimeout(mt,10)})};let dn=null;function wn($){dn&&dn($)}function Bi(){Jt.stop()}function Un(){Jt.start()}const Jt=new O6;Jt.setAnimationLoop(wn),typeof self<"u"&&Jt.setContext(self),this.setAnimationLoop=function($){dn=$,Tt.setAnimationLoop($),$===null?Jt.stop():Jt.start()},Tt.addEventListener("sessionstart",Bi),Tt.addEventListener("sessionend",Un),this.render=function($,ce){if(ce!==void 0&&ce.isCamera!==!0){Ze("WebGLRenderer.render: camera is not an instance of THREE.Camera.");return}if(B===!0)return;const Me=Tt.enabled===!0&&Tt.isPresenting===!0,Ae=F!==null&&(Q===null||Me)&&F.begin(O,Q);if($.matrixWorldAutoUpdate===!0&&$.updateMatrixWorld(),ce.parent===null&&ce.matrixWorldAutoUpdate===!0&&ce.updateMatrixWorld(),Tt.enabled===!0&&Tt.isPresenting===!0&&(F===null||F.isCompositing()===!1)&&(Tt.cameraAutoUpdate===!0&&Tt.updateCamera(ce),ce=Tt.getCamera()),$.isScene===!0&&$.onBeforeRender(O,$,ce,Q),P=nt.get($,L.length),P.init(ce),L.push(P),Sn.multiplyMatrices(ce.projectionMatrix,ce.matrixWorldInverse),Nt.setFromProjectionMatrix(Sn,Ba,ce.reversedDepth),fn=this.localClippingEnabled,Ft=Pt.init(this.clippingPlanes,fn),N=st.get($,U.length),N.init(),U.push(N),Tt.enabled===!0&&Tt.isPresenting===!0){const Et=O.xr.getDepthSensingMesh();Et!==null&&xi(Et,ce,-1/0,O.sortObjects)}xi($,ce,0,O.sortObjects),N.finish(),O.sortObjects===!0&&N.sort(Ie,ut),Je=Tt.enabled===!1||Tt.isPresenting===!1||Tt.hasDepthSensing()===!1,Je&&Re.addToRenderList(N,$),this.info.render.frame++,Ft===!0&&Pt.beginShadows();const Se=P.state.shadowsArray;if(ue.render(Se,$,ce),Ft===!0&&Pt.endShadows(),this.info.autoReset===!0&&this.info.reset(),(Ae&&F.hasRenderPass())===!1){const Et=N.opaque,Rt=N.transmissive;if(P.setupLights(),ce.isArrayCamera){const It=ce.cameras;if(Rt.length>0)for(let Vt=0,mn=It.length;Vt<mn;Vt++){const Gt=It[Vt];W(Et,Rt,$,Gt)}Je&&Re.render($);for(let Vt=0,mn=It.length;Vt<mn;Vt++){const Gt=It[Vt];pn(N,$,Gt,Gt.viewport)}}else Rt.length>0&&W(Et,Rt,$,ce),Je&&Re.render($),pn(N,$,ce)}Q!==null&&j===0&&(pe.updateMultisampleRenderTarget(Q),pe.updateRenderTargetMipmap(Q)),Ae&&F.end(O),$.isScene===!0&&$.onAfterRender(O,$,ce),Ot.resetDefaultState(),se=-1,ae=null,L.pop(),L.length>0?(P=L[L.length-1],Ft===!0&&Pt.setGlobalState(O.clippingPlanes,P.state.camera)):P=null,U.pop(),U.length>0?N=U[U.length-1]:N=null};function xi($,ce,Me,Ae){if($.visible===!1)return;if($.layers.test(ce.layers)){if($.isGroup)Me=$.renderOrder;else if($.isLOD)$.autoUpdate===!0&&$.update(ce);else if($.isLight)P.pushLight($),$.castShadow&&P.pushShadow($);else if($.isSprite){if(!$.frustumCulled||Nt.intersectsSprite($)){Ae&&qe.setFromMatrixPosition($.matrixWorld).applyMatrix4(Sn);const Et=Ct.update($),Rt=$.material;Rt.visible&&N.push($,Et,Rt,Me,qe.z,null)}}else if(($.isMesh||$.isLine||$.isPoints)&&(!$.frustumCulled||Nt.intersectsObject($))){const Et=Ct.update($),Rt=$.material;if(Ae&&($.boundingSphere!==void 0?($.boundingSphere===null&&$.computeBoundingSphere(),qe.copy($.boundingSphere.center)):(Et.boundingSphere===null&&Et.computeBoundingSphere(),qe.copy(Et.boundingSphere.center)),qe.applyMatrix4($.matrixWorld).applyMatrix4(Sn)),Array.isArray(Rt)){const It=Et.groups;for(let Vt=0,mn=It.length;Vt<mn;Vt++){const Gt=It[Vt],un=Rt[Gt.materialIndex];un&&un.visible&&N.push($,Et,un,Me,qe.z,Gt)}}else Rt.visible&&N.push($,Et,Rt,Me,qe.z,null)}}const mt=$.children;for(let Et=0,Rt=mt.length;Et<Rt;Et++)xi(mt[Et],ce,Me,Ae)}function pn($,ce,Me,Ae){const{opaque:Se,transmissive:mt,transparent:Et}=$;P.setupLightsView(Me),Ft===!0&&Pt.setGlobalState(O.clippingPlanes,Me),Ae&&wt.viewport(V.copy(Ae)),Se.length>0&&J(Se,ce,Me),mt.length>0&&J(mt,ce,Me),Et.length>0&&J(Et,ce,Me),wt.buffers.depth.setTest(!0),wt.buffers.depth.setMask(!0),wt.buffers.color.setMask(!0),wt.setPolygonOffset(!1)}function W($,ce,Me,Ae){if((Me.isScene===!0?Me.overrideMaterial:null)!==null)return;if(P.state.transmissionRenderTarget[Ae.id]===void 0){const un=Dt.has("EXT_color_buffer_half_float")||Dt.has("EXT_color_buffer_float");P.state.transmissionRenderTarget[Ae.id]=new sl(1,1,{generateMipmaps:!0,type:un?vi:ir,minFilter:Pa,samples:zt.samples,stencilBuffer:s,resolveDepthBuffer:!1,resolveStencilBuffer:!1,colorSpace:Nn.workingColorSpace})}const mt=P.state.transmissionRenderTarget[Ae.id],Et=Ae.viewport||V;mt.setSize(Et.z*O.transmissionResolutionScale,Et.w*O.transmissionResolutionScale);const Rt=O.getRenderTarget(),It=O.getActiveCubeFace(),Vt=O.getActiveMipmapLevel();O.setRenderTarget(mt),O.getClearColor(fe),Y=O.getClearAlpha(),Y<1&&O.setClearColor(16777215,.5),O.clear(),Je&&Re.render(Me);const mn=O.toneMapping;O.toneMapping=ta;const Gt=Ae.viewport;if(Ae.viewport!==void 0&&(Ae.viewport=void 0),P.setupLightsView(Ae),Ft===!0&&Pt.setGlobalState(O.clippingPlanes,Ae),J($,Me,Ae),pe.updateMultisampleRenderTarget(mt),pe.updateRenderTargetMipmap(mt),Dt.has("WEBGL_multisampled_render_to_texture")===!1){let un=!1;for(let ni=0,zi=ce.length;ni<zi;ni++){const si=ce[ni],{object:Mn,geometry:en,material:Cn,group:tn}=si;if(Cn.side===xa&&Mn.layers.test(Ae.layers)){const Vi=Cn.side;Cn.side=gr,Cn.needsUpdate=!0,me(Mn,Me,Ae,en,Cn,tn),Cn.side=Vi,Cn.needsUpdate=!0,un=!0}}un===!0&&(pe.updateMultisampleRenderTarget(mt),pe.updateRenderTargetMipmap(mt))}O.setRenderTarget(Rt,It,Vt),O.setClearColor(fe,Y),Gt!==void 0&&(Ae.viewport=Gt),O.toneMapping=mn}function J($,ce,Me){const Ae=ce.isScene===!0?ce.overrideMaterial:null;for(let Se=0,mt=$.length;Se<mt;Se++){const Et=$[Se],{object:Rt,geometry:It,group:Vt}=Et;let mn=Et.material;mn.allowOverride===!0&&Ae!==null&&(mn=Ae),Rt.layers.test(Me.layers)&&me(Rt,ce,Me,It,mn,Vt)}}function me($,ce,Me,Ae,Se,mt){$.onBeforeRender(O,ce,Me,Ae,Se,mt),$.modelViewMatrix.multiplyMatrices(Me.matrixWorldInverse,$.matrixWorld),$.normalMatrix.getNormalMatrix($.modelViewMatrix),Se.onBeforeRender(O,ce,Me,Ae,$,mt),Se.transparent===!0&&Se.side===xa&&Se.forceSinglePass===!1?(Se.side=gr,Se.needsUpdate=!0,O.renderBufferDirect(Me,ce,Ae,Se,$,mt),Se.side=Cl,Se.needsUpdate=!0,O.renderBufferDirect(Me,ce,Ae,Se,$,mt),Se.side=xa):O.renderBufferDirect(Me,ce,Ae,Se,$,mt),$.onAfterRender(O,ce,Me,Ae,Se,mt)}function De($,ce,Me){ce.isScene!==!0&&(ce=at);const Ae=k.get($),Se=P.state.lights,mt=P.state.shadowsArray,Et=Se.state.version,Rt=Yt.getParameters($,Se.state,mt,ce,Me),It=Yt.getProgramCacheKey(Rt);let Vt=Ae.programs;Ae.environment=$.isMeshStandardMaterial?ce.environment:null,Ae.fog=ce.fog,Ae.envMap=($.isMeshStandardMaterial?He:Fe).get($.envMap||Ae.environment),Ae.envMapRotation=Ae.environment!==null&&$.envMap===null?ce.environmentRotation:$.envMapRotation,Vt===void 0&&($.addEventListener("dispose",nn),Vt=new Map,Ae.programs=Vt);let mn=Vt.get(It);if(mn!==void 0){if(Ae.currentProgram===mn&&Ae.lightsStateVersion===Et)return je($,Rt),mn}else Rt.uniforms=Yt.getUniforms($),$.onBeforeCompile(Rt,O),mn=Yt.acquireProgram(Rt,It),Vt.set(It,mn),Ae.uniforms=Rt.uniforms;const Gt=Ae.uniforms;return(!$.isShaderMaterial&&!$.isRawShaderMaterial||$.clipping===!0)&&(Gt.clippingPlanes=Pt.uniform),je($,Rt),Ae.needsLights=pt($),Ae.lightsStateVersion=Et,Ae.needsLights&&(Gt.ambientLightColor.value=Se.state.ambient,Gt.lightProbe.value=Se.state.probe,Gt.directionalLights.value=Se.state.directional,Gt.directionalLightShadows.value=Se.state.directionalShadow,Gt.spotLights.value=Se.state.spot,Gt.spotLightShadows.value=Se.state.spotShadow,Gt.rectAreaLights.value=Se.state.rectArea,Gt.ltc_1.value=Se.state.rectAreaLTC1,Gt.ltc_2.value=Se.state.rectAreaLTC2,Gt.pointLights.value=Se.state.point,Gt.pointLightShadows.value=Se.state.pointShadow,Gt.hemisphereLights.value=Se.state.hemi,Gt.directionalShadowMap.value=Se.state.directionalShadowMap,Gt.directionalShadowMatrix.value=Se.state.directionalShadowMatrix,Gt.spotShadowMap.value=Se.state.spotShadowMap,Gt.spotLightMatrix.value=Se.state.spotLightMatrix,Gt.spotLightMap.value=Se.state.spotLightMap,Gt.pointShadowMap.value=Se.state.pointShadowMap,Gt.pointShadowMatrix.value=Se.state.pointShadowMatrix),Ae.currentProgram=mn,Ae.uniformsList=null,mn}function $e($){if($.uniformsList===null){const ce=$.currentProgram.getUniforms();$.uniformsList=Aw.seqWithValue(ce.seq,$.uniforms)}return $.uniformsList}function je($,ce){const Me=k.get($);Me.outputColorSpace=ce.outputColorSpace,Me.batching=ce.batching,Me.batchingColor=ce.batchingColor,Me.instancing=ce.instancing,Me.instancingColor=ce.instancingColor,Me.instancingMorph=ce.instancingMorph,Me.skinning=ce.skinning,Me.morphTargets=ce.morphTargets,Me.morphNormals=ce.morphNormals,Me.morphColors=ce.morphColors,Me.morphTargetsCount=ce.morphTargetsCount,Me.numClippingPlanes=ce.numClippingPlanes,Me.numIntersection=ce.numClipIntersection,Me.vertexAlphas=ce.vertexAlphas,Me.vertexTangents=ce.vertexTangents,Me.toneMapping=ce.toneMapping}function _t($,ce,Me,Ae,Se){ce.isScene!==!0&&(ce=at),pe.resetTextureUnits();const mt=ce.fog,Et=Ae.isMeshStandardMaterial?ce.environment:null,Rt=Q===null?O.outputColorSpace:Q.isXRRenderTarget===!0?Q.texture.colorSpace:vu,It=(Ae.isMeshStandardMaterial?He:Fe).get(Ae.envMap||Et),Vt=Ae.vertexColors===!0&&!!Me.attributes.color&&Me.attributes.color.itemSize===4,mn=!!Me.attributes.tangent&&(!!Ae.normalMap||Ae.anisotropy>0),Gt=!!Me.morphAttributes.position,un=!!Me.morphAttributes.normal,ni=!!Me.morphAttributes.color;let zi=ta;Ae.toneMapped&&(Q===null||Q.isXRRenderTarget===!0)&&(zi=O.toneMapping);const si=Me.morphAttributes.position||Me.morphAttributes.normal||Me.morphAttributes.color,Mn=si!==void 0?si.length:0,en=k.get(Ae),Cn=P.state.lights;if(Ft===!0&&(fn===!0||$!==ae)){const ps=$===ae&&Ae.id===se;Pt.setState(Ae,$,ps)}let tn=!1;Ae.version===en.__version?(en.needsLights&&en.lightsStateVersion!==Cn.state.version||en.outputColorSpace!==Rt||Se.isBatchedMesh&&en.batching===!1||!Se.isBatchedMesh&&en.batching===!0||Se.isBatchedMesh&&en.batchingColor===!0&&Se.colorTexture===null||Se.isBatchedMesh&&en.batchingColor===!1&&Se.colorTexture!==null||Se.isInstancedMesh&&en.instancing===!1||!Se.isInstancedMesh&&en.instancing===!0||Se.isSkinnedMesh&&en.skinning===!1||!Se.isSkinnedMesh&&en.skinning===!0||Se.isInstancedMesh&&en.instancingColor===!0&&Se.instanceColor===null||Se.isInstancedMesh&&en.instancingColor===!1&&Se.instanceColor!==null||Se.isInstancedMesh&&en.instancingMorph===!0&&Se.morphTexture===null||Se.isInstancedMesh&&en.instancingMorph===!1&&Se.morphTexture!==null||en.envMap!==It||Ae.fog===!0&&en.fog!==mt||en.numClippingPlanes!==void 0&&(en.numClippingPlanes!==Pt.numPlanes||en.numIntersection!==Pt.numIntersection)||en.vertexAlphas!==Vt||en.vertexTangents!==mn||en.morphTargets!==Gt||en.morphNormals!==un||en.morphColors!==ni||en.toneMapping!==zi||en.morphTargetsCount!==Mn)&&(tn=!0):(tn=!0,en.__version=Ae.version);let Vi=en.currentProgram;tn===!0&&(Vi=De(Ae,ce,Se));let Ds=!1,Ii=!1,Jr=!1;const qi=Vi.getUniforms(),Vr=en.uniforms;if(wt.useProgram(Vi.program)&&(Ds=!0,Ii=!0,Jr=!0),Ae.id!==se&&(se=Ae.id,Ii=!0),Ds||ae!==$){wt.buffers.depth.getReversed()&&$.reversedDepth!==!0&&($._reversedDepth=!0,$.updateProjectionMatrix()),qi.setValue(oe,"projectionMatrix",$.projectionMatrix),qi.setValue(oe,"viewMatrix",$.matrixWorldInverse);const ms=qi.map.cameraPosition;ms!==void 0&&ms.setValue(oe,At.setFromMatrixPosition($.matrixWorld)),zt.logarithmicDepthBuffer&&qi.setValue(oe,"logDepthBufFC",2/(Math.log($.far+1)/Math.LN2)),(Ae.isMeshPhongMaterial||Ae.isMeshToonMaterial||Ae.isMeshLambertMaterial||Ae.isMeshBasicMaterial||Ae.isMeshStandardMaterial||Ae.isShaderMaterial)&&qi.setValue(oe,"isOrthographic",$.isOrthographicCamera===!0),ae!==$&&(ae=$,Ii=!0,Jr=!0)}if(en.needsLights&&(Cn.state.directionalShadowMap.length>0&&qi.setValue(oe,"directionalShadowMap",Cn.state.directionalShadowMap,pe),Cn.state.spotShadowMap.length>0&&qi.setValue(oe,"spotShadowMap",Cn.state.spotShadowMap,pe),Cn.state.pointShadowMap.length>0&&qi.setValue(oe,"pointShadowMap",Cn.state.pointShadowMap,pe)),Se.isSkinnedMesh){qi.setOptional(oe,Se,"bindMatrix"),qi.setOptional(oe,Se,"bindMatrixInverse");const ps=Se.skeleton;ps&&(ps.boneTexture===null&&ps.computeBoneTexture(),qi.setValue(oe,"boneTexture",ps.boneTexture,pe))}Se.isBatchedMesh&&(qi.setOptional(oe,Se,"batchingTexture"),qi.setValue(oe,"batchingTexture",Se._matricesTexture,pe),qi.setOptional(oe,Se,"batchingIdTexture"),qi.setValue(oe,"batchingIdTexture",Se._indirectTexture,pe),qi.setOptional(oe,Se,"batchingColorTexture"),Se._colorsTexture!==null&&qi.setValue(oe,"batchingColorTexture",Se._colorsTexture,pe));const hs=Me.morphAttributes;if((hs.position!==void 0||hs.normal!==void 0||hs.color!==void 0)&&dt.update(Se,Me,Vi),(Ii||en.receiveShadow!==Se.receiveShadow)&&(en.receiveShadow=Se.receiveShadow,qi.setValue(oe,"receiveShadow",Se.receiveShadow)),Ae.isMeshGouraudMaterial&&Ae.envMap!==null&&(Vr.envMap.value=It,Vr.flipEnvMap.value=It.isCubeTexture&&It.isRenderTargetTexture===!1?-1:1),Ae.isMeshStandardMaterial&&Ae.envMap===null&&ce.environment!==null&&(Vr.envMapIntensity.value=ce.environmentIntensity),Vr.dfgLUT!==void 0&&(Vr.dfgLUT.value=kie()),Ii&&(qi.setValue(oe,"toneMappingExposure",O.toneMappingExposure),en.needsLights&&ct(Vr,Jr),mt&&Ae.fog===!0&&$t.refreshFogUniforms(Vr,mt),$t.refreshMaterialUniforms(Vr,Ae,Ce,he,P.state.transmissionRenderTarget[$.id]),Aw.upload(oe,$e(en),Vr,pe)),Ae.isShaderMaterial&&Ae.uniformsNeedUpdate===!0&&(Aw.upload(oe,$e(en),Vr,pe),Ae.uniformsNeedUpdate=!1),Ae.isSpriteMaterial&&qi.setValue(oe,"center",Se.center),qi.setValue(oe,"modelViewMatrix",Se.modelViewMatrix),qi.setValue(oe,"normalMatrix",Se.normalMatrix),qi.setValue(oe,"modelMatrix",Se.matrixWorld),Ae.isShaderMaterial||Ae.isRawShaderMaterial){const ps=Ae.uniformsGroups;for(let ms=0,Ed=ps.length;ms<Ed;ms++){const To=ps[ms];ht.update(To,Vi),ht.bind(To,Vi)}}return Vi}function ct($,ce){$.ambientLightColor.needsUpdate=ce,$.lightProbe.needsUpdate=ce,$.directionalLights.needsUpdate=ce,$.directionalLightShadows.needsUpdate=ce,$.pointLights.needsUpdate=ce,$.pointLightShadows.needsUpdate=ce,$.spotLights.needsUpdate=ce,$.spotLightShadows.needsUpdate=ce,$.rectAreaLights.needsUpdate=ce,$.hemisphereLights.needsUpdate=ce}function pt($){return $.isMeshLambertMaterial||$.isMeshToonMaterial||$.isMeshPhongMaterial||$.isMeshStandardMaterial||$.isShadowMaterial||$.isShaderMaterial&&$.lights===!0}this.getActiveCubeFace=function(){return q},this.getActiveMipmapLevel=function(){return j},this.getRenderTarget=function(){return Q},this.setRenderTargetTextures=function($,ce,Me){const Ae=k.get($);Ae.__autoAllocateDepthBuffer=$.resolveDepthBuffer===!1,Ae.__autoAllocateDepthBuffer===!1&&(Ae.__useRenderToTexture=!1),k.get($.texture).__webglTexture=ce,k.get($.depthTexture).__webglTexture=Ae.__autoAllocateDepthBuffer?void 0:Me,Ae.__hasExternalTextures=!0},this.setRenderTargetFramebuffer=function($,ce){const Me=k.get($);Me.__webglFramebuffer=ce,Me.__useDefaultFramebuffer=ce===void 0};const gt=oe.createFramebuffer();this.setRenderTarget=function($,ce=0,Me=0){Q=$,q=ce,j=Me;let Ae=null,Se=!1,mt=!1;if($){const Rt=k.get($);if(Rt.__useDefaultFramebuffer!==void 0){wt.bindFramebuffer(oe.FRAMEBUFFER,Rt.__webglFramebuffer),V.copy($.viewport),X.copy($.scissor),ee=$.scissorTest,wt.viewport(V),wt.scissor(X),wt.setScissorTest(ee),se=-1;return}else if(Rt.__webglFramebuffer===void 0)pe.setupRenderTarget($);else if(Rt.__hasExternalTextures)pe.rebindTextures($,k.get($.texture).__webglTexture,k.get($.depthTexture).__webglTexture);else if($.depthBuffer){const mn=$.depthTexture;if(Rt.__boundDepthTexture!==mn){if(mn!==null&&k.has(mn)&&($.width!==mn.image.width||$.height!==mn.image.height))throw new Error("WebGLRenderTarget: Attached DepthTexture is initialized to the incorrect size.");pe.setupDepthRenderbuffer($)}}const It=$.texture;(It.isData3DTexture||It.isDataArrayTexture||It.isCompressedArrayTexture)&&(mt=!0);const Vt=k.get($).__webglFramebuffer;$.isWebGLCubeRenderTarget?(Array.isArray(Vt[ce])?Ae=Vt[ce][Me]:Ae=Vt[ce],Se=!0):$.samples>0&&pe.useMultisampledRTT($)===!1?Ae=k.get($).__webglMultisampledFramebuffer:Array.isArray(Vt)?Ae=Vt[Me]:Ae=Vt,V.copy($.viewport),X.copy($.scissor),ee=$.scissorTest}else V.copy(Ee).multiplyScalar(Ce).floor(),X.copy(Ne).multiplyScalar(Ce).floor(),ee=rt;if(Me!==0&&(Ae=gt),wt.bindFramebuffer(oe.FRAMEBUFFER,Ae)&&wt.drawBuffers($,Ae),wt.viewport(V),wt.scissor(X),wt.setScissorTest(ee),Se){const Rt=k.get($.texture);oe.framebufferTexture2D(oe.FRAMEBUFFER,oe.COLOR_ATTACHMENT0,oe.TEXTURE_CUBE_MAP_POSITIVE_X+ce,Rt.__webglTexture,Me)}else if(mt){const Rt=ce;for(let It=0;It<$.textures.length;It++){const Vt=k.get($.textures[It]);oe.framebufferTextureLayer(oe.FRAMEBUFFER,oe.COLOR_ATTACHMENT0+It,Vt.__webglTexture,Me,Rt)}}else if($!==null&&Me!==0){const Rt=k.get($.texture);oe.framebufferTexture2D(oe.FRAMEBUFFER,oe.COLOR_ATTACHMENT0,oe.TEXTURE_2D,Rt.__webglTexture,Me)}se=-1},this.readRenderTargetPixels=function($,ce,Me,Ae,Se,mt,Et,Rt=0){if(!($&&$.isWebGLRenderTarget)){Ze("WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");return}let It=k.get($).__webglFramebuffer;if($.isWebGLCubeRenderTarget&&Et!==void 0&&(It=It[Et]),It){wt.bindFramebuffer(oe.FRAMEBUFFER,It);try{const Vt=$.textures[Rt],mn=Vt.format,Gt=Vt.type;if(!zt.textureFormatReadable(mn)){Ze("WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format.");return}if(!zt.textureTypeReadable(Gt)){Ze("WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.");return}ce>=0&&ce<=$.width-Ae&&Me>=0&&Me<=$.height-Se&&($.textures.length>1&&oe.readBuffer(oe.COLOR_ATTACHMENT0+Rt),oe.readPixels(ce,Me,Ae,Se,lt.convert(mn),lt.convert(Gt),mt))}finally{const Vt=Q!==null?k.get(Q).__webglFramebuffer:null;wt.bindFramebuffer(oe.FRAMEBUFFER,Vt)}}},this.readRenderTargetPixelsAsync=async function($,ce,Me,Ae,Se,mt,Et,Rt=0){if(!($&&$.isWebGLRenderTarget))throw new Error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");let It=k.get($).__webglFramebuffer;if($.isWebGLCubeRenderTarget&&Et!==void 0&&(It=It[Et]),It)if(ce>=0&&ce<=$.width-Ae&&Me>=0&&Me<=$.height-Se){wt.bindFramebuffer(oe.FRAMEBUFFER,It);const Vt=$.textures[Rt],mn=Vt.format,Gt=Vt.type;if(!zt.textureFormatReadable(mn))throw new Error("THREE.WebGLRenderer.readRenderTargetPixelsAsync: renderTarget is not in RGBA or implementation defined format.");if(!zt.textureTypeReadable(Gt))throw new Error("THREE.WebGLRenderer.readRenderTargetPixelsAsync: renderTarget is not in UnsignedByteType or implementation defined type.");const un=oe.createBuffer();oe.bindBuffer(oe.PIXEL_PACK_BUFFER,un),oe.bufferData(oe.PIXEL_PACK_BUFFER,mt.byteLength,oe.STREAM_READ),$.textures.length>1&&oe.readBuffer(oe.COLOR_ATTACHMENT0+Rt),oe.readPixels(ce,Me,Ae,Se,lt.convert(mn),lt.convert(Gt),0);const ni=Q!==null?k.get(Q).__webglFramebuffer:null;wt.bindFramebuffer(oe.FRAMEBUFFER,ni);const zi=oe.fenceSync(oe.SYNC_GPU_COMMANDS_COMPLETE,0);return oe.flush(),await iZ(oe,zi,4),oe.bindBuffer(oe.PIXEL_PACK_BUFFER,un),oe.getBufferSubData(oe.PIXEL_PACK_BUFFER,0,mt),oe.deleteBuffer(un),oe.deleteSync(zi),mt}else throw new Error("THREE.WebGLRenderer.readRenderTargetPixelsAsync: requested read bounds are out of range.")},this.copyFramebufferToTexture=function($,ce=null,Me=0){const Ae=Math.pow(2,-Me),Se=Math.floor($.image.width*Ae),mt=Math.floor($.image.height*Ae),Et=ce!==null?ce.x:0,Rt=ce!==null?ce.y:0;pe.setTexture2D($,0),oe.copyTexSubImage2D(oe.TEXTURE_2D,Me,0,0,Et,Rt,Se,mt),wt.unbindTexture()};const Lt=oe.createFramebuffer(),bt=oe.createFramebuffer();this.copyTextureToTexture=function($,ce,Me=null,Ae=null,Se=0,mt=null){mt===null&&(Se!==0?(cr("WebGLRenderer: copyTextureToTexture function signature has changed to support src and dst mipmap levels."),mt=Se,Se=0):mt=0);let Et,Rt,It,Vt,mn,Gt,un,ni,zi;const si=$.isCompressedTexture?$.mipmaps[mt]:$.image;if(Me!==null)Et=Me.max.x-Me.min.x,Rt=Me.max.y-Me.min.y,It=Me.isBox3?Me.max.z-Me.min.z:1,Vt=Me.min.x,mn=Me.min.y,Gt=Me.isBox3?Me.min.z:0;else{const hs=Math.pow(2,-Se);Et=Math.floor(si.width*hs),Rt=Math.floor(si.height*hs),$.isDataArrayTexture?It=si.depth:$.isData3DTexture?It=Math.floor(si.depth*hs):It=1,Vt=0,mn=0,Gt=0}Ae!==null?(un=Ae.x,ni=Ae.y,zi=Ae.z):(un=0,ni=0,zi=0);const Mn=lt.convert(ce.format),en=lt.convert(ce.type);let Cn;ce.isData3DTexture?(pe.setTexture3D(ce,0),Cn=oe.TEXTURE_3D):ce.isDataArrayTexture||ce.isCompressedArrayTexture?(pe.setTexture2DArray(ce,0),Cn=oe.TEXTURE_2D_ARRAY):(pe.setTexture2D(ce,0),Cn=oe.TEXTURE_2D),oe.pixelStorei(oe.UNPACK_FLIP_Y_WEBGL,ce.flipY),oe.pixelStorei(oe.UNPACK_PREMULTIPLY_ALPHA_WEBGL,ce.premultiplyAlpha),oe.pixelStorei(oe.UNPACK_ALIGNMENT,ce.unpackAlignment);const tn=oe.getParameter(oe.UNPACK_ROW_LENGTH),Vi=oe.getParameter(oe.UNPACK_IMAGE_HEIGHT),Ds=oe.getParameter(oe.UNPACK_SKIP_PIXELS),Ii=oe.getParameter(oe.UNPACK_SKIP_ROWS),Jr=oe.getParameter(oe.UNPACK_SKIP_IMAGES);oe.pixelStorei(oe.UNPACK_ROW_LENGTH,si.width),oe.pixelStorei(oe.UNPACK_IMAGE_HEIGHT,si.height),oe.pixelStorei(oe.UNPACK_SKIP_PIXELS,Vt),oe.pixelStorei(oe.UNPACK_SKIP_ROWS,mn),oe.pixelStorei(oe.UNPACK_SKIP_IMAGES,Gt);const qi=$.isDataArrayTexture||$.isData3DTexture,Vr=ce.isDataArrayTexture||ce.isData3DTexture;if($.isDepthTexture){const hs=k.get($),ps=k.get(ce),ms=k.get(hs.__renderTarget),Ed=k.get(ps.__renderTarget);wt.bindFramebuffer(oe.READ_FRAMEBUFFER,ms.__webglFramebuffer),wt.bindFramebuffer(oe.DRAW_FRAMEBUFFER,Ed.__webglFramebuffer);for(let To=0;To<It;To++)qi&&(oe.framebufferTextureLayer(oe.READ_FRAMEBUFFER,oe.COLOR_ATTACHMENT0,k.get($).__webglTexture,Se,Gt+To),oe.framebufferTextureLayer(oe.DRAW_FRAMEBUFFER,oe.COLOR_ATTACHMENT0,k.get(ce).__webglTexture,mt,zi+To)),oe.blitFramebuffer(Vt,mn,Et,Rt,un,ni,Et,Rt,oe.DEPTH_BUFFER_BIT,oe.NEAREST);wt.bindFramebuffer(oe.READ_FRAMEBUFFER,null),wt.bindFramebuffer(oe.DRAW_FRAMEBUFFER,null)}else if(Se!==0||$.isRenderTargetTexture||k.has($)){const hs=k.get($),ps=k.get(ce);wt.bindFramebuffer(oe.READ_FRAMEBUFFER,Lt),wt.bindFramebuffer(oe.DRAW_FRAMEBUFFER,bt);for(let ms=0;ms<It;ms++)qi?oe.framebufferTextureLayer(oe.READ_FRAMEBUFFER,oe.COLOR_ATTACHMENT0,hs.__webglTexture,Se,Gt+ms):oe.framebufferTexture2D(oe.READ_FRAMEBUFFER,oe.COLOR_ATTACHMENT0,oe.TEXTURE_2D,hs.__webglTexture,Se),Vr?oe.framebufferTextureLayer(oe.DRAW_FRAMEBUFFER,oe.COLOR_ATTACHMENT0,ps.__webglTexture,mt,zi+ms):oe.framebufferTexture2D(oe.DRAW_FRAMEBUFFER,oe.COLOR_ATTACHMENT0,oe.TEXTURE_2D,ps.__webglTexture,mt),Se!==0?oe.blitFramebuffer(Vt,mn,Et,Rt,un,ni,Et,Rt,oe.COLOR_BUFFER_BIT,oe.NEAREST):Vr?oe.copyTexSubImage3D(Cn,mt,un,ni,zi+ms,Vt,mn,Et,Rt):oe.copyTexSubImage2D(Cn,mt,un,ni,Vt,mn,Et,Rt);wt.bindFramebuffer(oe.READ_FRAMEBUFFER,null),wt.bindFramebuffer(oe.DRAW_FRAMEBUFFER,null)}else Vr?$.isDataTexture||$.isData3DTexture?oe.texSubImage3D(Cn,mt,un,ni,zi,Et,Rt,It,Mn,en,si.data):ce.isCompressedArrayTexture?oe.compressedTexSubImage3D(Cn,mt,un,ni,zi,Et,Rt,It,Mn,si.data):oe.texSubImage3D(Cn,mt,un,ni,zi,Et,Rt,It,Mn,en,si):$.isDataTexture?oe.texSubImage2D(oe.TEXTURE_2D,mt,un,ni,Et,Rt,Mn,en,si.data):$.isCompressedTexture?oe.compressedTexSubImage2D(oe.TEXTURE_2D,mt,un,ni,si.width,si.height,Mn,si.data):oe.texSubImage2D(oe.TEXTURE_2D,mt,un,ni,Et,Rt,Mn,en,si);oe.pixelStorei(oe.UNPACK_ROW_LENGTH,tn),oe.pixelStorei(oe.UNPACK_IMAGE_HEIGHT,Vi),oe.pixelStorei(oe.UNPACK_SKIP_PIXELS,Ds),oe.pixelStorei(oe.UNPACK_SKIP_ROWS,Ii),oe.pixelStorei(oe.UNPACK_SKIP_IMAGES,Jr),mt===0&&ce.generateMipmaps&&oe.generateMipmap(Cn),wt.unbindTexture()},this.initRenderTarget=function($){k.get($).__webglFramebuffer===void 0&&pe.setupRenderTarget($)},this.initTexture=function($){$.isCubeTexture?pe.setTextureCube($,0):$.isData3DTexture?pe.setTexture3D($,0):$.isDataArrayTexture||$.isCompressedArrayTexture?pe.setTexture2DArray($,0):pe.setTexture2D($,0),wt.unbindTexture()},this.resetState=function(){q=0,j=0,Q=null,wt.reset(),Ot.reset()},typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}get coordinateSystem(){return Ba}get outputColorSpace(){return this._outputColorSpace}set outputColorSpace(e){this._outputColorSpace=e;const t=this.getContext();t.drawingBufferColorSpace=Nn._getDrawingBufferColorSpace(e),t.unpackColorSpace=Nn._getUnpackColorSpace()}}const Hie=Object.freeze(Object.defineProperty({__proto__:null,ACESFilmicToneMapping:L1,AddEquation:La,AddOperation:JU,AdditiveAnimationBlendMode:tL,AdditiveBlending:V0,AgXToneMapping:hC,AlphaFormat:mC,AlwaysCompare:bC,AlwaysDepth:sx,AlwaysStencilFunc:Qw,AmbientLight:FL,AnimationAction:R6,AnimationClip:u1,AnimationLoader:HK,AnimationMixer:gQ,AnimationObjectGroup:pQ,AnimationUtils:zK,ArcCurve:l6,ArrayCamera:HL,ArrowHelper:GQ,AttachedBindMode:lO,Audio:A6,AudioAnalyser:rQ,AudioContext:kL,AudioListener:tQ,AudioLoader:QK,AxesHelper:kQ,BackSide:gr,BasicDepthPacking:Ok,BasicShadowMap:YU,BatchedMesh:i6,Bone:cL,BooleanKeyframeTrack:Cy,Box2:MQ,Box3:_o,Box3Helper:zQ,BoxGeometry:Xh,BoxHelper:FQ,BufferAttribute:Ji,BufferGeometry:Qn,BufferGeometryLoader:M6,ByteType:_h,Cache:nd,Camera:G1,CameraHelper:IQ,CanvasTexture:lK,CapsuleGeometry:OC,CatmullRomCurve3:u6,CineonToneMapping:dC,CircleGeometry:UC,ClampToEdgeWrapping:Dr,Clock:WL,Color:Kt,ColorKeyframeTrack:OL,ColorManagement:Nn,CompressedArrayTexture:aK,CompressedCubeTexture:oK,CompressedTexture:DC,CompressedTextureLoader:WK,ConeGeometry:q1,ConstantAlphaFactor:Mk,ConstantColorFactor:Tk,Controls:WQ,CubeCamera:uL,CubeDepthTexture:fL,CubeReflectionMapping:ol,CubeRefractionMapping:oc,CubeTexture:Im,CubeTextureLoader:T6,CubeUVReflectionMapping:Ph,CubicBezierCurve:pL,CubicBezierCurve3:c6,CubicInterpolant:v6,CullFaceBack:$w,CullFaceFront:jU,CullFaceFrontBack:LY,CullFaceNone:$U,Curve:af,CurvePath:d6,CustomBlending:A0,CustomToneMapping:eL,CylinderGeometry:kx,Cylindrical:EQ,Data3DTexture:SC,DataArrayTexture:V1,DataTexture:Ol,DataTextureLoader:UL,DataUtils:m0,DecrementStencilOp:Ik,DecrementWrapStencilOp:zk,DefaultLoadingManager:S6,DepthFormat:ba,DepthStencilFormat:ho,DepthTexture:Ga,DetachedBindMode:wk,DirectionalLight:IL,DirectionalLightHelper:BQ,DiscreteInterpolant:x6,DodecahedronGeometry:LC,DoubleSide:xa,DstAlphaFactor:sC,DstColorFactor:oC,DynamicCopyUsage:YY,DynamicDrawUsage:tm,DynamicReadUsage:XY,EdgesGeometry:o6,EllipseCurve:PC,EqualCompare:_C,EqualDepth:ox,EqualStencilFunc:Hk,EquirectangularReflectionMapping:Lh,EquirectangularRefractionMapping:ym,Euler:ll,EventDispatcher:Gl,ExternalTexture:dL,ExtrudeGeometry:BC,FileLoader:mu,Float16BufferAttribute:lL,Float32BufferAttribute:hn,FloatType:Ci,Fog:AC,FogExp2:MC,FramebufferTexture:NC,FrontSide:Cl,Frustum:Ry,FrustumArray:W1,GLBufferAttribute:bQ,GLSL1:KY,GLSL3:uO,GreaterCompare:vC,GreaterDepth:ux,GreaterEqualCompare:Gx,GreaterEqualDepth:lx,GreaterEqualStencilFunc:$k,GreaterStencilFunc:qk,GridHelper:LQ,Group:Lv,HalfFloatType:vi,HemisphereLight:LL,HemisphereLightHelper:UQ,IcosahedronGeometry:X1,ImageBitmapLoader:KK,ImageLoader:c1,ImageUtils:jk,IncrementStencilOp:Bk,IncrementWrapStencilOp:Fk,InstancedBufferAttribute:ic,InstancedBufferGeometry:E6,InstancedInterleavedBuffer:N6,InstancedMesh:n6,Int16BufferAttribute:FZ,Int32BufferAttribute:zZ,Int8BufferAttribute:PZ,IntType:Hs,InterleavedBuffer:H1,InterleavedBufferAttribute:Sm,Interpolant:j1,InterpolateDiscrete:t1,InterpolateLinear:Kw,InterpolateSmooth:Ew,InterpolationSamplingMode:JY,InterpolationSamplingType:QY,InvertStencilOp:Vk,KeepStencilOp:Yp,KeyframeTrack:fc,LOD:e6,LatheGeometry:IC,Layers:yx,LessCompare:zx,LessDepth:ax,LessEqualCompare:Vx,LessEqualDepth:Oh,LessEqualStencilFunc:Wk,LessStencilFunc:kk,Light:Vm,LightProbe:GL,Line:Tm,Line3:RQ,LineBasicMaterial:bo,LineCurve:mL,LineCurve3:f6,LineDashedMaterial:CL,LineLoop:r6,LineSegments:xd,LinearFilter:ei,LinearInterpolant:DL,LinearMipMapLinearFilter:jw,LinearMipMapNearestFilter:IY,LinearMipmapLinearFilter:Pa,LinearMipmapNearestFilter:dm,LinearSRGBColorSpace:vu,LinearToneMapping:cC,LinearTransfer:hy,Loader:cl,LoaderUtils:pO,LoadingManager:qC,LoopOnce:Ck,LoopPingPong:Dk,LoopRepeat:Nk,MOUSE:r0,Material:Ta,MaterialLoader:XC,MathUtils:oL,Matrix2:K1,Matrix3:Zn,Matrix4:gn,MaxEquation:KU,Mesh:ar,MeshBasicMaterial:lo,MeshDepthMaterial:AL,MeshDistanceMaterial:wL,MeshLambertMaterial:ML,MeshMatcapMaterial:RL,MeshNormalMaterial:EL,MeshPhongMaterial:SL,MeshPhysicalMaterial:bL,MeshStandardMaterial:WC,MeshToonMaterial:TL,MinEquation:ZU,MirroredRepeatWrapping:Ih,MixOperation:QU,MultiplyBlending:k0,MultiplyOperation:Ix,NearestFilter:Ki,NearestMipMapLinearFilter:BY,NearestMipMapNearestFilter:PY,NearestMipmapLinearFilter:jc,NearestMipmapNearestFilter:P1,NeutralToneMapping:pC,NeverCompare:yC,NeverDepth:rx,NeverStencilFunc:Gk,NoBlending:yo,NoColorSpace:Jo,NoNormalPacking:Mw,NoToneMapping:ta,NormalAnimationBlendMode:gC,NormalBlending:Nl,NormalGAPacking:Uk,NormalRGPacking:iL,NotEqualCompare:xC,NotEqualDepth:cx,NotEqualStencilFunc:Xk,NumberKeyframeTrack:o1,Object3D:Fi,ObjectLoader:YK,ObjectSpaceNormalMap:nL,OctahedronGeometry:$1,OneFactor:nC,OneMinusConstantAlphaFactor:Ak,OneMinusConstantColorFactor:Ek,OneMinusDstAlphaFactor:aC,OneMinusDstColorFactor:lC,OneMinusSrcAlphaFactor:ix,OneMinusSrcColorFactor:rC,OrthographicCamera:rc,PCFShadowMap:M0,PCFSoftShadowMap:MT,PMREMGenerator:yO,Path:nR,PerspectiveCamera:Br,Plane:Hc,PlaneGeometry:$h,PlaneHelper:VQ,PointLight:BL,PointLightHelper:DQ,Points:s6,PointsMaterial:CC,PolarGridHelper:PQ,PolyhedronGeometry:zm,PositionalAudio:iQ,PropertyBinding:ki,PropertyMixer:w6,QuadraticBezierCurve:gL,QuadraticBezierCurve3:yL,Quaternion:Va,QuaternionKeyframeTrack:Y1,QuaternionLinearInterpolant:b6,R11_EAC_Format:X0,RED_GREEN_RGTC2_Format:vm,RED_RGTC1_Format:cy,REVISION:Lm,RG11_EAC_Format:_m,RGBADepthPacking:GY,RGBAFormat:Qi,RGBAIntegerFormat:Ay,RGBA_ASTC_10x10_Format:ay,RGBA_ASTC_10x5_Format:iy,RGBA_ASTC_10x6_Format:ry,RGBA_ASTC_10x8_Format:sy,RGBA_ASTC_12x10_Format:oy,RGBA_ASTC_12x12_Format:ly,RGBA_ASTC_4x4_Format:Y0,RGBA_ASTC_5x4_Format:Z0,RGBA_ASTC_5x5_Format:K0,RGBA_ASTC_6x5_Format:Q0,RGBA_ASTC_6x6_Format:J0,RGBA_ASTC_8x5_Format:ey,RGBA_ASTC_8x6_Format:ty,RGBA_ASTC_8x8_Format:ny,RGBA_BPTC_Format:uy,RGBA_ETC2_EAC_Format:q0,RGBA_PVRTC_2BPPV1_Format:px,RGBA_PVRTC_4BPPV1_Format:hx,RGBA_S3TC_DXT1_Format:bh,RGBA_S3TC_DXT3_Format:Sh,RGBA_S3TC_DXT5_Format:Th,RGBDepthPacking:kY,RGBFormat:Fx,RGBIntegerFormat:Rk,RGB_BPTC_SIGNED_Format:Yw,RGB_BPTC_UNSIGNED_Format:Zw,RGB_ETC1_Format:H0,RGB_ETC2_Format:W0,RGB_PVRTC_2BPPV1_Format:dx,RGB_PVRTC_4BPPV1_Format:fx,RGB_S3TC_DXT1_Format:xh,RGDepthPacking:HY,RGFormat:po,RGIntegerFormat:My,RawShaderMaterial:xL,Ray:wy,Raycaster:$L,RectAreaLight:zL,RedFormat:Pm,RedIntegerFormat:Bm,ReinhardToneMapping:fC,RenderTarget:sf,RenderTarget3D:yQ,RepeatWrapping:Bh,ReplaceStencilOp:Pk,ReverseSubtractEquation:tC,RingGeometry:FC,SIGNED_R11_EAC_Format:$0,SIGNED_RED_GREEN_RGTC2_Format:dy,SIGNED_RED_RGTC1_Format:fy,SIGNED_RG11_EAC_Format:j0,SRGBColorSpace:ea,SRGBTransfer:an,Scene:Fm,ShaderChunk:ui,ShaderLib:Wc,ShaderMaterial:ul,ShadowMaterial:vL,Shape:R0,ShapeGeometry:zC,ShapePath:HQ,ShapeUtils:Zc,ShortType:vh,Skeleton:RC,SkeletonHelper:NQ,SkinnedMesh:t6,Source:nm,Sphere:Sa,SphereGeometry:Hx,Spherical:gO,SphericalHarmonics3:VL,SplineCurve:_L,SpotLight:Z1,SpotLightHelper:CQ,Sprite:Jk,SpriteMaterial:wC,SrcAlphaFactor:nx,SrcAlphaSaturateFactor:uC,SrcColorFactor:iC,StaticCopyUsage:jY,StaticDrawUsage:xm,StaticReadUsage:qY,StereoCamera:JK,StreamCopyUsage:ZY,StreamDrawUsage:WY,StreamReadUsage:$Y,StringKeyframeTrack:Ny,SubtractEquation:eC,SubtractiveBlending:G0,TOUCH:s0,TangentSpaceNormalMap:Kc,TetrahedronGeometry:VC,Texture:sr,TextureLoader:qK,TextureUtils:YQ,Timer:SQ,TimestampQuery:Yc,TorusGeometry:GC,TorusKnotGeometry:kC,Triangle:El,TriangleFanDrawMode:VY,TriangleStripDrawMode:zY,TrianglesDrawMode:FY,TubeGeometry:HC,UVMapping:Uh,Uint16BufferAttribute:TC,Uint32BufferAttribute:EC,Uint8BufferAttribute:BZ,Uint8ClampedBufferAttribute:IZ,Uniform:_Q,UniformsGroup:xQ,UniformsLib:sn,UniformsUtils:Kk,UnsignedByteType:ir,UnsignedInt101111Type:z1,UnsignedInt248Type:Dl,UnsignedInt5999Type:F1,UnsignedIntType:Hi,UnsignedShort4444Type:B1,UnsignedShort5551Type:I1,UnsignedShortType:Zu,VSMShadowMap:$c,Vector2:tt,Vector3:ne,Vector4:zn,VectorKeyframeTrack:l1,VideoFrameTexture:sK,VideoTexture:a6,WebGL3DRenderTarget:EZ,WebGLArrayRenderTarget:TZ,WebGLCoordinateSystem:Ba,WebGLCubeRenderTarget:k1,WebGLRenderTarget:sl,WebGLRenderer:jL,WebGLUtils:I6,WebGPUCoordinateSystem:Il,WebXRController:wT,WireframeGeometry:y6,WrapAroundEnding:n1,ZeroCurvatureEnding:h0,ZeroFactor:Qf,ZeroSlopeEnding:p0,ZeroStencilOp:Lk,createCanvasElement:sL,error:Ze,getConsoleFunction:nZ,log:gx,setConsoleFunction:tZ,warn:Ve,warnOnce:cr},Symbol.toStringTag,{value:"Module"}));var S3={exports:{}},T3={},E3={exports:{}},M3={};var pV;function Wie(){if(pV)return M3;pV=1;var r=Bx();function e(p,y){return p===y&&(p!==0||1/p===1/y)||p!==p&&y!==y}var t=typeof Object.is=="function"?Object.is:e,n=r.useState,i=r.useEffect,s=r.useLayoutEffect,a=r.useDebugValue;function o(p,y){var _=y(),v=n({inst:{value:_,getSnapshot:y}}),b=v[0].inst,E=v[1];return s(function(){b.value=_,b.getSnapshot=y,l(b)&&E({inst:b})},[p,_,y]),i(function(){return l(b)&&E({inst:b}),p(function(){l(b)&&E({inst:b})})},[p]),a(_),_}function l(p){var y=p.getSnapshot;p=p.value;try{var _=y();return!t(p,_)}catch{return!0}}function c(p,y){return y()}var d=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?c:o;return M3.useSyncExternalStore=r.useSyncExternalStore!==void 0?r.useSyncExternalStore:d,M3}var mV;function qie(){return mV||(mV=1,E3.exports=Wie()),E3.exports}var gV;function Xie(){if(gV)return T3;gV=1;var r=Bx(),e=qie();function t(c,d){return c===d&&(c!==0||1/c===1/d)||c!==c&&d!==d}var n=typeof Object.is=="function"?Object.is:t,i=e.useSyncExternalStore,s=r.useRef,a=r.useEffect,o=r.useMemo,l=r.useDebugValue;return T3.useSyncExternalStoreWithSelector=function(c,d,p,y,_){var v=s(null);if(v.current===null){var b={hasValue:!1,value:null};v.current=b}else b=v.current;v=o(function(){function T(U){if(!M){if(M=!0,R=U,U=y(U),_!==void 0&&b.hasValue){var L=b.value;if(_(L,U))return N=L}return N=U}if(L=N,n(R,U))return L;var F=y(U);return _!==void 0&&_(L,F)?(R=U,L):(R=U,N=F)}var M=!1,R,N,P=p===void 0?null:p;return[function(){return T(d())},P===null?void 0:function(){return T(P())}]},[d,p,y,_]);var E=i(c,v[0],v[1]);return a(function(){b.hasValue=!0,b.value=E},[E]),l(E),E},T3}var yV;function $ie(){return yV||(yV=1,S3.exports=Xie()),S3.exports}var jie=$ie();const Yie=Ey(jie),_V=r=>{let e;const t=new Set,n=(c,d)=>{const p=typeof c=="function"?c(e):c;if(!Object.is(p,e)){const y=e;e=d??(typeof p!="object"||p===null)?p:Object.assign({},e,p),t.forEach(_=>_(e,y))}},i=()=>e,o={setState:n,getState:i,getInitialState:()=>l,subscribe:c=>(t.add(c),()=>t.delete(c))},l=e=r(n,i,o);return o},Zie=(r=>r?_V(r):_V),{useSyncExternalStoreWithSelector:Kie}=Yie,Qie=r=>r;function Jie(r,e=Qie,t){const n=Kie(r.subscribe,r.getState,r.getInitialState,e,t);return ve.useDebugValue(n),n}const vV=(r,e)=>{const t=Zie(r),n=(i,s=e)=>Jie(t,i,s);return Object.assign(n,t),n},F6=((r,e)=>r?vV(r,e):vV),ere=r=>typeof r=="object"&&typeof r.then=="function",y0=[];function z6(r,e,t=(n,i)=>n===i){if(r===e)return!0;if(!r||!e)return!1;const n=r.length;if(e.length!==n)return!1;for(let i=0;i<n;i++)if(!t(r[i],e[i]))return!1;return!0}function V6(r,e=null,t=!1,n={}){e===null&&(e=[r]);for(const s of y0)if(z6(e,s.keys,s.equal)){if(t)return;if(Object.prototype.hasOwnProperty.call(s,"error"))throw s.error;if(Object.prototype.hasOwnProperty.call(s,"response"))return n.lifespan&&n.lifespan>0&&(s.timeout&&clearTimeout(s.timeout),s.timeout=setTimeout(s.remove,n.lifespan)),s.response;if(!t)throw s.promise}const i={keys:e,equal:n.equal,remove:()=>{const s=y0.indexOf(i);s!==-1&&y0.splice(s,1)},promise:(ere(r)?r:r(...e)).then(s=>{i.response=s,n.lifespan&&n.lifespan>0&&(i.timeout=setTimeout(i.remove,n.lifespan))}).catch(s=>i.error=s)};if(y0.push(i),!t)throw i.promise}const tre=(r,e,t)=>V6(r,e,!1,t),nre=(r,e,t)=>{V6(r,e,!0,t)},ire=r=>{if(r===void 0||r.length===0)y0.splice(0,y0.length);else{const e=y0.find(t=>z6(r,t.keys,t.equal));e&&e.remove()}};var A3={exports:{}},w3={exports:{}},R3={exports:{}},C3={};var xV;function rre(){return xV||(xV=1,(function(r){function e(V,X){var ee=V.length;V.push(X);e:for(;0<ee;){var fe=ee-1>>>1,Y=V[fe];if(0<i(Y,X))V[fe]=X,V[ee]=Y,ee=fe;else break e}}function t(V){return V.length===0?null:V[0]}function n(V){if(V.length===0)return null;var X=V[0],ee=V.pop();if(ee!==X){V[0]=ee;e:for(var fe=0,Y=V.length,K=Y>>>1;fe<K;){var he=2*(fe+1)-1,Ce=V[he],Ie=he+1,ut=V[Ie];if(0>i(Ce,ee))Ie<Y&&0>i(ut,Ce)?(V[fe]=ut,V[Ie]=ee,fe=Ie):(V[fe]=Ce,V[he]=ee,fe=he);else if(Ie<Y&&0>i(ut,ee))V[fe]=ut,V[Ie]=ee,fe=Ie;else break e}}return X}function i(V,X){var ee=V.sortIndex-X.sortIndex;return ee!==0?ee:V.id-X.id}if(r.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var s=performance;r.unstable_now=function(){return s.now()}}else{var a=Date,o=a.now();r.unstable_now=function(){return a.now()-o}}var l=[],c=[],d=1,p=null,y=3,_=!1,v=!1,b=!1,E=typeof setTimeout=="function"?setTimeout:null,T=typeof clearTimeout=="function"?clearTimeout:null,M=typeof setImmediate<"u"?setImmediate:null;function R(V){for(var X=t(c);X!==null;){if(X.callback===null)n(c);else if(X.startTime<=V)n(c),X.sortIndex=X.expirationTime,e(l,X);else break;X=t(c)}}function N(V){if(b=!1,R(V),!v)if(t(l)!==null)v=!0,se();else{var X=t(c);X!==null&&ae(N,X.startTime-V)}}var P=!1,U=-1,L=5,F=-1;function O(){return!(r.unstable_now()-F<L)}function B(){if(P){var V=r.unstable_now();F=V;var X=!0;try{e:{v=!1,b&&(b=!1,T(U),U=-1),_=!0;var ee=y;try{t:{for(R(V),p=t(l);p!==null&&!(p.expirationTime>V&&O());){var fe=p.callback;if(typeof fe=="function"){p.callback=null,y=p.priorityLevel;var Y=fe(p.expirationTime<=V);if(V=r.unstable_now(),typeof Y=="function"){p.callback=Y,R(V),X=!0;break t}p===t(l)&&n(l),R(V)}else n(l);p=t(l)}if(p!==null)X=!0;else{var K=t(c);K!==null&&ae(N,K.startTime-V),X=!1}}break e}finally{p=null,y=ee,_=!1}X=void 0}}finally{X?q():P=!1}}}var q;if(typeof M=="function")q=function(){M(B)};else if(typeof MessageChannel<"u"){var j=new MessageChannel,Q=j.port2;j.port1.onmessage=B,q=function(){Q.postMessage(null)}}else q=function(){E(B,0)};function se(){P||(P=!0,q())}function ae(V,X){U=E(function(){V(r.unstable_now())},X)}r.unstable_IdlePriority=5,r.unstable_ImmediatePriority=1,r.unstable_LowPriority=4,r.unstable_NormalPriority=3,r.unstable_Profiling=null,r.unstable_UserBlockingPriority=2,r.unstable_cancelCallback=function(V){V.callback=null},r.unstable_continueExecution=function(){v||_||(v=!0,se())},r.unstable_forceFrameRate=function(V){0>V||125<V?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):L=0<V?Math.floor(1e3/V):5},r.unstable_getCurrentPriorityLevel=function(){return y},r.unstable_getFirstCallbackNode=function(){return t(l)},r.unstable_next=function(V){switch(y){case 1:case 2:case 3:var X=3;break;default:X=y}var ee=y;y=X;try{return V()}finally{y=ee}},r.unstable_pauseExecution=function(){},r.unstable_requestPaint=function(){},r.unstable_runWithPriority=function(V,X){switch(V){case 1:case 2:case 3:case 4:case 5:break;default:V=3}var ee=y;y=V;try{return X()}finally{y=ee}},r.unstable_scheduleCallback=function(V,X,ee){var fe=r.unstable_now();switch(typeof ee=="object"&&ee!==null?(ee=ee.delay,ee=typeof ee=="number"&&0<ee?fe+ee:fe):ee=fe,V){case 1:var Y=-1;break;case 2:Y=250;break;case 5:Y=1073741823;break;case 4:Y=1e4;break;default:Y=5e3}return Y=ee+Y,V={id:d++,callback:X,priorityLevel:V,startTime:ee,expirationTime:Y,sortIndex:-1},ee>fe?(V.sortIndex=ee,e(c,V),t(l)===null&&V===t(c)&&(b?(T(U),U=-1):b=!0,ae(N,ee-fe))):(V.sortIndex=Y,e(l,V),v||_||(v=!0,se())),V},r.unstable_shouldYield=O,r.unstable_wrapCallback=function(V){var X=y;return function(){var ee=y;y=X;try{return V.apply(this,arguments)}finally{y=ee}}}})(C3)),C3}var bV;function sre(){return bV||(bV=1,R3.exports=rre()),R3.exports}var SV;function are(){return SV||(SV=1,(function(r){r.exports=function(e){function t(h,m,S,w){return new wb(h,m,S,w)}function n(){}function i(h){var m="https://react.dev/errors/"+h;if(1<arguments.length){m+="?args[]="+encodeURIComponent(arguments[1]);for(var S=2;S<arguments.length;S++)m+="&args[]="+encodeURIComponent(arguments[S])}return"Minified React error #"+h+"; visit "+m+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function s(h){return h===null||typeof h!="object"?null:(h=Lb&&h[Lb]||h["@@iterator"],typeof h=="function"?h:null)}function a(h){if(h==null)return null;if(typeof h=="function")return h.$$typeof===Fd?null:h.displayName||h.name||null;if(typeof h=="string")return h;switch(h){case hp:return"Fragment";case ql:return"Portal";case Ub:return"Profiler";case Ob:return"StrictMode";case c_:return"Suspense";case Af:return"SuspenseList"}if(typeof h=="object")switch(h.$$typeof){case Nu:return(h.displayName||"Context")+".Provider";case Mf:return(h._context.displayName||"Context")+".Consumer";case pp:var m=h.render;return h=h.displayName,h||(h=m.displayName||m.name||"",h=h!==""?"ForwardRef("+h+")":"ForwardRef"),h;case dg:return m=h.displayName||null,m!==null?m:a(h.type)||"Memo";case Xl:m=h._payload,h=h._init;try{return a(h(m))}catch{}}return null}function o(h){if(f_===void 0)try{throw Error()}catch(S){var m=S.stack.trim().match(/\n( *(at )?)/);f_=m&&m[1]||"",Pb=-1<S.stack.indexOf(`
    at`)?" (<anonymous>)":-1<S.stack.indexOf("@")?"@unknown:0:0":""}return`
`+f_+h+Pb}function l(h,m){if(!h||wf)return"";wf=!0;var S=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var w={DetermineComponentFrameRoot:function(){try{if(m){var rn=function(){throw Error()};if(Object.defineProperty(rn.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(rn,[])}catch(Kn){var cn=Kn}Reflect.construct(h,[],rn)}else{try{rn.call()}catch(Kn){cn=Kn}h.call(rn.prototype)}}else{try{throw Error()}catch(Kn){cn=Kn}(rn=h())&&typeof rn.catch=="function"&&rn.catch(function(){})}}catch(Kn){if(Kn&&cn&&typeof Kn.stack=="string")return[Kn.stack,cn.stack]}return[null,null]}};w.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var D=Object.getOwnPropertyDescriptor(w.DetermineComponentFrameRoot,"name");D&&D.configurable&&Object.defineProperty(w.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var z=w.DetermineComponentFrameRoot(),ie=z[0],ye=z[1];if(ie&&ye){var Le=ie.split(`
`),ft=ye.split(`
`);for(D=w=0;w<Le.length&&!Le[w].includes("DetermineComponentFrameRoot");)w++;for(;D<ft.length&&!ft[D].includes("DetermineComponentFrameRoot");)D++;if(w===Le.length||D===ft.length)for(w=Le.length-1,D=ft.length-1;1<=w&&0<=D&&Le[w]!==ft[D];)D--;for(;1<=w&&0<=D;w--,D--)if(Le[w]!==ft[D]){if(w!==1||D!==1)do if(w--,D--,0>D||Le[w]!==ft[D]){var Ht=`
`+Le[w].replace(" at new "," at ");return h.displayName&&Ht.includes("<anonymous>")&&(Ht=Ht.replace("<anonymous>",h.displayName)),Ht}while(1<=w&&0<=D);break}}}finally{wf=!1,Error.prepareStackTrace=S}return(S=h?h.displayName||h.name:"")?o(S):""}function c(h){switch(h.tag){case 26:case 27:case 5:return o(h.type);case 16:return o("Lazy");case 13:return o("Suspense");case 19:return o("SuspenseList");case 0:case 15:return h=l(h.type,!1),h;case 11:return h=l(h.type.render,!1),h;case 1:return h=l(h.type,!0),h;default:return""}}function d(h){try{var m="";do m+=c(h),h=h.return;while(h);return m}catch(S){return`
Error generating stack: `+S.message+`
`+S.stack}}function p(h){var m=h,S=h;if(h.alternate)for(;m.return;)m=m.return;else{h=m;do m=h,(m.flags&4098)!==0&&(S=m.return),h=m.return;while(h)}return m.tag===3?S:null}function y(h){if(p(h)!==h)throw Error(i(188))}function _(h){var m=h.alternate;if(!m){if(m=p(h),m===null)throw Error(i(188));return m!==h?null:h}for(var S=h,w=m;;){var D=S.return;if(D===null)break;var z=D.alternate;if(z===null){if(w=D.return,w!==null){S=w;continue}break}if(D.child===z.child){for(z=D.child;z;){if(z===S)return y(D),h;if(z===w)return y(D),m;z=z.sibling}throw Error(i(188))}if(S.return!==w.return)S=D,w=z;else{for(var ie=!1,ye=D.child;ye;){if(ye===S){ie=!0,S=D,w=z;break}if(ye===w){ie=!0,w=D,S=z;break}ye=ye.sibling}if(!ie){for(ye=z.child;ye;){if(ye===S){ie=!0,S=z,w=D;break}if(ye===w){ie=!0,w=z,S=D;break}ye=ye.sibling}if(!ie)throw Error(i(189))}}if(S.alternate!==w)throw Error(i(190))}if(S.tag!==3)throw Error(i(188));return S.stateNode.current===S?h:m}function v(h){var m=h.tag;if(m===5||m===26||m===27||m===6)return h;for(h=h.child;h!==null;){if(m=v(h),m!==null)return m;h=h.sibling}return null}function b(h){var m=h.tag;if(m===5||m===26||m===27||m===6)return h;for(h=h.child;h!==null;){if(h.tag!==4&&(m=b(h),m!==null))return m;h=h.sibling}return null}function E(h){return{current:h}}function T(h){0>Rc||(h.current=bg[Rc],bg[Rc]=null,Rc--)}function M(h,m){Rc++,bg[Rc]=h.current,h.current=m}function R(h){return h>>>=0,h===0?32:31-(Sg(h)/hM|0)|0}function N(h){var m=h&42;if(m!==0)return m;switch(h&-h){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return h&4194176;case 4194304:case 8388608:case 16777216:case 33554432:return h&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return h}}function P(h,m){var S=h.pendingLanes;if(S===0)return 0;var w=0,D=h.suspendedLanes,z=h.pingedLanes,ie=h.warmLanes;h=h.finishedLanes!==0;var ye=S&134217727;return ye!==0?(S=ye&~D,S!==0?w=N(S):(z&=ye,z!==0?w=N(z):h||(ie=ye&~ie,ie!==0&&(w=N(ie))))):(ye=S&~D,ye!==0?w=N(ye):z!==0?w=N(z):h||(ie=S&~ie,ie!==0&&(w=N(ie)))),w===0?0:m!==0&&m!==w&&(m&D)===0&&(D=w&-w,ie=m&-m,D>=ie||D===32&&(ie&4194176)!==0)?m:w}function U(h,m){return(h.pendingLanes&~(h.suspendedLanes&~h.pingedLanes)&m)===0}function L(h,m){switch(h){case 1:case 2:case 4:case 8:return m+250;case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return m+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function F(){var h=_p;return _p<<=1,(_p&4194176)===0&&(_p=128),h}function O(){var h=Tg;return Tg<<=1,(Tg&62914560)===0&&(Tg=4194304),h}function B(h){for(var m=[],S=0;31>S;S++)m.push(h);return m}function q(h,m){h.pendingLanes|=m,m!==268435456&&(h.suspendedLanes=0,h.pingedLanes=0,h.warmLanes=0)}function j(h,m,S,w,D,z){var ie=h.pendingLanes;h.pendingLanes=S,h.suspendedLanes=0,h.pingedLanes=0,h.warmLanes=0,h.expiredLanes&=S,h.entangledLanes&=S,h.errorRecoveryDisabledLanes&=S,h.shellSuspendCounter=0;var ye=h.entanglements,Le=h.expirationTimes,ft=h.hiddenUpdates;for(S=ie&~S;0<S;){var Ht=31-Ya(S),rn=1<<Ht;ye[Ht]=0,Le[Ht]=-1;var cn=ft[Ht];if(cn!==null)for(ft[Ht]=null,Ht=0;Ht<cn.length;Ht++){var Kn=cn[Ht];Kn!==null&&(Kn.lane&=-536870913)}S&=~rn}w!==0&&Q(h,w,0),z!==0&&D===0&&h.tag!==0&&(h.suspendedLanes|=z&~(ie&~m))}function Q(h,m,S){h.pendingLanes|=m,h.suspendedLanes&=~m;var w=31-Ya(m);h.entangledLanes|=m,h.entanglements[w]=h.entanglements[w]|1073741824|S&4194218}function se(h,m){var S=h.entangledLanes|=m;for(h=h.entanglements;S;){var w=31-Ya(S),D=1<<w;D&m|h[w]&m&&(h[w]|=m),S&=~D}}function ae(h){return h&=-h,2<h?8<h?(h&134217727)!==0?32:268435456:8:2}function V(h){if(Za&&typeof Za.onCommitFiberRoot=="function")try{Za.onCommitFiberRoot(xp,h,void 0,(h.current.flags&128)===128)}catch{}}function X(h){if(typeof yM=="function"&&dS(h),Za&&typeof Za.setStrictMode=="function")try{Za.setStrictMode(xp,h)}catch{}}function ee(h,m){return h===m&&(h!==0||1/h===1/m)||h!==h&&m!==m}function fe(h,m){if(typeof h=="object"&&h!==null){var S=R_.get(h);return S!==void 0?S:(m={value:h,source:m,stack:d(m)},R_.set(h,m),m)}return{value:h,source:m,stack:d(m)}}function Y(h,m){Ar[Hr++]=Ag,Ar[Hr++]=Mg,Mg=h,Ag=m}function K(h,m,S){Do[Oo++]=Pu,Do[Oo++]=hl,Do[Oo++]=$l,$l=h;var w=Pu;h=hl;var D=32-Ya(w)-1;w&=~(1<<D),S+=1;var z=32-Ya(m)+D;if(30<z){var ie=D-D%5;z=(w&(1<<ie)-1).toString(32),w>>=ie,D-=ie,Pu=1<<32-Ya(m)+D|S<<D|w,hl=z+h}else Pu=1<<z|S<<D|w,hl=h}function he(h){h.return!==null&&(Y(h,1),K(h,1,0))}function Ce(h){for(;h===Mg;)Mg=Ar[--Hr],Ar[Hr]=null,Ag=Ar[--Hr],Ar[Hr]=null;for(;h===$l;)$l=Do[--Oo],Do[Oo]=null,hl=Do[--Oo],Do[Oo]=null,Pu=Do[--Oo],Do[Oo]=null}function Ie(h,m){M(jl,m),M(wg,h),M(Bs,null),h=zd(m),T(Bs),M(Bs,h)}function ut(){T(Bs),T(wg),T(jl)}function Ee(h){h.memoizedState!==null&&M(bp,h);var m=Bs.current,S=XE(m,h.type);m!==S&&(M(wg,h),M(Bs,S))}function Ne(h){wg.current===h&&(T(Bs),T(wg)),bp.current===h&&(T(bp),Ou?qn._currentValue=ja:qn._currentValue2=ja)}function rt(h){var m=Error(i(418,""));throw At(fe(m,h)),Rg}function Nt(h,m){if(!Ra)throw Error(i(175));YN(h.stateNode,h.type,h.memoizedProps,m,h)||rt(h)}function Ft(h){for(ca=h.return;ca;)switch(ca.tag){case 3:case 27:pl=!0;return;case 5:case 13:pl=!1;return;default:ca=ca.return}}function fn(h){if(!Ra||h!==ca)return!1;if(!Ni)return Ft(h),Ni=!0,!1;var m=!1;if(Ys?h.tag!==3&&h.tag!==27&&(h.tag!==5||lM(h.type)&&!Nf(h.type,h.memoizedProps))&&(m=!0):h.tag!==3&&(h.tag!==5||lM(h.type)&&!Nf(h.type,h.memoizedProps))&&(m=!0),m&&Ks&&rt(h),Ft(h),h.tag===13){if(!Ra)throw Error(i(316));if(h=h.memoizedState,h=h!==null?h.dehydrated:null,!h)throw Error(i(317));Ks=aM(h)}else Ks=ca?Jb(h.stateNode):null;return!0}function Sn(){Ra&&(Ks=ca=null,Ni=!1)}function At(h){Uo===null?Uo=[h]:Uo.push(h)}function qe(){for(var h=Of,m=Sp=Of=0;m<h;){var S=Lo[m];Lo[m++]=null;var w=Lo[m];Lo[m++]=null;var D=Lo[m];Lo[m++]=null;var z=Lo[m];if(Lo[m++]=null,w!==null&&D!==null){var ie=w.pending;ie===null?D.next=D:(D.next=ie.next,ie.next=D),w.pending=D}z!==0&&oe(S,D,z)}}function at(h,m,S,w){Lo[Of++]=h,Lo[Of++]=m,Lo[Of++]=S,Lo[Of++]=w,Sp|=w,h.lanes|=w,h=h.alternate,h!==null&&(h.lanes|=w)}function Je(h,m,S,w){return at(h,m,S,w),Qt(h)}function xe(h,m){return at(h,null,null,m),Qt(h)}function oe(h,m,S){h.lanes|=S;var w=h.alternate;w!==null&&(w.lanes|=S);for(var D=!1,z=h.return;z!==null;)z.childLanes|=S,w=z.alternate,w!==null&&(w.childLanes|=S),z.tag===22&&(h=z.stateNode,h===null||h._visibility&1||(D=!0)),h=z,z=z.return;D&&m!==null&&h.tag===3&&(z=h.stateNode,D=31-Ya(S),z=z.hiddenUpdates,h=z[D],h===null?z[D]=[m]:h.push(m),m.lane=S|536870912)}function Qt(h){if(50<Zd)throw Zd=0,Da=null,Error(i(185));for(var m=h.return;m!==null;)h=m,m=h.return;return h.tag===3?h.stateNode:null}function Dt(h){h!==Hd&&h.next===null&&(Hd===null?Tp=Hd=h:Hd=Hd.next=h),Ng=!0,Cg||(Cg=!0,Fe(wt))}function zt(h,m){if(!Yl&&Ng){Yl=!0;do for(var S=!1,w=Tp;w!==null;){if(h!==0){var D=w.pendingLanes;if(D===0)var z=0;else{var ie=w.suspendedLanes,ye=w.pingedLanes;z=(1<<31-Ya(42|h)+1)-1,z&=D&~(ie&~ye),z=z&201326677?z&201326677|1:z?z|2:0}z!==0&&(S=!0,pe(w,z))}else z=oi,z=P(w,w===ci?z:0),(z&3)===0||U(w,z)||(S=!0,pe(w,z));w=w.next}while(S);Yl=!1}}function wt(){Ng=Cg=!1;var h=0;Uf!==0&&(Df()&&(h=Uf),Uf=0);for(var m=Zs(),S=null,w=Tp;w!==null;){var D=w.next,z=Z(w,m);z===0?(w.next=null,S===null?Tp=D:S.next=D,D===null&&(Hd=S)):(S=w,(h!==0||(z&3)!==0)&&(Ng=!0)),w=D}zt(h)}function Z(h,m){for(var S=h.suspendedLanes,w=h.pingedLanes,D=h.expirationTimes,z=h.pendingLanes&-62914561;0<z;){var ie=31-Ya(z),ye=1<<ie,Le=D[ie];Le===-1?((ye&S)===0||(ye&w)!==0)&&(D[ie]=L(ye,m)):Le<=m&&(h.expiredLanes|=ye),z&=~ye}if(m=ci,S=oi,S=P(h,h===m?S:0),w=h.callbackNode,S===0||h===m&&lr===2||h.cancelPendingCommit!==null)return w!==null&&w!==null&&Eg(w),h.callbackNode=null,h.callbackPriority=0;if((S&3)===0||U(h,S)){if(m=S&-S,m===h.callbackPriority)return m;switch(w!==null&&Eg(w),ae(S)){case 2:case 8:S=gM;break;case 32:S=A_;break;case 268435456:S=w_;break;default:S=A_}return w=k.bind(null,h),S=vp(S,w),h.callbackPriority=m,h.callbackNode=S,m}return w!==null&&w!==null&&Eg(w),h.callbackPriority=2,h.callbackNode=null,2}function k(h,m){var S=h.callbackNode;if(Ls()&&h.callbackNode!==S)return null;var w=oi;return w=P(h,h===ci?w:0),w===0?null:(og(h,w,m),Z(h,Zs()),h.callbackNode!=null&&h.callbackNode===S?k.bind(null,h):null)}function pe(h,m){if(Ls())return null;og(h,m,!0)}function Fe(h){gs?m_(function(){(On&6)!==0?vp(fS,h):h()}):vp(fS,h)}function He(){return Uf===0&&(Uf=F()),Uf}function ze(h,m){if(Dg===null){var S=Dg=[];C_=0,Ka=He(),Lf={status:"pending",value:void 0,then:function(w){S.push(w)}}}return C_++,m.then(Bt,Bt),m}function Bt(){if(--C_===0&&Dg!==null){Lf!==null&&(Lf.status="fulfilled");var h=Dg;Dg=null,Ka=0,Lf=null;for(var m=0;m<h.length;m++)(0,h[m])()}}function Ct(h,m){var S=[],w={status:"pending",value:null,reason:null,then:function(D){S.push(D)}};return h.then(function(){w.status="fulfilled",w.value=m;for(var D=0;D<S.length;D++)(0,S[D])(m)},function(D){for(w.status="rejected",w.reason=D,D=0;D<S.length;D++)(0,S[D])(void 0)}),w}function Yt(h){h.updateQueue={baseState:h.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function $t(h,m){h=h.updateQueue,m.updateQueue===h&&(m.updateQueue={baseState:h.baseState,firstBaseUpdate:h.firstBaseUpdate,lastBaseUpdate:h.lastBaseUpdate,shared:h.shared,callbacks:null})}function st(h){return{lane:h,tag:0,payload:null,callback:null,next:null}}function nt(h,m,S){var w=h.updateQueue;if(w===null)return null;if(w=w.shared,(On&2)!==0){var D=w.pending;return D===null?m.next=m:(m.next=D.next,D.next=m),w.pending=m,m=Qt(h),oe(h,null,S),m}return at(h,w,m,S),Qt(h)}function Pt(h,m,S){if(m=m.updateQueue,m!==null&&(m=m.shared,(S&4194176)!==0)){var w=m.lanes;w&=h.pendingLanes,S|=w,m.lanes=S,se(h,S)}}function ue(h,m){var S=h.updateQueue,w=h.alternate;if(w!==null&&(w=w.updateQueue,S===w)){var D=null,z=null;if(S=S.firstBaseUpdate,S!==null){do{var ie={lane:S.lane,tag:S.tag,payload:S.payload,callback:null,next:null};z===null?D=z=ie:z=z.next=ie,S=S.next}while(S!==null);z===null?D=z=m:z=z.next=m}else D=z=m;S={baseState:w.baseState,firstBaseUpdate:D,lastBaseUpdate:z,shared:w.shared,callbacks:w.callbacks},h.updateQueue=S;return}h=S.lastBaseUpdate,h===null?S.firstBaseUpdate=m:h.next=m,S.lastBaseUpdate=m}function Re(){if(Ep){var h=Lf;if(h!==null)throw h}}function dt(h,m,S,w){Ep=!1;var D=h.updateQueue;Cc=!1;var z=D.firstBaseUpdate,ie=D.lastBaseUpdate,ye=D.shared.pending;if(ye!==null){D.shared.pending=null;var Le=ye,ft=Le.next;Le.next=null,ie===null?z=ft:ie.next=ft,ie=Le;var Ht=h.alternate;Ht!==null&&(Ht=Ht.updateQueue,ye=Ht.lastBaseUpdate,ye!==ie&&(ye===null?Ht.firstBaseUpdate=ft:ye.next=ft,Ht.lastBaseUpdate=Le))}if(z!==null){var rn=D.baseState;ie=0,Ht=ft=Le=null,ye=z;do{var cn=ye.lane&-536870913,Kn=cn!==ye.lane;if(Kn?(oi&cn)===cn:(w&cn)===cn){cn!==0&&cn===Ka&&(Ep=!0),Ht!==null&&(Ht=Ht.next={lane:0,tag:ye.tag,payload:ye.payload,callback:null,next:null});e:{var to=h,Pg=ye;cn=m;var Kd=S;switch(Pg.tag){case 1:if(to=Pg.payload,typeof to=="function"){rn=to.call(Kd,rn,cn);break e}rn=to;break e;case 3:to.flags=to.flags&-65537|128;case 0:if(to=Pg.payload,cn=typeof to=="function"?to.call(Kd,rn,cn):to,cn==null)break e;rn=Id({},rn,cn);break e;case 2:Cc=!0}}cn=ye.callback,cn!==null&&(h.flags|=64,Kn&&(h.flags|=8192),Kn=D.callbacks,Kn===null?D.callbacks=[cn]:Kn.push(cn))}else Kn={lane:cn,tag:ye.tag,payload:ye.payload,callback:ye.callback,next:null},Ht===null?(ft=Ht=Kn,Le=rn):Ht=Ht.next=Kn,ie|=cn;if(ye=ye.next,ye===null){if(ye=D.shared.pending,ye===null)break;Kn=ye,ye=Kn.next,Kn.next=null,D.lastBaseUpdate=Kn,D.shared.pending=null}}while(!0);Ht===null&&(Le=rn),D.baseState=Le,D.firstBaseUpdate=ft,D.lastBaseUpdate=Ht,z===null&&(D.shared.lanes=0),Fo|=ie,h.lanes=ie,h.memoizedState=rn}}function le(h,m){if(typeof h!="function")throw Error(i(191,h));h.call(m)}function Be(h,m){var S=h.callbacks;if(S!==null)for(h.callbacks=null,h=0;h<S.length;h++)le(S[h],m)}function lt(h,m){if(No(h,m))return!0;if(typeof h!="object"||h===null||typeof m!="object"||m===null)return!1;var S=Object.keys(h),w=Object.keys(m);if(S.length!==w.length)return!1;for(w=0;w<S.length;w++){var D=S[w];if(!Og.call(m,D)||!No(h[D],m[D]))return!1}return!0}function Ot(h){return h=h.status,h==="fulfilled"||h==="rejected"}function ht(){}function it(h,m,S){switch(S=h[S],S===void 0?h.push(m):S!==m&&(m.then(ht,ht),m=S),m.status){case"fulfilled":return m.value;case"rejected":throw h=m.reason,h===er?Error(i(483)):h;default:if(typeof m.status=="string")m.then(ht,ht);else{if(h=ci,h!==null&&100<h.shellSuspendCounter)throw Error(i(482));h=m,h.status="pending",h.then(function(w){if(m.status==="pending"){var D=m;D.status="fulfilled",D.value=w}},function(w){if(m.status==="pending"){var D=m;D.status="rejected",D.reason=w}})}switch(m.status){case"fulfilled":return m.value;case"rejected":throw h=m.reason,h===er?Error(i(483)):h}throw Wd=m,er}}function Tt(){if(Wd===null)throw Error(i(459));var h=Wd;return Wd=null,h}function ln(h){var m=ml;return ml+=1,Bu===null&&(Bu=[]),it(Bu,h,m)}function jn(h,m){m=m.props.ref,h.ref=m!==void 0?m:null}function qt(h,m){throw m.$$typeof===Db?Error(i(525)):(h=Object.prototype.toString.call(m),Error(i(31,h==="[object Object]"?"object with keys {"+Object.keys(m).join(", ")+"}":h)))}function nn(h){var m=h._init;return m(h._payload)}function Bn(h){function m(We,Oe){if(h){var Ye=We.deletions;Ye===null?(We.deletions=[Oe],We.flags|=16):Ye.push(Oe)}}function S(We,Oe){if(!h)return null;for(;Oe!==null;)m(We,Oe),Oe=Oe.sibling;return null}function w(We){for(var Oe=new Map;We!==null;)We.key!==null?Oe.set(We.key,We):Oe.set(We.index,We),We=We.sibling;return Oe}function D(We,Oe){return We=la(We,Oe),We.index=0,We.sibling=null,We}function z(We,Oe,Ye){return We.index=Ye,h?(Ye=We.alternate,Ye!==null?(Ye=Ye.index,Ye<Oe?(We.flags|=33554434,Oe):Ye):(We.flags|=33554434,Oe)):(We.flags|=1048576,Oe)}function ie(We){return h&&We.alternate===null&&(We.flags|=33554434),We}function ye(We,Oe,Ye,Ut){return Oe===null||Oe.tag!==6?(Oe=Ef(Ye,We.mode,Ut),Oe.return=We,Oe):(Oe=D(Oe,Ye),Oe.return=We,Oe)}function Le(We,Oe,Ye,Ut){var Rn=Ye.type;return Rn===hp?Ht(We,Oe,Ye.props.children,Ut,Ye.key):Oe!==null&&(Oe.elementType===Rn||typeof Rn=="object"&&Rn!==null&&Rn.$$typeof===Xl&&nn(Rn)===Oe.type)?(Oe=D(Oe,Ye.props),jn(Oe,Ye),Oe.return=We,Oe):(Oe=fl(Ye.type,Ye.key,Ye.props,null,We.mode,Ut),jn(Oe,Ye),Oe.return=We,Oe)}function ft(We,Oe,Ye,Ut){return Oe===null||Oe.tag!==4||Oe.stateNode.containerInfo!==Ye.containerInfo||Oe.stateNode.implementation!==Ye.implementation?(Oe=dp(Ye,We.mode,Ut),Oe.return=We,Oe):(Oe=D(Oe,Ye.children||[]),Oe.return=We,Oe)}function Ht(We,Oe,Ye,Ut,Rn){return Oe===null||Oe.tag!==7?(Oe=Tc(Ye,We.mode,Ut,Rn),Oe.return=We,Oe):(Oe=D(Oe,Ye),Oe.return=We,Oe)}function rn(We,Oe,Ye){if(typeof Oe=="string"&&Oe!==""||typeof Oe=="number"||typeof Oe=="bigint")return Oe=Ef(""+Oe,We.mode,Ye),Oe.return=We,Oe;if(typeof Oe=="object"&&Oe!==null){switch(Oe.$$typeof){case Ec:return Ye=fl(Oe.type,Oe.key,Oe.props,null,We.mode,Ye),jn(Ye,Oe),Ye.return=We,Ye;case ql:return Oe=dp(Oe,We.mode,Ye),Oe.return=We,Oe;case Xl:var Ut=Oe._init;return Oe=Ut(Oe._payload),rn(We,Oe,Ye)}if(Rf(Oe)||s(Oe))return Oe=Tc(Oe,We.mode,Ye,null),Oe.return=We,Oe;if(typeof Oe.then=="function")return rn(We,ln(Oe),Ye);if(Oe.$$typeof===Nu)return rn(We,ng(We,Oe),Ye);qt(We,Oe)}return null}function cn(We,Oe,Ye,Ut){var Rn=Oe!==null?Oe.key:null;if(typeof Ye=="string"&&Ye!==""||typeof Ye=="number"||typeof Ye=="bigint")return Rn!==null?null:ye(We,Oe,""+Ye,Ut);if(typeof Ye=="object"&&Ye!==null){switch(Ye.$$typeof){case Ec:return Ye.key===Rn?Le(We,Oe,Ye,Ut):null;case ql:return Ye.key===Rn?ft(We,Oe,Ye,Ut):null;case Xl:return Rn=Ye._init,Ye=Rn(Ye._payload),cn(We,Oe,Ye,Ut)}if(Rf(Ye)||s(Ye))return Rn!==null?null:Ht(We,Oe,Ye,Ut,null);if(typeof Ye.then=="function")return cn(We,Oe,ln(Ye),Ut);if(Ye.$$typeof===Nu)return cn(We,Oe,ng(We,Ye),Ut);qt(We,Ye)}return null}function Kn(We,Oe,Ye,Ut,Rn){if(typeof Ut=="string"&&Ut!==""||typeof Ut=="number"||typeof Ut=="bigint")return We=We.get(Ye)||null,ye(Oe,We,""+Ut,Rn);if(typeof Ut=="object"&&Ut!==null){switch(Ut.$$typeof){case Ec:return We=We.get(Ut.key===null?Ye:Ut.key)||null,Le(Oe,We,Ut,Rn);case ql:return We=We.get(Ut.key===null?Ye:Ut.key)||null,ft(Oe,We,Ut,Rn);case Xl:var _r=Ut._init;return Ut=_r(Ut._payload),Kn(We,Oe,Ye,Ut,Rn)}if(Rf(Ut)||s(Ut))return We=We.get(Ye)||null,Ht(Oe,We,Ut,Rn,null);if(typeof Ut.then=="function")return Kn(We,Oe,Ye,ln(Ut),Rn);if(Ut.$$typeof===Nu)return Kn(We,Oe,Ye,ng(Oe,Ut),Rn);qt(Oe,Ut)}return null}function to(We,Oe,Ye,Ut){for(var Rn=null,_r=null,Xn=Oe,Oi=Oe=0,Ms=null;Xn!==null&&Oi<Ye.length;Oi++){Xn.index>Oi?(Ms=Xn,Xn=null):Ms=Xn.sibling;var Ui=cn(We,Xn,Ye[Oi],Ut);if(Ui===null){Xn===null&&(Xn=Ms);break}h&&Xn&&Ui.alternate===null&&m(We,Xn),Oe=z(Ui,Oe,Oi),_r===null?Rn=Ui:_r.sibling=Ui,_r=Ui,Xn=Ms}if(Oi===Ye.length)return S(We,Xn),Ni&&Y(We,Oi),Rn;if(Xn===null){for(;Oi<Ye.length;Oi++)Xn=rn(We,Ye[Oi],Ut),Xn!==null&&(Oe=z(Xn,Oe,Oi),_r===null?Rn=Xn:_r.sibling=Xn,_r=Xn);return Ni&&Y(We,Oi),Rn}for(Xn=w(Xn);Oi<Ye.length;Oi++)Ms=Kn(Xn,We,Oi,Ye[Oi],Ut),Ms!==null&&(h&&Ms.alternate!==null&&Xn.delete(Ms.key===null?Oi:Ms.key),Oe=z(Ms,Oe,Oi),_r===null?Rn=Ms:_r.sibling=Ms,_r=Ms);return h&&Xn.forEach(function(Bc){return m(We,Bc)}),Ni&&Y(We,Oi),Rn}function Pg(We,Oe,Ye,Ut){if(Ye==null)throw Error(i(151));for(var Rn=null,_r=null,Xn=Oe,Oi=Oe=0,Ms=null,Ui=Ye.next();Xn!==null&&!Ui.done;Oi++,Ui=Ye.next()){Xn.index>Oi?(Ms=Xn,Xn=null):Ms=Xn.sibling;var Bc=cn(We,Xn,Ui.value,Ut);if(Bc===null){Xn===null&&(Xn=Ms);break}h&&Xn&&Bc.alternate===null&&m(We,Xn),Oe=z(Bc,Oe,Oi),_r===null?Rn=Bc:_r.sibling=Bc,_r=Bc,Xn=Ms}if(Ui.done)return S(We,Xn),Ni&&Y(We,Oi),Rn;if(Xn===null){for(;!Ui.done;Oi++,Ui=Ye.next())Ui=rn(We,Ui.value,Ut),Ui!==null&&(Oe=z(Ui,Oe,Oi),_r===null?Rn=Ui:_r.sibling=Ui,_r=Ui);return Ni&&Y(We,Oi),Rn}for(Xn=w(Xn);!Ui.done;Oi++,Ui=Ye.next())Ui=Kn(Xn,We,Oi,Ui.value,Ut),Ui!==null&&(h&&Ui.alternate!==null&&Xn.delete(Ui.key===null?Oi:Ui.key),Oe=z(Ui,Oe,Oi),_r===null?Rn=Ui:_r.sibling=Ui,_r=Ui);return h&&Xn.forEach(function(F_){return m(We,F_)}),Ni&&Y(We,Oi),Rn}function Kd(We,Oe,Ye,Ut){if(typeof Ye=="object"&&Ye!==null&&Ye.type===hp&&Ye.key===null&&(Ye=Ye.props.children),typeof Ye=="object"&&Ye!==null){switch(Ye.$$typeof){case Ec:e:{for(var Rn=Ye.key;Oe!==null;){if(Oe.key===Rn){if(Rn=Ye.type,Rn===hp){if(Oe.tag===7){S(We,Oe.sibling),Ut=D(Oe,Ye.props.children),Ut.return=We,We=Ut;break e}}else if(Oe.elementType===Rn||typeof Rn=="object"&&Rn!==null&&Rn.$$typeof===Xl&&nn(Rn)===Oe.type){S(We,Oe.sibling),Ut=D(Oe,Ye.props),jn(Ut,Ye),Ut.return=We,We=Ut;break e}S(We,Oe);break}else m(We,Oe);Oe=Oe.sibling}Ye.type===hp?(Ut=Tc(Ye.props.children,We.mode,Ut,Ye.key),Ut.return=We,We=Ut):(Ut=fl(Ye.type,Ye.key,Ye.props,null,We.mode,Ut),jn(Ut,Ye),Ut.return=We,We=Ut)}return ie(We);case ql:e:{for(Rn=Ye.key;Oe!==null;){if(Oe.key===Rn)if(Oe.tag===4&&Oe.stateNode.containerInfo===Ye.containerInfo&&Oe.stateNode.implementation===Ye.implementation){S(We,Oe.sibling),Ut=D(Oe,Ye.children||[]),Ut.return=We,We=Ut;break e}else{S(We,Oe);break}else m(We,Oe);Oe=Oe.sibling}Ut=dp(Ye,We.mode,Ut),Ut.return=We,We=Ut}return ie(We);case Xl:return Rn=Ye._init,Ye=Rn(Ye._payload),Kd(We,Oe,Ye,Ut)}if(Rf(Ye))return to(We,Oe,Ye,Ut);if(s(Ye)){if(Rn=s(Ye),typeof Rn!="function")throw Error(i(150));return Ye=Rn.call(Ye),Pg(We,Oe,Ye,Ut)}if(typeof Ye.then=="function")return Kd(We,Oe,ln(Ye),Ut);if(Ye.$$typeof===Nu)return Kd(We,Oe,ng(We,Ye),Ut);qt(We,Ye)}return typeof Ye=="string"&&Ye!==""||typeof Ye=="number"||typeof Ye=="bigint"?(Ye=""+Ye,Oe!==null&&Oe.tag===6?(S(We,Oe.sibling),Ut=D(Oe,Ye),Ut.return=We,We=Ut):(S(We,Oe),Ut=Ef(Ye,We.mode,Ut),Ut.return=We,We=Ut),ie(We)):S(We,Oe)}return function(We,Oe,Ye,Ut){try{ml=0;var Rn=Kd(We,Oe,Ye,Ut);return Bu=null,Rn}catch(Xn){if(Xn===er)throw Xn;var _r=t(29,Xn,null,We.mode);return _r.lanes=Ut,_r.return=We,_r}}}function Zt(h,m){h=Zl,M(Po,h),M(Iu,m),Zl=h|m.baseLanes}function Ln(){M(Po,Zl),M(Iu,Iu.current)}function dn(){Zl=Po.current,T(Iu),T(Po)}function wn(h){var m=h.alternate;M(ys,ys.current&1),M(Bo,h),gl===null&&(m===null||Iu.current!==null||m.memoizedState!==null)&&(gl=h)}function Bi(h){if(h.tag===22){if(M(ys,ys.current),M(Bo,h),gl===null){var m=h.alternate;m!==null&&m.memoizedState!==null&&(gl=h)}}else Un()}function Un(){M(ys,ys.current),M(Bo,Bo.current)}function Jt(h){T(Bo),gl===h&&(gl=null),T(ys)}function xi(h){for(var m=h;m!==null;){if(m.tag===13){var S=m.memoizedState;if(S!==null&&(S=S.dehydrated,S===null||x_(S)||xg(S)))return m}else if(m.tag===19&&m.memoizedProps.revealOrder!==void 0){if((m.flags&128)!==0)return m}else if(m.child!==null){m.child.return=m,m=m.child;continue}if(m===h)break;for(;m.sibling===null;){if(m.return===null||m.return===h)return null;m=m.return}m.sibling.return=m.return,m=m.sibling}return null}function pn(){throw Error(i(321))}function W(h,m){if(m===null)return!1;for(var S=0;S<m.length&&S<h.length;S++)if(!No(h[S],m[S]))return!1;return!0}function J(h,m,S,w,D,z){return Fu=z,ii=m,m.memoizedState=null,m.updateQueue=null,m.lanes=0,In.H=h===null||h.memoizedState===null?_s:fa,Nc=!1,z=S(w,D),Nc=!1,wr&&(z=De(m,S,w,D)),me(h),z}function me(h){In.H=Di;var m=Gi!==null&&Gi.next!==null;if(Fu=0,ts=Gi=ii=null,yl=!1,Wr=0,Mp=null,m)throw Error(i(300));h===null||ns||(h=h.dependencies,h!==null&&hf(h)&&(ns=!0))}function De(h,m,S,w){ii=h;var D=0;do{if(wr&&(Mp=null),Wr=0,wr=!1,25<=D)throw Error(i(301));if(D+=1,ts=Gi=null,h.updateQueue!=null){var z=h.updateQueue;z.lastEffect=null,z.events=null,z.stores=null,z.memoCache!=null&&(z.memoCache.index=0)}In.H=Bf,z=m(S,w)}while(wr);return z}function $e(){var h=In.H,m=h.useState()[0];return m=typeof m.then=="function"?Lt(m):m,h=h.useState()[0],(Gi!==null?Gi.memoizedState:null)!==h&&(ii.flags|=1024),m}function je(){var h=Ug!==0;return Ug=0,h}function _t(h,m,S){m.updateQueue=h.updateQueue,m.flags&=-2053,h.lanes&=~S}function ct(h){if(yl){for(h=h.memoizedState;h!==null;){var m=h.queue;m!==null&&(m.pending=null),h=h.next}yl=!1}Fu=0,ts=Gi=ii=null,wr=!1,Wr=Ug=0,Mp=null}function pt(){var h={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return ts===null?ii.memoizedState=ts=h:ts=ts.next=h,ts}function gt(){if(Gi===null){var h=ii.alternate;h=h!==null?h.memoizedState:null}else h=Gi.next;var m=ts===null?ii.memoizedState:ts.next;if(m!==null)ts=m,Gi=h;else{if(h===null)throw ii.alternate===null?Error(i(467)):Error(i(310));Gi=h,h={memoizedState:Gi.memoizedState,baseState:Gi.baseState,baseQueue:Gi.baseQueue,queue:Gi.queue,next:null},ts===null?ii.memoizedState=ts=h:ts=ts.next=h}return ts}function Lt(h){var m=Wr;return Wr+=1,Mp===null&&(Mp=[]),h=it(Mp,h,m),m=ii,(ts===null?m.memoizedState:ts.next)===null&&(m=m.alternate,In.H=m===null||m.memoizedState===null?_s:fa),h}function bt(h){if(h!==null&&typeof h=="object"){if(typeof h.then=="function")return Lt(h);if(h.$$typeof===Nu)return Xs(h)}throw Error(i(438,String(h)))}function $(h){var m=null,S=ii.updateQueue;if(S!==null&&(m=S.memoCache),m==null){var w=ii.alternate;w!==null&&(w=w.updateQueue,w!==null&&(w=w.memoCache,w!=null&&(m={data:w.data.map(function(D){return D.slice()}),index:0})))}if(m==null&&(m={data:[],index:0}),S===null&&(S=D_(),ii.updateQueue=S),S.memoCache=m,S=m.data[m.index],S===void 0)for(S=m.data[m.index]=Array(h),w=0;w<h;w++)S[w]=qE;return m.index++,S}function ce(h,m){return typeof m=="function"?m(h):m}function Me(h){var m=gt();return Ae(m,Gi,h)}function Ae(h,m,S){var w=h.queue;if(w===null)throw Error(i(311));w.lastRenderedReducer=S;var D=h.baseQueue,z=w.pending;if(z!==null){if(D!==null){var ie=D.next;D.next=z.next,z.next=ie}m.baseQueue=D=z,w.pending=null}if(z=h.baseState,D===null)h.memoizedState=z;else{m=D.next;var ye=ie=null,Le=null,ft=m,Ht=!1;do{var rn=ft.lane&-536870913;if(rn!==ft.lane?(oi&rn)===rn:(Fu&rn)===rn){var cn=ft.revertLane;if(cn===0)Le!==null&&(Le=Le.next={lane:0,revertLane:0,action:ft.action,hasEagerState:ft.hasEagerState,eagerState:ft.eagerState,next:null}),rn===Ka&&(Ht=!0);else if((Fu&cn)===cn){ft=ft.next,cn===Ka&&(Ht=!0);continue}else rn={lane:0,revertLane:ft.revertLane,action:ft.action,hasEagerState:ft.hasEagerState,eagerState:ft.eagerState,next:null},Le===null?(ye=Le=rn,ie=z):Le=Le.next=rn,ii.lanes|=cn,Fo|=cn;rn=ft.action,Nc&&S(z,rn),z=ft.hasEagerState?ft.eagerState:S(z,rn)}else cn={lane:rn,revertLane:ft.revertLane,action:ft.action,hasEagerState:ft.hasEagerState,eagerState:ft.eagerState,next:null},Le===null?(ye=Le=cn,ie=z):Le=Le.next=cn,ii.lanes|=rn,Fo|=rn;ft=ft.next}while(ft!==null&&ft!==m);if(Le===null?ie=z:Le.next=ye,!No(z,h.memoizedState)&&(ns=!0,Ht&&(S=Lf,S!==null)))throw S;h.memoizedState=z,h.baseState=ie,h.baseQueue=Le,w.lastRenderedState=z}return D===null&&(w.lanes=0),[h.memoizedState,w.dispatch]}function Se(h){var m=gt(),S=m.queue;if(S===null)throw Error(i(311));S.lastRenderedReducer=h;var w=S.dispatch,D=S.pending,z=m.memoizedState;if(D!==null){S.pending=null;var ie=D=D.next;do z=h(z,ie.action),ie=ie.next;while(ie!==D);No(z,m.memoizedState)||(ns=!0),m.memoizedState=z,m.baseQueue===null&&(m.baseState=z),S.lastRenderedState=z}return[z,w]}function mt(h,m,S){var w=ii,D=gt(),z=Ni;if(z){if(S===void 0)throw Error(i(407));S=S()}else S=m();var ie=!No((Gi||D).memoizedState,S);if(ie&&(D.memoizedState=S,ns=!0),D=D.queue,To(It.bind(null,w,D,h),[h]),D.getSnapshot!==m||ie||ts!==null&&ts.memoizedState.tag&1){if(w.flags|=2048,Vr(9,Rt.bind(null,w,D,S,m),{destroy:void 0},null),ci===null)throw Error(i(349));z||(Fu&60)!==0||Et(w,m,S)}return S}function Et(h,m,S){h.flags|=16384,h={getSnapshot:m,value:S},m=ii.updateQueue,m===null?(m=D_(),ii.updateQueue=m,m.stores=[h]):(S=m.stores,S===null?m.stores=[h]:S.push(h))}function Rt(h,m,S,w){m.value=S,m.getSnapshot=w,Vt(m)&&mn(h)}function It(h,m,S){return S(function(){Vt(m)&&mn(h)})}function Vt(h){var m=h.getSnapshot;h=h.value;try{var S=m();return!No(h,S)}catch{return!0}}function mn(h){var m=xe(h,2);m!==null&&oa(m,h,2)}function Gt(h){var m=pt();if(typeof h=="function"){var S=h;if(h=S(),Nc){X(!0);try{S()}finally{X(!1)}}}return m.memoizedState=m.baseState=h,m.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:ce,lastRenderedState:h},m}function un(h,m,S,w){return h.baseState=S,Ae(h,Gi,typeof w=="function"?w:ce)}function ni(h,m,S,w,D){if(wd(h))throw Error(i(485));if(h=m.action,h!==null){var z={payload:D,action:h,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(ie){z.listeners.push(ie)}};In.T!==null?S(!0):z.isTransition=!1,w(z),S=m.pending,S===null?(z.next=m.pending=z,zi(m,z)):(z.next=S.next,m.pending=S.next=z)}}function zi(h,m){var S=m.action,w=m.payload,D=h.state;if(m.isTransition){var z=In.T,ie={};In.T=ie;try{var ye=S(D,w),Le=In.S;Le!==null&&Le(ie,ye),si(h,m,ye)}catch(ft){en(h,m,ft)}finally{In.T=z}}else try{z=S(D,w),si(h,m,z)}catch(ft){en(h,m,ft)}}function si(h,m,S){S!==null&&typeof S=="object"&&typeof S.then=="function"?S.then(function(w){Mn(h,m,w)},function(w){return en(h,m,w)}):Mn(h,m,S)}function Mn(h,m,S){m.status="fulfilled",m.value=S,Cn(m),h.state=S,m=h.pending,m!==null&&(S=m.next,S===m?h.pending=null:(S=S.next,m.next=S,zi(h,S)))}function en(h,m,S){var w=h.pending;if(h.pending=null,w!==null){w=w.next;do m.status="rejected",m.reason=S,Cn(m),m=m.next;while(m!==w)}h.action=null}function Cn(h){h=h.listeners;for(var m=0;m<h.length;m++)(0,h[m])()}function tn(h,m){return m}function Vi(h,m){if(Ni){var S=ci.formState;if(S!==null){e:{var w=ii;if(Ni){if(Ks){var D=QE(Ks,pl);if(D){Ks=Jb(D),w=JE(D);break e}}rt(w)}w=!1}w&&(m=S[0])}}S=pt(),S.memoizedState=S.baseState=m,w={pending:null,lanes:0,dispatch:null,lastRenderedReducer:tn,lastRenderedState:m},S.queue=w,S=ky.bind(null,ii,w),w.dispatch=S,w=Gt(!1);var z=Hy.bind(null,ii,!1,w.queue);return w=pt(),D={state:m,dispatch:null,action:h,pending:null},w.queue=D,S=ni.bind(null,ii,D,z,S),D.dispatch=S,w.memoizedState=h,[m,S,!1]}function Ds(h){var m=gt();return Ii(m,Gi,h)}function Ii(h,m,S){m=Ae(h,m,tn)[0],h=Me(ce)[0],m=typeof m=="object"&&m!==null&&typeof m.then=="function"?Lt(m):m;var w=gt(),D=w.queue,z=D.dispatch;return S!==w.memoizedState&&(ii.flags|=2048,Vr(9,Jr.bind(null,D,S),{destroy:void 0},null)),[m,z,h]}function Jr(h,m){h.action=m}function qi(h){var m=gt(),S=Gi;if(S!==null)return Ii(m,S,h);gt(),m=m.memoizedState,S=gt();var w=S.queue.dispatch;return S.memoizedState=h,[m,w,!1]}function Vr(h,m,S,w){return h={tag:h,create:m,inst:S,deps:w,next:null},m=ii.updateQueue,m===null&&(m=D_(),ii.updateQueue=m),S=m.lastEffect,S===null?m.lastEffect=h.next=h:(w=S.next,S.next=h,h.next=w,m.lastEffect=h),h}function hs(){return gt().memoizedState}function ps(h,m,S,w){var D=pt();ii.flags|=h,D.memoizedState=Vr(1|m,S,{destroy:void 0},w===void 0?null:w)}function ms(h,m,S,w){var D=gt();w=w===void 0?null:w;var z=D.memoizedState.inst;Gi!==null&&w!==null&&W(w,Gi.memoizedState.deps)?D.memoizedState=Vr(m,S,z,w):(ii.flags|=h,D.memoizedState=Vr(1|m,S,z,w))}function Ed(h,m){ps(8390656,8,h,m)}function To(h,m){ms(2048,8,h,m)}function xE(h,m){return ms(4,2,h,m)}function bE(h,m){return ms(4,4,h,m)}function $m(h,m){if(typeof m=="function"){h=h();var S=m(h);return function(){typeof S=="function"?S():m(null)}}if(m!=null)return h=h(),m.current=h,function(){m.current=null}}function Tu(h,m,S){S=S!=null?S.concat([h]):null,ms(4,4,$m.bind(null,m,h),S)}function jm(){}function zy(h,m){var S=gt();m=m===void 0?null:m;var w=S.memoizedState;return m!==null&&W(m,w[1])?w[0]:(S.memoizedState=[h,m],h)}function Md(h,m){var S=gt();m=m===void 0?null:m;var w=S.memoizedState;if(m!==null&&W(m,w[1]))return w[0];if(w=h(),Nc){X(!0);try{h()}finally{X(!1)}}return S.memoizedState=[w,m],w}function lf(h,m,S){return S===void 0||(Fu&1073741824)!==0?h.memoizedState=m:(h.memoizedState=S,h=Au(),ii.lanes|=h,Fo|=h,S)}function ib(h,m,S,w){return No(S,m)?S:Iu.current!==null?(h=lf(h,S,w),No(h,m)||(ns=!0),h):(Fu&42)===0?(ns=!0,h.memoizedState=S):(h=Au(),ii.lanes|=h,Fo|=h,m)}function Vy(h,m,S,w,D){var z=Ts();ua(z!==0&&8>z?z:8);var ie=In.T,ye={};In.T=ye,Hy(h,!1,m,S);try{var Le=D(),ft=In.S;if(ft!==null&&ft(ye,Le),Le!==null&&typeof Le=="object"&&typeof Le.then=="function"){var Ht=Ct(Le,w);cf(h,m,Ht,wa(h))}else cf(h,m,w,wa(h))}catch(rn){cf(h,m,{then:function(){},status:"rejected",reason:rn},wa())}finally{ua(z),In.T=ie}}function rb(h){var m=h.memoizedState;if(m!==null)return m;m={memoizedState:ja,baseState:ja,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:ce,lastRenderedState:ja},next:null};var S={};return m.next={memoizedState:S,baseState:S,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:ce,lastRenderedState:S},next:null},h.memoizedState=m,h=h.alternate,h!==null&&(h.memoizedState=m),m}function Ad(){return Xs(qn)}function Eu(){return gt().memoizedState}function Gy(){return gt().memoizedState}function Ym(h){for(var m=h.return;m!==null;){switch(m.tag){case 24:case 3:var S=wa();h=st(S);var w=nt(m,h,S);w!==null&&(oa(w,m,S),Pt(w,m,S)),m={cache:jy()},h.payload=m;return}m=m.return}}function uf(h,m,S){var w=wa();S={lane:w,revertLane:0,action:S,hasEagerState:!1,eagerState:null,next:null},wd(h)?Zm(m,S):(S=Je(h,m,S,w),S!==null&&(oa(S,h,w),sb(S,m,w)))}function ky(h,m,S){var w=wa();cf(h,m,S,w)}function cf(h,m,S,w){var D={lane:w,revertLane:0,action:S,hasEagerState:!1,eagerState:null,next:null};if(wd(h))Zm(m,D);else{var z=h.alternate;if(h.lanes===0&&(z===null||z.lanes===0)&&(z=m.lastRenderedReducer,z!==null))try{var ie=m.lastRenderedState,ye=z(ie,S);if(D.hasEagerState=!0,D.eagerState=ye,No(ye,ie))return at(h,m,D,0),ci===null&&qe(),!1}catch{}if(S=Je(h,m,D,w),S!==null)return oa(S,h,w),sb(S,m,w),!0}return!1}function Hy(h,m,S,w){if(w={lane:2,revertLane:He(),action:w,hasEagerState:!1,eagerState:null,next:null},wd(h)){if(m)throw Error(i(479))}else m=Je(h,S,w,2),m!==null&&oa(m,h,2)}function wd(h){var m=h.alternate;return h===ii||m!==null&&m===ii}function Zm(h,m){wr=yl=!0;var S=h.pending;S===null?m.next=m:(m.next=S.next,S.next=m),h.pending=m}function sb(h,m,S){if((S&4194176)!==0){var w=m.lanes;w&=h.pendingLanes,S|=w,m.lanes=S,se(h,S)}}function sa(h,m,S,w){m=h.memoizedState,S=S(w,m),S=S==null?m:Id({},m,S),h.memoizedState=S,h.lanes===0&&(h.updateQueue.baseState=S)}function ff(h,m,S,w,D,z,ie){return h=h.stateNode,typeof h.shouldComponentUpdate=="function"?h.shouldComponentUpdate(w,z,ie):m.prototype&&m.prototype.isPureReactComponent?!lt(S,w)||!lt(D,z):!0}function Km(h,m,S,w){h=m.state,typeof m.componentWillReceiveProps=="function"&&m.componentWillReceiveProps(S,w),typeof m.UNSAFE_componentWillReceiveProps=="function"&&m.UNSAFE_componentWillReceiveProps(S,w),m.state!==h&&O_.enqueueReplaceState(m,m.state,null)}function kl(h,m){var S=m;if("ref"in m){S={};for(var w in m)w!=="ref"&&(S[w]=m[w])}if(h=h.defaultProps){S===m&&(S=Id({},S));for(var D in h)S[D]===void 0&&(S[D]=h[D])}return S}function Wy(h,m){try{var S=h.onUncaughtError;S(m.value,{componentStack:m.stack})}catch(w){setTimeout(function(){throw w})}}function qy(h,m,S){try{var w=h.onCaughtError;w(S.value,{componentStack:S.stack,errorBoundary:m.tag===1?m.stateNode:null})}catch(D){setTimeout(function(){throw D})}}function Qm(h,m,S){return S=st(S),S.tag=3,S.payload={element:null},S.callback=function(){Wy(h,m)},S}function Qh(h){return h=st(h),h.tag=3,h}function Jm(h,m,S,w){var D=S.type.getDerivedStateFromError;if(typeof D=="function"){var z=w.value;h.payload=function(){return D(z)},h.callback=function(){qy(m,S,w)}}var ie=S.stateNode;ie!==null&&typeof ie.componentDidCatch=="function"&&(h.callback=function(){qy(m,S,w),typeof D!="function"&&(Vo===null?Vo=new Set([this]):Vo.add(this));var ye=w.stack;this.componentDidCatch(w.value,{componentStack:ye!==null?ye:""})})}function SE(h,m,S,w,D){if(S.flags|=32768,w!==null&&typeof w=="object"&&typeof w.then=="function"){if(m=S.alternate,m!==null&&Rd(m,S,D,!0),S=Bo.current,S!==null){switch(S.tag){case 13:return gl===null?$a():S.alternate===null&&Ai===0&&(Ai=3),S.flags&=-257,S.flags|=65536,S.lanes=D,w===N_?S.flags|=16384:(m=S.updateQueue,m===null?S.updateQueue=new Set([w]):m.add(w),l_(h,w,D)),!1;case 22:return S.flags|=65536,w===N_?S.flags|=16384:(m=S.updateQueue,m===null?(m={transitions:null,markerInstances:null,retryQueue:new Set([w])},S.updateQueue=m):(S=m.retryQueue,S===null?m.retryQueue=new Set([w]):S.add(w)),l_(h,w,D)),!1}throw Error(i(435,S.tag))}return l_(h,w,D),$a(),!1}if(Ni)return m=Bo.current,m!==null?((m.flags&65536)===0&&(m.flags|=256),m.flags|=65536,m.lanes=D,w!==Rg&&(h=Error(i(422),{cause:w}),At(fe(h,S)))):(w!==Rg&&(m=Error(i(423),{cause:w}),At(fe(m,S))),h=h.current.alternate,h.flags|=65536,D&=-D,h.lanes|=D,w=fe(w,S),D=Qm(h.stateNode,w,D),ue(h,D),Ai!==4&&(Ai=2)),!1;var z=Error(i(520),{cause:w});if(z=fe(z,S),wp===null?wp=[z]:wp.push(z),Ai!==4&&(Ai=2),m===null)return!0;w=fe(w,S),S=m;do{switch(S.tag){case 3:return S.flags|=65536,h=D&-D,S.lanes|=h,h=Qm(S.stateNode,w,h),ue(S,h),!1;case 1:if(m=S.type,z=S.stateNode,(S.flags&128)===0&&(typeof m.getDerivedStateFromError=="function"||z!==null&&typeof z.componentDidCatch=="function"&&(Vo===null||!Vo.has(z))))return S.flags|=65536,D&=-D,S.lanes|=D,D=Qh(D),Jm(D,h,S,w),ue(S,D),!1}S=S.return}while(S!==null);return!1}function qs(h,m,S,w){m.child=h===null?pS(m,null,S,w):Pf(m,h.child,S,w)}function TE(h,m,S,w,D){S=S.render;var z=m.ref;if("ref"in w){var ie={};for(var ye in w)ye!=="ref"&&(ie[ye]=w[ye])}else ie=w;return Cd(m),w=J(h,m,S,ie,z,D),ye=je(),h!==null&&!ns?(_t(h,m,D),mc(h,m,D)):(Ni&&ye&&he(m),m.flags|=1,qs(h,m,w,D),m.child)}function EE(h,m,S,w,D){if(h===null){var z=S.type;return typeof z=="function"&&!bc(z)&&z.defaultProps===void 0&&S.compare===null?(m.tag=15,m.type=z,Xy(h,m,z,w,D)):(h=fl(S.type,null,w,m,m.mode,D),h.ref=m.ref,h.return=m,m.child=h)}if(z=h.child,!db(h,D)){var ie=z.memoizedProps;if(S=S.compare,S=S!==null?S:lt,S(ie,w)&&h.ref===m.ref)return mc(h,m,D)}return m.flags|=1,h=la(z,w),h.ref=m.ref,h.return=m,m.child=h}function Xy(h,m,S,w,D){if(h!==null){var z=h.memoizedProps;if(lt(z,w)&&h.ref===m.ref)if(ns=!1,m.pendingProps=w=z,db(h,D))(h.flags&131072)!==0&&(ns=!0);else return m.lanes=h.lanes,mc(h,m,D)}return ab(h,m,S,w,D)}function ME(h,m,S){var w=m.pendingProps,D=w.children,z=(m.stateNode._pendingVisibility&2)!==0,ie=h!==null?h.memoizedState:null;if(eg(h,m),w.mode==="hidden"||z){if((m.flags&128)!==0){if(w=ie!==null?ie.baseLanes|S:S,h!==null){for(D=m.child=h.child,z=0;D!==null;)z=z|D.lanes|D.childLanes,D=D.sibling;m.childLanes=z&~w}else m.childLanes=0,m.child=null;return AE(h,m,w,S)}if((S&536870912)!==0)m.memoizedState={baseLanes:0,cachePool:null},h!==null&&Yy(m,ie!==null?ie.cachePool:null),ie!==null?Zt(m,ie):Ln(),Bi(m);else return m.lanes=m.childLanes=536870912,AE(h,m,ie!==null?ie.baseLanes|S:S,S)}else ie!==null?(Yy(m,ie.cachePool),Zt(m,ie),Un(),m.memoizedState=null):(h!==null&&Yy(m,null),Ln(),Un());return qs(h,m,D,S),m.child}function AE(h,m,S,w){var D=pf();return D=D===null?null:{parent:Ou?Xi._currentValue:Xi._currentValue2,pool:D},m.memoizedState={baseLanes:S,cachePool:D},h!==null&&Yy(m,null),Ln(),Bi(m),h!==null&&Rd(h,m,w,!0),null}function eg(h,m){var S=m.ref;if(S===null)h!==null&&h.ref!==null&&(m.flags|=2097664);else{if(typeof S!="function"&&typeof S!="object")throw Error(i(284));(h===null||h.ref!==S)&&(m.flags|=2097664)}}function ab(h,m,S,w,D){return Cd(m),S=J(h,m,S,w,void 0,D),w=je(),h!==null&&!ns?(_t(h,m,D),mc(h,m,D)):(Ni&&w&&he(m),m.flags|=1,qs(h,m,S,D),m.child)}function wE(h,m,S,w,D,z){return Cd(m),m.updateQueue=null,S=De(m,w,S,D),me(h),w=je(),h!==null&&!ns?(_t(h,m,z),mc(h,m,z)):(Ni&&w&&he(m),m.flags|=1,qs(h,m,S,z),m.child)}function ob(h,m,S,w,D){if(Cd(m),m.stateNode===null){var z=kd,ie=S.contextType;typeof ie=="object"&&ie!==null&&(z=Xs(ie)),z=new S(w,z),m.memoizedState=z.state!==null&&z.state!==void 0?z.state:null,z.updater=O_,m.stateNode=z,z._reactInternals=m,z=m.stateNode,z.props=w,z.state=m.memoizedState,z.refs={},Yt(m),ie=S.contextType,z.context=typeof ie=="object"&&ie!==null?Xs(ie):kd,z.state=m.memoizedState,ie=S.getDerivedStateFromProps,typeof ie=="function"&&(sa(m,S,ie,w),z.state=m.memoizedState),typeof S.getDerivedStateFromProps=="function"||typeof z.getSnapshotBeforeUpdate=="function"||typeof z.UNSAFE_componentWillMount!="function"&&typeof z.componentWillMount!="function"||(ie=z.state,typeof z.componentWillMount=="function"&&z.componentWillMount(),typeof z.UNSAFE_componentWillMount=="function"&&z.UNSAFE_componentWillMount(),ie!==z.state&&O_.enqueueReplaceState(z,z.state,null),dt(m,w,z,D),Re(),z.state=m.memoizedState),typeof z.componentDidMount=="function"&&(m.flags|=4194308),w=!0}else if(h===null){z=m.stateNode;var ye=m.memoizedProps,Le=kl(S,ye);z.props=Le;var ft=z.context,Ht=S.contextType;ie=kd,typeof Ht=="object"&&Ht!==null&&(ie=Xs(Ht));var rn=S.getDerivedStateFromProps;Ht=typeof rn=="function"||typeof z.getSnapshotBeforeUpdate=="function",ye=m.pendingProps!==ye,Ht||typeof z.UNSAFE_componentWillReceiveProps!="function"&&typeof z.componentWillReceiveProps!="function"||(ye||ft!==ie)&&Km(m,z,w,ie),Cc=!1;var cn=m.memoizedState;z.state=cn,dt(m,w,z,D),Re(),ft=m.memoizedState,ye||cn!==ft||Cc?(typeof rn=="function"&&(sa(m,S,rn,w),ft=m.memoizedState),(Le=Cc||ff(m,S,Le,w,cn,ft,ie))?(Ht||typeof z.UNSAFE_componentWillMount!="function"&&typeof z.componentWillMount!="function"||(typeof z.componentWillMount=="function"&&z.componentWillMount(),typeof z.UNSAFE_componentWillMount=="function"&&z.UNSAFE_componentWillMount()),typeof z.componentDidMount=="function"&&(m.flags|=4194308)):(typeof z.componentDidMount=="function"&&(m.flags|=4194308),m.memoizedProps=w,m.memoizedState=ft),z.props=w,z.state=ft,z.context=ie,w=Le):(typeof z.componentDidMount=="function"&&(m.flags|=4194308),w=!1)}else{z=m.stateNode,$t(h,m),ie=m.memoizedProps,Ht=kl(S,ie),z.props=Ht,rn=m.pendingProps,cn=z.context,ft=S.contextType,Le=kd,typeof ft=="object"&&ft!==null&&(Le=Xs(ft)),ye=S.getDerivedStateFromProps,(ft=typeof ye=="function"||typeof z.getSnapshotBeforeUpdate=="function")||typeof z.UNSAFE_componentWillReceiveProps!="function"&&typeof z.componentWillReceiveProps!="function"||(ie!==rn||cn!==Le)&&Km(m,z,w,Le),Cc=!1,cn=m.memoizedState,z.state=cn,dt(m,w,z,D),Re();var Kn=m.memoizedState;ie!==rn||cn!==Kn||Cc||h!==null&&h.dependencies!==null&&hf(h.dependencies)?(typeof ye=="function"&&(sa(m,S,ye,w),Kn=m.memoizedState),(Ht=Cc||ff(m,S,Ht,w,cn,Kn,Le)||h!==null&&h.dependencies!==null&&hf(h.dependencies))?(ft||typeof z.UNSAFE_componentWillUpdate!="function"&&typeof z.componentWillUpdate!="function"||(typeof z.componentWillUpdate=="function"&&z.componentWillUpdate(w,Kn,Le),typeof z.UNSAFE_componentWillUpdate=="function"&&z.UNSAFE_componentWillUpdate(w,Kn,Le)),typeof z.componentDidUpdate=="function"&&(m.flags|=4),typeof z.getSnapshotBeforeUpdate=="function"&&(m.flags|=1024)):(typeof z.componentDidUpdate!="function"||ie===h.memoizedProps&&cn===h.memoizedState||(m.flags|=4),typeof z.getSnapshotBeforeUpdate!="function"||ie===h.memoizedProps&&cn===h.memoizedState||(m.flags|=1024),m.memoizedProps=w,m.memoizedState=Kn),z.props=w,z.state=Kn,z.context=Le,w=Ht):(typeof z.componentDidUpdate!="function"||ie===h.memoizedProps&&cn===h.memoizedState||(m.flags|=4),typeof z.getSnapshotBeforeUpdate!="function"||ie===h.memoizedProps&&cn===h.memoizedState||(m.flags|=1024),w=!1)}return z=w,eg(h,m),w=(m.flags&128)!==0,z||w?(z=m.stateNode,S=w&&typeof S.getDerivedStateFromError!="function"?null:z.render(),m.flags|=1,h!==null&&w?(m.child=Pf(m,h.child,null,D),m.child=Pf(m,null,S,D)):qs(h,m,S,D),m.memoizedState=z.state,h=m.child):h=mc(h,m,D),h}function RE(h,m,S,w){return Sn(),m.flags|=256,qs(h,m,S,w),m.child}function lb(h){return{baseLanes:h,cachePool:UE()}}function ub(h,m,S){return h=h!==null?h.childLanes&~S:0,m&&(h|=eo),h}function CE(h,m,S){var w=m.pendingProps,D=!1,z=(m.flags&128)!==0,ie;if((ie=z)||(ie=h!==null&&h.memoizedState===null?!1:(ys.current&2)!==0),ie&&(D=!0,m.flags&=-129),ie=(m.flags&32)!==0,m.flags&=-33,h===null){if(Ni){if(D?wn(m):Un(),Ni){var ye=Ks,Le;(Le=ye)&&(ye=rM(ye,pl),ye!==null?(m.memoizedState={dehydrated:ye,treeContext:$l!==null?{id:Pu,overflow:hl}:null,retryLane:536870912},Le=t(18,null,null,0),Le.stateNode=ye,Le.return=m,m.child=Le,ca=m,Ks=null,Le=!0):Le=!1),Le||rt(m)}if(ye=m.memoizedState,ye!==null&&(ye=ye.dehydrated,ye!==null))return xg(ye)?m.lanes=16:m.lanes=536870912,null;Jt(m)}return ye=w.children,w=w.fallback,D?(Un(),D=m.mode,ye=cb({mode:"hidden",children:ye},D),w=Tc(w,D,S,null),ye.return=m,w.return=m,ye.sibling=w,m.child=ye,D=m.child,D.memoizedState=lb(S),D.childLanes=ub(h,ie,S),m.memoizedState=da,w):(wn(m),tg(m,ye))}if(Le=h.memoizedState,Le!==null&&(ye=Le.dehydrated,ye!==null)){if(z)m.flags&256?(wn(m),m.flags&=-257,m=fb(h,m,S)):m.memoizedState!==null?(Un(),m.child=h.child,m.flags|=128,m=null):(Un(),D=w.fallback,ye=m.mode,w=cb({mode:"visible",children:w.children},ye),D=Tc(D,ye,S,null),D.flags|=2,w.return=m,D.return=m,w.sibling=D,m.child=w,Pf(m,h.child,null,S),w=m.child,w.memoizedState=lb(S),w.childLanes=ub(h,ie,S),m.memoizedState=da,m=D);else if(wn(m),xg(ye))ie=KE(ye).digest,w=Error(i(419)),w.stack="",w.digest=ie,At({value:w,source:null,stack:null}),m=fb(h,m,S);else if(ns||Rd(h,m,S,!1),ie=(S&h.childLanes)!==0,ns||ie){if(ie=ci,ie!==null){if(w=S&-S,(w&42)!==0)w=1;else switch(w){case 2:w=1;break;case 8:w=4;break;case 32:w=16;break;case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:w=64;break;case 268435456:w=134217728;break;default:w=0}if(w=(w&(ie.suspendedLanes|S))!==0?0:w,w!==0&&w!==Le.retryLane)throw Le.retryLane=w,xe(h,w),oa(ie,h,w),vM}x_(ye)||$a(),m=fb(h,m,S)}else x_(ye)?(m.flags|=128,m.child=h.child,m=Pd.bind(null,h),jN(ye,m),m=null):(h=Le.treeContext,Ra&&(Ks=tM(ye),ca=m,Ni=!0,Uo=null,pl=!1,h!==null&&(Do[Oo++]=Pu,Do[Oo++]=hl,Do[Oo++]=$l,Pu=h.id,hl=h.overflow,$l=m)),m=tg(m,w.children),m.flags|=4096);return m}return D?(Un(),D=w.fallback,ye=m.mode,Le=h.child,z=Le.sibling,w=la(Le,{mode:"hidden",children:w.children}),w.subtreeFlags=Le.subtreeFlags&31457280,z!==null?D=la(z,D):(D=Tc(D,ye,S,null),D.flags|=2),D.return=m,w.return=m,w.sibling=D,m.child=w,w=D,D=m.child,ye=h.child.memoizedState,ye===null?ye=lb(S):(Le=ye.cachePool,Le!==null?(z=Ou?Xi._currentValue:Xi._currentValue2,Le=Le.parent!==z?{parent:z,pool:z}:Le):Le=UE(),ye={baseLanes:ye.baseLanes|S,cachePool:Le}),D.memoizedState=ye,D.childLanes=ub(h,ie,S),m.memoizedState=da,w):(wn(m),S=h.child,h=S.sibling,S=la(S,{mode:"visible",children:w.children}),S.return=m,S.sibling=null,h!==null&&(ie=m.deletions,ie===null?(m.deletions=[h],m.flags|=16):ie.push(h)),m.child=S,m.memoizedState=null,S)}function tg(h,m){return m=cb({mode:"visible",children:m},h.mode),m.return=h,h.child=m}function cb(h,m){return u_(h,m,0,null)}function fb(h,m,S){return Pf(m,h.child,null,S),h=tg(m,m.pendingProps.children),h.flags|=2,m.memoizedState=null,h}function NE(h,m,S){h.lanes|=m;var w=h.alternate;w!==null&&(w.lanes|=m),hb(h.return,m,S)}function $y(h,m,S,w,D){var z=h.memoizedState;z===null?h.memoizedState={isBackwards:m,rendering:null,renderingStartTime:0,last:w,tail:S,tailMode:D}:(z.isBackwards=m,z.rendering=null,z.renderingStartTime=0,z.last=w,z.tail=S,z.tailMode=D)}function DE(h,m,S){var w=m.pendingProps,D=w.revealOrder,z=w.tail;if(qs(h,m,w.children,S),w=ys.current,(w&2)!==0)w=w&1|2,m.flags|=128;else{if(h!==null&&(h.flags&128)!==0)e:for(h=m.child;h!==null;){if(h.tag===13)h.memoizedState!==null&&NE(h,S,m);else if(h.tag===19)NE(h,S,m);else if(h.child!==null){h.child.return=h,h=h.child;continue}if(h===m)break e;for(;h.sibling===null;){if(h.return===null||h.return===m)break e;h=h.return}h.sibling.return=h.return,h=h.sibling}w&=1}switch(M(ys,w),D){case"forwards":for(S=m.child,D=null;S!==null;)h=S.alternate,h!==null&&xi(h)===null&&(D=S),S=S.sibling;S=D,S===null?(D=m.child,m.child=null):(D=S.sibling,S.sibling=null),$y(m,!1,D,S,z);break;case"backwards":for(S=null,D=m.child,m.child=null;D!==null;){if(h=D.alternate,h!==null&&xi(h)===null){m.child=D;break}h=D.sibling,D.sibling=S,S=D,D=h}$y(m,!0,S,null,z);break;case"together":$y(m,!1,null,null,void 0);break;default:m.memoizedState=null}return m.child}function mc(h,m,S){if(h!==null&&(m.dependencies=h.dependencies),Fo|=m.lanes,(S&m.childLanes)===0)if(h!==null){if(Rd(h,m,S,!1),(S&m.childLanes)===0)return null}else return null;if(h!==null&&m.child!==h.child)throw Error(i(153));if(m.child!==null){for(h=m.child,S=la(h,h.pendingProps),m.child=S,S.return=m;h.sibling!==null;)h=h.sibling,S=S.sibling=la(h,h.pendingProps),S.return=m;S.sibling=null}return m.child}function db(h,m){return(h.lanes&m)!==0?!0:(h=h.dependencies,!!(h!==null&&hf(h)))}function qN(h,m,S){switch(m.tag){case 3:Ie(m,m.stateNode.containerInfo),df(m,Xi,h.memoizedState.cache),Sn();break;case 27:case 5:Ee(m);break;case 4:Ie(m,m.stateNode.containerInfo);break;case 10:df(m,m.type,m.memoizedProps.value);break;case 13:var w=m.memoizedState;if(w!==null)return w.dehydrated!==null?(wn(m),m.flags|=128,null):(S&m.child.childLanes)!==0?CE(h,m,S):(wn(m),h=mc(h,m,S),h!==null?h.sibling:null);wn(m);break;case 19:var D=(h.flags&128)!==0;if(w=(S&m.childLanes)!==0,w||(Rd(h,m,S,!1),w=(S&m.childLanes)!==0),D){if(w)return DE(h,m,S);m.flags|=128}if(D=m.memoizedState,D!==null&&(D.rendering=null,D.tail=null,D.lastEffect=null),M(ys,ys.current),w)break;return null;case 22:case 23:return m.lanes=0,ME(h,m,S);case 24:df(m,Xi,h.memoizedState.cache)}return mc(h,m,S)}function OE(h,m,S){if(h!==null)if(h.memoizedProps!==m.pendingProps)ns=!0;else{if(!db(h,S)&&(m.flags&128)===0)return ns=!1,qN(h,m,S);ns=(h.flags&131072)!==0}else ns=!1,Ni&&(m.flags&1048576)!==0&&K(m,Ag,m.index);switch(m.lanes=0,m.tag){case 16:e:{h=m.pendingProps;var w=m.elementType,D=w._init;if(w=D(w._payload),m.type=w,typeof w=="function")bc(w)?(h=kl(w,h),m.tag=1,m=ob(null,m,w,h,S)):(m.tag=0,m=ab(null,m,w,h,S));else{if(w!=null){if(D=w.$$typeof,D===pp){m.tag=11,m=TE(null,m,w,h,S);break e}else if(D===dg){m.tag=14,m=EE(null,m,w,h,S);break e}}throw m=a(w)||w,Error(i(306,m,""))}}return m;case 0:return ab(h,m,m.type,m.pendingProps,S);case 1:return w=m.type,D=kl(w,m.pendingProps),ob(h,m,w,D,S);case 3:e:{if(Ie(m,m.stateNode.containerInfo),h===null)throw Error(i(387));var z=m.pendingProps;D=m.memoizedState,w=D.element,$t(h,m),dt(m,z,null,S);var ie=m.memoizedState;if(z=ie.cache,df(m,Xi,z),z!==D.cache&&pb(m,[Xi],S,!0),Re(),z=ie.element,Ra&&D.isDehydrated)if(D={element:z,isDehydrated:!1,cache:ie.cache},m.updateQueue.baseState=D,m.memoizedState=D,m.flags&256){m=RE(h,m,z,S);break e}else if(z!==w){w=fe(Error(i(424)),m),At(w),m=RE(h,m,z,S);break e}else for(Ra&&(Ks=eM(m.stateNode.containerInfo),ca=m,Ni=!0,Uo=null,pl=!0),S=pS(m,null,z,S),m.child=S;S;)S.flags=S.flags&-3|4096,S=S.sibling;else{if(Sn(),z===w){m=mc(h,m,S);break e}qs(h,m,z,S)}m=m.child}return m;case 26:if(Co)return eg(h,m),h===null?(S=M_(m.type,null,m.pendingProps,null))?m.memoizedState=S:Ni||(m.stateNode=ZN(m.type,m.pendingProps,jl.current,m)):m.memoizedState=M_(m.type,h.memoizedProps,m.pendingProps,h.memoizedState),null;case 27:if(Ys)return Ee(m),h===null&&Ys&&Ni&&(w=m.stateNode=cS(m.type,m.pendingProps,jl.current,Bs.current,!1),ca=m,pl=!0,Ks=b_(w)),w=m.pendingProps.children,h!==null||Ni?qs(h,m,w,S):m.child=Pf(m,null,w,S),eg(h,m),m.child;case 5:return h===null&&Ni&&(uM(m.type,m.pendingProps,Bs.current),(D=w=Ks)&&(w=nM(w,m.type,m.pendingProps,pl),w!==null?(m.stateNode=w,ca=m,Ks=b_(w),pl=!1,D=!0):D=!1),D||rt(m)),Ee(m),D=m.type,z=m.pendingProps,ie=h!==null?h.memoizedProps:null,w=z.children,Nf(D,z)?w=null:ie!==null&&Nf(D,ie)&&(m.flags|=32),m.memoizedState!==null&&(D=J(h,m,$e,null,null,S),Ou?qn._currentValue=D:qn._currentValue2=D),eg(h,m),qs(h,m,w,S),m.child;case 6:return h===null&&Ni&&(cM(m.pendingProps,Bs.current),(h=S=Ks)&&(S=iM(S,m.pendingProps,pl),S!==null?(m.stateNode=S,ca=m,Ks=null,h=!0):h=!1),h||rt(m)),null;case 13:return CE(h,m,S);case 4:return Ie(m,m.stateNode.containerInfo),w=m.pendingProps,h===null?m.child=Pf(m,null,w,S):qs(h,m,w,S),m.child;case 11:return TE(h,m,m.type,m.pendingProps,S);case 7:return qs(h,m,m.pendingProps,S),m.child;case 8:return qs(h,m,m.pendingProps.children,S),m.child;case 12:return qs(h,m,m.pendingProps.children,S),m.child;case 10:return w=m.pendingProps,df(m,m.type,w.value),qs(h,m,w.children,S),m.child;case 9:return D=m.type._context,w=m.pendingProps.children,Cd(m),D=Xs(D),w=w(D),m.flags|=1,qs(h,m,w,S),m.child;case 14:return EE(h,m,m.type,m.pendingProps,S);case 15:return Xy(h,m,m.type,m.pendingProps,S);case 19:return DE(h,m,S);case 22:return ME(h,m,S);case 24:return Cd(m),w=Xs(Xi),h===null?(D=pf(),D===null&&(D=ci,z=jy(),D.pooledCache=z,z.refCount++,z!==null&&(D.pooledCacheLanes|=S),D=z),m.memoizedState={parent:w,cache:D},Yt(m),df(m,Xi,D)):((h.lanes&S)!==0&&($t(h,m),dt(m,null,null,S),Re()),D=h.memoizedState,z=m.memoizedState,D.parent!==w?(D={parent:w,cache:w},m.memoizedState=D,m.lanes===0&&(m.memoizedState=m.updateQueue.baseState=D),df(m,Xi,w)):(w=z.cache,df(m,Xi,w),w!==D.cache&&pb(m,[Xi],S,!0))),qs(h,m,m.pendingProps.children,S),m.child;case 29:throw m.pendingProps}throw Error(i(156,m.tag))}function df(h,m,S){Ou?(M(Qa,m._currentValue),m._currentValue=S):(M(Qa,m._currentValue2),m._currentValue2=S)}function gc(h){var m=Qa.current;Ou?h._currentValue=m:h._currentValue2=m,T(Qa)}function hb(h,m,S){for(;h!==null;){var w=h.alternate;if((h.childLanes&m)!==m?(h.childLanes|=m,w!==null&&(w.childLanes|=m)):w!==null&&(w.childLanes&m)!==m&&(w.childLanes|=m),h===S)break;h=h.return}}function pb(h,m,S,w){var D=h.child;for(D!==null&&(D.return=h);D!==null;){var z=D.dependencies;if(z!==null){var ie=D.child;z=z.firstContext;e:for(;z!==null;){var ye=z;z=D;for(var Le=0;Le<m.length;Le++)if(ye.context===m[Le]){z.lanes|=S,ye=z.alternate,ye!==null&&(ye.lanes|=S),hb(z.return,S,h),w||(ie=null);break e}z=ye.next}}else if(D.tag===18){if(ie=D.return,ie===null)throw Error(i(341));ie.lanes|=S,z=ie.alternate,z!==null&&(z.lanes|=S),hb(ie,S,h),ie=null}else ie=D.child;if(ie!==null)ie.return=D;else for(ie=D;ie!==null;){if(ie===h){ie=null;break}if(D=ie.sibling,D!==null){D.return=ie.return,ie=D;break}ie=ie.return}D=ie}}function Rd(h,m,S,w){h=null;for(var D=m,z=!1;D!==null;){if(!z){if((D.flags&524288)!==0)z=!0;else if((D.flags&262144)!==0)break}if(D.tag===10){var ie=D.alternate;if(ie===null)throw Error(i(387));if(ie=ie.memoizedProps,ie!==null){var ye=D.type;No(D.pendingProps.value,ie.value)||(h!==null?h.push(ye):h=[ye])}}else if(D===bp.current){if(ie=D.alternate,ie===null)throw Error(i(387));ie.memoizedState.memoizedState!==D.memoizedState.memoizedState&&(h!==null?h.push(qn):h=[qn])}D=D.return}h!==null&&pb(m,h,S,w),m.flags|=262144}function hf(h){for(h=h.firstContext;h!==null;){var m=h.context;if(!No(Ou?m._currentValue:m._currentValue2,h.memoizedValue))return!0;h=h.next}return!1}function Cd(h){If=h,qr=null,h=h.dependencies,h!==null&&(h.firstContext=null)}function Xs(h){return mb(If,h)}function ng(h,m){return If===null&&Cd(h),mb(h,m)}function mb(h,m){var S=Ou?m._currentValue:m._currentValue2;if(m={context:m,memoizedValue:S,next:null},qr===null){if(h===null)throw Error(i(308));qr=m,h.dependencies={lanes:0,firstContext:m},h.flags|=524288}else qr=qr.next=m;return S}function jy(){return{controller:new xM,data:new Map,refCount:0}}function Jh(h){h.refCount--,h.refCount===0&&Dc(qd,function(){h.controller.abort()})}function pf(){var h=Oc.current;return h!==null?h:ci.pooledCache}function Yy(h,m){m===null?M(Oc,Oc.current):M(Oc,m.pool)}function UE(){var h=pf();return h===null?null:{parent:Ou?Xi._currentValue:Xi._currentValue2,pool:h}}function Eo(h){h.flags|=4}function gb(h,m){if(h!==null&&h.child===m.child)return!1;if((m.flags&16)!==0)return!0;for(h=m.child;h!==null;){if((h.flags&13878)!==0||(h.subtreeFlags&13878)!==0)return!0;h=h.sibling}return!1}function Zy(h,m,S,w){if(js)for(S=m.child;S!==null;){if(S.tag===5||S.tag===6)Du(h,S.stateNode);else if(!(S.tag===4||Ys&&S.tag===27)&&S.child!==null){S.child.return=S,S=S.child;continue}if(S===m)break;for(;S.sibling===null;){if(S.return===null||S.return===m)return;S=S.return}S.sibling.return=S.return,S=S.sibling}else if(wo)for(var D=m.child;D!==null;){if(D.tag===5){var z=D.stateNode;S&&w&&(z=Kb(z,D.type,D.memoizedProps)),Du(h,z)}else if(D.tag===6)z=D.stateNode,S&&w&&(z=Qb(z,D.memoizedProps)),Du(h,z);else if(D.tag!==4){if(D.tag===22&&D.memoizedState!==null)z=D.child,z!==null&&(z.return=D),Zy(h,D,!0,!0);else if(D.child!==null){D.child.return=D,D=D.child;continue}}if(D===m)break;for(;D.sibling===null;){if(D.return===null||D.return===m)return;D=D.return}D.sibling.return=D.return,D=D.sibling}}function ep(h,m,S,w){if(wo)for(var D=m.child;D!==null;){if(D.tag===5){var z=D.stateNode;S&&w&&(z=Kb(z,D.type,D.memoizedProps)),Yb(h,z)}else if(D.tag===6)z=D.stateNode,S&&w&&(z=Qb(z,D.memoizedProps)),Yb(h,z);else if(D.tag!==4){if(D.tag===22&&D.memoizedState!==null)z=D.child,z!==null&&(z.return=D),ep(h,D,!(D.memoizedProps!==null&&D.memoizedProps.mode==="manual"),!0);else if(D.child!==null){D.child.return=D,D=D.child;continue}}if(D===m)break;for(;D.sibling===null;){if(D.return===null||D.return===m)return;D=D.return}D.sibling.return=D.return,D=D.sibling}}function tp(h,m){if(wo&&gb(h,m)){h=m.stateNode;var S=h.containerInfo,w=v_();ep(w,m,!1,!1),h.pendingChildren=w,Eo(m),ZE(S,w)}}function yb(h,m,S,w){if(js)h.memoizedProps!==w&&Eo(m);else if(wo){var D=h.stateNode,z=h.memoizedProps;if((h=gb(h,m))||z!==w){var ie=Bs.current;z=jb(D,S,z,w,!h,null),z===D?m.stateNode=D:(Mc(z,S,w,ie)&&Eo(m),m.stateNode=z,h?Zy(z,m,!1,!1):Eo(m))}else m.stateNode=D}}function np(h,m,S){if($E(m,S)){if(h.flags|=16777216,!Ac(m,S))if(lg())h.flags|=8192;else throw Wd=N_,hS}else h.flags&=-16777217}function _b(h,m){if(fM(m)){if(h.flags|=16777216,!lS(m))if(lg())h.flags|=8192;else throw Wd=N_,hS}else h.flags&=-16777217}function ig(h,m){m!==null&&(h.flags|=4),h.flags&16384&&(m=h.tag!==22?O():536870912,h.lanes|=m,Lc|=m)}function Nd(h,m){if(!Ni)switch(h.tailMode){case"hidden":m=h.tail;for(var S=null;m!==null;)m.alternate!==null&&(S=m),m=m.sibling;S===null?h.tail=null:S.sibling=null;break;case"collapsed":S=h.tail;for(var w=null;S!==null;)S.alternate!==null&&(w=S),S=S.sibling;w===null?m||h.tail===null?h.tail=null:h.tail.sibling=null:w.sibling=null}}function Er(h){var m=h.alternate!==null&&h.alternate.child===h.child,S=0,w=0;if(m)for(var D=h.child;D!==null;)S|=D.lanes|D.childLanes,w|=D.subtreeFlags&31457280,w|=D.flags&31457280,D.return=h,D=D.sibling;else for(D=h.child;D!==null;)S|=D.lanes|D.childLanes,w|=D.subtreeFlags,w|=D.flags,D.return=h,D=D.sibling;return h.subtreeFlags|=w,h.childLanes=S,m}function LE(h,m,S){var w=m.pendingProps;switch(Ce(m),m.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Er(m),null;case 1:return Er(m),null;case 3:return S=m.stateNode,w=null,h!==null&&(w=h.memoizedState.cache),m.memoizedState.cache!==w&&(m.flags|=2048),gc(Xi),ut(),S.pendingContext&&(S.context=S.pendingContext,S.pendingContext=null),(h===null||h.child===null)&&(fn(m)?Eo(m):h===null||h.memoizedState.isDehydrated&&(m.flags&256)===0||(m.flags|=1024,Uo!==null&&(_c(Uo),Uo=null))),tp(h,m),Er(m),null;case 26:if(Co){S=m.type;var D=m.memoizedState;return h===null?(Eo(m),D!==null?(Er(m),_b(m,D)):(Er(m),np(m,S,w))):D?D!==h.memoizedState?(Eo(m),Er(m),_b(m,D)):(Er(m),m.flags&=-16777217):(js?h.memoizedProps!==w&&Eo(m):yb(h,m,S,w),Er(m),np(m,S,w)),null}case 27:if(Ys){if(Ne(m),S=jl.current,D=m.type,h!==null&&m.stateNode!=null)js?h.memoizedProps!==w&&Eo(m):yb(h,m,D,w);else{if(!w){if(m.stateNode===null)throw Error(i(166));return Er(m),null}h=Bs.current,fn(m)?Nt(m,h):(h=cS(D,w,S,h,!0),m.stateNode=h,Eo(m))}return Er(m),null}case 5:if(Ne(m),S=m.type,h!==null&&m.stateNode!=null)yb(h,m,S,w);else{if(!w){if(m.stateNode===null)throw Error(i(166));return Er(m),null}h=Bs.current,fn(m)?Nt(m,h):(D=Ib(S,w,jl.current,h,m),Zy(D,m,!1,!1),m.stateNode=D,Mc(D,S,w,h)&&Eo(m))}return Er(m),np(m,m.type,m.pendingProps),null;case 6:if(h&&m.stateNode!=null)S=h.memoizedProps,js?S!==w&&Eo(m):wo&&(S!==w?(m.stateNode=h_(w,jl.current,Bs.current,m),Eo(m)):m.stateNode=h.stateNode);else{if(typeof w!="string"&&m.stateNode===null)throw Error(i(166));if(h=jl.current,S=Bs.current,fn(m)){if(!Ra)throw Error(i(176));if(h=m.stateNode,S=m.memoizedProps,w=null,D=ca,D!==null)switch(D.tag){case 27:case 5:w=D.memoizedProps}sM(h,S,m,w)||rt(m)}else m.stateNode=h_(w,h,S,m)}return Er(m),null;case 13:if(w=m.memoizedState,h===null||h.memoizedState!==null&&h.memoizedState.dehydrated!==null){if(D=fn(m),w!==null&&w.dehydrated!==null){if(h===null){if(!D)throw Error(i(318));if(!Ra)throw Error(i(344));if(D=m.memoizedState,D=D!==null?D.dehydrated:null,!D)throw Error(i(317));gp(D,m)}else Sn(),(m.flags&128)===0&&(m.memoizedState=null),m.flags|=4;Er(m),D=!1}else Uo!==null&&(_c(Uo),Uo=null),D=!0;if(!D)return m.flags&256?(Jt(m),m):(Jt(m),null)}if(Jt(m),(m.flags&128)!==0)return m.lanes=S,m;if(S=w!==null,h=h!==null&&h.memoizedState!==null,S){w=m.child,D=null,w.alternate!==null&&w.alternate.memoizedState!==null&&w.alternate.memoizedState.cachePool!==null&&(D=w.alternate.memoizedState.cachePool.pool);var z=null;w.memoizedState!==null&&w.memoizedState.cachePool!==null&&(z=w.memoizedState.cachePool.pool),z!==D&&(w.flags|=2048)}return S!==h&&S&&(m.child.flags|=8192),ig(m,m.updateQueue),Er(m),null;case 4:return ut(),tp(h,m),h===null&&Vb(m.stateNode.containerInfo),Er(m),null;case 10:return gc(m.type),Er(m),null;case 19:if(T(ys),D=m.memoizedState,D===null)return Er(m),null;if(w=(m.flags&128)!==0,z=D.rendering,z===null)if(w)Nd(D,!1);else{if(Ai!==0||h!==null&&(h.flags&128)!==0)for(h=m.child;h!==null;){if(z=xi(h),z!==null){for(m.flags|=128,Nd(D,!1),h=z.updateQueue,m.updateQueue=h,ig(m,h),m.subtreeFlags=0,h=S,S=m.child;S!==null;)Sc(S,h),S=S.sibling;return M(ys,ys.current&1|2),m.child}h=h.sibling}D.tail!==null&&Zs()>Pr&&(m.flags|=128,w=!0,Nd(D,!1),m.lanes=4194304)}else{if(!w)if(h=xi(z),h!==null){if(m.flags|=128,w=!0,h=h.updateQueue,m.updateQueue=h,ig(m,h),Nd(D,!0),D.tail===null&&D.tailMode==="hidden"&&!z.alternate&&!Ni)return Er(m),null}else 2*Zs()-D.renderingStartTime>Pr&&S!==536870912&&(m.flags|=128,w=!0,Nd(D,!1),m.lanes=4194304);D.isBackwards?(z.sibling=m.child,m.child=z):(h=D.last,h!==null?h.sibling=z:m.child=z,D.last=z)}return D.tail!==null?(m=D.tail,D.rendering=m,D.tail=m.sibling,D.renderingStartTime=Zs(),m.sibling=null,h=ys.current,M(ys,w?h&1|2:h&1),m):(Er(m),null);case 22:case 23:return Jt(m),dn(),w=m.memoizedState!==null,h!==null?h.memoizedState!==null!==w&&(m.flags|=8192):w&&(m.flags|=8192),w?(S&536870912)!==0&&(m.flags&128)===0&&(Er(m),m.subtreeFlags&6&&(m.flags|=8192)):Er(m),S=m.updateQueue,S!==null&&ig(m,S.retryQueue),S=null,h!==null&&h.memoizedState!==null&&h.memoizedState.cachePool!==null&&(S=h.memoizedState.cachePool.pool),w=null,m.memoizedState!==null&&m.memoizedState.cachePool!==null&&(w=m.memoizedState.cachePool.pool),w!==S&&(m.flags|=2048),h!==null&&T(Oc),null;case 24:return S=null,h!==null&&(S=h.memoizedState.cache),m.memoizedState.cache!==S&&(m.flags|=2048),gc(Xi),Er(m),null;case 25:return null}throw Error(i(156,m.tag))}function PE(h,m){switch(Ce(m),m.tag){case 1:return h=m.flags,h&65536?(m.flags=h&-65537|128,m):null;case 3:return gc(Xi),ut(),h=m.flags,(h&65536)!==0&&(h&128)===0?(m.flags=h&-65537|128,m):null;case 26:case 27:case 5:return Ne(m),null;case 13:if(Jt(m),h=m.memoizedState,h!==null&&h.dehydrated!==null){if(m.alternate===null)throw Error(i(340));Sn()}return h=m.flags,h&65536?(m.flags=h&-65537|128,m):null;case 19:return T(ys),null;case 4:return ut(),null;case 10:return gc(m.type),null;case 22:case 23:return Jt(m),dn(),h!==null&&T(Oc),h=m.flags,h&65536?(m.flags=h&-65537|128,m):null;case 24:return gc(Xi),null;case 25:return null;default:return null}}function vb(h,m){switch(Ce(m),m.tag){case 3:gc(Xi),ut();break;case 26:case 27:case 5:Ne(m);break;case 4:ut();break;case 13:Jt(m);break;case 19:T(ys);break;case 10:gc(m.type);break;case 22:case 23:Jt(m),dn(),h!==null&&T(Oc);break;case 24:gc(Xi)}}function rg(h,m){try{var S=m.updateQueue,w=S!==null?S.lastEffect:null;if(w!==null){var D=w.next;S=D;do{if((S.tag&h)===h){w=void 0;var z=S.create,ie=S.inst;w=z(),ie.destroy=w}S=S.next}while(S!==D)}}catch(ye){di(m,m.return,ye)}}function mf(h,m,S){try{var w=m.updateQueue,D=w!==null?w.lastEffect:null;if(D!==null){var z=D.next;w=z;do{if((w.tag&h)===h){var ie=w.inst,ye=ie.destroy;if(ye!==void 0){ie.destroy=void 0,D=m;var Le=S;try{ye()}catch(ft){di(D,Le,ft)}}}w=w.next}while(w!==z)}}catch(ft){di(m,m.return,ft)}}function BE(h){var m=h.updateQueue;if(m!==null){var S=h.stateNode;try{Be(m,S)}catch(w){di(h,h.return,w)}}}function IE(h,m,S){S.props=kl(h.type,h.memoizedProps),S.state=h.memoizedState;try{S.componentWillUnmount()}catch(w){di(h,m,w)}}function Dd(h,m){try{var S=h.ref;if(S!==null){var w=h.stateNode;switch(h.tag){case 26:case 27:case 5:var D=mp(w);break;default:D=w}typeof S=="function"?h.refCleanup=S(D):S.current=D}}catch(z){di(h,m,z)}}function Mr(h,m){var S=h.ref,w=h.refCleanup;if(S!==null)if(typeof w=="function")try{w()}catch(D){di(h,m,D)}finally{h.refCleanup=null,h=h.alternate,h!=null&&(h.refCleanup=null)}else if(typeof S=="function")try{S(null)}catch(D){di(h,m,D)}else S.current=null}function ip(h){var m=h.type,S=h.memoizedProps,w=h.stateNode;try{$N(w,m,S,h)}catch(D){di(h,h.return,D)}}function xb(h,m,S){try{Wb(h.stateNode,h.type,S,m,h)}catch(w){di(h,h.return,w)}}function bb(h){return h.tag===5||h.tag===3||(Co?h.tag===26:!1)||(Ys?h.tag===27:!1)||h.tag===4}function Ky(h){e:for(;;){for(;h.sibling===null;){if(h.return===null||bb(h.return))return null;h=h.return}for(h.sibling.return=h.return,h=h.sibling;h.tag!==5&&h.tag!==6&&(!Ys||h.tag!==27)&&h.tag!==18;){if(h.flags&2||h.child===null||h.tag===4)continue e;h.child.return=h,h=h.child}if(!(h.flags&2))return h.stateNode}}function Qy(h,m,S){var w=h.tag;if(w===5||w===6)h=h.stateNode,m?Xb(S,h,m):jE(S,h);else if(!(w===4||Ys&&w===27)&&(h=h.child,h!==null))for(Qy(h,m,S),h=h.sibling;h!==null;)Qy(h,m,S),h=h.sibling}function rp(h,m,S){var w=h.tag;if(w===5||w===6)h=h.stateNode,m?qb(S,h,m):Hb(S,h);else if(!(w===4||Ys&&w===27)&&(h=h.child,h!==null))for(rp(h,m,S),h=h.sibling;h!==null;)rp(h,m,S),h=h.sibling}function FE(h,m,S){h=h.containerInfo;try{Zb(h,S)}catch(w){di(m,m.return,w)}}function sp(h,m){for(Cf(h.containerInfo),Xr=m;Xr!==null;)if(h=Xr,m=h.child,(h.subtreeFlags&1028)!==0&&m!==null)m.return=h,Xr=m;else for(;Xr!==null;){h=Xr;var S=h.alternate;switch(m=h.flags,h.tag){case 0:break;case 11:case 15:break;case 1:if((m&1024)!==0&&S!==null){m=void 0;var w=h,D=S.memoizedProps;S=S.memoizedState;var z=w.stateNode;try{var ie=kl(w.type,D,w.elementType===w.type);m=z.getSnapshotBeforeUpdate(ie,S),z.__reactInternalSnapshotBeforeUpdate=m}catch(ye){di(w,w.return,ye)}}break;case 3:(m&1024)!==0&&js&&__(h.stateNode.containerInfo);break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((m&1024)!==0)throw Error(i(163))}if(m=h.sibling,m!==null){m.return=h.return,Xr=m;break}Xr=h.return}return ie=Xd,Xd=!1,ie}function Jy(h,m,S){var w=S.flags;switch(S.tag){case 0:case 11:case 15:Mu(h,S),w&4&&rg(5,S);break;case 1:if(Mu(h,S),w&4)if(h=S.stateNode,m===null)try{h.componentDidMount()}catch(ye){di(S,S.return,ye)}else{var D=kl(S.type,m.memoizedProps);m=m.memoizedState;try{h.componentDidUpdate(D,m,h.__reactInternalSnapshotBeforeUpdate)}catch(ye){di(S,S.return,ye)}}w&64&&BE(S),w&512&&Dd(S,S.return);break;case 3:if(Mu(h,S),w&64&&(w=S.updateQueue,w!==null)){if(h=null,S.child!==null)switch(S.child.tag){case 27:case 5:h=mp(S.child.stateNode);break;case 1:h=S.child.stateNode}try{Be(w,h)}catch(ye){di(S,S.return,ye)}}break;case 26:if(Co){Mu(h,S),w&512&&Dd(S,S.return);break}case 27:case 5:Mu(h,S),m===null&&w&4&&ip(S),w&512&&Dd(S,S.return);break;case 12:Mu(h,S);break;case 13:Mu(h,S),w&4&&gf(h,S);break;case 22:if(D=S.memoizedState!==null||Es,!D){m=m!==null&&m.memoizedState!==null||Lr;var z=Es,ie=Lr;Es=D,(Lr=m)&&!ie?_f(h,S,(S.subtreeFlags&8772)!==0):Mu(h,S),Es=z,Lr=ie}w&512&&(S.memoizedProps.mode==="manual"?Dd(S,S.return):Mr(S,S.return));break;default:Mu(h,S)}}function ap(h){var m=h.alternate;m!==null&&(h.alternate=null,ap(m)),h.child=null,h.deletions=null,h.sibling=null,h.tag===5&&(m=h.stateNode,m!==null&&Gb(m)),h.stateNode=null,h.return=null,h.dependencies=null,h.memoizedProps=null,h.memoizedState=null,h.pendingProps=null,h.stateNode=null,h.updateQueue=null}function Mo(h,m,S){for(S=S.child;S!==null;)e_(h,m,S),S=S.sibling}function e_(h,m,S){if(Za&&typeof Za.onCommitFiberUnmount=="function")try{Za.onCommitFiberUnmount(xp,S)}catch{}switch(S.tag){case 26:if(Co){Lr||Mr(S,m),Mo(h,m,S),S.memoizedState?iS(S.memoizedState):S.stateNode&&aS(S.stateNode);break}case 27:if(Ys){Lr||Mr(S,m);var w=is,D=Ja;is=S.stateNode,Mo(h,m,S),dM(S.stateNode),is=w,Ja=D;break}case 5:Lr||Mr(S,m);case 6:if(js){if(w=is,D=Ja,is=null,Mo(h,m,S),is=w,Ja=D,is!==null)if(Ja)try{es(is,S.stateNode)}catch(z){di(S,m,z)}else try{Ca(is,S.stateNode)}catch(z){di(S,m,z)}}else Mo(h,m,S);break;case 18:js&&is!==null&&(Ja?eS(is,S.stateNode):oM(is,S.stateNode));break;case 4:js?(w=is,D=Ja,is=S.stateNode.containerInfo,Ja=!0,Mo(h,m,S),is=w,Ja=D):(wo&&FE(S.stateNode,S,v_()),Mo(h,m,S));break;case 0:case 11:case 14:case 15:Lr||mf(2,S,m),Lr||mf(4,S,m),Mo(h,m,S);break;case 1:Lr||(Mr(S,m),w=S.stateNode,typeof w.componentWillUnmount=="function"&&IE(S,m,w)),Mo(h,m,S);break;case 21:Mo(h,m,S);break;case 22:Lr||Mr(S,m),Lr=(w=Lr)||S.memoizedState!==null,Mo(h,m,S),Lr=w;break;default:Mo(h,m,S)}}function gf(h,m){if(Ra&&m.memoizedState===null&&(h=m.alternate,h!==null&&(h=h.memoizedState,h!==null&&(h=h.dehydrated,h!==null))))try{T_(h)}catch(S){di(m,m.return,S)}}function op(h){switch(h.tag){case 13:case 19:var m=h.stateNode;return m===null&&(m=h.stateNode=new Ap),m;case 22:return h=h.stateNode,m=h._retryCache,m===null&&(m=h._retryCache=new Ap),m;default:throw Error(i(435,h.tag))}}function sg(h,m){var S=op(h);m.forEach(function(w){var D=Ab.bind(null,h,w);S.has(w)||(S.add(w),w.then(D,D))})}function Ma(h,m){var S=m.deletions;if(S!==null)for(var w=0;w<S.length;w++){var D=S[w],z=h,ie=m;if(js){var ye=ie;e:for(;ye!==null;){switch(ye.tag){case 27:case 5:is=ye.stateNode,Ja=!1;break e;case 3:is=ye.stateNode.containerInfo,Ja=!0;break e;case 4:is=ye.stateNode.containerInfo,Ja=!0;break e}ye=ye.return}if(is===null)throw Error(i(160));e_(z,ie,D),is=null,Ja=!1}else e_(z,ie,D);z=D.alternate,z!==null&&(z.return=null),D.return=null}if(m.subtreeFlags&13878)for(m=m.child;m!==null;)yf(m,h),m=m.sibling}function yf(h,m){var S=h.alternate,w=h.flags;switch(h.tag){case 0:case 11:case 14:case 15:Ma(m,h),qa(h),w&4&&(mf(3,h,h.return),rg(3,h),mf(5,h,h.return));break;case 1:Ma(m,h),qa(h),w&512&&(Lr||S===null||Mr(S,S.return)),w&64&&Es&&(h=h.updateQueue,h!==null&&(w=h.callbacks,w!==null&&(S=h.shared.hiddenCallbacks,h.shared.hiddenCallbacks=S===null?w:S.concat(w))));break;case 26:if(Co){var D=Na;Ma(m,h),qa(h),w&512&&(Lr||S===null||Mr(S,S.return)),w&4&&(w=S!==null?S.memoizedState:null,m=h.memoizedState,S===null?m===null?h.stateNode===null?h.stateNode=rS(D,h.type,h.memoizedProps,h):sS(D,h.type,h.stateNode):h.stateNode=nS(D,m,h.memoizedProps):w!==m?(w===null?S.stateNode!==null&&aS(S.stateNode):iS(w),m===null?sS(D,h.type,h.stateNode):nS(D,m,h.memoizedProps)):m===null&&h.stateNode!==null&&xb(h,h.memoizedProps,S.memoizedProps));break}case 27:if(Ys&&w&4&&h.alternate===null){D=h.stateNode;var z=h.memoizedProps;try{KN(D),QN(h.type,z,D,h)}catch(Ht){di(h,h.return,Ht)}}case 5:if(Ma(m,h),qa(h),w&512&&(Lr||S===null||Mr(S,S.return)),js){if(h.flags&32){m=h.stateNode;try{_g(m)}catch(Ht){di(h,h.return,Ht)}}w&4&&h.stateNode!=null&&(m=h.memoizedProps,xb(h,m,S!==null?S.memoizedProps:m)),w&1024&&(Ff=!0)}break;case 6:if(Ma(m,h),qa(h),w&4&&js){if(h.stateNode===null)throw Error(i(162));w=h.memoizedProps,S=S!==null?S.memoizedProps:w,m=h.stateNode;try{YE(m,S,w)}catch(Ht){di(h,h.return,Ht)}}break;case 3:if(Co?(oS(),D=Na,Na=E_(m.containerInfo),Ma(m,h),Na=D):Ma(m,h),qa(h),w&4){if(js&&Ra&&S!==null&&S.memoizedState.isDehydrated)try{S_(m.containerInfo)}catch(Ht){di(h,h.return,Ht)}if(wo){w=m.containerInfo,S=m.pendingChildren;try{Zb(w,S)}catch(Ht){di(h,h.return,Ht)}}}Ff&&(Ff=!1,Sb(h));break;case 4:Co?(S=Na,Na=E_(h.stateNode.containerInfo),Ma(m,h),qa(h),Na=S):(Ma(m,h),qa(h)),w&4&&wo&&FE(h.stateNode,h,h.stateNode.pendingChildren);break;case 12:Ma(m,h),qa(h);break;case 13:Ma(m,h),qa(h),h.child.flags&8192&&h.memoizedState!==null!=(S!==null&&S.memoizedState!==null)&&(zu=Zs()),w&4&&(w=h.updateQueue,w!==null&&(h.updateQueue=null,sg(h,w)));break;case 22:w&512&&(Lr||S===null||Mr(S,S.return)),D=h.memoizedState!==null;var ie=S!==null&&S.memoizedState!==null,ye=Es,Le=Lr;if(Es=ye||D,Lr=Le||ie,Ma(m,h),Lr=Le,Es=ye,qa(h),m=h.stateNode,m._current=h,m._visibility&=-3,m._visibility|=m._pendingVisibility&2,w&8192&&(m._visibility=D?m._visibility&-2:m._visibility|1,D&&(m=Es||Lr,S===null||ie||m||lp(h)),js&&(h.memoizedProps===null||h.memoizedProps.mode!=="manual"))){e:if(S=null,js)for(m=h;;){if(m.tag===5||Co&&m.tag===26||Ys&&m.tag===27){if(S===null){ie=S=m;try{z=ie.stateNode,D?vg(z):$b(ie.stateNode,ie.memoizedProps)}catch(Ht){di(ie,ie.return,Ht)}}}else if(m.tag===6){if(S===null){ie=m;try{var ft=ie.stateNode;D?y_(ft):wc(ft,ie.memoizedProps)}catch(Ht){di(ie,ie.return,Ht)}}}else if((m.tag!==22&&m.tag!==23||m.memoizedState===null||m===h)&&m.child!==null){m.child.return=m,m=m.child;continue}if(m===h)break e;for(;m.sibling===null;){if(m.return===null||m.return===h)break e;S===m&&(S=null),m=m.return}S===m&&(S=null),m.sibling.return=m.return,m=m.sibling}}w&4&&(w=h.updateQueue,w!==null&&(S=w.retryQueue,S!==null&&(w.retryQueue=null,sg(h,S))));break;case 19:Ma(m,h),qa(h),w&4&&(w=h.updateQueue,w!==null&&(h.updateQueue=null,sg(h,w)));break;case 21:break;default:Ma(m,h),qa(h)}}function qa(h){var m=h.flags;if(m&2){try{if(js&&(!Ys||h.tag!==27)){e:{for(var S=h.return;S!==null;){if(bb(S)){var w=S;break e}S=S.return}throw Error(i(160))}switch(w.tag){case 27:if(Ys){var D=w.stateNode,z=Ky(h);rp(h,z,D);break}case 5:var ie=w.stateNode;w.flags&32&&(_g(ie),w.flags&=-33);var ye=Ky(h);rp(h,ye,ie);break;case 3:case 4:var Le=w.stateNode.containerInfo,ft=Ky(h);Qy(h,ft,Le);break;default:throw Error(i(161))}}}catch(Ht){di(h,h.return,Ht)}h.flags&=-3}m&4096&&(h.flags&=-4097)}function Sb(h){if(h.subtreeFlags&1024)for(h=h.child;h!==null;){var m=h;Sb(m),m.tag===5&&m.flags&1024&&or(m.stateNode),h=h.sibling}}function Mu(h,m){if(m.subtreeFlags&8772)for(m=m.child;m!==null;)Jy(h,m.alternate,m),m=m.sibling}function lp(h){for(h=h.child;h!==null;){var m=h;switch(m.tag){case 0:case 11:case 14:case 15:mf(4,m,m.return),lp(m);break;case 1:Mr(m,m.return);var S=m.stateNode;typeof S.componentWillUnmount=="function"&&IE(m,m.return,S),lp(m);break;case 26:case 27:case 5:Mr(m,m.return),lp(m);break;case 22:Mr(m,m.return),m.memoizedState===null&&lp(m);break;default:lp(m)}h=h.sibling}}function _f(h,m,S){for(S=S&&(m.subtreeFlags&8772)!==0,m=m.child;m!==null;){var w=m.alternate,D=h,z=m,ie=z.flags;switch(z.tag){case 0:case 11:case 15:_f(D,z,S),rg(4,z);break;case 1:if(_f(D,z,S),w=z,D=w.stateNode,typeof D.componentDidMount=="function")try{D.componentDidMount()}catch(ft){di(w,w.return,ft)}if(w=z,D=w.updateQueue,D!==null){var ye=w.stateNode;try{var Le=D.shared.hiddenCallbacks;if(Le!==null)for(D.shared.hiddenCallbacks=null,D=0;D<Le.length;D++)le(Le[D],ye)}catch(ft){di(w,w.return,ft)}}S&&ie&64&&BE(z),Dd(z,z.return);break;case 26:case 27:case 5:_f(D,z,S),S&&w===null&&ie&4&&ip(z),Dd(z,z.return);break;case 12:_f(D,z,S);break;case 13:_f(D,z,S),S&&ie&4&&gf(D,z);break;case 22:z.memoizedState===null&&_f(D,z,S),Dd(z,z.return);break;default:_f(D,z,S)}m=m.sibling}}function Tb(h,m){var S=null;h!==null&&h.memoizedState!==null&&h.memoizedState.cachePool!==null&&(S=h.memoizedState.cachePool.pool),h=null,m.memoizedState!==null&&m.memoizedState.cachePool!==null&&(h=m.memoizedState.cachePool.pool),h!==S&&(h!=null&&h.refCount++,S!=null&&Jh(S))}function t_(h,m){h=null,m.alternate!==null&&(h=m.alternate.memoizedState.cache),m=m.memoizedState.cache,m!==h&&(m.refCount++,h!=null&&Jh(h))}function yc(h,m,S,w){if(m.subtreeFlags&10256)for(m=m.child;m!==null;)n_(h,m,S,w),m=m.sibling}function n_(h,m,S,w){var D=m.flags;switch(m.tag){case 0:case 11:case 15:yc(h,m,S,w),D&2048&&rg(9,m);break;case 3:yc(h,m,S,w),D&2048&&(h=null,m.alternate!==null&&(h=m.alternate.memoizedState.cache),m=m.memoizedState.cache,m!==h&&(m.refCount++,h!=null&&Jh(h)));break;case 12:if(D&2048){yc(h,m,S,w),h=m.stateNode;try{var z=m.memoizedProps,ie=z.id,ye=z.onPostCommit;typeof ye=="function"&&ye(ie,m.alternate===null?"mount":"update",h.passiveEffectDuration,-0)}catch(Le){di(m,m.return,Le)}}else yc(h,m,S,w);break;case 23:break;case 22:z=m.stateNode,m.memoizedState!==null?z._visibility&4?yc(h,m,S,w):vf(h,m):z._visibility&4?yc(h,m,S,w):(z._visibility|=4,aa(h,m,S,w,(m.subtreeFlags&10256)!==0)),D&2048&&Tb(m.alternate,m);break;case 24:yc(h,m,S,w),D&2048&&t_(m.alternate,m);break;default:yc(h,m,S,w)}}function aa(h,m,S,w,D){for(D=D&&(m.subtreeFlags&10256)!==0,m=m.child;m!==null;){var z=h,ie=m,ye=S,Le=w,ft=ie.flags;switch(ie.tag){case 0:case 11:case 15:aa(z,ie,ye,Le,D),rg(8,ie);break;case 23:break;case 22:var Ht=ie.stateNode;ie.memoizedState!==null?Ht._visibility&4?aa(z,ie,ye,Le,D):vf(z,ie):(Ht._visibility|=4,aa(z,ie,ye,Le,D)),D&&ft&2048&&Tb(ie.alternate,ie);break;case 24:aa(z,ie,ye,Le,D),D&&ft&2048&&t_(ie.alternate,ie);break;default:aa(z,ie,ye,Le,D)}m=m.sibling}}function vf(h,m){if(m.subtreeFlags&10256)for(m=m.child;m!==null;){var S=h,w=m,D=w.flags;switch(w.tag){case 22:vf(S,w),D&2048&&Tb(w.alternate,w);break;case 24:vf(S,w),D&2048&&t_(w.alternate,w);break;default:vf(S,w)}m=m.sibling}}function Os(h){if(h.subtreeFlags&$d)for(h=h.child;h!==null;)Od(h),h=h.sibling}function Od(h){switch(h.tag){case 26:Os(h),h.flags&$d&&(h.memoizedState!==null?uS(Na,h.memoizedState,h.memoizedProps):Gr(h.type,h.memoizedProps));break;case 5:Os(h),h.flags&$d&&Gr(h.type,h.memoizedProps);break;case 3:case 4:if(Co){var m=Na;Na=E_(h.stateNode.containerInfo),Os(h),Na=m}else Os(h);break;case 22:h.memoizedState===null&&(m=h.alternate,m!==null&&m.memoizedState!==null?(m=$d,$d=16777216,Os(h),$d=m):Os(h));break;default:Os(h)}}function i_(h){var m=h.alternate;if(m!==null&&(h=m.child,h!==null)){m.child=null;do m=h.sibling,h.sibling=null,h=m;while(h!==null)}}function xf(h){var m=h.deletions;if((h.flags&16)!==0){if(m!==null)for(var S=0;S<m.length;S++){var w=m[S];Xr=w,bf(w,h)}i_(h)}if(h.subtreeFlags&10256)for(h=h.child;h!==null;)ag(h),h=h.sibling}function ag(h){switch(h.tag){case 0:case 11:case 15:xf(h),h.flags&2048&&mf(9,h,h.return);break;case 3:xf(h);break;case 12:xf(h);break;case 22:var m=h.stateNode;h.memoizedState!==null&&m._visibility&4&&(h.return===null||h.return.tag!==13)?(m._visibility&=-5,up(h)):xf(h);break;default:xf(h)}}function up(h){var m=h.deletions;if((h.flags&16)!==0){if(m!==null)for(var S=0;S<m.length;S++){var w=m[S];Xr=w,bf(w,h)}i_(h)}for(h=h.child;h!==null;){switch(m=h,m.tag){case 0:case 11:case 15:mf(8,m,m.return),up(m);break;case 22:S=m.stateNode,S._visibility&4&&(S._visibility&=-5,up(m));break;default:up(m)}h=h.sibling}}function bf(h,m){for(;Xr!==null;){var S=Xr;switch(S.tag){case 0:case 11:case 15:mf(8,S,m);break;case 23:case 22:if(S.memoizedState!==null&&S.memoizedState.cachePool!==null){var w=S.memoizedState.cachePool.pool;w!=null&&w.refCount++}break;case 24:Jh(S.memoizedState.cache)}if(w=S.child,w!==null)w.return=S,Xr=w;else e:for(S=h;Xr!==null;){w=Xr;var D=w.sibling,z=w.return;if(ap(w),w===S){Xr=null;break e}if(D!==null){D.return=z,Xr=D;break e}Xr=z}}}function r_(h){var m=zb(h);if(m!=null){if(typeof m.memoizedProps["data-testname"]!="string")throw Error(i(364));return m}if(h=Gd(h),h===null)throw Error(i(362));return h.stateNode.current}function cp(h,m){var S=h.tag;switch(m.$$typeof){case Lg:if(h.type===m.value)return!0;break;case P_:e:{for(m=m.value,h=[h,0],S=0;S<h.length;){var w=h[S++],D=w.tag,z=h[S++],ie=m[z];if(D!==5&&D!==26&&D!==27||!Lu(w)){for(;ie!=null&&cp(w,ie);)z++,ie=m[z];if(z===m.length){m=!0;break e}else for(w=w.child;w!==null;)h.push(w,z),w=w.sibling}}m=!1}return m;case B_:if((S===5||S===26||S===27)&&XN(h.stateNode,m.value))return!0;break;case $i:if((S===5||S===6||S===26||S===27)&&(h=yg(h),h!==null&&0<=h.indexOf(m.value)))return!0;break;case Mi:if((S===5||S===26||S===27)&&(h=h.memoizedProps["data-testname"],typeof h=="string"&&h.toLowerCase()===m.value.toLowerCase()))return!0;break;default:throw Error(i(365))}return!1}function Sf(h){switch(h.$$typeof){case Lg:return"<"+(a(h.value)||"Unknown")+">";case P_:return":has("+(Sf(h)||"")+")";case B_:return'[role="'+h.value+'"]';case $i:return'"'+h.value+'"';case Mi:return'[data-testname="'+h.value+'"]';default:throw Error(i(365))}}function zE(h,m){var S=[];h=[h,0];for(var w=0;w<h.length;){var D=h[w++],z=D.tag,ie=h[w++],ye=m[ie];if(z!==5&&z!==26&&z!==27||!Lu(D)){for(;ye!=null&&cp(D,ye);)ie++,ye=m[ie];if(ie===m.length)S.push(D);else for(D=D.child;D!==null;)h.push(D,ie),D=D.sibling}}return S}function Aa(h,m){if(!Uu)throw Error(i(363));h=r_(h),h=zE(h,m),m=[],h=Array.from(h);for(var S=0;S<h.length;){var w=h[S++],D=w.tag;if(D===5||D===26||D===27)Lu(w)||m.push(w.stateNode);else for(w=w.child;w!==null;)h.push(w),w=w.sibling}return m}function wa(){if((On&2)!==0&&oi!==0)return oi&-oi;if(In.T!==null){var h=Ka;return h!==0?h:He()}return dl()}function Au(){eo===0&&(eo=(oi&536870912)===0||Ni?F():536870912);var h=Bo.current;return h!==null&&(h.flags|=32),eo}function oa(h,m,S){(h===ci&&lr===2||h.cancelPendingCommit!==null)&&(Wl(h,0),Hl(h,oi,eo,!1)),q(h,S),((On&2)===0||h!==ci)&&(h===ci&&((On&2)===0&&(Kl|=S),Ai===4&&Hl(h,oi,eo,!1)),Dt(h))}function og(h,m,S){if((On&6)!==0)throw Error(i(327));var w=!S&&(m&60)===0&&(m&h.expiredLanes)===0||U(h,m),D=w?Cu(h,m):wu(h,m,!0),z=w;do{if(D===0){Io&&!w&&Hl(h,m,0,!1);break}else if(D===6)Hl(h,m,0,!ji);else{if(S=h.current.alternate,z&&!VE(S)){D=wu(h,m,!1),z=!1;continue}if(D===2){if(z=m,h.errorRecoveryDisabledLanes&z)var ie=0;else ie=h.pendingLanes&-536870913,ie=ie!==0?ie:ie&536870912?536870912:0;if(ie!==0){m=ie;e:{var ye=h;D=wp;var Le=Ra&&ye.current.memoizedState.isDehydrated;if(Le&&(Wl(ye,ie).flags|=256),ie=wu(ye,ie,!1),ie!==2){if(Uc&&!Le){ye.errorRecoveryDisabledLanes|=z,Kl|=z,D=4;break e}z=zo,zo=D,z!==null&&_c(z)}D=ie}if(z=!1,D!==2)continue}}if(D===1){Wl(h,0),Hl(h,m,0,!0);break}e:{switch(w=h,D){case 0:case 1:throw Error(i(345));case 4:if((m&4194176)===m){Hl(w,m,eo,!ji);break e}break;case 2:zo=null;break;case 3:case 5:break;default:throw Error(i(329))}if(w.finishedWork=S,w.finishedLanes=m,(m&62914560)===m&&(z=zu+300-Zs(),10<z)){if(Hl(w,m,eo,!ji),P(w,0)!==0)break e;w.timeoutHandle=Fb(s_.bind(null,w,S,zo,Ql,Rp,m,eo,Kl,Lc,ji,2,-0,0),z);break e}s_(w,S,zo,Ql,Rp,m,eo,Kl,Lc,ji,0,-0,0)}}break}while(!0);Dt(h)}function _c(h){zo===null?zo=h:zo.push.apply(zo,h)}function s_(h,m,S,w,D,z,ie,ye,Le,ft,Ht,rn,cn){var Kn=m.subtreeFlags;if((Kn&8192||(Kn&16785408)===16785408)&&(Ro(),Od(m),m=p_(),m!==null)){h.cancelPendingCommit=m(yr.bind(null,h,S,w,D,ie,ye,Le,1,rn,cn)),Hl(h,z,ie,!ft);return}yr(h,S,w,D,ie,ye,Le,Ht,rn,cn)}function VE(h){for(var m=h;;){var S=m.tag;if((S===0||S===11||S===15)&&m.flags&16384&&(S=m.updateQueue,S!==null&&(S=S.stores,S!==null)))for(var w=0;w<S.length;w++){var D=S[w],z=D.getSnapshot;D=D.value;try{if(!No(z(),D))return!1}catch{return!1}}if(S=m.child,m.subtreeFlags&16384&&S!==null)S.return=m,m=S;else{if(m===h)break;for(;m.sibling===null;){if(m.return===null||m.return===h)return!0;m=m.return}m.sibling.return=m.return,m=m.sibling}}return!0}function Hl(h,m,S,w){m&=~ha,m&=~Kl,h.suspendedLanes|=m,h.pingedLanes&=~m,w&&(h.warmLanes|=m),w=h.expirationTimes;for(var D=m;0<D;){var z=31-Ya(D),ie=1<<z;w[z]=-1,D&=~ie}S!==0&&Q(h,S,m)}function Eb(){return(On&6)===0?(zt(0),!1):!0}function Xa(){if(Jn!==null){if(lr===0)var h=Jn.return;else h=Jn,qr=If=null,ct(h),Bu=null,ml=0,h=Jn;for(;h!==null;)vb(h.alternate,h),h=h.return;Jn=null}}function Wl(h,m){h.finishedWork=null,h.finishedLanes=0;var S=h.timeoutHandle;S!==Vd&&(h.timeoutHandle=Vd,gg(S)),S=h.cancelPendingCommit,S!==null&&(h.cancelPendingCommit=null,S()),Xa(),ci=h,Jn=S=la(h.current,null),oi=m,lr=0,rs=null,ji=!1,Io=U(h,m),Uc=!1,Lc=eo=ha=Kl=Fo=Ai=0,zo=wp=null,Rp=!1,(m&8)!==0&&(m|=m&32);var w=h.entangledLanes;if(w!==0)for(h=h.entanglements,w&=m;0<w;){var D=31-Ya(w),z=1<<D;m|=h[D],w&=~z}return Zl=m,qe(),S}function Ud(h,m){ii=null,In.H=Di,m===er?(m=Tt(),lr=3):m===hS?(m=Tt(),lr=4):lr=m===vM?8:m!==null&&typeof m=="object"&&typeof m.then=="function"?6:1,rs=m,Jn===null&&(Ai=1,Wy(h,fe(m,h.current)))}function lg(){var h=Bo.current;return h===null?!0:(oi&4194176)===oi?gl===null:(oi&62914560)===oi||(oi&536870912)!==0?h===gl:!1}function fp(){var h=In.H;return In.H=Di,h===null?Di:h}function Ao(){var h=In.A;return In.A=L_,h}function $a(){Ai=4,ji||(oi&4194176)!==oi&&Bo.current!==null||(Io=!0),(Fo&134217727)===0&&(Kl&134217727)===0||ci===null||Hl(ci,oi,eo,!1)}function wu(h,m,S){var w=On;On|=2;var D=fp(),z=Ao();(ci!==h||oi!==m)&&(Ql=null,Wl(h,m)),m=!1;var ie=Ai;e:do try{if(lr!==0&&Jn!==null){var ye=Jn,Le=rs;switch(lr){case 8:Xa(),ie=6;break e;case 3:case 2:case 6:Bo.current===null&&(m=!0);var ft=lr;if(lr=0,rs=null,Tf(h,ye,Le,ft),S&&Io){ie=0;break e}break;default:ft=lr,lr=0,rs=null,Tf(h,ye,Le,ft)}}Ru(),ie=Ai;break}catch(Ht){Ud(h,Ht)}while(!0);return m&&h.shellSuspendCounter++,qr=If=null,On=w,In.H=D,In.A=z,Jn===null&&(ci=null,oi=0,qe()),ie}function Ru(){for(;Jn!==null;)Mb(Jn)}function Cu(h,m){var S=On;On|=2;var w=fp(),D=Ao();ci!==h||oi!==m?(Ql=null,Pr=Zs()+500,Wl(h,m)):Io=U(h,m);e:do try{if(lr!==0&&Jn!==null){m=Jn;var z=rs;t:switch(lr){case 1:lr=0,rs=null,Tf(h,m,z,1);break;case 2:if(Ot(z)){lr=0,rs=null,a_(m);break}m=function(){lr===2&&ci===h&&(lr=7),Dt(h)},z.then(m,m);break e;case 3:lr=7;break e;case 4:lr=5;break e;case 7:Ot(z)?(lr=0,rs=null,a_(m)):(lr=0,rs=null,Tf(h,m,z,7));break;case 5:var ie=null;switch(Jn.tag){case 26:ie=Jn.memoizedState;case 5:case 27:var ye=Jn,Le=ye.type,ft=ye.pendingProps;if(ie?lS(ie):Ac(Le,ft)){lr=0,rs=null;var Ht=ye.sibling;if(Ht!==null)Jn=Ht;else{var rn=ye.return;rn!==null?(Jn=rn,ug(rn)):Jn=null}break t}}lr=0,rs=null,Tf(h,m,z,5);break;case 6:lr=0,rs=null,Tf(h,m,z,6);break;case 8:Xa(),Ai=6;break e;default:throw Error(i(462))}}vc();break}catch(cn){Ud(h,cn)}while(!0);return qr=If=null,In.H=w,In.A=D,On=S,Jn!==null?0:(ci=null,oi=0,qe(),Ai)}function vc(){for(;Jn!==null&&!pM();)Mb(Jn)}function Mb(h){var m=OE(h.alternate,h,Zl);h.memoizedProps=h.pendingProps,m===null?ug(h):Jn=m}function a_(h){var m=h,S=m.alternate;switch(m.tag){case 15:case 0:m=wE(S,m,m.pendingProps,m.type,void 0,oi);break;case 11:m=wE(S,m,m.pendingProps,m.type.render,m.ref,oi);break;case 5:ct(m);default:vb(S,m),m=Jn=Sc(m,Zl),m=OE(S,m,Zl)}h.memoizedProps=h.pendingProps,m===null?ug(h):Jn=m}function Tf(h,m,S,w){qr=If=null,ct(m),Bu=null,ml=0;var D=m.return;try{if(SE(h,D,m,S,oi)){Ai=1,Wy(h,fe(S,h.current)),Jn=null;return}}catch(z){if(D!==null)throw Jn=D,z;Ai=1,Wy(h,fe(S,h.current)),Jn=null;return}m.flags&32768?(Ni||w===1?h=!0:Io||(oi&536870912)!==0?h=!1:(ji=h=!0,(w===2||w===3||w===6)&&(w=Bo.current,w!==null&&w.tag===13&&(w.flags|=16384))),Us(m,h)):ug(m)}function ug(h){var m=h;do{if((m.flags&32768)!==0){Us(m,ji);return}h=m.return;var S=LE(m.alternate,m,Zl);if(S!==null){Jn=S;return}if(m=m.sibling,m!==null){Jn=m;return}Jn=m=h}while(m!==null);Ai===0&&(Ai=5)}function Us(h,m){do{var S=PE(h.alternate,h);if(S!==null){S.flags&=32767,Jn=S;return}if(S=h.return,S!==null&&(S.flags|=32768,S.subtreeFlags=0,S.deletions=null),!m&&(h=h.sibling,h!==null)){Jn=h;return}Jn=h=S}while(h!==null);Ai=6,Jn=null}function yr(h,m,S,w,D,z,ie,ye,Le,ft){var Ht=In.T,rn=Ts();try{ua(2),In.T=null,bi(h,m,S,w,rn,D,z,ie,ye,Le,ft)}finally{In.T=Ht,ua(rn)}}function bi(h,m,S,w,D,z,ie,ye){do Ls();while(Pc!==null);if((On&6)!==0)throw Error(i(327));var Le=h.finishedWork;if(w=h.finishedLanes,Le===null)return null;if(h.finishedWork=null,h.finishedLanes=0,Le===h.current)throw Error(i(177));h.callbackNode=null,h.callbackPriority=0,h.cancelPendingCommit=null;var ft=Le.lanes|Le.childLanes;if(ft|=Sp,j(h,w,ft,z,ie,ye),h===ci&&(Jn=ci=null,oi=0),(Le.subtreeFlags&10256)===0&&(Le.flags&10256)===0||_l||(_l=!0,I_=ft,Yd=S,cg(A_,function(){return Ls(),null})),S=(Le.flags&15990)!==0,(Le.subtreeFlags&15990)!==0||S?(S=In.T,In.T=null,z=Ts(),ua(2),ie=On,On|=4,sp(h,Le),yf(Le,h),Bb(h.containerInfo),h.current=Le,Jy(h,Le.alternate,Le),mM(),On=ie,ua(z),In.T=S):h.current=Le,_l?(_l=!1,Pc=h,jd=w):xc(h,ft),ft=h.pendingLanes,ft===0&&(Vo=null),V(Le.stateNode),Dt(h),m!==null)for(D=h.onRecoverableError,Le=0;Le<m.length;Le++)ft=m[Le],D(ft.value,{componentStack:ft.stack});return(jd&3)!==0&&Ls(),ft=h.pendingLanes,(w&4194218)!==0&&(ft&42)!==0?h===Da?Zd++:(Zd=0,Da=h):Zd=0,zt(0),null}function xc(h,m){(h.pooledCacheLanes&=m)===0&&(m=h.pooledCache,m!=null&&(h.pooledCache=null,Jh(m)))}function Ls(){if(Pc!==null){var h=Pc,m=I_;I_=0;var S=ae(jd),w=32>S?32:S;S=In.T;var D=Ts();try{if(ua(w),In.T=null,Pc===null)var z=!1;else{w=Yd,Yd=null;var ie=Pc,ye=jd;if(Pc=null,jd=0,(On&6)!==0)throw Error(i(331));var Le=On;if(On|=4,ag(ie.current),n_(ie,ie.current,ye,w),On=Le,zt(0,!1),Za&&typeof Za.onPostCommitFiberRoot=="function")try{Za.onPostCommitFiberRoot(xp,ie)}catch{}z=!0}return z}finally{ua(D),In.T=S,xc(h,m)}}return!1}function o_(h,m,S){m=fe(S,m),m=Qm(h.stateNode,m,2),h=nt(h,m,2),h!==null&&(q(h,2),Dt(h))}function di(h,m,S){if(h.tag===3)o_(h,h,S);else for(;m!==null;){if(m.tag===3){o_(m,h,S);break}else if(m.tag===1){var w=m.stateNode;if(typeof m.type.getDerivedStateFromError=="function"||typeof w.componentDidCatch=="function"&&(Vo===null||!Vo.has(w))){h=fe(S,h),S=Qh(2),w=nt(m,S,2),w!==null&&(Jm(S,w,m,h),q(w,2),Dt(w));break}}m=m.return}}function l_(h,m,S){var w=h.pingCache;if(w===null){w=h.pingCache=new hi;var D=new Set;w.set(m,D)}else D=w.get(m),D===void 0&&(D=new Set,w.set(m,D));D.has(S)||(Uc=!0,D.add(S),h=GE.bind(null,h,m,S),m.then(h,h))}function GE(h,m,S){var w=h.pingCache;w!==null&&w.delete(m),h.pingedLanes|=h.suspendedLanes&S,h.warmLanes&=~S,ci===h&&(oi&S)===S&&(Ai===4||Ai===3&&(oi&62914560)===oi&&300>Zs()-zu?(On&2)===0&&Wl(h,0):ha|=S,Lc===oi&&(Lc=0)),Dt(h)}function Ld(h,m){m===0&&(m=O()),h=xe(h,m),h!==null&&(q(h,m),Dt(h))}function Pd(h){var m=h.memoizedState,S=0;m!==null&&(S=m.retryLane),Ld(h,S)}function Ab(h,m){var S=0;switch(h.tag){case 13:var w=h.stateNode,D=h.memoizedState;D!==null&&(S=D.retryLane);break;case 19:w=h.stateNode;break;case 22:w=h.stateNode._retryCache;break;default:throw Error(i(314))}w!==null&&w.delete(m),Ld(h,S)}function cg(h,m){return vp(h,m)}function wb(h,m,S,w){this.tag=h,this.key=S,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=m,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=w,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function bc(h){return h=h.prototype,!(!h||!h.isReactComponent)}function la(h,m){var S=h.alternate;return S===null?(S=t(h.tag,m,h.key,h.mode),S.elementType=h.elementType,S.type=h.type,S.stateNode=h.stateNode,S.alternate=h,h.alternate=S):(S.pendingProps=m,S.type=h.type,S.flags=0,S.subtreeFlags=0,S.deletions=null),S.flags=h.flags&31457280,S.childLanes=h.childLanes,S.lanes=h.lanes,S.child=h.child,S.memoizedProps=h.memoizedProps,S.memoizedState=h.memoizedState,S.updateQueue=h.updateQueue,m=h.dependencies,S.dependencies=m===null?null:{lanes:m.lanes,firstContext:m.firstContext},S.sibling=h.sibling,S.index=h.index,S.ref=h.ref,S.refCleanup=h.refCleanup,S}function Sc(h,m){h.flags&=31457282;var S=h.alternate;return S===null?(h.childLanes=0,h.lanes=m,h.child=null,h.subtreeFlags=0,h.memoizedProps=null,h.memoizedState=null,h.updateQueue=null,h.dependencies=null,h.stateNode=null):(h.childLanes=S.childLanes,h.lanes=S.lanes,h.child=S.child,h.subtreeFlags=0,h.deletions=null,h.memoizedProps=S.memoizedProps,h.memoizedState=S.memoizedState,h.updateQueue=S.updateQueue,h.type=S.type,m=S.dependencies,h.dependencies=m===null?null:{lanes:m.lanes,firstContext:m.firstContext}),h}function fl(h,m,S,w,D,z){var ie=0;if(w=h,typeof h=="function")bc(h)&&(ie=1);else if(typeof h=="string")ie=Co&&Ys?tS(h,S,Bs.current)?26:yp(h)?27:5:Co?tS(h,S,Bs.current)?26:5:Ys&&yp(h)?27:5;else e:switch(h){case hp:return Tc(S.children,D,z,m);case Ob:ie=8,D|=24;break;case Ub:return h=t(12,S,m,D|2),h.elementType=Ub,h.lanes=z,h;case c_:return h=t(13,S,m,D),h.elementType=c_,h.lanes=z,h;case Af:return h=t(19,S,m,D),h.elementType=Af,h.lanes=z,h;case hg:return u_(S,D,z,m);default:if(typeof h=="object"&&h!==null)switch(h.$$typeof){case WE:case Nu:ie=10;break e;case Mf:ie=9;break e;case pp:ie=11;break e;case dg:ie=14;break e;case Xl:ie=16,w=null;break e}ie=29,S=Error(i(130,h===null?"null":typeof h,"")),w=null}return m=t(ie,S,m,D),m.elementType=h,m.type=w,m.lanes=z,m}function Tc(h,m,S,w){return h=t(7,h,w,m),h.lanes=S,h}function u_(h,m,S,w){h=t(22,h,w,m),h.elementType=hg,h.lanes=S;var D={_visibility:1,_pendingVisibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null,_current:null,detach:function(){var z=D._current;if(z===null)throw Error(i(456));if((D._pendingVisibility&2)===0){var ie=xe(z,2);ie!==null&&(D._pendingVisibility|=2,oa(ie,z,2))}},attach:function(){var z=D._current;if(z===null)throw Error(i(456));if((D._pendingVisibility&2)!==0){var ie=xe(z,2);ie!==null&&(D._pendingVisibility&=-3,oa(ie,z,2))}}};return h.stateNode=D,h}function Ef(h,m,S){return h=t(6,h,null,m),h.lanes=S,h}function dp(h,m,S){return m=t(4,h.children!==null?h.children:[],h.key,m),m.lanes=S,m.stateNode={containerInfo:h.containerInfo,pendingChildren:null,implementation:h.implementation},m}function Bd(h,m,S,w,D,z,ie,ye){this.tag=1,this.containerInfo=h,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=Vd,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=B(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.finishedLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=B(0),this.hiddenUpdates=B(null),this.identifierPrefix=w,this.onUncaughtError=D,this.onCaughtError=z,this.onRecoverableError=ie,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=ye,this.incompleteTransitions=new Map}function Ps(h,m,S,w,D,z,ie,ye,Le,ft,Ht,rn){return h=new Bd(h,m,S,ie,ye,Le,ft,rn),m=1,z===!0&&(m|=24),z=t(3,null,null,m),h.current=z,z.stateNode=h,m=jy(),m.refCount++,h.pooledCache=m,m.refCount++,z.memoizedState={element:w,isDehydrated:S,cache:m},Yt(z),h}function fg(h){return h?(h=kd,h):kd}function Rb(h){var m=h._reactInternals;if(m===void 0)throw typeof h.render=="function"?Error(i(188)):(h=Object.keys(h).join(","),Error(i(268,h)));return h=_(m),h=h!==null?v(h):null,h===null?null:mp(h.stateNode)}function kE(h,m,S,w,D,z){D=fg(D),w.context===null?w.context=D:w.pendingContext=D,w=st(m),w.payload={element:S},z=z===void 0?null:z,z!==null&&(w.callback=z),S=nt(h,w,m),S!==null&&(oa(S,h,m),Pt(S,h,m))}function HE(h,m){if(h=h.memoizedState,h!==null&&h.dehydrated!==null){var S=h.retryLane;h.retryLane=S!==0&&S<m?S:m}}function Cb(h,m){HE(h,m),(h=h.alternate)&&HE(h,m)}var Dn={},Nb=Bx(),$s=sre(),Id=Object.assign,Db=Symbol.for("react.element"),Ec=Symbol.for("react.transitional.element"),ql=Symbol.for("react.portal"),hp=Symbol.for("react.fragment"),Ob=Symbol.for("react.strict_mode"),Ub=Symbol.for("react.profiler"),WE=Symbol.for("react.provider"),Mf=Symbol.for("react.consumer"),Nu=Symbol.for("react.context"),pp=Symbol.for("react.forward_ref"),c_=Symbol.for("react.suspense"),Af=Symbol.for("react.suspense_list"),dg=Symbol.for("react.memo"),Xl=Symbol.for("react.lazy"),hg=Symbol.for("react.offscreen"),qE=Symbol.for("react.memo_cache_sentinel"),Lb=Symbol.iterator,Fd=Symbol.for("react.client.reference"),In=Nb.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,f_,Pb,wf=!1,Rf=Array.isArray,d_=e.rendererVersion,pg=e.rendererPackageName,mg=e.extraDevToolsConfig,mp=e.getPublicInstance,zd=e.getRootHostContext,XE=e.getChildHostContext,Cf=e.prepareForCommit,Bb=e.resetAfterCommit,Ib=e.createInstance,Du=e.appendInitialChild,Mc=e.finalizeInitialChildren,Nf=e.shouldSetTextContent,h_=e.createTextInstance,Fb=e.scheduleTimeout,gg=e.cancelTimeout,Vd=e.noTimeout,Ou=e.isPrimaryRenderer;e.warnsIfNotActing;var js=e.supportsMutation,wo=e.supportsPersistence,Ra=e.supportsHydration,zb=e.getInstanceFromNode;e.beforeActiveInstanceBlur,e.afterActiveInstanceBlur;var Vb=e.preparePortalMount;e.prepareScopeUpdate,e.getInstanceFromScope;var ua=e.setCurrentUpdatePriority,Ts=e.getCurrentUpdatePriority,dl=e.resolveUpdatePriority;e.resolveEventType,e.resolveEventTimeStamp;var Df=e.shouldAttemptEagerTransition,Gb=e.detachDeletedInstance;e.requestPostPaintCallback;var $E=e.maySuspendCommit,Ac=e.preloadInstance,Ro=e.startSuspendingCommit,Gr=e.suspendInstance,p_=e.waitForCommitToBeReady,ja=e.NotPendingTransition,qn=e.HostTransitionContext,or=e.resetFormInstance;e.bindToConsole;var gs=e.supportsMicrotasks,m_=e.scheduleMicrotask,Uu=e.supportsTestSelectors,Gd=e.findFiberRoot,g_=e.getBoundingRect,yg=e.getTextContent,Lu=e.isHiddenSubtree,XN=e.matchAccessibilityRole,kr=e.setFocusIfFocusable,kb=e.setupIntersectionObserver,Hb=e.appendChild,jE=e.appendChildToContainer,YE=e.commitTextUpdate,$N=e.commitMount,Wb=e.commitUpdate,qb=e.insertBefore,Xb=e.insertInContainerBefore,Ca=e.removeChild,es=e.removeChildFromContainer,_g=e.resetTextContent,vg=e.hideInstance,y_=e.hideTextInstance,$b=e.unhideInstance,wc=e.unhideTextInstance,__=e.clearContainer,jb=e.cloneInstance,v_=e.createContainerChildSet,Yb=e.appendChildToContainerChildSet,ZE=e.finalizeContainerChildren,Zb=e.replaceContainerChildren,Kb=e.cloneHiddenInstance,Qb=e.cloneHiddenTextInstance,x_=e.isSuspenseInstancePending,xg=e.isSuspenseInstanceFallback,KE=e.getSuspenseInstanceFallbackErrorDetails,jN=e.registerSuspenseInstanceRetry,QE=e.canHydrateFormStateMarker,JE=e.isFormStateMarkerMatching,Jb=e.getNextHydratableSibling,b_=e.getFirstHydratableChild,eM=e.getFirstHydratableChildWithinContainer,tM=e.getFirstHydratableChildWithinSuspenseInstance,nM=e.canHydrateInstance,iM=e.canHydrateTextInstance,rM=e.canHydrateSuspenseInstance,YN=e.hydrateInstance,sM=e.hydrateTextInstance,gp=e.hydrateSuspenseInstance,aM=e.getNextHydratableInstanceAfterSuspenseInstance,S_=e.commitHydratedContainer,T_=e.commitHydratedSuspenseInstance,oM=e.clearSuspenseBoundary,eS=e.clearSuspenseBoundaryFromContainer,lM=e.shouldDeleteUnhydratedTailInstances;e.diffHydratedPropsForDevWarnings,e.diffHydratedTextForDevWarnings,e.describeHydratableInstanceForDevWarnings;var uM=e.validateHydratableInstance,cM=e.validateHydratableTextInstance,Co=e.supportsResources,tS=e.isHostHoistableType,E_=e.getHoistableRoot,M_=e.getResource,nS=e.acquireResource,iS=e.releaseResource,rS=e.hydrateHoistable,sS=e.mountHoistable,aS=e.unmountHoistable,ZN=e.createHoistableInstance,oS=e.prepareToCommitHoistables,fM=e.mayResourceSuspendCommit,lS=e.preloadResource,uS=e.suspendResource,Ys=e.supportsSingletons,cS=e.resolveSingletonInstance,KN=e.clearSingleton,QN=e.acquireSingletonInstance,dM=e.releaseSingletonInstance,yp=e.isHostSingletonType,bg=[],Rc=-1,kd={},Ya=Math.clz32?Math.clz32:R,Sg=Math.log,hM=Math.LN2,_p=128,Tg=4194304,vp=$s.unstable_scheduleCallback,Eg=$s.unstable_cancelCallback,pM=$s.unstable_shouldYield,mM=$s.unstable_requestPaint,Zs=$s.unstable_now,fS=$s.unstable_ImmediatePriority,gM=$s.unstable_UserBlockingPriority,A_=$s.unstable_NormalPriority,w_=$s.unstable_IdlePriority,yM=$s.log,dS=$s.unstable_setDisableYieldValue,xp=null,Za=null,No=typeof Object.is=="function"?Object.is:ee,R_=new WeakMap,Ar=[],Hr=0,Mg=null,Ag=0,Do=[],Oo=0,$l=null,Pu=1,hl="",Bs=E(null),wg=E(null),jl=E(null),bp=E(null),ca=null,Ks=null,Ni=!1,Uo=null,pl=!1,Rg=Error(i(519)),Lo=[],Of=0,Sp=0,Tp=null,Hd=null,Cg=!1,Ng=!1,Yl=!1,Uf=0,Dg=null,C_=0,Ka=0,Lf=null,Cc=!1,Ep=!1,Og=Object.prototype.hasOwnProperty,er=Error(i(460)),hS=Error(i(474)),N_={then:function(){}},Wd=null,Bu=null,ml=0,Pf=Bn(!0),pS=Bn(!1),Iu=E(null),Po=E(0),Bo=E(null),gl=null,ys=E(0),Fu=0,ii=null,Gi=null,ts=null,yl=!1,wr=!1,Nc=!1,Ug=0,Wr=0,Mp=null,_M=0,D_=function(){return{lastEffect:null,events:null,stores:null,memoCache:null}},Di={readContext:Xs,use:bt,useCallback:pn,useContext:pn,useEffect:pn,useImperativeHandle:pn,useLayoutEffect:pn,useInsertionEffect:pn,useMemo:pn,useReducer:pn,useRef:pn,useState:pn,useDebugValue:pn,useDeferredValue:pn,useTransition:pn,useSyncExternalStore:pn,useId:pn};Di.useCacheRefresh=pn,Di.useMemoCache=pn,Di.useHostTransitionStatus=pn,Di.useFormState=pn,Di.useActionState=pn,Di.useOptimistic=pn;var _s={readContext:Xs,use:bt,useCallback:function(h,m){return pt().memoizedState=[h,m===void 0?null:m],h},useContext:Xs,useEffect:Ed,useImperativeHandle:function(h,m,S){S=S!=null?S.concat([h]):null,ps(4194308,4,$m.bind(null,m,h),S)},useLayoutEffect:function(h,m){return ps(4194308,4,h,m)},useInsertionEffect:function(h,m){ps(4,2,h,m)},useMemo:function(h,m){var S=pt();m=m===void 0?null:m;var w=h();if(Nc){X(!0);try{h()}finally{X(!1)}}return S.memoizedState=[w,m],w},useReducer:function(h,m,S){var w=pt();if(S!==void 0){var D=S(m);if(Nc){X(!0);try{S(m)}finally{X(!1)}}}else D=m;return w.memoizedState=w.baseState=D,h={pending:null,lanes:0,dispatch:null,lastRenderedReducer:h,lastRenderedState:D},w.queue=h,h=h.dispatch=uf.bind(null,ii,h),[w.memoizedState,h]},useRef:function(h){var m=pt();return h={current:h},m.memoizedState=h},useState:function(h){h=Gt(h);var m=h.queue,S=ky.bind(null,ii,m);return m.dispatch=S,[h.memoizedState,S]},useDebugValue:jm,useDeferredValue:function(h,m){var S=pt();return lf(S,h,m)},useTransition:function(){var h=Gt(!1);return h=Vy.bind(null,ii,h.queue,!0,!1),pt().memoizedState=h,[!1,h]},useSyncExternalStore:function(h,m,S){var w=ii,D=pt();if(Ni){if(S===void 0)throw Error(i(407));S=S()}else{if(S=m(),ci===null)throw Error(i(349));(oi&60)!==0||Et(w,m,S)}D.memoizedState=S;var z={value:S,getSnapshot:m};return D.queue=z,Ed(It.bind(null,w,z,h),[h]),w.flags|=2048,Vr(9,Rt.bind(null,w,z,S,m),{destroy:void 0},null),S},useId:function(){var h=pt(),m=ci.identifierPrefix;if(Ni){var S=hl,w=Pu;S=(w&~(1<<32-Ya(w)-1)).toString(32)+S,m=":"+m+"R"+S,S=Ug++,0<S&&(m+="H"+S.toString(32)),m+=":"}else S=_M++,m=":"+m+"r"+S.toString(32)+":";return h.memoizedState=m},useCacheRefresh:function(){return pt().memoizedState=Ym.bind(null,ii)}};_s.useMemoCache=$,_s.useHostTransitionStatus=Ad,_s.useFormState=Vi,_s.useActionState=Vi,_s.useOptimistic=function(h){var m=pt();m.memoizedState=m.baseState=h;var S={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return m.queue=S,m=Hy.bind(null,ii,!0,S),S.dispatch=m,[h,m]};var fa={readContext:Xs,use:bt,useCallback:zy,useContext:Xs,useEffect:To,useImperativeHandle:Tu,useInsertionEffect:xE,useLayoutEffect:bE,useMemo:Md,useReducer:Me,useRef:hs,useState:function(){return Me(ce)},useDebugValue:jm,useDeferredValue:function(h,m){var S=gt();return ib(S,Gi.memoizedState,h,m)},useTransition:function(){var h=Me(ce)[0],m=gt().memoizedState;return[typeof h=="boolean"?h:Lt(h),m]},useSyncExternalStore:mt,useId:Eu};fa.useCacheRefresh=Gy,fa.useMemoCache=$,fa.useHostTransitionStatus=Ad,fa.useFormState=Ds,fa.useActionState=Ds,fa.useOptimistic=function(h,m){var S=gt();return un(S,Gi,h,m)};var Bf={readContext:Xs,use:bt,useCallback:zy,useContext:Xs,useEffect:To,useImperativeHandle:Tu,useInsertionEffect:xE,useLayoutEffect:bE,useMemo:Md,useReducer:Se,useRef:hs,useState:function(){return Se(ce)},useDebugValue:jm,useDeferredValue:function(h,m){var S=gt();return Gi===null?lf(S,h,m):ib(S,Gi.memoizedState,h,m)},useTransition:function(){var h=Se(ce)[0],m=gt().memoizedState;return[typeof h=="boolean"?h:Lt(h),m]},useSyncExternalStore:mt,useId:Eu};Bf.useCacheRefresh=Gy,Bf.useMemoCache=$,Bf.useHostTransitionStatus=Ad,Bf.useFormState=qi,Bf.useActionState=qi,Bf.useOptimistic=function(h,m){var S=gt();return Gi!==null?un(S,Gi,h,m):(S.baseState=h,[h,S.queue.dispatch])};var O_={isMounted:function(h){return(h=h._reactInternals)?p(h)===h:!1},enqueueSetState:function(h,m,S){h=h._reactInternals;var w=wa(),D=st(w);D.payload=m,S!=null&&(D.callback=S),m=nt(h,D,w),m!==null&&(oa(m,h,w),Pt(m,h,w))},enqueueReplaceState:function(h,m,S){h=h._reactInternals;var w=wa(),D=st(w);D.tag=1,D.payload=m,S!=null&&(D.callback=S),m=nt(h,D,w),m!==null&&(oa(m,h,w),Pt(m,h,w))},enqueueForceUpdate:function(h,m){h=h._reactInternals;var S=wa(),w=st(S);w.tag=2,m!=null&&(w.callback=m),m=nt(h,w,S),m!==null&&(oa(m,h,S),Pt(m,h,S))}},mS=typeof reportError=="function"?reportError:function(h){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var m=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof h=="object"&&h!==null&&typeof h.message=="string"?String(h.message):String(h),error:h});if(!window.dispatchEvent(m))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",h);return}console.error(h)},vM=Error(i(461)),ns=!1,da={dehydrated:null,treeContext:null,retryLane:0},Qa=E(null),If=null,qr=null,xM=typeof AbortController<"u"?AbortController:function(){var h=[],m=this.signal={aborted:!1,addEventListener:function(S,w){h.push(w)}};this.abort=function(){m.aborted=!0,h.forEach(function(S){return S()})}},Dc=$s.unstable_scheduleCallback,qd=$s.unstable_NormalPriority,Xi={$$typeof:Nu,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0},U_=In.S;In.S=function(h,m){typeof m=="object"&&m!==null&&typeof m.then=="function"&&ze(h,m),U_!==null&&U_(h,m)};var Oc=E(null),Es=!1,Lr=!1,Ff=!1,Ap=typeof WeakSet=="function"?WeakSet:Set,Xr=null,Xd=!1,is=null,Ja=!1,Na=null,$d=8192,L_={getCacheForType:function(h){var m=Xs(Xi),S=m.data.get(h);return S===void 0&&(S=h(),m.data.set(h,S)),S}},Lg=0,P_=1,B_=2,Mi=3,$i=4;if(typeof Symbol=="function"&&Symbol.for){var ri=Symbol.for;Lg=ri("selector.component"),P_=ri("selector.has_pseudo_class"),B_=ri("selector.role"),Mi=ri("selector.test_id"),$i=ri("selector.text")}var hi=typeof WeakMap=="function"?WeakMap:Map,On=0,ci=null,Jn=null,oi=0,lr=0,rs=null,ji=!1,Io=!1,Uc=!1,Zl=0,Ai=0,Fo=0,Kl=0,ha=0,eo=0,Lc=0,wp=null,zo=null,Rp=!1,zu=0,Pr=1/0,Ql=null,Vo=null,_l=!1,Pc=null,jd=0,I_=0,Yd=null,Zd=0,Da=null;return Dn.attemptContinuousHydration=function(h){if(h.tag===13){var m=xe(h,67108864);m!==null&&oa(m,h,67108864),Cb(h,67108864)}},Dn.attemptHydrationAtCurrentPriority=function(h){if(h.tag===13){var m=wa(),S=xe(h,m);S!==null&&oa(S,h,m),Cb(h,m)}},Dn.attemptSynchronousHydration=function(h){switch(h.tag){case 3:if(h=h.stateNode,h.current.memoizedState.isDehydrated){var m=N(h.pendingLanes);if(m!==0){for(h.pendingLanes|=2,h.entangledLanes|=2;m;){var S=1<<31-Ya(m);h.entanglements[1]|=S,m&=~S}Dt(h),(On&6)===0&&(Pr=Zs()+500,zt(0))}}break;case 13:m=xe(h,2),m!==null&&oa(m,h,2),Eb(),Cb(h,2)}},Dn.batchedUpdates=function(h,m){return h(m)},Dn.createComponentSelector=function(h){return{$$typeof:Lg,value:h}},Dn.createContainer=function(h,m,S,w,D,z,ie,ye,Le,ft){return Ps(h,m,!1,null,S,w,z,ie,ye,Le,ft,null)},Dn.createHasPseudoClassSelector=function(h){return{$$typeof:P_,value:h}},Dn.createHydrationContainer=function(h,m,S,w,D,z,ie,ye,Le,ft,Ht,rn,cn){return h=Ps(S,w,!0,h,D,z,ye,Le,ft,Ht,rn,cn),h.context=fg(null),S=h.current,w=wa(),D=st(w),D.callback=m??null,nt(S,D,w),h.current.lanes=w,q(h,w),Dt(h),h},Dn.createPortal=function(h,m,S){var w=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:ql,key:w==null?null:""+w,children:h,containerInfo:m,implementation:S}},Dn.createRoleSelector=function(h){return{$$typeof:B_,value:h}},Dn.createTestNameSelector=function(h){return{$$typeof:Mi,value:h}},Dn.createTextSelector=function(h){return{$$typeof:$i,value:h}},Dn.defaultOnCaughtError=function(h){console.error(h)},Dn.defaultOnRecoverableError=function(h){mS(h)},Dn.defaultOnUncaughtError=function(h){mS(h)},Dn.deferredUpdates=function(h){var m=In.T,S=Ts();try{return ua(32),In.T=null,h()}finally{ua(S),In.T=m}},Dn.discreteUpdates=function(h,m,S,w,D){var z=In.T,ie=Ts();try{return ua(2),In.T=null,h(m,S,w,D)}finally{ua(ie),In.T=z,On===0&&(Pr=Zs()+500)}},Dn.findAllNodes=Aa,Dn.findBoundingRects=function(h,m){if(!Uu)throw Error(i(363));m=Aa(h,m),h=[];for(var S=0;S<m.length;S++)h.push(g_(m[S]));for(m=h.length-1;0<m;m--){S=h[m];for(var w=S.x,D=w+S.width,z=S.y,ie=z+S.height,ye=m-1;0<=ye;ye--)if(m!==ye){var Le=h[ye],ft=Le.x,Ht=ft+Le.width,rn=Le.y,cn=rn+Le.height;if(w>=ft&&z>=rn&&D<=Ht&&ie<=cn){h.splice(m,1);break}else if(w!==ft||S.width!==Le.width||cn<z||rn>ie){if(!(z!==rn||S.height!==Le.height||Ht<w||ft>D)){ft>w&&(Le.width+=ft-w,Le.x=w),Ht<D&&(Le.width=D-ft),h.splice(m,1);break}}else{rn>z&&(Le.height+=rn-z,Le.y=z),cn<ie&&(Le.height=ie-rn),h.splice(m,1);break}}}return h},Dn.findHostInstance=Rb,Dn.findHostInstanceWithNoPortals=function(h){return h=_(h),h=h!==null?b(h):null,h===null?null:mp(h.stateNode)},Dn.findHostInstanceWithWarning=function(h){return Rb(h)},Dn.flushPassiveEffects=Ls,Dn.flushSyncFromReconciler=function(h){var m=On;On|=1;var S=In.T,w=Ts();try{if(ua(2),In.T=null,h)return h()}finally{ua(w),In.T=S,On=m,(On&6)===0&&zt(0)}},Dn.flushSyncWork=Eb,Dn.focusWithin=function(h,m){if(!Uu)throw Error(i(363));for(h=r_(h),m=zE(h,m),m=Array.from(m),h=0;h<m.length;){var S=m[h++],w=S.tag;if(!Lu(S)){if((w===5||w===26||w===27)&&kr(S.stateNode))return!0;for(S=S.child;S!==null;)m.push(S),S=S.sibling}}return!1},Dn.getFindAllNodesFailureDescription=function(h,m){if(!Uu)throw Error(i(363));var S=0,w=[];h=[r_(h),0];for(var D=0;D<h.length;){var z=h[D++],ie=z.tag,ye=h[D++],Le=m[ye];if((ie!==5&&ie!==26&&ie!==27||!Lu(z))&&(cp(z,Le)&&(w.push(Sf(Le)),ye++,ye>S&&(S=ye)),ye<m.length))for(z=z.child;z!==null;)h.push(z,ye),z=z.sibling}if(S<m.length){for(h=[];S<m.length;S++)h.push(Sf(m[S]));return`findAllNodes was able to match part of the selector:
  `+(w.join(" > ")+`

No matching component was found for:
  `)+h.join(" > ")}return null},Dn.getPublicRootInstance=function(h){if(h=h.current,!h.child)return null;switch(h.child.tag){case 27:case 5:return mp(h.child.stateNode);default:return h.child.stateNode}},Dn.injectIntoDevTools=function(){var h={bundleType:0,version:d_,rendererPackageName:pg,currentDispatcherRef:In,findFiberByHostInstance:zb,reconcilerVersion:"19.0.0"};if(mg!==null&&(h.rendererConfig=mg),typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u")h=!1;else{var m=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(m.isDisabled||!m.supportsFiber)h=!0;else{try{xp=m.inject(h),Za=m}catch{}h=!!m.checkDCE}}return h},Dn.isAlreadyRendering=function(){return!1},Dn.observeVisibleRects=function(h,m,S,w){if(!Uu)throw Error(i(363));h=Aa(h,m);var D=kb(h,S,w).disconnect;return{disconnect:function(){D()}}},Dn.shouldError=function(){return null},Dn.shouldSuspend=function(){return!1},Dn.startHostTransition=function(h,m,S,w){if(h.tag!==5)throw Error(i(476));var D=rb(h).queue;Vy(h,D,m,ja,S===null?n:function(){var z=rb(h).next.queue;return cf(h,z,{},wa()),S(w)})},Dn.updateContainer=function(h,m,S,w){var D=m.current,z=wa();return kE(D,z,h,m,S,w),z},Dn.updateContainerSync=function(h,m,S,w){return m.tag===0&&Ls(),kE(m.current,2,h,m,S,w),2},Dn},r.exports.default=r.exports,Object.defineProperty(r.exports,"__esModule",{value:!0})})(w3)),w3.exports}var TV;function ore(){return TV||(TV=1,A3.exports=are()),A3.exports}var lre=ore();const ure=Ey(lre);var N3={exports:{}},D3={};var EV;function cre(){return EV||(EV=1,(function(r){function e(V,X){var ee=V.length;V.push(X);e:for(;0<ee;){var fe=ee-1>>>1,Y=V[fe];if(0<i(Y,X))V[fe]=X,V[ee]=Y,ee=fe;else break e}}function t(V){return V.length===0?null:V[0]}function n(V){if(V.length===0)return null;var X=V[0],ee=V.pop();if(ee!==X){V[0]=ee;e:for(var fe=0,Y=V.length,K=Y>>>1;fe<K;){var he=2*(fe+1)-1,Ce=V[he],Ie=he+1,ut=V[Ie];if(0>i(Ce,ee))Ie<Y&&0>i(ut,Ce)?(V[fe]=ut,V[Ie]=ee,fe=Ie):(V[fe]=Ce,V[he]=ee,fe=he);else if(Ie<Y&&0>i(ut,ee))V[fe]=ut,V[Ie]=ee,fe=Ie;else break e}}return X}function i(V,X){var ee=V.sortIndex-X.sortIndex;return ee!==0?ee:V.id-X.id}if(r.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var s=performance;r.unstable_now=function(){return s.now()}}else{var a=Date,o=a.now();r.unstable_now=function(){return a.now()-o}}var l=[],c=[],d=1,p=null,y=3,_=!1,v=!1,b=!1,E=typeof setTimeout=="function"?setTimeout:null,T=typeof clearTimeout=="function"?clearTimeout:null,M=typeof setImmediate<"u"?setImmediate:null;function R(V){for(var X=t(c);X!==null;){if(X.callback===null)n(c);else if(X.startTime<=V)n(c),X.sortIndex=X.expirationTime,e(l,X);else break;X=t(c)}}function N(V){if(b=!1,R(V),!v)if(t(l)!==null)v=!0,se();else{var X=t(c);X!==null&&ae(N,X.startTime-V)}}var P=!1,U=-1,L=5,F=-1;function O(){return!(r.unstable_now()-F<L)}function B(){if(P){var V=r.unstable_now();F=V;var X=!0;try{e:{v=!1,b&&(b=!1,T(U),U=-1),_=!0;var ee=y;try{t:{for(R(V),p=t(l);p!==null&&!(p.expirationTime>V&&O());){var fe=p.callback;if(typeof fe=="function"){p.callback=null,y=p.priorityLevel;var Y=fe(p.expirationTime<=V);if(V=r.unstable_now(),typeof Y=="function"){p.callback=Y,R(V),X=!0;break t}p===t(l)&&n(l),R(V)}else n(l);p=t(l)}if(p!==null)X=!0;else{var K=t(c);K!==null&&ae(N,K.startTime-V),X=!1}}break e}finally{p=null,y=ee,_=!1}X=void 0}}finally{X?q():P=!1}}}var q;if(typeof M=="function")q=function(){M(B)};else if(typeof MessageChannel<"u"){var j=new MessageChannel,Q=j.port2;j.port1.onmessage=B,q=function(){Q.postMessage(null)}}else q=function(){E(B,0)};function se(){P||(P=!0,q())}function ae(V,X){U=E(function(){V(r.unstable_now())},X)}r.unstable_IdlePriority=5,r.unstable_ImmediatePriority=1,r.unstable_LowPriority=4,r.unstable_NormalPriority=3,r.unstable_Profiling=null,r.unstable_UserBlockingPriority=2,r.unstable_cancelCallback=function(V){V.callback=null},r.unstable_continueExecution=function(){v||_||(v=!0,se())},r.unstable_forceFrameRate=function(V){0>V||125<V?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):L=0<V?Math.floor(1e3/V):5},r.unstable_getCurrentPriorityLevel=function(){return y},r.unstable_getFirstCallbackNode=function(){return t(l)},r.unstable_next=function(V){switch(y){case 1:case 2:case 3:var X=3;break;default:X=y}var ee=y;y=X;try{return V()}finally{y=ee}},r.unstable_pauseExecution=function(){},r.unstable_requestPaint=function(){},r.unstable_runWithPriority=function(V,X){switch(V){case 1:case 2:case 3:case 4:case 5:break;default:V=3}var ee=y;y=V;try{return X()}finally{y=ee}},r.unstable_scheduleCallback=function(V,X,ee){var fe=r.unstable_now();switch(typeof ee=="object"&&ee!==null?(ee=ee.delay,ee=typeof ee=="number"&&0<ee?fe+ee:fe):ee=fe,V){case 1:var Y=-1;break;case 2:Y=250;break;case 5:Y=1073741823;break;case 4:Y=1e4;break;default:Y=5e3}return Y=ee+Y,V={id:d++,callback:X,priorityLevel:V,startTime:ee,expirationTime:Y,sortIndex:-1},ee>fe?(V.sortIndex=ee,e(c,V),t(l)===null&&V===t(c)&&(b?(T(U),U=-1):b=!0,ae(N,ee-fe))):(V.sortIndex=Y,e(l,V),v||_||(v=!0,se())),V},r.unstable_shouldYield=O,r.unstable_wrapCallback=function(V){var X=y;return function(){var ee=y;y=X;try{return V.apply(this,arguments)}finally{y=ee}}}})(D3)),D3}var MV;function fre(){return MV||(MV=1,N3.exports=cre()),N3.exports}var AV=fre();function YL(r,e,t){if(!r)return;if(t(r)===!0)return r;let n=e?r.return:r.child;for(;n;){const i=YL(n,e,t);if(i)return i;n=e?null:n.sibling}}function G6(r){try{return Object.defineProperties(r,{_currentRenderer:{get(){return null},set(){}},_currentRenderer2:{get(){return null},set(){}}})}catch{return r}}const ZL=G6(H.createContext(null));let k6=class extends H.Component{render(){return H.createElement(ZL.Provider,{value:this._reactInternals},this.props.children)}};function H6(){const r=H.useContext(ZL);if(r===null)throw new Error("its-fine: useFiber must be called within a <FiberProvider />!");const e=H.useId();return H.useMemo(()=>{for(const t of[r,r?.alternate]){if(!t)continue;const n=YL(t,!1,i=>{let s=i.memoizedState;for(;s;){if(s.memoizedState===e)return!0;s=s.next}});if(n)return n}},[r,e])}const dre=Symbol.for("react.context"),hre=r=>r!==null&&typeof r=="object"&&"$$typeof"in r&&r.$$typeof===dre;function pre(){const r=H6(),[e]=H.useState(()=>new Map);e.clear();let t=r;for(;t;){const n=t.type;hre(n)&&n!==ZL&&!e.has(n)&&e.set(n,H.use(G6(n))),t=t.return}return e}function mre(){const r=pre();return H.useMemo(()=>Array.from(r.keys()).reduce((e,t)=>n=>H.createElement(e,null,H.createElement(t.Provider,{...n,value:r.get(t)})),e=>H.createElement(k6,{...e})),[r])}function W6(r){let e=r.root;for(;e.getState().previousRoot;)e=e.getState().previousRoot;return e}const q6=r=>r&&r.isOrthographicCamera,gre=r=>r&&r.hasOwnProperty("current"),yre=r=>r!=null&&(typeof r=="string"||typeof r=="number"||r.isColor),Q1=((r,e)=>typeof window<"u"&&(((r=window.document)==null?void 0:r.createElement)||((e=window.navigator)==null?void 0:e.product)==="ReactNative"))()?H.useLayoutEffect:H.useEffect;function KL(r){const e=H.useRef(r);return Q1(()=>{e.current=r},[r]),e}function _re(){const r=H6(),e=mre();return H.useMemo(()=>({children:t})=>{const i=!!YL(r,!0,s=>s.type===H.StrictMode)?H.StrictMode:H.Fragment;return Wt.jsx(i,{children:Wt.jsx(e,{children:t})})},[r,e])}function vre({set:r}){return Q1(()=>(r(new Promise(()=>null)),()=>r(!1)),[r]),null}const xre=(r=>(r=class extends H.Component{constructor(...t){super(...t),this.state={error:!1}}componentDidCatch(t){this.props.set(t)}render(){return this.state.error?null:this.props.children}},r.getDerivedStateFromError=()=>({error:!0}),r))();function X6(r){var e;const t=typeof window<"u"?(e=window.devicePixelRatio)!=null?e:2:1;return Array.isArray(r)?Math.min(Math.max(r[0],t),r[1]):r}function fv(r){var e;return(e=r.__r3f)==null?void 0:e.root.getState()}const $r={obj:r=>r===Object(r)&&!$r.arr(r)&&typeof r!="function",fun:r=>typeof r=="function",str:r=>typeof r=="string",num:r=>typeof r=="number",boo:r=>typeof r=="boolean",und:r=>r===void 0,nul:r=>r===null,arr:r=>Array.isArray(r),equ(r,e,{arrays:t="shallow",objects:n="reference",strict:i=!0}={}){if(typeof r!=typeof e||!!r!=!!e)return!1;if($r.str(r)||$r.num(r)||$r.boo(r))return r===e;const s=$r.obj(r);if(s&&n==="reference")return r===e;const a=$r.arr(r);if(a&&t==="reference")return r===e;if((a||s)&&r===e)return!0;let o;for(o in r)if(!(o in e))return!1;if(s&&t==="shallow"&&n==="shallow"){for(o in i?e:r)if(!$r.equ(r[o],e[o],{strict:i,objects:"reference"}))return!1}else for(o in i?e:r)if(r[o]!==e[o])return!1;if($r.und(o)){if(a&&r.length===0&&e.length===0||s&&Object.keys(r).length===0&&Object.keys(e).length===0)return!0;if(r!==e)return!1}return!0}};function bre(r){const e={nodes:{},materials:{},meshes:{}};return r&&r.traverse(t=>{t.name&&(e.nodes[t.name]=t),t.material&&!e.materials[t.material.name]&&(e.materials[t.material.name]=t.material),t.isMesh&&!e.meshes[t.name]&&(e.meshes[t.name]=t)}),e}function Sre(r){r.type!=="Scene"&&(r.dispose==null||r.dispose());for(const e in r){const t=r[e];t?.type!=="Scene"&&(t==null||t.dispose==null||t.dispose())}}const $6=["children","key","ref"];function Tre(r){const e={};for(const t in r)$6.includes(t)||(e[t]=r[t]);return e}function rR(r,e,t,n){const i=r;let s=i?.__r3f;return s||(s={root:e,type:t,parent:null,children:[],props:Tre(n),object:i,eventCount:0,handlers:{},isHidden:!1},i&&(i.__r3f=s)),s}function f1(r,e){if(!e.includes("-"))return{root:r,key:e,target:r[e]};if(e in r)return{root:r,key:e,target:r[e]};let t=r;const n=e.split("-");for(const i of n){if(typeof t!="object"||t===null){if(t!==void 0){const s=n.slice(n.indexOf(i)).join("-");return{root:t,key:s,target:void 0}}return{root:r,key:e,target:void 0}}e=i,r=t,t=t[e]}return{root:r,key:e,target:t}}const wV=/-\d+$/;function sR(r,e){if($r.str(e.props.attach)){if(wV.test(e.props.attach)){const i=e.props.attach.replace(wV,""),{root:s,key:a}=f1(r.object,i);Array.isArray(s[a])||(s[a]=[])}const{root:t,key:n}=f1(r.object,e.props.attach);e.previousAttach=t[n],t[n]=e.object}else $r.fun(e.props.attach)&&(e.previousAttach=e.props.attach(r.object,e.object))}function aR(r,e){if($r.str(e.props.attach)){const{root:t,key:n}=f1(r.object,e.props.attach),i=e.previousAttach;i===void 0?delete t[n]:t[n]=i}else e.previousAttach==null||e.previousAttach(r.object,e.object);delete e.previousAttach}const xO=[...$6,"args","dispose","attach","object","onUpdate","dispose"],RV=new Map;function Ere(r){let e=RV.get(r.constructor);try{e||(e=new r.constructor,RV.set(r.constructor,e))}catch{}return e}function Mre(r,e){const t={};for(const n in e)if(!xO.includes(n)&&!$r.equ(e[n],r.props[n])){t[n]=e[n];for(const i in e)i.startsWith(`${n}-`)&&(t[i]=e[i])}for(const n in r.props){if(xO.includes(n)||e.hasOwnProperty(n))continue;const{root:i,key:s}=f1(r.object,n);if(i.constructor&&i.constructor.length===0){const a=Ere(i);$r.und(a)||(t[s]=a[s])}else t[s]=0}return t}const Are=["map","emissiveMap","sheenColorMap","specularColorMap","envMap"],wre=/^on(Pointer|Click|DoubleClick|ContextMenu|Wheel)/;function Jf(r,e){var t;const n=r.__r3f,i=n&&W6(n).getState(),s=n?.eventCount;for(const o in e){let l=e[o];if(xO.includes(o))continue;if(n&&wre.test(o)){typeof l=="function"?n.handlers[o]=l:delete n.handlers[o],n.eventCount=Object.keys(n.handlers).length;continue}if(l===void 0)continue;let{root:c,key:d,target:p}=f1(r,o);if(p===void 0&&(typeof c!="object"||c===null))throw Error(`R3F: Cannot set "${o}". Ensure it is an object before setting "${d}".`);if(p instanceof yx&&l instanceof yx)p.mask=l.mask;else if(p instanceof Kt&&yre(l))p.set(l);else if(p!==null&&typeof p=="object"&&typeof p.set=="function"&&typeof p.copy=="function"&&l!=null&&l.constructor&&p.constructor===l.constructor)p.copy(l);else if(p!==null&&typeof p=="object"&&typeof p.set=="function"&&Array.isArray(l))typeof p.fromArray=="function"?p.fromArray(l):p.set(...l);else if(p!==null&&typeof p=="object"&&typeof p.set=="function"&&typeof l=="number")typeof p.setScalar=="function"?p.setScalar(l):p.set(l);else{var a;c[d]=l,i&&!i.linear&&Are.includes(d)&&(a=c[d])!=null&&a.isTexture&&c[d].format===Qi&&c[d].type===ir&&(c[d].colorSpace=ea)}}if(n!=null&&n.parent&&i!=null&&i.internal&&(t=n.object)!=null&&t.isObject3D&&s!==n.eventCount){const o=n.object,l=i.internal.interaction.indexOf(o);l>-1&&i.internal.interaction.splice(l,1),n.eventCount&&o.raycast!==null&&i.internal.interaction.push(o)}return n&&n.props.attach===void 0&&(n.object.isBufferGeometry?n.props.attach="geometry":n.object.isMaterial&&(n.props.attach="material")),n&&qx(n),r}function qx(r){var e;if(!r.parent)return;r.props.onUpdate==null||r.props.onUpdate(r.object);const t=(e=r.root)==null||e.getState==null?void 0:e.getState();t&&t.internal.frames===0&&t.invalidate()}function j6(r,e){r.manual||(q6(r)?(r.left=e.width/-2,r.right=e.width/2,r.top=e.height/2,r.bottom=e.height/-2):r.aspect=e.width/e.height,r.updateProjectionMatrix())}const Ko=r=>r?.isObject3D;function CA(r){return(r.eventObject||r.object).uuid+"/"+r.index+r.instanceId}function Y6(r,e,t,n){const i=t.get(e);i&&(t.delete(e),t.size===0&&(r.delete(n),i.target.releasePointerCapture(n)))}function Rre(r,e){const{internal:t}=r.getState();t.interaction=t.interaction.filter(n=>n!==e),t.initialHits=t.initialHits.filter(n=>n!==e),t.hovered.forEach((n,i)=>{(n.eventObject===e||n.object===e)&&t.hovered.delete(i)}),t.capturedMap.forEach((n,i)=>{Y6(t.capturedMap,e,n,i)})}function Cre(r){function e(l){const{internal:c}=r.getState(),d=l.offsetX-c.initialClick[0],p=l.offsetY-c.initialClick[1];return Math.round(Math.sqrt(d*d+p*p))}function t(l){return l.filter(c=>["Move","Over","Enter","Out","Leave"].some(d=>{var p;return(p=c.__r3f)==null?void 0:p.handlers["onPointer"+d]}))}function n(l,c){const d=r.getState(),p=new Set,y=[],_=c?c(d.internal.interaction):d.internal.interaction;for(let T=0;T<_.length;T++){const M=fv(_[T]);M&&(M.raycaster.camera=void 0)}d.previousRoot||d.events.compute==null||d.events.compute(l,d);function v(T){const M=fv(T);if(!M||!M.events.enabled||M.raycaster.camera===null)return[];if(M.raycaster.camera===void 0){var R;M.events.compute==null||M.events.compute(l,M,(R=M.previousRoot)==null?void 0:R.getState()),M.raycaster.camera===void 0&&(M.raycaster.camera=null)}return M.raycaster.camera?M.raycaster.intersectObject(T,!0):[]}let b=_.flatMap(v).sort((T,M)=>{const R=fv(T.object),N=fv(M.object);return!R||!N?T.distance-M.distance:N.events.priority-R.events.priority||T.distance-M.distance}).filter(T=>{const M=CA(T);return p.has(M)?!1:(p.add(M),!0)});d.events.filter&&(b=d.events.filter(b,d));for(const T of b){let M=T.object;for(;M;){var E;(E=M.__r3f)!=null&&E.eventCount&&y.push({...T,eventObject:M}),M=M.parent}}if("pointerId"in l&&d.internal.capturedMap.has(l.pointerId))for(let T of d.internal.capturedMap.get(l.pointerId).values())p.has(CA(T.intersection))||y.push(T.intersection);return y}function i(l,c,d,p){if(l.length){const y={stopped:!1};for(const _ of l){let v=fv(_.object);if(v||_.object.traverseAncestors(b=>{const E=fv(b);if(E)return v=E,!1}),v){const{raycaster:b,pointer:E,camera:T,internal:M}=v,R=new ne(E.x,E.y,0).unproject(T),N=O=>{var B,q;return(B=(q=M.capturedMap.get(O))==null?void 0:q.has(_.eventObject))!=null?B:!1},P=O=>{const B={intersection:_,target:c.target};M.capturedMap.has(O)?M.capturedMap.get(O).set(_.eventObject,B):M.capturedMap.set(O,new Map([[_.eventObject,B]])),c.target.setPointerCapture(O)},U=O=>{const B=M.capturedMap.get(O);B&&Y6(M.capturedMap,_.eventObject,B,O)};let L={};for(let O in c){let B=c[O];typeof B!="function"&&(L[O]=B)}let F={..._,...L,pointer:E,intersections:l,stopped:y.stopped,delta:d,unprojectedPoint:R,ray:b.ray,camera:T,stopPropagation(){const O="pointerId"in c&&M.capturedMap.get(c.pointerId);if((!O||O.has(_.eventObject))&&(F.stopped=y.stopped=!0,M.hovered.size&&Array.from(M.hovered.values()).find(B=>B.eventObject===_.eventObject))){const B=l.slice(0,l.indexOf(_));s([...B,_])}},target:{hasPointerCapture:N,setPointerCapture:P,releasePointerCapture:U},currentTarget:{hasPointerCapture:N,setPointerCapture:P,releasePointerCapture:U},nativeEvent:c};if(p(F),y.stopped===!0)break}}}return l}function s(l){const{internal:c}=r.getState();for(const d of c.hovered.values())if(!l.length||!l.find(p=>p.object===d.object&&p.index===d.index&&p.instanceId===d.instanceId)){const y=d.eventObject.__r3f;if(c.hovered.delete(CA(d)),y!=null&&y.eventCount){const _=y.handlers,v={...d,intersections:l};_.onPointerOut==null||_.onPointerOut(v),_.onPointerLeave==null||_.onPointerLeave(v)}}}function a(l,c){for(let d=0;d<c.length;d++){const p=c[d].__r3f;p==null||p.handlers.onPointerMissed==null||p.handlers.onPointerMissed(l)}}function o(l){switch(l){case"onPointerLeave":case"onPointerCancel":return()=>s([]);case"onLostPointerCapture":return c=>{const{internal:d}=r.getState();"pointerId"in c&&d.capturedMap.has(c.pointerId)&&requestAnimationFrame(()=>{d.capturedMap.has(c.pointerId)&&(d.capturedMap.delete(c.pointerId),s([]))})}}return function(d){const{onPointerMissed:p,internal:y}=r.getState();y.lastEvent.current=d;const _=l==="onPointerMove",v=l==="onClick"||l==="onContextMenu"||l==="onDoubleClick",E=n(d,_?t:void 0),T=v?e(d):0;l==="onPointerDown"&&(y.initialClick=[d.offsetX,d.offsetY],y.initialHits=E.map(R=>R.eventObject)),v&&!E.length&&T<=2&&(a(d,y.interaction),p&&p(d)),_&&s(E);function M(R){const N=R.eventObject,P=N.__r3f;if(!(P!=null&&P.eventCount))return;const U=P.handlers;if(_){if(U.onPointerOver||U.onPointerEnter||U.onPointerOut||U.onPointerLeave){const L=CA(R),F=y.hovered.get(L);F?F.stopped&&R.stopPropagation():(y.hovered.set(L,R),U.onPointerOver==null||U.onPointerOver(R),U.onPointerEnter==null||U.onPointerEnter(R))}U.onPointerMove==null||U.onPointerMove(R)}else{const L=U[l];L?(!v||y.initialHits.includes(N))&&(a(d,y.interaction.filter(F=>!y.initialHits.includes(F))),L(R)):v&&y.initialHits.includes(N)&&a(d,y.interaction.filter(F=>!y.initialHits.includes(F)))}}i(E,d,T,M)}}return{handlePointer:o}}const CV=r=>!!(r!=null&&r.render),QL=H.createContext(null),Nre=(r,e)=>{const t=F6((o,l)=>{const c=new ne,d=new ne,p=new ne;function y(T=l().camera,M=d,R=l().size){const{width:N,height:P,top:U,left:L}=R,F=N/P;M.isVector3?p.copy(M):p.set(...M);const O=T.getWorldPosition(c).distanceTo(p);if(q6(T))return{width:N/T.zoom,height:P/T.zoom,top:U,left:L,factor:1,distance:O,aspect:F};{const B=T.fov*Math.PI/180,q=2*Math.tan(B/2)*O,j=q*(N/P);return{width:j,height:q,top:U,left:L,factor:N/j,distance:O,aspect:F}}}let _;const v=T=>o(M=>({performance:{...M.performance,current:T}})),b=new tt;return{set:o,get:l,gl:null,camera:null,raycaster:null,events:{priority:1,enabled:!0,connected:!1},scene:null,xr:null,invalidate:(T=1)=>r(l(),T),advance:(T,M)=>e(T,M,l()),legacy:!1,linear:!1,flat:!1,controls:null,clock:new WL,pointer:b,mouse:b,frameloop:"always",onPointerMissed:void 0,performance:{current:1,min:.5,max:1,debounce:200,regress:()=>{const T=l();_&&clearTimeout(_),T.performance.current!==T.performance.min&&v(T.performance.min),_=setTimeout(()=>v(l().performance.max),T.performance.debounce)}},size:{width:0,height:0,top:0,left:0},viewport:{initialDpr:0,dpr:0,width:0,height:0,top:0,left:0,aspect:0,distance:0,factor:0,getCurrentViewport:y},setEvents:T=>o(M=>({...M,events:{...M.events,...T}})),setSize:(T,M,R=0,N=0)=>{const P=l().camera,U={width:T,height:M,top:R,left:N};o(L=>({size:U,viewport:{...L.viewport,...y(P,d,U)}}))},setDpr:T=>o(M=>{const R=X6(T);return{viewport:{...M.viewport,dpr:R,initialDpr:M.viewport.initialDpr||R}}}),setFrameloop:(T="always")=>{const M=l().clock;M.stop(),M.elapsedTime=0,T!=="never"&&(M.start(),M.elapsedTime=0),o(()=>({frameloop:T}))},previousRoot:void 0,internal:{interaction:[],hovered:new Map,subscribers:[],initialClick:[0,0],initialHits:[],capturedMap:new Map,lastEvent:H.createRef(),active:!1,frames:0,priority:0,subscribe:(T,M,R)=>{const N=l().internal;return N.priority=N.priority+(M>0?1:0),N.subscribers.push({ref:T,priority:M,store:R}),N.subscribers=N.subscribers.sort((P,U)=>P.priority-U.priority),()=>{const P=l().internal;P!=null&&P.subscribers&&(P.priority=P.priority-(M>0?1:0),P.subscribers=P.subscribers.filter(U=>U.ref!==T))}}}}}),n=t.getState();let i=n.size,s=n.viewport.dpr,a=n.camera;return t.subscribe(()=>{const{camera:o,size:l,viewport:c,gl:d,set:p}=t.getState();if(l.width!==i.width||l.height!==i.height||c.dpr!==s){i=l,s=c.dpr,j6(o,l),c.dpr>0&&d.setPixelRatio(c.dpr);const y=typeof HTMLCanvasElement<"u"&&d.domElement instanceof HTMLCanvasElement;d.setSize(l.width,l.height,y)}o!==a&&(a=o,p(y=>({viewport:{...y.viewport,...y.viewport.getCurrentViewport(o)}})))}),t.subscribe(o=>r(o)),t};function JL(){const r=H.useContext(QL);if(!r)throw new Error("R3F: Hooks can only be used within the Canvas component!");return r}function ru(r=t=>t,e){return JL()(r,e)}function eP(r,e=0){const t=JL(),n=t.getState().internal.subscribe,i=KL(r);return Q1(()=>n(i,e,t),[e,n,t]),null}const NV=new WeakMap,Dre=r=>{var e;return typeof r=="function"&&(r==null||(e=r.prototype)==null?void 0:e.constructor)===r};function Z6(r,e){return function(t,...n){let i;return Dre(t)?(i=NV.get(t),i||(i=new t,NV.set(t,i))):i=t,r&&r(i),Promise.all(n.map(s=>new Promise((a,o)=>i.load(s,l=>{Ko(l?.scene)&&Object.assign(l,bre(l.scene)),a(l)},e,l=>o(new Error(`Could not load ${s}: ${l?.message}`))))))}}function xx(r,e,t,n){const i=Array.isArray(e)?e:[e],s=tre(Z6(t,n),[r,...i],{equal:$r.equ});return Array.isArray(e)?s:s[0]}xx.preload=function(r,e,t){const n=Array.isArray(e)?e:[e];return nre(Z6(t),[r,...n])};xx.clear=function(r,e){const t=Array.isArray(e)?e:[e];return ire([r,...t])};var Ore={version:"9.4.2"};function Ure(r){const e=ure(r);return e.injectIntoDevTools(),e}const K6=0,bx={},Lre=/^three(?=[A-Z])/,YC=r=>`${r[0].toUpperCase()}${r.slice(1)}`;let Pre=0;const Bre=r=>typeof r=="function";function tP(r){if(Bre(r)){const e=`${Pre++}`;return bx[e]=r,e}else Object.assign(bx,r)}function Q6(r,e){const t=YC(r),n=bx[t];if(r!=="primitive"&&!n)throw new Error(`R3F: ${t} is not part of the THREE namespace! Did you forget to extend? See: https://docs.pmnd.rs/react-three-fiber/api/objects#using-3rd-party-objects-declaratively`);if(r==="primitive"&&!e.object)throw new Error("R3F: Primitives without 'object' are invalid!");if(e.args!==void 0&&!Array.isArray(e.args))throw new Error("R3F: The args prop must be an array!")}function Ire(r,e,t){var n;return r=YC(r)in bx?r:r.replace(Lre,""),Q6(r,e),r==="primitive"&&(n=e.object)!=null&&n.__r3f&&delete e.object.__r3f,rR(e.object,t,r,e)}function Fre(r){if(!r.isHidden){var e;r.props.attach&&(e=r.parent)!=null&&e.object?aR(r.parent,r):Ko(r.object)&&(r.object.visible=!1),r.isHidden=!0,qx(r)}}function J6(r){if(r.isHidden){var e;r.props.attach&&(e=r.parent)!=null&&e.object?sR(r.parent,r):Ko(r.object)&&r.props.visible!==!1&&(r.object.visible=!0),r.isHidden=!1,qx(r)}}function nP(r,e,t){const n=e.root.getState();if(!(!r.parent&&r.object!==n.scene)){if(!e.object){var i,s;const a=bx[YC(e.type)];e.object=(i=e.props.object)!=null?i:new a(...(s=e.props.args)!=null?s:[]),e.object.__r3f=e}if(Jf(e.object,e.props),e.props.attach)sR(r,e);else if(Ko(e.object)&&Ko(r.object)){const a=r.object.children.indexOf(t?.object);if(t&&a!==-1){const o=r.object.children.indexOf(e.object);if(o!==-1){r.object.children.splice(o,1);const l=o<a?a-1:a;r.object.children.splice(l,0,e.object)}else e.object.parent=r.object,r.object.children.splice(a,0,e.object),e.object.dispatchEvent({type:"added"}),r.object.dispatchEvent({type:"childadded",child:e.object})}else r.object.add(e.object)}for(const a of e.children)nP(e,a);qx(e)}}function O3(r,e){e&&(e.parent=r,r.children.push(e),nP(r,e))}function DV(r,e,t){if(!e||!t)return;e.parent=r;const n=r.children.indexOf(t);n!==-1?r.children.splice(n,0,e):r.children.push(e),nP(r,e,t)}function e8(r){if(typeof r.dispose=="function"){const e=()=>{try{r.dispose()}catch{}};typeof IS_REACT_ACT_ENVIRONMENT<"u"?e():AV.unstable_scheduleCallback(AV.unstable_IdlePriority,e)}}function bO(r,e,t){if(!e)return;e.parent=null;const n=r.children.indexOf(e);n!==-1&&r.children.splice(n,1),e.props.attach?aR(r,e):Ko(e.object)&&Ko(r.object)&&(r.object.remove(e.object),Rre(W6(e),e.object));const i=e.props.dispose!==null&&t!==!1;for(let s=e.children.length-1;s>=0;s--){const a=e.children[s];bO(e,a,i)}e.children.length=0,delete e.object.__r3f,i&&e.type!=="primitive"&&e.object.type!=="Scene"&&e8(e.object),t===void 0&&qx(e)}function zre(r,e){for(const t of[r,r.alternate])if(t!==null)if(typeof t.ref=="function"){t.refCleanup==null||t.refCleanup();const n=t.ref(e);typeof n=="function"&&(t.refCleanup=n)}else t.ref&&(t.ref.current=e)}const ww=[];function Vre(){for(const[t]of ww){const n=t.parent;if(n){t.props.attach?aR(n,t):Ko(t.object)&&Ko(n.object)&&n.object.remove(t.object);for(const i of t.children)i.props.attach?aR(t,i):Ko(i.object)&&Ko(t.object)&&t.object.remove(i.object)}t.isHidden&&J6(t),t.object.__r3f&&delete t.object.__r3f,t.type!=="primitive"&&e8(t.object)}for(const[t,n,i]of ww){t.props=n;const s=t.parent;if(s){var r,e;const a=bx[YC(t.type)];t.object=(r=t.props.object)!=null?r:new a(...(e=t.props.args)!=null?e:[]),t.object.__r3f=t,zre(i,t.object),Jf(t.object,t.props),t.props.attach?sR(s,t):Ko(t.object)&&Ko(s.object)&&s.object.add(t.object);for(const o of t.children)o.props.attach?sR(t,o):Ko(o.object)&&Ko(t.object)&&t.object.add(o.object);qx(t)}}ww.length=0}const U3=()=>{},OV={};let NA=K6;const Gre=0,kre=4,oR=Ure({isPrimaryRenderer:!1,warnsIfNotActing:!1,supportsMutation:!0,supportsPersistence:!1,supportsHydration:!1,createInstance:Ire,removeChild:bO,appendChild:O3,appendInitialChild:O3,insertBefore:DV,appendChildToContainer(r,e){const t=r.getState().scene.__r3f;!e||!t||O3(t,e)},removeChildFromContainer(r,e){const t=r.getState().scene.__r3f;!e||!t||bO(t,e)},insertInContainerBefore(r,e,t){const n=r.getState().scene.__r3f;!e||!t||!n||DV(n,e,t)},getRootHostContext:()=>OV,getChildHostContext:()=>OV,commitUpdate(r,e,t,n,i){var s,a,o;Q6(e,n);let l=!1;if((r.type==="primitive"&&t.object!==n.object||((s=n.args)==null?void 0:s.length)!==((a=t.args)==null?void 0:a.length)||(o=n.args)!=null&&o.some((d,p)=>{var y;return d!==((y=t.args)==null?void 0:y[p])}))&&(l=!0),l)ww.push([r,{...n},i]);else{const d=Mre(r,n);Object.keys(d).length&&(Object.assign(r.props,d),Jf(r.object,d))}(i.sibling===null||(i.flags&kre)===Gre)&&Vre()},finalizeInitialChildren:()=>!1,commitMount(){},getPublicInstance:r=>r?.object,prepareForCommit:()=>null,preparePortalMount:r=>rR(r.getState().scene,r,"",{}),resetAfterCommit:()=>{},shouldSetTextContent:()=>!1,clearContainer:()=>!1,hideInstance:Fre,unhideInstance:J6,createTextInstance:U3,hideTextInstance:U3,unhideTextInstance:U3,scheduleTimeout:typeof setTimeout=="function"?setTimeout:void 0,cancelTimeout:typeof clearTimeout=="function"?clearTimeout:void 0,noTimeout:-1,getInstanceFromNode:()=>null,beforeActiveInstanceBlur(){},afterActiveInstanceBlur(){},detachDeletedInstance(){},prepareScopeUpdate(){},getInstanceFromScope:()=>null,shouldAttemptEagerTransition:()=>!1,trackSchedulerEvent:()=>{},resolveEventType:()=>null,resolveEventTimeStamp:()=>-1.1,requestPostPaintCallback(){},maySuspendCommit:()=>!1,preloadInstance:()=>!0,startSuspendingCommit(){},suspendInstance(){},waitForCommitToBeReady:()=>null,NotPendingTransition:null,HostTransitionContext:H.createContext(null),setCurrentUpdatePriority(r){NA=r},getCurrentUpdatePriority(){return NA},resolveUpdatePriority(){var r;if(NA!==K6)return NA;switch(typeof window<"u"&&((r=window.event)==null?void 0:r.type)){case"click":case"contextmenu":case"dblclick":case"pointercancel":case"pointerdown":case"pointerup":return Tw.DiscreteEventPriority;case"pointermove":case"pointerout":case"pointerover":case"pointerenter":case"pointerleave":case"wheel":return Tw.ContinuousEventPriority;default:return Tw.DefaultEventPriority}},resetFormInstance(){},rendererPackageName:"@react-three/fiber",rendererVersion:Ore.version}),gy=new Map,dv={objects:"shallow",strict:!1};function Hre(r,e){if(!e&&typeof HTMLCanvasElement<"u"&&r instanceof HTMLCanvasElement&&r.parentElement){const{width:t,height:n,top:i,left:s}=r.parentElement.getBoundingClientRect();return{width:t,height:n,top:i,left:s}}else if(!e&&typeof OffscreenCanvas<"u"&&r instanceof OffscreenCanvas)return{width:r.width,height:r.height,top:0,left:0};return{width:0,height:0,top:0,left:0,...e}}function Wre(r){const e=gy.get(r),t=e?.fiber,n=e?.store;e&&console.warn("R3F.createRoot should only be called once!");const i=typeof reportError=="function"?reportError:console.error,s=n||Nre(EO,LV),a=t||oR.createContainer(s,Tw.ConcurrentRoot,null,!1,null,"",i,i,i,null);e||gy.set(r,{fiber:a,store:s});let o,l,c=!1,d=null;return{async configure(p={}){let y;d=new Promise(K=>y=K);let{gl:_,size:v,scene:b,events:E,onCreated:T,shadows:M=!1,linear:R=!1,flat:N=!1,legacy:P=!1,orthographic:U=!1,frameloop:L="always",dpr:F=[1,2],performance:O,raycaster:B,camera:q,onPointerMissed:j}=p,Q=s.getState(),se=Q.gl;if(!Q.gl){const K={canvas:r,powerPreference:"high-performance",antialias:!0,alpha:!0},he=typeof _=="function"?await _(K):_;CV(he)?se=he:se=new jL({...K,..._}),Q.set({gl:se})}let ae=Q.raycaster;ae||Q.set({raycaster:ae=new $L});const{params:V,...X}=B||{};if($r.equ(X,ae,dv)||Jf(ae,{...X}),$r.equ(V,ae.params,dv)||Jf(ae,{params:{...ae.params,...V}}),!Q.camera||Q.camera===l&&!$r.equ(l,q,dv)){l=q;const K=q?.isCamera,he=K?q:U?new rc(0,0,0,0,.1,1e3):new Br(75,0,.1,1e3);K||(he.position.z=5,q&&(Jf(he,q),he.manual||("aspect"in q||"left"in q||"right"in q||"bottom"in q||"top"in q)&&(he.manual=!0,he.updateProjectionMatrix())),!Q.camera&&!(q!=null&&q.rotation)&&he.lookAt(0,0,0)),Q.set({camera:he}),ae.camera=he}if(!Q.scene){let K;b!=null&&b.isScene?(K=b,rR(K,s,"",{})):(K=new Fm,rR(K,s,"",{}),b&&Jf(K,b)),Q.set({scene:K})}E&&!Q.events.handlers&&Q.set({events:E(s)});const ee=Hre(r,v);if($r.equ(ee,Q.size,dv)||Q.setSize(ee.width,ee.height,ee.top,ee.left),F&&Q.viewport.dpr!==X6(F)&&Q.setDpr(F),Q.frameloop!==L&&Q.setFrameloop(L),Q.onPointerMissed||Q.set({onPointerMissed:j}),O&&!$r.equ(O,Q.performance,dv)&&Q.set(K=>({performance:{...K.performance,...O}})),!Q.xr){var fe;const K=(Ie,ut)=>{const Ee=s.getState();Ee.frameloop!=="never"&&LV(Ie,!0,Ee,ut)},he=()=>{const Ie=s.getState();Ie.gl.xr.enabled=Ie.gl.xr.isPresenting,Ie.gl.xr.setAnimationLoop(Ie.gl.xr.isPresenting?K:null),Ie.gl.xr.isPresenting||EO(Ie)},Ce={connect(){const Ie=s.getState().gl;Ie.xr.addEventListener("sessionstart",he),Ie.xr.addEventListener("sessionend",he)},disconnect(){const Ie=s.getState().gl;Ie.xr.removeEventListener("sessionstart",he),Ie.xr.removeEventListener("sessionend",he)}};typeof((fe=se.xr)==null?void 0:fe.addEventListener)=="function"&&Ce.connect(),Q.set({xr:Ce})}if(se.shadowMap){const K=se.shadowMap.enabled,he=se.shadowMap.type;if(se.shadowMap.enabled=!!M,$r.boo(M))se.shadowMap.type=MT;else if($r.str(M)){var Y;const Ce={basic:YU,percentage:M0,soft:MT,variance:$c};se.shadowMap.type=(Y=Ce[M])!=null?Y:MT}else $r.obj(M)&&Object.assign(se.shadowMap,M);(K!==se.shadowMap.enabled||he!==se.shadowMap.type)&&(se.shadowMap.needsUpdate=!0)}return Nn.enabled=!P,c||(se.outputColorSpace=R?vu:ea,se.toneMapping=N?ta:L1),Q.legacy!==P&&Q.set(()=>({legacy:P})),Q.linear!==R&&Q.set(()=>({linear:R})),Q.flat!==N&&Q.set(()=>({flat:N})),_&&!$r.fun(_)&&!CV(_)&&!$r.equ(_,se,dv)&&Jf(se,_),o=T,c=!0,y(),this},render(p){return!c&&!d&&this.configure(),d.then(()=>{oR.updateContainer(Wt.jsx(qre,{store:s,children:p,onCreated:o,rootElement:r}),a,null,()=>{})}),s},unmount(){t8(r)}}}function qre({store:r,children:e,onCreated:t,rootElement:n}){return Q1(()=>{const i=r.getState();i.set(s=>({internal:{...s.internal,active:!0}})),t&&t(i),r.getState().events.connected||i.events.connect==null||i.events.connect(n)},[]),Wt.jsx(QL.Provider,{value:r,children:e})}function t8(r,e){const t=gy.get(r),n=t?.fiber;if(n){const i=t?.store.getState();i&&(i.internal.active=!1),oR.updateContainer(null,n,null,()=>{i&&setTimeout(()=>{try{var s,a,o,l;i.events.disconnect==null||i.events.disconnect(),(s=i.gl)==null||(a=s.renderLists)==null||a.dispose==null||a.dispose(),(o=i.gl)==null||o.forceContextLoss==null||o.forceContextLoss(),(l=i.gl)!=null&&l.xr&&i.xr.disconnect(),Sre(i.scene),gy.delete(r)}catch{}},500)})}}function Xre(r,e,t){return Wt.jsx($re,{children:r,container:e,state:t})}function $re({state:r={},children:e,container:t}){const{events:n,size:i,...s}=r,a=JL(),[o]=H.useState(()=>new $L),[l]=H.useState(()=>new tt),c=KL((p,y)=>{let _;if(y.camera&&i){const v=y.camera;_=p.viewport.getCurrentViewport(v,new ne,i),v!==p.camera&&j6(v,i)}return{...p,...y,scene:t,raycaster:o,pointer:l,mouse:l,previousRoot:a,events:{...p.events,...y.events,...n},size:{...p.size,...i},viewport:{...p.viewport,..._},setEvents:v=>y.set(b=>({...b,events:{...b.events,...v}}))}}),d=H.useMemo(()=>{const p=F6((_,v)=>({...s,set:_,get:v})),y=_=>p.setState(v=>c.current(_,v));return y(a.getState()),a.subscribe(y),p},[a,t]);return Wt.jsx(Wt.Fragment,{children:oR.createPortal(Wt.jsx(QL.Provider,{value:d,children:e}),d,null)})}const jre=new Set,Yre=new Set,Zre=new Set;function L3(r,e){if(r.size)for(const{callback:t}of r.values())t(e)}function NT(r,e){switch(r){case"before":return L3(jre,e);case"after":return L3(Yre,e);case"tail":return L3(Zre,e)}}let P3,B3;function SO(r,e,t){let n=e.clock.getDelta();e.frameloop==="never"&&typeof r=="number"&&(n=r-e.clock.elapsedTime,e.clock.oldTime=e.clock.elapsedTime,e.clock.elapsedTime=r),P3=e.internal.subscribers;for(let i=0;i<P3.length;i++)B3=P3[i],B3.ref.current(B3.store.getState(),n,t);return!e.internal.priority&&e.gl.render&&e.gl.render(e.scene,e.camera),e.internal.frames=Math.max(0,e.internal.frames-1),e.frameloop==="always"?1:e.internal.frames}let lR=!1,TO=!1,I3,UV,hv;function n8(r){UV=requestAnimationFrame(n8),lR=!0,I3=0,NT("before",r),TO=!0;for(const t of gy.values()){var e;hv=t.store.getState(),hv.internal.active&&(hv.frameloop==="always"||hv.internal.frames>0)&&!((e=hv.gl.xr)!=null&&e.isPresenting)&&(I3+=SO(r,hv))}if(TO=!1,NT("after",r),I3===0)return NT("tail",r),lR=!1,cancelAnimationFrame(UV)}function EO(r,e=1){var t;if(!r)return gy.forEach(n=>EO(n.store.getState(),e));(t=r.gl.xr)!=null&&t.isPresenting||!r.internal.active||r.frameloop==="never"||(e>1?r.internal.frames=Math.min(60,r.internal.frames+e):TO?r.internal.frames=2:r.internal.frames=1,lR||(lR=!0,requestAnimationFrame(n8)))}function LV(r,e=!0,t,n){if(e&&NT("before",r),t)SO(r,t,n);else for(const i of gy.values())SO(r,i.store.getState());e&&NT("after",r)}const F3={onClick:["click",!1],onContextMenu:["contextmenu",!1],onDoubleClick:["dblclick",!1],onWheel:["wheel",!0],onPointerDown:["pointerdown",!0],onPointerUp:["pointerup",!0],onPointerLeave:["pointerleave",!0],onPointerMove:["pointermove",!0],onPointerCancel:["pointercancel",!0],onLostPointerCapture:["lostpointercapture",!0]};function Kre(r){const{handlePointer:e}=Cre(r);return{priority:1,enabled:!0,compute(t,n,i){n.pointer.set(t.offsetX/n.size.width*2-1,-(t.offsetY/n.size.height)*2+1),n.raycaster.setFromCamera(n.pointer,n.camera)},connected:void 0,handlers:Object.keys(F3).reduce((t,n)=>({...t,[n]:e(n)}),{}),update:()=>{var t;const{events:n,internal:i}=r.getState();(t=i.lastEvent)!=null&&t.current&&n.handlers&&n.handlers.onPointerMove(i.lastEvent.current)},connect:t=>{const{set:n,events:i}=r.getState();if(i.disconnect==null||i.disconnect(),n(s=>({events:{...s.events,connected:t}})),i.handlers)for(const s in i.handlers){const a=i.handlers[s],[o,l]=F3[s];t.addEventListener(o,a,{passive:l})}},disconnect:()=>{const{set:t,events:n}=r.getState();if(n.connected){if(n.handlers)for(const i in n.handlers){const s=n.handlers[i],[a]=F3[i];n.connected.removeEventListener(a,s)}t(i=>({events:{...i.events,connected:void 0}}))}}}}function PV(r,e){let t;return(...n)=>{window.clearTimeout(t),t=window.setTimeout(()=>r(...n),e)}}function Qre({debounce:r,scroll:e,polyfill:t,offsetSize:n}={debounce:0,scroll:!1,offsetSize:!1}){const i=t||(typeof window>"u"?class{}:window.ResizeObserver);if(!i)throw new Error("This browser does not support ResizeObserver out of the box. See: https://github.com/react-spring/react-use-measure/#resize-observer-polyfills");const[s,a]=H.useState({left:0,top:0,width:0,height:0,bottom:0,right:0,x:0,y:0}),o=H.useRef({element:null,scrollContainers:null,resizeObserver:null,lastBounds:s,orientationHandler:null}),l=r?typeof r=="number"?r:r.scroll:null,c=r?typeof r=="number"?r:r.resize:null,d=H.useRef(!1);H.useEffect(()=>(d.current=!0,()=>{d.current=!1}));const[p,y,_]=H.useMemo(()=>{const T=()=>{if(!o.current.element)return;const{left:M,top:R,width:N,height:P,bottom:U,right:L,x:F,y:O}=o.current.element.getBoundingClientRect(),B={left:M,top:R,width:N,height:P,bottom:U,right:L,x:F,y:O};o.current.element instanceof HTMLElement&&n&&(B.height=o.current.element.offsetHeight,B.width=o.current.element.offsetWidth),Object.freeze(B),d.current&&!nse(o.current.lastBounds,B)&&a(o.current.lastBounds=B)};return[T,c?PV(T,c):T,l?PV(T,l):T]},[a,n,l,c]);function v(){o.current.scrollContainers&&(o.current.scrollContainers.forEach(T=>T.removeEventListener("scroll",_,!0)),o.current.scrollContainers=null),o.current.resizeObserver&&(o.current.resizeObserver.disconnect(),o.current.resizeObserver=null),o.current.orientationHandler&&("orientation"in screen&&"removeEventListener"in screen.orientation?screen.orientation.removeEventListener("change",o.current.orientationHandler):"onorientationchange"in window&&window.removeEventListener("orientationchange",o.current.orientationHandler))}function b(){o.current.element&&(o.current.resizeObserver=new i(_),o.current.resizeObserver.observe(o.current.element),e&&o.current.scrollContainers&&o.current.scrollContainers.forEach(T=>T.addEventListener("scroll",_,{capture:!0,passive:!0})),o.current.orientationHandler=()=>{_()},"orientation"in screen&&"addEventListener"in screen.orientation?screen.orientation.addEventListener("change",o.current.orientationHandler):"onorientationchange"in window&&window.addEventListener("orientationchange",o.current.orientationHandler))}const E=T=>{!T||T===o.current.element||(v(),o.current.element=T,o.current.scrollContainers=i8(T),b())};return ese(_,!!e),Jre(y),H.useEffect(()=>{v(),b()},[e,_,y]),H.useEffect(()=>v,[]),[E,s,p]}function Jre(r){H.useEffect(()=>{const e=r;return window.addEventListener("resize",e),()=>{window.removeEventListener("resize",e)}},[r])}function ese(r,e){H.useEffect(()=>{if(e){const t=r;return window.addEventListener("scroll",t,{capture:!0,passive:!0}),()=>{window.removeEventListener("scroll",t,!0)}}},[r,e])}function i8(r){const e=[];if(!r||r===document.body)return e;const{overflow:t,overflowX:n,overflowY:i}=window.getComputedStyle(r);return[t,n,i].some(s=>s==="auto"||s==="scroll")&&e.push(r),[...e,...i8(r.parentElement)]}const tse=["x","y","top","bottom","left","right","width","height"],nse=(r,e)=>tse.every(t=>r[t]===e[t]);function ise({ref:r,children:e,fallback:t,resize:n,style:i,gl:s,events:a=Kre,eventSource:o,eventPrefix:l,shadows:c,linear:d,flat:p,legacy:y,orthographic:_,frameloop:v,dpr:b,performance:E,raycaster:T,camera:M,scene:R,onPointerMissed:N,onCreated:P,...U}){H.useMemo(()=>tP(Hie),[]);const L=_re(),[F,O]=Qre({scroll:!0,debounce:{scroll:50,resize:0},...n}),B=H.useRef(null),q=H.useRef(null);H.useImperativeHandle(r,()=>B.current);const j=KL(N),[Q,se]=H.useState(!1),[ae,V]=H.useState(!1);if(Q)throw Q;if(ae)throw ae;const X=H.useRef(null);Q1(()=>{const fe=B.current;if(O.width>0&&O.height>0&&fe){X.current||(X.current=Wre(fe));async function Y(){await X.current.configure({gl:s,scene:R,events:a,shadows:c,linear:d,flat:p,legacy:y,orthographic:_,frameloop:v,dpr:b,performance:E,raycaster:T,camera:M,size:O,onPointerMissed:(...K)=>j.current==null?void 0:j.current(...K),onCreated:K=>{K.events.connect==null||K.events.connect(o?gre(o)?o.current:o:q.current),l&&K.setEvents({compute:(he,Ce)=>{const Ie=he[l+"X"],ut=he[l+"Y"];Ce.pointer.set(Ie/Ce.size.width*2-1,-(ut/Ce.size.height)*2+1),Ce.raycaster.setFromCamera(Ce.pointer,Ce.camera)}}),P?.(K)}}),X.current.render(Wt.jsx(L,{children:Wt.jsx(xre,{set:V,children:Wt.jsx(H.Suspense,{fallback:Wt.jsx(vre,{set:se}),children:e??null})})}))}Y()}}),H.useEffect(()=>{const fe=B.current;if(fe)return()=>t8(fe)},[]);const ee=o?"none":"auto";return Wt.jsx("div",{ref:q,style:{position:"relative",width:"100%",height:"100%",overflow:"hidden",pointerEvents:ee,...i},...U,children:Wt.jsx("div",{ref:F,style:{width:"100%",height:"100%"},children:Wt.jsx("canvas",{ref:B,style:{display:"block"},children:t})})})}function rse(r){return Wt.jsx(k6,{children:Wt.jsx(ise,{...r})})}function lh(r){if(r===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return r}function r8(r,e){r.prototype=Object.create(e.prototype),r.prototype.constructor=r,r.__proto__=e}var gu={autoSleep:120,force3D:"auto",nullTargetWarn:1,units:{lineHeight:""}},Sx={duration:.5,overwrite:!1,delay:0},iP,ka,jr,Ku=1e8,Nr=1/Ku,MO=Math.PI*2,sse=MO/4,ase=0,s8=Math.sqrt,ose=Math.cos,lse=Math.sin,Ea=function(e){return typeof e=="string"},bs=function(e){return typeof e=="function"},Fh=function(e){return typeof e=="number"},rP=function(e){return typeof e>"u"},md=function(e){return typeof e=="object"},Ul=function(e){return e!==!1},sP=function(){return typeof window<"u"},DA=function(e){return bs(e)||Ea(e)},a8=typeof ArrayBuffer=="function"&&ArrayBuffer.isView||function(){},vo=Array.isArray,use=/random\([^)]+\)/g,cse=/,\s*/g,BV=/(?:-?\.?\d|\.)+/gi,o8=/[-+=.]*\d+[.e\-+]*\d*[e\-+]*\d*/g,Pv=/[-+=.]*\d+[.e-]*\d*[a-z%]*/g,z3=/[-+=.]*\d+\.?\d*(?:e-|e\+)?\d*/gi,l8=/[+-]=-?[.\d]+/,fse=/[^,'"\[\]\s]+/gi,dse=/^[+\-=e\s\d]*\d+[.\d]*([a-z]*|%)\s*$/i,ls,Zf,AO,aP,xu={},uR={},u8,c8=function(e){return(uR=Tx(e,xu))&&Fl},oP=function(e,t){return console.warn("Invalid property",e,"set to",t,"Missing plugin? gsap.registerPlugin()")},d1=function(e,t){return!t&&console.warn(e)},f8=function(e,t){return e&&(xu[e]=t)&&uR&&(uR[e]=t)||xu},h1=function(){return 0},hse={suppressEvents:!0,isStart:!0,kill:!1},Rw={suppressEvents:!0,kill:!1},pse={suppressEvents:!0},lP={},hm=[],wO={},d8,au={},V3={},IV=30,Cw=[],uP="",cP=function(e){var t=e[0],n,i;if(md(t)||bs(t)||(e=[e]),!(n=(t._gsap||{}).harness)){for(i=Cw.length;i--&&!Cw[i].targetTest(t););n=Cw[i]}for(i=e.length;i--;)e[i]&&(e[i]._gsap||(e[i]._gsap=new B8(e[i],n)))||e.splice(i,1);return e},C0=function(e){return e._gsap||cP(Qu(e))[0]._gsap},h8=function(e,t,n){return(n=e[t])&&bs(n)?e[t]():rP(n)&&e.getAttribute&&e.getAttribute(t)||n},Ll=function(e,t){return(e=e.split(",")).forEach(t)||e},ws=function(e){return Math.round(e*1e5)/1e5||0},os=function(e){return Math.round(e*1e7)/1e7||0},kv=function(e,t){var n=t.charAt(0),i=parseFloat(t.substr(2));return e=parseFloat(e),n==="+"?e+i:n==="-"?e-i:n==="*"?e*i:e/i},mse=function(e,t){for(var n=t.length,i=0;e.indexOf(t[i])<0&&++i<n;);return i<n},cR=function(){var e=hm.length,t=hm.slice(0),n,i;for(wO={},hm.length=0,n=0;n<e;n++)i=t[n],i&&i._lazy&&(i.render(i._lazy[0],i._lazy[1],!0)._lazy=0)},fP=function(e){return!!(e._initted||e._startAt||e.add)},p8=function(e,t,n,i){hm.length&&!ka&&cR(),e.render(t,n,!!(ka&&t<0&&fP(e))),hm.length&&!ka&&cR()},m8=function(e){var t=parseFloat(e);return(t||t===0)&&(e+"").match(fse).length<2?t:Ea(e)?e.trim():e},g8=function(e){return e},bu=function(e,t){for(var n in t)n in e||(e[n]=t[n]);return e},gse=function(e){return function(t,n){for(var i in n)i in t||i==="duration"&&e||i==="ease"||(t[i]=n[i])}},Tx=function(e,t){for(var n in t)e[n]=t[n];return e},FV=function r(e,t){for(var n in t)n!=="__proto__"&&n!=="constructor"&&n!=="prototype"&&(e[n]=md(t[n])?r(e[n]||(e[n]={}),t[n]):t[n]);return e},fR=function(e,t){var n={},i;for(i in e)i in t||(n[i]=e[i]);return n},DT=function(e){var t=e.parent||ls,n=e.keyframes?gse(vo(e.keyframes)):bu;if(Ul(e.inherit))for(;t;)n(e,t.vars.defaults),t=t.parent||t._dp;return e},yse=function(e,t){for(var n=e.length,i=n===t.length;i&&n--&&e[n]===t[n];);return n<0},y8=function(e,t,n,i,s){var a=e[i],o;if(s)for(o=t[s];a&&a[s]>o;)a=a._prev;return a?(t._next=a._next,a._next=t):(t._next=e[n],e[n]=t),t._next?t._next._prev=t:e[i]=t,t._prev=a,t.parent=t._dp=e,t},ZC=function(e,t,n,i){n===void 0&&(n="_first"),i===void 0&&(i="_last");var s=t._prev,a=t._next;s?s._next=a:e[n]===t&&(e[n]=a),a?a._prev=s:e[i]===t&&(e[i]=s),t._next=t._prev=t.parent=null},Em=function(e,t){e.parent&&(!t||e.parent.autoRemoveChildren)&&e.parent.remove&&e.parent.remove(e),e._act=0},N0=function(e,t){if(e&&(!t||t._end>e._dur||t._start<0))for(var n=e;n;)n._dirty=1,n=n.parent;return e},_se=function(e){for(var t=e.parent;t&&t.parent;)t._dirty=1,t.totalDuration(),t=t.parent;return e},RO=function(e,t,n,i){return e._startAt&&(ka?e._startAt.revert(Rw):e.vars.immediateRender&&!e.vars.autoRevert||e._startAt.render(t,!0,i))},vse=function r(e){return!e||e._ts&&r(e.parent)},zV=function(e){return e._repeat?Ex(e._tTime,e=e.duration()+e._rDelay)*e:0},Ex=function(e,t){var n=Math.floor(e=os(e/t));return e&&n===e?n-1:n},dR=function(e,t){return(e-t._start)*t._ts+(t._ts>=0?0:t._dirty?t.totalDuration():t._tDur)},KC=function(e){return e._end=os(e._start+(e._tDur/Math.abs(e._ts||e._rts||Nr)||0))},QC=function(e,t){var n=e._dp;return n&&n.smoothChildTiming&&e._ts&&(e._start=os(n._time-(e._ts>0?t/e._ts:((e._dirty?e.totalDuration():e._tDur)-t)/-e._ts)),KC(e),n._dirty||N0(n,e)),e},_8=function(e,t){var n;if((t._time||!t._dur&&t._initted||t._start<e._time&&(t._dur||!t.add))&&(n=dR(e.rawTime(),t),(!t._dur||J1(0,t.totalDuration(),n)-t._tTime>Nr)&&t.render(n,!0)),N0(e,t)._dp&&e._initted&&e._time>=e._dur&&e._ts){if(e._dur<e.duration())for(n=e;n._dp;)n.rawTime()>=0&&n.totalTime(n._tTime),n=n._dp;e._zTime=-Nr}},ed=function(e,t,n,i){return t.parent&&Em(t),t._start=os((Fh(n)?n:n||e!==ls?Hu(e,n,t):e._time)+t._delay),t._end=os(t._start+(t.totalDuration()/Math.abs(t.timeScale())||0)),y8(e,t,"_first","_last",e._sort?"_start":0),CO(t)||(e._recent=t),i||_8(e,t),e._ts<0&&QC(e,e._tTime),e},v8=function(e,t){return(xu.ScrollTrigger||oP("scrollTrigger",t))&&xu.ScrollTrigger.create(t,e)},x8=function(e,t,n,i,s){if(hP(e,t,s),!e._initted)return 1;if(!n&&e._pt&&!ka&&(e._dur&&e.vars.lazy!==!1||!e._dur&&e.vars.lazy)&&d8!==cu.frame)return hm.push(e),e._lazy=[s,i],1},xse=function r(e){var t=e.parent;return t&&t._ts&&t._initted&&!t._lock&&(t.rawTime()<0||r(t))},CO=function(e){var t=e.data;return t==="isFromStart"||t==="isStart"},bse=function(e,t,n,i){var s=e.ratio,a=t<0||!t&&(!e._start&&xse(e)&&!(!e._initted&&CO(e))||(e._ts<0||e._dp._ts<0)&&!CO(e))?0:1,o=e._rDelay,l=0,c,d,p;if(o&&e._repeat&&(l=J1(0,e._tDur,t),d=Ex(l,o),e._yoyo&&d&1&&(a=1-a),d!==Ex(e._tTime,o)&&(s=1-a,e.vars.repeatRefresh&&e._initted&&e.invalidate())),a!==s||ka||i||e._zTime===Nr||!t&&e._zTime){if(!e._initted&&x8(e,t,i,n,l))return;for(p=e._zTime,e._zTime=t||(n?Nr:0),n||(n=t&&!p),e.ratio=a,e._from&&(a=1-a),e._time=0,e._tTime=l,c=e._pt;c;)c.r(a,c.d),c=c._next;t<0&&RO(e,t,n,!0),e._onUpdate&&!n&&du(e,"onUpdate"),l&&e._repeat&&!n&&e.parent&&du(e,"onRepeat"),(t>=e._tDur||t<0)&&e.ratio===a&&(a&&Em(e,1),!n&&!ka&&(du(e,a?"onComplete":"onReverseComplete",!0),e._prom&&e._prom()))}else e._zTime||(e._zTime=t)},Sse=function(e,t,n){var i;if(n>t)for(i=e._first;i&&i._start<=n;){if(i.data==="isPause"&&i._start>t)return i;i=i._next}else for(i=e._last;i&&i._start>=n;){if(i.data==="isPause"&&i._start<t)return i;i=i._prev}},Mx=function(e,t,n,i){var s=e._repeat,a=os(t)||0,o=e._tTime/e._tDur;return o&&!i&&(e._time*=a/e._dur),e._dur=a,e._tDur=s?s<0?1e10:os(a*(s+1)+e._rDelay*s):a,o>0&&!i&&QC(e,e._tTime=e._tDur*o),e.parent&&KC(e),n||N0(e.parent,e),e},VV=function(e){return e instanceof tl?N0(e):Mx(e,e._dur)},Tse={_start:0,endTime:h1,totalDuration:h1},Hu=function r(e,t,n){var i=e.labels,s=e._recent||Tse,a=e.duration()>=Ku?s.endTime(!1):e._dur,o,l,c;return Ea(t)&&(isNaN(t)||t in i)?(l=t.charAt(0),c=t.substr(-1)==="%",o=t.indexOf("="),l==="<"||l===">"?(o>=0&&(t=t.replace(/=/,"")),(l==="<"?s._start:s.endTime(s._repeat>=0))+(parseFloat(t.substr(1))||0)*(c?(o<0?s:n).totalDuration()/100:1)):o<0?(t in i||(i[t]=a),i[t]):(l=parseFloat(t.charAt(o-1)+t.substr(o+1)),c&&n&&(l=l/100*(vo(n)?n[0]:n).totalDuration()),o>1?r(e,t.substr(0,o-1),n)+l:a+l)):t==null?a:+t},OT=function(e,t,n){var i=Fh(t[1]),s=(i?2:1)+(e<2?0:1),a=t[s],o,l;if(i&&(a.duration=t[1]),a.parent=n,e){for(o=a,l=n;l&&!("immediateRender"in o);)o=l.vars.defaults||{},l=Ul(l.vars.inherit)&&l.parent;a.immediateRender=Ul(o.immediateRender),e<2?a.runBackwards=1:a.startAt=t[s-1]}return new ks(t[0],a,t[s+1])},Gm=function(e,t){return e||e===0?t(e):t},J1=function(e,t,n){return n<e?e:n>t?t:n},uo=function(e,t){return!Ea(e)||!(t=dse.exec(e))?"":t[1]},Ese=function(e,t,n){return Gm(n,function(i){return J1(e,t,i)})},NO=[].slice,b8=function(e,t){return e&&md(e)&&"length"in e&&(!t&&!e.length||e.length-1 in e&&md(e[0]))&&!e.nodeType&&e!==Zf},Mse=function(e,t,n){return n===void 0&&(n=[]),e.forEach(function(i){var s;return Ea(i)&&!t||b8(i,1)?(s=n).push.apply(s,Qu(i)):n.push(i)})||n},Qu=function(e,t,n){return jr&&!t&&jr.selector?jr.selector(e):Ea(e)&&!n&&(AO||!Ax())?NO.call((t||aP).querySelectorAll(e),0):vo(e)?Mse(e,n):b8(e)?NO.call(e,0):e?[e]:[]},DO=function(e){return e=Qu(e)[0]||d1("Invalid scope")||{},function(t){var n=e.current||e.nativeElement||e;return Qu(t,n.querySelectorAll?n:n===e?d1("Invalid scope")||aP.createElement("div"):e)}},S8=function(e){return e.sort(function(){return .5-Math.random()})},T8=function(e){if(bs(e))return e;var t=md(e)?e:{each:e},n=D0(t.ease),i=t.from||0,s=parseFloat(t.base)||0,a={},o=i>0&&i<1,l=isNaN(i)||o,c=t.axis,d=i,p=i;return Ea(i)?d=p={center:.5,edges:.5,end:1}[i]||0:!o&&l&&(d=i[0],p=i[1]),function(y,_,v){var b=(v||t).length,E=a[b],T,M,R,N,P,U,L,F,O;if(!E){if(O=t.grid==="auto"?0:(t.grid||[1,Ku])[1],!O){for(L=-Ku;L<(L=v[O++].getBoundingClientRect().left)&&O<b;);O<b&&O--}for(E=a[b]=[],T=l?Math.min(O,b)*d-.5:i%O,M=O===Ku?0:l?b*p/O-.5:i/O|0,L=0,F=Ku,U=0;U<b;U++)R=U%O-T,N=M-(U/O|0),E[U]=P=c?Math.abs(c==="y"?N:R):s8(R*R+N*N),P>L&&(L=P),P<F&&(F=P);i==="random"&&S8(E),E.max=L-F,E.min=F,E.v=b=(parseFloat(t.amount)||parseFloat(t.each)*(O>b?b-1:c?c==="y"?b/O:O:Math.max(O,b/O))||0)*(i==="edges"?-1:1),E.b=b<0?s-b:s,E.u=uo(t.amount||t.each)||0,n=n&&b<0?U8(n):n}return b=(E[y]-E.min)/E.max||0,os(E.b+(n?n(b):b)*E.v)+E.u}},OO=function(e){var t=Math.pow(10,((e+"").split(".")[1]||"").length);return function(n){var i=os(Math.round(parseFloat(n)/e)*e*t);return(i-i%1)/t+(Fh(n)?0:uo(n))}},E8=function(e,t){var n=vo(e),i,s;return!n&&md(e)&&(i=n=e.radius||Ku,e.values?(e=Qu(e.values),(s=!Fh(e[0]))&&(i*=i)):e=OO(e.increment)),Gm(t,n?bs(e)?function(a){return s=e(a),Math.abs(s-a)<=i?s:a}:function(a){for(var o=parseFloat(s?a.x:a),l=parseFloat(s?a.y:0),c=Ku,d=0,p=e.length,y,_;p--;)s?(y=e[p].x-o,_=e[p].y-l,y=y*y+_*_):y=Math.abs(e[p]-o),y<c&&(c=y,d=p);return d=!i||c<=i?e[d]:a,s||d===a||Fh(a)?d:d+uo(a)}:OO(e))},M8=function(e,t,n,i){return Gm(vo(e)?!t:n===!0?!!(n=0):!i,function(){return vo(e)?e[~~(Math.random()*e.length)]:(n=n||1e-5)&&(i=n<1?Math.pow(10,(n+"").length-2):1)&&Math.floor(Math.round((e-n/2+Math.random()*(t-e+n*.99))/n)*n*i)/i})},Ase=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return function(i){return t.reduce(function(s,a){return a(s)},i)}},wse=function(e,t){return function(n){return e(parseFloat(n))+(t||uo(n))}},Rse=function(e,t,n){return w8(e,t,0,1,n)},A8=function(e,t,n){return Gm(n,function(i){return e[~~t(i)]})},Cse=function r(e,t,n){var i=t-e;return vo(e)?A8(e,r(0,e.length),t):Gm(n,function(s){return(i+(s-e)%i)%i+e})},Nse=function r(e,t,n){var i=t-e,s=i*2;return vo(e)?A8(e,r(0,e.length-1),t):Gm(n,function(a){return a=(s+(a-e)%s)%s||0,e+(a>i?s-a:a)})},p1=function(e){return e.replace(use,function(t){var n=t.indexOf("[")+1,i=t.substring(n||7,n?t.indexOf("]"):t.length-1).split(cse);return M8(n?i:+i[0],n?0:+i[1],+i[2]||1e-5)})},w8=function(e,t,n,i,s){var a=t-e,o=i-n;return Gm(s,function(l){return n+((l-e)/a*o||0)})},Dse=function r(e,t,n,i){var s=isNaN(e+t)?0:function(_){return(1-_)*e+_*t};if(!s){var a=Ea(e),o={},l,c,d,p,y;if(n===!0&&(i=1)&&(n=null),a)e={p:e},t={p:t};else if(vo(e)&&!vo(t)){for(d=[],p=e.length,y=p-2,c=1;c<p;c++)d.push(r(e[c-1],e[c]));p--,s=function(v){v*=p;var b=Math.min(y,~~v);return d[b](v-b)},n=t}else i||(e=Tx(vo(e)?[]:{},e));if(!d){for(l in t)dP.call(o,e,l,"get",t[l]);s=function(v){return gP(v,o)||(a?e.p:e)}}}return Gm(n,s)},GV=function(e,t,n){var i=e.labels,s=Ku,a,o,l;for(a in i)o=i[a]-t,o<0==!!n&&o&&s>(o=Math.abs(o))&&(l=a,s=o);return l},du=function(e,t,n){var i=e.vars,s=i[t],a=jr,o=e._ctx,l,c,d;if(s)return l=i[t+"Params"],c=i.callbackScope||e,n&&hm.length&&cR(),o&&(jr=o),d=l?s.apply(c,l):s.call(c),jr=a,d},pT=function(e){return Em(e),e.scrollTrigger&&e.scrollTrigger.kill(!!ka),e.progress()<1&&du(e,"onInterrupt"),e},Bv,R8=[],C8=function(e){if(e)if(e=!e.name&&e.default||e,sP()||e.headless){var t=e.name,n=bs(e),i=t&&!n&&e.init?function(){this._props=[]}:e,s={init:h1,render:gP,add:dP,kill:$se,modifier:Xse,rawVars:0},a={targetTest:0,get:0,getSetter:mP,aliases:{},register:0};if(Ax(),e!==i){if(au[t])return;bu(i,bu(fR(e,s),a)),Tx(i.prototype,Tx(s,fR(e,a))),au[i.prop=t]=i,e.targetTest&&(Cw.push(i),lP[t]=1),t=(t==="css"?"CSS":t.charAt(0).toUpperCase()+t.substr(1))+"Plugin"}f8(t,i),e.register&&e.register(Fl,i,Pl)}else R8.push(e)},Rr=255,mT={aqua:[0,Rr,Rr],lime:[0,Rr,0],silver:[192,192,192],black:[0,0,0],maroon:[128,0,0],teal:[0,128,128],blue:[0,0,Rr],navy:[0,0,128],white:[Rr,Rr,Rr],olive:[128,128,0],yellow:[Rr,Rr,0],orange:[Rr,165,0],gray:[128,128,128],purple:[128,0,128],green:[0,128,0],red:[Rr,0,0],pink:[Rr,192,203],cyan:[0,Rr,Rr],transparent:[Rr,Rr,Rr,0]},G3=function(e,t,n){return e+=e<0?1:e>1?-1:0,(e*6<1?t+(n-t)*e*6:e<.5?n:e*3<2?t+(n-t)*(2/3-e)*6:t)*Rr+.5|0},N8=function(e,t,n){var i=e?Fh(e)?[e>>16,e>>8&Rr,e&Rr]:0:mT.black,s,a,o,l,c,d,p,y,_,v;if(!i){if(e.substr(-1)===","&&(e=e.substr(0,e.length-1)),mT[e])i=mT[e];else if(e.charAt(0)==="#"){if(e.length<6&&(s=e.charAt(1),a=e.charAt(2),o=e.charAt(3),e="#"+s+s+a+a+o+o+(e.length===5?e.charAt(4)+e.charAt(4):"")),e.length===9)return i=parseInt(e.substr(1,6),16),[i>>16,i>>8&Rr,i&Rr,parseInt(e.substr(7),16)/255];e=parseInt(e.substr(1),16),i=[e>>16,e>>8&Rr,e&Rr]}else if(e.substr(0,3)==="hsl"){if(i=v=e.match(BV),!t)l=+i[0]%360/360,c=+i[1]/100,d=+i[2]/100,a=d<=.5?d*(c+1):d+c-d*c,s=d*2-a,i.length>3&&(i[3]*=1),i[0]=G3(l+1/3,s,a),i[1]=G3(l,s,a),i[2]=G3(l-1/3,s,a);else if(~e.indexOf("="))return i=e.match(o8),n&&i.length<4&&(i[3]=1),i}else i=e.match(BV)||mT.transparent;i=i.map(Number)}return t&&!v&&(s=i[0]/Rr,a=i[1]/Rr,o=i[2]/Rr,p=Math.max(s,a,o),y=Math.min(s,a,o),d=(p+y)/2,p===y?l=c=0:(_=p-y,c=d>.5?_/(2-p-y):_/(p+y),l=p===s?(a-o)/_+(a<o?6:0):p===a?(o-s)/_+2:(s-a)/_+4,l*=60),i[0]=~~(l+.5),i[1]=~~(c*100+.5),i[2]=~~(d*100+.5)),n&&i.length<4&&(i[3]=1),i},D8=function(e){var t=[],n=[],i=-1;return e.split(pm).forEach(function(s){var a=s.match(Pv)||[];t.push.apply(t,a),n.push(i+=a.length+1)}),t.c=n,t},kV=function(e,t,n){var i="",s=(e+i).match(pm),a=t?"hsla(":"rgba(",o=0,l,c,d,p;if(!s)return e;if(s=s.map(function(y){return(y=N8(y,t,1))&&a+(t?y[0]+","+y[1]+"%,"+y[2]+"%,"+y[3]:y.join(","))+")"}),n&&(d=D8(e),l=n.c,l.join(i)!==d.c.join(i)))for(c=e.replace(pm,"1").split(Pv),p=c.length-1;o<p;o++)i+=c[o]+(~l.indexOf(o)?s.shift()||a+"0,0,0,0)":(d.length?d:s.length?s:n).shift());if(!c)for(c=e.split(pm),p=c.length-1;o<p;o++)i+=c[o]+s[o];return i+c[p]},pm=(function(){var r="(?:\\b(?:(?:rgb|rgba|hsl|hsla)\\(.+?\\))|\\B#(?:[0-9a-f]{3,4}){1,2}\\b",e;for(e in mT)r+="|"+e+"\\b";return new RegExp(r+")","gi")})(),Ose=/hsl[a]?\(/,O8=function(e){var t=e.join(" "),n;if(pm.lastIndex=0,pm.test(t))return n=Ose.test(t),e[1]=kV(e[1],n),e[0]=kV(e[0],n,D8(e[1])),!0},m1,cu=(function(){var r=Date.now,e=500,t=33,n=r(),i=n,s=1e3/240,a=s,o=[],l,c,d,p,y,_,v=function b(E){var T=r()-i,M=E===!0,R,N,P,U;if((T>e||T<0)&&(n+=T-t),i+=T,P=i-n,R=P-a,(R>0||M)&&(U=++p.frame,y=P-p.time*1e3,p.time=P=P/1e3,a+=R+(R>=s?4:s-R),N=1),M||(l=c(b)),N)for(_=0;_<o.length;_++)o[_](P,y,U,E)};return p={time:0,frame:0,tick:function(){v(!0)},deltaRatio:function(E){return y/(1e3/(E||60))},wake:function(){u8&&(!AO&&sP()&&(Zf=AO=window,aP=Zf.document||{},xu.gsap=Fl,(Zf.gsapVersions||(Zf.gsapVersions=[])).push(Fl.version),c8(uR||Zf.GreenSockGlobals||!Zf.gsap&&Zf||{}),R8.forEach(C8)),d=typeof requestAnimationFrame<"u"&&requestAnimationFrame,l&&p.sleep(),c=d||function(E){return setTimeout(E,a-p.time*1e3+1|0)},m1=1,v(2))},sleep:function(){(d?cancelAnimationFrame:clearTimeout)(l),m1=0,c=h1},lagSmoothing:function(E,T){e=E||1/0,t=Math.min(T||33,e)},fps:function(E){s=1e3/(E||240),a=p.time*1e3+s},add:function(E,T,M){var R=T?function(N,P,U,L){E(N,P,U,L),p.remove(R)}:E;return p.remove(E),o[M?"unshift":"push"](R),Ax(),R},remove:function(E,T){~(T=o.indexOf(E))&&o.splice(T,1)&&_>=T&&_--},_listeners:o},p})(),Ax=function(){return!m1&&cu.wake()},Pi={},Use=/^[\d.\-M][\d.\-,\s]/,Lse=/["']/g,Pse=function(e){for(var t={},n=e.substr(1,e.length-3).split(":"),i=n[0],s=1,a=n.length,o,l,c;s<a;s++)l=n[s],o=s!==a-1?l.lastIndexOf(","):l.length,c=l.substr(0,o),t[i]=isNaN(c)?c.replace(Lse,"").trim():+c,i=l.substr(o+1).trim();return t},Bse=function(e){var t=e.indexOf("(")+1,n=e.indexOf(")"),i=e.indexOf("(",t);return e.substring(t,~i&&i<n?e.indexOf(")",n+1):n)},Ise=function(e){var t=(e+"").split("("),n=Pi[t[0]];return n&&t.length>1&&n.config?n.config.apply(null,~e.indexOf("{")?[Pse(t[1])]:Bse(e).split(",").map(m8)):Pi._CE&&Use.test(e)?Pi._CE("",e):n},U8=function(e){return function(t){return 1-e(1-t)}},L8=function r(e,t){for(var n=e._first,i;n;)n instanceof tl?r(n,t):n.vars.yoyoEase&&(!n._yoyo||!n._repeat)&&n._yoyo!==t&&(n.timeline?r(n.timeline,t):(i=n._ease,n._ease=n._yEase,n._yEase=i,n._yoyo=t)),n=n._next},D0=function(e,t){return e&&(bs(e)?e:Pi[e]||Ise(e))||t},Dy=function(e,t,n,i){n===void 0&&(n=function(l){return 1-t(1-l)}),i===void 0&&(i=function(l){return l<.5?t(l*2)/2:1-t((1-l)*2)/2});var s={easeIn:t,easeOut:n,easeInOut:i},a;return Ll(e,function(o){Pi[o]=xu[o]=s,Pi[a=o.toLowerCase()]=n;for(var l in s)Pi[a+(l==="easeIn"?".in":l==="easeOut"?".out":".inOut")]=Pi[o+"."+l]=s[l]}),s},P8=function(e){return function(t){return t<.5?(1-e(1-t*2))/2:.5+e((t-.5)*2)/2}},k3=function r(e,t,n){var i=t>=1?t:1,s=(n||(e?.3:.45))/(t<1?t:1),a=s/MO*(Math.asin(1/i)||0),o=function(d){return d===1?1:i*Math.pow(2,-10*d)*lse((d-a)*s)+1},l=e==="out"?o:e==="in"?function(c){return 1-o(1-c)}:P8(o);return s=MO/s,l.config=function(c,d){return r(e,c,d)},l},H3=function r(e,t){t===void 0&&(t=1.70158);var n=function(a){return a?--a*a*((t+1)*a+t)+1:0},i=e==="out"?n:e==="in"?function(s){return 1-n(1-s)}:P8(n);return i.config=function(s){return r(e,s)},i};Ll("Linear,Quad,Cubic,Quart,Quint,Strong",function(r,e){var t=e<5?e+1:e;Dy(r+",Power"+(t-1),e?function(n){return Math.pow(n,t)}:function(n){return n},function(n){return 1-Math.pow(1-n,t)},function(n){return n<.5?Math.pow(n*2,t)/2:1-Math.pow((1-n)*2,t)/2})});Pi.Linear.easeNone=Pi.none=Pi.Linear.easeIn;Dy("Elastic",k3("in"),k3("out"),k3());(function(r,e){var t=1/e,n=2*t,i=2.5*t,s=function(o){return o<t?r*o*o:o<n?r*Math.pow(o-1.5/e,2)+.75:o<i?r*(o-=2.25/e)*o+.9375:r*Math.pow(o-2.625/e,2)+.984375};Dy("Bounce",function(a){return 1-s(1-a)},s)})(7.5625,2.75);Dy("Expo",function(r){return Math.pow(2,10*(r-1))*r+r*r*r*r*r*r*(1-r)});Dy("Circ",function(r){return-(s8(1-r*r)-1)});Dy("Sine",function(r){return r===1?1:-ose(r*sse)+1});Dy("Back",H3("in"),H3("out"),H3());Pi.SteppedEase=Pi.steps=xu.SteppedEase={config:function(e,t){e===void 0&&(e=1);var n=1/e,i=e+(t?0:1),s=t?1:0,a=1-Nr;return function(o){return((i*J1(0,a,o)|0)+s)*n}}};Sx.ease=Pi["quad.out"];Ll("onComplete,onUpdate,onStart,onRepeat,onReverseComplete,onInterrupt",function(r){return uP+=r+","+r+"Params,"});var B8=function(e,t){this.id=ase++,e._gsap=this,this.target=e,this.harness=t,this.get=t?t.get:h8,this.set=t?t.getSetter:mP},g1=(function(){function r(t){this.vars=t,this._delay=+t.delay||0,(this._repeat=t.repeat===1/0?-2:t.repeat||0)&&(this._rDelay=t.repeatDelay||0,this._yoyo=!!t.yoyo||!!t.yoyoEase),this._ts=1,Mx(this,+t.duration,1,1),this.data=t.data,jr&&(this._ctx=jr,jr.data.push(this)),m1||cu.wake()}var e=r.prototype;return e.delay=function(n){return n||n===0?(this.parent&&this.parent.smoothChildTiming&&this.startTime(this._start+n-this._delay),this._delay=n,this):this._delay},e.duration=function(n){return arguments.length?this.totalDuration(this._repeat>0?n+(n+this._rDelay)*this._repeat:n):this.totalDuration()&&this._dur},e.totalDuration=function(n){return arguments.length?(this._dirty=0,Mx(this,this._repeat<0?n:(n-this._repeat*this._rDelay)/(this._repeat+1))):this._tDur},e.totalTime=function(n,i){if(Ax(),!arguments.length)return this._tTime;var s=this._dp;if(s&&s.smoothChildTiming&&this._ts){for(QC(this,n),!s._dp||s.parent||_8(s,this);s&&s.parent;)s.parent._time!==s._start+(s._ts>=0?s._tTime/s._ts:(s.totalDuration()-s._tTime)/-s._ts)&&s.totalTime(s._tTime,!0),s=s.parent;!this.parent&&this._dp.autoRemoveChildren&&(this._ts>0&&n<this._tDur||this._ts<0&&n>0||!this._tDur&&!n)&&ed(this._dp,this,this._start-this._delay)}return(this._tTime!==n||!this._dur&&!i||this._initted&&Math.abs(this._zTime)===Nr||!this._initted&&this._dur&&n||!n&&!this._initted&&(this.add||this._ptLookup))&&(this._ts||(this._pTime=n),p8(this,n,i)),this},e.time=function(n,i){return arguments.length?this.totalTime(Math.min(this.totalDuration(),n+zV(this))%(this._dur+this._rDelay)||(n?this._dur:0),i):this._time},e.totalProgress=function(n,i){return arguments.length?this.totalTime(this.totalDuration()*n,i):this.totalDuration()?Math.min(1,this._tTime/this._tDur):this.rawTime()>=0&&this._initted?1:0},e.progress=function(n,i){return arguments.length?this.totalTime(this.duration()*(this._yoyo&&!(this.iteration()&1)?1-n:n)+zV(this),i):this.duration()?Math.min(1,this._time/this._dur):this.rawTime()>0?1:0},e.iteration=function(n,i){var s=this.duration()+this._rDelay;return arguments.length?this.totalTime(this._time+(n-1)*s,i):this._repeat?Ex(this._tTime,s)+1:1},e.timeScale=function(n,i){if(!arguments.length)return this._rts===-Nr?0:this._rts;if(this._rts===n)return this;var s=this.parent&&this._ts?dR(this.parent._time,this):this._tTime;return this._rts=+n||0,this._ts=this._ps||n===-Nr?0:this._rts,this.totalTime(J1(-Math.abs(this._delay),this.totalDuration(),s),i!==!1),KC(this),_se(this)},e.paused=function(n){return arguments.length?(this._ps!==n&&(this._ps=n,n?(this._pTime=this._tTime||Math.max(-this._delay,this.rawTime()),this._ts=this._act=0):(Ax(),this._ts=this._rts,this.totalTime(this.parent&&!this.parent.smoothChildTiming?this.rawTime():this._tTime||this._pTime,this.progress()===1&&Math.abs(this._zTime)!==Nr&&(this._tTime-=Nr)))),this):this._ps},e.startTime=function(n){if(arguments.length){this._start=os(n);var i=this.parent||this._dp;return i&&(i._sort||!this.parent)&&ed(i,this,this._start-this._delay),this}return this._start},e.endTime=function(n){return this._start+(Ul(n)?this.totalDuration():this.duration())/Math.abs(this._ts||1)},e.rawTime=function(n){var i=this.parent||this._dp;return i?n&&(!this._ts||this._repeat&&this._time&&this.totalProgress()<1)?this._tTime%(this._dur+this._rDelay):this._ts?dR(i.rawTime(n),this):this._tTime:this._tTime},e.revert=function(n){n===void 0&&(n=pse);var i=ka;return ka=n,fP(this)&&(this.timeline&&this.timeline.revert(n),this.totalTime(-.01,n.suppressEvents)),this.data!=="nested"&&n.kill!==!1&&this.kill(),ka=i,this},e.globalTime=function(n){for(var i=this,s=arguments.length?n:i.rawTime();i;)s=i._start+s/(Math.abs(i._ts)||1),i=i._dp;return!this.parent&&this._sat?this._sat.globalTime(n):s},e.repeat=function(n){return arguments.length?(this._repeat=n===1/0?-2:n,VV(this)):this._repeat===-2?1/0:this._repeat},e.repeatDelay=function(n){if(arguments.length){var i=this._time;return this._rDelay=n,VV(this),i?this.time(i):this}return this._rDelay},e.yoyo=function(n){return arguments.length?(this._yoyo=n,this):this._yoyo},e.seek=function(n,i){return this.totalTime(Hu(this,n),Ul(i))},e.restart=function(n,i){return this.play().totalTime(n?-this._delay:0,Ul(i)),this._dur||(this._zTime=-Nr),this},e.play=function(n,i){return n!=null&&this.seek(n,i),this.reversed(!1).paused(!1)},e.reverse=function(n,i){return n!=null&&this.seek(n||this.totalDuration(),i),this.reversed(!0).paused(!1)},e.pause=function(n,i){return n!=null&&this.seek(n,i),this.paused(!0)},e.resume=function(){return this.paused(!1)},e.reversed=function(n){return arguments.length?(!!n!==this.reversed()&&this.timeScale(-this._rts||(n?-Nr:0)),this):this._rts<0},e.invalidate=function(){return this._initted=this._act=0,this._zTime=-Nr,this},e.isActive=function(){var n=this.parent||this._dp,i=this._start,s;return!!(!n||this._ts&&this._initted&&n.isActive()&&(s=n.rawTime(!0))>=i&&s<this.endTime(!0)-Nr)},e.eventCallback=function(n,i,s){var a=this.vars;return arguments.length>1?(i?(a[n]=i,s&&(a[n+"Params"]=s),n==="onUpdate"&&(this._onUpdate=i)):delete a[n],this):a[n]},e.then=function(n){var i=this,s=i._prom;return new Promise(function(a){var o=bs(n)?n:g8,l=function(){var d=i.then;i.then=null,s&&s(),bs(o)&&(o=o(i))&&(o.then||o===i)&&(i.then=d),a(o),i.then=d};i._initted&&i.totalProgress()===1&&i._ts>=0||!i._tTime&&i._ts<0?l():i._prom=l})},e.kill=function(){pT(this)},r})();bu(g1.prototype,{_time:0,_start:0,_end:0,_tTime:0,_tDur:0,_dirty:0,_repeat:0,_yoyo:!1,parent:null,_initted:!1,_rDelay:0,_ts:1,_dp:0,ratio:0,_zTime:-Nr,_prom:0,_ps:!1,_rts:1});var tl=(function(r){r8(e,r);function e(n,i){var s;return n===void 0&&(n={}),s=r.call(this,n)||this,s.labels={},s.smoothChildTiming=!!n.smoothChildTiming,s.autoRemoveChildren=!!n.autoRemoveChildren,s._sort=Ul(n.sortChildren),ls&&ed(n.parent||ls,lh(s),i),n.reversed&&s.reverse(),n.paused&&s.paused(!0),n.scrollTrigger&&v8(lh(s),n.scrollTrigger),s}var t=e.prototype;return t.to=function(i,s,a){return OT(0,arguments,this),this},t.from=function(i,s,a){return OT(1,arguments,this),this},t.fromTo=function(i,s,a,o){return OT(2,arguments,this),this},t.set=function(i,s,a){return s.duration=0,s.parent=this,DT(s).repeatDelay||(s.repeat=0),s.immediateRender=!!s.immediateRender,new ks(i,s,Hu(this,a),1),this},t.call=function(i,s,a){return ed(this,ks.delayedCall(0,i,s),a)},t.staggerTo=function(i,s,a,o,l,c,d){return a.duration=s,a.stagger=a.stagger||o,a.onComplete=c,a.onCompleteParams=d,a.parent=this,new ks(i,a,Hu(this,l)),this},t.staggerFrom=function(i,s,a,o,l,c,d){return a.runBackwards=1,DT(a).immediateRender=Ul(a.immediateRender),this.staggerTo(i,s,a,o,l,c,d)},t.staggerFromTo=function(i,s,a,o,l,c,d,p){return o.startAt=a,DT(o).immediateRender=Ul(o.immediateRender),this.staggerTo(i,s,o,l,c,d,p)},t.render=function(i,s,a){var o=this._time,l=this._dirty?this.totalDuration():this._tDur,c=this._dur,d=i<=0?0:os(i),p=this._zTime<0!=i<0&&(this._initted||!c),y,_,v,b,E,T,M,R,N,P,U,L;if(this!==ls&&d>l&&i>=0&&(d=l),d!==this._tTime||a||p){if(o!==this._time&&c&&(d+=this._time-o,i+=this._time-o),y=d,N=this._start,R=this._ts,T=!R,p&&(c||(o=this._zTime),(i||!s)&&(this._zTime=i)),this._repeat){if(U=this._yoyo,E=c+this._rDelay,this._repeat<-1&&i<0)return this.totalTime(E*100+i,s,a);if(y=os(d%E),d===l?(b=this._repeat,y=c):(P=os(d/E),b=~~P,b&&b===P&&(y=c,b--),y>c&&(y=c)),P=Ex(this._tTime,E),!o&&this._tTime&&P!==b&&this._tTime-P*E-this._dur<=0&&(P=b),U&&b&1&&(y=c-y,L=1),b!==P&&!this._lock){var F=U&&P&1,O=F===(U&&b&1);if(b<P&&(F=!F),o=F?0:d%c?c:d,this._lock=1,this.render(o||(L?0:os(b*E)),s,!c)._lock=0,this._tTime=d,!s&&this.parent&&du(this,"onRepeat"),this.vars.repeatRefresh&&!L&&(this.invalidate()._lock=1,P=b),o&&o!==this._time||T!==!this._ts||this.vars.onRepeat&&!this.parent&&!this._act)return this;if(c=this._dur,l=this._tDur,O&&(this._lock=2,o=F?c:-1e-4,this.render(o,!0),this.vars.repeatRefresh&&!L&&this.invalidate()),this._lock=0,!this._ts&&!T)return this;L8(this,L)}}if(this._hasPause&&!this._forcing&&this._lock<2&&(M=Sse(this,os(o),os(y)),M&&(d-=y-(y=M._start))),this._tTime=d,this._time=y,this._act=!R,this._initted||(this._onUpdate=this.vars.onUpdate,this._initted=1,this._zTime=i,o=0),!o&&d&&c&&!s&&!P&&(du(this,"onStart"),this._tTime!==d))return this;if(y>=o&&i>=0)for(_=this._first;_;){if(v=_._next,(_._act||y>=_._start)&&_._ts&&M!==_){if(_.parent!==this)return this.render(i,s,a);if(_.render(_._ts>0?(y-_._start)*_._ts:(_._dirty?_.totalDuration():_._tDur)+(y-_._start)*_._ts,s,a),y!==this._time||!this._ts&&!T){M=0,v&&(d+=this._zTime=-Nr);break}}_=v}else{_=this._last;for(var B=i<0?i:y;_;){if(v=_._prev,(_._act||B<=_._end)&&_._ts&&M!==_){if(_.parent!==this)return this.render(i,s,a);if(_.render(_._ts>0?(B-_._start)*_._ts:(_._dirty?_.totalDuration():_._tDur)+(B-_._start)*_._ts,s,a||ka&&fP(_)),y!==this._time||!this._ts&&!T){M=0,v&&(d+=this._zTime=B?-Nr:Nr);break}}_=v}}if(M&&!s&&(this.pause(),M.render(y>=o?0:-Nr)._zTime=y>=o?1:-1,this._ts))return this._start=N,KC(this),this.render(i,s,a);this._onUpdate&&!s&&du(this,"onUpdate",!0),(d===l&&this._tTime>=this.totalDuration()||!d&&o)&&(N===this._start||Math.abs(R)!==Math.abs(this._ts))&&(this._lock||((i||!c)&&(d===l&&this._ts>0||!d&&this._ts<0)&&Em(this,1),!s&&!(i<0&&!o)&&(d||o||!l)&&(du(this,d===l&&i>=0?"onComplete":"onReverseComplete",!0),this._prom&&!(d<l&&this.timeScale()>0)&&this._prom())))}return this},t.add=function(i,s){var a=this;if(Fh(s)||(s=Hu(this,s,i)),!(i instanceof g1)){if(vo(i))return i.forEach(function(o){return a.add(o,s)}),this;if(Ea(i))return this.addLabel(i,s);if(bs(i))i=ks.delayedCall(0,i);else return this}return this!==i?ed(this,i,s):this},t.getChildren=function(i,s,a,o){i===void 0&&(i=!0),s===void 0&&(s=!0),a===void 0&&(a=!0),o===void 0&&(o=-Ku);for(var l=[],c=this._first;c;)c._start>=o&&(c instanceof ks?s&&l.push(c):(a&&l.push(c),i&&l.push.apply(l,c.getChildren(!0,s,a)))),c=c._next;return l},t.getById=function(i){for(var s=this.getChildren(1,1,1),a=s.length;a--;)if(s[a].vars.id===i)return s[a]},t.remove=function(i){return Ea(i)?this.removeLabel(i):bs(i)?this.killTweensOf(i):(i.parent===this&&ZC(this,i),i===this._recent&&(this._recent=this._last),N0(this))},t.totalTime=function(i,s){return arguments.length?(this._forcing=1,!this._dp&&this._ts&&(this._start=os(cu.time-(this._ts>0?i/this._ts:(this.totalDuration()-i)/-this._ts))),r.prototype.totalTime.call(this,i,s),this._forcing=0,this):this._tTime},t.addLabel=function(i,s){return this.labels[i]=Hu(this,s),this},t.removeLabel=function(i){return delete this.labels[i],this},t.addPause=function(i,s,a){var o=ks.delayedCall(0,s||h1,a);return o.data="isPause",this._hasPause=1,ed(this,o,Hu(this,i))},t.removePause=function(i){var s=this._first;for(i=Hu(this,i);s;)s._start===i&&s.data==="isPause"&&Em(s),s=s._next},t.killTweensOf=function(i,s,a){for(var o=this.getTweensOf(i,a),l=o.length;l--;)rm!==o[l]&&o[l].kill(i,s);return this},t.getTweensOf=function(i,s){for(var a=[],o=Qu(i),l=this._first,c=Fh(s),d;l;)l instanceof ks?mse(l._targets,o)&&(c?(!rm||l._initted&&l._ts)&&l.globalTime(0)<=s&&l.globalTime(l.totalDuration())>s:!s||l.isActive())&&a.push(l):(d=l.getTweensOf(o,s)).length&&a.push.apply(a,d),l=l._next;return a},t.tweenTo=function(i,s){s=s||{};var a=this,o=Hu(a,i),l=s,c=l.startAt,d=l.onStart,p=l.onStartParams,y=l.immediateRender,_,v=ks.to(a,bu({ease:s.ease||"none",lazy:!1,immediateRender:!1,time:o,overwrite:"auto",duration:s.duration||Math.abs((o-(c&&"time"in c?c.time:a._time))/a.timeScale())||Nr,onStart:function(){if(a.pause(),!_){var E=s.duration||Math.abs((o-(c&&"time"in c?c.time:a._time))/a.timeScale());v._dur!==E&&Mx(v,E,0,1).render(v._time,!0,!0),_=1}d&&d.apply(v,p||[])}},s));return y?v.render(0):v},t.tweenFromTo=function(i,s,a){return this.tweenTo(s,bu({startAt:{time:Hu(this,i)}},a))},t.recent=function(){return this._recent},t.nextLabel=function(i){return i===void 0&&(i=this._time),GV(this,Hu(this,i))},t.previousLabel=function(i){return i===void 0&&(i=this._time),GV(this,Hu(this,i),1)},t.currentLabel=function(i){return arguments.length?this.seek(i,!0):this.previousLabel(this._time+Nr)},t.shiftChildren=function(i,s,a){a===void 0&&(a=0);var o=this._first,l=this.labels,c;for(i=os(i);o;)o._start>=a&&(o._start+=i,o._end+=i),o=o._next;if(s)for(c in l)l[c]>=a&&(l[c]+=i);return N0(this)},t.invalidate=function(i){var s=this._first;for(this._lock=0;s;)s.invalidate(i),s=s._next;return r.prototype.invalidate.call(this,i)},t.clear=function(i){i===void 0&&(i=!0);for(var s=this._first,a;s;)a=s._next,this.remove(s),s=a;return this._dp&&(this._time=this._tTime=this._pTime=0),i&&(this.labels={}),N0(this)},t.totalDuration=function(i){var s=0,a=this,o=a._last,l=Ku,c,d,p;if(arguments.length)return a.timeScale((a._repeat<0?a.duration():a.totalDuration())/(a.reversed()?-i:i));if(a._dirty){for(p=a.parent;o;)c=o._prev,o._dirty&&o.totalDuration(),d=o._start,d>l&&a._sort&&o._ts&&!a._lock?(a._lock=1,ed(a,o,d-o._delay,1)._lock=0):l=d,d<0&&o._ts&&(s-=d,(!p&&!a._dp||p&&p.smoothChildTiming)&&(a._start+=os(d/a._ts),a._time-=d,a._tTime-=d),a.shiftChildren(-d,!1,-1/0),l=0),o._end>s&&o._ts&&(s=o._end),o=c;Mx(a,a===ls&&a._time>s?a._time:s,1,1),a._dirty=0}return a._tDur},e.updateRoot=function(i){if(ls._ts&&(p8(ls,dR(i,ls)),d8=cu.frame),cu.frame>=IV){IV+=gu.autoSleep||120;var s=ls._first;if((!s||!s._ts)&&gu.autoSleep&&cu._listeners.length<2){for(;s&&!s._ts;)s=s._next;s||cu.sleep()}}},e})(g1);bu(tl.prototype,{_lock:0,_hasPause:0,_forcing:0});var Fse=function(e,t,n,i,s,a,o){var l=new Pl(this._pt,e,t,0,1,k8,null,s),c=0,d=0,p,y,_,v,b,E,T,M;for(l.b=n,l.e=i,n+="",i+="",(T=~i.indexOf("random("))&&(i=p1(i)),a&&(M=[n,i],a(M,e,t),n=M[0],i=M[1]),y=n.match(z3)||[];p=z3.exec(i);)v=p[0],b=i.substring(c,p.index),_?_=(_+1)%5:b.substr(-5)==="rgba("&&(_=1),v!==y[d++]&&(E=parseFloat(y[d-1])||0,l._pt={_next:l._pt,p:b||d===1?b:",",s:E,c:v.charAt(1)==="="?kv(E,v)-E:parseFloat(v)-E,m:_&&_<4?Math.round:0},c=z3.lastIndex);return l.c=c<i.length?i.substring(c,i.length):"",l.fp=o,(l8.test(i)||T)&&(l.e=0),this._pt=l,l},dP=function(e,t,n,i,s,a,o,l,c,d){bs(i)&&(i=i(s||0,e,a));var p=e[t],y=n!=="get"?n:bs(p)?c?e[t.indexOf("set")||!bs(e["get"+t.substr(3)])?t:"get"+t.substr(3)](c):e[t]():p,_=bs(p)?c?Hse:V8:pP,v;if(Ea(i)&&(~i.indexOf("random(")&&(i=p1(i)),i.charAt(1)==="="&&(v=kv(y,i)+(uo(y)||0),(v||v===0)&&(i=v))),!d||y!==i||UO)return!isNaN(y*i)&&i!==""?(v=new Pl(this._pt,e,t,+y||0,i-(y||0),typeof p=="boolean"?qse:G8,0,_),c&&(v.fp=c),o&&v.modifier(o,this,e),this._pt=v):(!p&&!(t in e)&&oP(t,i),Fse.call(this,e,t,y,i,_,l||gu.stringFilter,c))},zse=function(e,t,n,i,s){if(bs(e)&&(e=UT(e,s,t,n,i)),!md(e)||e.style&&e.nodeType||vo(e)||a8(e))return Ea(e)?UT(e,s,t,n,i):e;var a={},o;for(o in e)a[o]=UT(e[o],s,t,n,i);return a},I8=function(e,t,n,i,s,a){var o,l,c,d;if(au[e]&&(o=new au[e]).init(s,o.rawVars?t[e]:zse(t[e],i,s,a,n),n,i,a)!==!1&&(n._pt=l=new Pl(n._pt,s,e,0,1,o.render,o,0,o.priority),n!==Bv))for(c=n._ptLookup[n._targets.indexOf(s)],d=o._props.length;d--;)c[o._props[d]]=l;return o},rm,UO,hP=function r(e,t,n){var i=e.vars,s=i.ease,a=i.startAt,o=i.immediateRender,l=i.lazy,c=i.onUpdate,d=i.runBackwards,p=i.yoyoEase,y=i.keyframes,_=i.autoRevert,v=e._dur,b=e._startAt,E=e._targets,T=e.parent,M=T&&T.data==="nested"?T.vars.targets:E,R=e._overwrite==="auto"&&!iP,N=e.timeline,P,U,L,F,O,B,q,j,Q,se,ae,V,X;if(N&&(!y||!s)&&(s="none"),e._ease=D0(s,Sx.ease),e._yEase=p?U8(D0(p===!0?s:p,Sx.ease)):0,p&&e._yoyo&&!e._repeat&&(p=e._yEase,e._yEase=e._ease,e._ease=p),e._from=!N&&!!i.runBackwards,!N||y&&!i.stagger){if(j=E[0]?C0(E[0]).harness:0,V=j&&i[j.prop],P=fR(i,lP),b&&(b._zTime<0&&b.progress(1),t<0&&d&&o&&!_?b.render(-1,!0):b.revert(d&&v?Rw:hse),b._lazy=0),a){if(Em(e._startAt=ks.set(E,bu({data:"isStart",overwrite:!1,parent:T,immediateRender:!0,lazy:!b&&Ul(l),startAt:null,delay:0,onUpdate:c&&function(){return du(e,"onUpdate")},stagger:0},a))),e._startAt._dp=0,e._startAt._sat=e,t<0&&(ka||!o&&!_)&&e._startAt.revert(Rw),o&&v&&t<=0&&n<=0){t&&(e._zTime=t);return}}else if(d&&v&&!b){if(t&&(o=!1),L=bu({overwrite:!1,data:"isFromStart",lazy:o&&!b&&Ul(l),immediateRender:o,stagger:0,parent:T},P),V&&(L[j.prop]=V),Em(e._startAt=ks.set(E,L)),e._startAt._dp=0,e._startAt._sat=e,t<0&&(ka?e._startAt.revert(Rw):e._startAt.render(-1,!0)),e._zTime=t,!o)r(e._startAt,Nr,Nr);else if(!t)return}for(e._pt=e._ptCache=0,l=v&&Ul(l)||l&&!v,U=0;U<E.length;U++){if(O=E[U],q=O._gsap||cP(E)[U]._gsap,e._ptLookup[U]=se={},wO[q.id]&&hm.length&&cR(),ae=M===E?U:M.indexOf(O),j&&(Q=new j).init(O,V||P,e,ae,M)!==!1&&(e._pt=F=new Pl(e._pt,O,Q.name,0,1,Q.render,Q,0,Q.priority),Q._props.forEach(function(ee){se[ee]=F}),Q.priority&&(B=1)),!j||V)for(L in P)au[L]&&(Q=I8(L,P,e,ae,O,M))?Q.priority&&(B=1):se[L]=F=dP.call(e,O,L,"get",P[L],ae,M,0,i.stringFilter);e._op&&e._op[U]&&e.kill(O,e._op[U]),R&&e._pt&&(rm=e,ls.killTweensOf(O,se,e.globalTime(t)),X=!e.parent,rm=0),e._pt&&l&&(wO[q.id]=1)}B&&H8(e),e._onInit&&e._onInit(e)}e._onUpdate=c,e._initted=(!e._op||e._pt)&&!X,y&&t<=0&&N.render(Ku,!0,!0)},Vse=function(e,t,n,i,s,a,o,l){var c=(e._pt&&e._ptCache||(e._ptCache={}))[t],d,p,y,_;if(!c)for(c=e._ptCache[t]=[],y=e._ptLookup,_=e._targets.length;_--;){if(d=y[_][t],d&&d.d&&d.d._pt)for(d=d.d._pt;d&&d.p!==t&&d.fp!==t;)d=d._next;if(!d)return UO=1,e.vars[t]="+=0",hP(e,o),UO=0,l?d1(t+" not eligible for reset"):1;c.push(d)}for(_=c.length;_--;)p=c[_],d=p._pt||p,d.s=(i||i===0)&&!s?i:d.s+(i||0)+a*d.c,d.c=n-d.s,p.e&&(p.e=ws(n)+uo(p.e)),p.b&&(p.b=d.s+uo(p.b))},Gse=function(e,t){var n=e[0]?C0(e[0]).harness:0,i=n&&n.aliases,s,a,o,l;if(!i)return t;s=Tx({},t);for(a in i)if(a in s)for(l=i[a].split(","),o=l.length;o--;)s[l[o]]=s[a];return s},kse=function(e,t,n,i){var s=t.ease||i||"power1.inOut",a,o;if(vo(t))o=n[e]||(n[e]=[]),t.forEach(function(l,c){return o.push({t:c/(t.length-1)*100,v:l,e:s})});else for(a in t)o=n[a]||(n[a]=[]),a==="ease"||o.push({t:parseFloat(e),v:t[a],e:s})},UT=function(e,t,n,i,s){return bs(e)?e.call(t,n,i,s):Ea(e)&&~e.indexOf("random(")?p1(e):e},F8=uP+"repeat,repeatDelay,yoyo,repeatRefresh,yoyoEase,autoRevert",z8={};Ll(F8+",id,stagger,delay,duration,paused,scrollTrigger",function(r){return z8[r]=1});var ks=(function(r){r8(e,r);function e(n,i,s,a){var o;typeof i=="number"&&(s.duration=i,i=s,s=null),o=r.call(this,a?i:DT(i))||this;var l=o.vars,c=l.duration,d=l.delay,p=l.immediateRender,y=l.stagger,_=l.overwrite,v=l.keyframes,b=l.defaults,E=l.scrollTrigger,T=l.yoyoEase,M=i.parent||ls,R=(vo(n)||a8(n)?Fh(n[0]):"length"in i)?[n]:Qu(n),N,P,U,L,F,O,B,q;if(o._targets=R.length?cP(R):d1("GSAP target "+n+" not found. https://gsap.com",!gu.nullTargetWarn)||[],o._ptLookup=[],o._overwrite=_,v||y||DA(c)||DA(d)){if(i=o.vars,N=o.timeline=new tl({data:"nested",defaults:b||{},targets:M&&M.data==="nested"?M.vars.targets:R}),N.kill(),N.parent=N._dp=lh(o),N._start=0,y||DA(c)||DA(d)){if(L=R.length,B=y&&T8(y),md(y))for(F in y)~F8.indexOf(F)&&(q||(q={}),q[F]=y[F]);for(P=0;P<L;P++)U=fR(i,z8),U.stagger=0,T&&(U.yoyoEase=T),q&&Tx(U,q),O=R[P],U.duration=+UT(c,lh(o),P,O,R),U.delay=(+UT(d,lh(o),P,O,R)||0)-o._delay,!y&&L===1&&U.delay&&(o._delay=d=U.delay,o._start+=d,U.delay=0),N.to(O,U,B?B(P,O,R):0),N._ease=Pi.none;N.duration()?c=d=0:o.timeline=0}else if(v){DT(bu(N.vars.defaults,{ease:"none"})),N._ease=D0(v.ease||i.ease||"none");var j=0,Q,se,ae;if(vo(v))v.forEach(function(V){return N.to(R,V,">")}),N.duration();else{U={};for(F in v)F==="ease"||F==="easeEach"||kse(F,v[F],U,v.easeEach);for(F in U)for(Q=U[F].sort(function(V,X){return V.t-X.t}),j=0,P=0;P<Q.length;P++)se=Q[P],ae={ease:se.e,duration:(se.t-(P?Q[P-1].t:0))/100*c},ae[F]=se.v,N.to(R,ae,j),j+=ae.duration;N.duration()<c&&N.to({},{duration:c-N.duration()})}}c||o.duration(c=N.duration())}else o.timeline=0;return _===!0&&!iP&&(rm=lh(o),ls.killTweensOf(R),rm=0),ed(M,lh(o),s),i.reversed&&o.reverse(),i.paused&&o.paused(!0),(p||!c&&!v&&o._start===os(M._time)&&Ul(p)&&vse(lh(o))&&M.data!=="nested")&&(o._tTime=-Nr,o.render(Math.max(0,-d)||0)),E&&v8(lh(o),E),o}var t=e.prototype;return t.render=function(i,s,a){var o=this._time,l=this._tDur,c=this._dur,d=i<0,p=i>l-Nr&&!d?l:i<Nr?0:i,y,_,v,b,E,T,M,R,N;if(!c)bse(this,i,s,a);else if(p!==this._tTime||!i||a||!this._initted&&this._tTime||this._startAt&&this._zTime<0!==d||this._lazy){if(y=p,R=this.timeline,this._repeat){if(b=c+this._rDelay,this._repeat<-1&&d)return this.totalTime(b*100+i,s,a);if(y=os(p%b),p===l?(v=this._repeat,y=c):(E=os(p/b),v=~~E,v&&v===E?(y=c,v--):y>c&&(y=c)),T=this._yoyo&&v&1,T&&(N=this._yEase,y=c-y),E=Ex(this._tTime,b),y===o&&!a&&this._initted&&v===E)return this._tTime=p,this;v!==E&&(R&&this._yEase&&L8(R,T),this.vars.repeatRefresh&&!T&&!this._lock&&y!==b&&this._initted&&(this._lock=a=1,this.render(os(b*v),!0).invalidate()._lock=0))}if(!this._initted){if(x8(this,d?i:y,a,s,p))return this._tTime=0,this;if(o!==this._time&&!(a&&this.vars.repeatRefresh&&v!==E))return this;if(c!==this._dur)return this.render(i,s,a)}if(this._tTime=p,this._time=y,!this._act&&this._ts&&(this._act=1,this._lazy=0),this.ratio=M=(N||this._ease)(y/c),this._from&&(this.ratio=M=1-M),!o&&p&&!s&&!E&&(du(this,"onStart"),this._tTime!==p))return this;for(_=this._pt;_;)_.r(M,_.d),_=_._next;R&&R.render(i<0?i:R._dur*R._ease(y/this._dur),s,a)||this._startAt&&(this._zTime=i),this._onUpdate&&!s&&(d&&RO(this,i,s,a),du(this,"onUpdate")),this._repeat&&v!==E&&this.vars.onRepeat&&!s&&this.parent&&du(this,"onRepeat"),(p===this._tDur||!p)&&this._tTime===p&&(d&&!this._onUpdate&&RO(this,i,!0,!0),(i||!c)&&(p===this._tDur&&this._ts>0||!p&&this._ts<0)&&Em(this,1),!s&&!(d&&!o)&&(p||o||T)&&(du(this,p===l?"onComplete":"onReverseComplete",!0),this._prom&&!(p<l&&this.timeScale()>0)&&this._prom()))}return this},t.targets=function(){return this._targets},t.invalidate=function(i){return(!i||!this.vars.runBackwards)&&(this._startAt=0),this._pt=this._op=this._onUpdate=this._lazy=this.ratio=0,this._ptLookup=[],this.timeline&&this.timeline.invalidate(i),r.prototype.invalidate.call(this,i)},t.resetTo=function(i,s,a,o,l){m1||cu.wake(),this._ts||this.play();var c=Math.min(this._dur,(this._dp._time-this._start)*this._ts),d;return this._initted||hP(this,c),d=this._ease(c/this._dur),Vse(this,i,s,a,o,d,c,l)?this.resetTo(i,s,a,o,1):(QC(this,0),this.parent||y8(this._dp,this,"_first","_last",this._dp._sort?"_start":0),this.render(0))},t.kill=function(i,s){if(s===void 0&&(s="all"),!i&&(!s||s==="all"))return this._lazy=this._pt=0,this.parent?pT(this):this.scrollTrigger&&this.scrollTrigger.kill(!!ka),this;if(this.timeline){var a=this.timeline.totalDuration();return this.timeline.killTweensOf(i,s,rm&&rm.vars.overwrite!==!0)._first||pT(this),this.parent&&a!==this.timeline.totalDuration()&&Mx(this,this._dur*this.timeline._tDur/a,0,1),this}var o=this._targets,l=i?Qu(i):o,c=this._ptLookup,d=this._pt,p,y,_,v,b,E,T;if((!s||s==="all")&&yse(o,l))return s==="all"&&(this._pt=0),pT(this);for(p=this._op=this._op||[],s!=="all"&&(Ea(s)&&(b={},Ll(s,function(M){return b[M]=1}),s=b),s=Gse(o,s)),T=o.length;T--;)if(~l.indexOf(o[T])){y=c[T],s==="all"?(p[T]=s,v=y,_={}):(_=p[T]=p[T]||{},v=s);for(b in v)E=y&&y[b],E&&((!("kill"in E.d)||E.d.kill(b)===!0)&&ZC(this,E,"_pt"),delete y[b]),_!=="all"&&(_[b]=1)}return this._initted&&!this._pt&&d&&pT(this),this},e.to=function(i,s){return new e(i,s,arguments[2])},e.from=function(i,s){return OT(1,arguments)},e.delayedCall=function(i,s,a,o){return new e(s,0,{immediateRender:!1,lazy:!1,overwrite:!1,delay:i,onComplete:s,onReverseComplete:s,onCompleteParams:a,onReverseCompleteParams:a,callbackScope:o})},e.fromTo=function(i,s,a){return OT(2,arguments)},e.set=function(i,s){return s.duration=0,s.repeatDelay||(s.repeat=0),new e(i,s)},e.killTweensOf=function(i,s,a){return ls.killTweensOf(i,s,a)},e})(g1);bu(ks.prototype,{_targets:[],_lazy:0,_startAt:0,_op:0,_onInit:0});Ll("staggerTo,staggerFrom,staggerFromTo",function(r){ks[r]=function(){var e=new tl,t=NO.call(arguments,0);return t.splice(r==="staggerFromTo"?5:4,0,0),e[r].apply(e,t)}});var pP=function(e,t,n){return e[t]=n},V8=function(e,t,n){return e[t](n)},Hse=function(e,t,n,i){return e[t](i.fp,n)},Wse=function(e,t,n){return e.setAttribute(t,n)},mP=function(e,t){return bs(e[t])?V8:rP(e[t])&&e.setAttribute?Wse:pP},G8=function(e,t){return t.set(t.t,t.p,Math.round((t.s+t.c*e)*1e6)/1e6,t)},qse=function(e,t){return t.set(t.t,t.p,!!(t.s+t.c*e),t)},k8=function(e,t){var n=t._pt,i="";if(!e&&t.b)i=t.b;else if(e===1&&t.e)i=t.e;else{for(;n;)i=n.p+(n.m?n.m(n.s+n.c*e):Math.round((n.s+n.c*e)*1e4)/1e4)+i,n=n._next;i+=t.c}t.set(t.t,t.p,i,t)},gP=function(e,t){for(var n=t._pt;n;)n.r(e,n.d),n=n._next},Xse=function(e,t,n,i){for(var s=this._pt,a;s;)a=s._next,s.p===i&&s.modifier(e,t,n),s=a},$se=function(e){for(var t=this._pt,n,i;t;)i=t._next,t.p===e&&!t.op||t.op===e?ZC(this,t,"_pt"):t.dep||(n=1),t=i;return!n},jse=function(e,t,n,i){i.mSet(e,t,i.m.call(i.tween,n,i.mt),i)},H8=function(e){for(var t=e._pt,n,i,s,a;t;){for(n=t._next,i=s;i&&i.pr>t.pr;)i=i._next;(t._prev=i?i._prev:a)?t._prev._next=t:s=t,(t._next=i)?i._prev=t:a=t,t=n}e._pt=s},Pl=(function(){function r(t,n,i,s,a,o,l,c,d){this.t=n,this.s=s,this.c=a,this.p=i,this.r=o||G8,this.d=l||this,this.set=c||pP,this.pr=d||0,this._next=t,t&&(t._prev=this)}var e=r.prototype;return e.modifier=function(n,i,s){this.mSet=this.mSet||this.set,this.set=jse,this.m=n,this.mt=s,this.tween=i},r})();Ll(uP+"parent,duration,ease,delay,overwrite,runBackwards,startAt,yoyo,immediateRender,repeat,repeatDelay,data,paused,reversed,lazy,callbackScope,stringFilter,id,yoyoEase,stagger,inherit,repeatRefresh,keyframes,autoRevert,scrollTrigger",function(r){return lP[r]=1});xu.TweenMax=xu.TweenLite=ks;xu.TimelineLite=xu.TimelineMax=tl;ls=new tl({sortChildren:!1,defaults:Sx,autoRemoveChildren:!0,id:"root",smoothChildTiming:!0});gu.stringFilter=O8;var O0=[],Nw={},Yse=[],HV=0,Zse=0,W3=function(e){return(Nw[e]||Yse).map(function(t){return t()})},LO=function(){var e=Date.now(),t=[];e-HV>2&&(W3("matchMediaInit"),O0.forEach(function(n){var i=n.queries,s=n.conditions,a,o,l,c;for(o in i)a=Zf.matchMedia(i[o]).matches,a&&(l=1),a!==s[o]&&(s[o]=a,c=1);c&&(n.revert(),l&&t.push(n))}),W3("matchMediaRevert"),t.forEach(function(n){return n.onMatch(n,function(i){return n.add(null,i)})}),HV=e,W3("matchMedia"))},W8=(function(){function r(t,n){this.selector=n&&DO(n),this.data=[],this._r=[],this.isReverted=!1,this.id=Zse++,t&&this.add(t)}var e=r.prototype;return e.add=function(n,i,s){bs(n)&&(s=i,i=n,n=bs);var a=this,o=function(){var c=jr,d=a.selector,p;return c&&c!==a&&c.data.push(a),s&&(a.selector=DO(s)),jr=a,p=i.apply(a,arguments),bs(p)&&a._r.push(p),jr=c,a.selector=d,a.isReverted=!1,p};return a.last=o,n===bs?o(a,function(l){return a.add(null,l)}):n?a[n]=o:o},e.ignore=function(n){var i=jr;jr=null,n(this),jr=i},e.getTweens=function(){var n=[];return this.data.forEach(function(i){return i instanceof r?n.push.apply(n,i.getTweens()):i instanceof ks&&!(i.parent&&i.parent.data==="nested")&&n.push(i)}),n},e.clear=function(){this._r.length=this.data.length=0},e.kill=function(n,i){var s=this;if(n?(function(){for(var o=s.getTweens(),l=s.data.length,c;l--;)c=s.data[l],c.data==="isFlip"&&(c.revert(),c.getChildren(!0,!0,!1).forEach(function(d){return o.splice(o.indexOf(d),1)}));for(o.map(function(d){return{g:d._dur||d._delay||d._sat&&!d._sat.vars.immediateRender?d.globalTime(0):-1/0,t:d}}).sort(function(d,p){return p.g-d.g||-1/0}).forEach(function(d){return d.t.revert(n)}),l=s.data.length;l--;)c=s.data[l],c instanceof tl?c.data!=="nested"&&(c.scrollTrigger&&c.scrollTrigger.revert(),c.kill()):!(c instanceof ks)&&c.revert&&c.revert(n);s._r.forEach(function(d){return d(n,s)}),s.isReverted=!0})():this.data.forEach(function(o){return o.kill&&o.kill()}),this.clear(),i)for(var a=O0.length;a--;)O0[a].id===this.id&&O0.splice(a,1)},e.revert=function(n){this.kill(n||{})},r})(),Kse=(function(){function r(t){this.contexts=[],this.scope=t,jr&&jr.data.push(this)}var e=r.prototype;return e.add=function(n,i,s){md(n)||(n={matches:n});var a=new W8(0,s||this.scope),o=a.conditions={},l,c,d;jr&&!a.selector&&(a.selector=jr.selector),this.contexts.push(a),i=a.add("onMatch",i),a.queries=n;for(c in n)c==="all"?d=1:(l=Zf.matchMedia(n[c]),l&&(O0.indexOf(a)<0&&O0.push(a),(o[c]=l.matches)&&(d=1),l.addListener?l.addListener(LO):l.addEventListener("change",LO)));return d&&i(a,function(p){return a.add(null,p)}),this},e.revert=function(n){this.kill(n||{})},e.kill=function(n){this.contexts.forEach(function(i){return i.kill(n,!0)})},r})(),hR={registerPlugin:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];t.forEach(function(i){return C8(i)})},timeline:function(e){return new tl(e)},getTweensOf:function(e,t){return ls.getTweensOf(e,t)},getProperty:function(e,t,n,i){Ea(e)&&(e=Qu(e)[0]);var s=C0(e||{}).get,a=n?g8:m8;return n==="native"&&(n=""),e&&(t?a((au[t]&&au[t].get||s)(e,t,n,i)):function(o,l,c){return a((au[o]&&au[o].get||s)(e,o,l,c))})},quickSetter:function(e,t,n){if(e=Qu(e),e.length>1){var i=e.map(function(d){return Fl.quickSetter(d,t,n)}),s=i.length;return function(d){for(var p=s;p--;)i[p](d)}}e=e[0]||{};var a=au[t],o=C0(e),l=o.harness&&(o.harness.aliases||{})[t]||t,c=a?function(d){var p=new a;Bv._pt=0,p.init(e,n?d+n:d,Bv,0,[e]),p.render(1,p),Bv._pt&&gP(1,Bv)}:o.set(e,l);return a?c:function(d){return c(e,l,n?d+n:d,o,1)}},quickTo:function(e,t,n){var i,s=Fl.to(e,bu((i={},i[t]="+=0.1",i.paused=!0,i.stagger=0,i),n||{})),a=function(l,c,d){return s.resetTo(t,l,c,d)};return a.tween=s,a},isTweening:function(e){return ls.getTweensOf(e,!0).length>0},defaults:function(e){return e&&e.ease&&(e.ease=D0(e.ease,Sx.ease)),FV(Sx,e||{})},config:function(e){return FV(gu,e||{})},registerEffect:function(e){var t=e.name,n=e.effect,i=e.plugins,s=e.defaults,a=e.extendTimeline;(i||"").split(",").forEach(function(o){return o&&!au[o]&&!xu[o]&&d1(t+" effect requires "+o+" plugin.")}),V3[t]=function(o,l,c){return n(Qu(o),bu(l||{},s),c)},a&&(tl.prototype[t]=function(o,l,c){return this.add(V3[t](o,md(l)?l:(c=l)&&{},this),c)})},registerEase:function(e,t){Pi[e]=D0(t)},parseEase:function(e,t){return arguments.length?D0(e,t):Pi},getById:function(e){return ls.getById(e)},exportRoot:function(e,t){e===void 0&&(e={});var n=new tl(e),i,s;for(n.smoothChildTiming=Ul(e.smoothChildTiming),ls.remove(n),n._dp=0,n._time=n._tTime=ls._time,i=ls._first;i;)s=i._next,(t||!(!i._dur&&i instanceof ks&&i.vars.onComplete===i._targets[0]))&&ed(n,i,i._start-i._delay),i=s;return ed(ls,n,0),n},context:function(e,t){return e?new W8(e,t):jr},matchMedia:function(e){return new Kse(e)},matchMediaRefresh:function(){return O0.forEach(function(e){var t=e.conditions,n,i;for(i in t)t[i]&&(t[i]=!1,n=1);n&&e.revert()})||LO()},addEventListener:function(e,t){var n=Nw[e]||(Nw[e]=[]);~n.indexOf(t)||n.push(t)},removeEventListener:function(e,t){var n=Nw[e],i=n&&n.indexOf(t);i>=0&&n.splice(i,1)},utils:{wrap:Cse,wrapYoyo:Nse,distribute:T8,random:M8,snap:E8,normalize:Rse,getUnit:uo,clamp:Ese,splitColor:N8,toArray:Qu,selector:DO,mapRange:w8,pipe:Ase,unitize:wse,interpolate:Dse,shuffle:S8},install:c8,effects:V3,ticker:cu,updateRoot:tl.updateRoot,plugins:au,globalTimeline:ls,core:{PropTween:Pl,globals:f8,Tween:ks,Timeline:tl,Animation:g1,getCache:C0,_removeLinkedListItem:ZC,reverting:function(){return ka},context:function(e){return e&&jr&&(jr.data.push(e),e._ctx=jr),jr},suppressOverwrites:function(e){return iP=e}}};Ll("to,from,fromTo,delayedCall,set,killTweensOf",function(r){return hR[r]=ks[r]});cu.add(tl.updateRoot);Bv=hR.to({},{duration:0});var Qse=function(e,t){for(var n=e._pt;n&&n.p!==t&&n.op!==t&&n.fp!==t;)n=n._next;return n},Jse=function(e,t){var n=e._targets,i,s,a;for(i in t)for(s=n.length;s--;)a=e._ptLookup[s][i],a&&(a=a.d)&&(a._pt&&(a=Qse(a,i)),a&&a.modifier&&a.modifier(t[i],e,n[s],i))},q3=function(e,t){return{name:e,headless:1,rawVars:1,init:function(i,s,a){a._onInit=function(o){var l,c;if(Ea(s)&&(l={},Ll(s,function(d){return l[d]=1}),s=l),t){l={};for(c in s)l[c]=t(s[c]);s=l}Jse(o,s)}}}},Fl=hR.registerPlugin({name:"attr",init:function(e,t,n,i,s){var a,o,l;this.tween=n;for(a in t)l=e.getAttribute(a)||"",o=this.add(e,"setAttribute",(l||0)+"",t[a],i,s,0,0,a),o.op=a,o.b=l,this._props.push(a)},render:function(e,t){for(var n=t._pt;n;)ka?n.set(n.t,n.p,n.b,n):n.r(e,n.d),n=n._next}},{name:"endArray",headless:1,init:function(e,t){for(var n=t.length;n--;)this.add(e,n,e[n]||0,t[n],0,0,0,0,0,1)}},q3("roundProps",OO),q3("modifiers"),q3("snap",E8))||hR;ks.version=tl.version=Fl.version="3.14.2";u8=1;sP()&&Ax();Pi.Power0;Pi.Power1;Pi.Power2;Pi.Power3;Pi.Power4;Pi.Linear;Pi.Quad;Pi.Cubic;Pi.Quart;Pi.Quint;Pi.Strong;Pi.Elastic;Pi.Back;Pi.SteppedEase;Pi.Bounce;Pi.Sine;Pi.Expo;Pi.Circ;var WV,sm,Hv,yP,_0,qV,_P,eae=function(){return typeof window<"u"},zh={},a0=180/Math.PI,Wv=Math.PI/180,pv=Math.atan2,XV=1e8,vP=/([A-Z])/g,tae=/(left|right|width|margin|padding|x)/i,nae=/[\s,\(]\S/,id={autoAlpha:"opacity,visibility",scale:"scaleX,scaleY",alpha:"opacity"},PO=function(e,t){return t.set(t.t,t.p,Math.round((t.s+t.c*e)*1e4)/1e4+t.u,t)},iae=function(e,t){return t.set(t.t,t.p,e===1?t.e:Math.round((t.s+t.c*e)*1e4)/1e4+t.u,t)},rae=function(e,t){return t.set(t.t,t.p,e?Math.round((t.s+t.c*e)*1e4)/1e4+t.u:t.b,t)},sae=function(e,t){return t.set(t.t,t.p,e===1?t.e:e?Math.round((t.s+t.c*e)*1e4)/1e4+t.u:t.b,t)},aae=function(e,t){var n=t.s+t.c*e;t.set(t.t,t.p,~~(n+(n<0?-.5:.5))+t.u,t)},q8=function(e,t){return t.set(t.t,t.p,e?t.e:t.b,t)},X8=function(e,t){return t.set(t.t,t.p,e!==1?t.b:t.e,t)},oae=function(e,t,n){return e.style[t]=n},lae=function(e,t,n){return e.style.setProperty(t,n)},uae=function(e,t,n){return e._gsap[t]=n},cae=function(e,t,n){return e._gsap.scaleX=e._gsap.scaleY=n},fae=function(e,t,n,i,s){var a=e._gsap;a.scaleX=a.scaleY=n,a.renderTransform(s,a)},dae=function(e,t,n,i,s){var a=e._gsap;a[t]=n,a.renderTransform(s,a)},cs="transform",Bl=cs+"Origin",hae=function r(e,t){var n=this,i=this.target,s=i.style,a=i._gsap;if(e in zh&&s){if(this.tfm=this.tfm||{},e!=="transform")e=id[e]||e,~e.indexOf(",")?e.split(",").forEach(function(o){return n.tfm[o]=uh(i,o)}):this.tfm[e]=a.x?a[e]:uh(i,e),e===Bl&&(this.tfm.zOrigin=a.zOrigin);else return id.transform.split(",").forEach(function(o){return r.call(n,o,t)});if(this.props.indexOf(cs)>=0)return;a.svg&&(this.svgo=i.getAttribute("data-svg-origin"),this.props.push(Bl,t,"")),e=cs}(s||t)&&this.props.push(e,t,s[e])},$8=function(e){e.translate&&(e.removeProperty("translate"),e.removeProperty("scale"),e.removeProperty("rotate"))},pae=function(){var e=this.props,t=this.target,n=t.style,i=t._gsap,s,a;for(s=0;s<e.length;s+=3)e[s+1]?e[s+1]===2?t[e[s]](e[s+2]):t[e[s]]=e[s+2]:e[s+2]?n[e[s]]=e[s+2]:n.removeProperty(e[s].substr(0,2)==="--"?e[s]:e[s].replace(vP,"-$1").toLowerCase());if(this.tfm){for(a in this.tfm)i[a]=this.tfm[a];i.svg&&(i.renderTransform(),t.setAttribute("data-svg-origin",this.svgo||"")),s=_P(),(!s||!s.isStart)&&!n[cs]&&($8(n),i.zOrigin&&n[Bl]&&(n[Bl]+=" "+i.zOrigin+"px",i.zOrigin=0,i.renderTransform()),i.uncache=1)}},j8=function(e,t){var n={target:e,props:[],revert:pae,save:hae};return e._gsap||Fl.core.getCache(e),t&&e.style&&e.nodeType&&t.split(",").forEach(function(i){return n.save(i)}),n},Y8,BO=function(e,t){var n=sm.createElementNS?sm.createElementNS((t||"http://www.w3.org/1999/xhtml").replace(/^https/,"http"),e):sm.createElement(e);return n&&n.style?n:sm.createElement(e)},hu=function r(e,t,n){var i=getComputedStyle(e);return i[t]||i.getPropertyValue(t.replace(vP,"-$1").toLowerCase())||i.getPropertyValue(t)||!n&&r(e,wx(t)||t,1)||""},$V="O,Moz,ms,Ms,Webkit".split(","),wx=function(e,t,n){var i=t||_0,s=i.style,a=5;if(e in s&&!n)return e;for(e=e.charAt(0).toUpperCase()+e.substr(1);a--&&!($V[a]+e in s););return a<0?null:(a===3?"ms":a>=0?$V[a]:"")+e},IO=function(){eae()&&window.document&&(WV=window,sm=WV.document,Hv=sm.documentElement,_0=BO("div")||{style:{}},BO("div"),cs=wx(cs),Bl=cs+"Origin",_0.style.cssText="border-width:0;line-height:0;position:absolute;padding:0",Y8=!!wx("perspective"),_P=Fl.core.reverting,yP=1)},jV=function(e){var t=e.ownerSVGElement,n=BO("svg",t&&t.getAttribute("xmlns")||"http://www.w3.org/2000/svg"),i=e.cloneNode(!0),s;i.style.display="block",n.appendChild(i),Hv.appendChild(n);try{s=i.getBBox()}catch{}return n.removeChild(i),Hv.removeChild(n),s},YV=function(e,t){for(var n=t.length;n--;)if(e.hasAttribute(t[n]))return e.getAttribute(t[n])},Z8=function(e){var t,n;try{t=e.getBBox()}catch{t=jV(e),n=1}return t&&(t.width||t.height)||n||(t=jV(e)),t&&!t.width&&!t.x&&!t.y?{x:+YV(e,["x","cx","x1"])||0,y:+YV(e,["y","cy","y1"])||0,width:0,height:0}:t},K8=function(e){return!!(e.getCTM&&(!e.parentNode||e.ownerSVGElement)&&Z8(e))},Mm=function(e,t){if(t){var n=e.style,i;t in zh&&t!==Bl&&(t=cs),n.removeProperty?(i=t.substr(0,2),(i==="ms"||t.substr(0,6)==="webkit")&&(t="-"+t),n.removeProperty(i==="--"?t:t.replace(vP,"-$1").toLowerCase())):n.removeAttribute(t)}},am=function(e,t,n,i,s,a){var o=new Pl(e._pt,t,n,0,1,a?X8:q8);return e._pt=o,o.b=i,o.e=s,e._props.push(n),o},ZV={deg:1,rad:1,turn:1},mae={grid:1,flex:1},Am=function r(e,t,n,i){var s=parseFloat(n)||0,a=(n+"").trim().substr((s+"").length)||"px",o=_0.style,l=tae.test(t),c=e.tagName.toLowerCase()==="svg",d=(c?"client":"offset")+(l?"Width":"Height"),p=100,y=i==="px",_=i==="%",v,b,E,T;if(i===a||!s||ZV[i]||ZV[a])return s;if(a!=="px"&&!y&&(s=r(e,t,n,"px")),T=e.getCTM&&K8(e),(_||a==="%")&&(zh[t]||~t.indexOf("adius")))return v=T?e.getBBox()[l?"width":"height"]:e[d],ws(_?s/v*p:s/100*v);if(o[l?"width":"height"]=p+(y?a:i),b=i!=="rem"&&~t.indexOf("adius")||i==="em"&&e.appendChild&&!c?e:e.parentNode,T&&(b=(e.ownerSVGElement||{}).parentNode),(!b||b===sm||!b.appendChild)&&(b=sm.body),E=b._gsap,E&&_&&E.width&&l&&E.time===cu.time&&!E.uncache)return ws(s/E.width*p);if(_&&(t==="height"||t==="width")){var M=e.style[t];e.style[t]=p+i,v=e[d],M?e.style[t]=M:Mm(e,t)}else(_||a==="%")&&!mae[hu(b,"display")]&&(o.position=hu(e,"position")),b===e&&(o.position="static"),b.appendChild(_0),v=_0[d],b.removeChild(_0),o.position="absolute";return l&&_&&(E=C0(b),E.time=cu.time,E.width=b[d]),ws(y?v*s/p:v&&s?p/v*s:0)},uh=function(e,t,n,i){var s;return yP||IO(),t in id&&t!=="transform"&&(t=id[t],~t.indexOf(",")&&(t=t.split(",")[0])),zh[t]&&t!=="transform"?(s=_1(e,i),s=t!=="transformOrigin"?s[t]:s.svg?s.origin:mR(hu(e,Bl))+" "+s.zOrigin+"px"):(s=e.style[t],(!s||s==="auto"||i||~(s+"").indexOf("calc("))&&(s=pR[t]&&pR[t](e,t,n)||hu(e,t)||h8(e,t)||(t==="opacity"?1:0))),n&&!~(s+"").trim().indexOf(" ")?Am(e,t,s,n)+n:s},gae=function(e,t,n,i){if(!n||n==="none"){var s=wx(t,e,1),a=s&&hu(e,s,1);a&&a!==n?(t=s,n=a):t==="borderColor"&&(n=hu(e,"borderTopColor"))}var o=new Pl(this._pt,e.style,t,0,1,k8),l=0,c=0,d,p,y,_,v,b,E,T,M,R,N,P;if(o.b=n,o.e=i,n+="",i+="",i.substring(0,6)==="var(--"&&(i=hu(e,i.substring(4,i.indexOf(")")))),i==="auto"&&(b=e.style[t],e.style[t]=i,i=hu(e,t)||i,b?e.style[t]=b:Mm(e,t)),d=[n,i],O8(d),n=d[0],i=d[1],y=n.match(Pv)||[],P=i.match(Pv)||[],P.length){for(;p=Pv.exec(i);)E=p[0],M=i.substring(l,p.index),v?v=(v+1)%5:(M.substr(-5)==="rgba("||M.substr(-5)==="hsla(")&&(v=1),E!==(b=y[c++]||"")&&(_=parseFloat(b)||0,N=b.substr((_+"").length),E.charAt(1)==="="&&(E=kv(_,E)+N),T=parseFloat(E),R=E.substr((T+"").length),l=Pv.lastIndex-R.length,R||(R=R||gu.units[t]||N,l===i.length&&(i+=R,o.e+=R)),N!==R&&(_=Am(e,t,b,R)||0),o._pt={_next:o._pt,p:M||c===1?M:",",s:_,c:T-_,m:v&&v<4||t==="zIndex"?Math.round:0});o.c=l<i.length?i.substring(l,i.length):""}else o.r=t==="display"&&i==="none"?X8:q8;return l8.test(i)&&(o.e=0),this._pt=o,o},KV={top:"0%",bottom:"100%",left:"0%",right:"100%",center:"50%"},yae=function(e){var t=e.split(" "),n=t[0],i=t[1]||"50%";return(n==="top"||n==="bottom"||i==="left"||i==="right")&&(e=n,n=i,i=e),t[0]=KV[n]||n,t[1]=KV[i]||i,t.join(" ")},_ae=function(e,t){if(t.tween&&t.tween._time===t.tween._dur){var n=t.t,i=n.style,s=t.u,a=n._gsap,o,l,c;if(s==="all"||s===!0)i.cssText="",l=1;else for(s=s.split(","),c=s.length;--c>-1;)o=s[c],zh[o]&&(l=1,o=o==="transformOrigin"?Bl:cs),Mm(n,o);l&&(Mm(n,cs),a&&(a.svg&&n.removeAttribute("transform"),i.scale=i.rotate=i.translate="none",_1(n,1),a.uncache=1,$8(i)))}},pR={clearProps:function(e,t,n,i,s){if(s.data!=="isFromStart"){var a=e._pt=new Pl(e._pt,t,n,0,0,_ae);return a.u=i,a.pr=-10,a.tween=s,e._props.push(n),1}}},y1=[1,0,0,1,0,0],Q8={},J8=function(e){return e==="matrix(1, 0, 0, 1, 0, 0)"||e==="none"||!e},QV=function(e){var t=hu(e,cs);return J8(t)?y1:t.substr(7).match(o8).map(ws)},xP=function(e,t){var n=e._gsap||C0(e),i=e.style,s=QV(e),a,o,l,c;return n.svg&&e.getAttribute("transform")?(l=e.transform.baseVal.consolidate().matrix,s=[l.a,l.b,l.c,l.d,l.e,l.f],s.join(",")==="1,0,0,1,0,0"?y1:s):(s===y1&&!e.offsetParent&&e!==Hv&&!n.svg&&(l=i.display,i.display="block",a=e.parentNode,(!a||!e.offsetParent&&!e.getBoundingClientRect().width)&&(c=1,o=e.nextElementSibling,Hv.appendChild(e)),s=QV(e),l?i.display=l:Mm(e,"display"),c&&(o?a.insertBefore(e,o):a?a.appendChild(e):Hv.removeChild(e))),t&&s.length>6?[s[0],s[1],s[4],s[5],s[12],s[13]]:s)},FO=function(e,t,n,i,s,a){var o=e._gsap,l=s||xP(e,!0),c=o.xOrigin||0,d=o.yOrigin||0,p=o.xOffset||0,y=o.yOffset||0,_=l[0],v=l[1],b=l[2],E=l[3],T=l[4],M=l[5],R=t.split(" "),N=parseFloat(R[0])||0,P=parseFloat(R[1])||0,U,L,F,O;n?l!==y1&&(L=_*E-v*b)&&(F=N*(E/L)+P*(-b/L)+(b*M-E*T)/L,O=N*(-v/L)+P*(_/L)-(_*M-v*T)/L,N=F,P=O):(U=Z8(e),N=U.x+(~R[0].indexOf("%")?N/100*U.width:N),P=U.y+(~(R[1]||R[0]).indexOf("%")?P/100*U.height:P)),i||i!==!1&&o.smooth?(T=N-c,M=P-d,o.xOffset=p+(T*_+M*b)-T,o.yOffset=y+(T*v+M*E)-M):o.xOffset=o.yOffset=0,o.xOrigin=N,o.yOrigin=P,o.smooth=!!i,o.origin=t,o.originIsAbsolute=!!n,e.style[Bl]="0px 0px",a&&(am(a,o,"xOrigin",c,N),am(a,o,"yOrigin",d,P),am(a,o,"xOffset",p,o.xOffset),am(a,o,"yOffset",y,o.yOffset)),e.setAttribute("data-svg-origin",N+" "+P)},_1=function(e,t){var n=e._gsap||new B8(e);if("x"in n&&!t&&!n.uncache)return n;var i=e.style,s=n.scaleX<0,a="px",o="deg",l=getComputedStyle(e),c=hu(e,Bl)||"0",d,p,y,_,v,b,E,T,M,R,N,P,U,L,F,O,B,q,j,Q,se,ae,V,X,ee,fe,Y,K,he,Ce,Ie,ut;return d=p=y=b=E=T=M=R=N=0,_=v=1,n.svg=!!(e.getCTM&&K8(e)),l.translate&&((l.translate!=="none"||l.scale!=="none"||l.rotate!=="none")&&(i[cs]=(l.translate!=="none"?"translate3d("+(l.translate+" 0 0").split(" ").slice(0,3).join(", ")+") ":"")+(l.rotate!=="none"?"rotate("+l.rotate+") ":"")+(l.scale!=="none"?"scale("+l.scale.split(" ").join(",")+") ":"")+(l[cs]!=="none"?l[cs]:"")),i.scale=i.rotate=i.translate="none"),L=xP(e,n.svg),n.svg&&(n.uncache?(ee=e.getBBox(),c=n.xOrigin-ee.x+"px "+(n.yOrigin-ee.y)+"px",X=""):X=!t&&e.getAttribute("data-svg-origin"),FO(e,X||c,!!X||n.originIsAbsolute,n.smooth!==!1,L)),P=n.xOrigin||0,U=n.yOrigin||0,L!==y1&&(q=L[0],j=L[1],Q=L[2],se=L[3],d=ae=L[4],p=V=L[5],L.length===6?(_=Math.sqrt(q*q+j*j),v=Math.sqrt(se*se+Q*Q),b=q||j?pv(j,q)*a0:0,M=Q||se?pv(Q,se)*a0+b:0,M&&(v*=Math.abs(Math.cos(M*Wv))),n.svg&&(d-=P-(P*q+U*Q),p-=U-(P*j+U*se))):(ut=L[6],Ce=L[7],Y=L[8],K=L[9],he=L[10],Ie=L[11],d=L[12],p=L[13],y=L[14],F=pv(ut,he),E=F*a0,F&&(O=Math.cos(-F),B=Math.sin(-F),X=ae*O+Y*B,ee=V*O+K*B,fe=ut*O+he*B,Y=ae*-B+Y*O,K=V*-B+K*O,he=ut*-B+he*O,Ie=Ce*-B+Ie*O,ae=X,V=ee,ut=fe),F=pv(-Q,he),T=F*a0,F&&(O=Math.cos(-F),B=Math.sin(-F),X=q*O-Y*B,ee=j*O-K*B,fe=Q*O-he*B,Ie=se*B+Ie*O,q=X,j=ee,Q=fe),F=pv(j,q),b=F*a0,F&&(O=Math.cos(F),B=Math.sin(F),X=q*O+j*B,ee=ae*O+V*B,j=j*O-q*B,V=V*O-ae*B,q=X,ae=ee),E&&Math.abs(E)+Math.abs(b)>359.9&&(E=b=0,T=180-T),_=ws(Math.sqrt(q*q+j*j+Q*Q)),v=ws(Math.sqrt(V*V+ut*ut)),F=pv(ae,V),M=Math.abs(F)>2e-4?F*a0:0,N=Ie?1/(Ie<0?-Ie:Ie):0),n.svg&&(X=e.getAttribute("transform"),n.forceCSS=e.setAttribute("transform","")||!J8(hu(e,cs)),X&&e.setAttribute("transform",X))),Math.abs(M)>90&&Math.abs(M)<270&&(s?(_*=-1,M+=b<=0?180:-180,b+=b<=0?180:-180):(v*=-1,M+=M<=0?180:-180)),t=t||n.uncache,n.x=d-((n.xPercent=d&&(!t&&n.xPercent||(Math.round(e.offsetWidth/2)===Math.round(-d)?-50:0)))?e.offsetWidth*n.xPercent/100:0)+a,n.y=p-((n.yPercent=p&&(!t&&n.yPercent||(Math.round(e.offsetHeight/2)===Math.round(-p)?-50:0)))?e.offsetHeight*n.yPercent/100:0)+a,n.z=y+a,n.scaleX=ws(_),n.scaleY=ws(v),n.rotation=ws(b)+o,n.rotationX=ws(E)+o,n.rotationY=ws(T)+o,n.skewX=M+o,n.skewY=R+o,n.transformPerspective=N+a,(n.zOrigin=parseFloat(c.split(" ")[2])||!t&&n.zOrigin||0)&&(i[Bl]=mR(c)),n.xOffset=n.yOffset=0,n.force3D=gu.force3D,n.renderTransform=n.svg?xae:Y8?eH:vae,n.uncache=0,n},mR=function(e){return(e=e.split(" "))[0]+" "+e[1]},X3=function(e,t,n){var i=uo(t);return ws(parseFloat(t)+parseFloat(Am(e,"x",n+"px",i)))+i},vae=function(e,t){t.z="0px",t.rotationY=t.rotationX="0deg",t.force3D=0,eH(e,t)},Zg="0deg",GS="0px",Kg=") ",eH=function(e,t){var n=t||this,i=n.xPercent,s=n.yPercent,a=n.x,o=n.y,l=n.z,c=n.rotation,d=n.rotationY,p=n.rotationX,y=n.skewX,_=n.skewY,v=n.scaleX,b=n.scaleY,E=n.transformPerspective,T=n.force3D,M=n.target,R=n.zOrigin,N="",P=T==="auto"&&e&&e!==1||T===!0;if(R&&(p!==Zg||d!==Zg)){var U=parseFloat(d)*Wv,L=Math.sin(U),F=Math.cos(U),O;U=parseFloat(p)*Wv,O=Math.cos(U),a=X3(M,a,L*O*-R),o=X3(M,o,-Math.sin(U)*-R),l=X3(M,l,F*O*-R+R)}E!==GS&&(N+="perspective("+E+Kg),(i||s)&&(N+="translate("+i+"%, "+s+"%) "),(P||a!==GS||o!==GS||l!==GS)&&(N+=l!==GS||P?"translate3d("+a+", "+o+", "+l+") ":"translate("+a+", "+o+Kg),c!==Zg&&(N+="rotate("+c+Kg),d!==Zg&&(N+="rotateY("+d+Kg),p!==Zg&&(N+="rotateX("+p+Kg),(y!==Zg||_!==Zg)&&(N+="skew("+y+", "+_+Kg),(v!==1||b!==1)&&(N+="scale("+v+", "+b+Kg),M.style[cs]=N||"translate(0, 0)"},xae=function(e,t){var n=t||this,i=n.xPercent,s=n.yPercent,a=n.x,o=n.y,l=n.rotation,c=n.skewX,d=n.skewY,p=n.scaleX,y=n.scaleY,_=n.target,v=n.xOrigin,b=n.yOrigin,E=n.xOffset,T=n.yOffset,M=n.forceCSS,R=parseFloat(a),N=parseFloat(o),P,U,L,F,O;l=parseFloat(l),c=parseFloat(c),d=parseFloat(d),d&&(d=parseFloat(d),c+=d,l+=d),l||c?(l*=Wv,c*=Wv,P=Math.cos(l)*p,U=Math.sin(l)*p,L=Math.sin(l-c)*-y,F=Math.cos(l-c)*y,c&&(d*=Wv,O=Math.tan(c-d),O=Math.sqrt(1+O*O),L*=O,F*=O,d&&(O=Math.tan(d),O=Math.sqrt(1+O*O),P*=O,U*=O)),P=ws(P),U=ws(U),L=ws(L),F=ws(F)):(P=p,F=y,U=L=0),(R&&!~(a+"").indexOf("px")||N&&!~(o+"").indexOf("px"))&&(R=Am(_,"x",a,"px"),N=Am(_,"y",o,"px")),(v||b||E||T)&&(R=ws(R+v-(v*P+b*L)+E),N=ws(N+b-(v*U+b*F)+T)),(i||s)&&(O=_.getBBox(),R=ws(R+i/100*O.width),N=ws(N+s/100*O.height)),O="matrix("+P+","+U+","+L+","+F+","+R+","+N+")",_.setAttribute("transform",O),M&&(_.style[cs]=O)},bae=function(e,t,n,i,s){var a=360,o=Ea(s),l=parseFloat(s)*(o&&~s.indexOf("rad")?a0:1),c=l-i,d=i+c+"deg",p,y;return o&&(p=s.split("_")[1],p==="short"&&(c%=a,c!==c%(a/2)&&(c+=c<0?a:-a)),p==="cw"&&c<0?c=(c+a*XV)%a-~~(c/a)*a:p==="ccw"&&c>0&&(c=(c-a*XV)%a-~~(c/a)*a)),e._pt=y=new Pl(e._pt,t,n,i,c,iae),y.e=d,y.u="deg",e._props.push(n),y},JV=function(e,t){for(var n in t)e[n]=t[n];return e},Sae=function(e,t,n){var i=JV({},n._gsap),s="perspective,force3D,transformOrigin,svgOrigin",a=n.style,o,l,c,d,p,y,_,v;i.svg?(c=n.getAttribute("transform"),n.setAttribute("transform",""),a[cs]=t,o=_1(n,1),Mm(n,cs),n.setAttribute("transform",c)):(c=getComputedStyle(n)[cs],a[cs]=t,o=_1(n,1),a[cs]=c);for(l in zh)c=i[l],d=o[l],c!==d&&s.indexOf(l)<0&&(_=uo(c),v=uo(d),p=_!==v?Am(n,l,c,v):parseFloat(c),y=parseFloat(d),e._pt=new Pl(e._pt,o,l,p,y-p,PO),e._pt.u=v||0,e._props.push(l));JV(o,i)};Ll("padding,margin,Width,Radius",function(r,e){var t="Top",n="Right",i="Bottom",s="Left",a=(e<3?[t,n,i,s]:[t+s,t+n,i+n,i+s]).map(function(o){return e<2?r+o:"border"+o+r});pR[e>1?"border"+r:r]=function(o,l,c,d,p){var y,_;if(arguments.length<4)return y=a.map(function(v){return uh(o,v,c)}),_=y.join(" "),_.split(y[0]).length===5?y[0]:_;y=(d+"").split(" "),_={},a.forEach(function(v,b){return _[v]=y[b]=y[b]||y[(b-1)/2|0]}),o.init(l,_,p)}});var tH={name:"css",register:IO,targetTest:function(e){return e.style&&e.nodeType},init:function(e,t,n,i,s){var a=this._props,o=e.style,l=n.vars.startAt,c,d,p,y,_,v,b,E,T,M,R,N,P,U,L,F,O;yP||IO(),this.styles=this.styles||j8(e),F=this.styles.props,this.tween=n;for(b in t)if(b!=="autoRound"&&(d=t[b],!(au[b]&&I8(b,t,n,i,e,s)))){if(_=typeof d,v=pR[b],_==="function"&&(d=d.call(n,i,e,s),_=typeof d),_==="string"&&~d.indexOf("random(")&&(d=p1(d)),v)v(this,e,b,d,n)&&(L=1);else if(b.substr(0,2)==="--")c=(getComputedStyle(e).getPropertyValue(b)+"").trim(),d+="",pm.lastIndex=0,pm.test(c)||(E=uo(c),T=uo(d),T?E!==T&&(c=Am(e,b,c,T)+T):E&&(d+=E)),this.add(o,"setProperty",c,d,i,s,0,0,b),a.push(b),F.push(b,0,o[b]);else if(_!=="undefined"){if(l&&b in l?(c=typeof l[b]=="function"?l[b].call(n,i,e,s):l[b],Ea(c)&&~c.indexOf("random(")&&(c=p1(c)),uo(c+"")||c==="auto"||(c+=gu.units[b]||uo(uh(e,b))||""),(c+"").charAt(1)==="="&&(c=uh(e,b))):c=uh(e,b),y=parseFloat(c),M=_==="string"&&d.charAt(1)==="="&&d.substr(0,2),M&&(d=d.substr(2)),p=parseFloat(d),b in id&&(b==="autoAlpha"&&(y===1&&uh(e,"visibility")==="hidden"&&p&&(y=0),F.push("visibility",0,o.visibility),am(this,o,"visibility",y?"inherit":"hidden",p?"inherit":"hidden",!p)),b!=="scale"&&b!=="transform"&&(b=id[b],~b.indexOf(",")&&(b=b.split(",")[0]))),R=b in zh,R){if(this.styles.save(b),O=d,_==="string"&&d.substring(0,6)==="var(--"){if(d=hu(e,d.substring(4,d.indexOf(")"))),d.substring(0,5)==="calc("){var B=e.style.perspective;e.style.perspective=d,d=hu(e,"perspective"),B?e.style.perspective=B:Mm(e,"perspective")}p=parseFloat(d)}if(N||(P=e._gsap,P.renderTransform&&!t.parseTransform||_1(e,t.parseTransform),U=t.smoothOrigin!==!1&&P.smooth,N=this._pt=new Pl(this._pt,o,cs,0,1,P.renderTransform,P,0,-1),N.dep=1),b==="scale")this._pt=new Pl(this._pt,P,"scaleY",P.scaleY,(M?kv(P.scaleY,M+p):p)-P.scaleY||0,PO),this._pt.u=0,a.push("scaleY",b),b+="X";else if(b==="transformOrigin"){F.push(Bl,0,o[Bl]),d=yae(d),P.svg?FO(e,d,0,U,0,this):(T=parseFloat(d.split(" ")[2])||0,T!==P.zOrigin&&am(this,P,"zOrigin",P.zOrigin,T),am(this,o,b,mR(c),mR(d)));continue}else if(b==="svgOrigin"){FO(e,d,1,U,0,this);continue}else if(b in Q8){bae(this,P,b,y,M?kv(y,M+d):d);continue}else if(b==="smoothOrigin"){am(this,P,"smooth",P.smooth,d);continue}else if(b==="force3D"){P[b]=d;continue}else if(b==="transform"){Sae(this,d,e);continue}}else b in o||(b=wx(b)||b);if(R||(p||p===0)&&(y||y===0)&&!nae.test(d)&&b in o)E=(c+"").substr((y+"").length),p||(p=0),T=uo(d)||(b in gu.units?gu.units[b]:E),E!==T&&(y=Am(e,b,c,T)),this._pt=new Pl(this._pt,R?P:o,b,y,(M?kv(y,M+p):p)-y,!R&&(T==="px"||b==="zIndex")&&t.autoRound!==!1?aae:PO),this._pt.u=T||0,R&&O!==d?(this._pt.b=c,this._pt.e=O,this._pt.r=sae):E!==T&&T!=="%"&&(this._pt.b=c,this._pt.r=rae);else if(b in o)gae.call(this,e,b,c,M?M+d:d);else if(b in e)this.add(e,b,c||e[b],M?M+d:d,i,s);else if(b!=="parseTransform"){oP(b,d);continue}R||(b in o?F.push(b,0,o[b]):typeof e[b]=="function"?F.push(b,2,e[b]()):F.push(b,1,c||e[b])),a.push(b)}}L&&H8(this)},render:function(e,t){if(t.tween._time||!_P())for(var n=t._pt;n;)n.r(e,n.d),n=n._next;else t.styles.revert()},get:uh,aliases:id,getSetter:function(e,t,n){var i=id[t];return i&&i.indexOf(",")<0&&(t=i),t in zh&&t!==Bl&&(e._gsap.x||uh(e,"x"))?n&&qV===n?t==="scale"?cae:uae:(qV=n||{})&&(t==="scale"?fae:dae):e.style&&!rP(e.style[t])?oae:~t.indexOf("-")?lae:mP(e,t)},core:{_removeProperty:Mm,_getMatrix:xP}};Fl.utils.checkPrefix=wx;Fl.core.getStyleSaver=j8;(function(r,e,t,n){var i=Ll(r+","+e+","+t,function(s){zh[s]=1});Ll(e,function(s){gu.units[s]="deg",Q8[s]=1}),id[i[13]]=r+","+e,Ll(n,function(s){var a=s.split(":");id[a[1]]=i[a[0]]})})("x,y,z,scale,scaleX,scaleY,xPercent,yPercent","rotation,rotationX,rotationY,skewX,skewY","transform,transformOrigin,svgOrigin,force3D,smoothOrigin,transformPerspective","0:translateX,1:translateY,2:translateZ,8:rotate,8:rotationZ,8:rotateZ,9:rotateX,10:rotateY");Ll("x,y,z,top,right,bottom,left,width,height,fontSize,padding,margin,perspective",function(r){gu.units[r]="px"});Fl.registerPlugin(tH);var nH=Fl.registerPlugin(tH)||Fl;nH.core.Tween;function Tae(r,e){for(var t=0;t<e.length;t++){var n=e[t];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(r,n.key,n)}}function Eae(r,e,t){return e&&Tae(r.prototype,e),r}var Ia,Dw,fu,om,lm,qv,iH,o0,LT,rH,gh,kc,sH,aH=function(){return Ia||typeof window<"u"&&(Ia=window.gsap)&&Ia.registerPlugin&&Ia},oH=1,Iv=[],gi=[],ad=[],PT=Date.now,zO=function(e,t){return t},Mae=function(){var e=LT.core,t=e.bridge||{},n=e._scrollers,i=e._proxies;n.push.apply(n,gi),i.push.apply(i,ad),gi=n,ad=i,zO=function(a,o){return t[a](o)}},mm=function(e,t){return~ad.indexOf(e)&&ad[ad.indexOf(e)+1][t]},BT=function(e){return!!~rH.indexOf(e)},Wo=function(e,t,n,i,s){return e.addEventListener(t,n,{passive:i!==!1,capture:!!s})},ko=function(e,t,n,i){return e.removeEventListener(t,n,!!i)},OA="scrollLeft",UA="scrollTop",VO=function(){return gh&&gh.isPressed||gi.cache++},gR=function(e,t){var n=function i(s){if(s||s===0){oH&&(fu.history.scrollRestoration="manual");var a=gh&&gh.isPressed;s=i.v=Math.round(s)||(gh&&gh.iOS?1:0),e(s),i.cacheID=gi.cache,a&&zO("ss",s)}else(t||gi.cache!==i.cacheID||zO("ref"))&&(i.cacheID=gi.cache,i.v=e());return i.v+i.offset};return n.offset=0,e&&n},nl={s:OA,p:"left",p2:"Left",os:"right",os2:"Right",d:"width",d2:"Width",a:"x",sc:gR(function(r){return arguments.length?fu.scrollTo(r,Js.sc()):fu.pageXOffset||om[OA]||lm[OA]||qv[OA]||0})},Js={s:UA,p:"top",p2:"Top",os:"bottom",os2:"Bottom",d:"height",d2:"Height",a:"y",op:nl,sc:gR(function(r){return arguments.length?fu.scrollTo(nl.sc(),r):fu.pageYOffset||om[UA]||lm[UA]||qv[UA]||0})},Sl=function(e,t){return(t&&t._ctx&&t._ctx.selector||Ia.utils.toArray)(e)[0]||(typeof e=="string"&&Ia.config().nullTargetWarn!==!1?console.warn("Element not found:",e):null)},Aae=function(e,t){for(var n=t.length;n--;)if(t[n]===e||t[n].contains(e))return!0;return!1},wm=function(e,t){var n=t.s,i=t.sc;BT(e)&&(e=om.scrollingElement||lm);var s=gi.indexOf(e),a=i===Js.sc?1:2;!~s&&(s=gi.push(e)-1),gi[s+a]||Wo(e,"scroll",VO);var o=gi[s+a],l=o||(gi[s+a]=gR(mm(e,n),!0)||(BT(e)?i:gR(function(c){return arguments.length?e[n]=c:e[n]})));return l.target=e,o||(l.smooth=Ia.getProperty(e,"scrollBehavior")==="smooth"),l},GO=function(e,t,n){var i=e,s=e,a=PT(),o=a,l=t||50,c=Math.max(500,l*3),d=function(v,b){var E=PT();b||E-a>l?(s=i,i=v,o=a,a=E):n?i+=v:i=s+(v-s)/(E-o)*(a-o)},p=function(){s=i=n?0:i,o=a=0},y=function(v){var b=o,E=s,T=PT();return(v||v===0)&&v!==i&&d(v),a===o||T-o>c?0:(i+(n?E:-E))/((n?T:a)-b)*1e3};return{update:d,reset:p,getVelocity:y}},kS=function(e,t){return t&&!e._gsapAllow&&e.preventDefault(),e.changedTouches?e.changedTouches[0]:e},e4=function(e){var t=Math.max.apply(Math,e),n=Math.min.apply(Math,e);return Math.abs(t)>=Math.abs(n)?t:n},lH=function(){LT=Ia.core.globals().ScrollTrigger,LT&&LT.core&&Mae()},uH=function(e){return Ia=e||aH(),!Dw&&Ia&&typeof document<"u"&&document.body&&(fu=window,om=document,lm=om.documentElement,qv=om.body,rH=[fu,om,lm,qv],Ia.utils.clamp,sH=Ia.core.context||function(){},o0="onpointerenter"in qv?"pointer":"mouse",iH=Rs.isTouch=fu.matchMedia&&fu.matchMedia("(hover: none), (pointer: coarse)").matches?1:"ontouchstart"in fu||navigator.maxTouchPoints>0||navigator.msMaxTouchPoints>0?2:0,kc=Rs.eventTypes=("ontouchstart"in lm?"touchstart,touchmove,touchcancel,touchend":"onpointerdown"in lm?"pointerdown,pointermove,pointercancel,pointerup":"mousedown,mousemove,mouseup,mouseup").split(","),setTimeout(function(){return oH=0},500),lH(),Dw=1),Dw};nl.op=Js;gi.cache=0;var Rs=(function(){function r(t){this.init(t)}var e=r.prototype;return e.init=function(n){Dw||uH(Ia)||console.warn("Please gsap.registerPlugin(Observer)"),LT||lH();var i=n.tolerance,s=n.dragMinimum,a=n.type,o=n.target,l=n.lineHeight,c=n.debounce,d=n.preventDefault,p=n.onStop,y=n.onStopDelay,_=n.ignore,v=n.wheelSpeed,b=n.event,E=n.onDragStart,T=n.onDragEnd,M=n.onDrag,R=n.onPress,N=n.onRelease,P=n.onRight,U=n.onLeft,L=n.onUp,F=n.onDown,O=n.onChangeX,B=n.onChangeY,q=n.onChange,j=n.onToggleX,Q=n.onToggleY,se=n.onHover,ae=n.onHoverEnd,V=n.onMove,X=n.ignoreCheck,ee=n.isNormalizer,fe=n.onGestureStart,Y=n.onGestureEnd,K=n.onWheel,he=n.onEnable,Ce=n.onDisable,Ie=n.onClick,ut=n.scrollSpeed,Ee=n.capture,Ne=n.allowClicks,rt=n.lockAxis,Nt=n.onLockAxis;this.target=o=Sl(o)||lm,this.vars=n,_&&(_=Ia.utils.toArray(_)),i=i||1e-9,s=s||0,v=v||1,ut=ut||1,a=a||"wheel,touch,pointer",c=c!==!1,l||(l=parseFloat(fu.getComputedStyle(qv).lineHeight)||22);var Ft,fn,Sn,At,qe,at,Je,xe=this,oe=0,Qt=0,Dt=n.passive||!d&&n.passive!==!1,zt=wm(o,nl),wt=wm(o,Js),Z=zt(),k=wt(),pe=~a.indexOf("touch")&&!~a.indexOf("pointer")&&kc[0]==="pointerdown",Fe=BT(o),He=o.ownerDocument||om,ze=[0,0,0],Bt=[0,0,0],Ct=0,Yt=function(){return Ct=PT()},$t=function(nn,Bn){return(xe.event=nn)&&_&&Aae(nn.target,_)||Bn&&pe&&nn.pointerType!=="touch"||X&&X(nn,Bn)},st=function(){xe._vx.reset(),xe._vy.reset(),fn.pause(),p&&p(xe)},nt=function(){var nn=xe.deltaX=e4(ze),Bn=xe.deltaY=e4(Bt),Zt=Math.abs(nn)>=i,Ln=Math.abs(Bn)>=i;q&&(Zt||Ln)&&q(xe,nn,Bn,ze,Bt),Zt&&(P&&xe.deltaX>0&&P(xe),U&&xe.deltaX<0&&U(xe),O&&O(xe),j&&xe.deltaX<0!=oe<0&&j(xe),oe=xe.deltaX,ze[0]=ze[1]=ze[2]=0),Ln&&(F&&xe.deltaY>0&&F(xe),L&&xe.deltaY<0&&L(xe),B&&B(xe),Q&&xe.deltaY<0!=Qt<0&&Q(xe),Qt=xe.deltaY,Bt[0]=Bt[1]=Bt[2]=0),(At||Sn)&&(V&&V(xe),Sn&&(E&&Sn===1&&E(xe),M&&M(xe),Sn=0),At=!1),at&&!(at=!1)&&Nt&&Nt(xe),qe&&(K(xe),qe=!1),Ft=0},Pt=function(nn,Bn,Zt){ze[Zt]+=nn,Bt[Zt]+=Bn,xe._vx.update(nn),xe._vy.update(Bn),c?Ft||(Ft=requestAnimationFrame(nt)):nt()},ue=function(nn,Bn){rt&&!Je&&(xe.axis=Je=Math.abs(nn)>Math.abs(Bn)?"x":"y",at=!0),Je!=="y"&&(ze[2]+=nn,xe._vx.update(nn,!0)),Je!=="x"&&(Bt[2]+=Bn,xe._vy.update(Bn,!0)),c?Ft||(Ft=requestAnimationFrame(nt)):nt()},Re=function(nn){if(!$t(nn,1)){nn=kS(nn,d);var Bn=nn.clientX,Zt=nn.clientY,Ln=Bn-xe.x,dn=Zt-xe.y,wn=xe.isDragging;xe.x=Bn,xe.y=Zt,(wn||(Ln||dn)&&(Math.abs(xe.startX-Bn)>=s||Math.abs(xe.startY-Zt)>=s))&&(Sn||(Sn=wn?2:1),wn||(xe.isDragging=!0),ue(Ln,dn))}},dt=xe.onPress=function(qt){$t(qt,1)||qt&&qt.button||(xe.axis=Je=null,fn.pause(),xe.isPressed=!0,qt=kS(qt),oe=Qt=0,xe.startX=xe.x=qt.clientX,xe.startY=xe.y=qt.clientY,xe._vx.reset(),xe._vy.reset(),Wo(ee?o:He,kc[1],Re,Dt,!0),xe.deltaX=xe.deltaY=0,R&&R(xe))},le=xe.onRelease=function(qt){if(!$t(qt,1)){ko(ee?o:He,kc[1],Re,!0);var nn=!isNaN(xe.y-xe.startY),Bn=xe.isDragging,Zt=Bn&&(Math.abs(xe.x-xe.startX)>3||Math.abs(xe.y-xe.startY)>3),Ln=kS(qt);!Zt&&nn&&(xe._vx.reset(),xe._vy.reset(),d&&Ne&&Ia.delayedCall(.08,function(){if(PT()-Ct>300&&!qt.defaultPrevented){if(qt.target.click)qt.target.click();else if(He.createEvent){var dn=He.createEvent("MouseEvents");dn.initMouseEvent("click",!0,!0,fu,1,Ln.screenX,Ln.screenY,Ln.clientX,Ln.clientY,!1,!1,!1,!1,0,null),qt.target.dispatchEvent(dn)}}})),xe.isDragging=xe.isGesturing=xe.isPressed=!1,p&&Bn&&!ee&&fn.restart(!0),Sn&&nt(),T&&Bn&&T(xe),N&&N(xe,Zt)}},Be=function(nn){return nn.touches&&nn.touches.length>1&&(xe.isGesturing=!0)&&fe(nn,xe.isDragging)},lt=function(){return(xe.isGesturing=!1)||Y(xe)},Ot=function(nn){if(!$t(nn)){var Bn=zt(),Zt=wt();Pt((Bn-Z)*ut,(Zt-k)*ut,1),Z=Bn,k=Zt,p&&fn.restart(!0)}},ht=function(nn){if(!$t(nn)){nn=kS(nn,d),K&&(qe=!0);var Bn=(nn.deltaMode===1?l:nn.deltaMode===2?fu.innerHeight:1)*v;Pt(nn.deltaX*Bn,nn.deltaY*Bn,0),p&&!ee&&fn.restart(!0)}},it=function(nn){if(!$t(nn)){var Bn=nn.clientX,Zt=nn.clientY,Ln=Bn-xe.x,dn=Zt-xe.y;xe.x=Bn,xe.y=Zt,At=!0,p&&fn.restart(!0),(Ln||dn)&&ue(Ln,dn)}},Tt=function(nn){xe.event=nn,se(xe)},ln=function(nn){xe.event=nn,ae(xe)},jn=function(nn){return $t(nn)||kS(nn,d)&&Ie(xe)};fn=xe._dc=Ia.delayedCall(y||.25,st).pause(),xe.deltaX=xe.deltaY=0,xe._vx=GO(0,50,!0),xe._vy=GO(0,50,!0),xe.scrollX=zt,xe.scrollY=wt,xe.isDragging=xe.isGesturing=xe.isPressed=!1,sH(this),xe.enable=function(qt){return xe.isEnabled||(Wo(Fe?He:o,"scroll",VO),a.indexOf("scroll")>=0&&Wo(Fe?He:o,"scroll",Ot,Dt,Ee),a.indexOf("wheel")>=0&&Wo(o,"wheel",ht,Dt,Ee),(a.indexOf("touch")>=0&&iH||a.indexOf("pointer")>=0)&&(Wo(o,kc[0],dt,Dt,Ee),Wo(He,kc[2],le),Wo(He,kc[3],le),Ne&&Wo(o,"click",Yt,!0,!0),Ie&&Wo(o,"click",jn),fe&&Wo(He,"gesturestart",Be),Y&&Wo(He,"gestureend",lt),se&&Wo(o,o0+"enter",Tt),ae&&Wo(o,o0+"leave",ln),V&&Wo(o,o0+"move",it)),xe.isEnabled=!0,xe.isDragging=xe.isGesturing=xe.isPressed=At=Sn=!1,xe._vx.reset(),xe._vy.reset(),Z=zt(),k=wt(),qt&&qt.type&&dt(qt),he&&he(xe)),xe},xe.disable=function(){xe.isEnabled&&(Iv.filter(function(qt){return qt!==xe&&BT(qt.target)}).length||ko(Fe?He:o,"scroll",VO),xe.isPressed&&(xe._vx.reset(),xe._vy.reset(),ko(ee?o:He,kc[1],Re,!0)),ko(Fe?He:o,"scroll",Ot,Ee),ko(o,"wheel",ht,Ee),ko(o,kc[0],dt,Ee),ko(He,kc[2],le),ko(He,kc[3],le),ko(o,"click",Yt,!0),ko(o,"click",jn),ko(He,"gesturestart",Be),ko(He,"gestureend",lt),ko(o,o0+"enter",Tt),ko(o,o0+"leave",ln),ko(o,o0+"move",it),xe.isEnabled=xe.isPressed=xe.isDragging=!1,Ce&&Ce(xe))},xe.kill=xe.revert=function(){xe.disable();var qt=Iv.indexOf(xe);qt>=0&&Iv.splice(qt,1),gh===xe&&(gh=0)},Iv.push(xe),ee&&BT(o)&&(gh=xe),xe.enable(b)},Eae(r,[{key:"velocityX",get:function(){return this._vx.getVelocity()}},{key:"velocityY",get:function(){return this._vy.getVelocity()}}]),r})();Rs.version="3.14.2";Rs.create=function(r){return new Rs(r)};Rs.register=uH;Rs.getAll=function(){return Iv.slice()};Rs.getById=function(r){return Iv.filter(function(e){return e.vars.id===r})[0]};aH()&&Ia.registerPlugin(Rs);var bn,Rv,mi,Ur,lu,ur,bP,yR,v1,IT,gT,LA,ao,JC,kO,jo,t4,n4,Cv,cH,$3,fH,$o,HO,dH,hH,jp,WO,SP,Xv,TP,FT,qO,j3,PA=1,oo=Date.now,Y3=oo(),sc=0,yT=0,i4=function(e,t,n){var i=su(e)&&(e.substr(0,6)==="clamp("||e.indexOf("max")>-1);return n["_"+t+"Clamp"]=i,i?e.substr(6,e.length-7):e},r4=function(e,t){return t&&(!su(e)||e.substr(0,6)!=="clamp(")?"clamp("+e+")":e},wae=function r(){return yT&&requestAnimationFrame(r)},s4=function(){return JC=1},a4=function(){return JC=0},Kf=function(e){return e},_T=function(e){return Math.round(e*1e5)/1e5||0},pH=function(){return typeof window<"u"},mH=function(){return bn||pH()&&(bn=window.gsap)&&bn.registerPlugin&&bn},yy=function(e){return!!~bP.indexOf(e)},gH=function(e){return(e==="Height"?TP:mi["inner"+e])||lu["client"+e]||ur["client"+e]},yH=function(e){return mm(e,"getBoundingClientRect")||(yy(e)?function(){return Bw.width=mi.innerWidth,Bw.height=TP,Bw}:function(){return hh(e)})},Rae=function(e,t,n){var i=n.d,s=n.d2,a=n.a;return(a=mm(e,"getBoundingClientRect"))?function(){return a()[i]}:function(){return(t?gH(s):e["client"+s])||0}},Cae=function(e,t){return!t||~ad.indexOf(e)?yH(e):function(){return Bw}},rd=function(e,t){var n=t.s,i=t.d2,s=t.d,a=t.a;return Math.max(0,(n="scroll"+i)&&(a=mm(e,n))?a()-yH(e)()[s]:yy(e)?(lu[n]||ur[n])-gH(i):e[n]-e["offset"+i])},BA=function(e,t){for(var n=0;n<Cv.length;n+=3)(!t||~t.indexOf(Cv[n+1]))&&e(Cv[n],Cv[n+1],Cv[n+2])},su=function(e){return typeof e=="string"},co=function(e){return typeof e=="function"},vT=function(e){return typeof e=="number"},l0=function(e){return typeof e=="object"},HS=function(e,t,n){return e&&e.progress(t?0:1)&&n&&e.pause()},Z3=function(e,t){if(e.enabled){var n=e._ctx?e._ctx.add(function(){return t(e)}):t(e);n&&n.totalTime&&(e.callbackAnimation=n)}},mv=Math.abs,_H="left",vH="top",EP="right",MP="bottom",U0="width",L0="height",zT="Right",VT="Left",GT="Top",kT="Bottom",Fs="padding",Xu="margin",Rx="Width",AP="Height",Qs="px",$u=function(e){return mi.getComputedStyle(e)},Nae=function(e){var t=$u(e).position;e.style.position=t==="absolute"||t==="fixed"?t:"relative"},o4=function(e,t){for(var n in t)n in e||(e[n]=t[n]);return e},hh=function(e,t){var n=t&&$u(e)[kO]!=="matrix(1, 0, 0, 1, 0, 0)"&&bn.to(e,{x:0,y:0,xPercent:0,yPercent:0,rotation:0,rotationX:0,rotationY:0,scale:1,skewX:0,skewY:0}).progress(1),i=e.getBoundingClientRect();return n&&n.progress(0).kill(),i},_R=function(e,t){var n=t.d2;return e["offset"+n]||e["client"+n]||0},xH=function(e){var t=[],n=e.labels,i=e.duration(),s;for(s in n)t.push(n[s]/i);return t},Dae=function(e){return function(t){return bn.utils.snap(xH(e),t)}},wP=function(e){var t=bn.utils.snap(e),n=Array.isArray(e)&&e.slice(0).sort(function(i,s){return i-s});return n?function(i,s,a){a===void 0&&(a=.001);var o;if(!s)return t(i);if(s>0){for(i-=a,o=0;o<n.length;o++)if(n[o]>=i)return n[o];return n[o-1]}else for(o=n.length,i+=a;o--;)if(n[o]<=i)return n[o];return n[0]}:function(i,s,a){a===void 0&&(a=.001);var o=t(i);return!s||Math.abs(o-i)<a||o-i<0==s<0?o:t(s<0?i-e:i+e)}},Oae=function(e){return function(t,n){return wP(xH(e))(t,n.direction)}},IA=function(e,t,n,i){return n.split(",").forEach(function(s){return e(t,s,i)})},ya=function(e,t,n,i,s){return e.addEventListener(t,n,{passive:!i,capture:!!s})},ma=function(e,t,n,i){return e.removeEventListener(t,n,!!i)},FA=function(e,t,n){n=n&&n.wheelHandler,n&&(e(t,"wheel",n),e(t,"touchmove",n))},l4={startColor:"green",endColor:"red",indent:0,fontSize:"16px",fontWeight:"normal"},zA={toggleActions:"play",anticipatePin:0},vR={top:0,left:0,center:.5,bottom:1,right:1},Ow=function(e,t){if(su(e)){var n=e.indexOf("="),i=~n?+(e.charAt(n-1)+1)*parseFloat(e.substr(n+1)):0;~n&&(e.indexOf("%")>n&&(i*=t/100),e=e.substr(0,n-1)),e=i+(e in vR?vR[e]*t:~e.indexOf("%")?parseFloat(e)*t/100:parseFloat(e)||0)}return e},VA=function(e,t,n,i,s,a,o,l){var c=s.startColor,d=s.endColor,p=s.fontSize,y=s.indent,_=s.fontWeight,v=Ur.createElement("div"),b=yy(n)||mm(n,"pinType")==="fixed",E=e.indexOf("scroller")!==-1,T=b?ur:n,M=e.indexOf("start")!==-1,R=M?c:d,N="border-color:"+R+";font-size:"+p+";color:"+R+";font-weight:"+_+";pointer-events:none;white-space:nowrap;font-family:sans-serif,Arial;z-index:1000;padding:4px 8px;border-width:0;border-style:solid;";return N+="position:"+((E||l)&&b?"fixed;":"absolute;"),(E||l||!b)&&(N+=(i===Js?EP:MP)+":"+(a+parseFloat(y))+"px;"),o&&(N+="box-sizing:border-box;text-align:left;width:"+o.offsetWidth+"px;"),v._isStart=M,v.setAttribute("class","gsap-marker-"+e+(t?" marker-"+t:"")),v.style.cssText=N,v.innerText=t||t===0?e+"-"+t:e,T.children[0]?T.insertBefore(v,T.children[0]):T.appendChild(v),v._offset=v["offset"+i.op.d2],Uw(v,0,i,M),v},Uw=function(e,t,n,i){var s={display:"block"},a=n[i?"os2":"p2"],o=n[i?"p2":"os2"];e._isFlipped=i,s[n.a+"Percent"]=i?-100:0,s[n.a]=i?"1px":0,s["border"+a+Rx]=1,s["border"+o+Rx]=0,s[n.p]=t+"px",bn.set(e,s)},fi=[],XO={},x1,u4=function(){return oo()-sc>34&&(x1||(x1=requestAnimationFrame(Mh)))},gv=function(){(!$o||!$o.isPressed||$o.startX>ur.clientWidth)&&(gi.cache++,$o?x1||(x1=requestAnimationFrame(Mh)):Mh(),sc||vy("scrollStart"),sc=oo())},K3=function(){hH=mi.innerWidth,dH=mi.innerHeight},xT=function(e){gi.cache++,(e===!0||!ao&&!fH&&!Ur.fullscreenElement&&!Ur.webkitFullscreenElement&&(!HO||hH!==mi.innerWidth||Math.abs(mi.innerHeight-dH)>mi.innerHeight*.25))&&yR.restart(!0)},_y={},Uae=[],bH=function r(){return ma(Ei,"scrollEnd",r)||v0(!0)},vy=function(e){return _y[e]&&_y[e].map(function(t){return t()})||Uae},iu=[],SH=function(e){for(var t=0;t<iu.length;t+=5)(!e||iu[t+4]&&iu[t+4].query===e)&&(iu[t].style.cssText=iu[t+1],iu[t].getBBox&&iu[t].setAttribute("transform",iu[t+2]||""),iu[t+3].uncache=1)},TH=function(){return gi.forEach(function(e){return co(e)&&++e.cacheID&&(e.rec=e())})},RP=function(e,t){var n;for(jo=0;jo<fi.length;jo++)n=fi[jo],n&&(!t||n._ctx===t)&&(e?n.kill(1):n.revert(!0,!0));FT=!0,t&&SH(t),t||vy("revert")},EH=function(e,t){gi.cache++,(t||!Yo)&&gi.forEach(function(n){return co(n)&&n.cacheID++&&(n.rec=0)}),su(e)&&(mi.history.scrollRestoration=SP=e)},Yo,P0=0,c4,Lae=function(){if(c4!==P0){var e=c4=P0;requestAnimationFrame(function(){return e===P0&&v0(!0)})}},MH=function(){ur.appendChild(Xv),TP=!$o&&Xv.offsetHeight||mi.innerHeight,ur.removeChild(Xv)},f4=function(e){return v1(".gsap-marker-start, .gsap-marker-end, .gsap-marker-scroller-start, .gsap-marker-scroller-end").forEach(function(t){return t.style.display=e?"none":"block"})},v0=function(e,t){if(lu=Ur.documentElement,ur=Ur.body,bP=[mi,Ur,lu,ur],sc&&!e&&!FT){ya(Ei,"scrollEnd",bH);return}MH(),Yo=Ei.isRefreshing=!0,FT||TH();var n=vy("refreshInit");cH&&Ei.sort(),t||RP(),gi.forEach(function(i){co(i)&&(i.smooth&&(i.target.style.scrollBehavior="auto"),i(0))}),fi.slice(0).forEach(function(i){return i.refresh()}),FT=!1,fi.forEach(function(i){if(i._subPinOffset&&i.pin){var s=i.vars.horizontal?"offsetWidth":"offsetHeight",a=i.pin[s];i.revert(!0,1),i.adjustPinSpacing(i.pin[s]-a),i.refresh()}}),qO=1,f4(!0),fi.forEach(function(i){var s=rd(i.scroller,i._dir),a=i.vars.end==="max"||i._endClamp&&i.end>s,o=i._startClamp&&i.start>=s;(a||o)&&i.setPositions(o?s-1:i.start,a?Math.max(o?s:i.start+1,s):i.end,!0)}),f4(!1),qO=0,n.forEach(function(i){return i&&i.render&&i.render(-1)}),gi.forEach(function(i){co(i)&&(i.smooth&&requestAnimationFrame(function(){return i.target.style.scrollBehavior="smooth"}),i.rec&&i(i.rec))}),EH(SP,1),yR.pause(),P0++,Yo=2,Mh(2),fi.forEach(function(i){return co(i.vars.onRefresh)&&i.vars.onRefresh(i)}),Yo=Ei.isRefreshing=!1,vy("refresh")},$O=0,Lw=1,HT,Mh=function(e){if(e===2||!Yo&&!FT){Ei.isUpdating=!0,HT&&HT.update(0);var t=fi.length,n=oo(),i=n-Y3>=50,s=t&&fi[0].scroll();if(Lw=$O>s?-1:1,Yo||($O=s),i&&(sc&&!JC&&n-sc>200&&(sc=0,vy("scrollEnd")),gT=Y3,Y3=n),Lw<0){for(jo=t;jo-- >0;)fi[jo]&&fi[jo].update(0,i);Lw=1}else for(jo=0;jo<t;jo++)fi[jo]&&fi[jo].update(0,i);Ei.isUpdating=!1}x1=0},jO=[_H,vH,MP,EP,Xu+kT,Xu+zT,Xu+GT,Xu+VT,"display","flexShrink","float","zIndex","gridColumnStart","gridColumnEnd","gridRowStart","gridRowEnd","gridArea","justifySelf","alignSelf","placeSelf","order"],Pw=jO.concat([U0,L0,"boxSizing","max"+Rx,"max"+AP,"position",Xu,Fs,Fs+GT,Fs+zT,Fs+kT,Fs+VT]),Pae=function(e,t,n){$v(n);var i=e._gsap;if(i.spacerIsNative)$v(i.spacerState);else if(e._gsap.swappedIn){var s=t.parentNode;s&&(s.insertBefore(e,t),s.removeChild(t))}e._gsap.swappedIn=!1},Q3=function(e,t,n,i){if(!e._gsap.swappedIn){for(var s=jO.length,a=t.style,o=e.style,l;s--;)l=jO[s],a[l]=n[l];a.position=n.position==="absolute"?"absolute":"relative",n.display==="inline"&&(a.display="inline-block"),o[MP]=o[EP]="auto",a.flexBasis=n.flexBasis||"auto",a.overflow="visible",a.boxSizing="border-box",a[U0]=_R(e,nl)+Qs,a[L0]=_R(e,Js)+Qs,a[Fs]=o[Xu]=o[vH]=o[_H]="0",$v(i),o[U0]=o["max"+Rx]=n[U0],o[L0]=o["max"+AP]=n[L0],o[Fs]=n[Fs],e.parentNode!==t&&(e.parentNode.insertBefore(t,e),t.appendChild(e)),e._gsap.swappedIn=!0}},Bae=/([A-Z])/g,$v=function(e){if(e){var t=e.t.style,n=e.length,i=0,s,a;for((e.t._gsap||bn.core.getCache(e.t)).uncache=1;i<n;i+=2)a=e[i+1],s=e[i],a?t[s]=a:t[s]&&t.removeProperty(s.replace(Bae,"-$1").toLowerCase())}},GA=function(e){for(var t=Pw.length,n=e.style,i=[],s=0;s<t;s++)i.push(Pw[s],n[Pw[s]]);return i.t=e,i},Iae=function(e,t,n){for(var i=[],s=e.length,a=n?8:0,o;a<s;a+=2)o=e[a],i.push(o,o in t?t[o]:e[a+1]);return i.t=e.t,i},Bw={left:0,top:0},d4=function(e,t,n,i,s,a,o,l,c,d,p,y,_,v){co(e)&&(e=e(l)),su(e)&&e.substr(0,3)==="max"&&(e=y+(e.charAt(4)==="="?Ow("0"+e.substr(3),n):0));var b=_?_.time():0,E,T,M;if(_&&_.seek(0),isNaN(e)||(e=+e),vT(e))_&&(e=bn.utils.mapRange(_.scrollTrigger.start,_.scrollTrigger.end,0,y,e)),o&&Uw(o,n,i,!0);else{co(t)&&(t=t(l));var R=(e||"0").split(" "),N,P,U,L;M=Sl(t,l)||ur,N=hh(M)||{},(!N||!N.left&&!N.top)&&$u(M).display==="none"&&(L=M.style.display,M.style.display="block",N=hh(M),L?M.style.display=L:M.style.removeProperty("display")),P=Ow(R[0],N[i.d]),U=Ow(R[1]||"0",n),e=N[i.p]-c[i.p]-d+P+s-U,o&&Uw(o,U,i,n-U<20||o._isStart&&U>20),n-=n-U}if(v&&(l[v]=e||-.001,e<0&&(e=0)),a){var F=e+n,O=a._isStart;E="scroll"+i.d2,Uw(a,F,i,O&&F>20||!O&&(p?Math.max(ur[E],lu[E]):a.parentNode[E])<=F+1),p&&(c=hh(o),p&&(a.style[i.op.p]=c[i.op.p]-i.op.m-a._offset+Qs))}return _&&M&&(E=hh(M),_.seek(y),T=hh(M),_._caScrollDist=E[i.p]-T[i.p],e=e/_._caScrollDist*y),_&&_.seek(b),_?e:Math.round(e)},Fae=/(webkit|moz|length|cssText|inset)/i,h4=function(e,t,n,i){if(e.parentNode!==t){var s=e.style,a,o;if(t===ur){e._stOrig=s.cssText,o=$u(e);for(a in o)!+a&&!Fae.test(a)&&o[a]&&typeof s[a]=="string"&&a!=="0"&&(s[a]=o[a]);s.top=n,s.left=i}else s.cssText=e._stOrig;bn.core.getCache(e).uncache=1,t.appendChild(e)}},AH=function(e,t,n){var i=t,s=i;return function(a){var o=Math.round(e());return o!==i&&o!==s&&Math.abs(o-i)>3&&Math.abs(o-s)>3&&(a=o,n&&n()),s=i,i=Math.round(a),i}},kA=function(e,t,n){var i={};i[t.p]="+="+n,bn.set(e,i)},p4=function(e,t){var n=wm(e,t),i="_scroll"+t.p2,s=function a(o,l,c,d,p){var y=a.tween,_=l.onComplete,v={};c=c||n();var b=AH(n,c,function(){y.kill(),a.tween=0});return p=d&&p||0,d=d||o-c,y&&y.kill(),l[i]=o,l.inherit=!1,l.modifiers=v,v[i]=function(){return b(c+d*y.ratio+p*y.ratio*y.ratio)},l.onUpdate=function(){gi.cache++,a.tween&&Mh()},l.onComplete=function(){a.tween=0,_&&_.call(y)},y=a.tween=bn.to(e,l),y};return e[i]=n,n.wheelHandler=function(){return s.tween&&s.tween.kill()&&(s.tween=0)},ya(e,"wheel",n.wheelHandler),Ei.isTouch&&ya(e,"touchmove",n.wheelHandler),s},Ei=(function(){function r(t,n){Rv||r.register(bn)||console.warn("Please gsap.registerPlugin(ScrollTrigger)"),WO(this),this.init(t,n)}var e=r.prototype;return e.init=function(n,i){if(this.progress=this.start=0,this.vars&&this.kill(!0,!0),!yT){this.update=this.refresh=this.kill=Kf;return}n=o4(su(n)||vT(n)||n.nodeType?{trigger:n}:n,zA);var s=n,a=s.onUpdate,o=s.toggleClass,l=s.id,c=s.onToggle,d=s.onRefresh,p=s.scrub,y=s.trigger,_=s.pin,v=s.pinSpacing,b=s.invalidateOnRefresh,E=s.anticipatePin,T=s.onScrubComplete,M=s.onSnapComplete,R=s.once,N=s.snap,P=s.pinReparent,U=s.pinSpacer,L=s.containerAnimation,F=s.fastScrollEnd,O=s.preventOverlaps,B=n.horizontal||n.containerAnimation&&n.horizontal!==!1?nl:Js,q=!p&&p!==0,j=Sl(n.scroller||mi),Q=bn.core.getCache(j),se=yy(j),ae=("pinType"in n?n.pinType:mm(j,"pinType")||se&&"fixed")==="fixed",V=[n.onEnter,n.onLeave,n.onEnterBack,n.onLeaveBack],X=q&&n.toggleActions.split(" "),ee="markers"in n?n.markers:zA.markers,fe=se?0:parseFloat($u(j)["border"+B.p2+Rx])||0,Y=this,K=n.onRefreshInit&&function(){return n.onRefreshInit(Y)},he=Rae(j,se,B),Ce=Cae(j,se),Ie=0,ut=0,Ee=0,Ne=wm(j,B),rt,Nt,Ft,fn,Sn,At,qe,at,Je,xe,oe,Qt,Dt,zt,wt,Z,k,pe,Fe,He,ze,Bt,Ct,Yt,$t,st,nt,Pt,ue,Re,dt,le,Be,lt,Ot,ht,it,Tt,ln;if(Y._startClamp=Y._endClamp=!1,Y._dir=B,E*=45,Y.scroller=j,Y.scroll=L?L.time.bind(L):Ne,fn=Ne(),Y.vars=n,i=i||n.animation,"refreshPriority"in n&&(cH=1,n.refreshPriority===-9999&&(HT=Y)),Q.tweenScroll=Q.tweenScroll||{top:p4(j,Js),left:p4(j,nl)},Y.tweenTo=rt=Q.tweenScroll[B.p],Y.scrubDuration=function(Zt){Be=vT(Zt)&&Zt,Be?le?le.duration(Zt):le=bn.to(i,{ease:"expo",totalProgress:"+=0",inherit:!1,duration:Be,paused:!0,onComplete:function(){return T&&T(Y)}}):(le&&le.progress(1).kill(),le=0)},i&&(i.vars.lazy=!1,i._initted&&!Y.isReverted||i.vars.immediateRender!==!1&&n.immediateRender!==!1&&i.duration()&&i.render(0,!0,!0),Y.animation=i.pause(),i.scrollTrigger=Y,Y.scrubDuration(p),Re=0,l||(l=i.vars.id)),N&&((!l0(N)||N.push)&&(N={snapTo:N}),"scrollBehavior"in ur.style&&bn.set(se?[ur,lu]:j,{scrollBehavior:"auto"}),gi.forEach(function(Zt){return co(Zt)&&Zt.target===(se?Ur.scrollingElement||lu:j)&&(Zt.smooth=!1)}),Ft=co(N.snapTo)?N.snapTo:N.snapTo==="labels"?Dae(i):N.snapTo==="labelsDirectional"?Oae(i):N.directional!==!1?function(Zt,Ln){return wP(N.snapTo)(Zt,oo()-ut<500?0:Ln.direction)}:bn.utils.snap(N.snapTo),lt=N.duration||{min:.1,max:2},lt=l0(lt)?IT(lt.min,lt.max):IT(lt,lt),Ot=bn.delayedCall(N.delay||Be/2||.1,function(){var Zt=Ne(),Ln=oo()-ut<500,dn=rt.tween;if((Ln||Math.abs(Y.getVelocity())<10)&&!dn&&!JC&&Ie!==Zt){var wn=(Zt-At)/zt,Bi=i&&!q?i.totalProgress():wn,Un=Ln?0:(Bi-dt)/(oo()-gT)*1e3||0,Jt=bn.utils.clamp(-wn,1-wn,mv(Un/2)*Un/.185),xi=wn+(N.inertia===!1?0:Jt),pn,W,J=N,me=J.onStart,De=J.onInterrupt,$e=J.onComplete;if(pn=Ft(xi,Y),vT(pn)||(pn=xi),W=Math.max(0,Math.round(At+pn*zt)),Zt<=qe&&Zt>=At&&W!==Zt){if(dn&&!dn._initted&&dn.data<=mv(W-Zt))return;N.inertia===!1&&(Jt=pn-wn),rt(W,{duration:lt(mv(Math.max(mv(xi-Bi),mv(pn-Bi))*.185/Un/.05||0)),ease:N.ease||"power3",data:mv(W-Zt),onInterrupt:function(){return Ot.restart(!0)&&De&&De(Y)},onComplete:function(){Y.update(),Ie=Ne(),i&&!q&&(le?le.resetTo("totalProgress",pn,i._tTime/i._tDur):i.progress(pn)),Re=dt=i&&!q?i.totalProgress():Y.progress,M&&M(Y),$e&&$e(Y)}},Zt,Jt*zt,W-Zt-Jt*zt),me&&me(Y,rt.tween)}}else Y.isActive&&Ie!==Zt&&Ot.restart(!0)}).pause()),l&&(XO[l]=Y),y=Y.trigger=Sl(y||_!==!0&&_),ln=y&&y._gsap&&y._gsap.stRevert,ln&&(ln=ln(Y)),_=_===!0?y:Sl(_),su(o)&&(o={targets:y,className:o}),_&&(v===!1||v===Xu||(v=!v&&_.parentNode&&_.parentNode.style&&$u(_.parentNode).display==="flex"?!1:Fs),Y.pin=_,Nt=bn.core.getCache(_),Nt.spacer?wt=Nt.pinState:(U&&(U=Sl(U),U&&!U.nodeType&&(U=U.current||U.nativeElement),Nt.spacerIsNative=!!U,U&&(Nt.spacerState=GA(U))),Nt.spacer=pe=U||Ur.createElement("div"),pe.classList.add("pin-spacer"),l&&pe.classList.add("pin-spacer-"+l),Nt.pinState=wt=GA(_)),n.force3D!==!1&&bn.set(_,{force3D:!0}),Y.spacer=pe=Nt.spacer,ue=$u(_),Yt=ue[v+B.os2],He=bn.getProperty(_),ze=bn.quickSetter(_,B.a,Qs),Q3(_,pe,ue),k=GA(_)),ee){Qt=l0(ee)?o4(ee,l4):l4,xe=VA("scroller-start",l,j,B,Qt,0),oe=VA("scroller-end",l,j,B,Qt,0,xe),Fe=xe["offset"+B.op.d2];var jn=Sl(mm(j,"content")||j);at=this.markerStart=VA("start",l,jn,B,Qt,Fe,0,L),Je=this.markerEnd=VA("end",l,jn,B,Qt,Fe,0,L),L&&(Tt=bn.quickSetter([at,Je],B.a,Qs)),!ae&&!(ad.length&&mm(j,"fixedMarkers")===!0)&&(Nae(se?ur:j),bn.set([xe,oe],{force3D:!0}),st=bn.quickSetter(xe,B.a,Qs),Pt=bn.quickSetter(oe,B.a,Qs))}if(L){var qt=L.vars.onUpdate,nn=L.vars.onUpdateParams;L.eventCallback("onUpdate",function(){Y.update(0,0,1),qt&&qt.apply(L,nn||[])})}if(Y.previous=function(){return fi[fi.indexOf(Y)-1]},Y.next=function(){return fi[fi.indexOf(Y)+1]},Y.revert=function(Zt,Ln){if(!Ln)return Y.kill(!0);var dn=Zt!==!1||!Y.enabled,wn=ao;dn!==Y.isReverted&&(dn&&(ht=Math.max(Ne(),Y.scroll.rec||0),Ee=Y.progress,it=i&&i.progress()),at&&[at,Je,xe,oe].forEach(function(Bi){return Bi.style.display=dn?"none":"block"}),dn&&(ao=Y,Y.update(dn)),_&&(!P||!Y.isActive)&&(dn?Pae(_,pe,wt):Q3(_,pe,$u(_),$t)),dn||Y.update(dn),ao=wn,Y.isReverted=dn)},Y.refresh=function(Zt,Ln,dn,wn){if(!((ao||!Y.enabled)&&!Ln)){if(_&&Zt&&sc){ya(r,"scrollEnd",bH);return}!Yo&&K&&K(Y),ao=Y,rt.tween&&!dn&&(rt.tween.kill(),rt.tween=0),le&&le.pause(),b&&i&&(i.revert({kill:!1}).invalidate(),i.getChildren?i.getChildren(!0,!0,!1).forEach(function(It){return It.vars.immediateRender&&It.render(0,!0,!0)}):i.vars.immediateRender&&i.render(0,!0,!0)),Y.isReverted||Y.revert(!0,!0),Y._subPinOffset=!1;var Bi=he(),Un=Ce(),Jt=L?L.duration():rd(j,B),xi=zt<=.01||!zt,pn=0,W=wn||0,J=l0(dn)?dn.end:n.end,me=n.endTrigger||y,De=l0(dn)?dn.start:n.start||(n.start===0||!y?0:_?"0 0":"0 100%"),$e=Y.pinnedContainer=n.pinnedContainer&&Sl(n.pinnedContainer,Y),je=y&&Math.max(0,fi.indexOf(Y))||0,_t=je,ct,pt,gt,Lt,bt,$,ce,Me,Ae,Se,mt,Et,Rt;for(ee&&l0(dn)&&(Et=bn.getProperty(xe,B.p),Rt=bn.getProperty(oe,B.p));_t-- >0;)$=fi[_t],$.end||$.refresh(0,1)||(ao=Y),ce=$.pin,ce&&(ce===y||ce===_||ce===$e)&&!$.isReverted&&(Se||(Se=[]),Se.unshift($),$.revert(!0,!0)),$!==fi[_t]&&(je--,_t--);for(co(De)&&(De=De(Y)),De=i4(De,"start",Y),At=d4(De,y,Bi,B,Ne(),at,xe,Y,Un,fe,ae,Jt,L,Y._startClamp&&"_startClamp")||(_?-.001:0),co(J)&&(J=J(Y)),su(J)&&!J.indexOf("+=")&&(~J.indexOf(" ")?J=(su(De)?De.split(" ")[0]:"")+J:(pn=Ow(J.substr(2),Bi),J=su(De)?De:(L?bn.utils.mapRange(0,L.duration(),L.scrollTrigger.start,L.scrollTrigger.end,At):At)+pn,me=y)),J=i4(J,"end",Y),qe=Math.max(At,d4(J||(me?"100% 0":Jt),me,Bi,B,Ne()+pn,Je,oe,Y,Un,fe,ae,Jt,L,Y._endClamp&&"_endClamp"))||-.001,pn=0,_t=je;_t--;)$=fi[_t]||{},ce=$.pin,ce&&$.start-$._pinPush<=At&&!L&&$.end>0&&(ct=$.end-(Y._startClamp?Math.max(0,$.start):$.start),(ce===y&&$.start-$._pinPush<At||ce===$e)&&isNaN(De)&&(pn+=ct*(1-$.progress)),ce===_&&(W+=ct));if(At+=pn,qe+=pn,Y._startClamp&&(Y._startClamp+=pn),Y._endClamp&&!Yo&&(Y._endClamp=qe||-.001,qe=Math.min(qe,rd(j,B))),zt=qe-At||(At-=.01)&&.001,xi&&(Ee=bn.utils.clamp(0,1,bn.utils.normalize(At,qe,ht))),Y._pinPush=W,at&&pn&&(ct={},ct[B.a]="+="+pn,$e&&(ct[B.p]="-="+Ne()),bn.set([at,Je],ct)),_&&!(qO&&Y.end>=rd(j,B)))ct=$u(_),Lt=B===Js,gt=Ne(),Bt=parseFloat(He(B.a))+W,!Jt&&qe>1&&(mt=(se?Ur.scrollingElement||lu:j).style,mt={style:mt,value:mt["overflow"+B.a.toUpperCase()]},se&&$u(ur)["overflow"+B.a.toUpperCase()]!=="scroll"&&(mt.style["overflow"+B.a.toUpperCase()]="scroll")),Q3(_,pe,ct),k=GA(_),pt=hh(_,!0),Me=ae&&wm(j,Lt?nl:Js)(),v?($t=[v+B.os2,zt+W+Qs],$t.t=pe,_t=v===Fs?_R(_,B)+zt+W:0,_t&&($t.push(B.d,_t+Qs),pe.style.flexBasis!=="auto"&&(pe.style.flexBasis=_t+Qs)),$v($t),$e&&fi.forEach(function(It){It.pin===$e&&It.vars.pinSpacing!==!1&&(It._subPinOffset=!0)}),ae&&Ne(ht)):(_t=_R(_,B),_t&&pe.style.flexBasis!=="auto"&&(pe.style.flexBasis=_t+Qs)),ae&&(bt={top:pt.top+(Lt?gt-At:Me)+Qs,left:pt.left+(Lt?Me:gt-At)+Qs,boxSizing:"border-box",position:"fixed"},bt[U0]=bt["max"+Rx]=Math.ceil(pt.width)+Qs,bt[L0]=bt["max"+AP]=Math.ceil(pt.height)+Qs,bt[Xu]=bt[Xu+GT]=bt[Xu+zT]=bt[Xu+kT]=bt[Xu+VT]="0",bt[Fs]=ct[Fs],bt[Fs+GT]=ct[Fs+GT],bt[Fs+zT]=ct[Fs+zT],bt[Fs+kT]=ct[Fs+kT],bt[Fs+VT]=ct[Fs+VT],Z=Iae(wt,bt,P),Yo&&Ne(0)),i?(Ae=i._initted,$3(1),i.render(i.duration(),!0,!0),Ct=He(B.a)-Bt+zt+W,nt=Math.abs(zt-Ct)>1,ae&&nt&&Z.splice(Z.length-2,2),i.render(0,!0,!0),Ae||i.invalidate(!0),i.parent||i.totalTime(i.totalTime()),$3(0)):Ct=zt,mt&&(mt.value?mt.style["overflow"+B.a.toUpperCase()]=mt.value:mt.style.removeProperty("overflow-"+B.a));else if(y&&Ne()&&!L)for(pt=y.parentNode;pt&&pt!==ur;)pt._pinOffset&&(At-=pt._pinOffset,qe-=pt._pinOffset),pt=pt.parentNode;Se&&Se.forEach(function(It){return It.revert(!1,!0)}),Y.start=At,Y.end=qe,fn=Sn=Yo?ht:Ne(),!L&&!Yo&&(fn<ht&&Ne(ht),Y.scroll.rec=0),Y.revert(!1,!0),ut=oo(),Ot&&(Ie=-1,Ot.restart(!0)),ao=0,i&&q&&(i._initted||it)&&i.progress()!==it&&i.progress(it||0,!0).render(i.time(),!0,!0),(xi||Ee!==Y.progress||L||b||i&&!i._initted)&&(i&&!q&&(i._initted||Ee||i.vars.immediateRender!==!1)&&i.totalProgress(L&&At<-.001&&!Ee?bn.utils.normalize(At,qe,0):Ee,!0),Y.progress=xi||(fn-At)/zt===Ee?0:Ee),_&&v&&(pe._pinOffset=Math.round(Y.progress*Ct)),le&&le.invalidate(),isNaN(Et)||(Et-=bn.getProperty(xe,B.p),Rt-=bn.getProperty(oe,B.p),kA(xe,B,Et),kA(at,B,Et-(wn||0)),kA(oe,B,Rt),kA(Je,B,Rt-(wn||0))),xi&&!Yo&&Y.update(),d&&!Yo&&!Dt&&(Dt=!0,d(Y),Dt=!1)}},Y.getVelocity=function(){return(Ne()-Sn)/(oo()-gT)*1e3||0},Y.endAnimation=function(){HS(Y.callbackAnimation),i&&(le?le.progress(1):i.paused()?q||HS(i,Y.direction<0,1):HS(i,i.reversed()))},Y.labelToScroll=function(Zt){return i&&i.labels&&(At||Y.refresh()||At)+i.labels[Zt]/i.duration()*zt||0},Y.getTrailing=function(Zt){var Ln=fi.indexOf(Y),dn=Y.direction>0?fi.slice(0,Ln).reverse():fi.slice(Ln+1);return(su(Zt)?dn.filter(function(wn){return wn.vars.preventOverlaps===Zt}):dn).filter(function(wn){return Y.direction>0?wn.end<=At:wn.start>=qe})},Y.update=function(Zt,Ln,dn){if(!(L&&!dn&&!Zt)){var wn=Yo===!0?ht:Y.scroll(),Bi=Zt?0:(wn-At)/zt,Un=Bi<0?0:Bi>1?1:Bi||0,Jt=Y.progress,xi,pn,W,J,me,De,$e,je;if(Ln&&(Sn=fn,fn=L?Ne():wn,N&&(dt=Re,Re=i&&!q?i.totalProgress():Un)),E&&_&&!ao&&!PA&&sc&&(!Un&&At<wn+(wn-Sn)/(oo()-gT)*E?Un=1e-4:Un===1&&qe>wn+(wn-Sn)/(oo()-gT)*E&&(Un=.9999)),Un!==Jt&&Y.enabled){if(xi=Y.isActive=!!Un&&Un<1,pn=!!Jt&&Jt<1,De=xi!==pn,me=De||!!Un!=!!Jt,Y.direction=Un>Jt?1:-1,Y.progress=Un,me&&!ao&&(W=Un&&!Jt?0:Un===1?1:Jt===1?2:3,q&&(J=!De&&X[W+1]!=="none"&&X[W+1]||X[W],je=i&&(J==="complete"||J==="reset"||J in i))),O&&(De||je)&&(je||p||!i)&&(co(O)?O(Y):Y.getTrailing(O).forEach(function(gt){return gt.endAnimation()})),q||(le&&!ao&&!PA?(le._dp._time-le._start!==le._time&&le.render(le._dp._time-le._start),le.resetTo?le.resetTo("totalProgress",Un,i._tTime/i._tDur):(le.vars.totalProgress=Un,le.invalidate().restart())):i&&i.totalProgress(Un,!!(ao&&(ut||Zt)))),_){if(Zt&&v&&(pe.style[v+B.os2]=Yt),!ae)ze(_T(Bt+Ct*Un));else if(me){if($e=!Zt&&Un>Jt&&qe+1>wn&&wn+1>=rd(j,B),P)if(!Zt&&(xi||$e)){var _t=hh(_,!0),ct=wn-At;h4(_,ur,_t.top+(B===Js?ct:0)+Qs,_t.left+(B===Js?0:ct)+Qs)}else h4(_,pe);$v(xi||$e?Z:k),nt&&Un<1&&xi||ze(Bt+(Un===1&&!$e?Ct:0))}}N&&!rt.tween&&!ao&&!PA&&Ot.restart(!0),o&&(De||R&&Un&&(Un<1||!j3))&&v1(o.targets).forEach(function(gt){return gt.classList[xi||R?"add":"remove"](o.className)}),a&&!q&&!Zt&&a(Y),me&&!ao?(q&&(je&&(J==="complete"?i.pause().totalProgress(1):J==="reset"?i.restart(!0).pause():J==="restart"?i.restart(!0):i[J]()),a&&a(Y)),(De||!j3)&&(c&&De&&Z3(Y,c),V[W]&&Z3(Y,V[W]),R&&(Un===1?Y.kill(!1,1):V[W]=0),De||(W=Un===1?1:3,V[W]&&Z3(Y,V[W]))),F&&!xi&&Math.abs(Y.getVelocity())>(vT(F)?F:2500)&&(HS(Y.callbackAnimation),le?le.progress(1):HS(i,J==="reverse"?1:!Un,1))):q&&a&&!ao&&a(Y)}if(Pt){var pt=L?wn/L.duration()*(L._caScrollDist||0):wn;st(pt+(xe._isFlipped?1:0)),Pt(pt)}Tt&&Tt(-wn/L.duration()*(L._caScrollDist||0))}},Y.enable=function(Zt,Ln){Y.enabled||(Y.enabled=!0,ya(j,"resize",xT),se||ya(j,"scroll",gv),K&&ya(r,"refreshInit",K),Zt!==!1&&(Y.progress=Ee=0,fn=Sn=Ie=Ne()),Ln!==!1&&Y.refresh())},Y.getTween=function(Zt){return Zt&&rt?rt.tween:le},Y.setPositions=function(Zt,Ln,dn,wn){if(L){var Bi=L.scrollTrigger,Un=L.duration(),Jt=Bi.end-Bi.start;Zt=Bi.start+Jt*Zt/Un,Ln=Bi.start+Jt*Ln/Un}Y.refresh(!1,!1,{start:r4(Zt,dn&&!!Y._startClamp),end:r4(Ln,dn&&!!Y._endClamp)},wn),Y.update()},Y.adjustPinSpacing=function(Zt){if($t&&Zt){var Ln=$t.indexOf(B.d)+1;$t[Ln]=parseFloat($t[Ln])+Zt+Qs,$t[1]=parseFloat($t[1])+Zt+Qs,$v($t)}},Y.disable=function(Zt,Ln){if(Zt!==!1&&Y.revert(!0,!0),Y.enabled&&(Y.enabled=Y.isActive=!1,Ln||le&&le.pause(),ht=0,Nt&&(Nt.uncache=1),K&&ma(r,"refreshInit",K),Ot&&(Ot.pause(),rt.tween&&rt.tween.kill()&&(rt.tween=0)),!se)){for(var dn=fi.length;dn--;)if(fi[dn].scroller===j&&fi[dn]!==Y)return;ma(j,"resize",xT),se||ma(j,"scroll",gv)}},Y.kill=function(Zt,Ln){Y.disable(Zt,Ln),le&&!Ln&&le.kill(),l&&delete XO[l];var dn=fi.indexOf(Y);dn>=0&&fi.splice(dn,1),dn===jo&&Lw>0&&jo--,dn=0,fi.forEach(function(wn){return wn.scroller===Y.scroller&&(dn=1)}),dn||Yo||(Y.scroll.rec=0),i&&(i.scrollTrigger=null,Zt&&i.revert({kill:!1}),Ln||i.kill()),at&&[at,Je,xe,oe].forEach(function(wn){return wn.parentNode&&wn.parentNode.removeChild(wn)}),HT===Y&&(HT=0),_&&(Nt&&(Nt.uncache=1),dn=0,fi.forEach(function(wn){return wn.pin===_&&dn++}),dn||(Nt.spacer=0)),n.onKill&&n.onKill(Y)},fi.push(Y),Y.enable(!1,!1),ln&&ln(Y),i&&i.add&&!zt){var Bn=Y.update;Y.update=function(){Y.update=Bn,gi.cache++,At||qe||Y.refresh()},bn.delayedCall(.01,Y.update),zt=.01,At=qe=0}else Y.refresh();_&&Lae()},r.register=function(n){return Rv||(bn=n||mH(),pH()&&window.document&&r.enable(),Rv=yT),Rv},r.defaults=function(n){if(n)for(var i in n)zA[i]=n[i];return zA},r.disable=function(n,i){yT=0,fi.forEach(function(a){return a[i?"kill":"disable"](n)}),ma(mi,"wheel",gv),ma(Ur,"scroll",gv),clearInterval(LA),ma(Ur,"touchcancel",Kf),ma(ur,"touchstart",Kf),IA(ma,Ur,"pointerdown,touchstart,mousedown",s4),IA(ma,Ur,"pointerup,touchend,mouseup",a4),yR.kill(),BA(ma);for(var s=0;s<gi.length;s+=3)FA(ma,gi[s],gi[s+1]),FA(ma,gi[s],gi[s+2])},r.enable=function(){if(mi=window,Ur=document,lu=Ur.documentElement,ur=Ur.body,bn&&(v1=bn.utils.toArray,IT=bn.utils.clamp,WO=bn.core.context||Kf,$3=bn.core.suppressOverwrites||Kf,SP=mi.history.scrollRestoration||"auto",$O=mi.pageYOffset||0,bn.core.globals("ScrollTrigger",r),ur)){yT=1,Xv=document.createElement("div"),Xv.style.height="100vh",Xv.style.position="absolute",MH(),wae(),Rs.register(bn),r.isTouch=Rs.isTouch,jp=Rs.isTouch&&/(iPad|iPhone|iPod|Mac)/g.test(navigator.userAgent),HO=Rs.isTouch===1,ya(mi,"wheel",gv),bP=[mi,Ur,lu,ur],bn.matchMedia?(r.matchMedia=function(c){var d=bn.matchMedia(),p;for(p in c)d.add(p,c[p]);return d},bn.addEventListener("matchMediaInit",function(){TH(),RP()}),bn.addEventListener("matchMediaRevert",function(){return SH()}),bn.addEventListener("matchMedia",function(){v0(0,1),vy("matchMedia")}),bn.matchMedia().add("(orientation: portrait)",function(){return K3(),K3})):console.warn("Requires GSAP 3.11.0 or later"),K3(),ya(Ur,"scroll",gv);var n=ur.hasAttribute("style"),i=ur.style,s=i.borderTopStyle,a=bn.core.Animation.prototype,o,l;for(a.revert||Object.defineProperty(a,"revert",{value:function(){return this.time(-.01,!0)}}),i.borderTopStyle="solid",o=hh(ur),Js.m=Math.round(o.top+Js.sc())||0,nl.m=Math.round(o.left+nl.sc())||0,s?i.borderTopStyle=s:i.removeProperty("border-top-style"),n||(ur.setAttribute("style",""),ur.removeAttribute("style")),LA=setInterval(u4,250),bn.delayedCall(.5,function(){return PA=0}),ya(Ur,"touchcancel",Kf),ya(ur,"touchstart",Kf),IA(ya,Ur,"pointerdown,touchstart,mousedown",s4),IA(ya,Ur,"pointerup,touchend,mouseup",a4),kO=bn.utils.checkPrefix("transform"),Pw.push(kO),Rv=oo(),yR=bn.delayedCall(.2,v0).pause(),Cv=[Ur,"visibilitychange",function(){var c=mi.innerWidth,d=mi.innerHeight;Ur.hidden?(t4=c,n4=d):(t4!==c||n4!==d)&&xT()},Ur,"DOMContentLoaded",v0,mi,"load",v0,mi,"resize",xT],BA(ya),fi.forEach(function(c){return c.enable(0,1)}),l=0;l<gi.length;l+=3)FA(ma,gi[l],gi[l+1]),FA(ma,gi[l],gi[l+2])}},r.config=function(n){"limitCallbacks"in n&&(j3=!!n.limitCallbacks);var i=n.syncInterval;i&&clearInterval(LA)||(LA=i)&&setInterval(u4,i),"ignoreMobileResize"in n&&(HO=r.isTouch===1&&n.ignoreMobileResize),"autoRefreshEvents"in n&&(BA(ma)||BA(ya,n.autoRefreshEvents||"none"),fH=(n.autoRefreshEvents+"").indexOf("resize")===-1)},r.scrollerProxy=function(n,i){var s=Sl(n),a=gi.indexOf(s),o=yy(s);~a&&gi.splice(a,o?6:2),i&&(o?ad.unshift(mi,i,ur,i,lu,i):ad.unshift(s,i))},r.clearMatchMedia=function(n){fi.forEach(function(i){return i._ctx&&i._ctx.query===n&&i._ctx.kill(!0,!0)})},r.isInViewport=function(n,i,s){var a=(su(n)?Sl(n):n).getBoundingClientRect(),o=a[s?U0:L0]*i||0;return s?a.right-o>0&&a.left+o<mi.innerWidth:a.bottom-o>0&&a.top+o<mi.innerHeight},r.positionInViewport=function(n,i,s){su(n)&&(n=Sl(n));var a=n.getBoundingClientRect(),o=a[s?U0:L0],l=i==null?o/2:i in vR?vR[i]*o:~i.indexOf("%")?parseFloat(i)*o/100:parseFloat(i)||0;return s?(a.left+l)/mi.innerWidth:(a.top+l)/mi.innerHeight},r.killAll=function(n){if(fi.slice(0).forEach(function(s){return s.vars.id!=="ScrollSmoother"&&s.kill()}),n!==!0){var i=_y.killAll||[];_y={},i.forEach(function(s){return s()})}},r})();Ei.version="3.14.2";Ei.saveStyles=function(r){return r?v1(r).forEach(function(e){if(e&&e.style){var t=iu.indexOf(e);t>=0&&iu.splice(t,5),iu.push(e,e.style.cssText,e.getBBox&&e.getAttribute("transform"),bn.core.getCache(e),WO())}}):iu};Ei.revert=function(r,e){return RP(!r,e)};Ei.create=function(r,e){return new Ei(r,e)};Ei.refresh=function(r){return r?xT(!0):(Rv||Ei.register())&&v0(!0)};Ei.update=function(r){return++gi.cache&&Mh(r===!0?2:0)};Ei.clearScrollMemory=EH;Ei.maxScroll=function(r,e){return rd(r,e?nl:Js)};Ei.getScrollFunc=function(r,e){return wm(Sl(r),e?nl:Js)};Ei.getById=function(r){return XO[r]};Ei.getAll=function(){return fi.filter(function(r){return r.vars.id!=="ScrollSmoother"})};Ei.isScrolling=function(){return!!sc};Ei.snapDirectional=wP;Ei.addEventListener=function(r,e){var t=_y[r]||(_y[r]=[]);~t.indexOf(e)||t.push(e)};Ei.removeEventListener=function(r,e){var t=_y[r],n=t&&t.indexOf(e);n>=0&&t.splice(n,1)};Ei.batch=function(r,e){var t=[],n={},i=e.interval||.016,s=e.batchMax||1e9,a=function(c,d){var p=[],y=[],_=bn.delayedCall(i,function(){d(p,y),p=[],y=[]}).pause();return function(v){p.length||_.restart(!0),p.push(v.trigger),y.push(v),s<=p.length&&_.progress(1)}},o;for(o in e)n[o]=o.substr(0,2)==="on"&&co(e[o])&&o!=="onRefreshInit"?a(o,e[o]):e[o];return co(s)&&(s=s(),ya(Ei,"refresh",function(){return s=e.batchMax()})),v1(r).forEach(function(l){var c={};for(o in n)c[o]=n[o];c.trigger=l,t.push(Ei.create(c))}),t};var m4=function(e,t,n,i){return t>i?e(i):t<0&&e(0),n>i?(i-t)/(n-t):n<0?t/(t-n):1},J3=function r(e,t){t===!0?e.style.removeProperty("touch-action"):e.style.touchAction=t===!0?"auto":t?"pan-"+t+(Rs.isTouch?" pinch-zoom":""):"none",e===lu&&r(ur,t)},HA={auto:1,scroll:1},zae=function(e){var t=e.event,n=e.target,i=e.axis,s=(t.changedTouches?t.changedTouches[0]:t).target,a=s._gsap||bn.core.getCache(s),o=oo(),l;if(!a._isScrollT||o-a._isScrollT>2e3){for(;s&&s!==ur&&(s.scrollHeight<=s.clientHeight&&s.scrollWidth<=s.clientWidth||!(HA[(l=$u(s)).overflowY]||HA[l.overflowX]));)s=s.parentNode;a._isScroll=s&&s!==n&&!yy(s)&&(HA[(l=$u(s)).overflowY]||HA[l.overflowX]),a._isScrollT=o}(a._isScroll||i==="x")&&(t.stopPropagation(),t._gsapAllow=!0)},wH=function(e,t,n,i){return Rs.create({target:e,capture:!0,debounce:!1,lockAxis:!0,type:t,onWheel:i=i&&zae,onPress:i,onDrag:i,onScroll:i,onEnable:function(){return n&&ya(Ur,Rs.eventTypes[0],y4,!1,!0)},onDisable:function(){return ma(Ur,Rs.eventTypes[0],y4,!0)}})},Vae=/(input|label|select|textarea)/i,g4,y4=function(e){var t=Vae.test(e.target.tagName);(t||g4)&&(e._gsapAllow=!0,g4=t)},Gae=function(e){l0(e)||(e={}),e.preventDefault=e.isNormalizer=e.allowClicks=!0,e.type||(e.type="wheel,touch"),e.debounce=!!e.debounce,e.id=e.id||"normalizer";var t=e,n=t.normalizeScrollX,i=t.momentum,s=t.allowNestedScroll,a=t.onRelease,o,l,c=Sl(e.target)||lu,d=bn.core.globals().ScrollSmoother,p=d&&d.get(),y=jp&&(e.content&&Sl(e.content)||p&&e.content!==!1&&!p.smooth()&&p.content()),_=wm(c,Js),v=wm(c,nl),b=1,E=(Rs.isTouch&&mi.visualViewport?mi.visualViewport.scale*mi.visualViewport.width:mi.outerWidth)/mi.innerWidth,T=0,M=co(i)?function(){return i(o)}:function(){return i||2.8},R,N,P=wH(c,e.type,!0,s),U=function(){return N=!1},L=Kf,F=Kf,O=function(){l=rd(c,Js),F=IT(jp?1:0,l),n&&(L=IT(0,rd(c,nl))),R=P0},B=function(){y._gsap.y=_T(parseFloat(y._gsap.y)+_.offset)+"px",y.style.transform="matrix3d(1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, "+parseFloat(y._gsap.y)+", 0, 1)",_.offset=_.cacheID=0},q=function(){if(N){requestAnimationFrame(U);var ee=_T(o.deltaY/2),fe=F(_.v-ee);if(y&&fe!==_.v+_.offset){_.offset=fe-_.v;var Y=_T((parseFloat(y&&y._gsap.y)||0)-_.offset);y.style.transform="matrix3d(1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, "+Y+", 0, 1)",y._gsap.y=Y+"px",_.cacheID=gi.cache,Mh()}return!0}_.offset&&B(),N=!0},j,Q,se,ae,V=function(){O(),j.isActive()&&j.vars.scrollY>l&&(_()>l?j.progress(1)&&_(l):j.resetTo("scrollY",l))};return y&&bn.set(y,{y:"+=0"}),e.ignoreCheck=function(X){return jp&&X.type==="touchmove"&&q()||b>1.05&&X.type!=="touchstart"||o.isGesturing||X.touches&&X.touches.length>1},e.onPress=function(){N=!1;var X=b;b=_T((mi.visualViewport&&mi.visualViewport.scale||1)/E),j.pause(),X!==b&&J3(c,b>1.01?!0:n?!1:"x"),Q=v(),se=_(),O(),R=P0},e.onRelease=e.onGestureStart=function(X,ee){if(_.offset&&B(),!ee)ae.restart(!0);else{gi.cache++;var fe=M(),Y,K;n&&(Y=v(),K=Y+fe*.05*-X.velocityX/.227,fe*=m4(v,Y,K,rd(c,nl)),j.vars.scrollX=L(K)),Y=_(),K=Y+fe*.05*-X.velocityY/.227,fe*=m4(_,Y,K,rd(c,Js)),j.vars.scrollY=F(K),j.invalidate().duration(fe).play(.01),(jp&&j.vars.scrollY>=l||Y>=l-1)&&bn.to({},{onUpdate:V,duration:fe})}a&&a(X)},e.onWheel=function(){j._ts&&j.pause(),oo()-T>1e3&&(R=0,T=oo())},e.onChange=function(X,ee,fe,Y,K){if(P0!==R&&O(),ee&&n&&v(L(Y[2]===ee?Q+(X.startX-X.x):v()+ee-Y[1])),fe){_.offset&&B();var he=K[2]===fe,Ce=he?se+X.startY-X.y:_()+fe-K[1],Ie=F(Ce);he&&Ce!==Ie&&(se+=Ie-Ce),_(Ie)}(fe||ee)&&Mh()},e.onEnable=function(){J3(c,n?!1:"x"),Ei.addEventListener("refresh",V),ya(mi,"resize",V),_.smooth&&(_.target.style.scrollBehavior="auto",_.smooth=v.smooth=!1),P.enable()},e.onDisable=function(){J3(c,!0),ma(mi,"resize",V),Ei.removeEventListener("refresh",V),P.kill()},e.lockAxis=e.lockAxis!==!1,o=new Rs(e),o.iOS=jp,jp&&!_()&&_(1),jp&&bn.ticker.add(Kf),ae=o._dc,j=bn.to(o,{ease:"power4",paused:!0,inherit:!1,scrollX:n?"+=0.1":"+=0",scrollY:"+=0.1",modifiers:{scrollY:AH(_,_(),function(){return j.pause()})},onUpdate:Mh,onComplete:ae.vars.onComplete}),o};Ei.sort=function(r){if(co(r))return fi.sort(r);var e=mi.pageYOffset||0;return Ei.getAll().forEach(function(t){return t._sortY=t.trigger?e+t.trigger.getBoundingClientRect().top:t.start+mi.innerHeight}),fi.sort(r||function(t,n){return(t.vars.refreshPriority||0)*-1e6+(t.vars.containerAnimation?1e6:t._sortY)-((n.vars.containerAnimation?1e6:n._sortY)+(n.vars.refreshPriority||0)*-1e6)})};Ei.observe=function(r){return new Rs(r)};Ei.normalizeScroll=function(r){if(typeof r>"u")return $o;if(r===!0&&$o)return $o.enable();if(r===!1){$o&&$o.kill(),$o=r;return}var e=r instanceof Rs?r:Gae(r);return $o&&$o.target===e.target&&$o.kill(),yy(e.target)&&($o=e),e};Ei.core={_getVelocityProp:GO,_inputObserver:wH,_scrollers:gi,_proxies:ad,bridge:{ss:function(){sc||vy("scrollStart"),sc=oo()},ref:function(){return ao}}};mH()&&bn.registerPlugin(Ei);function xR(){return xR=Object.assign?Object.assign.bind():function(r){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var n in t)({}).hasOwnProperty.call(t,n)&&(r[n]=t[n])}return r},xR.apply(null,arguments)}function kae(r,e,t){return Math.max(e,Math.min(r,t))}const mo={toVector(r,e){return r===void 0&&(r=e),Array.isArray(r)?r:[r,r]},add(r,e){return[r[0]+e[0],r[1]+e[1]]},sub(r,e){return[r[0]-e[0],r[1]-e[1]]},addTo(r,e){r[0]+=e[0],r[1]+=e[1]},subTo(r,e){r[0]-=e[0],r[1]-=e[1]}};function _4(r,e,t){return e===0||Math.abs(e)===1/0?Math.pow(r,t*5):r*e*t/(e+t*r)}function v4(r,e,t,n=.15){return n===0?kae(r,e,t):r<e?-_4(e-r,t-e,n)+e:r>t?+_4(r-t,t-e,n)+t:r}function Hae(r,[e,t],[n,i]){const[[s,a],[o,l]]=r;return[v4(e,s,a,n),v4(t,o,l,i)]}function Wae(r,e){if(typeof r!="object"||r===null)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var n=t.call(r,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}function qae(r){var e=Wae(r,"string");return typeof e=="symbol"?e:String(e)}function Tl(r,e,t){return e=qae(e),e in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function x4(r,e){var t=Object.keys(r);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(r);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(r,i).enumerable})),t.push.apply(t,n)}return t}function fs(r){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?x4(Object(t),!0).forEach(function(n){Tl(r,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(t)):x4(Object(t)).forEach(function(n){Object.defineProperty(r,n,Object.getOwnPropertyDescriptor(t,n))})}return r}const RH={pointer:{start:"down",change:"move",end:"up"},mouse:{start:"down",change:"move",end:"up"},touch:{start:"start",change:"move",end:"end"},gesture:{start:"start",change:"change",end:"end"}};function b4(r){return r?r[0].toUpperCase()+r.slice(1):""}const Xae=["enter","leave"];function $ae(r=!1,e){return r&&!Xae.includes(e)}function jae(r,e="",t=!1){const n=RH[r],i=n&&n[e]||e;return"on"+b4(r)+b4(i)+($ae(t,i)?"Capture":"")}const Yae=["gotpointercapture","lostpointercapture"];function Zae(r){let e=r.substring(2).toLowerCase();const t=!!~e.indexOf("passive");t&&(e=e.replace("passive",""));const n=Yae.includes(e)?"capturecapture":"capture",i=!!~e.indexOf(n);return i&&(e=e.replace("capture","")),{device:e,capture:i,passive:t}}function Kae(r,e=""){const t=RH[r],n=t&&t[e]||e;return r+n}function eN(r){return"touches"in r}function CH(r){return eN(r)?"touch":"pointerType"in r?r.pointerType:"mouse"}function Qae(r){return Array.from(r.touches).filter(e=>{var t,n;return e.target===r.currentTarget||((t=r.currentTarget)===null||t===void 0||(n=t.contains)===null||n===void 0?void 0:n.call(t,e.target))})}function Jae(r){return r.type==="touchend"||r.type==="touchcancel"?r.changedTouches:r.targetTouches}function NH(r){return eN(r)?Jae(r)[0]:r}function eoe(r){return Qae(r).map(e=>e.identifier)}function eD(r){const e=NH(r);return eN(r)?e.identifier:e.pointerId}function S4(r){const e=NH(r);return[e.clientX,e.clientY]}function toe(r){const e={};if("buttons"in r&&(e.buttons=r.buttons),"shiftKey"in r){const{shiftKey:t,altKey:n,metaKey:i,ctrlKey:s}=r;Object.assign(e,{shiftKey:t,altKey:n,metaKey:i,ctrlKey:s})}return e}function bR(r,...e){return typeof r=="function"?r(...e):r}function noe(){}function ioe(...r){return r.length===0?noe:r.length===1?r[0]:function(){let e;for(const t of r)e=t.apply(this,arguments)||e;return e}}function T4(r,e){return Object.assign({},e,r||{})}const roe=32;class soe{constructor(e,t,n){this.ctrl=e,this.args=t,this.key=n,this.state||(this.state={},this.computeValues([0,0]),this.computeInitial(),this.init&&this.init(),this.reset())}get state(){return this.ctrl.state[this.key]}set state(e){this.ctrl.state[this.key]=e}get shared(){return this.ctrl.state.shared}get eventStore(){return this.ctrl.gestureEventStores[this.key]}get timeoutStore(){return this.ctrl.gestureTimeoutStores[this.key]}get config(){return this.ctrl.config[this.key]}get sharedConfig(){return this.ctrl.config.shared}get handler(){return this.ctrl.handlers[this.key]}reset(){const{state:e,shared:t,ingKey:n,args:i}=this;t[n]=e._active=e.active=e._blocked=e._force=!1,e._step=[!1,!1],e.intentional=!1,e._movement=[0,0],e._distance=[0,0],e._direction=[0,0],e._delta=[0,0],e._bounds=[[-1/0,1/0],[-1/0,1/0]],e.args=i,e.axis=void 0,e.memo=void 0,e.elapsedTime=e.timeDelta=0,e.direction=[0,0],e.distance=[0,0],e.overflow=[0,0],e._movementBound=[!1,!1],e.velocity=[0,0],e.movement=[0,0],e.delta=[0,0],e.timeStamp=0}start(e){const t=this.state,n=this.config;t._active||(this.reset(),this.computeInitial(),t._active=!0,t.target=e.target,t.currentTarget=e.currentTarget,t.lastOffset=n.from?bR(n.from,t):t.offset,t.offset=t.lastOffset,t.startTime=t.timeStamp=e.timeStamp)}computeValues(e){const t=this.state;t._values=e,t.values=this.config.transform(e)}computeInitial(){const e=this.state;e._initial=e._values,e.initial=e.values}compute(e){const{state:t,config:n,shared:i}=this;t.args=this.args;let s=0;if(e&&(t.event=e,n.preventDefault&&e.cancelable&&t.event.preventDefault(),t.type=e.type,i.touches=this.ctrl.pointerIds.size||this.ctrl.touchIds.size,i.locked=!!document.pointerLockElement,Object.assign(i,toe(e)),i.down=i.pressed=i.buttons%2===1||i.touches>0,s=e.timeStamp-t.timeStamp,t.timeStamp=e.timeStamp,t.elapsedTime=t.timeStamp-t.startTime),t._active){const U=t._delta.map(Math.abs);mo.addTo(t._distance,U)}this.axisIntent&&this.axisIntent(e);const[a,o]=t._movement,[l,c]=n.threshold,{_step:d,values:p}=t;if(n.hasCustomTransform?(d[0]===!1&&(d[0]=Math.abs(a)>=l&&p[0]),d[1]===!1&&(d[1]=Math.abs(o)>=c&&p[1])):(d[0]===!1&&(d[0]=Math.abs(a)>=l&&Math.sign(a)*l),d[1]===!1&&(d[1]=Math.abs(o)>=c&&Math.sign(o)*c)),t.intentional=d[0]!==!1||d[1]!==!1,!t.intentional)return;const y=[0,0];if(n.hasCustomTransform){const[U,L]=p;y[0]=d[0]!==!1?U-d[0]:0,y[1]=d[1]!==!1?L-d[1]:0}else y[0]=d[0]!==!1?a-d[0]:0,y[1]=d[1]!==!1?o-d[1]:0;this.restrictToAxis&&!t._blocked&&this.restrictToAxis(y);const _=t.offset,v=t._active&&!t._blocked||t.active;v&&(t.first=t._active&&!t.active,t.last=!t._active&&t.active,t.active=i[this.ingKey]=t._active,e&&(t.first&&("bounds"in n&&(t._bounds=bR(n.bounds,t)),this.setup&&this.setup()),t.movement=y,this.computeOffset()));const[b,E]=t.offset,[[T,M],[R,N]]=t._bounds;t.overflow=[b<T?-1:b>M?1:0,E<R?-1:E>N?1:0],t._movementBound[0]=t.overflow[0]?t._movementBound[0]===!1?t._movement[0]:t._movementBound[0]:!1,t._movementBound[1]=t.overflow[1]?t._movementBound[1]===!1?t._movement[1]:t._movementBound[1]:!1;const P=t._active?n.rubberband||[0,0]:[0,0];if(t.offset=Hae(t._bounds,t.offset,P),t.delta=mo.sub(t.offset,_),this.computeMovement(),v&&(!t.last||s>roe)){t.delta=mo.sub(t.offset,_);const U=t.delta.map(Math.abs);mo.addTo(t.distance,U),t.direction=t.delta.map(Math.sign),t._direction=t._delta.map(Math.sign),!t.first&&s>0&&(t.velocity=[U[0]/s,U[1]/s],t.timeDelta=s)}}emit(){const e=this.state,t=this.shared,n=this.config;if(e._active||this.clean(),(e._blocked||!e.intentional)&&!e._force&&!n.triggerAllEvents)return;const i=this.handler(fs(fs(fs({},t),e),{},{[this.aliasKey]:e.values}));i!==void 0&&(e.memo=i)}clean(){this.eventStore.clean(),this.timeoutStore.clean()}}function aoe([r,e],t){const n=Math.abs(r),i=Math.abs(e);if(n>i&&n>t)return"x";if(i>n&&i>t)return"y"}class ooe extends soe{constructor(...e){super(...e),Tl(this,"aliasKey","xy")}reset(){super.reset(),this.state.axis=void 0}init(){this.state.offset=[0,0],this.state.lastOffset=[0,0]}computeOffset(){this.state.offset=mo.add(this.state.lastOffset,this.state.movement)}computeMovement(){this.state.movement=mo.sub(this.state.offset,this.state.lastOffset)}axisIntent(e){const t=this.state,n=this.config;if(!t.axis&&e){const i=typeof n.axisThreshold=="object"?n.axisThreshold[CH(e)]:n.axisThreshold;t.axis=aoe(t._movement,i)}t._blocked=(n.lockDirection||!!n.axis)&&!t.axis||!!n.axis&&n.axis!==t.axis}restrictToAxis(e){if(this.config.axis||this.config.lockDirection)switch(this.state.axis){case"x":e[1]=0;break;case"y":e[0]=0;break}}}const loe=r=>r,E4=.15,DH={enabled(r=!0){return r},eventOptions(r,e,t){return fs(fs({},t.shared.eventOptions),r)},preventDefault(r=!1){return r},triggerAllEvents(r=!1){return r},rubberband(r=0){switch(r){case!0:return[E4,E4];case!1:return[0,0];default:return mo.toVector(r)}},from(r){if(typeof r=="function")return r;if(r!=null)return mo.toVector(r)},transform(r,e,t){const n=r||t.shared.transform;return this.hasCustomTransform=!!n,n||loe},threshold(r){return mo.toVector(r,0)}},uoe=0,eE=fs(fs({},DH),{},{axis(r,e,{axis:t}){if(this.lockDirection=t==="lock",!this.lockDirection)return t},axisThreshold(r=uoe){return r},bounds(r={}){if(typeof r=="function")return s=>eE.bounds(r(s));if("current"in r)return()=>r.current;if(typeof HTMLElement=="function"&&r instanceof HTMLElement)return r;const{left:e=-1/0,right:t=1/0,top:n=-1/0,bottom:i=1/0}=r;return[[e,t],[n,i]]}}),M4={ArrowRight:(r,e=1)=>[r*e,0],ArrowLeft:(r,e=1)=>[-1*r*e,0],ArrowUp:(r,e=1)=>[0,-1*r*e],ArrowDown:(r,e=1)=>[0,r*e]};class coe extends ooe{constructor(...e){super(...e),Tl(this,"ingKey","dragging")}reset(){super.reset();const e=this.state;e._pointerId=void 0,e._pointerActive=!1,e._keyboardActive=!1,e._preventScroll=!1,e._delayed=!1,e.swipe=[0,0],e.tap=!1,e.canceled=!1,e.cancel=this.cancel.bind(this)}setup(){const e=this.state;if(e._bounds instanceof HTMLElement){const t=e._bounds.getBoundingClientRect(),n=e.currentTarget.getBoundingClientRect(),i={left:t.left-n.left+e.offset[0],right:t.right-n.right+e.offset[0],top:t.top-n.top+e.offset[1],bottom:t.bottom-n.bottom+e.offset[1]};e._bounds=eE.bounds(i)}}cancel(){const e=this.state;e.canceled||(e.canceled=!0,e._active=!1,setTimeout(()=>{this.compute(),this.emit()},0))}setActive(){this.state._active=this.state._pointerActive||this.state._keyboardActive}clean(){this.pointerClean(),this.state._pointerActive=!1,this.state._keyboardActive=!1,super.clean()}pointerDown(e){const t=this.config,n=this.state;if(e.buttons!=null&&(Array.isArray(t.pointerButtons)?!t.pointerButtons.includes(e.buttons):t.pointerButtons!==-1&&t.pointerButtons!==e.buttons))return;const i=this.ctrl.setEventIds(e);t.pointerCapture&&e.target.setPointerCapture(e.pointerId),!(i&&i.size>1&&n._pointerActive)&&(this.start(e),this.setupPointer(e),n._pointerId=eD(e),n._pointerActive=!0,this.computeValues(S4(e)),this.computeInitial(),t.preventScrollAxis&&CH(e)!=="mouse"?(n._active=!1,this.setupScrollPrevention(e)):t.delay>0?(this.setupDelayTrigger(e),t.triggerAllEvents&&(this.compute(e),this.emit())):this.startPointerDrag(e))}startPointerDrag(e){const t=this.state;t._active=!0,t._preventScroll=!0,t._delayed=!1,this.compute(e),this.emit()}pointerMove(e){const t=this.state,n=this.config;if(!t._pointerActive)return;const i=eD(e);if(t._pointerId!==void 0&&i!==t._pointerId)return;const s=S4(e);if(document.pointerLockElement===e.target?t._delta=[e.movementX,e.movementY]:(t._delta=mo.sub(s,t._values),this.computeValues(s)),mo.addTo(t._movement,t._delta),this.compute(e),t._delayed&&t.intentional){this.timeoutStore.remove("dragDelay"),t.active=!1,this.startPointerDrag(e);return}if(n.preventScrollAxis&&!t._preventScroll)if(t.axis)if(t.axis===n.preventScrollAxis||n.preventScrollAxis==="xy"){t._active=!1,this.clean();return}else{this.timeoutStore.remove("startPointerDrag"),this.startPointerDrag(e);return}else return;this.emit()}pointerUp(e){this.ctrl.setEventIds(e);try{this.config.pointerCapture&&e.target.hasPointerCapture(e.pointerId)&&e.target.releasePointerCapture(e.pointerId)}catch{}const t=this.state,n=this.config;if(!t._active||!t._pointerActive)return;const i=eD(e);if(t._pointerId!==void 0&&i!==t._pointerId)return;this.state._pointerActive=!1,this.setActive(),this.compute(e);const[s,a]=t._distance;if(t.tap=s<=n.tapsThreshold&&a<=n.tapsThreshold,t.tap&&n.filterTaps)t._force=!0;else{const[o,l]=t._delta,[c,d]=t._movement,[p,y]=n.swipe.velocity,[_,v]=n.swipe.distance,b=n.swipe.duration;if(t.elapsedTime<b){const E=Math.abs(o/t.timeDelta),T=Math.abs(l/t.timeDelta);E>p&&Math.abs(c)>_&&(t.swipe[0]=Math.sign(o)),T>y&&Math.abs(d)>v&&(t.swipe[1]=Math.sign(l))}}this.emit()}pointerClick(e){!this.state.tap&&e.detail>0&&(e.preventDefault(),e.stopPropagation())}setupPointer(e){const t=this.config,n=t.device;t.pointerLock&&e.currentTarget.requestPointerLock(),t.pointerCapture||(this.eventStore.add(this.sharedConfig.window,n,"change",this.pointerMove.bind(this)),this.eventStore.add(this.sharedConfig.window,n,"end",this.pointerUp.bind(this)),this.eventStore.add(this.sharedConfig.window,n,"cancel",this.pointerUp.bind(this)))}pointerClean(){this.config.pointerLock&&document.pointerLockElement===this.state.currentTarget&&document.exitPointerLock()}preventScroll(e){this.state._preventScroll&&e.cancelable&&e.preventDefault()}setupScrollPrevention(e){this.state._preventScroll=!1,foe(e);const t=this.eventStore.add(this.sharedConfig.window,"touch","change",this.preventScroll.bind(this),{passive:!1});this.eventStore.add(this.sharedConfig.window,"touch","end",t),this.eventStore.add(this.sharedConfig.window,"touch","cancel",t),this.timeoutStore.add("startPointerDrag",this.startPointerDrag.bind(this),this.config.preventScrollDelay,e)}setupDelayTrigger(e){this.state._delayed=!0,this.timeoutStore.add("dragDelay",()=>{this.state._step=[0,0],this.startPointerDrag(e)},this.config.delay)}keyDown(e){const t=M4[e.key];if(t){const n=this.state,i=e.shiftKey?10:e.altKey?.1:1;this.start(e),n._delta=t(this.config.keyboardDisplacement,i),n._keyboardActive=!0,mo.addTo(n._movement,n._delta),this.compute(e),this.emit()}}keyUp(e){e.key in M4&&(this.state._keyboardActive=!1,this.setActive(),this.compute(e),this.emit())}bind(e){const t=this.config.device;e(t,"start",this.pointerDown.bind(this)),this.config.pointerCapture&&(e(t,"change",this.pointerMove.bind(this)),e(t,"end",this.pointerUp.bind(this)),e(t,"cancel",this.pointerUp.bind(this)),e("lostPointerCapture","",this.pointerUp.bind(this))),this.config.keys&&(e("key","down",this.keyDown.bind(this)),e("key","up",this.keyUp.bind(this))),this.config.filterTaps&&e("click","",this.pointerClick.bind(this),{capture:!0,passive:!1})}}function foe(r){"persist"in r&&typeof r.persist=="function"&&r.persist()}const tE=typeof window<"u"&&window.document&&window.document.createElement;function OH(){return tE&&"ontouchstart"in window}function doe(){return OH()||tE&&window.navigator.maxTouchPoints>1}function hoe(){return tE&&"onpointerdown"in window}function poe(){return tE&&"exitPointerLock"in window.document}function moe(){try{return"constructor"in GestureEvent}catch{return!1}}const ju={isBrowser:tE,gesture:moe(),touch:OH(),touchscreen:doe(),pointer:hoe(),pointerLock:poe()},goe=250,yoe=180,_oe=.5,voe=50,xoe=250,boe=10,A4={mouse:0,touch:0,pen:8},Soe=fs(fs({},eE),{},{device(r,e,{pointer:{touch:t=!1,lock:n=!1,mouse:i=!1}={}}){return this.pointerLock=n&&ju.pointerLock,ju.touch&&t?"touch":this.pointerLock?"mouse":ju.pointer&&!i?"pointer":ju.touch?"touch":"mouse"},preventScrollAxis(r,e,{preventScroll:t}){if(this.preventScrollDelay=typeof t=="number"?t:t||t===void 0&&r?goe:void 0,!(!ju.touchscreen||t===!1))return r||(t!==void 0?"y":void 0)},pointerCapture(r,e,{pointer:{capture:t=!0,buttons:n=1,keys:i=!0}={}}){return this.pointerButtons=n,this.keys=i,!this.pointerLock&&this.device==="pointer"&&t},threshold(r,e,{filterTaps:t=!1,tapsThreshold:n=3,axis:i=void 0}){const s=mo.toVector(r,t?n:i?1:0);return this.filterTaps=t,this.tapsThreshold=n,s},swipe({velocity:r=_oe,distance:e=voe,duration:t=xoe}={}){return{velocity:this.transform(mo.toVector(r)),distance:this.transform(mo.toVector(e)),duration:t}},delay(r=0){switch(r){case!0:return yoe;case!1:return 0;default:return r}},axisThreshold(r){return r?fs(fs({},A4),r):A4},keyboardDisplacement(r=boe){return r}});fs(fs({},DH),{},{device(r,e,{shared:t,pointer:{touch:n=!1}={}}){if(t.target&&!ju.touch&&ju.gesture)return"gesture";if(ju.touch&&n)return"touch";if(ju.touchscreen){if(ju.pointer)return"pointer";if(ju.touch)return"touch"}},bounds(r,e,{scaleBounds:t={},angleBounds:n={}}){const i=a=>{const o=T4(bR(t,a),{min:-1/0,max:1/0});return[o.min,o.max]},s=a=>{const o=T4(bR(n,a),{min:-1/0,max:1/0});return[o.min,o.max]};return typeof t!="function"&&typeof n!="function"?[i(),s()]:a=>[i(a),s(a)]},threshold(r,e,t){return this.lockDirection=t.axis==="lock",mo.toVector(r,this.lockDirection?[.1,3]:0)},modifierKey(r){return r===void 0?"ctrlKey":r},pinchOnWheel(r=!0){return r}});fs(fs({},eE),{},{mouseOnly:(r=!0)=>r});fs(fs({},eE),{},{mouseOnly:(r=!0)=>r});const UH=new Map,YO=new Map;function Toe(r){UH.set(r.key,r.engine),YO.set(r.key,r.resolver)}const Eoe={key:"drag",engine:coe,resolver:Soe};function Moe(r,e){if(r==null)return{};var t={},n=Object.keys(r),i,s;for(s=0;s<n.length;s++)i=n[s],!(e.indexOf(i)>=0)&&(t[i]=r[i]);return t}function Aoe(r,e){if(r==null)return{};var t=Moe(r,e),n,i;if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(r);for(i=0;i<s.length;i++)n=s[i],!(e.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(r,n)&&(t[n]=r[n])}return t}const woe={target(r){if(r)return()=>"current"in r?r.current:r},enabled(r=!0){return r},window(r=ju.isBrowser?window:void 0){return r},eventOptions({passive:r=!0,capture:e=!1}={}){return{passive:r,capture:e}},transform(r){return r}},Roe=["target","eventOptions","window","enabled","transform"];function Iw(r={},e){const t={};for(const[n,i]of Object.entries(e))switch(typeof i){case"function":t[n]=i.call(t,r[n],n,r);break;case"object":t[n]=Iw(r[n],i);break;case"boolean":i&&(t[n]=r[n]);break}return t}function Coe(r,e,t={}){const n=r,{target:i,eventOptions:s,window:a,enabled:o,transform:l}=n,c=Aoe(n,Roe);if(t.shared=Iw({target:i,eventOptions:s,window:a,enabled:o,transform:l},woe),e){const d=YO.get(e);t[e]=Iw(fs({shared:t.shared},c),d)}else for(const d in c){const p=YO.get(d);p&&(t[d]=Iw(fs({shared:t.shared},c[d]),p))}return t}class LH{constructor(e,t){Tl(this,"_listeners",new Set),this._ctrl=e,this._gestureKey=t}add(e,t,n,i,s){const a=this._listeners,o=Kae(t,n),l=this._gestureKey?this._ctrl.config[this._gestureKey].eventOptions:{},c=fs(fs({},l),s);e.addEventListener(o,i,c);const d=()=>{e.removeEventListener(o,i,c),a.delete(d)};return a.add(d),d}clean(){this._listeners.forEach(e=>e()),this._listeners.clear()}}class Noe{constructor(){Tl(this,"_timeouts",new Map)}add(e,t,n=140,...i){this.remove(e),this._timeouts.set(e,window.setTimeout(t,n,...i))}remove(e){const t=this._timeouts.get(e);t&&window.clearTimeout(t)}clean(){this._timeouts.forEach(e=>{window.clearTimeout(e)}),this._timeouts.clear()}}class Doe{constructor(e){Tl(this,"gestures",new Set),Tl(this,"_targetEventStore",new LH(this)),Tl(this,"gestureEventStores",{}),Tl(this,"gestureTimeoutStores",{}),Tl(this,"handlers",{}),Tl(this,"config",{}),Tl(this,"pointerIds",new Set),Tl(this,"touchIds",new Set),Tl(this,"state",{shared:{shiftKey:!1,metaKey:!1,ctrlKey:!1,altKey:!1}}),Ooe(this,e)}setEventIds(e){if(eN(e))return this.touchIds=new Set(eoe(e)),this.touchIds;if("pointerId"in e)return e.type==="pointerup"||e.type==="pointercancel"?this.pointerIds.delete(e.pointerId):e.type==="pointerdown"&&this.pointerIds.add(e.pointerId),this.pointerIds}applyHandlers(e,t){this.handlers=e,this.nativeHandlers=t}applyConfig(e,t){this.config=Coe(e,t,this.config)}clean(){this._targetEventStore.clean();for(const e of this.gestures)this.gestureEventStores[e].clean(),this.gestureTimeoutStores[e].clean()}effect(){return this.config.shared.target&&this.bind(),()=>this._targetEventStore.clean()}bind(...e){const t=this.config.shared,n={};let i;if(!(t.target&&(i=t.target(),!i))){if(t.enabled){for(const a of this.gestures){const o=this.config[a],l=w4(n,o.eventOptions,!!i);if(o.enabled){const c=UH.get(a);new c(this,e,a).bind(l)}}const s=w4(n,t.eventOptions,!!i);for(const a in this.nativeHandlers)s(a,"",o=>this.nativeHandlers[a](fs(fs({},this.state.shared),{},{event:o,args:e})),void 0,!0)}for(const s in n)n[s]=ioe(...n[s]);if(!i)return n;for(const s in n){const{device:a,capture:o,passive:l}=Zae(s);this._targetEventStore.add(i,a,"",n[s],{capture:o,passive:l})}}}}function yv(r,e){r.gestures.add(e),r.gestureEventStores[e]=new LH(r,e),r.gestureTimeoutStores[e]=new Noe}function Ooe(r,e){e.drag&&yv(r,"drag"),e.wheel&&yv(r,"wheel"),e.scroll&&yv(r,"scroll"),e.move&&yv(r,"move"),e.pinch&&yv(r,"pinch"),e.hover&&yv(r,"hover")}const w4=(r,e,t)=>(n,i,s,a={},o=!1)=>{var l,c;const d=(l=a.capture)!==null&&l!==void 0?l:e.capture,p=(c=a.passive)!==null&&c!==void 0?c:e.passive;let y=o?n:jae(n,i,d);t&&p&&(y+="Passive"),r[y]=r[y]||[],r[y].push(s)};function Uoe(r,e={},t,n){const i=ve.useMemo(()=>new Doe(r),[]);if(i.applyHandlers(r,n),i.applyConfig(e,t),ve.useEffect(i.effect.bind(i)),ve.useEffect(()=>i.clean.bind(i),[]),e.target===void 0)return i.bind.bind(i)}function Loe(r,e){return Toe(Eoe),Uoe({drag:r},e||{},"drag")}const PH=parseInt(Lm.replace(/\D+/g,""));var Yu=Uint8Array,um=Uint16Array,ZO=Uint32Array,BH=new Yu([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),IH=new Yu([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),Poe=new Yu([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),FH=function(r,e){for(var t=new um(31),n=0;n<31;++n)t[n]=e+=1<<r[n-1];for(var i=new ZO(t[30]),n=1;n<30;++n)for(var s=t[n];s<t[n+1];++s)i[s]=s-t[n]<<5|n;return[t,i]},zH=FH(BH,2),VH=zH[0],Boe=zH[1];VH[28]=258,Boe[258]=28;var Ioe=FH(IH,0),Foe=Ioe[0],KO=new um(32768);for(var Fr=0;Fr<32768;++Fr){var Hp=(Fr&43690)>>>1|(Fr&21845)<<1;Hp=(Hp&52428)>>>2|(Hp&13107)<<2,Hp=(Hp&61680)>>>4|(Hp&3855)<<4,KO[Fr]=((Hp&65280)>>>8|(Hp&255)<<8)>>>1}var WT=(function(r,e,t){for(var n=r.length,i=0,s=new um(e);i<n;++i)++s[r[i]-1];var a=new um(e);for(i=0;i<e;++i)a[i]=a[i-1]+s[i-1]<<1;var o;if(t){o=new um(1<<e);var l=15-e;for(i=0;i<n;++i)if(r[i])for(var c=i<<4|r[i],d=e-r[i],p=a[r[i]-1]++<<d,y=p|(1<<d)-1;p<=y;++p)o[KO[p]>>>l]=c}else for(o=new um(n),i=0;i<n;++i)r[i]&&(o[i]=KO[a[r[i]-1]++]>>>15-r[i]);return o}),nE=new Yu(288);for(var Fr=0;Fr<144;++Fr)nE[Fr]=8;for(var Fr=144;Fr<256;++Fr)nE[Fr]=9;for(var Fr=256;Fr<280;++Fr)nE[Fr]=7;for(var Fr=280;Fr<288;++Fr)nE[Fr]=8;var GH=new Yu(32);for(var Fr=0;Fr<32;++Fr)GH[Fr]=5;var zoe=WT(nE,9,1),Voe=WT(GH,5,1),tD=function(r){for(var e=r[0],t=1;t<r.length;++t)r[t]>e&&(e=r[t]);return e},Vc=function(r,e,t){var n=e/8|0;return(r[n]|r[n+1]<<8)>>(e&7)&t},nD=function(r,e){var t=e/8|0;return(r[t]|r[t+1]<<8|r[t+2]<<16)>>(e&7)},Goe=function(r){return(r/8|0)+(r&7&&1)},koe=function(r,e,t){(t==null||t>r.length)&&(t=r.length);var n=new(r instanceof um?um:r instanceof ZO?ZO:Yu)(t-e);return n.set(r.subarray(e,t)),n},Hoe=function(r,e,t){var n=r.length;if(!n||t&&!t.l&&n<5)return e||new Yu(0);var i=!e||t,s=!t||t.i;t||(t={}),e||(e=new Yu(n*3));var a=function(Ee){var Ne=e.length;if(Ee>Ne){var rt=new Yu(Math.max(Ne*2,Ee));rt.set(e),e=rt}},o=t.f||0,l=t.p||0,c=t.b||0,d=t.l,p=t.d,y=t.m,_=t.n,v=n*8;do{if(!d){t.f=o=Vc(r,l,1);var b=Vc(r,l+1,3);if(l+=3,b)if(b==1)d=zoe,p=Voe,y=9,_=5;else if(b==2){var R=Vc(r,l,31)+257,N=Vc(r,l+10,15)+4,P=R+Vc(r,l+5,31)+1;l+=14;for(var U=new Yu(P),L=new Yu(19),F=0;F<N;++F)L[Poe[F]]=Vc(r,l+F*3,7);l+=N*3;for(var O=tD(L),B=(1<<O)-1,q=WT(L,O,1),F=0;F<P;){var j=q[Vc(r,l,B)];l+=j&15;var E=j>>>4;if(E<16)U[F++]=E;else{var Q=0,se=0;for(E==16?(se=3+Vc(r,l,3),l+=2,Q=U[F-1]):E==17?(se=3+Vc(r,l,7),l+=3):E==18&&(se=11+Vc(r,l,127),l+=7);se--;)U[F++]=Q}}var ae=U.subarray(0,R),V=U.subarray(R);y=tD(ae),_=tD(V),d=WT(ae,y,1),p=WT(V,_,1)}else throw"invalid block type";else{var E=Goe(l)+4,T=r[E-4]|r[E-3]<<8,M=E+T;if(M>n){if(s)throw"unexpected EOF";break}i&&a(c+T),e.set(r.subarray(E,M),c),t.b=c+=T,t.p=l=M*8;continue}if(l>v){if(s)throw"unexpected EOF";break}}i&&a(c+131072);for(var X=(1<<y)-1,ee=(1<<_)-1,fe=l;;fe=l){var Q=d[nD(r,l)&X],Y=Q>>>4;if(l+=Q&15,l>v){if(s)throw"unexpected EOF";break}if(!Q)throw"invalid length/literal";if(Y<256)e[c++]=Y;else if(Y==256){fe=l,d=null;break}else{var K=Y-254;if(Y>264){var F=Y-257,he=BH[F];K=Vc(r,l,(1<<he)-1)+VH[F],l+=he}var Ce=p[nD(r,l)&ee],Ie=Ce>>>4;if(!Ce)throw"invalid distance";l+=Ce&15;var V=Foe[Ie];if(Ie>3){var he=IH[Ie];V+=nD(r,l)&(1<<he)-1,l+=he}if(l>v){if(s)throw"unexpected EOF";break}i&&a(c+131072);for(var ut=c+K;c<ut;c+=4)e[c]=e[c-V],e[c+1]=e[c+1-V],e[c+2]=e[c+2-V],e[c+3]=e[c+3-V];c=ut}}t.l=d,t.p=fe,t.b=c,d&&(o=1,t.m=y,t.d=p,t.n=_)}while(!o);return c==e.length?e:koe(e,0,c)},Woe=new Yu(0),qoe=function(r){if((r[0]&15)!=8||r[0]>>>4>7||(r[0]<<8|r[1])%31)throw"invalid zlib data";if(r[1]&32)throw"invalid zlib data: preset dictionaries not supported"};function WA(r,e){return Hoe((qoe(r),r.subarray(2,-4)),e)}var Xoe=typeof TextDecoder<"u"&&new TextDecoder,$oe=0;try{Xoe.decode(Woe,{stream:!0}),$oe=1}catch{}const joe=r=>r&&r.isCubeTexture;class Yoe extends ar{constructor(e,t){var n,i;const s=joe(e),o=((i=s?(n=e.image[0])==null?void 0:n.width:e.image.width)!=null?i:1024)/4,l=Math.floor(Math.log2(o)),c=Math.pow(2,l),d=3*Math.max(c,112),p=4*c,y=[s?"#define ENVMAP_TYPE_CUBE":"",`#define CUBEUV_TEXEL_WIDTH ${1/d}`,`#define CUBEUV_TEXEL_HEIGHT ${1/p}`,`#define CUBEUV_MAX_MIP ${l}.0`],_=`
        varying vec3 vWorldPosition;
        void main() 
        {
            vec4 worldPosition = ( modelMatrix * vec4( position, 1.0 ) );
            vWorldPosition = worldPosition.xyz;
            
            gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
        }
        `,v=y.join(`
`)+`
        #define ENVMAP_TYPE_CUBE_UV
        varying vec3 vWorldPosition;
        uniform float radius;
        uniform float height;
        uniform float angle;
        #ifdef ENVMAP_TYPE_CUBE
            uniform samplerCube map;
        #else
            uniform sampler2D map;
        #endif
        // From: https://www.shadertoy.com/view/4tsBD7
        float diskIntersectWithBackFaceCulling( vec3 ro, vec3 rd, vec3 c, vec3 n, float r ) 
        {
            float d = dot ( rd, n );
            
            if( d > 0.0 ) { return 1e6; }
            
            vec3  o = ro - c;
            float t = - dot( n, o ) / d;
            vec3  q = o + rd * t;
            
            return ( dot( q, q ) < r * r ) ? t : 1e6;
        }
        // From: https://www.iquilezles.org/www/articles/intersectors/intersectors.htm
        float sphereIntersect( vec3 ro, vec3 rd, vec3 ce, float ra ) 
        {
            vec3 oc = ro - ce;
            float b = dot( oc, rd );
            float c = dot( oc, oc ) - ra * ra;
            float h = b * b - c;
            
            if( h < 0.0 ) { return -1.0; }
            
            h = sqrt( h );
            
            return - b + h;
        }
        vec3 project() 
        {
            vec3 p = normalize( vWorldPosition );
            vec3 camPos = cameraPosition;
            camPos.y -= height;
            float intersection = sphereIntersect( camPos, p, vec3( 0.0 ), radius );
            if( intersection > 0.0 ) {
                
                vec3 h = vec3( 0.0, - height, 0.0 );
                float intersection2 = diskIntersectWithBackFaceCulling( camPos, p, h, vec3( 0.0, 1.0, 0.0 ), radius );
                p = ( camPos + min( intersection, intersection2 ) * p ) / radius;
            } else {
                p = vec3( 0.0, 1.0, 0.0 );
            }
            return p;
        }
        #include <common>
        #include <cube_uv_reflection_fragment>
        void main() 
        {
            vec3 projectedWorldPosition = project();
            
            #ifdef ENVMAP_TYPE_CUBE
                vec3 outcolor = textureCube( map, projectedWorldPosition ).rgb;
            #else
                vec3 direction = normalize( projectedWorldPosition );
                vec2 uv = equirectUv( direction );
                vec3 outcolor = texture2D( map, uv ).rgb;
            #endif
            gl_FragColor = vec4( outcolor, 1.0 );
            #include <tonemapping_fragment>
            #include <${PH>=154?"colorspace_fragment":"encodings_fragment"}>
        }
        `,b={map:{value:e},height:{value:t?.height||15},radius:{value:t?.radius||100}},E=new X1(1,16),T=new ul({uniforms:b,fragmentShader:v,vertexShader:_,side:xa});super(E,T)}set radius(e){this.material.uniforms.radius.value=e}get radius(){return this.material.uniforms.radius.value}set height(e){this.material.uniforms.height.value=e}get height(){return this.material.uniforms.height.value}}var Zoe=Object.defineProperty,Koe=(r,e,t)=>e in r?Zoe(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,Qoe=(r,e,t)=>(Koe(r,e+"",t),t);class Joe{constructor(){Qoe(this,"_listeners")}addEventListener(e,t){this._listeners===void 0&&(this._listeners={});const n=this._listeners;n[e]===void 0&&(n[e]=[]),n[e].indexOf(t)===-1&&n[e].push(t)}hasEventListener(e,t){if(this._listeners===void 0)return!1;const n=this._listeners;return n[e]!==void 0&&n[e].indexOf(t)!==-1}removeEventListener(e,t){if(this._listeners===void 0)return;const i=this._listeners[e];if(i!==void 0){const s=i.indexOf(t);s!==-1&&i.splice(s,1)}}dispatchEvent(e){if(this._listeners===void 0)return;const n=this._listeners[e.type];if(n!==void 0){e.target=this;const i=n.slice(0);for(let s=0,a=i.length;s<a;s++)i[s].call(this,e);e.target=null}}}var ele=Object.defineProperty,tle=(r,e,t)=>e in r?ele(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,Fn=(r,e,t)=>(tle(r,typeof e!="symbol"?e+"":e,t),t);const qA=new wy,R4=new Hc,nle=Math.cos(70*(Math.PI/180)),C4=(r,e)=>(r%e+e)%e;let ile=class extends Joe{constructor(e,t){super(),Fn(this,"object"),Fn(this,"domElement"),Fn(this,"enabled",!0),Fn(this,"target",new ne),Fn(this,"minDistance",0),Fn(this,"maxDistance",1/0),Fn(this,"minZoom",0),Fn(this,"maxZoom",1/0),Fn(this,"minPolarAngle",0),Fn(this,"maxPolarAngle",Math.PI),Fn(this,"minAzimuthAngle",-1/0),Fn(this,"maxAzimuthAngle",1/0),Fn(this,"enableDamping",!1),Fn(this,"dampingFactor",.05),Fn(this,"enableZoom",!0),Fn(this,"zoomSpeed",1),Fn(this,"enableRotate",!0),Fn(this,"rotateSpeed",1),Fn(this,"enablePan",!0),Fn(this,"panSpeed",1),Fn(this,"screenSpacePanning",!0),Fn(this,"keyPanSpeed",7),Fn(this,"zoomToCursor",!1),Fn(this,"autoRotate",!1),Fn(this,"autoRotateSpeed",2),Fn(this,"reverseOrbit",!1),Fn(this,"reverseHorizontalOrbit",!1),Fn(this,"reverseVerticalOrbit",!1),Fn(this,"keys",{LEFT:"ArrowLeft",UP:"ArrowUp",RIGHT:"ArrowRight",BOTTOM:"ArrowDown"}),Fn(this,"mouseButtons",{LEFT:r0.ROTATE,MIDDLE:r0.DOLLY,RIGHT:r0.PAN}),Fn(this,"touches",{ONE:s0.ROTATE,TWO:s0.DOLLY_PAN}),Fn(this,"target0"),Fn(this,"position0"),Fn(this,"zoom0"),Fn(this,"_domElementKeyEvents",null),Fn(this,"getPolarAngle"),Fn(this,"getAzimuthalAngle"),Fn(this,"setPolarAngle"),Fn(this,"setAzimuthalAngle"),Fn(this,"getDistance"),Fn(this,"getZoomScale"),Fn(this,"listenToKeyEvents"),Fn(this,"stopListenToKeyEvents"),Fn(this,"saveState"),Fn(this,"reset"),Fn(this,"update"),Fn(this,"connect"),Fn(this,"dispose"),Fn(this,"dollyIn"),Fn(this,"dollyOut"),Fn(this,"getScale"),Fn(this,"setScale"),this.object=e,this.domElement=t,this.target0=this.target.clone(),this.position0=this.object.position.clone(),this.zoom0=this.object.zoom,this.getPolarAngle=()=>d.phi,this.getAzimuthalAngle=()=>d.theta,this.setPolarAngle=ue=>{let Re=C4(ue,2*Math.PI),dt=d.phi;dt<0&&(dt+=2*Math.PI),Re<0&&(Re+=2*Math.PI);let le=Math.abs(Re-dt);2*Math.PI-le<le&&(Re<dt?Re+=2*Math.PI:dt+=2*Math.PI),p.phi=Re-dt,n.update()},this.setAzimuthalAngle=ue=>{let Re=C4(ue,2*Math.PI),dt=d.theta;dt<0&&(dt+=2*Math.PI),Re<0&&(Re+=2*Math.PI);let le=Math.abs(Re-dt);2*Math.PI-le<le&&(Re<dt?Re+=2*Math.PI:dt+=2*Math.PI),p.theta=Re-dt,n.update()},this.getDistance=()=>n.object.position.distanceTo(n.target),this.listenToKeyEvents=ue=>{ue.addEventListener("keydown",ze),this._domElementKeyEvents=ue},this.stopListenToKeyEvents=()=>{this._domElementKeyEvents.removeEventListener("keydown",ze),this._domElementKeyEvents=null},this.saveState=()=>{n.target0.copy(n.target),n.position0.copy(n.object.position),n.zoom0=n.object.zoom},this.reset=()=>{n.target.copy(n.target0),n.object.position.copy(n.position0),n.object.zoom=n.zoom0,n.object.updateProjectionMatrix(),n.dispatchEvent(i),n.update(),l=o.NONE},this.update=(()=>{const ue=new ne,Re=new ne(0,1,0),dt=new Va().setFromUnitVectors(e.up,Re),le=dt.clone().invert(),Be=new ne,lt=new Va,Ot=2*Math.PI;return function(){const it=n.object.position;dt.setFromUnitVectors(e.up,Re),le.copy(dt).invert(),ue.copy(it).sub(n.target),ue.applyQuaternion(dt),d.setFromVector3(ue),n.autoRotate&&l===o.NONE&&se(j()),n.enableDamping?(d.theta+=p.theta*n.dampingFactor,d.phi+=p.phi*n.dampingFactor):(d.theta+=p.theta,d.phi+=p.phi);let Tt=n.minAzimuthAngle,ln=n.maxAzimuthAngle;isFinite(Tt)&&isFinite(ln)&&(Tt<-Math.PI?Tt+=Ot:Tt>Math.PI&&(Tt-=Ot),ln<-Math.PI?ln+=Ot:ln>Math.PI&&(ln-=Ot),Tt<=ln?d.theta=Math.max(Tt,Math.min(ln,d.theta)):d.theta=d.theta>(Tt+ln)/2?Math.max(Tt,d.theta):Math.min(ln,d.theta)),d.phi=Math.max(n.minPolarAngle,Math.min(n.maxPolarAngle,d.phi)),d.makeSafe(),n.enableDamping===!0?n.target.addScaledVector(_,n.dampingFactor):n.target.add(_),n.zoomToCursor&&O||n.object.isOrthographicCamera?d.radius=Ce(d.radius):d.radius=Ce(d.radius*y),ue.setFromSpherical(d),ue.applyQuaternion(le),it.copy(n.target).add(ue),n.object.matrixAutoUpdate||n.object.updateMatrix(),n.object.lookAt(n.target),n.enableDamping===!0?(p.theta*=1-n.dampingFactor,p.phi*=1-n.dampingFactor,_.multiplyScalar(1-n.dampingFactor)):(p.set(0,0,0),_.set(0,0,0));let jn=!1;if(n.zoomToCursor&&O){let qt=null;if(n.object instanceof Br&&n.object.isPerspectiveCamera){const nn=ue.length();qt=Ce(nn*y);const Bn=nn-qt;n.object.position.addScaledVector(L,Bn),n.object.updateMatrixWorld()}else if(n.object.isOrthographicCamera){const nn=new ne(F.x,F.y,0);nn.unproject(n.object),n.object.zoom=Math.max(n.minZoom,Math.min(n.maxZoom,n.object.zoom/y)),n.object.updateProjectionMatrix(),jn=!0;const Bn=new ne(F.x,F.y,0);Bn.unproject(n.object),n.object.position.sub(Bn).add(nn),n.object.updateMatrixWorld(),qt=ue.length()}else console.warn("WARNING: OrbitControls.js encountered an unknown camera type - zoom to cursor disabled."),n.zoomToCursor=!1;qt!==null&&(n.screenSpacePanning?n.target.set(0,0,-1).transformDirection(n.object.matrix).multiplyScalar(qt).add(n.object.position):(qA.origin.copy(n.object.position),qA.direction.set(0,0,-1).transformDirection(n.object.matrix),Math.abs(n.object.up.dot(qA.direction))<nle?e.lookAt(n.target):(R4.setFromNormalAndCoplanarPoint(n.object.up,n.target),qA.intersectPlane(R4,n.target))))}else n.object instanceof rc&&n.object.isOrthographicCamera&&(jn=y!==1,jn&&(n.object.zoom=Math.max(n.minZoom,Math.min(n.maxZoom,n.object.zoom/y)),n.object.updateProjectionMatrix()));return y=1,O=!1,jn||Be.distanceToSquared(n.object.position)>c||8*(1-lt.dot(n.object.quaternion))>c?(n.dispatchEvent(i),Be.copy(n.object.position),lt.copy(n.object.quaternion),jn=!1,!0):!1}})(),this.connect=ue=>{n.domElement=ue,n.domElement.style.touchAction="none",n.domElement.addEventListener("contextmenu",Yt),n.domElement.addEventListener("pointerdown",wt),n.domElement.addEventListener("pointercancel",k),n.domElement.addEventListener("wheel",He)},this.dispose=()=>{var ue,Re,dt,le,Be,lt;n.domElement&&(n.domElement.style.touchAction="auto"),(ue=n.domElement)==null||ue.removeEventListener("contextmenu",Yt),(Re=n.domElement)==null||Re.removeEventListener("pointerdown",wt),(dt=n.domElement)==null||dt.removeEventListener("pointercancel",k),(le=n.domElement)==null||le.removeEventListener("wheel",He),(Be=n.domElement)==null||Be.ownerDocument.removeEventListener("pointermove",Z),(lt=n.domElement)==null||lt.ownerDocument.removeEventListener("pointerup",k),n._domElementKeyEvents!==null&&n._domElementKeyEvents.removeEventListener("keydown",ze)};const n=this,i={type:"change"},s={type:"start"},a={type:"end"},o={NONE:-1,ROTATE:0,DOLLY:1,PAN:2,TOUCH_ROTATE:3,TOUCH_PAN:4,TOUCH_DOLLY_PAN:5,TOUCH_DOLLY_ROTATE:6};let l=o.NONE;const c=1e-6,d=new gO,p=new gO;let y=1;const _=new ne,v=new tt,b=new tt,E=new tt,T=new tt,M=new tt,R=new tt,N=new tt,P=new tt,U=new tt,L=new ne,F=new tt;let O=!1;const B=[],q={};function j(){return 2*Math.PI/60/60*n.autoRotateSpeed}function Q(){return Math.pow(.95,n.zoomSpeed)}function se(ue){n.reverseOrbit||n.reverseHorizontalOrbit?p.theta+=ue:p.theta-=ue}function ae(ue){n.reverseOrbit||n.reverseVerticalOrbit?p.phi+=ue:p.phi-=ue}const V=(()=>{const ue=new ne;return function(dt,le){ue.setFromMatrixColumn(le,0),ue.multiplyScalar(-dt),_.add(ue)}})(),X=(()=>{const ue=new ne;return function(dt,le){n.screenSpacePanning===!0?ue.setFromMatrixColumn(le,1):(ue.setFromMatrixColumn(le,0),ue.crossVectors(n.object.up,ue)),ue.multiplyScalar(dt),_.add(ue)}})(),ee=(()=>{const ue=new ne;return function(dt,le){const Be=n.domElement;if(Be&&n.object instanceof Br&&n.object.isPerspectiveCamera){const lt=n.object.position;ue.copy(lt).sub(n.target);let Ot=ue.length();Ot*=Math.tan(n.object.fov/2*Math.PI/180),V(2*dt*Ot/Be.clientHeight,n.object.matrix),X(2*le*Ot/Be.clientHeight,n.object.matrix)}else Be&&n.object instanceof rc&&n.object.isOrthographicCamera?(V(dt*(n.object.right-n.object.left)/n.object.zoom/Be.clientWidth,n.object.matrix),X(le*(n.object.top-n.object.bottom)/n.object.zoom/Be.clientHeight,n.object.matrix)):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - pan disabled."),n.enablePan=!1)}})();function fe(ue){n.object instanceof Br&&n.object.isPerspectiveCamera||n.object instanceof rc&&n.object.isOrthographicCamera?y=ue:(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),n.enableZoom=!1)}function Y(ue){fe(y/ue)}function K(ue){fe(y*ue)}function he(ue){if(!n.zoomToCursor||!n.domElement)return;O=!0;const Re=n.domElement.getBoundingClientRect(),dt=ue.clientX-Re.left,le=ue.clientY-Re.top,Be=Re.width,lt=Re.height;F.x=dt/Be*2-1,F.y=-(le/lt)*2+1,L.set(F.x,F.y,1).unproject(n.object).sub(n.object.position).normalize()}function Ce(ue){return Math.max(n.minDistance,Math.min(n.maxDistance,ue))}function Ie(ue){v.set(ue.clientX,ue.clientY)}function ut(ue){he(ue),N.set(ue.clientX,ue.clientY)}function Ee(ue){T.set(ue.clientX,ue.clientY)}function Ne(ue){b.set(ue.clientX,ue.clientY),E.subVectors(b,v).multiplyScalar(n.rotateSpeed);const Re=n.domElement;Re&&(se(2*Math.PI*E.x/Re.clientHeight),ae(2*Math.PI*E.y/Re.clientHeight)),v.copy(b),n.update()}function rt(ue){P.set(ue.clientX,ue.clientY),U.subVectors(P,N),U.y>0?Y(Q()):U.y<0&&K(Q()),N.copy(P),n.update()}function Nt(ue){M.set(ue.clientX,ue.clientY),R.subVectors(M,T).multiplyScalar(n.panSpeed),ee(R.x,R.y),T.copy(M),n.update()}function Ft(ue){he(ue),ue.deltaY<0?K(Q()):ue.deltaY>0&&Y(Q()),n.update()}function fn(ue){let Re=!1;switch(ue.code){case n.keys.UP:ee(0,n.keyPanSpeed),Re=!0;break;case n.keys.BOTTOM:ee(0,-n.keyPanSpeed),Re=!0;break;case n.keys.LEFT:ee(n.keyPanSpeed,0),Re=!0;break;case n.keys.RIGHT:ee(-n.keyPanSpeed,0),Re=!0;break}Re&&(ue.preventDefault(),n.update())}function Sn(){if(B.length==1)v.set(B[0].pageX,B[0].pageY);else{const ue=.5*(B[0].pageX+B[1].pageX),Re=.5*(B[0].pageY+B[1].pageY);v.set(ue,Re)}}function At(){if(B.length==1)T.set(B[0].pageX,B[0].pageY);else{const ue=.5*(B[0].pageX+B[1].pageX),Re=.5*(B[0].pageY+B[1].pageY);T.set(ue,Re)}}function qe(){const ue=B[0].pageX-B[1].pageX,Re=B[0].pageY-B[1].pageY,dt=Math.sqrt(ue*ue+Re*Re);N.set(0,dt)}function at(){n.enableZoom&&qe(),n.enablePan&&At()}function Je(){n.enableZoom&&qe(),n.enableRotate&&Sn()}function xe(ue){if(B.length==1)b.set(ue.pageX,ue.pageY);else{const dt=Pt(ue),le=.5*(ue.pageX+dt.x),Be=.5*(ue.pageY+dt.y);b.set(le,Be)}E.subVectors(b,v).multiplyScalar(n.rotateSpeed);const Re=n.domElement;Re&&(se(2*Math.PI*E.x/Re.clientHeight),ae(2*Math.PI*E.y/Re.clientHeight)),v.copy(b)}function oe(ue){if(B.length==1)M.set(ue.pageX,ue.pageY);else{const Re=Pt(ue),dt=.5*(ue.pageX+Re.x),le=.5*(ue.pageY+Re.y);M.set(dt,le)}R.subVectors(M,T).multiplyScalar(n.panSpeed),ee(R.x,R.y),T.copy(M)}function Qt(ue){const Re=Pt(ue),dt=ue.pageX-Re.x,le=ue.pageY-Re.y,Be=Math.sqrt(dt*dt+le*le);P.set(0,Be),U.set(0,Math.pow(P.y/N.y,n.zoomSpeed)),Y(U.y),N.copy(P)}function Dt(ue){n.enableZoom&&Qt(ue),n.enablePan&&oe(ue)}function zt(ue){n.enableZoom&&Qt(ue),n.enableRotate&&xe(ue)}function wt(ue){var Re,dt;n.enabled!==!1&&(B.length===0&&((Re=n.domElement)==null||Re.ownerDocument.addEventListener("pointermove",Z),(dt=n.domElement)==null||dt.ownerDocument.addEventListener("pointerup",k)),$t(ue),ue.pointerType==="touch"?Bt(ue):pe(ue))}function Z(ue){n.enabled!==!1&&(ue.pointerType==="touch"?Ct(ue):Fe(ue))}function k(ue){var Re,dt,le;st(ue),B.length===0&&((Re=n.domElement)==null||Re.releasePointerCapture(ue.pointerId),(dt=n.domElement)==null||dt.ownerDocument.removeEventListener("pointermove",Z),(le=n.domElement)==null||le.ownerDocument.removeEventListener("pointerup",k)),n.dispatchEvent(a),l=o.NONE}function pe(ue){let Re;switch(ue.button){case 0:Re=n.mouseButtons.LEFT;break;case 1:Re=n.mouseButtons.MIDDLE;break;case 2:Re=n.mouseButtons.RIGHT;break;default:Re=-1}switch(Re){case r0.DOLLY:if(n.enableZoom===!1)return;ut(ue),l=o.DOLLY;break;case r0.ROTATE:if(ue.ctrlKey||ue.metaKey||ue.shiftKey){if(n.enablePan===!1)return;Ee(ue),l=o.PAN}else{if(n.enableRotate===!1)return;Ie(ue),l=o.ROTATE}break;case r0.PAN:if(ue.ctrlKey||ue.metaKey||ue.shiftKey){if(n.enableRotate===!1)return;Ie(ue),l=o.ROTATE}else{if(n.enablePan===!1)return;Ee(ue),l=o.PAN}break;default:l=o.NONE}l!==o.NONE&&n.dispatchEvent(s)}function Fe(ue){if(n.enabled!==!1)switch(l){case o.ROTATE:if(n.enableRotate===!1)return;Ne(ue);break;case o.DOLLY:if(n.enableZoom===!1)return;rt(ue);break;case o.PAN:if(n.enablePan===!1)return;Nt(ue);break}}function He(ue){n.enabled===!1||n.enableZoom===!1||l!==o.NONE&&l!==o.ROTATE||(ue.preventDefault(),n.dispatchEvent(s),Ft(ue),n.dispatchEvent(a))}function ze(ue){n.enabled===!1||n.enablePan===!1||fn(ue)}function Bt(ue){switch(nt(ue),B.length){case 1:switch(n.touches.ONE){case s0.ROTATE:if(n.enableRotate===!1)return;Sn(),l=o.TOUCH_ROTATE;break;case s0.PAN:if(n.enablePan===!1)return;At(),l=o.TOUCH_PAN;break;default:l=o.NONE}break;case 2:switch(n.touches.TWO){case s0.DOLLY_PAN:if(n.enableZoom===!1&&n.enablePan===!1)return;at(),l=o.TOUCH_DOLLY_PAN;break;case s0.DOLLY_ROTATE:if(n.enableZoom===!1&&n.enableRotate===!1)return;Je(),l=o.TOUCH_DOLLY_ROTATE;break;default:l=o.NONE}break;default:l=o.NONE}l!==o.NONE&&n.dispatchEvent(s)}function Ct(ue){switch(nt(ue),l){case o.TOUCH_ROTATE:if(n.enableRotate===!1)return;xe(ue),n.update();break;case o.TOUCH_PAN:if(n.enablePan===!1)return;oe(ue),n.update();break;case o.TOUCH_DOLLY_PAN:if(n.enableZoom===!1&&n.enablePan===!1)return;Dt(ue),n.update();break;case o.TOUCH_DOLLY_ROTATE:if(n.enableZoom===!1&&n.enableRotate===!1)return;zt(ue),n.update();break;default:l=o.NONE}}function Yt(ue){n.enabled!==!1&&ue.preventDefault()}function $t(ue){B.push(ue)}function st(ue){delete q[ue.pointerId];for(let Re=0;Re<B.length;Re++)if(B[Re].pointerId==ue.pointerId){B.splice(Re,1);return}}function nt(ue){let Re=q[ue.pointerId];Re===void 0&&(Re=new tt,q[ue.pointerId]=Re),Re.set(ue.pageX,ue.pageY)}function Pt(ue){const Re=ue.pointerId===B[0].pointerId?B[1]:B[0];return q[Re.pointerId]}this.dollyIn=(ue=Q())=>{K(ue),n.update()},this.dollyOut=(ue=Q())=>{Y(ue),n.update()},this.getScale=()=>y,this.setScale=ue=>{fe(ue),n.update()},this.getZoomScale=()=>Q(),t!==void 0&&this.connect(t),this.update()}};class rle extends UL{constructor(e){super(e),this.type=vi}parse(e){const a=function(F,O){switch(F){case 1:throw new Error("THREE.RGBELoader: Read Error: "+(O||""));case 2:throw new Error("THREE.RGBELoader: Write Error: "+(O||""));case 3:throw new Error("THREE.RGBELoader: Bad File Format: "+(O||""));default:case 4:throw new Error("THREE.RGBELoader: Memory Error: "+(O||""))}},p=function(F,O,B){O=O||1024;let j=F.pos,Q=-1,se=0,ae="",V=String.fromCharCode.apply(null,new Uint16Array(F.subarray(j,j+128)));for(;0>(Q=V.indexOf(`
`))&&se<O&&j<F.byteLength;)ae+=V,se+=V.length,j+=128,V+=String.fromCharCode.apply(null,new Uint16Array(F.subarray(j,j+128)));return-1<Q?(F.pos+=se+Q+1,ae+V.slice(0,Q)):!1},y=function(F){const O=/^#\?(\S+)/,B=/^\s*GAMMA\s*=\s*(\d+(\.\d+)?)\s*$/,q=/^\s*EXPOSURE\s*=\s*(\d+(\.\d+)?)\s*$/,j=/^\s*FORMAT=(\S+)\s*$/,Q=/^\s*\-Y\s+(\d+)\s+\+X\s+(\d+)\s*$/,se={valid:0,string:"",comments:"",programtype:"RGBE",format:"",gamma:1,exposure:1,width:0,height:0};let ae,V;for((F.pos>=F.byteLength||!(ae=p(F)))&&a(1,"no header found"),(V=ae.match(O))||a(3,"bad initial token"),se.valid|=1,se.programtype=V[1],se.string+=ae+`
`;ae=p(F),ae!==!1;){if(se.string+=ae+`
`,ae.charAt(0)==="#"){se.comments+=ae+`
`;continue}if((V=ae.match(B))&&(se.gamma=parseFloat(V[1])),(V=ae.match(q))&&(se.exposure=parseFloat(V[1])),(V=ae.match(j))&&(se.valid|=2,se.format=V[1]),(V=ae.match(Q))&&(se.valid|=4,se.height=parseInt(V[1],10),se.width=parseInt(V[2],10)),se.valid&2&&se.valid&4)break}return se.valid&2||a(3,"missing format specifier"),se.valid&4||a(3,"missing image size specifier"),se},_=function(F,O,B){const q=O;if(q<8||q>32767||F[0]!==2||F[1]!==2||F[2]&128)return new Uint8Array(F);q!==(F[2]<<8|F[3])&&a(3,"wrong scanline width");const j=new Uint8Array(4*O*B);j.length||a(4,"unable to allocate buffer space");let Q=0,se=0;const ae=4*q,V=new Uint8Array(4),X=new Uint8Array(ae);let ee=B;for(;ee>0&&se<F.byteLength;){se+4>F.byteLength&&a(1),V[0]=F[se++],V[1]=F[se++],V[2]=F[se++],V[3]=F[se++],(V[0]!=2||V[1]!=2||(V[2]<<8|V[3])!=q)&&a(3,"bad rgbe scanline format");let fe=0,Y;for(;fe<ae&&se<F.byteLength;){Y=F[se++];const he=Y>128;if(he&&(Y-=128),(Y===0||fe+Y>ae)&&a(3,"bad scanline data"),he){const Ce=F[se++];for(let Ie=0;Ie<Y;Ie++)X[fe++]=Ce}else X.set(F.subarray(se,se+Y),fe),fe+=Y,se+=Y}const K=q;for(let he=0;he<K;he++){let Ce=0;j[Q]=X[he+Ce],Ce+=q,j[Q+1]=X[he+Ce],Ce+=q,j[Q+2]=X[he+Ce],Ce+=q,j[Q+3]=X[he+Ce],Q+=4}ee--}return j},v=function(F,O,B,q){const j=F[O+3],Q=Math.pow(2,j-128)/255;B[q+0]=F[O+0]*Q,B[q+1]=F[O+1]*Q,B[q+2]=F[O+2]*Q,B[q+3]=1},b=function(F,O,B,q){const j=F[O+3],Q=Math.pow(2,j-128)/255;B[q+0]=m0.toHalfFloat(Math.min(F[O+0]*Q,65504)),B[q+1]=m0.toHalfFloat(Math.min(F[O+1]*Q,65504)),B[q+2]=m0.toHalfFloat(Math.min(F[O+2]*Q,65504)),B[q+3]=m0.toHalfFloat(1)},E=new Uint8Array(e);E.pos=0;const T=y(E),M=T.width,R=T.height,N=_(E.subarray(E.pos),M,R);let P,U,L;switch(this.type){case Ci:L=N.length/4;const F=new Float32Array(L*4);for(let B=0;B<L;B++)v(N,B*4,F,B*4);P=F,U=Ci;break;case vi:L=N.length/4;const O=new Uint16Array(L*4);for(let B=0;B<L;B++)b(N,B*4,O,B*4);P=O,U=vi;break;default:throw new Error("THREE.RGBELoader: Unsupported type: "+this.type)}return{width:M,height:R,data:P,header:T.string,gamma:T.gamma,exposure:T.exposure,type:U}}setDataType(e){return this.type=e,this}load(e,t,n,i){function s(a,o){switch(a.type){case Ci:case vi:"colorSpace"in a?a.colorSpace="srgb-linear":a.encoding=3e3,a.minFilter=ei,a.magFilter=ei,a.generateMipmaps=!1,a.flipY=!0;break}t&&t(a,o)}return super.load(e,s,n,i)}}const WS=PH>=152;class sle extends UL{constructor(e){super(e),this.type=vi}parse(e){const O=Math.pow(2.7182818,2.2);function B(W,J){for(var me=0,De=0;De<65536;++De)(De==0||W[De>>3]&1<<(De&7))&&(J[me++]=De);for(var $e=me-1;me<65536;)J[me++]=0;return $e}function q(W){for(var J=0;J<16384;J++)W[J]={},W[J].len=0,W[J].lit=0,W[J].p=null}const j={l:0,c:0,lc:0};function Q(W,J,me,De,$e){for(;me<W;)J=J<<8|Pt(De,$e),me+=8;me-=W,j.l=J>>me&(1<<W)-1,j.c=J,j.lc=me}const se=new Array(59);function ae(W){for(var J=0;J<=58;++J)se[J]=0;for(var J=0;J<65537;++J)se[W[J]]+=1;for(var me=0,J=58;J>0;--J){var De=me+se[J]>>1;se[J]=me,me=De}for(var J=0;J<65537;++J){var $e=W[J];$e>0&&(W[J]=$e|se[$e]++<<6)}}function V(W,J,me,De,$e,je,_t){for(var ct=me,pt=0,gt=0;$e<=je;$e++){if(ct.value-me.value>De)return!1;Q(6,pt,gt,W,ct);var Lt=j.l;if(pt=j.c,gt=j.lc,_t[$e]=Lt,Lt==63){if(ct.value-me.value>De)throw"Something wrong with hufUnpackEncTable";Q(8,pt,gt,W,ct);var bt=j.l+6;if(pt=j.c,gt=j.lc,$e+bt>je+1)throw"Something wrong with hufUnpackEncTable";for(;bt--;)_t[$e++]=0;$e--}else if(Lt>=59){var bt=Lt-59+2;if($e+bt>je+1)throw"Something wrong with hufUnpackEncTable";for(;bt--;)_t[$e++]=0;$e--}}ae(_t)}function X(W){return W&63}function ee(W){return W>>6}function fe(W,J,me,De){for(;J<=me;J++){var $e=ee(W[J]),je=X(W[J]);if($e>>je)throw"Invalid table entry";if(je>14){var _t=De[$e>>je-14];if(_t.len)throw"Invalid table entry";if(_t.lit++,_t.p){var ct=_t.p;_t.p=new Array(_t.lit);for(var pt=0;pt<_t.lit-1;++pt)_t.p[pt]=ct[pt]}else _t.p=new Array(1);_t.p[_t.lit-1]=J}else if(je)for(var gt=0,pt=1<<14-je;pt>0;pt--){var _t=De[($e<<14-je)+gt];if(_t.len||_t.p)throw"Invalid table entry";_t.len=je,_t.lit=J,gt++}}return!0}const Y={c:0,lc:0};function K(W,J,me,De){W=W<<8|Pt(me,De),J+=8,Y.c=W,Y.lc=J}const he={c:0,lc:0};function Ce(W,J,me,De,$e,je,_t,ct,pt,gt){if(W==J){De<8&&(K(me,De,$e,_t),me=Y.c,De=Y.lc),De-=8;var Lt=me>>De,Lt=new Uint8Array([Lt])[0];if(pt.value+Lt>gt)return!1;for(var bt=ct[pt.value-1];Lt-- >0;)ct[pt.value++]=bt}else if(pt.value<gt)ct[pt.value++]=W;else return!1;he.c=me,he.lc=De}function Ie(W){return W&65535}function ut(W){var J=Ie(W);return J>32767?J-65536:J}const Ee={a:0,b:0};function Ne(W,J){var me=ut(W),De=ut(J),$e=De,je=me+($e&1)+($e>>1),_t=je,ct=je-$e;Ee.a=_t,Ee.b=ct}function rt(W,J){var me=Ie(W),De=Ie(J),$e=me-(De>>1)&65535,je=De+$e-32768&65535;Ee.a=je,Ee.b=$e}function Nt(W,J,me,De,$e,je,_t){for(var ct=_t<16384,pt=me>$e?$e:me,gt=1,Lt;gt<=pt;)gt<<=1;for(gt>>=1,Lt=gt,gt>>=1;gt>=1;){for(var bt=0,$=bt+je*($e-Lt),ce=je*gt,Me=je*Lt,Ae=De*gt,Se=De*Lt,mt,Et,Rt,It;bt<=$;bt+=Me){for(var Vt=bt,mn=bt+De*(me-Lt);Vt<=mn;Vt+=Se){var Gt=Vt+Ae,un=Vt+ce,ni=un+Ae;ct?(Ne(W[Vt+J],W[un+J]),mt=Ee.a,Rt=Ee.b,Ne(W[Gt+J],W[ni+J]),Et=Ee.a,It=Ee.b,Ne(mt,Et),W[Vt+J]=Ee.a,W[Gt+J]=Ee.b,Ne(Rt,It),W[un+J]=Ee.a,W[ni+J]=Ee.b):(rt(W[Vt+J],W[un+J]),mt=Ee.a,Rt=Ee.b,rt(W[Gt+J],W[ni+J]),Et=Ee.a,It=Ee.b,rt(mt,Et),W[Vt+J]=Ee.a,W[Gt+J]=Ee.b,rt(Rt,It),W[un+J]=Ee.a,W[ni+J]=Ee.b)}if(me&gt){var un=Vt+ce;ct?Ne(W[Vt+J],W[un+J]):rt(W[Vt+J],W[un+J]),mt=Ee.a,W[un+J]=Ee.b,W[Vt+J]=mt}}if($e&gt)for(var Vt=bt,mn=bt+De*(me-Lt);Vt<=mn;Vt+=Se){var Gt=Vt+Ae;ct?Ne(W[Vt+J],W[Gt+J]):rt(W[Vt+J],W[Gt+J]),mt=Ee.a,W[Gt+J]=Ee.b,W[Vt+J]=mt}Lt=gt,gt>>=1}return bt}function Ft(W,J,me,De,$e,je,_t,ct,pt,gt){for(var Lt=0,bt=0,$=ct,ce=Math.trunc($e.value+(je+7)/8);$e.value<ce;)for(K(Lt,bt,me,$e),Lt=Y.c,bt=Y.lc;bt>=14;){var Me=Lt>>bt-14&16383,Ae=J[Me];if(Ae.len)bt-=Ae.len,Ce(Ae.lit,_t,Lt,bt,me,De,$e,pt,gt,$),Lt=he.c,bt=he.lc;else{if(!Ae.p)throw"hufDecode issues";var Se;for(Se=0;Se<Ae.lit;Se++){for(var mt=X(W[Ae.p[Se]]);bt<mt&&$e.value<ce;)K(Lt,bt,me,$e),Lt=Y.c,bt=Y.lc;if(bt>=mt&&ee(W[Ae.p[Se]])==(Lt>>bt-mt&(1<<mt)-1)){bt-=mt,Ce(Ae.p[Se],_t,Lt,bt,me,De,$e,pt,gt,$),Lt=he.c,bt=he.lc;break}}if(Se==Ae.lit)throw"hufDecode issues"}}var Et=8-je&7;for(Lt>>=Et,bt-=Et;bt>0;){var Ae=J[Lt<<14-bt&16383];if(Ae.len)bt-=Ae.len,Ce(Ae.lit,_t,Lt,bt,me,De,$e,pt,gt,$),Lt=he.c,bt=he.lc;else throw"hufDecode issues"}return!0}function fn(W,J,me,De,$e,je){var _t={value:0},ct=me.value,pt=nt(J,me),gt=nt(J,me);me.value+=4;var Lt=nt(J,me);if(me.value+=4,pt<0||pt>=65537||gt<0||gt>=65537)throw"Something wrong with HUF_ENCSIZE";var bt=new Array(65537),$=new Array(16384);q($);var ce=De-(me.value-ct);if(V(W,J,me,ce,pt,gt,bt),Lt>8*(De-(me.value-ct)))throw"Something wrong with hufUncompress";fe(bt,pt,gt,$),Ft(bt,$,W,J,me,Lt,gt,je,$e,_t)}function Sn(W,J,me){for(var De=0;De<me;++De)J[De]=W[J[De]]}function At(W){for(var J=1;J<W.length;J++){var me=W[J-1]+W[J]-128;W[J]=me}}function qe(W,J){for(var me=0,De=Math.floor((W.length+1)/2),$e=0,je=W.length-1;!($e>je||(J[$e++]=W[me++],$e>je));)J[$e++]=W[De++]}function at(W){for(var J=W.byteLength,me=new Array,De=0,$e=new DataView(W);J>0;){var je=$e.getInt8(De++);if(je<0){var _t=-je;J-=_t+1;for(var ct=0;ct<_t;ct++)me.push($e.getUint8(De++))}else{var _t=je;J-=2;for(var pt=$e.getUint8(De++),ct=0;ct<_t+1;ct++)me.push(pt)}}return me}function Je(W,J,me,De,$e,je){var Gt=new DataView(je.buffer),_t=me[W.idx[0]].width,ct=me[W.idx[0]].height,pt=3,gt=Math.floor(_t/8),Lt=Math.ceil(_t/8),bt=Math.ceil(ct/8),$=_t-(Lt-1)*8,ce=ct-(bt-1)*8,Me={value:0},Ae=new Array(pt),Se=new Array(pt),mt=new Array(pt),Et=new Array(pt),Rt=new Array(pt);for(let Mn=0;Mn<pt;++Mn)Rt[Mn]=J[W.idx[Mn]],Ae[Mn]=Mn<1?0:Ae[Mn-1]+Lt*bt,Se[Mn]=new Float32Array(64),mt[Mn]=new Uint16Array(64),Et[Mn]=new Uint16Array(Lt*64);for(let Mn=0;Mn<bt;++Mn){var It=8;Mn==bt-1&&(It=ce);var Vt=8;for(let Cn=0;Cn<Lt;++Cn){Cn==Lt-1&&(Vt=$);for(let tn=0;tn<pt;++tn)mt[tn].fill(0),mt[tn][0]=$e[Ae[tn]++],xe(Me,De,mt[tn]),oe(mt[tn],Se[tn]),Qt(Se[tn]);Dt(Se);for(let tn=0;tn<pt;++tn)zt(Se[tn],Et[tn],Cn*64)}let en=0;for(let Cn=0;Cn<pt;++Cn){const tn=me[W.idx[Cn]].type;for(let Vi=8*Mn;Vi<8*Mn+It;++Vi){en=Rt[Cn][Vi];for(let Ds=0;Ds<gt;++Ds){const Ii=Ds*64+(Vi&7)*8;Gt.setUint16(en+0*tn,Et[Cn][Ii+0],!0),Gt.setUint16(en+2*tn,Et[Cn][Ii+1],!0),Gt.setUint16(en+4*tn,Et[Cn][Ii+2],!0),Gt.setUint16(en+6*tn,Et[Cn][Ii+3],!0),Gt.setUint16(en+8*tn,Et[Cn][Ii+4],!0),Gt.setUint16(en+10*tn,Et[Cn][Ii+5],!0),Gt.setUint16(en+12*tn,Et[Cn][Ii+6],!0),Gt.setUint16(en+14*tn,Et[Cn][Ii+7],!0),en+=16*tn}}if(gt!=Lt)for(let Vi=8*Mn;Vi<8*Mn+It;++Vi){const Ds=Rt[Cn][Vi]+8*gt*2*tn,Ii=gt*64+(Vi&7)*8;for(let Jr=0;Jr<Vt;++Jr)Gt.setUint16(Ds+Jr*2*tn,Et[Cn][Ii+Jr],!0)}}}for(var mn=new Uint16Array(_t),Gt=new DataView(je.buffer),un=0;un<pt;++un){me[W.idx[un]].decoded=!0;var ni=me[W.idx[un]].type;if(me[un].type==2)for(var zi=0;zi<ct;++zi){const Mn=Rt[un][zi];for(var si=0;si<_t;++si)mn[si]=Gt.getUint16(Mn+si*2*ni,!0);for(var si=0;si<_t;++si)Gt.setFloat32(Mn+si*2*ni,Be(mn[si]),!0)}}}function xe(W,J,me){for(var De,$e=1;$e<64;)De=J[W.value],De==65280?$e=64:De>>8==255?$e+=De&255:(me[$e]=De,$e++),W.value++}function oe(W,J){J[0]=Be(W[0]),J[1]=Be(W[1]),J[2]=Be(W[5]),J[3]=Be(W[6]),J[4]=Be(W[14]),J[5]=Be(W[15]),J[6]=Be(W[27]),J[7]=Be(W[28]),J[8]=Be(W[2]),J[9]=Be(W[4]),J[10]=Be(W[7]),J[11]=Be(W[13]),J[12]=Be(W[16]),J[13]=Be(W[26]),J[14]=Be(W[29]),J[15]=Be(W[42]),J[16]=Be(W[3]),J[17]=Be(W[8]),J[18]=Be(W[12]),J[19]=Be(W[17]),J[20]=Be(W[25]),J[21]=Be(W[30]),J[22]=Be(W[41]),J[23]=Be(W[43]),J[24]=Be(W[9]),J[25]=Be(W[11]),J[26]=Be(W[18]),J[27]=Be(W[24]),J[28]=Be(W[31]),J[29]=Be(W[40]),J[30]=Be(W[44]),J[31]=Be(W[53]),J[32]=Be(W[10]),J[33]=Be(W[19]),J[34]=Be(W[23]),J[35]=Be(W[32]),J[36]=Be(W[39]),J[37]=Be(W[45]),J[38]=Be(W[52]),J[39]=Be(W[54]),J[40]=Be(W[20]),J[41]=Be(W[22]),J[42]=Be(W[33]),J[43]=Be(W[38]),J[44]=Be(W[46]),J[45]=Be(W[51]),J[46]=Be(W[55]),J[47]=Be(W[60]),J[48]=Be(W[21]),J[49]=Be(W[34]),J[50]=Be(W[37]),J[51]=Be(W[47]),J[52]=Be(W[50]),J[53]=Be(W[56]),J[54]=Be(W[59]),J[55]=Be(W[61]),J[56]=Be(W[35]),J[57]=Be(W[36]),J[58]=Be(W[48]),J[59]=Be(W[49]),J[60]=Be(W[57]),J[61]=Be(W[58]),J[62]=Be(W[62]),J[63]=Be(W[63])}function Qt(W){const J=.5*Math.cos(.7853975),me=.5*Math.cos(3.14159/16),De=.5*Math.cos(3.14159/8),$e=.5*Math.cos(3*3.14159/16),je=.5*Math.cos(5*3.14159/16),_t=.5*Math.cos(3*3.14159/8),ct=.5*Math.cos(7*3.14159/16);for(var pt=new Array(4),gt=new Array(4),Lt=new Array(4),bt=new Array(4),$=0;$<8;++$){var ce=$*8;pt[0]=De*W[ce+2],pt[1]=_t*W[ce+2],pt[2]=De*W[ce+6],pt[3]=_t*W[ce+6],gt[0]=me*W[ce+1]+$e*W[ce+3]+je*W[ce+5]+ct*W[ce+7],gt[1]=$e*W[ce+1]-ct*W[ce+3]-me*W[ce+5]-je*W[ce+7],gt[2]=je*W[ce+1]-me*W[ce+3]+ct*W[ce+5]+$e*W[ce+7],gt[3]=ct*W[ce+1]-je*W[ce+3]+$e*W[ce+5]-me*W[ce+7],Lt[0]=J*(W[ce+0]+W[ce+4]),Lt[3]=J*(W[ce+0]-W[ce+4]),Lt[1]=pt[0]+pt[3],Lt[2]=pt[1]-pt[2],bt[0]=Lt[0]+Lt[1],bt[1]=Lt[3]+Lt[2],bt[2]=Lt[3]-Lt[2],bt[3]=Lt[0]-Lt[1],W[ce+0]=bt[0]+gt[0],W[ce+1]=bt[1]+gt[1],W[ce+2]=bt[2]+gt[2],W[ce+3]=bt[3]+gt[3],W[ce+4]=bt[3]-gt[3],W[ce+5]=bt[2]-gt[2],W[ce+6]=bt[1]-gt[1],W[ce+7]=bt[0]-gt[0]}for(var Me=0;Me<8;++Me)pt[0]=De*W[16+Me],pt[1]=_t*W[16+Me],pt[2]=De*W[48+Me],pt[3]=_t*W[48+Me],gt[0]=me*W[8+Me]+$e*W[24+Me]+je*W[40+Me]+ct*W[56+Me],gt[1]=$e*W[8+Me]-ct*W[24+Me]-me*W[40+Me]-je*W[56+Me],gt[2]=je*W[8+Me]-me*W[24+Me]+ct*W[40+Me]+$e*W[56+Me],gt[3]=ct*W[8+Me]-je*W[24+Me]+$e*W[40+Me]-me*W[56+Me],Lt[0]=J*(W[Me]+W[32+Me]),Lt[3]=J*(W[Me]-W[32+Me]),Lt[1]=pt[0]+pt[3],Lt[2]=pt[1]-pt[2],bt[0]=Lt[0]+Lt[1],bt[1]=Lt[3]+Lt[2],bt[2]=Lt[3]-Lt[2],bt[3]=Lt[0]-Lt[1],W[0+Me]=bt[0]+gt[0],W[8+Me]=bt[1]+gt[1],W[16+Me]=bt[2]+gt[2],W[24+Me]=bt[3]+gt[3],W[32+Me]=bt[3]-gt[3],W[40+Me]=bt[2]-gt[2],W[48+Me]=bt[1]-gt[1],W[56+Me]=bt[0]-gt[0]}function Dt(W){for(var J=0;J<64;++J){var me=W[0][J],De=W[1][J],$e=W[2][J];W[0][J]=me+1.5747*$e,W[1][J]=me-.1873*De-.4682*$e,W[2][J]=me+1.8556*De}}function zt(W,J,me){for(var De=0;De<64;++De)J[me+De]=m0.toHalfFloat(wt(W[De]))}function wt(W){return W<=1?Math.sign(W)*Math.pow(Math.abs(W),2.2):Math.sign(W)*Math.pow(O,Math.abs(W)-1)}function Z(W){return new DataView(W.array.buffer,W.offset.value,W.size)}function k(W){var J=W.viewer.buffer.slice(W.offset.value,W.offset.value+W.size),me=new Uint8Array(at(J)),De=new Uint8Array(me.length);return At(me),qe(me,De),new DataView(De.buffer)}function pe(W){var J=W.array.slice(W.offset.value,W.offset.value+W.size),me=WA(J),De=new Uint8Array(me.length);return At(me),qe(me,De),new DataView(De.buffer)}function Fe(W){for(var J=W.viewer,me={value:W.offset.value},De=new Uint16Array(W.width*W.scanlineBlockSize*(W.channels*W.type)),$e=new Uint8Array(8192),je=0,_t=new Array(W.channels),ct=0;ct<W.channels;ct++)_t[ct]={},_t[ct].start=je,_t[ct].end=_t[ct].start,_t[ct].nx=W.width,_t[ct].ny=W.lines,_t[ct].size=W.type,je+=_t[ct].nx*_t[ct].ny*_t[ct].size;var pt=lt(J,me),gt=lt(J,me);if(gt>=8192)throw"Something is wrong with PIZ_COMPRESSION BITMAP_SIZE";if(pt<=gt)for(var ct=0;ct<gt-pt+1;ct++)$e[ct+pt]=ue(J,me);var Lt=new Uint16Array(65536),bt=B($e,Lt),$=nt(J,me);fn(W.array,J,me,$,De,je);for(var ct=0;ct<W.channels;++ct)for(var ce=_t[ct],Me=0;Me<_t[ct].size;++Me)Nt(De,ce.start+Me,ce.nx,ce.size,ce.ny,ce.nx*ce.size,bt);Sn(Lt,De,je);for(var Ae=0,Se=new Uint8Array(De.buffer.byteLength),mt=0;mt<W.lines;mt++)for(var Et=0;Et<W.channels;Et++){var ce=_t[Et],Rt=ce.nx*ce.size,It=new Uint8Array(De.buffer,ce.end*2,Rt*2);Se.set(It,Ae),Ae+=Rt*2,ce.end+=Rt}return new DataView(Se.buffer)}function He(W){var J=W.array.slice(W.offset.value,W.offset.value+W.size),me=WA(J);const De=W.lines*W.channels*W.width,$e=W.type==1?new Uint16Array(De):new Uint32Array(De);let je=0,_t=0;const ct=new Array(4);for(let pt=0;pt<W.lines;pt++)for(let gt=0;gt<W.channels;gt++){let Lt=0;switch(W.type){case 1:ct[0]=je,ct[1]=ct[0]+W.width,je=ct[1]+W.width;for(let bt=0;bt<W.width;++bt){const $=me[ct[0]++]<<8|me[ct[1]++];Lt+=$,$e[_t]=Lt,_t++}break;case 2:ct[0]=je,ct[1]=ct[0]+W.width,ct[2]=ct[1]+W.width,je=ct[2]+W.width;for(let bt=0;bt<W.width;++bt){const $=me[ct[0]++]<<24|me[ct[1]++]<<16|me[ct[2]++]<<8;Lt+=$,$e[_t]=Lt,_t++}break}}return new DataView($e.buffer)}function ze(W){var J=W.viewer,me={value:W.offset.value},De=new Uint8Array(W.width*W.lines*(W.channels*W.type*2)),$e={version:Re(J,me),unknownUncompressedSize:Re(J,me),unknownCompressedSize:Re(J,me),acCompressedSize:Re(J,me),dcCompressedSize:Re(J,me),rleCompressedSize:Re(J,me),rleUncompressedSize:Re(J,me),rleRawSize:Re(J,me),totalAcUncompressedCount:Re(J,me),totalDcUncompressedCount:Re(J,me),acCompression:Re(J,me)};if($e.version<2)throw"EXRLoader.parse: "+Un.compression+" version "+$e.version+" is unsupported";for(var je=new Array,_t=lt(J,me)-2;_t>0;){var ct=Bt(J.buffer,me),pt=ue(J,me),gt=pt>>2&3,Lt=(pt>>4)-1,bt=new Int8Array([Lt])[0],$=ue(J,me);je.push({name:ct,index:bt,type:$,compression:gt}),_t-=ct.length+3}for(var ce=Un.channels,Me=new Array(W.channels),Ae=0;Ae<W.channels;++Ae){var Se=Me[Ae]={},mt=ce[Ae];Se.name=mt.name,Se.compression=0,Se.decoded=!1,Se.type=mt.pixelType,Se.pLinear=mt.pLinear,Se.width=W.width,Se.height=W.lines}for(var Et={idx:new Array(3)},Rt=0;Rt<W.channels;++Rt)for(var Se=Me[Rt],Ae=0;Ae<je.length;++Ae){var It=je[Ae];Se.name==It.name&&(Se.compression=It.compression,It.index>=0&&(Et.idx[It.index]=Rt),Se.offset=Rt)}if($e.acCompressedSize>0)switch($e.acCompression){case 0:var Gt=new Uint16Array($e.totalAcUncompressedCount);fn(W.array,J,me,$e.acCompressedSize,Gt,$e.totalAcUncompressedCount);break;case 1:var Vt=W.array.slice(me.value,me.value+$e.totalAcUncompressedCount),mn=WA(Vt),Gt=new Uint16Array(mn.buffer);me.value+=$e.totalAcUncompressedCount;break}if($e.dcCompressedSize>0){var un={array:W.array,offset:me,size:$e.dcCompressedSize},ni=new Uint16Array(pe(un).buffer);me.value+=$e.dcCompressedSize}if($e.rleRawSize>0){var Vt=W.array.slice(me.value,me.value+$e.rleCompressedSize),mn=WA(Vt),zi=at(mn.buffer);me.value+=$e.rleCompressedSize}for(var si=0,Mn=new Array(Me.length),Ae=0;Ae<Mn.length;++Ae)Mn[Ae]=new Array;for(var en=0;en<W.lines;++en)for(var Cn=0;Cn<Me.length;++Cn)Mn[Cn].push(si),si+=Me[Cn].width*W.type*2;Je(Et,Mn,Me,Gt,ni,De);for(var Ae=0;Ae<Me.length;++Ae){var Se=Me[Ae];if(!Se.decoded)switch(Se.compression){case 2:for(var tn=0,Vi=0,en=0;en<W.lines;++en){for(var Ds=Mn[Ae][tn],Ii=0;Ii<Se.width;++Ii){for(var Jr=0;Jr<2*Se.type;++Jr)De[Ds++]=zi[Vi+Jr*Se.width*Se.height];Vi++}tn++}break;case 1:default:throw"EXRLoader.parse: unsupported channel compression"}}return new DataView(De.buffer)}function Bt(W,J){for(var me=new Uint8Array(W),De=0;me[J.value+De]!=0;)De+=1;var $e=new TextDecoder().decode(me.slice(J.value,J.value+De));return J.value=J.value+De+1,$e}function Ct(W,J,me){var De=new TextDecoder().decode(new Uint8Array(W).slice(J.value,J.value+me));return J.value=J.value+me,De}function Yt(W,J){var me=st(W,J),De=nt(W,J);return[me,De]}function $t(W,J){var me=nt(W,J),De=nt(W,J);return[me,De]}function st(W,J){var me=W.getInt32(J.value,!0);return J.value=J.value+4,me}function nt(W,J){var me=W.getUint32(J.value,!0);return J.value=J.value+4,me}function Pt(W,J){var me=W[J.value];return J.value=J.value+1,me}function ue(W,J){var me=W.getUint8(J.value);return J.value=J.value+1,me}const Re=function(W,J){let me;return"getBigInt64"in DataView.prototype?me=Number(W.getBigInt64(J.value,!0)):me=W.getUint32(J.value+4,!0)+Number(W.getUint32(J.value,!0)<<32),J.value+=8,me};function dt(W,J){var me=W.getFloat32(J.value,!0);return J.value+=4,me}function le(W,J){return m0.toHalfFloat(dt(W,J))}function Be(W){var J=(W&31744)>>10,me=W&1023;return(W>>15?-1:1)*(J?J===31?me?NaN:1/0:Math.pow(2,J-15)*(1+me/1024):6103515625e-14*(me/1024))}function lt(W,J){var me=W.getUint16(J.value,!0);return J.value+=2,me}function Ot(W,J){return Be(lt(W,J))}function ht(W,J,me,De){for(var $e=me.value,je=[];me.value<$e+De-1;){var _t=Bt(J,me),ct=st(W,me),pt=ue(W,me);me.value+=3;var gt=st(W,me),Lt=st(W,me);je.push({name:_t,pixelType:ct,pLinear:pt,xSampling:gt,ySampling:Lt})}return me.value+=1,je}function it(W,J){var me=dt(W,J),De=dt(W,J),$e=dt(W,J),je=dt(W,J),_t=dt(W,J),ct=dt(W,J),pt=dt(W,J),gt=dt(W,J);return{redX:me,redY:De,greenX:$e,greenY:je,blueX:_t,blueY:ct,whiteX:pt,whiteY:gt}}function Tt(W,J){var me=["NO_COMPRESSION","RLE_COMPRESSION","ZIPS_COMPRESSION","ZIP_COMPRESSION","PIZ_COMPRESSION","PXR24_COMPRESSION","B44_COMPRESSION","B44A_COMPRESSION","DWAA_COMPRESSION","DWAB_COMPRESSION"],De=ue(W,J);return me[De]}function ln(W,J){var me=nt(W,J),De=nt(W,J),$e=nt(W,J),je=nt(W,J);return{xMin:me,yMin:De,xMax:$e,yMax:je}}function jn(W,J){var me=["INCREASING_Y"],De=ue(W,J);return me[De]}function qt(W,J){var me=dt(W,J),De=dt(W,J);return[me,De]}function nn(W,J){var me=dt(W,J),De=dt(W,J),$e=dt(W,J);return[me,De,$e]}function Bn(W,J,me,De,$e){if(De==="string"||De==="stringvector"||De==="iccProfile")return Ct(J,me,$e);if(De==="chlist")return ht(W,J,me,$e);if(De==="chromaticities")return it(W,me);if(De==="compression")return Tt(W,me);if(De==="box2i")return ln(W,me);if(De==="lineOrder")return jn(W,me);if(De==="float")return dt(W,me);if(De==="v2f")return qt(W,me);if(De==="v3f")return nn(W,me);if(De==="int")return st(W,me);if(De==="rational")return Yt(W,me);if(De==="timecode")return $t(W,me);if(De==="preview")return me.value+=$e,"skipped";me.value+=$e}function Zt(W,J,me){const De={};if(W.getUint32(0,!0)!=20000630)throw"THREE.EXRLoader: provided file doesn't appear to be in OpenEXR format.";De.version=W.getUint8(4);const $e=W.getUint8(5);De.spec={singleTile:!!($e&2),longName:!!($e&4),deepFormat:!!($e&8),multiPart:!!($e&16)},me.value=8;for(var je=!0;je;){var _t=Bt(J,me);if(_t==0)je=!1;else{var ct=Bt(J,me),pt=nt(W,me),gt=Bn(W,J,me,ct,pt);gt===void 0?console.warn(`EXRLoader.parse: skipped unknown header attribute type '${ct}'.`):De[_t]=gt}}if(($e&-5)!=0)throw console.error("EXRHeader:",De),"THREE.EXRLoader: provided file is currently unsupported.";return De}function Ln(W,J,me,De,$e){const je={size:0,viewer:J,array:me,offset:De,width:W.dataWindow.xMax-W.dataWindow.xMin+1,height:W.dataWindow.yMax-W.dataWindow.yMin+1,channels:W.channels.length,bytesPerLine:null,lines:null,inputSize:null,type:W.channels[0].pixelType,uncompress:null,getter:null,format:null,[WS?"colorSpace":"encoding"]:null};switch(W.compression){case"NO_COMPRESSION":je.lines=1,je.uncompress=Z;break;case"RLE_COMPRESSION":je.lines=1,je.uncompress=k;break;case"ZIPS_COMPRESSION":je.lines=1,je.uncompress=pe;break;case"ZIP_COMPRESSION":je.lines=16,je.uncompress=pe;break;case"PIZ_COMPRESSION":je.lines=32,je.uncompress=Fe;break;case"PXR24_COMPRESSION":je.lines=16,je.uncompress=He;break;case"DWAA_COMPRESSION":je.lines=32,je.uncompress=ze;break;case"DWAB_COMPRESSION":je.lines=256,je.uncompress=ze;break;default:throw"EXRLoader.parse: "+W.compression+" is unsupported"}if(je.scanlineBlockSize=je.lines,je.type==1)switch($e){case Ci:je.getter=Ot,je.inputSize=2;break;case vi:je.getter=lt,je.inputSize=2;break}else if(je.type==2)switch($e){case Ci:je.getter=dt,je.inputSize=4;break;case vi:je.getter=le,je.inputSize=4}else throw"EXRLoader.parse: unsupported pixelType "+je.type+" for "+W.compression+".";je.blockCount=(W.dataWindow.yMax+1)/je.scanlineBlockSize;for(var _t=0;_t<je.blockCount;_t++)Re(J,De);je.outputChannels=je.channels==3?4:je.channels;const ct=je.width*je.height*je.outputChannels;switch($e){case Ci:je.byteArray=new Float32Array(ct),je.channels<je.outputChannels&&je.byteArray.fill(1,0,ct);break;case vi:je.byteArray=new Uint16Array(ct),je.channels<je.outputChannels&&je.byteArray.fill(15360,0,ct);break;default:console.error("THREE.EXRLoader: unsupported type: ",$e);break}return je.bytesPerLine=je.width*je.inputSize*je.channels,je.outputChannels==4?je.format=Qi:je.format=Pm,WS?je.colorSpace="srgb-linear":je.encoding=3e3,je}const dn=new DataView(e),wn=new Uint8Array(e),Bi={value:0},Un=Zt(dn,e,Bi),Jt=Ln(Un,dn,wn,Bi,this.type),xi={value:0},pn={R:0,G:1,B:2,A:3,Y:0};for(let W=0;W<Jt.height/Jt.scanlineBlockSize;W++){const J=nt(dn,Bi);Jt.size=nt(dn,Bi),Jt.lines=J+Jt.scanlineBlockSize>Jt.height?Jt.height-J:Jt.scanlineBlockSize;const De=Jt.size<Jt.lines*Jt.bytesPerLine?Jt.uncompress(Jt):Z(Jt);Bi.value+=Jt.size;for(let $e=0;$e<Jt.scanlineBlockSize;$e++){const je=$e+W*Jt.scanlineBlockSize;if(je>=Jt.height)break;for(let _t=0;_t<Jt.channels;_t++){const ct=pn[Un.channels[_t].name];for(let pt=0;pt<Jt.width;pt++){xi.value=($e*(Jt.channels*Jt.width)+_t*Jt.width+pt)*Jt.inputSize;const gt=(Jt.height-1-je)*(Jt.width*Jt.outputChannels)+pt*Jt.outputChannels+ct;Jt.byteArray[gt]=Jt.getter(De,xi)}}}}return{header:Un,width:Jt.width,height:Jt.height,data:Jt.byteArray,format:Jt.format,[WS?"colorSpace":"encoding"]:Jt[WS?"colorSpace":"encoding"],type:this.type}}setDataType(e){return this.type=e,this}load(e,t,n,i){function s(a,o){WS?a.colorSpace=o.colorSpace:a.encoding=o.encoding,a.minFilter=ei,a.magFilter=ei,a.generateMipmaps=!1,a.flipY=!1,t&&t(a,o)}return super.load(e,s,n,i)}}const ale=H.forwardRef(({makeDefault:r,camera:e,regress:t,domElement:n,enableDamping:i=!0,keyEvents:s=!1,onChange:a,onStart:o,onEnd:l,...c},d)=>{const p=ru(U=>U.invalidate),y=ru(U=>U.camera),_=ru(U=>U.gl),v=ru(U=>U.events),b=ru(U=>U.setEvents),E=ru(U=>U.set),T=ru(U=>U.get),M=ru(U=>U.performance),R=e||y,N=n||v.connected||_.domElement,P=H.useMemo(()=>new ile(R),[R]);return eP(()=>{P.enabled&&P.update()},-1),H.useEffect(()=>(s&&P.connect(s===!0?N:s),P.connect(N),()=>{P.dispose()}),[s,N,t,P,p]),H.useEffect(()=>{const U=O=>{p(),t&&M.regress(),a&&a(O)},L=O=>{o&&o(O)},F=O=>{l&&l(O)};return P.addEventListener("change",U),P.addEventListener("start",L),P.addEventListener("end",F),()=>{P.removeEventListener("start",L),P.removeEventListener("end",F),P.removeEventListener("change",U)}},[a,o,l,P,p,b]),H.useEffect(()=>{if(r){const U=T().controls;return E({controls:P}),()=>E({controls:U})}},[r,P]),H.createElement("primitive",xR({ref:d,object:P,enableDamping:i},c))}),kH=(r,e,t)=>{let n;switch(r){case ir:n=new Uint8ClampedArray(e*t*4);break;case vi:n=new Uint16Array(e*t*4);break;case Hi:n=new Uint32Array(e*t*4);break;case _h:n=new Int8Array(e*t*4);break;case vh:n=new Int16Array(e*t*4);break;case Hs:n=new Int32Array(e*t*4);break;case Ci:n=new Float32Array(e*t*4);break;default:throw new Error("Unsupported data type")}return n};let XA;const ole=(r,e,t,n)=>{if(XA!==void 0)return XA;const i=new sl(1,1,n);e.setRenderTarget(i);const s=new ar(new $h,new lo({color:16777215}));e.render(s,t),e.setRenderTarget(null);const a=kH(r,i.width,i.height);return e.readRenderTargetPixels(i,0,0,i.width,i.height,a),i.dispose(),s.geometry.dispose(),s.material.dispose(),XA=a[0]!==0,XA};class CP{_renderer;_rendererIsDisposable=!1;_material;_scene;_camera;_quad;_renderTarget;_width;_height;_type;_colorSpace;_supportsReadPixels=!0;constructor(e){this._width=e.width,this._height=e.height,this._type=e.type,this._colorSpace=e.colorSpace;const t={format:Qi,depthBuffer:!1,stencilBuffer:!1,type:this._type,colorSpace:this._colorSpace,anisotropy:e.renderTargetOptions?.anisotropy!==void 0?e.renderTargetOptions?.anisotropy:1,generateMipmaps:e.renderTargetOptions?.generateMipmaps!==void 0?e.renderTargetOptions?.generateMipmaps:!1,magFilter:e.renderTargetOptions?.magFilter!==void 0?e.renderTargetOptions?.magFilter:ei,minFilter:e.renderTargetOptions?.minFilter!==void 0?e.renderTargetOptions?.minFilter:ei,samples:e.renderTargetOptions?.samples!==void 0?e.renderTargetOptions?.samples:void 0,wrapS:e.renderTargetOptions?.wrapS!==void 0?e.renderTargetOptions?.wrapS:Dr,wrapT:e.renderTargetOptions?.wrapT!==void 0?e.renderTargetOptions?.wrapT:Dr};if(this._material=e.material,e.renderer?this._renderer=e.renderer:(this._renderer=CP.instantiateRenderer(),this._rendererIsDisposable=!0),this._scene=new Fm,this._camera=new rc,this._camera.position.set(0,0,10),this._camera.left=-.5,this._camera.right=.5,this._camera.top=.5,this._camera.bottom=-.5,this._camera.updateProjectionMatrix(),!ole(this._type,this._renderer,this._camera,t)){let n;switch(this._type){case vi:n=this._renderer.extensions.has("EXT_color_buffer_float")?Ci:void 0;break}n!==void 0?(console.warn(`This browser does not support reading pixels from ${this._type} RenderTargets, switching to ${Ci}`),this._type=n):(this._supportsReadPixels=!1,console.warn("This browser dos not support toArray or toDataTexture, calls to those methods will result in an error thrown"))}this._quad=new ar(new $h,this._material),this._quad.geometry.computeBoundingBox(),this._scene.add(this._quad),this._renderTarget=new sl(this.width,this.height,t),this._renderTarget.texture.mapping=e.renderTargetOptions?.mapping!==void 0?e.renderTargetOptions?.mapping:Uh}static instantiateRenderer(){const e=new jL;return e.setSize(128,128),e}render=()=>{this._renderer.setRenderTarget(this._renderTarget);try{this._renderer.render(this._scene,this._camera)}catch(e){throw this._renderer.setRenderTarget(null),e}this._renderer.setRenderTarget(null)};toArray(){if(!this._supportsReadPixels)throw new Error("Can't read pixels in this browser");const e=kH(this._type,this._width,this._height);return this._renderer.readRenderTargetPixels(this._renderTarget,0,0,this._width,this._height,e),e}toDataTexture(e){const t=new Ol(this.toArray(),this.width,this.height,Qi,this._type,e?.mapping||Uh,e?.wrapS||Dr,e?.wrapT||Dr,e?.magFilter||ei,e?.minFilter||ei,e?.anisotropy||1,vu);return t.generateMipmaps=e?.generateMipmaps!==void 0?e?.generateMipmaps:!1,t}disposeOnDemandRenderer(){this._renderer.setRenderTarget(null),this._rendererIsDisposable&&(this._renderer.dispose(),this._renderer.forceContextLoss())}dispose(e){this.disposeOnDemandRenderer(),e&&this.renderTarget.dispose(),this.material instanceof ul&&Object.values(this.material.uniforms).forEach(t=>{t.value instanceof sr&&t.value.dispose()}),Object.values(this.material).forEach(t=>{t instanceof sr&&t.dispose()}),this.material.dispose(),this._quad.geometry.dispose()}get width(){return this._width}set width(e){this._width=e,this._renderTarget.setSize(this._width,this._height)}get height(){return this._height}set height(e){this._height=e,this._renderTarget.setSize(this._width,this._height)}get renderer(){return this._renderer}get renderTarget(){return this._renderTarget}set renderTarget(e){this._renderTarget=e,this._width=e.width,this._height=e.height}get material(){return this._material}get type(){return this._type}get colorSpace(){return this._colorSpace}}class HH extends Error{}class WH extends Error{}const qS=(r,e,t)=>{const n=new RegExp(`${e}="([^"]*)"`,"i").exec(r);if(n)return n[1];const i=new RegExp(`<${e}[^>]*>([\\s\\S]*?)</${e}>`,"i").exec(r);if(i){const s=i[1].match(/<rdf:li>([^<]*)<\/rdf:li>/g);return s&&s.length===3?s.map(a=>a.replace(/<\/?rdf:li>/g,"")):i[1].trim()}if(t!==void 0)return t;throw new Error(`Can't find ${e} in gainmap metadata`)},lle=r=>{let e;typeof TextDecoder<"u"?e=new TextDecoder().decode(r):e=r.toString();let t=e.indexOf("<x:xmpmeta");for(;t!==-1;){const n=e.indexOf("x:xmpmeta>",t),i=e.slice(t,n+10);try{const s=qS(i,"hdrgm:GainMapMin","0"),a=qS(i,"hdrgm:GainMapMax"),o=qS(i,"hdrgm:Gamma","1"),l=qS(i,"hdrgm:OffsetSDR","0.015625"),c=qS(i,"hdrgm:OffsetHDR","0.015625"),d=/hdrgm:HDRCapacityMin="([^"]*)"/.exec(i),p=d?d[1]:"0",y=/hdrgm:HDRCapacityMax="([^"]*)"/.exec(i);if(!y)throw new Error("Incomplete gainmap metadata");const _=y[1];return{gainMapMin:Array.isArray(s)?s.map(v=>parseFloat(v)):[parseFloat(s),parseFloat(s),parseFloat(s)],gainMapMax:Array.isArray(a)?a.map(v=>parseFloat(v)):[parseFloat(a),parseFloat(a),parseFloat(a)],gamma:Array.isArray(o)?o.map(v=>parseFloat(v)):[parseFloat(o),parseFloat(o),parseFloat(o)],offsetSdr:Array.isArray(l)?l.map(v=>parseFloat(v)):[parseFloat(l),parseFloat(l),parseFloat(l)],offsetHdr:Array.isArray(c)?c.map(v=>parseFloat(v)):[parseFloat(c),parseFloat(c),parseFloat(c)],hdrCapacityMin:parseFloat(p),hdrCapacityMax:parseFloat(_)}}catch{}t=e.indexOf("<x:xmpmeta",n)}};class ule{options;constructor(e){this.options={debug:e&&e.debug!==void 0?e.debug:!1,extractFII:e&&e.extractFII!==void 0?e.extractFII:!0,extractNonFII:e&&e.extractNonFII!==void 0?e.extractNonFII:!0}}extract(e){return new Promise((t,n)=>{const i=this.options.debug,s=new DataView(e.buffer);if(s.getUint16(0)!==65496){n(new Error("Not a valid jpeg"));return}const a=s.byteLength;let o=2,l=0,c;for(;o<a;){if(++l>250){n(new Error(`Found no marker after ${l} loops `));return}if(s.getUint8(o)!==255){n(new Error(`Not a valid marker at offset 0x${o.toString(16)}, found: 0x${s.getUint8(o).toString(16)}`));return}if(c=s.getUint8(o+1),i&&console.log(`Marker: ${c.toString(16)}`),c===226){i&&console.log("Found APP2 marker (0xffe2)");const d=o+4;if(s.getUint32(d)===1297106432){const p=d+4;let y;if(s.getUint16(p)===18761)y=!1;else if(s.getUint16(p)===19789)y=!0;else{n(new Error("No valid endianness marker found in TIFF header"));return}if(s.getUint16(p+2,!y)!==42){n(new Error("Not valid TIFF data! (no 0x002A marker)"));return}const _=s.getUint32(p+4,!y);if(_<8){n(new Error("Not valid TIFF data! (First offset less than 8)"));return}const v=p+_,b=s.getUint16(v,!y),E=v+2;let T=0;for(let P=E;P<E+12*b;P+=12)s.getUint16(P,!y)===45057&&(T=s.getUint32(P+8,!y));const R=v+2+b*12+4,N=[];for(let P=R;P<R+T*16;P+=16){const U={MPType:s.getUint32(P,!y),size:s.getUint32(P+4,!y),dataOffset:s.getUint32(P+8,!y),dependantImages:s.getUint32(P+12,!y),start:-1,end:-1,isFII:!1};U.dataOffset?(U.start=p+U.dataOffset,U.isFII=!1):(U.start=0,U.isFII=!0),U.end=U.start+U.size,N.push(U)}if(this.options.extractNonFII&&N.length){const P=new Blob([s]),U=[];for(const L of N){if(L.isFII&&!this.options.extractFII)continue;const F=P.slice(L.start,L.end+1,"image/jpeg");U.push(F)}t(U)}}}o+=2+s.getUint16(o+2)}})}}const cle=async r=>{const e=lle(r);if(!e)throw new WH("Gain map XMP metadata not found");const n=await new ule({extractFII:!0,extractNonFII:!0}).extract(r);if(n.length!==2)throw new HH("Gain map recovery image not found");return{sdr:new Uint8Array(await n[0].arrayBuffer()),gainMap:new Uint8Array(await n[1].arrayBuffer()),metadata:e}},N4=r=>new Promise((e,t)=>{const n=document.createElement("img");n.onload=()=>{e(n)},n.onerror=i=>{t(i)},n.src=URL.createObjectURL(r)});class fle extends cl{_renderer;_renderTargetOptions;_internalLoadingManager;_config;constructor(e,t){super(t),this._config=e,e.renderer&&(this._renderer=e.renderer),this._internalLoadingManager=new qC}setRenderer(e){return this._renderer=e,this}setRenderTargetOptions(e){return this._renderTargetOptions=e,this}prepareQuadRenderer(){this._renderer||console.warn("WARNING: A Renderer was not passed to this Loader constructor or in setRenderer, the result of this Loader will need to be converted to a Data Texture with toDataTexture() before you can use it in your renderer.");const e=this._config.createMaterial({gainMapMax:[1,1,1],gainMapMin:[0,0,0],gamma:[1,1,1],offsetHdr:[1,1,1],offsetSdr:[1,1,1],hdrCapacityMax:1,hdrCapacityMin:0,maxDisplayBoost:1,gainMap:new sr,sdr:new sr});return this._config.createQuadRenderer({width:16,height:16,type:vi,colorSpace:vu,material:e,renderer:this._renderer,renderTargetOptions:this._renderTargetOptions})}async processImages(e,t,n){const i=t?new Blob([t],{type:"image/jpeg"}):void 0,s=new Blob([e],{type:"image/jpeg"});let a,o,l=!1;if(typeof createImageBitmap>"u"){const c=await Promise.all([i?N4(i):Promise.resolve(void 0),N4(s)]);o=c[0],a=c[1],l=n==="flipY"}else{const c=await Promise.all([i?createImageBitmap(i,{imageOrientation:n||"flipY"}):Promise.resolve(void 0),createImageBitmap(s,{imageOrientation:n||"flipY"})]);o=c[0],a=c[1]}return{sdrImage:a,gainMapImage:o,needsFlip:l}}createTextures(e,t,n){const i=new sr(t||new ImageData(2,2),Uh,Dr,Dr,ei,jw,Qi,ir,1,vu);i.flipY=n,i.needsUpdate=!0;const s=new sr(e,Uh,Dr,Dr,ei,jw,Qi,ir,1,ea);return s.flipY=n,s.needsUpdate=!0,{gainMap:i,sdr:s}}updateQuadRenderer(e,t,n,i,s){e.width=t.width,e.height=t.height,e.material.gainMap=n,e.material.sdr=i,e.material.gainMapMin=s.gainMapMin,e.material.gainMapMax=s.gainMapMax,e.material.offsetHdr=s.offsetHdr,e.material.offsetSdr=s.offsetSdr,e.material.gamma=s.gamma,e.material.hdrCapacityMin=s.hdrCapacityMin,e.material.hdrCapacityMax=s.hdrCapacityMax,e.material.maxDisplayBoost=Math.pow(2,s.hdrCapacityMax),e.material.needsUpdate=!0}}const dle=`
varying vec2 vUv;

void main() {
  vUv = uv;
  gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);
}
`,hle=`
// min half float value
#define HALF_FLOAT_MIN vec3( -65504, -65504, -65504 )
// max half float value
#define HALF_FLOAT_MAX vec3( 65504, 65504, 65504 )

uniform sampler2D sdr;
uniform sampler2D gainMap;
uniform vec3 gamma;
uniform vec3 offsetHdr;
uniform vec3 offsetSdr;
uniform vec3 gainMapMin;
uniform vec3 gainMapMax;
uniform float weightFactor;

varying vec2 vUv;

void main() {
  vec3 rgb = texture2D( sdr, vUv ).rgb;
  vec3 recovery = texture2D( gainMap, vUv ).rgb;
  vec3 logRecovery = pow( recovery, gamma );
  vec3 logBoost = gainMapMin * ( 1.0 - logRecovery ) + gainMapMax * logRecovery;
  vec3 hdrColor = (rgb + offsetSdr) * exp2( logBoost * weightFactor ) - offsetHdr;
  vec3 clampedHdrColor = max( HALF_FLOAT_MIN, min( HALF_FLOAT_MAX, hdrColor ));
  gl_FragColor = vec4( clampedHdrColor , 1.0 );
}
`;class ple extends ul{_maxDisplayBoost;_hdrCapacityMin;_hdrCapacityMax;constructor({gamma:e,offsetHdr:t,offsetSdr:n,gainMapMin:i,gainMapMax:s,maxDisplayBoost:a,hdrCapacityMin:o,hdrCapacityMax:l,sdr:c,gainMap:d}){super({name:"GainMapDecoderMaterial",vertexShader:dle,fragmentShader:hle,uniforms:{sdr:{value:c},gainMap:{value:d},gamma:{value:new ne(1/e[0],1/e[1],1/e[2])},offsetHdr:{value:new ne().fromArray(t)},offsetSdr:{value:new ne().fromArray(n)},gainMapMin:{value:new ne().fromArray(i)},gainMapMax:{value:new ne().fromArray(s)},weightFactor:{value:(Math.log2(a)-o)/(l-o)}},blending:yo,depthTest:!1,depthWrite:!1}),this._maxDisplayBoost=a,this._hdrCapacityMin=o,this._hdrCapacityMax=l,this.needsUpdate=!0,this.uniformsNeedUpdate=!0}get sdr(){return this.uniforms.sdr.value}set sdr(e){this.uniforms.sdr.value=e}get gainMap(){return this.uniforms.gainMap.value}set gainMap(e){this.uniforms.gainMap.value=e}get offsetHdr(){return this.uniforms.offsetHdr.value.toArray()}set offsetHdr(e){this.uniforms.offsetHdr.value.fromArray(e)}get offsetSdr(){return this.uniforms.offsetSdr.value.toArray()}set offsetSdr(e){this.uniforms.offsetSdr.value.fromArray(e)}get gainMapMin(){return this.uniforms.gainMapMin.value.toArray()}set gainMapMin(e){this.uniforms.gainMapMin.value.fromArray(e)}get gainMapMax(){return this.uniforms.gainMapMax.value.toArray()}set gainMapMax(e){this.uniforms.gainMapMax.value.fromArray(e)}get gamma(){const e=this.uniforms.gamma.value;return[1/e.x,1/e.y,1/e.z]}set gamma(e){const t=this.uniforms.gamma.value;t.x=1/e[0],t.y=1/e[1],t.z=1/e[2]}get hdrCapacityMin(){return this._hdrCapacityMin}set hdrCapacityMin(e){this._hdrCapacityMin=e,this.calculateWeight()}get hdrCapacityMax(){return this._hdrCapacityMax}set hdrCapacityMax(e){this._hdrCapacityMax=e,this.calculateWeight()}get maxDisplayBoost(){return this._maxDisplayBoost}set maxDisplayBoost(e){this._maxDisplayBoost=Math.max(1,Math.min(65504,e)),this.calculateWeight()}calculateWeight(){const e=(Math.log2(this._maxDisplayBoost)-this._hdrCapacityMin)/(this._hdrCapacityMax-this._hdrCapacityMin);this.uniforms.weightFactor.value=Math.max(0,Math.min(1,e))}}class qH extends fle{constructor(e,t){super({renderer:e,createMaterial:n=>new ple(n),createQuadRenderer:n=>new CP(n)},t)}async render(e,t,n,i){const{sdrImage:s,gainMapImage:a,needsFlip:o}=await this.processImages(n,i,"flipY"),{gainMap:l,sdr:c}=this.createTextures(s,a,o);this.updateQuadRenderer(e,s,l,c,t),e.render()}}class mle extends qH{load([e,t,n],i,s,a){const o=this.prepareQuadRenderer();let l,c,d;const p=async()=>{if(l&&c&&d){try{await this.render(o,d,l,c)}catch(O){this.manager.itemError(e),this.manager.itemError(t),this.manager.itemError(n),typeof a=="function"&&a(O),o.disposeOnDemandRenderer();return}typeof i=="function"&&i(o),this.manager.itemEnd(e),this.manager.itemEnd(t),this.manager.itemEnd(n),o.disposeOnDemandRenderer()}};let y=!0,_=0,v=0,b=!0,E=0,T=0,M=!0,R=0,N=0;const P=()=>{if(typeof s=="function"){const O=_+E+R,B=v+T+N,q=y&&b&&M;s(new ProgressEvent("progress",{lengthComputable:q,loaded:B,total:O}))}};this.manager.itemStart(e),this.manager.itemStart(t),this.manager.itemStart(n);const U=new mu(this._internalLoadingManager);U.setResponseType("arraybuffer"),U.setRequestHeader(this.requestHeader),U.setPath(this.path),U.setWithCredentials(this.withCredentials),U.load(e,async O=>{if(typeof O=="string")throw new Error("Invalid sdr buffer");l=O,await p()},O=>{y=O.lengthComputable,v=O.loaded,_=O.total,P()},O=>{this.manager.itemError(e),typeof a=="function"&&a(O)});const L=new mu(this._internalLoadingManager);L.setResponseType("arraybuffer"),L.setRequestHeader(this.requestHeader),L.setPath(this.path),L.setWithCredentials(this.withCredentials),L.load(t,async O=>{if(typeof O=="string")throw new Error("Invalid gainmap buffer");c=O,await p()},O=>{b=O.lengthComputable,T=O.loaded,E=O.total,P()},O=>{this.manager.itemError(t),typeof a=="function"&&a(O)});const F=new mu(this._internalLoadingManager);return F.setRequestHeader(this.requestHeader),F.setPath(this.path),F.setWithCredentials(this.withCredentials),F.load(n,async O=>{if(typeof O!="string")throw new Error("Invalid metadata string");d=JSON.parse(O),await p()},O=>{M=O.lengthComputable,N=O.loaded,R=O.total,P()},O=>{this.manager.itemError(n),typeof a=="function"&&a(O)}),o}}class gle extends qH{load(e,t,n,i){const s=this.prepareQuadRenderer(),a=new mu(this._internalLoadingManager);return a.setResponseType("arraybuffer"),a.setRequestHeader(this.requestHeader),a.setPath(this.path),a.setWithCredentials(this.withCredentials),this.manager.itemStart(e),a.load(e,async o=>{if(typeof o=="string")throw new Error("Invalid buffer, received [string], was expecting [ArrayBuffer]");const l=new Uint8Array(o);let c,d,p;try{const y=await cle(l);c=y.sdr,d=y.gainMap,p=y.metadata}catch(y){if(y instanceof WH||y instanceof HH)console.warn(`Failure to reconstruct an HDR image from ${e}: Gain map metadata not found in the file, HDRJPGLoader will render the SDR jpeg`),p={gainMapMin:[0,0,0],gainMapMax:[1,1,1],gamma:[1,1,1],hdrCapacityMin:0,hdrCapacityMax:1,offsetHdr:[0,0,0],offsetSdr:[0,0,0]},c=l;else throw y}try{await this.render(s,p,c.buffer,d?.buffer)}catch(y){this.manager.itemError(e),typeof i=="function"&&i(y),s.disposeOnDemandRenderer();return}typeof t=="function"&&t(s),this.manager.itemEnd(e),s.disposeOnDemandRenderer()},n,o=>{this.manager.itemError(e),typeof i=="function"&&i(o)}),s}}const b1={apartment:"lebombo_1k.hdr",city:"potsdamer_platz_1k.hdr",dawn:"kiara_1_dawn_1k.hdr",forest:"forest_slope_1k.hdr",lobby:"st_fagans_interior_1k.hdr",night:"dikhololo_night_1k.hdr",park:"rooitou_park_1k.hdr",studio:"studio_small_03_1k.hdr",sunset:"venice_sunset_1k.hdr",warehouse:"empty_warehouse_01_1k.hdr"},XH="https://raw.githack.com/pmndrs/drei-assets/456060a26bbeb8fdf79326f224b6d99b8bcce736/hdri/",jv=r=>Array.isArray(r),NP=["/px.png","/nx.png","/py.png","/ny.png","/pz.png","/nz.png"];function tN({files:r=NP,path:e="",preset:t=void 0,colorSpace:n=void 0,extensions:i}={}){t&&(DP(t),r=b1[t],e=XH);const s=jv(r),{extension:a,isCubemap:o}=OP(r),l=UP(a);if(!l)throw new Error("useEnvironment: Unrecognized file extension: "+r);const c=ru(_=>_.gl);H.useLayoutEffect(()=>{if(a!=="webp"&&a!=="jpg"&&a!=="jpeg")return;function _(){xx.clear(l,s?[r]:r)}c.domElement.addEventListener("webglcontextlost",_,{once:!0})},[r,c.domElement]);const d=xx(l,s?[r]:r,_=>{(a==="webp"||a==="jpg"||a==="jpeg")&&_.setRenderer(c),_.setPath==null||_.setPath(e),i&&i(_)});let p=s?d[0]:d;if(a==="jpg"||a==="jpeg"||a==="webp"){var y;p=(y=p.renderTarget)==null?void 0:y.texture}return p.mapping=o?ol:Lh,p.colorSpace=n??(o?"srgb":"srgb-linear"),p}const yle={files:NP,path:"",preset:void 0,extensions:void 0};tN.preload=r=>{const e={...yle,...r};let{files:t,path:n=""}=e;const{preset:i,extensions:s}=e;i&&(DP(i),t=b1[i],n=XH);const{extension:a}=OP(t);if(a==="webp"||a==="jpg"||a==="jpeg")throw new Error("useEnvironment: Preloading gainmaps is not supported");const o=UP(a);if(!o)throw new Error("useEnvironment: Unrecognized file extension: "+t);xx.preload(o,jv(t)?[t]:t,l=>{l.setPath==null||l.setPath(n),s&&s(l)})};const _le={files:NP,preset:void 0};tN.clear=r=>{const e={..._le,...r};let{files:t}=e;const{preset:n}=e;n&&(DP(n),t=b1[n]);const{extension:i}=OP(t),s=UP(i);if(!s)throw new Error("useEnvironment: Unrecognized file extension: "+t);xx.clear(s,jv(t)?[t]:t)};function DP(r){if(!(r in b1))throw new Error("Preset must be one of: "+Object.keys(b1).join(", "))}function OP(r){var e;const t=jv(r)&&r.length===6,n=jv(r)&&r.length===3&&r.some(a=>a.endsWith("json")),i=jv(r)?r[0]:r;return{extension:t?"cube":n?"webp":i.startsWith("data:application/exr")?"exr":i.startsWith("data:application/hdr")?"hdr":i.startsWith("data:image/jpeg")?"jpg":(e=i.split(".").pop())==null||(e=e.split("?"))==null||(e=e.shift())==null?void 0:e.toLowerCase(),isCubemap:t,isGainmap:n}}function UP(r){return r==="cube"?T6:r==="hdr"?rle:r==="exr"?sle:r==="jpg"||r==="jpeg"?gle:r==="webp"?mle:null}const vle=r=>r.current&&r.current.isScene,xle=r=>vle(r)?r.current:r;function LP(r,e,t,n,i={}){var s,a,o,l;i={backgroundBlurriness:0,backgroundIntensity:1,backgroundRotation:[0,0,0],environmentIntensity:1,environmentRotation:[0,0,0],...i};const c=xle(e||t),d=c.background,p=c.environment,y={backgroundBlurriness:c.backgroundBlurriness,backgroundIntensity:c.backgroundIntensity,backgroundRotation:(s=(a=c.backgroundRotation)==null||a.clone==null?void 0:a.clone())!==null&&s!==void 0?s:[0,0,0],environmentIntensity:c.environmentIntensity,environmentRotation:(o=(l=c.environmentRotation)==null||l.clone==null?void 0:l.clone())!==null&&o!==void 0?o:[0,0,0]};return r!=="only"&&(c.environment=n),r&&(c.background=n),Jf(c,i),()=>{r!=="only"&&(c.environment=p),r&&(c.background=d),Jf(c,y)}}function PP({scene:r,background:e=!1,map:t,...n}){const i=ru(s=>s.scene);return H.useLayoutEffect(()=>{if(t)return LP(e,r,i,t,n)}),null}function $H({background:r=!1,scene:e,blur:t,backgroundBlurriness:n,backgroundIntensity:i,backgroundRotation:s,environmentIntensity:a,environmentRotation:o,...l}){const c=tN(l),d=ru(p=>p.scene);return H.useLayoutEffect(()=>LP(r,e,d,c,{backgroundBlurriness:t??n,backgroundIntensity:i,backgroundRotation:s,environmentIntensity:a,environmentRotation:o})),H.useEffect(()=>()=>{c.dispose()},[c]),null}function ble({children:r,near:e=.1,far:t=1e3,resolution:n=256,frames:i=1,map:s,background:a=!1,blur:o,backgroundBlurriness:l,backgroundIntensity:c,backgroundRotation:d,environmentIntensity:p,environmentRotation:y,scene:_,files:v,path:b,preset:E=void 0,extensions:T}){const M=ru(F=>F.gl),R=ru(F=>F.scene),N=H.useRef(null),[P]=H.useState(()=>new Fm),U=H.useMemo(()=>{const F=new k1(n);return F.texture.type=vi,F},[n]);H.useEffect(()=>()=>{U.dispose()},[U]),H.useLayoutEffect(()=>{if(i===1){const F=M.autoClear;M.autoClear=!0,N.current.update(M,P),M.autoClear=F}return LP(a,_,R,U.texture,{backgroundBlurriness:o??l,backgroundIntensity:c,backgroundRotation:d,environmentIntensity:p,environmentRotation:y})},[r,P,U.texture,_,R,a,i,M]);let L=1;return eP(()=>{if(i===1/0||L<i){const F=M.autoClear;M.autoClear=!0,N.current.update(M,P),M.autoClear=F,L++}}),H.createElement(H.Fragment,null,Xre(H.createElement(H.Fragment,null,r,H.createElement("cubeCamera",{ref:N,args:[e,t,U]}),v||E?H.createElement($H,{background:!0,files:v,preset:E,path:b,extensions:T}):s?H.createElement(PP,{background:!0,map:s,extensions:T}):null),P))}function Sle(r){var e,t,n,i;const s=tN(r),a=r.map||s;H.useMemo(()=>tP({GroundProjectedEnvImpl:Yoe}),[]),H.useEffect(()=>()=>{s.dispose()},[s]);const o=H.useMemo(()=>[a],[a]),l=(e=r.ground)==null?void 0:e.height,c=(t=r.ground)==null?void 0:t.radius,d=(n=(i=r.ground)==null?void 0:i.scale)!==null&&n!==void 0?n:1e3;return H.createElement(H.Fragment,null,H.createElement(PP,xR({},r,{map:a})),H.createElement("groundProjectedEnvImpl",{args:o,scale:d,height:l,radius:c}))}function Tle(r){return r.ground?H.createElement(Sle,r):r.map?H.createElement(PP,r):r.children?H.createElement(ble,r):H.createElement($H,r)}const Ele=["alphaMap","alphaTest","anisotropy","anisotropyMap","anisotropyRotation","aoMap","aoMapIntensity","attenuationColor","attenuationDistance","bumpMap","clearcoat","clearcoatMap","clearcoatNormalMap","clearcoatNormalScale","clearcoatRoughness","color","dispersion","displacementMap","emissive","emissiveIntensity","emissiveMap","envMap","envMapIntensity","gradientMap","ior","iridescence","iridescenceIOR","iridescenceMap","iridescenceThicknessMap","lightMap","lightMapIntensity","map","matcap","metalness","metalnessMap","normalMap","normalScale","opacity","roughness","roughnessMap","sheen","sheenColor","sheenColorMap","sheenRoughnessMap","shininess","specular","specularColor","specularColorMap","specularIntensity","specularIntensityMap","specularMap","thickness","transmission","transmissionMap"],iD=new WeakMap;class Mle{constructor(e){this.renderObjects=new WeakMap,this.hasNode=this.containsNode(e),this.hasAnimation=e.object.isSkinnedMesh===!0,this.refreshUniforms=Ele,this.renderId=0}firstInitialization(e){return this.renderObjects.has(e)===!1?(this.getRenderObjectData(e),!0):!1}needsVelocity(e){const t=e.getMRT();return t!==null&&t.has("velocity")}getRenderObjectData(e){let t=this.renderObjects.get(e);if(t===void 0){const{geometry:n,material:i,object:s}=e;if(t={material:this.getMaterialData(i),geometry:{id:n.id,attributes:this.getAttributesData(n.attributes),indexVersion:n.index?n.index.version:null,drawRange:{start:n.drawRange.start,count:n.drawRange.count}},worldMatrix:s.matrixWorld.clone()},s.center&&(t.center=s.center.clone()),s.morphTargetInfluences&&(t.morphTargetInfluences=s.morphTargetInfluences.slice()),e.bundle!==null&&(t.version=e.bundle.version),t.material.transmission>0){const{width:a,height:o}=e.context;t.bufferWidth=a,t.bufferHeight=o}t.lights=this.getLightsData(e.lightsNode.getLights()),this.renderObjects.set(e,t)}return t}getAttributesData(e){const t={};for(const n in e){const i=e[n];t[n]={version:i.version}}return t}containsNode(e){const t=e.material;for(const n in t)if(t[n]&&t[n].isNode)return!0;return!!(e.context.modelViewMatrix||e.context.modelNormalViewMatrix||e.context.getAO||e.context.getShadow)}getMaterialData(e){const t={};for(const n of this.refreshUniforms){const i=e[n];i!=null&&(typeof i=="object"&&i.clone!==void 0?i.isTexture===!0?t[n]={id:i.id,version:i.version}:t[n]=i.clone():t[n]=i)}return t}equals(e,t){const{object:n,material:i,geometry:s}=e,a=this.getRenderObjectData(e);if(a.worldMatrix.equals(n.matrixWorld)!==!0)return a.worldMatrix.copy(n.matrixWorld),!1;const o=a.material;for(const E in o){const T=o[E],M=i[E];if(T.equals!==void 0){if(T.equals(M)===!1)return T.copy(M),!1}else if(M.isTexture===!0){if(T.id!==M.id||T.version!==M.version)return T.id=M.id,T.version=M.version,!1}else if(T!==M)return o[E]=M,!1}if(o.transmission>0){const{width:E,height:T}=e.context;if(a.bufferWidth!==E||a.bufferHeight!==T)return a.bufferWidth=E,a.bufferHeight=T,!1}const l=a.geometry,c=s.attributes,d=l.attributes,p=Object.keys(d),y=Object.keys(c);if(l.id!==s.id)return l.id=s.id,!1;if(p.length!==y.length)return a.geometry.attributes=this.getAttributesData(c),!1;for(const E of p){const T=d[E],M=c[E];if(M===void 0)return delete d[E],!1;if(T.version!==M.version)return T.version=M.version,!1}const _=s.index,v=l.indexVersion,b=_?_.version:null;if(v!==b)return l.indexVersion=b,!1;if(l.drawRange.start!==s.drawRange.start||l.drawRange.count!==s.drawRange.count)return l.drawRange.start=s.drawRange.start,l.drawRange.count=s.drawRange.count,!1;if(a.morphTargetInfluences){let E=!1;for(let T=0;T<a.morphTargetInfluences.length;T++)a.morphTargetInfluences[T]!==n.morphTargetInfluences[T]&&(a.morphTargetInfluences[T]=n.morphTargetInfluences[T],E=!0);if(E)return!1}if(a.lights){for(let E=0;E<t.length;E++)if(a.lights[E].map!==t[E].map)return!1}return a.center&&a.center.equals(n.center)===!1?(a.center.copy(n.center),!0):(e.bundle!==null&&(a.version=e.bundle.version),!0)}getLightsData(e){const t=[];for(const n of e)n.isSpotLight===!0&&n.map!==null&&t.push({map:n.map.version});return t}getLights(e,t){if(iD.has(e)){const i=iD.get(e);if(i.renderId===t)return i.lightsData}const n=this.getLightsData(e.getLights());return iD.set(e,{renderId:t,lightsData:n}),n}needsRefresh(e,t){if(this.hasNode||this.hasAnimation||this.firstInitialization(e)||this.needsVelocity(t.renderer))return!0;const{renderId:n}=t;if(this.renderId!==n)return this.renderId=n,!0;const i=e.object.static===!0,s=e.bundle!==null&&e.bundle.static===!0&&this.getRenderObjectData(e).version===e.bundle.version;if(i||s)return!1;const a=this.getLights(e.lightsNode,n);return this.equals(e,a)!==!0}}function BP(r,e=0){let t=3735928559^e,n=1103547991^e;if(r instanceof Array)for(let i=0,s;i<r.length;i++)s=r[i],t=Math.imul(t^s,2654435761),n=Math.imul(n^s,1597334677);else for(let i=0,s;i<r.length;i++)s=r.charCodeAt(i),t=Math.imul(t^s,2654435761),n=Math.imul(n^s,1597334677);return t=Math.imul(t^t>>>16,2246822507),t^=Math.imul(n^n>>>13,3266489909),n=Math.imul(n^n>>>16,2246822507),n^=Math.imul(t^t>>>13,3266489909),4294967296*(2097151&n)+(t>>>0)}const iE=r=>BP(r),Xx=r=>BP(r),qT=(...r)=>BP(r),Ale=new Map([[1,"float"],[2,"vec2"],[3,"vec3"],[4,"vec4"],[9,"mat3"],[16,"mat4"]]),D4=new WeakMap;function jH(r){return Ale.get(r)}function SR(r){if(/[iu]?vec\d/.test(r))return r.startsWith("ivec")?Int32Array:r.startsWith("uvec")?Uint32Array:Float32Array;if(/mat\d/.test(r)||/float/.test(r))return Float32Array;if(/uint/.test(r))return Uint32Array;if(/int/.test(r))return Int32Array;throw new Error(`THREE.NodeUtils: Unsupported type: ${r}`)}function YH(r){if(/float|int|uint/.test(r))return 1;if(/vec2/.test(r))return 2;if(/vec3/.test(r))return 3;if(/vec4/.test(r)||/mat2/.test(r))return 4;if(/mat3/.test(r))return 9;if(/mat4/.test(r))return 16;Ze("TSL: Unsupported type:",r)}function wle(r){if(/float|int|uint/.test(r))return 1;if(/vec2/.test(r))return 2;if(/vec3/.test(r))return 3;if(/vec4/.test(r)||/mat2/.test(r))return 4;if(/mat3/.test(r))return 12;if(/mat4/.test(r))return 16;Ze("TSL: Unsupported type:",r)}function Rle(r){if(/float|int|uint/.test(r))return 4;if(/vec2/.test(r))return 8;if(/vec3/.test(r)||/vec4/.test(r))return 16;if(/mat2/.test(r))return 8;if(/mat3/.test(r)||/mat4/.test(r))return 16;Ze("TSL: Unsupported type:",r)}function cm(r){if(r==null)return null;const e=typeof r;return r.isNode===!0?"node":e==="number"?"float":e==="boolean"?"bool":e==="string"?"string":e==="function"?"shader":r.isVector2===!0?"vec2":r.isVector3===!0?"vec3":r.isVector4===!0?"vec4":r.isMatrix2===!0?"mat2":r.isMatrix3===!0?"mat3":r.isMatrix4===!0?"mat4":r.isColor===!0?"color":r instanceof ArrayBuffer?"ArrayBuffer":null}function IP(r,...e){const t=r?r.slice(-4):void 0;return e.length===1&&(t==="vec2"?e=[e[0],e[0]]:t==="vec3"?e=[e[0],e[0],e[0]]:t==="vec4"&&(e=[e[0],e[0],e[0],e[0]])),r==="color"?new Kt(...e):t==="vec2"?new tt(...e):t==="vec3"?new ne(...e):t==="vec4"?new zn(...e):t==="mat2"?new K1(...e):t==="mat3"?new Zn(...e):t==="mat4"?new gn(...e):r==="bool"?e[0]||!1:r==="float"||r==="int"||r==="uint"?e[0]||0:r==="string"?e[0]||"":r==="ArrayBuffer"?QH(e[0]):null}function ZH(r){let e=D4.get(r);return e===void 0&&(e={},D4.set(r,e)),e}function KH(r){let e="";const t=new Uint8Array(r);for(let n=0;n<t.length;n++)e+=String.fromCharCode(t[n]);return btoa(e)}function QH(r){return Uint8Array.from(atob(r),e=>e.charCodeAt(0)).buffer}const bT={VERTEX:"vertex",FRAGMENT:"fragment"},$n={NONE:"none",FRAME:"frame",RENDER:"render",OBJECT:"object"},Cle={BOOLEAN:"bool",INTEGER:"int",FLOAT:"float",VECTOR2:"vec2",VECTOR3:"vec3",VECTOR4:"vec4",MATRIX2:"mat2",MATRIX3:"mat3",MATRIX4:"mat4"},Fa={READ_ONLY:"readOnly",WRITE_ONLY:"writeOnly",READ_WRITE:"readWrite"},JH=["fragment","vertex"],QO=["setup","analyze","generate"],JO=[...JH,"compute"],Oy=["x","y","z","w"],Nle={analyze:"setup",generate:"analyze"};let Dle=0,on=class extends Gl{static get type(){return"Node"}constructor(e=null){super(),this.nodeType=e,this.updateType=$n.NONE,this.updateBeforeType=$n.NONE,this.updateAfterType=$n.NONE,this.uuid=oL.generateUUID(),this.version=0,this.name="",this.global=!1,this.parents=!1,this.isNode=!0,this._beforeNodes=null,this._cacheKey=null,this._cacheKeyVersion=0,Object.defineProperty(this,"id",{value:Dle++})}set needsUpdate(e){e===!0&&this.version++}get type(){return this.constructor.type}onUpdate(e,t){return this.updateType=t,this.update=e.bind(this),this}onFrameUpdate(e){return this.onUpdate(e,$n.FRAME)}onRenderUpdate(e){return this.onUpdate(e,$n.RENDER)}onObjectUpdate(e){return this.onUpdate(e,$n.OBJECT)}onReference(e){return this.updateReference=e.bind(this),this}updateReference(){return this}isGlobal(){return this.global}*getChildren(){for(const{childNode:e}of this._getChildren())yield e}dispose(){this.dispatchEvent({type:"dispose"})}traverse(e){e(this);for(const t of this.getChildren())t.traverse(e)}_getChildren(e=new Set){const t=[];e.add(this);for(const n of Object.getOwnPropertyNames(this)){const i=this[n];if(!(n.startsWith("_")===!0||e.has(i))){if(Array.isArray(i)===!0)for(let s=0;s<i.length;s++){const a=i[s];a&&a.isNode===!0&&t.push({property:n,index:s,childNode:a})}else if(i&&i.isNode===!0)t.push({property:n,childNode:i});else if(i&&Object.getPrototypeOf(i)===Object.prototype)for(const s in i){if(s.startsWith("_")===!0)continue;const a=i[s];a&&a.isNode===!0&&t.push({property:n,index:s,childNode:a})}}}return t}getCacheKey(e=!1,t=null){if(e=e||this.version!==this._cacheKeyVersion,e===!0||this._cacheKey===null){t===null&&(t=new Set);const n=[];for(const{property:i,childNode:s}of this._getChildren(t))n.push(iE(i.slice(0,-4)),s.getCacheKey(e,t));this._cacheKey=qT(Xx(n),this.customCacheKey()),this._cacheKeyVersion=this.version}return this._cacheKey}customCacheKey(){return this.id}getScope(){return this}getHash(){return this.uuid}getUpdateType(){return this.updateType}getUpdateBeforeType(){return this.updateBeforeType}getUpdateAfterType(){return this.updateAfterType}getElementType(e){const t=this.getNodeType(e);return e.getElementType(t)}getMemberType(){return"void"}getNodeType(e){const t=e.getNodeProperties(this);return t.outputNode?t.outputNode.getNodeType(e):this.nodeType}getShared(e){const t=this.getHash(e);return e.getNodeFromHash(t)||this}getArrayCount(){return null}setup(e){const t=e.getNodeProperties(this);let n=0;for(const i of this.getChildren())t["node"+n++]=i;return t.outputNode||null}analyze(e,t=null){const n=e.increaseUsage(this);if(this.parents===!0){const i=e.getDataFromNode(this,"any");i.stages=i.stages||{},i.stages[e.shaderStage]=i.stages[e.shaderStage]||[],i.stages[e.shaderStage].push(t)}if(n===1){const i=e.getNodeProperties(this);for(const s of Object.values(i))s&&s.isNode===!0&&s.build(e,this)}}generate(e,t){const{outputNode:n}=e.getNodeProperties(this);if(n&&n.isNode===!0)return n.build(e,t)}updateBefore(){Ve("Abstract function.")}updateAfter(){Ve("Abstract function.")}update(){Ve("Abstract function.")}before(e){return this._beforeNodes===null&&(this._beforeNodes=[]),this._beforeNodes.push(e),this}build(e,t=null){const n=this.getShared(e);if(this!==n)return n.build(e,t);if(this._beforeNodes!==null){const l=this._beforeNodes;this._beforeNodes=null;for(const c of l)c.build(e,t);this._beforeNodes=l}const i=e.getDataFromNode(this);i.buildStages=i.buildStages||{},i.buildStages[e.buildStage]=!0;const s=Nle[e.buildStage];if(s&&i.buildStages[s]!==!0){const l=e.getBuildStage();e.setBuildStage(s),this.build(e),e.setBuildStage(l)}e.addNode(this),e.addChain(this);let a=null;const o=e.getBuildStage();if(o==="setup"){this.updateReference(e);const l=e.getNodeProperties(this);if(l.initialized!==!0){l.initialized=!0,l.outputNode=this.setup(e)||l.outputNode||null;for(const c of Object.values(l))if(c&&c.isNode===!0){if(c.parents===!0){const d=e.getNodeProperties(c);d.parents=d.parents||[],d.parents.push(this)}c.build(e)}}a=l.outputNode}else if(o==="analyze")this.analyze(e,t);else if(o==="generate"){if(this.generate.length<2){const c=this.getNodeType(e),d=e.getDataFromNode(this);a=d.snippet,a===void 0?d.generated===void 0?(d.generated=!0,a=this.generate(e)||"",d.snippet=a):(Ve("Node: Recursion detected.",this),a="/* Recursion detected. */"):d.flowCodes!==void 0&&e.context.nodeBlock!==void 0&&e.addFlowCodeHierarchy(this,e.context.nodeBlock),a=e.format(a,c,t)}else a=this.generate(e,t)||"";a===""&&t!==null&&t!=="void"&&t!=="OutputType"&&(Ze(`TSL: Invalid generated code, expected a "${t}".`),a=e.generateConst(t))}return e.removeChain(this),e.addSequentialNode(this),a}getSerializeChildren(){return this._getChildren()}serialize(e){const t=this.getSerializeChildren(),n={};for(const{property:i,index:s,childNode:a}of t)s!==void 0?(n[i]===void 0&&(n[i]=Number.isInteger(s)?[]:{}),n[i][s]=a.toJSON(e.meta).uuid):n[i]=a.toJSON(e.meta).uuid;Object.keys(n).length>0&&(e.inputNodes=n)}deserialize(e){if(e.inputNodes!==void 0){const t=e.meta.nodes;for(const n in e.inputNodes)if(Array.isArray(e.inputNodes[n])){const i=[];for(const s of e.inputNodes[n])i.push(t[s]);this[n]=i}else if(typeof e.inputNodes[n]=="object"){const i={};for(const s in e.inputNodes[n]){const a=e.inputNodes[n][s];i[s]=t[a]}this[n]=i}else{const i=e.inputNodes[n];this[n]=t[i]}}}toJSON(e){const{uuid:t,type:n}=this,i=e===void 0||typeof e=="string";i&&(e={textures:{},images:{},nodes:{}});let s=e.nodes[t];s===void 0&&(s={uuid:t,type:n,meta:e,metadata:{version:4.7,type:"Node",generator:"Node.toJSON"}},i!==!0&&(e.nodes[s.uuid]=s),this.serialize(s),delete s.meta);function a(o){const l=[];for(const c in o){const d=o[c];delete d.metadata,l.push(d)}return l}if(i){const o=a(e.textures),l=a(e.images),c=a(e.nodes);o.length>0&&(s.textures=o),l.length>0&&(s.images=l),c.length>0&&(s.nodes=c)}return s}};class Uy extends on{static get type(){return"ArrayElementNode"}constructor(e,t){super(),this.node=e,this.indexNode=t,this.isArrayElementNode=!0}getNodeType(e){return this.node.getElementType(e)}getMemberType(e,t){return this.node.getMemberType(e,t)}generate(e){const t=this.indexNode.getNodeType(e),n=this.node.build(e),i=this.indexNode.build(e,!e.isVector(t)&&e.isInteger(t)?t:"uint");return`${n}[ ${i} ]`}}class e9 extends on{static get type(){return"ConvertNode"}constructor(e,t){super(),this.node=e,this.convertTo=t}getNodeType(e){const t=this.node.getNodeType(e);let n=null;for(const i of this.convertTo.split("|"))(n===null||e.getTypeLength(t)===e.getTypeLength(i))&&(n=i);return n}serialize(e){super.serialize(e),e.convertTo=this.convertTo}deserialize(e){super.deserialize(e),this.convertTo=e.convertTo}generate(e,t){const n=this.node,i=this.getNodeType(e),s=n.build(e,i);return e.format(s,i,t)}}class Qr extends on{static get type(){return"TempNode"}constructor(e=null){super(e),this.isTempNode=!0}hasDependencies(e){return e.getDataFromNode(this).usageCount>1}build(e,t){if(e.getBuildStage()==="generate"){const i=e.getVectorType(this.getNodeType(e,t)),s=e.getDataFromNode(this);if(s.propertyName!==void 0)return e.format(s.propertyName,i,t);if(i!=="void"&&t!=="void"&&this.hasDependencies(e)){const a=super.build(e,i),o=e.getVarFromNode(this,null,i),l=e.getPropertyName(o);return e.addLineFlowCode(`${l} = ${a}`,this),s.snippet=a,s.propertyName=l,e.format(s.propertyName,i,t)}}return super.build(e,t)}}class Ole extends Qr{static get type(){return"JoinNode"}constructor(e=[],t=null){super(t),this.nodes=e}getNodeType(e){return this.nodeType!==null?e.getVectorType(this.nodeType):e.getTypeFromLength(this.nodes.reduce((t,n)=>t+e.getTypeLength(n.getNodeType(e)),0))}generate(e,t){const n=this.getNodeType(e),i=e.getTypeLength(n),s=this.nodes,a=e.getComponentType(n),o=[];let l=0;for(const d of s){if(l>=i){Ze(`TSL: Length of parameters exceeds maximum length of function '${n}()' type.`);break}let p=d.getNodeType(e),y=e.getTypeLength(p),_;if(l+y>i&&(Ze(`TSL: Length of '${n}()' data exceeds maximum length of output type.`),y=i-l,p=e.getTypeFromLength(y)),l+=y,_=d.build(e,p),e.getComponentType(p)!==a){const b=e.getTypeFromLength(y,a);_=e.format(_,p,b)}o.push(_)}const c=`${e.getType(n)}( ${o.join(", ")} )`;return e.format(c,n,t)}}const Ule=Oy.join("");class t9 extends on{static get type(){return"SplitNode"}constructor(e,t="x"){super(),this.node=e,this.components=t,this.isSplitNode=!0}getVectorLength(){let e=this.components.length;for(const t of this.components)e=Math.max(Oy.indexOf(t)+1,e);return e}getComponentType(e){return e.getComponentType(this.node.getNodeType(e))}getNodeType(e){return e.getTypeFromLength(this.components.length,this.getComponentType(e))}getScope(){return this.node.getScope()}generate(e,t){const n=this.node,i=e.getTypeLength(n.getNodeType(e));let s=null;if(i>1){let a=null;this.getVectorLength()>=i&&(a=e.getTypeFromLength(this.getVectorLength(),this.getComponentType(e)));const l=n.build(e,a);this.components.length===i&&this.components===Ule.slice(0,this.components.length)?s=e.format(l,a,t):s=e.format(`${l}.${this.components}`,this.getNodeType(e),t)}else s=n.build(e,t);return s}serialize(e){super.serialize(e),e.components=this.components}deserialize(e){super.deserialize(e),this.components=e.components}}class Lle extends Qr{static get type(){return"SetNode"}constructor(e,t,n){super(),this.sourceNode=e,this.components=t,this.targetNode=n}getNodeType(e){return this.sourceNode.getNodeType(e)}generate(e){const{sourceNode:t,components:n,targetNode:i}=this,s=this.getNodeType(e),a=e.getComponentType(i.getNodeType(e)),o=e.getTypeFromLength(n.length,a),l=i.build(e,o),c=t.build(e,s),d=e.getTypeLength(s),p=[];for(let y=0;y<d;y++){const _=Oy[y];_===n[0]?(p.push(l),y+=n.length-1):p.push(c+"."+_)}return`${e.getType(s)}( ${p.join(", ")} )`}}class Ple extends Qr{static get type(){return"FlipNode"}constructor(e,t){super(),this.sourceNode=e,this.components=t}getNodeType(e){return this.sourceNode.getNodeType(e)}generate(e){const{components:t,sourceNode:n}=this,i=this.getNodeType(e),s=n.build(e),a=e.getVarFromNode(this),o=e.getPropertyName(a);e.addLineFlowCode(o+" = "+s,this);const l=e.getTypeLength(i),c=[];let d=0;for(let p=0;p<l;p++){const y=Oy[p];y===t[d]?(c.push("1.0 - "+(o+"."+y)),d++):c.push(o+"."+y)}return`${e.getType(i)}( ${c.join(", ")} )`}}class FP extends on{static get type(){return"InputNode"}constructor(e,t=null){super(t),this.isInputNode=!0,this.value=e,this.precision=null}getNodeType(){return this.nodeType===null?cm(this.value):this.nodeType}getInputType(e){return this.getNodeType(e)}setPrecision(e){return this.precision=e,this}serialize(e){super.serialize(e),e.value=this.value,this.value&&this.value.toArray&&(e.value=this.value.toArray()),e.valueType=cm(this.value),e.nodeType=this.nodeType,e.valueType==="ArrayBuffer"&&(e.value=KH(e.value)),e.precision=this.precision}deserialize(e){super.deserialize(e),this.nodeType=e.nodeType,this.value=Array.isArray(e.value)?IP(e.valueType,...e.value):e.value,this.precision=e.precision||null,this.value&&this.value.fromArray&&(this.value=this.value.fromArray(e.value))}generate(){Ve("Abstract function.")}}const O4=/float|u?int/;class dc extends FP{static get type(){return"ConstNode"}constructor(e,t=null){super(e,t),this.isConstNode=!0}generateConst(e){return e.generateConst(this.getNodeType(e),this.value)}generate(e,t){const n=this.getNodeType(e);return O4.test(n)&&O4.test(t)?e.generateConst(t,this.value):e.format(this.generateConst(e),n,t)}}class Ble extends on{static get type(){return"MemberNode"}constructor(e,t){super(),this.structNode=e,this.property=t,this.isMemberNode=!0}hasMember(e){return this.structNode.isMemberNode&&this.structNode.hasMember(e)===!1?!1:this.structNode.getMemberType(e,this.property)!=="void"}getNodeType(e){return this.hasMember(e)===!1?"float":this.structNode.getMemberType(e,this.property)}getMemberType(e,t){if(this.hasMember(e)===!1)return"float";const n=this.getNodeType(e);return e.getStructTypeNode(n).getMemberType(e,t)}generate(e){if(this.hasMember(e)===!1){Ve(`TSL: Member "${this.property}" does not exist in struct.`);const n=this.getNodeType(e);return e.generateConst(n)}return this.structNode.build(e)+"."+this.property}}let Rm=null;const eU=new Map;function Ke(r,e){if(eU.has(r)){Ve(`TSL: Redefinition of method chaining '${r}'.`);return}if(typeof e!="function")throw new Error(`THREE.TSL: Node element ${r} is not a function`);eU.set(r,e),r!=="assign"&&(on.prototype[r]=function(...t){return this.isStackNode?this.addToStack(e(...t)):e(this,...t)},on.prototype[r+"Assign"]=function(...t){return this.isStackNode?this.assign(t[0],e(...t)):this.assign(e(this,...t))})}const Ile=r=>r.replace(/r|s/g,"x").replace(/g|t/g,"y").replace(/b|p/g,"z").replace(/a|q/g,"w"),U4=r=>Ile(r).split("").sort().join("");on.prototype.assign=function(...r){if(this.isStackNode!==!0)return Rm!==null?Rm.assign(this,...r):Ze("TSL: No stack defined for assign operation. Make sure the assign is inside a Fn()."),this;{const e=eU.get("assign");return this.addToStack(e(...r))}};on.prototype.toVarIntent=function(){return this};on.prototype.get=function(r){return new Ble(this,r)};const XT={};function $A(r,e,t){XT[r]=XT[e]=XT[t]={get(){this._cache=this._cache||{};let a=this._cache[r];return a===void 0&&(a=new t9(this,r),this._cache[r]=a),a},set(a){this[r].assign(Xt(a))}};const n=r.toUpperCase(),i=e.toUpperCase(),s=t.toUpperCase();on.prototype["set"+n]=on.prototype["set"+i]=on.prototype["set"+s]=function(a){const o=U4(r);return new Lle(this,o,Xt(a))},on.prototype["flip"+n]=on.prototype["flip"+i]=on.prototype["flip"+s]=function(){const a=U4(r);return new Ple(this,a)}}const Hf=["x","y","z","w"],Wf=["r","g","b","a"],qf=["s","t","p","q"];for(let r=0;r<4;r++){let e=Hf[r],t=Wf[r],n=qf[r];$A(e,t,n);for(let i=0;i<4;i++){e=Hf[r]+Hf[i],t=Wf[r]+Wf[i],n=qf[r]+qf[i],$A(e,t,n);for(let s=0;s<4;s++){e=Hf[r]+Hf[i]+Hf[s],t=Wf[r]+Wf[i]+Wf[s],n=qf[r]+qf[i]+qf[s],$A(e,t,n);for(let a=0;a<4;a++)e=Hf[r]+Hf[i]+Hf[s]+Hf[a],t=Wf[r]+Wf[i]+Wf[s]+Wf[a],n=qf[r]+qf[i]+qf[s]+qf[a],$A(e,t,n)}}}for(let r=0;r<32;r++)XT[r]={get(){this._cache=this._cache||{};let e=this._cache[r];return e===void 0&&(e=new Uy(this,new dc(r,"uint")),this._cache[r]=e),e},set(e){this[r].assign(Xt(e))}};Object.defineProperties(on.prototype,XT);const L4=new WeakMap,Fle=function(r,e=null){const t=cm(r);return t==="node"?r:e===null&&(t==="float"||t==="boolean")||t&&t!=="shader"&&t!=="string"?Xt(tU(r,e)):t==="shader"?r.isFn?r:Te(r):r},zle=function(r,e=null){for(const t in r)r[t]=Xt(r[t],e);return r},Vle=function(r,e=null){const t=r.length;for(let n=0;n<t;n++)r[n]=Xt(r[n],e);return r},n9=function(r,e=null,t=null,n=null){function i(d){return n!==null?(d=Xt(Object.assign(d,n)),n.intent===!0&&(d=d.toVarIntent())):d=Xt(d),d}let s,a=e,o,l;function c(d){let p;return a?p=/[a-z]/i.test(a)?a+"()":a:p=r.type,o!==void 0&&d.length<o?(Ze(`TSL: "${p}" parameter length is less than minimum required.`),d.concat(new Array(o-d.length).fill(0))):l!==void 0&&d.length>l?(Ze(`TSL: "${p}" parameter length exceeds limit.`),d.slice(0,l)):d}return e===null?s=(...d)=>i(new r(...B0(c(d)))):t!==null?(t=Xt(t),s=(...d)=>i(new r(e,...B0(c(d)),t))):s=(...d)=>i(new r(e,...B0(c(d)))),s.setParameterLength=(...d)=>(d.length===1?o=l=d[0]:d.length===2&&([o,l]=d),s),s.setName=d=>(a=d,s),s},Gle=function(r,...e){return new r(...B0(e))};class kle extends on{constructor(e,t){super(),this.shaderNode=e,this.rawInputs=t,this.isShaderCallNodeInternal=!0}getNodeType(e){return this.shaderNode.nodeType||this.getOutputNode(e).getNodeType(e)}getElementType(e){return this.getOutputNode(e).getElementType(e)}getMemberType(e,t){return this.getOutputNode(e).getMemberType(e,t)}call(e){const{shaderNode:t,rawInputs:n}=this,i=e.getNodeProperties(t),s=e.getClosestSubBuild(t.subBuilds)||"",a=s||"default";if(i[a])return i[a];const o=e.subBuildFn,l=e.fnCall;e.subBuildFn=s,e.fnCall=this;let c=null;if(t.layout){let d=L4.get(e.constructor);d===void 0&&(d=new WeakMap,L4.set(e.constructor,d));let p=d.get(t);p===void 0&&(p=Xt(e.buildFunctionNode(t)),d.set(t,p)),e.addInclude(p);const y=n?Hle(n):null;c=Xt(p.call(y))}else{const d=new Proxy(e,{get:(b,E,T)=>{let M;return Symbol.iterator===E?M=function*(){yield void 0}:M=Reflect.get(b,E,T),M}}),p=n?Wle(n):null,y=Array.isArray(n)?n.length>0:n!==null,_=t.jsFunc,v=y||_.length>1?_(p,d):_(d);c=Xt(v)}return e.subBuildFn=o,e.fnCall=l,t.once&&(i[a]=c),c}setupOutput(e){return e.addStack(),e.stack.outputNode=this.call(e),e.removeStack()}getOutputNode(e){const t=e.getNodeProperties(this),n=e.getSubBuildOutput(this);return t[n]=t[n]||this.setupOutput(e),t[n].subBuild=e.getClosestSubBuild(this),t[n]}build(e,t=null){let n=null;const i=e.getBuildStage(),s=e.getNodeProperties(this),a=e.getSubBuildOutput(this),o=this.getOutputNode(e),l=e.fnCall;if(e.fnCall=this,i==="setup"){const c=e.getSubBuildProperty("initialized",this);if(s[c]!==!0&&(s[c]=!0,s[a]=this.getOutputNode(e),s[a].build(e),this.shaderNode.subBuilds))for(const d of e.chaining){const p=e.getDataFromNode(d,"any");p.subBuilds=p.subBuilds||new Set;for(const y of this.shaderNode.subBuilds)p.subBuilds.add(y)}n=s[a]}else i==="analyze"?o.build(e,t):i==="generate"&&(n=o.build(e,t)||"");return e.fnCall=l,n}}function Hle(r){let e;return rN(r),r[0]&&(r[0].isNode||Object.getPrototypeOf(r[0])!==Object.prototype)?e=[...r]:e=r[0],e}function Wle(r){let e=0;return rN(r),new Proxy(r,{get:(t,n,i)=>{let s;if(n==="length")return s=r.length,s;if(Symbol.iterator===n)s=function*(){for(const a of r)yield Xt(a)};else{if(r.length>0)if(Object.getPrototypeOf(r[0])===Object.prototype){const a=r[0];a[n]===void 0?s=a[e++]:s=Reflect.get(a,n,i)}else r[0]instanceof on&&(r[n]===void 0?s=r[e++]:s=Reflect.get(r,n,i));else s=Reflect.get(t,n,i);s=Xt(s)}return s}})}class qle extends on{constructor(e,t){super(t),this.jsFunc=e,this.layout=null,this.global=!0,this.once=!1}setLayout(e){return this.layout=e,this}getLayout(){return this.layout}call(e=null){return new kle(this,e)}setup(){return this.call()}}const Xle=[!1,!0],$le=[0,1,2,3],jle=[-1,-2],i9=[.5,1.5,1/3,1e-6,1e6,Math.PI,Math.PI*2,1/Math.PI,2/Math.PI,1/(Math.PI*2),Math.PI/2],zP=new Map;for(const r of Xle)zP.set(r,new dc(r));const VP=new Map;for(const r of $le)VP.set(r,new dc(r,"uint"));const GP=new Map([...VP].map(r=>new dc(r.value,"int")));for(const r of jle)GP.set(r,new dc(r,"int"));const nN=new Map([...GP].map(r=>new dc(r.value)));for(const r of i9)nN.set(r,new dc(r));for(const r of i9)nN.set(-r,new dc(-r));const iN={bool:zP,uint:VP,ints:GP,float:nN},P4=new Map([...zP,...nN]),tU=(r,e)=>P4.has(r)?P4.get(r):r.isNode===!0?r:new dc(r,e),Ws=function(r,e=null){return(...t)=>{for(const i of t)if(i===void 0)return Ze(`TSL: Invalid parameter for the type "${r}".`),new dc(0,r);if((t.length===0||!["bool","float","int","uint"].includes(r)&&t.every(i=>{const s=typeof i;return s!=="object"&&s!=="function"}))&&(t=[IP(r,...t)]),t.length===1&&e!==null&&e.has(t[0]))return ST(e.get(t[0]));if(t.length===1){const i=tU(t[0],r);return i.nodeType===r?ST(i):ST(new e9(i,r))}const n=t.map(i=>tU(i));return ST(new Ole(n,r))}},S1=r=>typeof r=="object"&&r!==null?r.value:r,r9=r=>r!=null?r.nodeType||r.convertTo||(typeof r=="string"?r:null):null;function Fv(r,e){return new qle(r,e)}const Xt=(r,e=null)=>Fle(r,e),ST=(r,e=null)=>Xt(r,e).toVarIntent(),rN=(r,e=null)=>new zle(r,e),B0=(r,e=null)=>new Vle(r,e),Gn=(r,e=null,t=null,n=null)=>new n9(r,e,t,n),kt=(r,...e)=>new Gle(r,...e),Mt=(r,e=null,t=null,n={})=>new n9(r,e,t,{...n,intent:!0});let Yle=0;class Zle extends on{constructor(e,t=null){super();let n=null;t!==null&&(typeof t=="object"?n=t.return:(typeof t=="string"?n=t:Ze("TSL: Invalid layout type."),t=null)),this.shaderNode=new Fv(e,n),t!==null&&this.setLayout(t),this.isFn=!0}setLayout(e){const t=this.shaderNode.nodeType;if(typeof e.inputs!="object"){const n={name:"fn"+Yle++,type:t,inputs:[]};for(const i in e)i!=="return"&&n.inputs.push({name:i,type:e[i]});e=n}return this.shaderNode.setLayout(e),this}getNodeType(e){return this.shaderNode.getNodeType(e)||"float"}call(...e){const t=this.shaderNode.call(e);return this.shaderNode.nodeType==="void"&&t.toStack(),t.toVarIntent()}once(e=null){return this.shaderNode.once=!0,this.shaderNode.subBuilds=e,this}generate(e){const t=this.getNodeType(e);return Ze('TSL: "Fn()" was declared but not invoked. Try calling it like "Fn()( ...params )".'),e.generateConst(t)}}function Te(r,e=null){const t=new Zle(r,e);return new Proxy(()=>{},{apply(n,i,s){return t.call(...s)},get(n,i,s){return Reflect.get(t,i,s)},set(n,i,s,a){return Reflect.set(t,i,s,a)}})}const T1=r=>{Rm=r},kP=()=>Rm,Tn=(...r)=>Rm.If(...r),Kle=(...r)=>Rm.Switch(...r);function sN(r){return Rm&&Rm.addToStack(r),r}Ke("toStack",sN);const s9=new Ws("color"),re=new Ws("float",iN.float),de=new Ws("int",iN.ints),vt=new Ws("uint",iN.uint),lc=new Ws("bool",iN.bool),St=new Ws("vec2"),Vs=new Ws("ivec2"),HP=new Ws("uvec2"),a9=new Ws("bvec2"),ge=new Ws("vec3"),WP=new Ws("ivec3"),Ly=new Ws("uvec3"),qP=new Ws("bvec3"),En=new Ws("vec4"),XP=new Ws("ivec4"),$P=new Ws("uvec4"),o9=new Ws("bvec4"),aN=new Ws("mat2"),Ha=new Ws("mat3"),gm=new Ws("mat4"),Qle=(r="")=>new dc(r,"string"),Jle=r=>new dc(r,"ArrayBuffer");Ke("toColor",s9);Ke("toFloat",re);Ke("toInt",de);Ke("toUint",vt);Ke("toBool",lc);Ke("toVec2",St);Ke("toIVec2",Vs);Ke("toUVec2",HP);Ke("toBVec2",a9);Ke("toVec3",ge);Ke("toIVec3",WP);Ke("toUVec3",Ly);Ke("toBVec3",qP);Ke("toVec4",En);Ke("toIVec4",XP);Ke("toUVec4",$P);Ke("toBVec4",o9);Ke("toMat2",aN);Ke("toMat3",Ha);Ke("toMat4",gm);const l9=Gn(Uy).setParameterLength(2),u9=(r,e)=>Xt(new e9(Xt(r),e)),eue=(r,e)=>Xt(new t9(Xt(r),e));Ke("element",l9);Ke("convert",u9);const tue=r=>(Ve("TSL: append() has been renamed to Stack()."),sN(r));Ke("append",r=>(Ve("TSL: .append() has been renamed to .toStack()."),sN(r)));class Wi extends on{static get type(){return"PropertyNode"}constructor(e,t=null,n=!1){super(e),this.name=t,this.varying=n,this.isPropertyNode=!0,this.global=!0}customCacheKey(){return iE(this.type+":"+(this.name||"")+":"+(this.varying?"1":"0"))}getHash(e){return this.name||super.getHash(e)}generate(e){let t;return this.varying===!0?(t=e.getVaryingFromNode(this,this.name),t.needsInterpolation=!0):t=e.getVarFromNode(this,this.name),e.getPropertyName(t)}}const Ah=(r,e)=>new Wi(r,e),E1=(r,e)=>new Wi(r,e,!0),nr=kt(Wi,"vec4","DiffuseColor"),c0=kt(Wi,"vec3","DiffuseContribution"),nU=kt(Wi,"vec3","EmissiveColor"),td=kt(Wi,"float","Roughness"),yh=kt(Wi,"float","Metalness"),TR=kt(Wi,"float","Clearcoat"),M1=kt(Wi,"float","ClearcoatRoughness"),nu=kt(Wi,"vec3","Sheen"),Kp=kt(Wi,"float","SheenRoughness"),oN=kt(Wi,"float","Iridescence"),ER=kt(Wi,"float","IridescenceIOR"),MR=kt(Wi,"float","IridescenceThickness"),AR=kt(Wi,"float","AlphaT"),Zp=kt(Wi,"float","Anisotropy"),$T=kt(Wi,"vec3","AnisotropyT"),I0=kt(Wi,"vec3","AnisotropyB"),Cm=kt(Wi,"color","SpecularColor"),x0=kt(Wi,"color","SpecularColorBlended"),Yv=kt(Wi,"float","SpecularF90"),wR=kt(Wi,"float","Shininess"),Zv=kt(Wi,"vec4","Output"),Fw=kt(Wi,"float","dashSize"),iU=kt(Wi,"float","gapSize"),nue=kt(Wi,"float","pointWidth"),jT=kt(Wi,"float","IOR"),RR=kt(Wi,"float","Transmission"),jP=kt(Wi,"float","Thickness"),YP=kt(Wi,"float","AttenuationDistance"),ZP=kt(Wi,"color","AttenuationColor"),KP=kt(Wi,"float","Dispersion");class c9 extends on{static get type(){return"UniformGroupNode"}constructor(e,t=!1,n=1){super("string"),this.name=e,this.shared=t,this.order=n,this.isUniformGroup=!0}serialize(e){super.serialize(e),e.name=this.name,e.version=this.version,e.shared=this.shared}deserialize(e){super.deserialize(e),this.name=e.name,this.version=e.version,this.shared=e.shared}}const f9=r=>new c9(r),lN=(r,e=0)=>new c9(r,!0,e),d9=lN("frame"),yn=lN("render"),QP=f9("object");class rE extends FP{static get type(){return"UniformNode"}constructor(e,t=null){super(e,t),this.isUniformNode=!0,this.name="",this.groupNode=QP}setName(e){return this.name=e,this}label(e){return Ve('TSL: "label()" has been deprecated. Use "setName()" instead.'),this.setName(e)}setGroup(e){return this.groupNode=e,this}getGroup(){return this.groupNode}getUniformHash(e){return this.getHash(e)}onUpdate(e,t){return e=e.bind(this),super.onUpdate(n=>{const i=e(n,this);i!==void 0&&(this.value=i)},t)}getInputType(e){let t=super.getInputType(e);return t==="bool"&&(t="uint"),t}generate(e,t){const n=this.getNodeType(e),i=this.getUniformHash(e);let s=e.getNodeFromHash(i);s===void 0&&(e.setHashNode(this,i),s=this);const a=s.getInputType(e),o=e.getUniformFromNode(s,a,e.shaderStage,this.name||e.context.nodeName),l=e.getPropertyName(o);e.context.nodeName!==void 0&&delete e.context.nodeName;let c=l;if(n==="bool"){const d=e.getDataFromNode(this);let p=d.propertyName;if(p===void 0){const y=e.getVarFromNode(this,null,"bool");p=e.getPropertyName(y),d.propertyName=p,c=e.format(l,a,n),e.addLineFlowCode(`${p} = ${c}`,this)}c=p}return e.format(c,n,t)}}const _n=(r,e)=>{const t=r9(e||r);if(t===r&&(r=IP(t)),r&&r.isNode===!0){let n=r.value;r.traverse(i=>{i.isConstNode===!0&&(n=i.value)}),r=n}return new rE(r,t)};class B4 extends Qr{static get type(){return"ArrayNode"}constructor(e,t,n=null){super(e),this.count=t,this.values=n,this.isArrayNode=!0}getArrayCount(){return this.count}getNodeType(e){return this.nodeType===null?this.values[0].getNodeType(e):this.nodeType}getElementType(e){return this.getNodeType(e)}getMemberType(e,t){return this.nodeType===null?this.values[0].getMemberType(e,t):super.getMemberType(e,t)}generate(e){const t=this.getNodeType(e);return e.generateArray(t,this.count,this.values)}}const h9=(...r)=>{let e;if(r.length===1){const t=r[0];e=new B4(null,t.length,t)}else{const t=r[0],n=r[1];e=new B4(t,n)}return Xt(e)};Ke("toArray",(r,e)=>h9(Array(e).fill(r)));class iue extends Qr{static get type(){return"AssignNode"}constructor(e,t){super(),this.targetNode=e,this.sourceNode=t,this.isAssignNode=!0}hasDependencies(){return!1}getNodeType(e,t){return t!=="void"?this.targetNode.getNodeType(e):"void"}needsSplitAssign(e){const{targetNode:t}=this;if(e.isAvailable("swizzleAssign")===!1&&t.isSplitNode&&t.components.length>1){const n=e.getTypeLength(t.node.getNodeType(e));return Oy.join("").slice(0,n)!==t.components}return!1}setup(e){const{targetNode:t,sourceNode:n}=this,i=t.getScope(),s=e.getDataFromNode(i);s.assign=!0;const a=e.getNodeProperties(this);a.sourceNode=n,a.targetNode=t.context({assign:!0})}generate(e,t){const{targetNode:n,sourceNode:i}=e.getNodeProperties(this),s=this.needsSplitAssign(e),a=n.build(e),o=n.getNodeType(e),l=i.build(e,o),c=i.getNodeType(e),d=e.getDataFromNode(this);let p;if(d.initialized===!0)t!=="void"&&(p=a);else if(s){const y=e.getVarFromNode(this,null,o),_=e.getPropertyName(y);e.addLineFlowCode(`${_} = ${l}`,this);const v=n.node,E=v.node.context({assign:!0}).build(e);for(let T=0;T<v.components.length;T++){const M=v.components[T];e.addLineFlowCode(`${E}.${M} = ${_}[ ${T} ]`,this)}t!=="void"&&(p=a)}else p=`${a} = ${l}`,(t==="void"||c==="void")&&(e.addLineFlowCode(p,this),t!=="void"&&(p=a));return d.initialized=!0,e.format(p,o,t)}}const p9=Gn(iue).setParameterLength(2);Ke("assign",p9);class rue extends Qr{static get type(){return"FunctionCallNode"}constructor(e=null,t={}){super(),this.functionNode=e,this.parameters=t}setParameters(e){return this.parameters=e,this}getParameters(){return this.parameters}getNodeType(e){return this.functionNode.getNodeType(e)}getMemberType(e,t){return this.functionNode.getMemberType(e,t)}generate(e){const t=[],n=this.functionNode,i=n.getInputs(e),s=this.parameters,a=(l,c)=>{const d=c.type,p=d==="pointer";let y;return p?y="&"+l.build(e):y=l.build(e,d),y};if(Array.isArray(s)){if(s.length>i.length)Ze("TSL: The number of provided parameters exceeds the expected number of inputs in 'Fn()'."),s.length=i.length;else if(s.length<i.length)for(Ze("TSL: The number of provided parameters is less than the expected number of inputs in 'Fn()'.");s.length<i.length;)s.push(re(0));for(let l=0;l<s.length;l++)t.push(a(s[l],i[l]))}else for(const l of i){const c=s[l.name];c!==void 0?t.push(a(c,l)):(Ze(`TSL: Input '${l.name}' not found in 'Fn()'.`),t.push(a(re(0),l)))}return`${n.build(e,"property")}( ${t.join(", ")} )`}}const m9=(r,...e)=>(e=e.length>1||e[0]&&e[0].isNode===!0?B0(e):rN(e[0]),new rue(Xt(r),e));Ke("call",m9);const sue={"==":"equal","!=":"notEqual","<":"lessThan",">":"greaterThan","<=":"lessThanEqual",">=":"greaterThanEqual","%":"mod"};class Zr extends Qr{static get type(){return"OperatorNode"}constructor(e,t,n,...i){if(super(),i.length>0){let s=new Zr(e,t,n);for(let a=0;a<i.length-1;a++)s=new Zr(e,s,i[a]);t=s,n=i[i.length-1]}this.op=e,this.aNode=t,this.bNode=n,this.isOperatorNode=!0}getOperatorMethod(e,t){return e.getMethod(sue[this.op],t)}getNodeType(e,t=null){const n=this.op,i=this.aNode,s=this.bNode,a=i.getNodeType(e),o=s?s.getNodeType(e):null;if(a==="void"||o==="void")return t||"void";if(n==="%")return a;if(n==="~"||n==="&"||n==="|"||n==="^"||n===">>"||n==="<<")return e.getIntegerType(a);if(n==="!"||n==="&&"||n==="||"||n==="^^")return"bool";if(n==="=="||n==="!="||n==="<"||n===">"||n==="<="||n===">="){const l=Math.max(e.getTypeLength(a),e.getTypeLength(o));return l>1?`bvec${l}`:"bool"}else{if(e.isMatrix(a)){if(o==="float")return a;if(e.isVector(o))return e.getVectorFromMatrix(a);if(e.isMatrix(o))return a}else if(e.isMatrix(o)){if(a==="float")return o;if(e.isVector(a))return e.getVectorFromMatrix(o)}return e.getTypeLength(o)>e.getTypeLength(a)?o:a}}generate(e,t){const n=this.op,{aNode:i,bNode:s}=this,a=this.getNodeType(e,t);let o=null,l=null;a!=="void"?(o=i.getNodeType(e),l=s?s.getNodeType(e):null,n==="<"||n===">"||n==="<="||n===">="||n==="=="||n==="!="?e.isVector(o)?l=o:e.isVector(l)?o=l:o!==l&&(o=l="float"):n===">>"||n==="<<"?(o=a,l=e.changeComponentType(l,"uint")):n==="%"?(o=a,l=e.isInteger(o)&&e.isInteger(l)?l:o):e.isMatrix(o)?l==="float"?l="float":e.isVector(l)?l=e.getVectorFromMatrix(o):e.isMatrix(l)||(o=l=a):e.isMatrix(l)?o==="float"?o="float":e.isVector(o)?o=e.getVectorFromMatrix(l):o=l=a:o=l=a):o=l=a;const c=i.build(e,o),d=s?s.build(e,l):null,p=e.getFunctionOperator(n);if(t!=="void"){const y=e.renderer.coordinateSystem===Ba;if(n==="=="||n==="!="||n==="<"||n===">"||n==="<="||n===">=")return y?e.isVector(o)?e.format(`${this.getOperatorMethod(e,t)}( ${c}, ${d} )`,a,t):e.format(`( ${c} ${n} ${d} )`,a,t):e.format(`( ${c} ${n} ${d} )`,a,t);if(n==="%")return e.isInteger(l)?e.format(`( ${c} % ${d} )`,a,t):e.format(`${this.getOperatorMethod(e,a)}( ${c}, ${d} )`,a,t);if(n==="!"||n==="~")return e.format(`(${n}${c})`,o,t);if(p)return e.format(`${p}( ${c}, ${d} )`,a,t);if(e.isMatrix(o)&&l==="float")return e.format(`( ${d} ${n} ${c} )`,a,t);if(o==="float"&&e.isMatrix(l))return e.format(`${c} ${n} ${d}`,a,t);{let _=`( ${c} ${n} ${d} )`;return!y&&a==="bool"&&e.isVector(o)&&e.isVector(l)&&(_=`all${_}`),e.format(_,a,t)}}else if(o!=="void")return p?e.format(`${p}( ${c}, ${d} )`,a,t):e.isMatrix(o)&&l==="float"?e.format(`${d} ${n} ${c}`,a,t):e.format(`${c} ${n} ${d}`,a,t)}serialize(e){super.serialize(e),e.op=this.op}deserialize(e){super.deserialize(e),this.op=e.op}}const Ns=Mt(Zr,"+").setParameterLength(2,1/0).setName("add"),_i=Mt(Zr,"-").setParameterLength(2,1/0).setName("sub"),Vn=Mt(Zr,"*").setParameterLength(2,1/0).setName("mul"),Su=Mt(Zr,"/").setParameterLength(2,1/0).setName("div"),sE=Mt(Zr,"%").setParameterLength(2).setName("mod"),JP=Mt(Zr,"==").setParameterLength(2).setName("equal"),g9=Mt(Zr,"!=").setParameterLength(2).setName("notEqual"),y9=Mt(Zr,"<").setParameterLength(2).setName("lessThan"),eB=Mt(Zr,">").setParameterLength(2).setName("greaterThan"),_9=Mt(Zr,"<=").setParameterLength(2).setName("lessThanEqual"),v9=Mt(Zr,">=").setParameterLength(2).setName("greaterThanEqual"),x9=Mt(Zr,"&&").setParameterLength(2,1/0).setName("and"),b9=Mt(Zr,"||").setParameterLength(2,1/0).setName("or"),S9=Mt(Zr,"!").setParameterLength(1).setName("not"),T9=Mt(Zr,"^^").setParameterLength(2).setName("xor"),E9=Mt(Zr,"&").setParameterLength(2).setName("bitAnd"),M9=Mt(Zr,"~").setParameterLength(1).setName("bitNot"),A9=Mt(Zr,"|").setParameterLength(2).setName("bitOr"),w9=Mt(Zr,"^").setParameterLength(2).setName("bitXor"),R9=Mt(Zr,"<<").setParameterLength(2).setName("shiftLeft"),C9=Mt(Zr,">>").setParameterLength(2).setName("shiftRight"),N9=Te(([r])=>(r.addAssign(1),r)),D9=Te(([r])=>(r.subAssign(1),r)),O9=Te(([r])=>{const e=de(r).toConst();return r.addAssign(1),e}),U9=Te(([r])=>{const e=de(r).toConst();return r.subAssign(1),e});Ke("add",Ns);Ke("sub",_i);Ke("mul",Vn);Ke("div",Su);Ke("mod",sE);Ke("equal",JP);Ke("notEqual",g9);Ke("lessThan",y9);Ke("greaterThan",eB);Ke("lessThanEqual",_9);Ke("greaterThanEqual",v9);Ke("and",x9);Ke("or",b9);Ke("not",S9);Ke("xor",T9);Ke("bitAnd",E9);Ke("bitNot",M9);Ke("bitOr",A9);Ke("bitXor",w9);Ke("shiftLeft",R9);Ke("shiftRight",C9);Ke("incrementBefore",N9);Ke("decrementBefore",D9);Ke("increment",O9);Ke("decrement",U9);const L9=(r,e)=>(Ve('TSL: "modInt()" is deprecated. Use "mod( int( ... ) )" instead.'),sE(de(r),de(e)));Ke("modInt",L9);class Pe extends Qr{static get type(){return"MathNode"}constructor(e,t,n=null,i=null){if(super(),(e===Pe.MAX||e===Pe.MIN)&&arguments.length>3){let s=new Pe(e,t,n);for(let a=2;a<arguments.length-1;a++)s=new Pe(e,s,arguments[a]);t=s,n=arguments[arguments.length-1],i=null}this.method=e,this.aNode=t,this.bNode=n,this.cNode=i,this.isMathNode=!0}getInputType(e){const t=this.aNode.getNodeType(e),n=this.bNode?this.bNode.getNodeType(e):null,i=this.cNode?this.cNode.getNodeType(e):null,s=e.isMatrix(t)?0:e.getTypeLength(t),a=e.isMatrix(n)?0:e.getTypeLength(n),o=e.isMatrix(i)?0:e.getTypeLength(i);return s>a&&s>o?t:a>o?n:o>s?i:t}getNodeType(e){const t=this.method;return t===Pe.LENGTH||t===Pe.DISTANCE||t===Pe.DOT?"float":t===Pe.CROSS?"vec3":t===Pe.ALL||t===Pe.ANY?"bool":t===Pe.EQUALS?e.changeComponentType(this.aNode.getNodeType(e),"bool"):this.getInputType(e)}setup(e){const{aNode:t,bNode:n,method:i}=this;let s=null;if(i===Pe.ONE_MINUS)s=_i(1,t);else if(i===Pe.RECIPROCAL)s=Su(1,t);else if(i===Pe.DIFFERENCE)s=Sr(_i(t,n));else if(i===Pe.TRANSFORM_DIRECTION){let a=t,o=n;e.isMatrix(a.getNodeType(e))?o=En(ge(o),0):a=En(ge(a),0);const l=Vn(a,o).xyz;s=al(l)}return s!==null?s:super.setup(e)}generate(e,t){if(e.getNodeProperties(this).outputNode)return super.generate(e,t);let i=this.method;const s=this.getNodeType(e),a=this.getInputType(e),o=this.aNode,l=this.bNode,c=this.cNode,d=e.renderer.coordinateSystem;if(i===Pe.NEGATE)return e.format("( - "+o.build(e,a)+" )",s,t);{const p=[];return i===Pe.CROSS?p.push(o.build(e,s),l.build(e,s)):d===Ba&&i===Pe.STEP?p.push(o.build(e,e.getTypeLength(o.getNodeType(e))===1?"float":a),l.build(e,a)):d===Ba&&(i===Pe.MIN||i===Pe.MAX)?p.push(o.build(e,a),l.build(e,e.getTypeLength(l.getNodeType(e))===1?"float":a)):i===Pe.REFRACT?p.push(o.build(e,a),l.build(e,a),c.build(e,"float")):i===Pe.MIX?p.push(o.build(e,a),l.build(e,a),c.build(e,e.getTypeLength(c.getNodeType(e))===1?"float":a)):(d===Il&&i===Pe.ATAN&&l!==null&&(i="atan2"),e.shaderStage!=="fragment"&&(i===Pe.DFDX||i===Pe.DFDY)&&(Ve(`TSL: '${i}' is not supported in the ${e.shaderStage} stage.`),i="/*"+i+"*/"),p.push(o.build(e,a)),l!==null&&p.push(l.build(e,a)),c!==null&&p.push(c.build(e,a))),e.format(`${e.getMethod(i,s)}( ${p.join(", ")} )`,s,t)}}serialize(e){super.serialize(e),e.method=this.method}deserialize(e){super.deserialize(e),this.method=e.method}}Pe.ALL="all";Pe.ANY="any";Pe.RADIANS="radians";Pe.DEGREES="degrees";Pe.EXP="exp";Pe.EXP2="exp2";Pe.LOG="log";Pe.LOG2="log2";Pe.SQRT="sqrt";Pe.INVERSE_SQRT="inversesqrt";Pe.FLOOR="floor";Pe.CEIL="ceil";Pe.NORMALIZE="normalize";Pe.FRACT="fract";Pe.SIN="sin";Pe.COS="cos";Pe.TAN="tan";Pe.ASIN="asin";Pe.ACOS="acos";Pe.ATAN="atan";Pe.ABS="abs";Pe.SIGN="sign";Pe.LENGTH="length";Pe.NEGATE="negate";Pe.ONE_MINUS="oneMinus";Pe.DFDX="dFdx";Pe.DFDY="dFdy";Pe.ROUND="round";Pe.RECIPROCAL="reciprocal";Pe.TRUNC="trunc";Pe.FWIDTH="fwidth";Pe.TRANSPOSE="transpose";Pe.DETERMINANT="determinant";Pe.INVERSE="inverse";Pe.EQUALS="equals";Pe.MIN="min";Pe.MAX="max";Pe.STEP="step";Pe.REFLECT="reflect";Pe.DISTANCE="distance";Pe.DIFFERENCE="difference";Pe.DOT="dot";Pe.CROSS="cross";Pe.POW="pow";Pe.TRANSFORM_DIRECTION="transformDirection";Pe.MIX="mix";Pe.CLAMP="clamp";Pe.REFRACT="refract";Pe.SMOOTHSTEP="smoothstep";Pe.FACEFORWARD="faceforward";const tB=re(1e-6),aue=re(1e6),CR=re(Math.PI),oue=re(Math.PI*2),lue=re(Math.PI*2),uue=re(Math.PI*.5),P9=Mt(Pe,Pe.ALL).setParameterLength(1),B9=Mt(Pe,Pe.ANY).setParameterLength(1),I9=Mt(Pe,Pe.RADIANS).setParameterLength(1),F9=Mt(Pe,Pe.DEGREES).setParameterLength(1),nB=Mt(Pe,Pe.EXP).setParameterLength(1),Cx=Mt(Pe,Pe.EXP2).setParameterLength(1),uN=Mt(Pe,Pe.LOG).setParameterLength(1),od=Mt(Pe,Pe.LOG2).setParameterLength(1),go=Mt(Pe,Pe.SQRT).setParameterLength(1),iB=Mt(Pe,Pe.INVERSE_SQRT).setParameterLength(1),ld=Mt(Pe,Pe.FLOOR).setParameterLength(1),cN=Mt(Pe,Pe.CEIL).setParameterLength(1),al=Mt(Pe,Pe.NORMALIZE).setParameterLength(1),Qc=Mt(Pe,Pe.FRACT).setParameterLength(1),Qo=Mt(Pe,Pe.SIN).setParameterLength(1),qc=Mt(Pe,Pe.COS).setParameterLength(1),z9=Mt(Pe,Pe.TAN).setParameterLength(1),V9=Mt(Pe,Pe.ASIN).setParameterLength(1),rB=Mt(Pe,Pe.ACOS).setParameterLength(1),fN=Mt(Pe,Pe.ATAN).setParameterLength(1,2),Sr=Mt(Pe,Pe.ABS).setParameterLength(1),sB=Mt(Pe,Pe.SIGN).setParameterLength(1),ud=Mt(Pe,Pe.LENGTH).setParameterLength(1),aB=Mt(Pe,Pe.NEGATE).setParameterLength(1),G9=Mt(Pe,Pe.ONE_MINUS).setParameterLength(1),oB=Mt(Pe,Pe.DFDX).setParameterLength(1),lB=Mt(Pe,Pe.DFDY).setParameterLength(1),k9=Mt(Pe,Pe.ROUND).setParameterLength(1),H9=Mt(Pe,Pe.RECIPROCAL).setParameterLength(1),uB=Mt(Pe,Pe.TRUNC).setParameterLength(1),cB=Mt(Pe,Pe.FWIDTH).setParameterLength(1),W9=Mt(Pe,Pe.TRANSPOSE).setParameterLength(1),q9=Mt(Pe,Pe.DETERMINANT).setParameterLength(1),X9=Mt(Pe,Pe.INVERSE).setParameterLength(1),$9=(r,e)=>(Ve('TSL: "equals" is deprecated. Use "equal" inside a vector instead, like: "bvec*( equal( ... ) )"'),JP(r,e)),zl=Mt(Pe,Pe.MIN).setParameterLength(2,1/0),Kr=Mt(Pe,Pe.MAX).setParameterLength(2,1/0),dN=Mt(Pe,Pe.STEP).setParameterLength(2),j9=Mt(Pe,Pe.REFLECT).setParameterLength(2),Y9=Mt(Pe,Pe.DISTANCE).setParameterLength(2),Z9=Mt(Pe,Pe.DIFFERENCE).setParameterLength(2),uc=Mt(Pe,Pe.DOT).setParameterLength(2),Vh=Mt(Pe,Pe.CROSS).setParameterLength(2),Ju=Mt(Pe,Pe.POW).setParameterLength(2),fB=r=>Vn(r,r),K9=r=>Vn(r,r,r),dB=r=>Vn(r,r,r,r),Q9=Mt(Pe,Pe.TRANSFORM_DIRECTION).setParameterLength(2),J9=r=>Vn(sB(r),Ju(Sr(r),1/3)),hB=r=>uc(r,r),yi=Mt(Pe,Pe.MIX).setParameterLength(3),Jc=(r,e=0,t=1)=>Xt(new Pe(Pe.CLAMP,Xt(r),Xt(e),Xt(t))),hN=r=>Jc(r),pB=Mt(Pe,Pe.REFRACT).setParameterLength(3),ef=Mt(Pe,Pe.SMOOTHSTEP).setParameterLength(3),mB=Mt(Pe,Pe.FACEFORWARD).setParameterLength(3),eW=Te(([r])=>{const n=43758.5453,i=uc(r.xy,St(12.9898,78.233)),s=sE(i,CR);return Qc(Qo(s).mul(n))}),tW=(r,e,t)=>yi(e,t,r),nW=(r,e,t)=>ef(e,t,r),iW=(r,e)=>dN(e,r),rW=(r,e)=>(Ve('TSL: "atan2" is overloaded. Use "atan" instead.'),fN(r,e)),cue=mB,fue=iB;Ke("all",P9);Ke("any",B9);Ke("equals",$9);Ke("radians",I9);Ke("degrees",F9);Ke("exp",nB);Ke("exp2",Cx);Ke("log",uN);Ke("log2",od);Ke("sqrt",go);Ke("inverseSqrt",iB);Ke("floor",ld);Ke("ceil",cN);Ke("normalize",al);Ke("fract",Qc);Ke("sin",Qo);Ke("cos",qc);Ke("tan",z9);Ke("asin",V9);Ke("acos",rB);Ke("atan",fN);Ke("abs",Sr);Ke("sign",sB);Ke("length",ud);Ke("lengthSq",hB);Ke("negate",aB);Ke("oneMinus",G9);Ke("dFdx",oB);Ke("dFdy",lB);Ke("round",k9);Ke("reciprocal",H9);Ke("trunc",uB);Ke("fwidth",cB);Ke("atan2",rW);Ke("min",zl);Ke("max",Kr);Ke("step",iW);Ke("reflect",j9);Ke("distance",Y9);Ke("dot",uc);Ke("cross",Vh);Ke("pow",Ju);Ke("pow2",fB);Ke("pow3",K9);Ke("pow4",dB);Ke("transformDirection",Q9);Ke("mix",tW);Ke("clamp",Jc);Ke("refract",pB);Ke("smoothstep",nW);Ke("faceForward",mB);Ke("difference",Z9);Ke("saturate",hN);Ke("cbrt",J9);Ke("transpose",W9);Ke("determinant",q9);Ke("inverse",X9);Ke("rand",eW);class due extends on{static get type(){return"ConditionalNode"}constructor(e,t,n=null){super(),this.condNode=e,this.ifNode=t,this.elseNode=n}getNodeType(e){const{ifNode:t,elseNode:n}=e.getNodeProperties(this);if(t===void 0)return e.flowBuildStage(this,"setup"),this.getNodeType(e);const i=t.getNodeType(e);if(n!==null){const s=n.getNodeType(e);if(e.getTypeLength(s)>e.getTypeLength(i))return s}return i}setup(e){const t=this.condNode,n=this.ifNode.isolate(),i=this.elseNode?this.elseNode.isolate():null,s=e.context.nodeBlock;e.getDataFromNode(n).parentNodeBlock=s,i!==null&&(e.getDataFromNode(i).parentNodeBlock=s);const a=e.context.uniformFlow,o=e.getNodeProperties(this);o.condNode=t,o.ifNode=a?n:n.context({nodeBlock:n}),o.elseNode=i?a?i:i.context({nodeBlock:i}):null}generate(e,t){const n=this.getNodeType(e),i=e.getDataFromNode(this);if(i.nodeProperty!==void 0)return i.nodeProperty;const{condNode:s,ifNode:a,elseNode:o}=e.getNodeProperties(this),l=e.currentFunctionNode,c=t!=="void",d=c?Ah(n).build(e):"";i.nodeProperty=d;const p=s.build(e,"bool");if(e.context.uniformFlow&&o!==null){const v=a.build(e,n),b=o.build(e,n),E=e.getTernary(p,v,b);return e.format(E,n,t)}e.addFlowCode(`
${e.tab}if ( ${p} ) {

`).addFlowTab();let _=a.build(e,n);if(_&&(c?_=d+" = "+_+";":(_="return "+_+";",l===null&&(Ve("TSL: Return statement used in an inline 'Fn()'. Define a layout struct to allow return values."),_="// "+_))),e.removeFlowTab().addFlowCode(e.tab+"	"+_+`

`+e.tab+"}"),o!==null){e.addFlowCode(` else {

`).addFlowTab();let v=o.build(e,n);v&&(c?v=d+" = "+v+";":(v="return "+v+";",l===null&&(Ve("TSL: Return statement used in an inline 'Fn()'. Define a layout struct to allow return values."),v="// "+v))),e.removeFlowTab().addFlowCode(e.tab+"	"+v+`

`+e.tab+`}

`)}else e.addFlowCode(`

`);return e.format(d,n,t)}}const za=Gn(due).setParameterLength(2,3);Ke("select",za);class sW extends on{static get type(){return"ContextNode"}constructor(e=null,t={}){super(),this.isContextNode=!0,this.node=e,this.value=t}getScope(){return this.node.getScope()}getNodeType(e){return this.node.getNodeType(e)}getFlowContextData(){const e=[];return this.traverse(t=>{t.isContextNode===!0&&e.push(t.value)}),Object.assign({},...e)}getMemberType(e,t){return this.node.getMemberType(e,t)}analyze(e){const t=e.addContext(this.value);this.node.build(e),e.setContext(t)}setup(e){const t=e.addContext(this.value);this.node.build(e),e.setContext(t)}generate(e,t){const n=e.addContext(this.value),i=this.node.build(e,t);return e.setContext(n),i}}const jh=(r=null,e={})=>{let t=r;return(t===null||t.isNode!==!0)&&(e=t||e,t=null),new sW(t,e)},aW=r=>jh(r,{uniformFlow:!0}),gB=(r,e)=>jh(r,{nodeName:e});function oW(r,e,t=null){return jh(t,{getShadow:({light:n,shadowColorNode:i})=>e===n?i.mul(r):i})}function lW(r,e=null){return jh(e,{getAO:(t,{material:n})=>n.transparent===!0?t:t!==null?t.mul(r):r})}function uW(r,e){return Ve('TSL: "label()" has been deprecated. Use "setName()" instead.'),gB(r,e)}Ke("context",jh);Ke("label",uW);Ke("uniformFlow",aW);Ke("setName",gB);Ke("builtinShadowContext",(r,e,t)=>oW(e,t,r));Ke("builtinAOContext",(r,e)=>lW(e,r));class zw extends on{static get type(){return"VarNode"}constructor(e,t=null,n=!1){super(),this.node=e,this.name=t,this.global=!0,this.isVarNode=!0,this.readOnly=n,this.parents=!0,this.intent=!1}setIntent(e){return this.intent=e,this}isIntent(e){return e.getDataFromNode(this).forceDeclaration===!0?!1:this.intent}getIntent(){return this.intent}getMemberType(e,t){return this.node.getMemberType(e,t)}getElementType(e){return this.node.getElementType(e)}getNodeType(e){return this.node.getNodeType(e)}getArrayCount(e){return this.node.getArrayCount(e)}isAssign(e){return e.getDataFromNode(this).assign}build(...e){const t=e[0];if(this._hasStack(t)===!1&&t.buildStage==="setup"&&(t.context.nodeLoop||t.context.nodeBlock)){let n=!1;if(this.node.isShaderCallNodeInternal&&this.node.shaderNode.getLayout()===null&&t.fnCall&&t.fnCall.shaderNode&&t.getDataFromNode(this.node.shaderNode).hasLoop){const a=t.getDataFromNode(this);a.forceDeclaration=!0,n=!0}const i=t.getBaseStack();n?i.addToStackBefore(this):i.addToStack(this)}return this.isIntent(t)&&this.isAssign(t)!==!0?this.node.build(...e):super.build(...e)}generate(e){const{node:t,name:n,readOnly:i}=this,{renderer:s}=e,a=s.backend.isWebGPUBackend===!0;let o=!1,l=!1;i&&(o=e.isDeterministic(t),l=a?i:o);const c=this.getNodeType(e);if(c=="void")return this.isIntent(e)!==!0&&Ze('TSL: ".toVar()" can not be used with void type.'),t.build(e);const d=e.getVectorType(c),p=t.build(e,d),y=e.getVarFromNode(this,n,d,void 0,l),_=e.getPropertyName(y);let v=_;if(l)if(a)v=o?`const ${_}`:`let ${_}`;else{const b=t.getArrayCount(e);v=`const ${e.getVar(y.type,_,b)}`}return e.addLineFlowCode(`${v} = ${p}`,this),_}_hasStack(e){return e.getDataFromNode(this).stack!==void 0}}const yB=Gn(zw),cW=(r,e=null)=>yB(r,e).toStack(),fW=(r,e=null)=>yB(r,e,!0).toStack(),dW=r=>yB(r).setIntent(!0).toStack();Ke("toVar",cW);Ke("toConst",fW);Ke("toVarIntent",dW);class hue extends on{static get type(){return"SubBuild"}constructor(e,t,n=null){super(n),this.node=e,this.name=t,this.isSubBuildNode=!0}getNodeType(e){if(this.nodeType!==null)return this.nodeType;e.addSubBuild(this.name);const t=this.node.getNodeType(e);return e.removeSubBuild(),t}build(e,...t){e.addSubBuild(this.name);const n=this.node.build(e,...t);return e.removeSubBuild(),n}}const Kv=(r,e,t=null)=>Xt(new hue(Xt(r),e,t));class pue extends on{static get type(){return"VaryingNode"}constructor(e,t=null){super(),this.node=e,this.name=t,this.isVaryingNode=!0,this.interpolationType=null,this.interpolationSampling=null,this.global=!0}setInterpolation(e,t=null){return this.interpolationType=e,this.interpolationSampling=t,this}getHash(e){return this.name||super.getHash(e)}getNodeType(e){return this.node.getNodeType(e)}setupVarying(e){const t=e.getNodeProperties(this);let n=t.varying;if(n===void 0){const i=this.name,s=this.getNodeType(e),a=this.interpolationType,o=this.interpolationSampling;t.varying=n=e.getVaryingFromNode(this,i,s,a,o),t.node=Kv(this.node,"VERTEX")}return n.needsInterpolation||(n.needsInterpolation=e.shaderStage==="fragment"),n}setup(e){this.setupVarying(e),e.flowNodeFromShaderStage(bT.VERTEX,this.node)}analyze(e){this.setupVarying(e),e.flowNodeFromShaderStage(bT.VERTEX,this.node)}generate(e){const t=e.getSubBuildProperty("property",e.currentStack),n=e.getNodeProperties(this),i=this.setupVarying(e);if(n[t]===void 0){const s=this.getNodeType(e),a=e.getPropertyName(i,bT.VERTEX);e.flowNodeFromShaderStage(bT.VERTEX,n.node,s,a),n[t]=a}return e.getPropertyName(i)}}const bd=Gn(pue).setParameterLength(1,2),hW=r=>bd(r);Ke("toVarying",bd);Ke("toVertexStage",hW);Ke("varying",(...r)=>(Ve("TSL: .varying() has been renamed to .toVarying()."),bd(...r)));Ke("vertexStage",(...r)=>(Ve("TSL: .vertexStage() has been renamed to .toVertexStage()."),bd(...r)));const pW=Te(([r])=>{const e=r.mul(.9478672986).add(.0521327014).pow(2.4),t=r.mul(.0773993808),n=r.lessThanEqual(.04045);return yi(e,t,n)}).setLayout({name:"sRGBTransferEOTF",type:"vec3",inputs:[{name:"color",type:"vec3"}]}),mW=Te(([r])=>{const e=r.pow(.41666).mul(1.055).sub(.055),t=r.mul(12.92),n=r.lessThanEqual(.0031308);return yi(e,t,n)}).setLayout({name:"sRGBTransferOETF",type:"vec3",inputs:[{name:"color",type:"vec3"}]}),_B="WorkingColorSpace",mue="OutputColorSpace";class vB extends Qr{static get type(){return"ColorSpaceNode"}constructor(e,t,n){super("vec4"),this.colorNode=e,this.source=t,this.target=n}resolveColorSpace(e,t){return t===_B?Nn.workingColorSpace:t===mue?e.context.outputColorSpace||e.renderer.outputColorSpace:t}setup(e){const{colorNode:t}=this,n=this.resolveColorSpace(e,this.source),i=this.resolveColorSpace(e,this.target);let s=t;return Nn.enabled===!1||n===i||!n||!i||(Nn.getTransfer(n)===an&&(s=En(pW(s.rgb),s.a)),Nn.getPrimaries(n)!==Nn.getPrimaries(i)&&(s=En(Ha(Nn._getMatrix(new Zn,n,i)).mul(s.rgb),s.a)),Nn.getTransfer(i)===an&&(s=En(mW(s.rgb),s.a))),s}}const gW=(r,e)=>Xt(new vB(Xt(r),_B,e)),pN=(r,e)=>Xt(new vB(Xt(r),e,_B)),gue=(r,e,t)=>Xt(new vB(Xt(r),e,t));Ke("workingToColorSpace",gW);Ke("colorSpaceToWorking",pN);let yue=class extends Uy{static get type(){return"ReferenceElementNode"}constructor(e,t){super(e,t),this.referenceNode=e,this.isReferenceElementNode=!0}getNodeType(){return this.referenceNode.uniformType}generate(e){const t=super.generate(e),n=this.referenceNode.getNodeType(),i=this.getNodeType();return e.format(t,n,i)}};class yW extends on{static get type(){return"ReferenceBaseNode"}constructor(e,t,n=null,i=null){super(),this.property=e,this.uniformType=t,this.object=n,this.count=i,this.properties=e.split("."),this.reference=n,this.node=null,this.group=null,this.updateType=$n.OBJECT}setGroup(e){return this.group=e,this}element(e){return new yue(this,Xt(e))}setNodeType(e){const t=_n(null,e);this.group!==null&&t.setGroup(this.group),this.node=t}getNodeType(e){return this.node===null&&(this.updateReference(e),this.updateValue()),this.node.getNodeType(e)}getValueFromReference(e=this.reference){const{properties:t}=this;let n=e[t[0]];for(let i=1;i<t.length;i++)n=n[t[i]];return n}updateReference(e){return this.reference=this.object!==null?this.object:e.object,this.reference}setup(){return this.updateValue(),this.node}update(){this.updateValue()}updateValue(){this.node===null&&this.setNodeType(this.uniformType);const e=this.getValueFromReference();Array.isArray(e)?this.node.array=e:this.node.value=e}}const _ue=(r,e,t)=>new yW(r,e,t);class vue extends yW{static get type(){return"RendererReferenceNode"}constructor(e,t,n=null){super(e,t,n),this.renderer=n,this.setGroup(yn)}updateReference(e){return this.reference=this.renderer!==null?this.renderer:e.renderer,this.reference}}const _W=(r,e,t=null)=>new vue(r,e,t);class xue extends Qr{static get type(){return"ToneMappingNode"}constructor(e,t=xW,n=null){super("vec3"),this._toneMapping=e,this.exposureNode=t,this.colorNode=n}customCacheKey(){return qT(this._toneMapping)}setToneMapping(e){return this._toneMapping=e,this}getToneMapping(){return this._toneMapping}setup(e){const t=this.colorNode||e.context.color,n=this._toneMapping;if(n===ta)return t;let i=null;const s=e.renderer.library.getToneMappingFunction(n);return s!==null?i=En(s(t.rgb,this.exposureNode),t.a):(Ze("ToneMappingNode: Unsupported Tone Mapping configuration.",n),i=t),i}}const vW=(r,e,t)=>Xt(new xue(r,Xt(e),Xt(t))),xW=_W("toneMappingExposure","float");Ke("toneMapping",(r,e,t)=>vW(e,t,r));const I4=new WeakMap;function F4(r,e){let t=I4.get(r);return t===void 0&&(t=new H1(r,e),I4.set(r,t)),t}class Wp extends FP{static get type(){return"BufferAttributeNode"}constructor(e,t=null,n=0,i=0){super(e,t),this.isBufferNode=!0,this.bufferType=t,this.bufferStride=n,this.bufferOffset=i,this.usage=xm,this.instanced=!1,this.attribute=null,this.global=!0,e&&e.isBufferAttribute===!0&&e.itemSize<=4&&(this.attribute=e,this.usage=e.usage,this.instanced=e.isInstancedBufferAttribute)}getHash(e){if(this.bufferStride===0&&this.bufferOffset===0){let t=e.globalCache.getData(this.value);return t===void 0&&(t={node:this},e.globalCache.setData(this.value,t)),t.node.uuid}return this.uuid}getNodeType(e){return this.bufferType===null&&(this.bufferType=e.getTypeFromAttribute(this.attribute)),this.bufferType}setup(e){if(this.attribute!==null)return;const t=this.getNodeType(e),n=e.getTypeLength(t),i=this.value,s=this.bufferStride||n,a=this.bufferOffset;let o;i.isInterleavedBuffer===!0?o=i:i.isBufferAttribute===!0?o=F4(i.array,s):o=F4(i,s);const l=new Sm(o,n,a);o.setUsage(this.usage),this.attribute=l,this.attribute.isInstancedBufferAttribute=this.instanced}generate(e){const t=this.getNodeType(e),n=e.getBufferAttributeFromNode(this,t),i=e.getPropertyName(n);let s=null;return e.shaderStage==="vertex"||e.shaderStage==="compute"?(this.name=i,s=i):s=bd(this).build(e,t),s}getInputType(){return"bufferAttribute"}setUsage(e){return this.usage=e,this.attribute&&this.attribute.isBufferAttribute===!0&&(this.attribute.usage=e),this}setInstanced(e){return this.instanced=e,this}}function mN(r,e=null,t=0,n=0,i=xm,s=!1){return e==="mat3"||e===null&&r.itemSize===9?Ha(new Wp(r,"vec3",9,0).setUsage(i).setInstanced(s),new Wp(r,"vec3",9,3).setUsage(i).setInstanced(s),new Wp(r,"vec3",9,6).setUsage(i).setInstanced(s)):e==="mat4"||e===null&&r.itemSize===16?gm(new Wp(r,"vec4",16,0).setUsage(i).setInstanced(s),new Wp(r,"vec4",16,4).setUsage(i).setInstanced(s),new Wp(r,"vec4",16,8).setUsage(i).setInstanced(s),new Wp(r,"vec4",16,12).setUsage(i).setInstanced(s)):new Wp(r,e,t,n)}const xB=(r,e=null,t=0,n=0)=>mN(r,e,t,n),bue=(r,e=null,t=0,n=0)=>mN(r,e,t,n,tm),NR=(r,e=null,t=0,n=0)=>mN(r,e,t,n,xm,!0),rU=(r,e=null,t=0,n=0)=>mN(r,e,t,n,tm,!0);Ke("toAttribute",r=>xB(r.value));class Sue extends on{static get type(){return"ComputeNode"}constructor(e,t){super("void"),this.isComputeNode=!0,this.computeNode=e,this.workgroupSize=t,this.count=null,this.version=1,this.name="",this.updateBeforeType=$n.OBJECT,this.onInitFunction=null}setCount(e){return this.count=e,this}getCount(){return this.count}dispose(){this.dispatchEvent({type:"dispose"})}setName(e){return this.name=e,this}label(e){return Ve('TSL: "label()" has been deprecated. Use "setName()" instead.'),this.setName(e)}onInit(e){return this.onInitFunction=e,this}updateBefore({renderer:e}){e.compute(this)}setup(e){const t=this.computeNode.build(e);if(t){const n=e.getNodeProperties(this);n.outputComputeNode=t.outputNode,t.outputNode=null}return t}generate(e,t){const{shaderStage:n}=e;if(n==="compute"){const i=this.computeNode.build(e,"void");i!==""&&e.addLineFlowCode(i,this)}else{const s=e.getNodeProperties(this).outputComputeNode;if(s)return s.build(e,t)}}}const bB=(r,e=[64])=>{(e.length===0||e.length>3)&&Ze("TSL: compute() workgroupSize must have 1, 2, or 3 elements");for(let t=0;t<e.length;t++){const n=e[t];(typeof n!="number"||n<=0||!Number.isInteger(n))&&Ze(`TSL: compute() workgroupSize element at index [ ${t} ] must be a positive integer`)}for(;e.length<3;)e.push(1);return Xt(new Sue(Xt(r),e))},bW=(r,e,t)=>bB(r,t).setCount(e);Ke("compute",bW);Ke("computeKernel",bB);class Tue extends on{static get type(){return"IsolateNode"}constructor(e,t=!0){super(),this.node=e,this.parent=t,this.isIsolateNode=!0}getNodeType(e){const t=e.getCache(),n=e.getCacheFromNode(this,this.parent);e.setCache(n);const i=this.node.getNodeType(e);return e.setCache(t),i}build(e,...t){const n=e.getCache(),i=e.getCacheFromNode(this,this.parent);e.setCache(i);const s=this.node.build(e,...t);return e.setCache(n),s}setParent(e){return this.parent=e,this}getParent(){return this.parent}}const Qv=r=>new Tue(Xt(r));function SW(r,e=!0){return Ve('TSL: "cache()" has been deprecated. Use "isolate()" instead.'),Qv(r).setParent(e)}Ke("cache",SW);Ke("isolate",Qv);class Eue extends on{static get type(){return"BypassNode"}constructor(e,t){super(),this.isBypassNode=!0,this.outputNode=e,this.callNode=t}getNodeType(e){return this.outputNode.getNodeType(e)}generate(e){const t=this.callNode.build(e,"void");return t!==""&&e.addLineFlowCode(t,this),this.outputNode.build(e)}}const TW=Gn(Eue).setParameterLength(2);Ke("bypass",TW);class EW extends on{static get type(){return"RemapNode"}constructor(e,t,n,i=re(0),s=re(1)){super(),this.node=e,this.inLowNode=t,this.inHighNode=n,this.outLowNode=i,this.outHighNode=s,this.doClamp=!0}setup(){const{node:e,inLowNode:t,inHighNode:n,outLowNode:i,outHighNode:s,doClamp:a}=this;let o=e.sub(t).div(n.sub(t));return a===!0&&(o=o.clamp()),o.mul(s.sub(i)).add(i)}}const MW=Gn(EW,null,null,{doClamp:!1}).setParameterLength(3,5),AW=Gn(EW).setParameterLength(3,5);Ke("remap",MW);Ke("remapClamp",AW);class Vw extends on{static get type(){return"ExpressionNode"}constructor(e="",t="void"){super(t),this.snippet=e}generate(e,t){const n=this.getNodeType(e),i=this.snippet;if(n==="void")e.addLineFlowCode(i,this);else return e.format(i,n,t)}}const Gh=Gn(Vw).setParameterLength(1,2),wW=r=>(r?za(r,Gh("discard")):Gh("discard")).toStack(),Mue=()=>Gh("return").toStack();Ke("discard",wW);class Aue extends Qr{static get type(){return"RenderOutputNode"}constructor(e,t,n){super("vec4"),this.colorNode=e,this._toneMapping=t,this.outputColorSpace=n,this.isRenderOutputNode=!0}setToneMapping(e){return this._toneMapping=e,this}getToneMapping(){return this._toneMapping}setup({context:e}){let t=this.colorNode||e.color;const n=(this._toneMapping!==null?this._toneMapping:e.toneMapping)||ta,i=(this.outputColorSpace!==null?this.outputColorSpace:e.outputColorSpace)||Jo;return n!==ta&&(t=t.toneMapping(n)),i!==Jo&&i!==Nn.workingColorSpace&&(t=t.workingToColorSpace(i)),t}}const RW=(r,e=null,t=null)=>Xt(new Aue(Xt(r),e,t));Ke("renderOutput",RW);class wue extends Qr{static get type(){return"DebugNode"}constructor(e,t=null){super(),this.node=e,this.callback=t}getNodeType(e){return this.node.getNodeType(e)}setup(e){return this.node.build(e)}analyze(e){return this.node.build(e)}generate(e){const t=this.callback,n=this.node.build(e),i="--- TSL debug - "+e.shaderStage+" shader ---",s="-".repeat(i.length);let a="";return a+="// #"+i+`#
`,a+=e.flow.code.replace(/^\t/mg,"")+`
`,a+="/* ... */ "+n+` /* ... */
`,a+="// #"+s+`#
`,t!==null?t(e,a):gx(a),n}}const CW=(r,e=null)=>Xt(new wue(Xt(r),e)).toStack();Ke("debug",CW);class NW{constructor(){this._renderer=null,this.currentFrame=null}get nodeFrame(){return this._renderer._nodes.nodeFrame}setRenderer(e){return this._renderer=e,this}getRenderer(){return this._renderer}init(){}begin(){}finish(){}inspect(){}computeAsync(){}beginCompute(){}finishCompute(){}beginRender(){}finishRender(){}copyTextureToTexture(){}copyFramebufferToTexture(){}}class Rue extends on{static get type(){return"InspectorNode"}constructor(e,t="",n=null){super(),this.node=e,this.name=t,this.callback=n,this.updateType=$n.FRAME,this.isInspectorNode=!0}getName(){return this.name||this.node.name}update(e){e.renderer.inspector.inspect(this)}getNodeType(e){return this.node.getNodeType(e)}setup(e){let t=this.node;return e.context.inspector===!0&&this.callback!==null&&(t=this.callback(t)),e.renderer.backend.isWebGPUBackend!==!0&&e.renderer.inspector.constructor!==NW&&cr('TSL: ".toInspector()" is only available with WebGPU.'),t}}function DW(r,e="",t=null){return r=Xt(r),r.before(new Rue(r,e,t))}Ke("toInspector",DW);function Cue(r){Ve("TSL: AddNodeElement has been removed in favor of tree-shaking. Trying add",r)}class OW extends on{static get type(){return"AttributeNode"}constructor(e,t=null){super(t),this.global=!0,this._attributeName=e}getHash(e){return this.getAttributeName(e)}getNodeType(e){let t=this.nodeType;if(t===null){const n=this.getAttributeName(e);if(e.hasGeometryAttribute(n)){const i=e.geometry.getAttribute(n);t=e.getTypeFromAttribute(i)}else t="float"}return t}setAttributeName(e){return this._attributeName=e,this}getAttributeName(){return this._attributeName}generate(e){const t=this.getAttributeName(e),n=this.getNodeType(e);if(e.hasGeometryAttribute(t)===!0){const s=e.geometry.getAttribute(t),a=e.getTypeFromAttribute(s),o=e.getAttribute(t,a);return e.shaderStage==="vertex"?e.format(o.name,a,n):bd(this).build(e,n)}else return Ve(`AttributeNode: Vertex attribute "${t}" not found on geometry.`),e.generateConst(n)}serialize(e){super.serialize(e),e.global=this.global,e._attributeName=this._attributeName}deserialize(e){super.deserialize(e),this.global=e.global,this._attributeName=e._attributeName}}const kh=(r,e=null)=>new OW(r,e),hr=(r=0)=>kh("uv"+(r>0?r:""),"vec2");class Nue extends on{static get type(){return"TextureSizeNode"}constructor(e,t=null){super("uvec2"),this.isTextureSizeNode=!0,this.textureNode=e,this.levelNode=t}generate(e,t){const n=this.textureNode.build(e,"property"),i=this.levelNode===null?"0":this.levelNode.build(e,"int");return e.format(`${e.getMethod("textureDimensions")}( ${n}, ${i} )`,this.getNodeType(e),t)}}const wh=Gn(Nue).setParameterLength(1,2);class Due extends rE{static get type(){return"MaxMipLevelNode"}constructor(e){super(0),this._textureNode=e,this.updateType=$n.FRAME}get textureNode(){return this._textureNode}get texture(){return this._textureNode.value}update(){const e=this.texture,t=e.images,n=t&&t.length>0?t[0]&&t[0].image||t[0]:e.image;if(n&&n.width!==void 0){const{width:i,height:s}=n;this.value=Math.log2(Math.max(i,s))}}}const SB=Gn(Due).setParameterLength(1),TB=new sr;class gd extends rE{static get type(){return"TextureNode"}constructor(e=TB,t=null,n=null,i=null){super(e),this.isTextureNode=!0,this.uvNode=t,this.levelNode=n,this.biasNode=i,this.compareNode=null,this.depthNode=null,this.gradNode=null,this.offsetNode=null,this.sampler=!0,this.updateMatrix=!1,this.updateType=$n.NONE,this.referenceNode=null,this._value=e,this._matrixUniform=null,this._flipYUniform=null,this.setUpdateMatrix(t===null)}set value(e){this.referenceNode?this.referenceNode.value=e:this._value=e}get value(){return this.referenceNode?this.referenceNode.value:this._value}getUniformHash(){return this.value.uuid}getNodeType(){return this.value.isDepthTexture===!0?"float":this.value.type===Hi?"uvec4":this.value.type===Hs?"ivec4":"vec4"}getInputType(){return"texture"}getDefaultUV(){return hr(this.value.channel)}updateReference(){return this.value}getTransformedUV(e){return this._matrixUniform===null&&(this._matrixUniform=_n(this.value.matrix)),this._matrixUniform.mul(ge(e,1)).xy}setUpdateMatrix(e){return this.updateMatrix=e,this}setupUV(e,t){return e.isFlipY()&&(this._flipYUniform===null&&(this._flipYUniform=_n(!1)),t=t.toVar(),this.sampler?t=this._flipYUniform.select(t.flipY(),t):t=this._flipYUniform.select(t.setY(de(wh(this,this.levelNode).y).sub(t.y).sub(1)),t)),t}setup(e){const t=e.getNodeProperties(this);t.referenceNode=this.referenceNode;const n=this.value;if(!n||n.isTexture!==!0)throw new Error("THREE.TSL: `texture( value )` function expects a valid instance of THREE.Texture().");const i=Te(()=>{let a=this.uvNode;return(a===null||e.context.forceUVContext===!0)&&e.context.getUV&&(a=e.context.getUV(this,e)),a||(a=this.getDefaultUV()),this.updateMatrix===!0&&(a=this.getTransformedUV(a)),a=this.setupUV(e,a),this.updateType=this._matrixUniform!==null||this._flipYUniform!==null?$n.OBJECT:$n.NONE,a})();let s=this.levelNode;s===null&&e.context.getTextureLevel&&(s=e.context.getTextureLevel(this)),t.uvNode=i,t.levelNode=s,t.biasNode=this.biasNode,t.compareNode=this.compareNode,t.gradNode=this.gradNode,t.depthNode=this.depthNode,t.offsetNode=this.offsetNode}generateUV(e,t){return t.build(e,this.sampler===!0?"vec2":"ivec2")}generateOffset(e,t){return t.build(e,"ivec2")}generateSnippet(e,t,n,i,s,a,o,l,c){const d=this.value;let p;return s?p=e.generateTextureBias(d,t,n,s,a,c):l?p=e.generateTextureGrad(d,t,n,l,a,c):o?p=e.generateTextureCompare(d,t,n,o,a,c):this.sampler===!1?p=e.generateTextureLoad(d,t,n,i,a,c):i?p=e.generateTextureLevel(d,t,n,i,a,c):p=e.generateTexture(d,t,n,a,c),p}generate(e,t){const n=this.value,i=e.getNodeProperties(this),s=super.generate(e,"property");if(/^sampler/.test(t))return s+"_sampler";if(e.isReference(t))return s;{const a=e.getDataFromNode(this);let o=a.propertyName;if(o===void 0){const{uvNode:d,levelNode:p,biasNode:y,compareNode:_,depthNode:v,gradNode:b,offsetNode:E}=i,T=this.generateUV(e,d),M=p?p.build(e,"float"):null,R=y?y.build(e,"float"):null,N=v?v.build(e,"int"):null,P=_?_.build(e,"float"):null,U=b?[b[0].build(e,"vec2"),b[1].build(e,"vec2")]:null,L=E?this.generateOffset(e,E):null,F=e.getVarFromNode(this);o=e.getPropertyName(F);const O=this.generateSnippet(e,s,T,M,R,N,P,U,L);e.addLineFlowCode(`${o} = ${O}`,this),a.snippet=O,a.propertyName=o}let l=o;const c=this.getNodeType(e);return e.needsToWorkingColorSpace(n)&&(l=pN(Gh(l,c),n.colorSpace).setup(e).build(e,c)),e.format(l,c,t)}}setSampler(e){return this.sampler=e,this}getSampler(){return this.sampler}uv(e){return Ve("TextureNode: .uv() has been renamed. Use .sample() instead."),this.sample(e)}sample(e){const t=this.clone();return t.uvNode=Xt(e),t.referenceNode=this.getBase(),Xt(t)}load(e){return this.sample(e).setSampler(!1)}blur(e){const t=this.clone();t.biasNode=Xt(e).mul(SB(t)),t.referenceNode=this.getBase();const n=t.value;return t.generateMipmaps===!1&&(n&&n.generateMipmaps===!1||n.minFilter===Ki||n.magFilter===Ki)&&(Ve("TSL: texture().blur() requires mipmaps and sampling. Use .generateMipmaps=true and .minFilter/.magFilter=THREE.LinearFilter in the Texture."),t.biasNode=null),Xt(t)}level(e){const t=this.clone();return t.levelNode=Xt(e),t.referenceNode=this.getBase(),Xt(t)}size(e){return wh(this,e)}bias(e){const t=this.clone();return t.biasNode=Xt(e),t.referenceNode=this.getBase(),Xt(t)}getBase(){return this.referenceNode?this.referenceNode.getBase():this}compare(e){const t=this.clone();return t.compareNode=Xt(e),t.referenceNode=this.getBase(),Xt(t)}grad(e,t){const n=this.clone();return n.gradNode=[Xt(e),Xt(t)],n.referenceNode=this.getBase(),Xt(n)}depth(e){const t=this.clone();return t.depthNode=Xt(e),t.referenceNode=this.getBase(),Xt(t)}offset(e){const t=this.clone();return t.offsetNode=Xt(e),t.referenceNode=this.getBase(),Xt(t)}serialize(e){super.serialize(e),e.value=this.value.toJSON(e.meta).uuid,e.sampler=this.sampler,e.updateMatrix=this.updateMatrix,e.updateType=this.updateType}deserialize(e){super.deserialize(e),this.value=e.meta.textures[e.value],this.sampler=e.sampler,this.updateMatrix=e.updateMatrix,this.updateType=e.updateType}update(){const e=this.value,t=this._matrixUniform;t!==null&&(t.value=e.matrix),e.matrixAutoUpdate===!0&&e.updateMatrix();const n=this._flipYUniform;n!==null&&(n.value=e.image instanceof ImageBitmap&&e.flipY===!0||e.isRenderTargetTexture===!0||e.isFramebufferTexture===!0||e.isDepthTexture===!0)}clone(){const e=new this.constructor(this.value,this.uvNode,this.levelNode,this.biasNode);return e.sampler=this.sampler,e.depthNode=this.depthNode,e.compareNode=this.compareNode,e.gradNode=this.gradNode,e.offsetNode=this.offsetNode,e}}const Oue=Gn(gd).setParameterLength(1,4).setName("texture"),Li=(r=TB,e=null,t=null,n=null)=>{let i;return r&&r.isTextureNode===!0?(i=Xt(r.clone()),i.referenceNode=r.getBase(),e!==null&&(i.uvNode=Xt(e)),t!==null&&(i.levelNode=Xt(t)),n!==null&&(i.biasNode=Xt(n))):i=Oue(r,e,t,n),i},Uue=(r=TB)=>Li(r),as=(...r)=>Li(...r).setSampler(!1),Lue=(r,e,t)=>Li(r,e).level(t),Pue=r=>(r.isNode===!0?r:Li(r)).convert("sampler"),Bue=r=>(r.isNode===!0?r:Li(r)).convert("samplerComparison");class EB extends rE{static get type(){return"BufferNode"}constructor(e,t,n=0){super(e,t),this.isBufferNode=!0,this.bufferType=t,this.bufferCount=n,this.updateRanges=[]}addUpdateRange(e,t){this.updateRanges.push({start:e,count:t})}clearUpdateRanges(){this.updateRanges.length=0}getElementType(e){return this.getNodeType(e)}getInputType(){return"buffer"}}const aE=(r,e,t)=>new EB(r,e,t);class Iue extends Uy{static get type(){return"UniformArrayElementNode"}constructor(e,t){super(e,t),this.isArrayBufferElementNode=!0}generate(e){const t=super.generate(e),n=this.getNodeType(),i=this.node.getPaddedType();return e.format(t,i,n)}}class Fue extends EB{static get type(){return"UniformArrayNode"}constructor(e,t=null){super(null),this.array=e,this.elementType=t===null?cm(e[0]):t,this.paddedType=this.getPaddedType(),this.updateType=$n.RENDER,this.isArrayBufferNode=!0}getNodeType(){return this.paddedType}getElementType(){return this.elementType}getPaddedType(){const e=this.elementType;let t="vec4";return e==="mat2"?t="mat2":/mat/.test(e)===!0?t="mat4":e.charAt(0)==="i"?t="ivec4":e.charAt(0)==="u"&&(t="uvec4"),t}update(){const{array:e,value:t}=this,n=this.elementType;if(n==="float"||n==="int"||n==="uint")for(let i=0;i<e.length;i++){const s=i*4;t[s]=e[i]}else if(n==="color")for(let i=0;i<e.length;i++){const s=i*4,a=e[i];t[s]=a.r,t[s+1]=a.g,t[s+2]=a.b||0}else if(n==="mat2")for(let i=0;i<e.length;i++){const s=i*4,a=e[i];t[s]=a.elements[0],t[s+1]=a.elements[1],t[s+2]=a.elements[2],t[s+3]=a.elements[3]}else if(n==="mat3")for(let i=0;i<e.length;i++){const s=i*16,a=e[i];t[s]=a.elements[0],t[s+1]=a.elements[1],t[s+2]=a.elements[2],t[s+4]=a.elements[3],t[s+5]=a.elements[4],t[s+6]=a.elements[5],t[s+8]=a.elements[6],t[s+9]=a.elements[7],t[s+10]=a.elements[8],t[s+15]=1}else if(n==="mat4")for(let i=0;i<e.length;i++){const s=i*16,a=e[i];for(let o=0;o<a.elements.length;o++)t[s+o]=a.elements[o]}else for(let i=0;i<e.length;i++){const s=i*4,a=e[i];t[s]=a.x,t[s+1]=a.y,t[s+2]=a.z||0,t[s+3]=a.w||0}}setup(e){const t=this.array.length,n=this.elementType;let i=Float32Array;const s=this.paddedType,a=e.getTypeLength(s);return n.charAt(0)==="i"&&(i=Int32Array),n.charAt(0)==="u"&&(i=Uint32Array),this.value=new i(t*a),this.bufferCount=t,this.bufferType=s,super.setup(e)}element(e){return new Iue(this,Xt(e))}}const fo=(r,e)=>new Fue(r,e);class zue extends on{constructor(e){super("float"),this.name=e,this.isBuiltinNode=!0}generate(){return this.name}}const Yh=Gn(zue).setParameterLength(1);let XS,$S;class Cr extends on{static get type(){return"ScreenNode"}constructor(e){super(),this.scope=e,this._output=null,this.isViewportNode=!0}getNodeType(){return this.scope===Cr.DPR?"float":this.scope===Cr.VIEWPORT?"vec4":"vec2"}getUpdateType(){let e=$n.NONE;return(this.scope===Cr.SIZE||this.scope===Cr.VIEWPORT||this.scope===Cr.DPR)&&(e=$n.RENDER),this.updateType=e,e}update({renderer:e}){const t=e.getRenderTarget();this.scope===Cr.VIEWPORT?t!==null?$S.copy(t.viewport):(e.getViewport($S),$S.multiplyScalar(e.getPixelRatio())):this.scope===Cr.DPR?this._output.value=e.getPixelRatio():t!==null?(XS.width=t.width,XS.height=t.height):e.getDrawingBufferSize(XS)}setup(){const e=this.scope;let t=null;return e===Cr.SIZE?t=_n(XS||(XS=new tt)):e===Cr.VIEWPORT?t=_n($S||($S=new zn)):e===Cr.DPR?t=_n(1):t=St(Py.div(xy)),this._output=t,t}generate(e){if(this.scope===Cr.COORDINATE){let t=e.getFragCoord();if(e.isFlipY()){const n=e.getNodeProperties(xy).outputNode.build(e);t=`${e.getType("vec2")}( ${t}.x, ${n}.y - ${t}.y )`}return t}return super.generate(e)}}Cr.COORDINATE="coordinate";Cr.VIEWPORT="viewport";Cr.SIZE="size";Cr.UV="uv";Cr.DPR="dpr";const UW=kt(Cr,Cr.DPR),Rh=kt(Cr,Cr.UV),xy=kt(Cr,Cr.SIZE),Py=kt(Cr,Cr.COORDINATE),MB=kt(Cr,Cr.VIEWPORT),AB=MB.zw,LW=Py.sub(MB.xy),Vue=LW.div(AB),Gue=Te(()=>(Ve('TSL: "viewportResolution" is deprecated. Use "screenSize" instead.'),xy),"vec2").once()(),km=_n(0,"uint").setName("u_cameraIndex").setGroup(lN("cameraIndex")).toVarying("v_cameraIndex"),Qp=_n("float").setName("cameraNear").setGroup(yn).onRenderUpdate(({camera:r})=>r.near),Jp=_n("float").setName("cameraFar").setGroup(yn).onRenderUpdate(({camera:r})=>r.far),Ch=Te(({camera:r})=>{let e;if(r.isArrayCamera&&r.cameras.length>0){const t=[];for(const i of r.cameras)t.push(i.projectionMatrix);e=fo(t).setGroup(yn).setName("cameraProjectionMatrices").element(r.isMultiViewCamera?Yh("gl_ViewID_OVR"):km).toConst("cameraProjectionMatrix")}else e=_n("mat4").setName("cameraProjectionMatrix").setGroup(yn).onRenderUpdate(({camera:t})=>t.projectionMatrix);return e}).once()(),kue=Te(({camera:r})=>{let e;if(r.isArrayCamera&&r.cameras.length>0){const t=[];for(const i of r.cameras)t.push(i.projectionMatrixInverse);e=fo(t).setGroup(yn).setName("cameraProjectionMatricesInverse").element(r.isMultiViewCamera?Yh("gl_ViewID_OVR"):km).toConst("cameraProjectionMatrixInverse")}else e=_n("mat4").setName("cameraProjectionMatrixInverse").setGroup(yn).onRenderUpdate(({camera:t})=>t.projectionMatrixInverse);return e}).once()(),hc=Te(({camera:r})=>{let e;if(r.isArrayCamera&&r.cameras.length>0){const t=[];for(const i of r.cameras)t.push(i.matrixWorldInverse);e=fo(t).setGroup(yn).setName("cameraViewMatrices").element(r.isMultiViewCamera?Yh("gl_ViewID_OVR"):km).toConst("cameraViewMatrix")}else e=_n("mat4").setName("cameraViewMatrix").setGroup(yn).onRenderUpdate(({camera:t})=>t.matrixWorldInverse);return e}).once()(),Hue=Te(({camera:r})=>{let e;if(r.isArrayCamera&&r.cameras.length>0){const t=[];for(const i of r.cameras)t.push(i.matrixWorld);e=fo(t).setGroup(yn).setName("cameraWorldMatrices").element(r.isMultiViewCamera?Yh("gl_ViewID_OVR"):km).toConst("cameraWorldMatrix")}else e=_n("mat4").setName("cameraWorldMatrix").setGroup(yn).onRenderUpdate(({camera:t})=>t.matrixWorld);return e}).once()(),Wue=Te(({camera:r})=>{let e;if(r.isArrayCamera&&r.cameras.length>0){const t=[];for(const i of r.cameras)t.push(i.normalMatrix);e=fo(t).setGroup(yn).setName("cameraNormalMatrices").element(r.isMultiViewCamera?Yh("gl_ViewID_OVR"):km).toConst("cameraNormalMatrix")}else e=_n("mat3").setName("cameraNormalMatrix").setGroup(yn).onRenderUpdate(({camera:t})=>t.normalMatrix);return e}).once()(),PW=Te(({camera:r})=>{let e;if(r.isArrayCamera&&r.cameras.length>0){const t=[];for(let i=0,s=r.cameras.length;i<s;i++)t.push(new ne);e=fo(t).setGroup(yn).setName("cameraPositions").onRenderUpdate(({camera:i},s)=>{const a=i.cameras,o=s.array;for(let l=0,c=a.length;l<c;l++)o[l].setFromMatrixPosition(a[l].matrixWorld)}).element(r.isMultiViewCamera?Yh("gl_ViewID_OVR"):km).toConst("cameraPosition")}else e=_n(new ne).setName("cameraPosition").setGroup(yn).onRenderUpdate(({camera:t},n)=>n.value.setFromMatrixPosition(t.matrixWorld));return e}).once()(),que=Te(({camera:r})=>{let e;if(r.isArrayCamera&&r.cameras.length>0){const t=[];for(const i of r.cameras)t.push(i.viewport);e=fo(t,"vec4").setGroup(yn).setName("cameraViewports").element(km).toConst("cameraViewport")}else e=En(0,0,xy.x,xy.y).toConst("cameraViewport");return e}).once()(),z4=new Sa;class pi extends on{static get type(){return"Object3DNode"}constructor(e,t=null){super(),this.scope=e,this.object3d=t,this.updateType=$n.OBJECT,this.uniformNode=new rE(null)}getNodeType(){const e=this.scope;if(e===pi.WORLD_MATRIX)return"mat4";if(e===pi.POSITION||e===pi.VIEW_POSITION||e===pi.DIRECTION||e===pi.SCALE)return"vec3";if(e===pi.RADIUS)return"float"}update(e){const t=this.object3d,n=this.uniformNode,i=this.scope;if(i===pi.WORLD_MATRIX)n.value=t.matrixWorld;else if(i===pi.POSITION)n.value=n.value||new ne,n.value.setFromMatrixPosition(t.matrixWorld);else if(i===pi.SCALE)n.value=n.value||new ne,n.value.setFromMatrixScale(t.matrixWorld);else if(i===pi.DIRECTION)n.value=n.value||new ne,t.getWorldDirection(n.value);else if(i===pi.VIEW_POSITION){const s=e.camera;n.value=n.value||new ne,n.value.setFromMatrixPosition(t.matrixWorld),n.value.applyMatrix4(s.matrixWorldInverse)}else if(i===pi.RADIUS){const s=e.object.geometry;s.boundingSphere===null&&s.computeBoundingSphere(),z4.copy(s.boundingSphere).applyMatrix4(t.matrixWorld),n.value=z4.radius}}generate(e){const t=this.scope;return t===pi.WORLD_MATRIX?this.uniformNode.nodeType="mat4":t===pi.POSITION||t===pi.VIEW_POSITION||t===pi.DIRECTION||t===pi.SCALE?this.uniformNode.nodeType="vec3":t===pi.RADIUS&&(this.uniformNode.nodeType="float"),this.uniformNode.build(e)}serialize(e){super.serialize(e),e.scope=this.scope}deserialize(e){super.deserialize(e),this.scope=e.scope}}pi.WORLD_MATRIX="worldMatrix";pi.POSITION="position";pi.SCALE="scale";pi.VIEW_POSITION="viewPosition";pi.DIRECTION="direction";pi.RADIUS="radius";const Xue=Gn(pi,pi.DIRECTION).setParameterLength(1),$ue=Gn(pi,pi.WORLD_MATRIX).setParameterLength(1),BW=Gn(pi,pi.POSITION).setParameterLength(1),jue=Gn(pi,pi.SCALE).setParameterLength(1),Yue=Gn(pi,pi.VIEW_POSITION).setParameterLength(1),Zue=Gn(pi,pi.RADIUS).setParameterLength(1);class cc extends pi{static get type(){return"ModelNode"}constructor(e){super(e)}update(e){this.object3d=e.object,super.update(e)}}const Kue=kt(cc,cc.DIRECTION),ec=kt(cc,cc.WORLD_MATRIX),Que=kt(cc,cc.POSITION),Jue=kt(cc,cc.SCALE),ece=kt(cc,cc.VIEW_POSITION),tce=kt(cc,cc.RADIUS),IW=_n(new Zn).onObjectUpdate(({object:r},e)=>e.value.getNormalMatrix(r.matrixWorld)),nce=_n(new gn).onObjectUpdate(({object:r},e)=>e.value.copy(r.matrixWorld).invert()),Hm=Te(r=>r.context.modelViewMatrix||FW).once()().toVar("modelViewMatrix"),FW=hc.mul(ec),sU=Te(r=>(r.context.isHighPrecisionModelViewMatrix=!0,_n("mat4").onObjectUpdate(({object:e,camera:t})=>e.modelViewMatrix.multiplyMatrices(t.matrixWorldInverse,e.matrixWorld)))).once()().toVar("highpModelViewMatrix"),aU=Te(r=>{const e=r.context.isHighPrecisionModelViewMatrix;return _n("mat3").onObjectUpdate(({object:t,camera:n})=>(e!==!0&&t.modelViewMatrix.multiplyMatrices(n.matrixWorldInverse,t.matrixWorld),t.normalMatrix.getNormalMatrix(t.modelViewMatrix)))}).once()().toVar("highpModelNormalViewMatrix"),oE=kh("position","vec3"),Yr=oE.toVarying("positionLocal"),DR=oE.toVarying("positionPrevious"),cd=Te(r=>ec.mul(Yr).xyz.toVarying(r.getSubBuildProperty("v_positionWorld")),"vec3").once(["POSITION"])(),wB=Te(()=>Yr.transformDirection(ec).toVarying("v_positionWorldDirection").normalize().toVar("positionWorldDirection"),"vec3").once(["POSITION"])(),xs=Te(r=>r.context.setupPositionView().toVarying("v_positionView"),"vec3").once(["POSITION"])(),mr=Te(r=>{let e;return r.camera.isOrthographicCamera?e=ge(0,0,1):e=xs.negate().toVarying("v_positionViewDirection").normalize(),e.toVar("positionViewDirection")},"vec3").once(["POSITION"])();class ice extends on{static get type(){return"FrontFacingNode"}constructor(){super("bool"),this.isFrontFacingNode=!0}generate(e){if(e.shaderStage!=="fragment")return"true";const{material:t}=e;return t.side===gr?"false":e.getFrontFacing()}}const zW=kt(ice),RB=re(zW).mul(2).sub(1),$x=Te(([r],{material:e})=>{const t=e.side;return t===gr?r=r.mul(-1):t===xa&&(r=r.mul(RB)),r}),gN=kh("normal","vec3"),Vl=Te(r=>r.geometry.hasAttribute("normal")===!1?(Ve('TSL: Vertex attribute "normal" not found on geometry.'),ge(0,1,0)):gN,"vec3").once()().toVar("normalLocal"),VW=xs.dFdx().cross(xs.dFdy()).normalize().toVar("normalFlat"),Nx=Te(r=>{let e;return r.material.flatShading===!0?e=VW:e=CB(Vl).toVarying("v_normalViewGeometry").normalize(),e},"vec3").once()().toVar("normalViewGeometry"),GW=Te(r=>{let e=Nx.transformDirection(hc);return r.material.flatShading!==!0&&(e=e.toVarying("v_normalWorldGeometry")),e.normalize().toVar("normalWorldGeometry")},"vec3").once()(),Ri=Te(({subBuildFn:r,material:e,context:t})=>{let n;return r==="NORMAL"||r==="VERTEX"?(n=Nx,e.flatShading!==!0&&(n=$x(n))):n=t.setupNormal().context({getUV:null}),n},"vec3").once(["NORMAL","VERTEX"])().toVar("normalView"),Wm=Ri.transformDirection(hc).toVar("normalWorld"),b0=Te(({subBuildFn:r,context:e})=>{let t;return r==="NORMAL"||r==="VERTEX"?t=Ri:t=e.setupClearcoatNormal().context({getUV:null}),t},"vec3").once(["NORMAL","VERTEX"])().toVar("clearcoatNormalView"),kW=Te(([r,e=ec])=>{const t=Ha(e),n=r.div(ge(t[0].dot(t[0]),t[1].dot(t[1]),t[2].dot(t[2])));return t.mul(n).xyz}),CB=Te(([r],e)=>{const t=e.context.modelNormalViewMatrix;if(t)return t.transformDirection(r);const n=IW.mul(r);return hc.transformDirection(n)}),rce=Te(()=>(Ve('TSL: "transformedNormalView" is deprecated. Use "normalView" instead.'),Ri)).once(["NORMAL","VERTEX"])(),sce=Te(()=>(Ve('TSL: "transformedNormalWorld" is deprecated. Use "normalWorld" instead.'),Wm)).once(["NORMAL","VERTEX"])(),ace=Te(()=>(Ve('TSL: "transformedClearcoatNormalView" is deprecated. Use "clearcoatNormalView" instead.'),b0)).once(["NORMAL","VERTEX"])(),V4=new ll,rD=new gn,HW=_n(0).onReference(({material:r})=>r).onObjectUpdate(({material:r})=>r.refractionRatio),Gw=_n(1).onReference(({material:r})=>r).onObjectUpdate(function({material:r,scene:e}){return r.envMap?r.envMapIntensity:e.environmentIntensity}),NB=_n(new gn).onReference(function(r){return r.material}).onObjectUpdate(function({material:r,scene:e}){const t=e.environment!==null&&r.envMap===null?e.environmentRotation:r.envMapRotation;return t?(V4.copy(t),rD.makeRotationFromEuler(V4)):rD.identity(),rD}),WW=mr.negate().reflect(Ri),qW=mr.negate().refract(Ri,HW),XW=WW.transformDirection(hc).toVar("reflectVector"),$W=qW.transformDirection(hc).toVar("reflectVector"),jW=new Im;class oce extends gd{static get type(){return"CubeTextureNode"}constructor(e,t=null,n=null,i=null){super(e,t,n,i),this.isCubeTextureNode=!0}getInputType(){return this.value.isDepthTexture===!0?"cubeDepthTexture":"cubeTexture"}getDefaultUV(){const e=this.value;return e.mapping===ol?XW:e.mapping===oc?$W:(Ze('CubeTextureNode: Mapping "%s" not supported.',e.mapping),ge(0,0,0))}setUpdateMatrix(){}setupUV(e,t){const n=this.value;return n.isDepthTexture===!0?e.renderer.coordinateSystem===Il?ge(t.x,t.y.negate(),t.z):t:((e.renderer.coordinateSystem===Il||!n.isRenderTargetTexture)&&(t=ge(t.x.negate(),t.yz)),NB.mul(t))}generateUV(e,t){return t.build(e,this.sampler===!0?"vec3":"ivec3")}}const DB=Gn(oce).setParameterLength(1,4).setName("cubeTexture"),il=(r=jW,e=null,t=null,n=null)=>{let i;return r&&r.isCubeTextureNode===!0?(i=Xt(r.clone()),i.referenceNode=r,e!==null&&(i.uvNode=Xt(e)),t!==null&&(i.levelNode=Xt(t)),n!==null&&(i.biasNode=Xt(n))):i=DB(r,e,t,n),i},lce=(r=jW)=>DB(r);class uce extends Uy{static get type(){return"ReferenceElementNode"}constructor(e,t){super(e,t),this.referenceNode=e,this.isReferenceElementNode=!0}getNodeType(){return this.referenceNode.uniformType}generate(e){const t=super.generate(e),n=this.referenceNode.getNodeType(),i=this.getNodeType();return e.format(t,n,i)}}class yN extends on{static get type(){return"ReferenceNode"}constructor(e,t,n=null,i=null){super(),this.property=e,this.uniformType=t,this.object=n,this.count=i,this.properties=e.split("."),this.reference=n,this.node=null,this.group=null,this.name=null,this.updateType=$n.OBJECT}element(e){return new uce(this,Xt(e))}setGroup(e){return this.group=e,this}setName(e){return this.name=e,this}label(e){return Ve('TSL: "label()" has been deprecated. Use "setName()" instead.'),this.setName(e)}setNodeType(e){let t=null;this.count!==null?t=aE(null,e,this.count):Array.isArray(this.getValueFromReference())?t=fo(null,e):e==="texture"?t=Li(null):e==="cubeTexture"?t=il(null):t=_n(null,e),this.group!==null&&t.setGroup(this.group),this.name!==null&&t.setName(this.name),this.node=t}getNodeType(e){return this.node===null&&(this.updateReference(e),this.updateValue()),this.node.getNodeType(e)}getValueFromReference(e=this.reference){const{properties:t}=this;let n=e[t[0]];for(let i=1;i<t.length;i++)n=n[t[i]];return n}updateReference(e){return this.reference=this.object!==null?this.object:e.object,this.reference}setup(){return this.updateValue(),this.node}update(){this.updateValue()}updateValue(){this.node===null&&this.setNodeType(this.uniformType);const e=this.getValueFromReference();Array.isArray(e)?this.node.array=e:this.node.value=e}}const fr=(r,e,t)=>new yN(r,e,t),oU=(r,e,t,n)=>new yN(r,e,n,t);class cce extends yN{static get type(){return"MaterialReferenceNode"}constructor(e,t,n=null){super(e,t,n),this.material=n,this.isMaterialReferenceNode=!0}updateReference(e){return this.reference=this.material!==null?this.material:e.material,this.reference}}const ph=(r,e,t=null)=>new cce(r,e,t),YW=hr(),fce=xs.dFdx(),dce=xs.dFdy(),ZW=YW.dFdx(),KW=YW.dFdy(),QW=Ri,JW=dce.cross(QW),e7=QW.cross(fce),lU=JW.mul(ZW.x).add(e7.mul(KW.x)),uU=JW.mul(ZW.y).add(e7.mul(KW.y)),G4=lU.dot(lU).max(uU.dot(uU)),t7=G4.equal(0).select(0,G4.inverseSqrt()),hce=lU.mul(t7).toVar("tangentViewFrame"),pce=uU.mul(t7).toVar("bitangentViewFrame"),_N=kh("tangent","vec4"),lE=_N.xyz.toVar("tangentLocal"),vN=Te(({subBuildFn:r,geometry:e,material:t})=>{let n;return r==="VERTEX"||e.hasAttribute("tangent")?n=Hm.mul(En(lE,0)).xyz.toVarying("v_tangentView").normalize():n=hce,t.flatShading!==!0&&(n=$x(n)),n},"vec3").once(["NORMAL","VERTEX"])().toVar("tangentView"),n7=vN.transformDirection(hc).toVarying("v_tangentWorld").normalize().toVar("tangentWorld"),xN=Te(([r,e],{subBuildFn:t,material:n})=>{let i=r.mul(_N.w).xyz;return t==="NORMAL"&&n.flatShading!==!0&&(i=i.toVarying(e)),i}).once(["NORMAL"]),mce=xN(gN.cross(_N),"v_bitangentGeometry").normalize().toVar("bitangentGeometry"),gce=xN(Vl.cross(lE),"v_bitangentLocal").normalize().toVar("bitangentLocal"),i7=Te(({subBuildFn:r,geometry:e,material:t})=>{let n;return r==="VERTEX"||e.hasAttribute("tangent")?n=xN(Ri.cross(vN),"v_bitangentView").normalize():n=pce,t.flatShading!==!0&&(n=$x(n)),n},"vec3").once(["NORMAL","VERTEX"])().toVar("bitangentView"),yce=xN(Wm.cross(n7),"v_bitangentWorld").normalize().toVar("bitangentWorld"),S0=Ha(vN,i7,Ri).toVar("TBNViewMatrix"),r7=mr.mul(S0),_ce=(r,e)=>r.sub(r7.mul(e)),s7=Te(()=>{let r=I0.cross(mr);return r=r.cross(I0).normalize(),r=yi(r,Ri,Zp.mul(td.oneMinus()).oneMinus().pow2().pow2()).normalize(),r}).once()(),a7=r=>Xt(r).mul(.5).add(.5),vce=r=>Xt(r).mul(2).sub(1),cU=r=>ge(r,go(hN(re(1).sub(uc(r,r)))));class xce extends Qr{static get type(){return"NormalMapNode"}constructor(e,t=null){super("vec3"),this.node=e,this.scaleNode=t,this.normalMapType=Kc,this.unpackNormalMode=Mw}setup({material:e}){const{normalMapType:t,scaleNode:n,unpackNormalMode:i}=this;let s=this.node.mul(2).sub(1);if(t===Kc?i===iL?s=cU(s.xy):i===Uk?s=cU(s.yw):i!==Mw&&console.error(`THREE.NodeMaterial: Unexpected unpack normal mode: ${i}`):i!==Mw&&console.error(`THREE.NodeMaterial: Normal map type '${t}' is not compatible with unpack normal mode '${i}'`),n!==null){let o=n;e.flatShading===!0&&(o=$x(o)),s=ge(s.xy.mul(o),s.z)}let a=null;return t===nL?a=CB(s):t===Kc?a=S0.mul(s).normalize():(Ze(`NodeMaterial: Unsupported normal map type: ${t}`),a=Ri),a}}const fU=Gn(xce).setParameterLength(1,2),bce=Te(({textureNode:r,bumpScale:e})=>{const t=i=>r.isolate().context({getUV:s=>i(s.uvNode||hr()),forceUVContext:!0}),n=re(t(i=>i));return St(re(t(i=>i.add(i.dFdx()))).sub(n),re(t(i=>i.add(i.dFdy()))).sub(n)).mul(e)}),Sce=Te(r=>{const{surf_pos:e,surf_norm:t,dHdxy:n}=r,i=e.dFdx().normalize(),s=e.dFdy().normalize(),a=t,o=s.cross(a),l=a.cross(i),c=i.dot(o).mul(RB),d=c.sign().mul(n.x.mul(o).add(n.y.mul(l)));return c.abs().mul(t).sub(d).normalize()});class Tce extends Qr{static get type(){return"BumpMapNode"}constructor(e,t=null){super("vec3"),this.textureNode=e,this.scaleNode=t}setup(){const e=this.scaleNode!==null?this.scaleNode:1,t=bce({textureNode:this.textureNode,bumpScale:e});return Sce({surf_pos:xs,surf_norm:Ri,dHdxy:t})}}const OB=Gn(Tce).setParameterLength(1,2),k4=new Map;class et extends on{static get type(){return"MaterialNode"}constructor(e){super(),this.scope=e}getCache(e,t){let n=k4.get(e);return n===void 0&&(n=ph(e,t),k4.set(e,n)),n}getFloat(e){return this.getCache(e,"float")}getColor(e){return this.getCache(e,"color")}getTexture(e){return this.getCache(e==="map"?"map":e+"Map","texture")}setup(e){const t=e.context.material,n=this.scope;let i=null;if(n===et.COLOR){const s=t.color!==void 0?this.getColor(n):ge();t.map&&t.map.isTexture===!0?i=s.mul(this.getTexture("map")):i=s}else if(n===et.OPACITY){const s=this.getFloat(n);t.alphaMap&&t.alphaMap.isTexture===!0?i=s.mul(this.getTexture("alpha")):i=s}else if(n===et.SPECULAR_STRENGTH)t.specularMap&&t.specularMap.isTexture===!0?i=this.getTexture("specular").r:i=re(1);else if(n===et.SPECULAR_INTENSITY){const s=this.getFloat(n);t.specularIntensityMap&&t.specularIntensityMap.isTexture===!0?i=s.mul(this.getTexture(n).a):i=s}else if(n===et.SPECULAR_COLOR){const s=this.getColor(n);t.specularColorMap&&t.specularColorMap.isTexture===!0?i=s.mul(this.getTexture(n).rgb):i=s}else if(n===et.ROUGHNESS){const s=this.getFloat(n);t.roughnessMap&&t.roughnessMap.isTexture===!0?i=s.mul(this.getTexture(n).g):i=s}else if(n===et.METALNESS){const s=this.getFloat(n);t.metalnessMap&&t.metalnessMap.isTexture===!0?i=s.mul(this.getTexture(n).b):i=s}else if(n===et.EMISSIVE){const s=this.getFloat("emissiveIntensity"),a=this.getColor(n).mul(s);t.emissiveMap&&t.emissiveMap.isTexture===!0?i=a.mul(this.getTexture(n)):i=a}else if(n===et.NORMAL)t.normalMap?(i=fU(this.getTexture("normal"),this.getCache("normalScale","vec2")),i.normalMapType=t.normalMapType,(t.normalMap.format==po||t.normalMap.format==vm||t.normalMap.format==_m)&&(i.unpackNormalMode=iL)):t.bumpMap?i=OB(this.getTexture("bump").r,this.getFloat("bumpScale")):i=Ri;else if(n===et.CLEARCOAT){const s=this.getFloat(n);t.clearcoatMap&&t.clearcoatMap.isTexture===!0?i=s.mul(this.getTexture(n).r):i=s}else if(n===et.CLEARCOAT_ROUGHNESS){const s=this.getFloat(n);t.clearcoatRoughnessMap&&t.clearcoatRoughnessMap.isTexture===!0?i=s.mul(this.getTexture(n).r):i=s}else if(n===et.CLEARCOAT_NORMAL)t.clearcoatNormalMap?i=fU(this.getTexture(n),this.getCache(n+"Scale","vec2")):i=Ri;else if(n===et.SHEEN){const s=this.getColor("sheenColor").mul(this.getFloat("sheen"));t.sheenColorMap&&t.sheenColorMap.isTexture===!0?i=s.mul(this.getTexture("sheenColor").rgb):i=s}else if(n===et.SHEEN_ROUGHNESS){const s=this.getFloat(n);t.sheenRoughnessMap&&t.sheenRoughnessMap.isTexture===!0?i=s.mul(this.getTexture(n).a):i=s,i=i.clamp(1e-4,1)}else if(n===et.ANISOTROPY)if(t.anisotropyMap&&t.anisotropyMap.isTexture===!0){const s=this.getTexture(n);i=aN(Nv.x,Nv.y,Nv.y.negate(),Nv.x).mul(s.rg.mul(2).sub(St(1)).normalize().mul(s.b))}else i=Nv;else if(n===et.IRIDESCENCE_THICKNESS){const s=fr("1","float",t.iridescenceThicknessRange);if(t.iridescenceThicknessMap){const a=fr("0","float",t.iridescenceThicknessRange);i=s.sub(a).mul(this.getTexture(n).g).add(a)}else i=s}else if(n===et.TRANSMISSION){const s=this.getFloat(n);t.transmissionMap?i=s.mul(this.getTexture(n).r):i=s}else if(n===et.THICKNESS){const s=this.getFloat(n);t.thicknessMap?i=s.mul(this.getTexture(n).g):i=s}else if(n===et.IOR)i=this.getFloat(n);else if(n===et.LIGHT_MAP)i=this.getTexture(n).rgb.mul(this.getFloat("lightMapIntensity"));else if(n===et.AO)i=this.getTexture(n).r.sub(1).mul(this.getFloat("aoMapIntensity")).add(1);else if(n===et.LINE_DASH_OFFSET)i=t.dashOffset?this.getFloat(n):re(0);else{const s=this.getNodeType(e);i=this.getCache(n,s)}return i}}et.ALPHA_TEST="alphaTest";et.COLOR="color";et.OPACITY="opacity";et.SHININESS="shininess";et.SPECULAR="specular";et.SPECULAR_STRENGTH="specularStrength";et.SPECULAR_INTENSITY="specularIntensity";et.SPECULAR_COLOR="specularColor";et.REFLECTIVITY="reflectivity";et.ROUGHNESS="roughness";et.METALNESS="metalness";et.NORMAL="normal";et.CLEARCOAT="clearcoat";et.CLEARCOAT_ROUGHNESS="clearcoatRoughness";et.CLEARCOAT_NORMAL="clearcoatNormal";et.EMISSIVE="emissive";et.ROTATION="rotation";et.SHEEN="sheen";et.SHEEN_ROUGHNESS="sheenRoughness";et.ANISOTROPY="anisotropy";et.IRIDESCENCE="iridescence";et.IRIDESCENCE_IOR="iridescenceIOR";et.IRIDESCENCE_THICKNESS="iridescenceThickness";et.IOR="ior";et.TRANSMISSION="transmission";et.THICKNESS="thickness";et.ATTENUATION_DISTANCE="attenuationDistance";et.ATTENUATION_COLOR="attenuationColor";et.LINE_SCALE="scale";et.LINE_DASH_SIZE="dashSize";et.LINE_GAP_SIZE="gapSize";et.LINE_WIDTH="linewidth";et.LINE_DASH_OFFSET="dashOffset";et.POINT_SIZE="size";et.DISPERSION="dispersion";et.LIGHT_MAP="light";et.AO="ao";const o7=kt(et,et.ALPHA_TEST),l7=kt(et,et.COLOR),u7=kt(et,et.SHININESS),c7=kt(et,et.EMISSIVE),UB=kt(et,et.OPACITY),f7=kt(et,et.SPECULAR),dU=kt(et,et.SPECULAR_INTENSITY),d7=kt(et,et.SPECULAR_COLOR),YT=kt(et,et.SPECULAR_STRENGTH),kw=kt(et,et.REFLECTIVITY),h7=kt(et,et.ROUGHNESS),p7=kt(et,et.METALNESS),m7=kt(et,et.NORMAL),g7=kt(et,et.CLEARCOAT),y7=kt(et,et.CLEARCOAT_ROUGHNESS),_7=kt(et,et.CLEARCOAT_NORMAL),v7=kt(et,et.ROTATION),x7=kt(et,et.SHEEN),b7=kt(et,et.SHEEN_ROUGHNESS),S7=kt(et,et.ANISOTROPY),T7=kt(et,et.IRIDESCENCE),E7=kt(et,et.IRIDESCENCE_IOR),M7=kt(et,et.IRIDESCENCE_THICKNESS),A7=kt(et,et.TRANSMISSION),w7=kt(et,et.THICKNESS),R7=kt(et,et.IOR),C7=kt(et,et.ATTENUATION_DISTANCE),N7=kt(et,et.ATTENUATION_COLOR),D7=kt(et,et.LINE_SCALE),O7=kt(et,et.LINE_DASH_SIZE),U7=kt(et,et.LINE_GAP_SIZE),Ece=kt(et,et.LINE_WIDTH),L7=kt(et,et.LINE_DASH_OFFSET),P7=kt(et,et.POINT_SIZE),B7=kt(et,et.DISPERSION),LB=kt(et,et.LIGHT_MAP),I7=kt(et,et.AO),Nv=_n(new tt).onReference(function(r){return r.material}).onRenderUpdate(function({material:r}){this.value.set(r.anisotropy*Math.cos(r.anisotropyRotation),r.anisotropy*Math.sin(r.anisotropyRotation))}),F7=Te(r=>r.context.setupModelViewProjection(),"vec4").once()().toVarying("v_modelViewProjection");class Mce extends Uy{static get type(){return"StorageArrayElementNode"}constructor(e,t){super(e,t),this.isStorageArrayElementNode=!0}set storageBufferNode(e){this.node=e}get storageBufferNode(){return this.node}getMemberType(e,t){const n=this.storageBufferNode.structTypeNode;return n?n.getMemberType(e,t):"void"}setup(e){return e.isAvailable("storageBuffer")===!1&&this.node.isPBO===!0&&e.setupPBO(this.node),super.setup(e)}generate(e,t){let n;const i=e.context.assign;if(e.isAvailable("storageBuffer")===!1?this.node.isPBO===!0&&i!==!0&&(this.node.value.isInstancedBufferAttribute||e.shaderStage!=="compute")?n=e.generatePBO(this):n=this.node.build(e):n=super.generate(e),i!==!0){const s=this.getNodeType(e);n=e.format(n,s,t)}return n}}const Ace=Gn(Mce).setParameterLength(2);class wce extends EB{static get type(){return"StorageBufferNode"}constructor(e,t=null,n=0){let i,s=null;t&&t.isStruct?(i="struct",s=t.layout,(e.isStorageBufferAttribute||e.isStorageInstancedBufferAttribute)&&(n=e.count)):t===null&&(e.isStorageBufferAttribute||e.isStorageInstancedBufferAttribute)?(i=jH(e.itemSize),n=e.count):i=t,super(e,i,n),this.isStorageBufferNode=!0,this.structTypeNode=s,this.access=Fa.READ_WRITE,this.isAtomic=!1,this.isPBO=!1,this._attribute=null,this._varying=null,this.global=!0,e.isStorageBufferAttribute!==!0&&e.isStorageInstancedBufferAttribute!==!0&&(e.isInstancedBufferAttribute?e.isStorageInstancedBufferAttribute=!0:e.isStorageBufferAttribute=!0)}getHash(e){if(this.bufferCount===0){let t=e.globalCache.getData(this.value);return t===void 0&&(t={node:this},e.globalCache.setData(this.value,t)),t.node.uuid}return this.uuid}getInputType(){return this.value.isIndirectStorageBufferAttribute?"indirectStorageBuffer":"storageBuffer"}element(e){return Ace(this,e)}setPBO(e){return this.isPBO=e,this}getPBO(){return this.isPBO}setAccess(e){return this.access=e,this}toReadOnly(){return this.setAccess(Fa.READ_ONLY)}setAtomic(e){return this.isAtomic=e,this}toAtomic(){return this.setAtomic(!0)}getAttributeData(){return this._attribute===null&&(this._attribute=xB(this.value),this._varying=bd(this._attribute)),{attribute:this._attribute,varying:this._varying}}getNodeType(e){if(this.structTypeNode!==null)return this.structTypeNode.getNodeType(e);if(e.isAvailable("storageBuffer")||e.isAvailable("indirectStorageBuffer"))return super.getNodeType(e);const{attribute:t}=this.getAttributeData();return t.getNodeType(e)}getMemberType(e,t){return this.structTypeNode!==null?this.structTypeNode.getMemberType(e,t):"void"}generate(e){if(this.structTypeNode!==null&&this.structTypeNode.build(e),e.isAvailable("storageBuffer")||e.isAvailable("indirectStorageBuffer"))return super.generate(e);const{attribute:t,varying:n}=this.getAttributeData(),i=n.build(e);return e.registerTransform(i,t),i}}const Nh=(r,e=null,t=0)=>new wce(r,e,t),Rce=(r,e,t)=>(Ve('TSL: "storageObject()" is deprecated. Use "storage().setPBO( true )" instead.'),Nh(r,e,t).setPBO(!0));class Ir extends on{static get type(){return"IndexNode"}constructor(e){super("uint"),this.scope=e,this.isIndexNode=!0}generate(e){const t=this.getNodeType(e),n=this.scope;let i;if(n===Ir.VERTEX)i=e.getVertexIndex();else if(n===Ir.INSTANCE)i=e.getInstanceIndex();else if(n===Ir.DRAW)i=e.getDrawIndex();else if(n===Ir.INVOCATION_LOCAL)i=e.getInvocationLocalIndex();else if(n===Ir.INVOCATION_SUBGROUP)i=e.getInvocationSubgroupIndex();else if(n===Ir.SUBGROUP)i=e.getSubgroupIndex();else throw new Error("THREE.IndexNode: Unknown scope: "+n);let s;return e.shaderStage==="vertex"||e.shaderStage==="compute"?s=i:s=bd(this).build(e,t),s}}Ir.VERTEX="vertex";Ir.INSTANCE="instance";Ir.SUBGROUP="subgroup";Ir.INVOCATION_LOCAL="invocationLocal";Ir.INVOCATION_SUBGROUP="invocationSubgroup";Ir.DRAW="draw";const z7=kt(Ir,Ir.VERTEX),fd=kt(Ir,Ir.INSTANCE),Cce=kt(Ir,Ir.SUBGROUP),Nce=kt(Ir,Ir.INVOCATION_SUBGROUP),Dce=kt(Ir,Ir.INVOCATION_LOCAL),V7=kt(Ir,Ir.DRAW);class G7 extends on{static get type(){return"InstanceNode"}constructor(e,t,n=null){super("void"),this.count=e,this.instanceMatrix=t,this.instanceColor=n,this.instanceMatrixNode=null,this.instanceColorNode=null,this.updateType=$n.FRAME,this.buffer=null,this.bufferColor=null}get isStorageMatrix(){const{instanceMatrix:e}=this;return e&&e.isStorageInstancedBufferAttribute===!0}get isStorageColor(){const{instanceColor:e}=this;return e&&e.isStorageInstancedBufferAttribute===!0}setup(e){const{instanceMatrix:t,instanceColor:n,isStorageMatrix:i,isStorageColor:s}=this,{count:a}=t;let{instanceMatrixNode:o,instanceColorNode:l}=this;if(o===null){if(i)o=Nh(t,"mat4",Math.max(a,1)).element(fd);else if(a<=1e3)o=aE(t.array,"mat4",Math.max(a,1)).element(fd);else{const d=new N6(t.array,16,1);this.buffer=d;const p=t.usage===tm?rU:NR,y=[p(d,"vec4",16,0),p(d,"vec4",16,4),p(d,"vec4",16,8),p(d,"vec4",16,12)];o=gm(...y)}this.instanceMatrixNode=o}if(n&&l===null){if(s)l=Nh(n,"vec3",Math.max(n.count,1)).element(fd);else{const d=new ic(n.array,3),p=n.usage===tm?rU:NR;this.bufferColor=d,l=ge(p(d,"vec3",3,0))}this.instanceColorNode=l}const c=o.mul(Yr).xyz;if(Yr.assign(c),e.hasGeometryAttribute("normal")){const d=kW(Vl,o);Vl.assign(d)}this.instanceColorNode!==null&&E1("vec3","vInstanceColor").assign(this.instanceColorNode)}update(){this.buffer!==null&&this.isStorageMatrix!==!0&&(this.buffer.clearUpdateRanges(),this.buffer.updateRanges.push(...this.instanceMatrix.updateRanges),this.instanceMatrix.usage!==tm&&this.instanceMatrix.version!==this.buffer.version&&(this.buffer.version=this.instanceMatrix.version)),this.instanceColor&&this.bufferColor!==null&&this.isStorageColor!==!0&&(this.bufferColor.clearUpdateRanges(),this.bufferColor.updateRanges.push(...this.instanceColor.updateRanges),this.instanceColor.usage!==tm&&this.instanceColor.version!==this.bufferColor.version&&(this.bufferColor.version=this.instanceColor.version))}}const Oce=Gn(G7).setParameterLength(2,3);class Uce extends G7{static get type(){return"InstancedMeshNode"}constructor(e){const{count:t,instanceMatrix:n,instanceColor:i}=e;super(t,n,i),this.instancedMesh=e}}const k7=Gn(Uce).setParameterLength(1);class Lce extends on{static get type(){return"BatchNode"}constructor(e){super("void"),this.batchMesh=e,this.batchingIdNode=null}setup(e){this.batchingIdNode===null&&(e.getDrawIndex()===null?this.batchingIdNode=fd:this.batchingIdNode=V7);const n=Te(([v])=>{const b=de(wh(as(this.batchMesh._indirectTexture),0).x).toConst(),E=de(v).mod(b).toConst(),T=de(v).div(b).toConst();return as(this.batchMesh._indirectTexture,Vs(E,T)).x}).setLayout({name:"getIndirectIndex",type:"uint",inputs:[{name:"id",type:"int"}]})(de(this.batchingIdNode)),i=this.batchMesh._matricesTexture,s=de(wh(as(i),0).x).toConst(),a=re(n).mul(4).toInt().toConst(),o=a.mod(s).toConst(),l=a.div(s).toConst(),c=gm(as(i,Vs(o,l)),as(i,Vs(o.add(1),l)),as(i,Vs(o.add(2),l)),as(i,Vs(o.add(3),l))),d=this.batchMesh._colorsTexture;if(d!==null){const b=Te(([E])=>{const T=de(wh(as(d),0).x).toConst(),M=E,R=M.mod(T).toConst(),N=M.div(T).toConst();return as(d,Vs(R,N)).rgb}).setLayout({name:"getBatchingColor",type:"vec3",inputs:[{name:"id",type:"int"}]})(n);E1("vec3","vBatchColor").assign(b)}const p=Ha(c);Yr.assign(c.mul(Yr));const y=Vl.div(ge(p[0].dot(p[0]),p[1].dot(p[1]),p[2].dot(p[2]))),_=p.mul(y).xyz;Vl.assign(_),e.hasGeometryAttribute("tangent")&&lE.mulAssign(p)}}const H7=Gn(Lce).setParameterLength(1),H4=new WeakMap;class W7 extends on{static get type(){return"SkinningNode"}constructor(e){super("void"),this.skinnedMesh=e,this.updateType=$n.OBJECT,this.skinIndexNode=kh("skinIndex","uvec4"),this.skinWeightNode=kh("skinWeight","vec4"),this.bindMatrixNode=fr("bindMatrix","mat4"),this.bindMatrixInverseNode=fr("bindMatrixInverse","mat4"),this.boneMatricesNode=oU("skeleton.boneMatrices","mat4",e.skeleton.bones.length),this.positionNode=Yr,this.toPositionNode=Yr,this.previousBoneMatricesNode=null}getSkinnedPosition(e=this.boneMatricesNode,t=this.positionNode){const{skinIndexNode:n,skinWeightNode:i,bindMatrixNode:s,bindMatrixInverseNode:a}=this,o=e.element(n.x),l=e.element(n.y),c=e.element(n.z),d=e.element(n.w),p=s.mul(t),y=Ns(o.mul(i.x).mul(p),l.mul(i.y).mul(p),c.mul(i.z).mul(p),d.mul(i.w).mul(p));return a.mul(y).xyz}getSkinnedNormal(e=this.boneMatricesNode,t=Vl){const{skinIndexNode:n,skinWeightNode:i,bindMatrixNode:s,bindMatrixInverseNode:a}=this,o=e.element(n.x),l=e.element(n.y),c=e.element(n.z),d=e.element(n.w);let p=Ns(i.x.mul(o),i.y.mul(l),i.z.mul(c),i.w.mul(d));return p=a.mul(p).mul(s),p.transformDirection(t).xyz}getPreviousSkinnedPosition(e){const t=e.object;return this.previousBoneMatricesNode===null&&(t.skeleton.previousBoneMatrices=new Float32Array(t.skeleton.boneMatrices),this.previousBoneMatricesNode=oU("skeleton.previousBoneMatrices","mat4",t.skeleton.bones.length)),this.getSkinnedPosition(this.previousBoneMatricesNode,DR)}needsPreviousBoneMatrices(e){const t=e.renderer.getMRT();return t&&t.has("velocity")||ZH(e.object).useVelocity===!0}setup(e){this.needsPreviousBoneMatrices(e)&&DR.assign(this.getPreviousSkinnedPosition(e));const t=this.getSkinnedPosition();if(this.toPositionNode&&this.toPositionNode.assign(t),e.hasGeometryAttribute("normal")){const n=this.getSkinnedNormal();Vl.assign(n),e.hasGeometryAttribute("tangent")&&lE.assign(n)}return t}generate(e,t){if(t!=="void")return super.generate(e,t)}update(e){const t=e.object&&e.object.skeleton?e.object.skeleton:this.skinnedMesh.skeleton;H4.get(t)!==e.frameId&&(H4.set(t,e.frameId),this.previousBoneMatricesNode!==null&&(t.previousBoneMatrices===null&&(t.previousBoneMatrices=new Float32Array(t.boneMatrices)),t.previousBoneMatrices.set(t.boneMatrices)),t.update())}}const q7=r=>new W7(r),Pce=(r,e=null)=>{const t=new W7(r);return t.positionNode=Nh(new ic(r.geometry.getAttribute("position").array,3),"vec3").setPBO(!0).toReadOnly().element(fd).toVar(),t.skinIndexNode=Nh(new ic(new Uint32Array(r.geometry.getAttribute("skinIndex").array),4),"uvec4").setPBO(!0).toReadOnly().element(fd).toVar(),t.skinWeightNode=Nh(new ic(r.geometry.getAttribute("skinWeight").array,4),"vec4").setPBO(!0).toReadOnly().element(fd).toVar(),t.bindMatrixNode=_n(r.bindMatrix,"mat4"),t.bindMatrixInverseNode=_n(r.bindMatrixInverse,"mat4"),t.boneMatricesNode=aE(r.skeleton.boneMatrices,"mat4",r.skeleton.bones.length),t.toPositionNode=e,Xt(t)};class Bce extends on{static get type(){return"LoopNode"}constructor(e=[]){super("void"),this.params=e}getVarName(e){return String.fromCharCode(105+e)}getProperties(e){const t=e.getNodeProperties(this);if(t.stackNode!==void 0)return t;const n={};for(let o=0,l=this.params.length-1;o<l;o++){const c=this.params[o],d=c.isNode!==!0&&c.name||this.getVarName(o),p=c.isNode!==!0&&c.type||"int";n[d]=Gh(d,p)}const i=e.addStack(),s=this.params[this.params.length-1](n);t.returnsNode=s.context({nodeLoop:s}),t.stackNode=i;const a=this.params[0];if(a.isNode!==!0&&typeof a.update=="function"){const o=Te(this.params[0].update)(n);t.updateNode=o.context({nodeLoop:o})}return e.removeStack(),t}setup(e){if(this.getProperties(e),e.fnCall){const t=e.getDataFromNode(e.fnCall.shaderNode);t.hasLoop=!0}}generate(e){const t=this.getProperties(e),n=this.params,i=t.stackNode;for(let a=0,o=n.length-1;a<o;a++){const l=n[a];let c=!1,d=null,p=null,y=null,_=null,v=null,b=null;l.isNode?l.getNodeType(e)==="bool"?(c=!0,_="bool",p=l.build(e,_)):(_="int",y=this.getVarName(a),d="0",p=l.build(e,_),v="<"):(_=l.type||"int",y=l.name||this.getVarName(a),d=l.start,p=l.end,v=l.condition,b=l.update,typeof d=="number"?d=e.generateConst(_,d):d&&d.isNode&&(d=d.build(e,_)),typeof p=="number"?p=e.generateConst(_,p):p&&p.isNode&&(p=p.build(e,_)),d!==void 0&&p===void 0?(d=d+" - 1",p="0",v=">="):p!==void 0&&d===void 0&&(d="0",v="<"),v===void 0&&(Number(d)>Number(p)?v=">=":v="<"));let E;if(c)E=`while ( ${p} )`;else{const T={start:d,end:p},M=T.start,R=T.end;let N;const P=()=>v.includes("<")?"+=":"-=";if(b!=null)switch(typeof b){case"function":N=e.flowStagesNode(t.updateNode,"void").code.replace(/\t|;/g,"");break;case"number":N=y+" "+P()+" "+e.generateConst(_,b);break;case"string":N=y+" "+b;break;default:b.isNode?N=y+" "+P()+" "+b.build(e):(Ze("TSL: 'Loop( { update: ... } )' is not a function, string or number."),N="break /* invalid update */")}else _==="int"||_==="uint"?b=v.includes("<")?"++":"--":b=P()+" 1.",N=y+" "+b;const U=e.getVar(_,y)+" = "+M,L=y+" "+v+" "+R;E=`for ( ${U}; ${L}; ${N} )`}e.addFlowCode((a===0?`
`:"")+e.tab+E+` {

`).addFlowTab()}const s=i.build(e,"void");t.returnsNode.build(e,"void"),e.removeFlowTab().addFlowCode(`
`+e.tab+s);for(let a=0,o=this.params.length-1;a<o;a++)e.addFlowCode((a===0?"":e.tab)+`}

`).removeFlowTab();e.addFlowTab()}}const rr=(...r)=>new Bce(B0(r,"int")).toStack(),Ice=()=>Gh("continue").toStack(),X7=()=>Gh("break").toStack(),sD=new WeakMap,tu=new zn,W4=Te(({bufferMap:r,influence:e,stride:t,width:n,depth:i,offset:s})=>{const a=de(z7).mul(t).add(s),o=a.div(n),l=a.sub(o.mul(n));return as(r,Vs(l,o)).depth(i).xyz.mul(e)});function Fce(r){const e=r.morphAttributes.position!==void 0,t=r.morphAttributes.normal!==void 0,n=r.morphAttributes.color!==void 0,i=r.morphAttributes.position||r.morphAttributes.normal||r.morphAttributes.color,s=i!==void 0?i.length:0;let a=sD.get(r);if(a===void 0||a.count!==s){let M=function(){E.dispose(),sD.delete(r),r.removeEventListener("dispose",M)};var o=M;a!==void 0&&a.texture.dispose();const l=r.morphAttributes.position||[],c=r.morphAttributes.normal||[],d=r.morphAttributes.color||[];let p=0;e===!0&&(p=1),t===!0&&(p=2),n===!0&&(p=3);let y=r.attributes.position.count*p,_=1;const v=4096;y>v&&(_=Math.ceil(y/v),y=v);const b=new Float32Array(y*_*4*s),E=new V1(b,y,_,s);E.type=Ci,E.needsUpdate=!0;const T=p*4;for(let R=0;R<s;R++){const N=l[R],P=c[R],U=d[R],L=y*_*4*R;for(let F=0;F<N.count;F++){const O=F*T;e===!0&&(tu.fromBufferAttribute(N,F),b[L+O+0]=tu.x,b[L+O+1]=tu.y,b[L+O+2]=tu.z,b[L+O+3]=0),t===!0&&(tu.fromBufferAttribute(P,F),b[L+O+4]=tu.x,b[L+O+5]=tu.y,b[L+O+6]=tu.z,b[L+O+7]=0),n===!0&&(tu.fromBufferAttribute(U,F),b[L+O+8]=tu.x,b[L+O+9]=tu.y,b[L+O+10]=tu.z,b[L+O+11]=U.itemSize===4?tu.w:1)}}a={count:s,texture:E,stride:p,size:new tt(y,_)},sD.set(r,a),r.addEventListener("dispose",M)}return a}class zce extends on{static get type(){return"MorphNode"}constructor(e){super("void"),this.mesh=e,this.morphBaseInfluence=_n(1),this.updateType=$n.OBJECT}setup(e){const{geometry:t}=e,n=t.morphAttributes.position!==void 0,i=t.hasAttribute("normal")&&t.morphAttributes.normal!==void 0,s=t.morphAttributes.position||t.morphAttributes.normal||t.morphAttributes.color,a=s!==void 0?s.length:0,{texture:o,stride:l,size:c}=Fce(t);n===!0&&Yr.mulAssign(this.morphBaseInfluence),i===!0&&Vl.mulAssign(this.morphBaseInfluence);const d=de(c.width);rr(a,({i:p})=>{const y=re(0).toVar();this.mesh.count>1&&this.mesh.morphTexture!==null&&this.mesh.morphTexture!==void 0?y.assign(as(this.mesh.morphTexture,Vs(de(p).add(1),de(fd))).r):y.assign(fr("morphTargetInfluences","float").element(p).toVar()),Tn(y.notEqual(0),()=>{n===!0&&Yr.addAssign(W4({bufferMap:o,influence:y,stride:l,width:d,depth:p,offset:de(0)})),i===!0&&Vl.addAssign(W4({bufferMap:o,influence:y,stride:l,width:d,depth:p,offset:de(1)}))})})}update(){const e=this.morphBaseInfluence;this.mesh.geometry.morphTargetsRelative?e.value=1:e.value=1-this.mesh.morphTargetInfluences.reduce((t,n)=>t+n,0)}}const $7=Gn(zce).setParameterLength(1);class jx extends on{static get type(){return"LightingNode"}constructor(){super("vec3"),this.isLightingNode=!0}}class Vce extends jx{static get type(){return"AONode"}constructor(e=null){super(),this.aoNode=e}setup(e){e.context.ambientOcclusion.mulAssign(this.aoNode)}}class Gce extends sW{static get type(){return"LightingContextNode"}constructor(e,t=null,n=null,i=null){super(e),this.lightingModel=t,this.backdropNode=n,this.backdropAlphaNode=i,this._value=null}getContext(){const{backdropNode:e,backdropAlphaNode:t}=this,n=ge().toVar("directDiffuse"),i=ge().toVar("directSpecular"),s=ge().toVar("indirectDiffuse"),a=ge().toVar("indirectSpecular"),o={directDiffuse:n,directSpecular:i,indirectDiffuse:s,indirectSpecular:a};return{radiance:ge().toVar("radiance"),irradiance:ge().toVar("irradiance"),iblIrradiance:ge().toVar("iblIrradiance"),ambientOcclusion:re(1).toVar("ambientOcclusion"),reflectedLight:o,backdrop:e,backdropAlpha:t}}setup(e){return this.value=this._value||(this._value=this.getContext()),this.value.lightingModel=this.lightingModel||e.context.lightingModel,super.setup(e)}}const j7=Gn(Gce);class kce extends jx{static get type(){return"IrradianceNode"}constructor(e){super(),this.node=e}setup(e){e.context.irradiance.addAssign(this.node)}}const _v=new tt;class bN extends gd{static get type(){return"ViewportTextureNode"}constructor(e=Rh,t=null,n=null){let i=null;n===null?(i=new NC,i.minFilter=Pa,n=i):i=n,super(n,e,t),this.generateMipmaps=!1,this.defaultFramebuffer=i,this.isOutputTextureNode=!0,this.updateBeforeType=$n.FRAME,this._cacheTextures=new WeakMap}getTextureForReference(e=null){let t,n;if(this.referenceNode?(t=this.referenceNode.defaultFramebuffer,n=this.referenceNode._cacheTextures):(t=this.defaultFramebuffer,n=this._cacheTextures),e===null)return t;if(n.has(e)===!1){const i=t.clone();n.set(e,i)}return n.get(e)}updateReference(e){const t=e.renderer.getRenderTarget();return this.value=this.getTextureForReference(t),this.value}updateBefore(e){const t=e.renderer,n=t.getRenderTarget();n===null?t.getDrawingBufferSize(_v):_v.set(n.width,n.height);const i=this.getTextureForReference(n);(i.image.width!==_v.width||i.image.height!==_v.height)&&(i.image.width=_v.width,i.image.height=_v.height,i.needsUpdate=!0);const s=i.generateMipmaps;i.generateMipmaps=this.generateMipmaps,t.copyFramebufferToTexture(i),i.generateMipmaps=s}clone(){const e=new this.constructor(this.uvNode,this.levelNode,this.value);return e.generateMipmaps=this.generateMipmaps,e}}const Hce=Gn(bN).setParameterLength(0,3),PB=Gn(bN,null,null,{generateMipmaps:!0}).setParameterLength(0,3);let jA=null;class Wce extends bN{static get type(){return"ViewportDepthTextureNode"}constructor(e=Rh,t=null){jA===null&&(jA=new Ga),super(e,t,jA)}getTextureForReference(){return jA}}const BB=Gn(Wce).setParameterLength(0,2);class Ml extends on{static get type(){return"ViewportDepthNode"}constructor(e,t=null){super("float"),this.scope=e,this.valueNode=t,this.isViewportDepthNode=!0}generate(e){const{scope:t}=this;return t===Ml.DEPTH_BASE?e.getFragDepth():super.generate(e)}setup({camera:e}){const{scope:t}=this,n=this.valueNode;let i=null;if(t===Ml.DEPTH_BASE)n!==null&&(i=Z7().assign(n));else if(t===Ml.DEPTH)e.isPerspectiveCamera?i=Y7(xs.z,Qp,Jp):i=Jv(xs.z,Qp,Jp);else if(t===Ml.LINEAR_DEPTH)if(n!==null)if(e.isPerspectiveCamera){const s=IB(n,Qp,Jp);i=Jv(s,Qp,Jp)}else i=n;else i=Jv(xs.z,Qp,Jp);return i}}Ml.DEPTH_BASE="depthBase";Ml.DEPTH="depth";Ml.LINEAR_DEPTH="linearDepth";const Jv=(r,e,t)=>r.add(e).div(e.sub(t)),qce=(r,e,t)=>e.sub(t).mul(r).sub(e),Y7=(r,e,t)=>e.add(r).mul(t).div(t.sub(e).mul(r)),IB=(r,e,t)=>e.mul(t).div(t.sub(e).mul(r).sub(t)),FB=(r,e,t)=>{e=e.max(1e-6).toVar();const n=od(r.negate().div(e)),i=od(t.div(e));return n.div(i)},Xce=(r,e,t)=>{const n=r.mul(uN(t.div(e)));return re(Math.E).pow(n).mul(e).negate()},Z7=Gn(Ml,Ml.DEPTH_BASE),zB=kt(Ml,Ml.DEPTH),OR=Gn(Ml,Ml.LINEAR_DEPTH).setParameterLength(0,1),$ce=OR(BB());zB.assign=r=>Z7(r);class ac extends on{static get type(){return"ClippingNode"}constructor(e=ac.DEFAULT){super(),this.scope=e}setup(e){super.setup(e);const t=e.clippingContext,{intersectionPlanes:n,unionPlanes:i}=t;return this.hardwareClipping=e.material.hardwareClipping,this.scope===ac.ALPHA_TO_COVERAGE?this.setupAlphaToCoverage(n,i):this.scope===ac.HARDWARE?this.setupHardwareClipping(i,e):this.setupDefault(n,i)}setupAlphaToCoverage(e,t){return Te(()=>{const n=re().toVar("distanceToPlane"),i=re().toVar("distanceToGradient"),s=re(1).toVar("clipOpacity"),a=t.length;if(this.hardwareClipping===!1&&a>0){const l=fo(t).setGroup(yn);rr(a,({i:c})=>{const d=l.element(c);n.assign(xs.dot(d.xyz).negate().add(d.w)),i.assign(n.fwidth().div(2)),s.mulAssign(ef(i.negate(),i,n))})}const o=e.length;if(o>0){const l=fo(e).setGroup(yn),c=re(1).toVar("intersectionClipOpacity");rr(o,({i:d})=>{const p=l.element(d);n.assign(xs.dot(p.xyz).negate().add(p.w)),i.assign(n.fwidth().div(2)),c.mulAssign(ef(i.negate(),i,n).oneMinus())}),s.mulAssign(c.oneMinus())}nr.a.mulAssign(s),nr.a.equal(0).discard()})()}setupDefault(e,t){return Te(()=>{const n=t.length;if(this.hardwareClipping===!1&&n>0){const s=fo(t).setGroup(yn);rr(n,({i:a})=>{const o=s.element(a);xs.dot(o.xyz).greaterThan(o.w).discard()})}const i=e.length;if(i>0){const s=fo(e).setGroup(yn),a=lc(!0).toVar("clipped");rr(i,({i:o})=>{const l=s.element(o);a.assign(xs.dot(l.xyz).greaterThan(l.w).and(a))}),a.discard()}})()}setupHardwareClipping(e,t){const n=e.length;return t.enableHardwareClipping(n),Te(()=>{const i=fo(e).setGroup(yn),s=Yh(t.getClipDistance());rr(n,({i:a})=>{const o=i.element(a),l=xs.dot(o.xyz).sub(o.w).negate();s.element(a).assign(l)})})()}}ac.ALPHA_TO_COVERAGE="alphaToCoverage";ac.DEFAULT="default";ac.HARDWARE="hardware";const jce=()=>new ac,Yce=()=>new ac(ac.ALPHA_TO_COVERAGE),Zce=()=>new ac(ac.HARDWARE),Kce=.05,q4=Te(([r])=>Qc(Vn(1e4,Qo(Vn(17,r.x).add(Vn(.1,r.y)))).mul(Ns(.1,Sr(Qo(Vn(13,r.y).add(r.x))))))),X4=Te(([r])=>q4(St(q4(r.xy),r.z))),Qce=Te(([r])=>{const e=Kr(ud(oB(r.xyz)),ud(lB(r.xyz))),t=re(1).div(re(Kce).mul(e)).toVar("pixScale"),n=St(Cx(ld(od(t))),Cx(cN(od(t)))),i=St(X4(ld(n.x.mul(r.xyz))),X4(ld(n.y.mul(r.xyz)))),s=Qc(od(t)),a=Ns(Vn(s.oneMinus(),i.x),Vn(s,i.y)),o=zl(s,s.oneMinus()),l=ge(a.mul(a).div(Vn(2,o).mul(_i(1,o))),a.sub(Vn(.5,o)).div(_i(1,o)),_i(1,_i(1,a).mul(_i(1,a)).div(Vn(2,o).mul(_i(1,o))))),c=a.lessThan(o.oneMinus()).select(a.lessThan(o).select(l.x,l.y),l.z);return Jc(c,1e-6,1)}).setLayout({name:"getAlphaHashThreshold",type:"float",inputs:[{name:"position",type:"vec3"}]});class Jce extends OW{static get type(){return"VertexColorNode"}constructor(e){super(null,"vec4"),this.isVertexColorNode=!0,this.index=e}getAttributeName(){const e=this.index;return"color"+(e>0?e:"")}generate(e){const t=this.getAttributeName(e),n=e.hasGeometryAttribute(t);let i;return n===!0?i=super.generate(e):i=e.generateConst(this.nodeType,new zn(1,1,1,1)),i}serialize(e){super.serialize(e),e.index=this.index}deserialize(e){super.deserialize(e),this.index=e.index}}const K7=(r=0)=>new Jce(r),Q7=Te(([r,e])=>zl(1,r.oneMinus().div(e)).oneMinus()).setLayout({name:"blendBurn",type:"vec3",inputs:[{name:"base",type:"vec3"},{name:"blend",type:"vec3"}]}),J7=Te(([r,e])=>zl(r.div(e.oneMinus()),1)).setLayout({name:"blendDodge",type:"vec3",inputs:[{name:"base",type:"vec3"},{name:"blend",type:"vec3"}]}),eq=Te(([r,e])=>r.oneMinus().mul(e.oneMinus()).oneMinus()).setLayout({name:"blendScreen",type:"vec3",inputs:[{name:"base",type:"vec3"},{name:"blend",type:"vec3"}]}),tq=Te(([r,e])=>yi(r.mul(2).mul(e),r.oneMinus().mul(2).mul(e.oneMinus()).oneMinus(),dN(.5,r))).setLayout({name:"blendOverlay",type:"vec3",inputs:[{name:"base",type:"vec3"},{name:"blend",type:"vec3"}]}),efe=Te(([r,e])=>{const t=e.a.add(r.a.mul(e.a.oneMinus()));return En(e.rgb.mul(e.a).add(r.rgb.mul(r.a).mul(e.a.oneMinus())).div(t),t)}).setLayout({name:"blendColor",type:"vec4",inputs:[{name:"base",type:"vec4"},{name:"blend",type:"vec4"}]}),nq=Te(([r])=>En(r.rgb.mul(r.a),r.a),{color:"vec4",return:"vec4"}),tfe=Te(([r])=>(Tn(r.a.equal(0),()=>En(0)),En(r.rgb.div(r.a),r.a)),{color:"vec4",return:"vec4"}),nfe=(...r)=>(Ve('TSL: "burn" has been renamed. Use "blendBurn" instead.'),Q7(r)),ife=(...r)=>(Ve('TSL: "dodge" has been renamed. Use "blendDodge" instead.'),J7(r)),rfe=(...r)=>(Ve('TSL: "screen" has been renamed. Use "blendScreen" instead.'),eq(r)),sfe=(...r)=>(Ve('TSL: "overlay" has been renamed. Use "blendOverlay" instead.'),tq(r));class ds extends Ta{static get type(){return"NodeMaterial"}get type(){return this.constructor.type}set type(e){}constructor(){super(),this.isNodeMaterial=!0,this.fog=!0,this.lights=!1,this.hardwareClipping=!1,this.lightsNode=null,this.envNode=null,this.aoNode=null,this.colorNode=null,this.normalNode=null,this.opacityNode=null,this.backdropNode=null,this.backdropAlphaNode=null,this.alphaTestNode=null,this.maskNode=null,this.positionNode=null,this.geometryNode=null,this.depthNode=null,this.receivedShadowPositionNode=null,this.castShadowPositionNode=null,this.receivedShadowNode=null,this.castShadowNode=null,this.outputNode=null,this.mrtNode=null,this.fragmentNode=null,this.vertexNode=null,this.contextNode=null,Object.defineProperty(this,"shadowPositionNode",{get:()=>this.receivedShadowPositionNode,set:e=>{Ve('NodeMaterial: ".shadowPositionNode" was renamed to ".receivedShadowPositionNode".'),this.receivedShadowPositionNode=e}})}_getNodeChildren(){const e=[];for(const t of Object.getOwnPropertyNames(this)){if(t.startsWith("_")===!0)continue;const n=this[t];n&&n.isNode===!0&&e.push({property:t,childNode:n})}return e}customProgramCacheKey(){const e=[];for(const{property:t,childNode:n}of this._getNodeChildren())e.push(iE(t.slice(0,-4)),n.getCacheKey());return this.type+Xx(e)}build(e){this.setup(e)}setupObserver(e){return new Mle(e)}setup(e){e.context.setupNormal=()=>Kv(this.setupNormal(e),"NORMAL","vec3"),e.context.setupPositionView=()=>this.setupPositionView(e),e.context.setupModelViewProjection=()=>this.setupModelViewProjection(e);const t=e.renderer,n=t.getRenderTarget();t.contextNode.isContextNode===!0?e.context={...e.context,...t.contextNode.getFlowContextData()}:Ze('NodeMaterial: "renderer.contextNode" must be an instance of `context()`.'),this.contextNode!==null&&(this.contextNode.isContextNode===!0?e.context={...e.context,...this.contextNode.getFlowContextData()}:Ze('NodeMaterial: "material.contextNode" must be an instance of `context()`.')),e.addStack();const i=Kv(this.setupVertex(e),"VERTEX"),s=this.vertexNode||i;e.stack.outputNode=s,this.setupHardwareClipping(e),this.geometryNode!==null&&(e.stack.outputNode=e.stack.outputNode.bypass(this.geometryNode)),e.addFlow("vertex",e.removeStack()),e.addStack();let a;const o=this.setupClipping(e);if((this.depthWrite===!0||this.depthTest===!0)&&(n!==null?n.depthBuffer===!0&&this.setupDepth(e):t.depth===!0&&this.setupDepth(e)),this.fragmentNode===null){this.setupDiffuseColor(e),this.setupVariants(e);const l=this.setupLighting(e);o!==null&&e.stack.addToStack(o);const c=En(l,nr.a).max(0);a=this.setupOutput(e,c),Zv.assign(a);const d=this.outputNode!==null;if(d&&(a=this.outputNode),e.context.getOutput&&(a=e.context.getOutput(a,e)),n!==null){const p=t.getMRT(),y=this.mrtNode;p!==null?(d&&Zv.assign(a),a=p,y!==null&&(a=p.merge(y))):y!==null&&(a=y)}}else{let l=this.fragmentNode;l.isOutputStructNode!==!0&&(l=En(l)),a=this.setupOutput(e,l)}e.stack.outputNode=a,e.addFlow("fragment",e.removeStack()),e.observer=this.setupObserver(e)}setupClipping(e){if(e.clippingContext===null)return null;const{unionPlanes:t,intersectionPlanes:n}=e.clippingContext;let i=null;if(t.length>0||n.length>0){const s=e.renderer.currentSamples;this.alphaToCoverage&&s>1?i=Yce():e.stack.addToStack(jce())}return i}setupHardwareClipping(e){if(this.hardwareClipping=!1,e.clippingContext===null)return;const t=e.clippingContext.unionPlanes.length;t>0&&t<=8&&e.isAvailable("clipDistance")&&(e.stack.addToStack(Zce()),this.hardwareClipping=!0)}setupDepth(e){const{renderer:t,camera:n}=e;let i=this.depthNode;if(i===null){const s=t.getMRT();s&&s.has("depth")?i=s.get("depth"):t.logarithmicDepthBuffer===!0&&(n.isPerspectiveCamera?i=FB(xs.z,Qp,Jp):i=Jv(xs.z,Qp,Jp))}i!==null&&zB.assign(i).toStack()}setupPositionView(){return Hm.mul(Yr).xyz}setupModelViewProjection(){return Ch.mul(xs)}setupVertex(e){return e.addStack(),this.setupPosition(e),e.context.vertex=e.removeStack(),F7}setupPosition(e){const{object:t,geometry:n}=e;if((n.morphAttributes.position||n.morphAttributes.normal||n.morphAttributes.color)&&$7(t).toStack(),t.isSkinnedMesh===!0&&q7(t).toStack(),this.displacementMap){const i=ph("displacementMap","texture"),s=ph("displacementScale","float"),a=ph("displacementBias","float");Yr.addAssign(Vl.normalize().mul(i.x.mul(s).add(a)))}return t.isBatchedMesh&&H7(t).toStack(),t.isInstancedMesh&&t.instanceMatrix&&t.instanceMatrix.isInstancedBufferAttribute===!0&&k7(t).toStack(),this.positionNode!==null&&Yr.assign(Kv(this.positionNode,"POSITION","vec3")),Yr}setupDiffuseColor(e){const{object:t,geometry:n}=e;this.maskNode!==null&&lc(this.maskNode).not().discard();let i=this.colorNode?En(this.colorNode):l7;this.vertexColors===!0&&n.hasAttribute("color")&&(i=i.mul(K7())),t.instanceColor&&(i=E1("vec3","vInstanceColor").mul(i)),t.isBatchedMesh&&t._colorsTexture&&(i=E1("vec3","vBatchColor").mul(i)),nr.assign(i);const s=this.opacityNode?re(this.opacityNode):UB;nr.a.assign(nr.a.mul(s));let a=null;(this.alphaTestNode!==null||this.alphaTest>0)&&(a=this.alphaTestNode!==null?re(this.alphaTestNode):o7,this.alphaToCoverage===!0?(nr.a=ef(a,a.add(cB(nr.a)),nr.a),nr.a.lessThanEqual(0).discard()):nr.a.lessThanEqual(a).discard()),this.alphaHash===!0&&nr.a.lessThan(Qce(Yr)).discard(),e.isOpaque()&&nr.a.assign(1)}setupVariants(){}setupOutgoingLight(){return this.lights===!0?ge(0):nr.rgb}setupNormal(){return this.normalNode?ge(this.normalNode):m7}setupEnvironment(){let e=null;return this.envNode?e=this.envNode:this.envMap&&(e=this.envMap.isCubeTexture?ph("envMap","cubeTexture"):ph("envMap","texture")),e}setupLightMap(e){let t=null;return e.material.lightMap&&(t=new kce(LB)),t}setupLights(e){const t=[],n=this.setupEnvironment(e);n&&n.isLightingNode&&t.push(n);const i=this.setupLightMap(e);i&&i.isLightingNode&&t.push(i);let s=this.aoNode;s===null&&e.material.aoMap&&(s=I7),e.context.getAO&&(s=e.context.getAO(s,e)),s&&t.push(new Vce(s));let a=this.lightsNode||e.lightsNode;return t.length>0&&(a=e.renderer.lighting.createNode([...a.getLights(),...t])),a}setupLightingModel(){}setupLighting(e){const{material:t}=e,{backdropNode:n,backdropAlphaNode:i,emissiveNode:s}=this,o=this.lights===!0||this.lightsNode!==null?this.setupLights(e):null;let l=this.setupOutgoingLight(e);if(o&&o.getScope().hasLights){const c=this.setupLightingModel(e)||null;l=j7(o,c,n,i)}else n!==null&&(l=ge(i!==null?yi(l,n,i):n));return(s&&s.isNode===!0||t.emissive&&t.emissive.isColor===!0)&&(nU.assign(ge(s||c7)),l=l.add(nU)),l}setupFog(e,t){const n=e.fogNode;return n&&(Zv.assign(t),t=En(n.toVar())),t}setupPremultipliedAlpha(e,t){return nq(t)}setupOutput(e,t){return this.fog===!0&&(t=this.setupFog(e,t)),this.premultipliedAlpha===!0&&(t=this.setupPremultipliedAlpha(e,t)),t}setDefaultValues(e){for(const n in e){const i=e[n];this[n]===void 0&&(this[n]=i,i&&i.clone&&(this[n]=i.clone()))}const t=Object.getOwnPropertyDescriptors(e.constructor.prototype);for(const n in t)Object.getOwnPropertyDescriptor(this.constructor.prototype,n)===void 0&&t[n].get!==void 0&&Object.defineProperty(this.constructor.prototype,n,t[n])}toJSON(e){const t=e===void 0||typeof e=="string";t&&(e={textures:{},images:{},nodes:{}});const n=Ta.prototype.toJSON.call(this,e);n.inputNodes={};for(const{property:s,childNode:a}of this._getNodeChildren())n.inputNodes[s]=a.toJSON(e).uuid;function i(s){const a=[];for(const o in s){const l=s[o];delete l.metadata,a.push(l)}return a}if(t){const s=i(e.textures),a=i(e.images),o=i(e.nodes);s.length>0&&(n.textures=s),a.length>0&&(n.images=a),o.length>0&&(n.nodes=o)}return n}copy(e){return this.lightsNode=e.lightsNode,this.envNode=e.envNode,this.aoNode=e.aoNode,this.colorNode=e.colorNode,this.normalNode=e.normalNode,this.opacityNode=e.opacityNode,this.backdropNode=e.backdropNode,this.backdropAlphaNode=e.backdropAlphaNode,this.alphaTestNode=e.alphaTestNode,this.maskNode=e.maskNode,this.positionNode=e.positionNode,this.geometryNode=e.geometryNode,this.depthNode=e.depthNode,this.receivedShadowPositionNode=e.receivedShadowPositionNode,this.castShadowPositionNode=e.castShadowPositionNode,this.receivedShadowNode=e.receivedShadowNode,this.castShadowNode=e.castShadowNode,this.outputNode=e.outputNode,this.mrtNode=e.mrtNode,this.fragmentNode=e.fragmentNode,this.vertexNode=e.vertexNode,this.contextNode=e.contextNode,super.copy(e)}}const afe=new bo;class ofe extends ds{static get type(){return"LineBasicNodeMaterial"}constructor(e){super(),this.isLineBasicNodeMaterial=!0,this.setDefaultValues(afe),this.setValues(e)}}const lfe=new CL;class ufe extends ds{static get type(){return"LineDashedNodeMaterial"}constructor(e){super(),this.isLineDashedNodeMaterial=!0,this.setDefaultValues(lfe),this.dashOffset=0,this.offsetNode=null,this.dashScaleNode=null,this.dashSizeNode=null,this.gapSizeNode=null,this.setValues(e)}setupVariants(){const e=this.offsetNode?re(this.offsetNode):L7,t=this.dashScaleNode?re(this.dashScaleNode):D7,n=this.dashSizeNode?re(this.dashSizeNode):O7,i=this.gapSizeNode?re(this.gapSizeNode):U7;Fw.assign(n),iU.assign(i);const s=bd(kh("lineDistance").mul(t));(e?s.add(e):s).mod(Fw.add(iU)).greaterThan(Fw).discard()}}let YA=null;class cfe extends bN{static get type(){return"ViewportSharedTextureNode"}constructor(e=Rh,t=null){YA===null&&(YA=new NC),super(e,t,YA)}getTextureForReference(){return YA}updateReference(){return this}}const ffe=Gn(cfe).setParameterLength(0,2),dfe=new EL;class hfe extends ds{static get type(){return"MeshNormalNodeMaterial"}constructor(e){super(),this.isMeshNormalNodeMaterial=!0,this.setDefaultValues(dfe),this.setValues(e)}setupDiffuseColor(){const e=this.opacityNode?re(this.opacityNode):UB;nr.assign(pN(En(a7(Ri),e),ea))}}const VB=Te(([r=wB])=>{const e=r.z.atan(r.x).mul(1/(Math.PI*2)).add(.5),t=r.y.clamp(-1,1).asin().mul(1/Math.PI).add(.5);return St(e,t)});class iq extends k1{constructor(e=1,t={}){super(e,t),this.isCubeRenderTarget=!0}fromEquirectangularTexture(e,t){const n=t.minFilter,i=t.generateMipmaps;t.generateMipmaps=!0,this.texture.type=t.type,this.texture.colorSpace=t.colorSpace,this.texture.generateMipmaps=t.generateMipmaps,this.texture.minFilter=t.minFilter,this.texture.magFilter=t.magFilter;const s=new Xh(5,5,5),a=VB(wB),o=new ds;o.colorNode=Li(t,a,0),o.side=gr,o.blending=yo;const l=new ar(s,o),c=new Fm;c.add(l),t.minFilter===Pa&&(t.minFilter=ei);const d=new uL(1,10,this),p=e.getMRT();return e.setMRT(null),d.update(e,c),e.setMRT(p),t.minFilter=n,t.currentGenerateMipmaps=i,l.geometry.dispose(),l.material.dispose(),this}}const ZT=new WeakMap;class pfe extends Qr{static get type(){return"CubeMapNode"}constructor(e){super("vec3"),this.envNode=e,this._cubeTexture=null,this._cubeTextureNode=il(null);const t=new Im;t.isRenderTargetTexture=!0,this._defaultTexture=t,this.updateBeforeType=$n.RENDER}updateBefore(e){const{renderer:t,material:n}=e,i=this.envNode;if(i.isTextureNode||i.isMaterialReferenceNode){const s=i.isTextureNode?i.value:n[i.property];if(s&&s.isTexture){const a=s.mapping;if(a===Lh||a===ym){if(ZT.has(s)){const o=ZT.get(s);$4(o,s.mapping),this._cubeTexture=o}else{const o=s.image;if(mfe(o)){const l=new iq(o.height);l.fromEquirectangularTexture(t,s),$4(l.texture,s.mapping),this._cubeTexture=l.texture,ZT.set(s,l.texture),s.addEventListener("dispose",rq)}else this._cubeTexture=this._defaultTexture}this._cubeTextureNode.value=this._cubeTexture}else this._cubeTextureNode=this.envNode}}}setup(e){return this.updateBefore(e),this._cubeTextureNode}}function mfe(r){return r==null?!1:r.height>0}function rq(r){const e=r.target;e.removeEventListener("dispose",rq);const t=ZT.get(e);t!==void 0&&(ZT.delete(e),t.dispose())}function $4(r,e){e===Lh?r.mapping=ol:e===ym&&(r.mapping=oc)}const sq=Gn(pfe).setParameterLength(1);class GB extends jx{static get type(){return"BasicEnvironmentNode"}constructor(e=null){super(),this.envNode=e}setup(e){e.context.environment=sq(this.envNode)}}class gfe extends jx{static get type(){return"BasicLightMapNode"}constructor(e=null){super(),this.lightMapNode=e}setup(e){const t=re(1/Math.PI);e.context.irradianceLightMap=this.lightMapNode.mul(t)}}class SN{start(e){e.lightsNode.setupLights(e,e.lightsNode.getLightNodes(e)),this.indirect(e)}finish(){}direct(){}directRectArea(){}indirect(){}ambientOcclusion(){}}class aq extends SN{constructor(){super()}indirect({context:e}){const t=e.ambientOcclusion,n=e.reflectedLight,i=e.irradianceLightMap;n.indirectDiffuse.assign(En(0)),i?n.indirectDiffuse.addAssign(i):n.indirectDiffuse.addAssign(En(1,1,1,0)),n.indirectDiffuse.mulAssign(t),n.indirectDiffuse.mulAssign(nr.rgb)}finish(e){const{material:t,context:n}=e,i=n.outgoingLight,s=e.context.environment;if(s)switch(t.combine){case Ix:i.rgb.assign(yi(i.rgb,i.rgb.mul(s.rgb),YT.mul(kw)));break;case QU:i.rgb.assign(yi(i.rgb,s.rgb,YT.mul(kw)));break;case JU:i.rgb.addAssign(s.rgb.mul(YT.mul(kw)));break;default:Ve("BasicLightingModel: Unsupported .combine value:",t.combine);break}}}const yfe=new lo;class _fe extends ds{static get type(){return"MeshBasicNodeMaterial"}constructor(e){super(),this.isMeshBasicNodeMaterial=!0,this.lights=!0,this.setDefaultValues(yfe),this.setValues(e)}setupNormal(){return $x(Nx)}setupEnvironment(e){const t=super.setupEnvironment(e);return t?new GB(t):null}setupLightMap(e){let t=null;return e.material.lightMap&&(t=new gfe(LB)),t}setupOutgoingLight(){return nr.rgb}setupLightingModel(){return new aq}}const Dx=Te(({f0:r,f90:e,dotVH:t})=>{const n=t.mul(-5.55473).sub(6.98316).mul(t).exp2();return r.mul(n.oneMinus()).add(e.mul(n))}),by=Te(r=>r.diffuseColor.mul(1/Math.PI)),vfe=()=>re(.25),xfe=Te(({dotNH:r})=>wR.mul(re(.5)).add(1).mul(re(1/Math.PI)).mul(r.pow(wR))),bfe=Te(({lightDirection:r})=>{const e=r.add(mr).normalize(),t=Ri.dot(e).clamp(),n=mr.dot(e).clamp(),i=Dx({f0:Cm,f90:1,dotVH:n}),s=vfe(),a=xfe({dotNH:t});return i.mul(s).mul(a)});class oq extends aq{constructor(e=!0){super(),this.specular=e}direct({lightDirection:e,lightColor:t,reflectedLight:n}){const s=Ri.dot(e).clamp().mul(t);n.directDiffuse.addAssign(s.mul(by({diffuseColor:nr.rgb}))),this.specular===!0&&n.directSpecular.addAssign(s.mul(bfe({lightDirection:e})).mul(YT))}indirect(e){const{ambientOcclusion:t,irradiance:n,reflectedLight:i}=e.context;i.indirectDiffuse.addAssign(n.mul(by({diffuseColor:nr}))),i.indirectDiffuse.mulAssign(t)}}const Sfe=new ML;class Tfe extends ds{static get type(){return"MeshLambertNodeMaterial"}constructor(e){super(),this.isMeshLambertNodeMaterial=!0,this.lights=!0,this.setDefaultValues(Sfe),this.setValues(e)}setupEnvironment(e){const t=super.setupEnvironment(e);return t?new GB(t):null}setupLightingModel(){return new oq(!1)}}const Efe=new SL;class Mfe extends ds{static get type(){return"MeshPhongNodeMaterial"}constructor(e){super(),this.isMeshPhongNodeMaterial=!0,this.lights=!0,this.shininessNode=null,this.specularNode=null,this.setDefaultValues(Efe),this.setValues(e)}setupEnvironment(e){const t=super.setupEnvironment(e);return t?new GB(t):null}setupLightingModel(){return new oq}setupVariants(){const e=(this.shininessNode?re(this.shininessNode):u7).max(1e-4);wR.assign(e);const t=this.specularNode||f7;Cm.assign(t)}copy(e){return this.shininessNode=e.shininessNode,this.specularNode=e.specularNode,super.copy(e)}}const lq=Te(r=>{if(r.geometry.hasAttribute("normal")===!1)return re(0);const e=Nx.dFdx().abs().max(Nx.dFdy().abs());return e.x.max(e.y).max(e.z)}),kB=Te(r=>{const{roughness:e}=r,t=lq();let n=e.max(.0525);return n=n.add(t),n=n.min(1),n}),uq=Te(({alpha:r,dotNL:e,dotNV:t})=>{const n=r.pow2(),i=e.mul(n.add(n.oneMinus().mul(t.pow2())).sqrt()),s=t.mul(n.add(n.oneMinus().mul(e.pow2())).sqrt());return Su(.5,i.add(s).max(tB))}).setLayout({name:"V_GGX_SmithCorrelated",type:"float",inputs:[{name:"alpha",type:"float"},{name:"dotNL",type:"float"},{name:"dotNV",type:"float"}]}),Afe=Te(({alphaT:r,alphaB:e,dotTV:t,dotBV:n,dotTL:i,dotBL:s,dotNV:a,dotNL:o})=>{const l=o.mul(ge(r.mul(t),e.mul(n),a).length()),c=a.mul(ge(r.mul(i),e.mul(s),o).length());return Su(.5,l.add(c))}).setLayout({name:"V_GGX_SmithCorrelated_Anisotropic",type:"float",inputs:[{name:"alphaT",type:"float",qualifier:"in"},{name:"alphaB",type:"float",qualifier:"in"},{name:"dotTV",type:"float",qualifier:"in"},{name:"dotBV",type:"float",qualifier:"in"},{name:"dotTL",type:"float",qualifier:"in"},{name:"dotBL",type:"float",qualifier:"in"},{name:"dotNV",type:"float",qualifier:"in"},{name:"dotNL",type:"float",qualifier:"in"}]}),cq=Te(({alpha:r,dotNH:e})=>{const t=r.pow2(),n=e.pow2().mul(t.oneMinus()).oneMinus();return t.div(n.pow2()).mul(1/Math.PI)}).setLayout({name:"D_GGX",type:"float",inputs:[{name:"alpha",type:"float"},{name:"dotNH",type:"float"}]}),wfe=re(1/Math.PI),Rfe=Te(({alphaT:r,alphaB:e,dotNH:t,dotTH:n,dotBH:i})=>{const s=r.mul(e),a=ge(e.mul(n),r.mul(i),s.mul(t)),o=a.dot(a),l=s.div(o);return wfe.mul(s.mul(l.pow2()))}).setLayout({name:"D_GGX_Anisotropic",type:"float",inputs:[{name:"alphaT",type:"float",qualifier:"in"},{name:"alphaB",type:"float",qualifier:"in"},{name:"dotNH",type:"float",qualifier:"in"},{name:"dotTH",type:"float",qualifier:"in"},{name:"dotBH",type:"float",qualifier:"in"}]}),HB=Te(({lightDirection:r,f0:e,f90:t,roughness:n,f:i,normalView:s=Ri,USE_IRIDESCENCE:a,USE_ANISOTROPY:o})=>{const l=n.pow2(),c=r.add(mr).normalize(),d=s.dot(r).clamp(),p=s.dot(mr).clamp(),y=s.dot(c).clamp(),_=mr.dot(c).clamp();let v=Dx({f0:e,f90:t,dotVH:_}),b,E;if(S1(a)&&(v=oN.mix(v,i)),S1(o)){const T=$T.dot(r),M=$T.dot(mr),R=$T.dot(c),N=I0.dot(r),P=I0.dot(mr),U=I0.dot(c);b=Afe({alphaT:AR,alphaB:l,dotTV:M,dotBV:P,dotTL:T,dotBL:N,dotNV:p,dotNL:d}),E=Rfe({alphaT:AR,alphaB:l,dotNH:y,dotTH:R,dotBH:U})}else b=uq({alpha:l,dotNL:d,dotNV:p}),E=cq({alpha:l,dotNH:y});return v.mul(b).mul(E)}),Cfe=new Uint16Array([12469,15057,12620,14925,13266,14620,13807,14376,14323,13990,14545,13625,14713,13328,14840,12882,14931,12528,14996,12233,15039,11829,15066,11525,15080,11295,15085,10976,15082,10705,15073,10495,13880,14564,13898,14542,13977,14430,14158,14124,14393,13732,14556,13410,14702,12996,14814,12596,14891,12291,14937,11834,14957,11489,14958,11194,14943,10803,14921,10506,14893,10278,14858,9960,14484,14039,14487,14025,14499,13941,14524,13740,14574,13468,14654,13106,14743,12678,14818,12344,14867,11893,14889,11509,14893,11180,14881,10751,14852,10428,14812,10128,14765,9754,14712,9466,14764,13480,14764,13475,14766,13440,14766,13347,14769,13070,14786,12713,14816,12387,14844,11957,14860,11549,14868,11215,14855,10751,14825,10403,14782,10044,14729,9651,14666,9352,14599,9029,14967,12835,14966,12831,14963,12804,14954,12723,14936,12564,14917,12347,14900,11958,14886,11569,14878,11247,14859,10765,14828,10401,14784,10011,14727,9600,14660,9289,14586,8893,14508,8533,15111,12234,15110,12234,15104,12216,15092,12156,15067,12010,15028,11776,14981,11500,14942,11205,14902,10752,14861,10393,14812,9991,14752,9570,14682,9252,14603,8808,14519,8445,14431,8145,15209,11449,15208,11451,15202,11451,15190,11438,15163,11384,15117,11274,15055,10979,14994,10648,14932,10343,14871,9936,14803,9532,14729,9218,14645,8742,14556,8381,14461,8020,14365,7603,15273,10603,15272,10607,15267,10619,15256,10631,15231,10614,15182,10535,15118,10389,15042,10167,14963,9787,14883,9447,14800,9115,14710,8665,14615,8318,14514,7911,14411,7507,14279,7198,15314,9675,15313,9683,15309,9712,15298,9759,15277,9797,15229,9773,15166,9668,15084,9487,14995,9274,14898,8910,14800,8539,14697,8234,14590,7790,14479,7409,14367,7067,14178,6621,15337,8619,15337,8631,15333,8677,15325,8769,15305,8871,15264,8940,15202,8909,15119,8775,15022,8565,14916,8328,14804,8009,14688,7614,14569,7287,14448,6888,14321,6483,14088,6171,15350,7402,15350,7419,15347,7480,15340,7613,15322,7804,15287,7973,15229,8057,15148,8012,15046,7846,14933,7611,14810,7357,14682,7069,14552,6656,14421,6316,14251,5948,14007,5528,15356,5942,15356,5977,15353,6119,15348,6294,15332,6551,15302,6824,15249,7044,15171,7122,15070,7050,14949,6861,14818,6611,14679,6349,14538,6067,14398,5651,14189,5311,13935,4958,15359,4123,15359,4153,15356,4296,15353,4646,15338,5160,15311,5508,15263,5829,15188,6042,15088,6094,14966,6001,14826,5796,14678,5543,14527,5287,14377,4985,14133,4586,13869,4257,15360,1563,15360,1642,15358,2076,15354,2636,15341,3350,15317,4019,15273,4429,15203,4732,15105,4911,14981,4932,14836,4818,14679,4621,14517,4386,14359,4156,14083,3795,13808,3437,15360,122,15360,137,15358,285,15355,636,15344,1274,15322,2177,15281,2765,15215,3223,15120,3451,14995,3569,14846,3567,14681,3466,14511,3305,14344,3121,14037,2800,13753,2467,15360,0,15360,1,15359,21,15355,89,15346,253,15325,479,15287,796,15225,1148,15133,1492,15008,1749,14856,1882,14685,1886,14506,1783,14324,1608,13996,1398,13702,1183]);let Xf=null;const A1=Te(({roughness:r,dotNV:e})=>{Xf===null&&(Xf=new Ol(Cfe,16,16,po,vi),Xf.name="DFG_LUT",Xf.minFilter=ei,Xf.magFilter=ei,Xf.wrapS=Dr,Xf.wrapT=Dr,Xf.generateMipmaps=!1,Xf.needsUpdate=!0);const t=St(r,e);return Li(Xf,t).rg}),Nfe=Te(({lightDirection:r,f0:e,f90:t,roughness:n,f:i,USE_IRIDESCENCE:s,USE_ANISOTROPY:a})=>{const o=HB({lightDirection:r,f0:e,f90:t,roughness:n,f:i,USE_IRIDESCENCE:s,USE_ANISOTROPY:a}),l=Ri.dot(r).clamp(),c=Ri.dot(mr).clamp(),d=A1({roughness:n,dotNV:c}),p=A1({roughness:n,dotNV:l}),y=e.mul(d.x).add(t.mul(d.y)),_=e.mul(p.x).add(t.mul(p.y)),v=d.x.add(d.y),b=p.x.add(p.y),E=re(1).sub(v),T=re(1).sub(b),M=e.add(e.oneMinus().mul(.047619)),R=y.mul(_).mul(M).div(re(1).sub(E.mul(T).mul(M).mul(M)).add(tB)),N=E.mul(T),P=R.mul(N);return o.add(P)}),fq=Te(r=>{const{dotNV:e,specularColor:t,specularF90:n,roughness:i}=r,s=A1({dotNV:e,roughness:i});return t.mul(s.x).add(n.mul(s.y))}),hU=Te(({f:r,f90:e,dotVH:t})=>{const n=t.oneMinus().saturate(),i=n.mul(n),s=n.mul(i,i).clamp(0,.9999);return r.sub(ge(e).mul(s)).div(s.oneMinus())}).setLayout({name:"Schlick_to_F0",type:"vec3",inputs:[{name:"f",type:"vec3"},{name:"f90",type:"float"},{name:"dotVH",type:"float"}]}),Dfe=Te(({roughness:r,dotNH:e})=>{const t=r.pow2(),n=re(1).div(t),s=e.pow2().oneMinus().max(.0078125);return re(2).add(n).mul(s.pow(n.mul(.5))).div(2*Math.PI)}).setLayout({name:"D_Charlie",type:"float",inputs:[{name:"roughness",type:"float"},{name:"dotNH",type:"float"}]}),Ofe=Te(({dotNV:r,dotNL:e})=>re(1).div(re(4).mul(e.add(r).sub(e.mul(r))))).setLayout({name:"V_Neubelt",type:"float",inputs:[{name:"dotNV",type:"float"},{name:"dotNL",type:"float"}]}),Ufe=Te(({lightDirection:r})=>{const e=r.add(mr).normalize(),t=Ri.dot(r).clamp(),n=Ri.dot(mr).clamp(),i=Ri.dot(e).clamp(),s=Dfe({roughness:Kp,dotNH:i}),a=Ofe({dotNV:n,dotNL:t});return nu.mul(s).mul(a)}),Lfe=Te(({N:r,V:e,roughness:t})=>{const s=.0078125,a=r.dot(e).saturate(),o=St(t,a.oneMinus().sqrt());return o.assign(o.mul(.984375).add(s)),o}).setLayout({name:"LTC_Uv",type:"vec2",inputs:[{name:"N",type:"vec3"},{name:"V",type:"vec3"},{name:"roughness",type:"float"}]}),Pfe=Te(({f:r})=>{const e=r.length();return Kr(e.mul(e).add(r.z).div(e.add(1)),0)}).setLayout({name:"LTC_ClippedSphereFormFactor",type:"float",inputs:[{name:"f",type:"vec3"}]}),ZA=Te(({v1:r,v2:e})=>{const t=r.dot(e),n=t.abs().toVar(),i=n.mul(.0145206).add(.4965155).mul(n).add(.8543985).toVar(),s=n.add(4.1616724).mul(n).add(3.417594).toVar(),a=i.div(s),o=t.greaterThan(0).select(a,Kr(t.mul(t).oneMinus(),1e-7).inverseSqrt().mul(.5).sub(a));return r.cross(e).mul(o)}).setLayout({name:"LTC_EdgeVectorFormFactor",type:"vec3",inputs:[{name:"v1",type:"vec3"},{name:"v2",type:"vec3"}]}),j4=Te(({N:r,V:e,P:t,mInv:n,p0:i,p1:s,p2:a,p3:o})=>{const l=s.sub(i).toVar(),c=o.sub(i).toVar(),d=l.cross(c),p=ge().toVar();return Tn(d.dot(t.sub(i)).greaterThanEqual(0),()=>{const y=e.sub(r.mul(e.dot(r))).normalize(),_=r.cross(y).negate(),v=n.mul(Ha(y,_,r).transpose()).toVar(),b=v.mul(i.sub(t)).normalize().toVar(),E=v.mul(s.sub(t)).normalize().toVar(),T=v.mul(a.sub(t)).normalize().toVar(),M=v.mul(o.sub(t)).normalize().toVar(),R=ge(0).toVar();R.addAssign(ZA({v1:b,v2:E})),R.addAssign(ZA({v1:E,v2:T})),R.addAssign(ZA({v1:T,v2:M})),R.addAssign(ZA({v1:M,v2:b})),p.assign(ge(Pfe({f:R})))}),p}).setLayout({name:"LTC_Evaluate",type:"vec3",inputs:[{name:"N",type:"vec3"},{name:"V",type:"vec3"},{name:"P",type:"vec3"},{name:"mInv",type:"mat3"},{name:"p0",type:"vec3"},{name:"p1",type:"vec3"},{name:"p2",type:"vec3"},{name:"p3",type:"vec3"}]}),TN=1/6,dq=r=>Vn(TN,Vn(r,Vn(r,r.negate().add(3)).sub(3)).add(1)),pU=r=>Vn(TN,Vn(r,Vn(r,Vn(3,r).sub(6))).add(4)),hq=r=>Vn(TN,Vn(r,Vn(r,Vn(-3,r).add(3)).add(3)).add(1)),mU=r=>Vn(TN,Ju(r,3)),Y4=r=>dq(r).add(pU(r)),Z4=r=>hq(r).add(mU(r)),K4=r=>Ns(-1,pU(r).div(dq(r).add(pU(r)))),Q4=r=>Ns(1,mU(r).div(hq(r).add(mU(r)))),J4=(r,e,t)=>{const n=r.uvNode,i=Vn(n,e.zw).add(.5),s=ld(i),a=Qc(i),o=Y4(a.x),l=Z4(a.x),c=K4(a.x),d=Q4(a.x),p=K4(a.y),y=Q4(a.y),_=St(s.x.add(c),s.y.add(p)).sub(.5).mul(e.xy),v=St(s.x.add(d),s.y.add(p)).sub(.5).mul(e.xy),b=St(s.x.add(c),s.y.add(y)).sub(.5).mul(e.xy),E=St(s.x.add(d),s.y.add(y)).sub(.5).mul(e.xy),T=Y4(a.y).mul(Ns(o.mul(r.sample(_).level(t)),l.mul(r.sample(v).level(t)))),M=Z4(a.y).mul(Ns(o.mul(r.sample(b).level(t)),l.mul(r.sample(E).level(t))));return T.add(M)},WB=Te(([r,e])=>{const t=St(r.size(de(e))),n=St(r.size(de(e.add(1)))),i=Su(1,t),s=Su(1,n),a=J4(r,En(i,t),ld(e)),o=J4(r,En(s,n),cN(e));return Qc(e).mix(a,o)}),Bfe=Te(([r,e])=>{const t=e.mul(SB(r));return WB(r,t)}),eG=Te(([r,e,t,n,i])=>{const s=ge(pB(e.negate(),al(r),Su(1,n))),a=ge(ud(i[0].xyz),ud(i[1].xyz),ud(i[2].xyz));return al(s).mul(t.mul(a))}).setLayout({name:"getVolumeTransmissionRay",type:"vec3",inputs:[{name:"n",type:"vec3"},{name:"v",type:"vec3"},{name:"thickness",type:"float"},{name:"ior",type:"float"},{name:"modelMatrix",type:"mat4"}]}),Ife=Te(([r,e])=>r.mul(Jc(e.mul(2).sub(2),0,1))).setLayout({name:"applyIorToRoughness",type:"float",inputs:[{name:"roughness",type:"float"},{name:"ior",type:"float"}]}),Ffe=PB(),zfe=PB(),tG=Te(([r,e,t],{material:n})=>{const s=(n.side===gr?Ffe:zfe).sample(r),a=od(xy.x).mul(Ife(e,t));return WB(s,a)}),nG=Te(([r,e,t])=>(Tn(t.notEqual(0),()=>{const n=uN(e).negate().div(t);return nB(n.negate().mul(r))}),ge(1))).setLayout({name:"volumeAttenuation",type:"vec3",inputs:[{name:"transmissionDistance",type:"float"},{name:"attenuationColor",type:"vec3"},{name:"attenuationDistance",type:"float"}]}),Vfe=Te(([r,e,t,n,i,s,a,o,l,c,d,p,y,_,v])=>{let b,E;if(v){b=En().toVar(),E=ge().toVar();const P=d.sub(1).mul(v.mul(.025)),U=ge(d.sub(P),d,d.add(P));rr({start:0,end:3},({i:L})=>{const F=U.element(L),O=eG(r,e,p,F,o),B=a.add(O),q=c.mul(l.mul(En(B,1))),j=St(q.xy.div(q.w)).toVar();j.addAssign(1),j.divAssign(2),j.assign(St(j.x,j.y.oneMinus()));const Q=tG(j,t,F);b.element(L).assign(Q.element(L)),b.a.addAssign(Q.a),E.element(L).assign(n.element(L).mul(nG(ud(O),y,_).element(L)))}),b.a.divAssign(3)}else{const P=eG(r,e,p,d,o),U=a.add(P),L=c.mul(l.mul(En(U,1))),F=St(L.xy.div(L.w)).toVar();F.addAssign(1),F.divAssign(2),F.assign(St(F.x,F.y.oneMinus())),b=tG(F,t,d),E=n.mul(nG(ud(P),y,_))}const T=E.rgb.mul(b.rgb),M=r.dot(e).clamp(),R=ge(fq({dotNV:M,specularColor:i,specularF90:s,roughness:t})),N=E.r.add(E.g,E.b).div(3);return En(R.oneMinus().mul(T),b.a.oneMinus().mul(N).oneMinus())}),Gfe=Ha(3.2404542,-.969266,.0556434,-1.5371385,1.8760108,-.2040259,-.4985314,.041556,1.0572252),kfe=r=>{const e=r.sqrt();return ge(1).add(e).div(ge(1).sub(e))},iG=(r,e)=>r.sub(e).div(r.add(e)).pow2(),Hfe=(r,e)=>{const t=r.mul(2*Math.PI*1e-9),n=ge(54856e-17,44201e-17,52481e-17),i=ge(1681e3,1795300,2208400),s=ge(43278e5,93046e5,66121e5),a=re(9747e-17*Math.sqrt(2*Math.PI*45282e5)).mul(t.mul(2239900).add(e.x).cos()).mul(t.pow2().mul(-45282e5).exp());let o=n.mul(s.mul(2*Math.PI).sqrt()).mul(i.mul(t).add(e).cos()).mul(t.pow2().negate().mul(s).exp());return o=ge(o.x.add(a),o.y,o.z).div(10685e-11),Gfe.mul(o)},rG=Te(({outsideIOR:r,eta2:e,cosTheta1:t,thinFilmThickness:n,baseF0:i})=>{const s=yi(r,e,ef(0,.03,n)),o=r.div(s).pow2().mul(t.pow2().oneMinus()).oneMinus();Tn(o.lessThan(0),()=>ge(1));const l=o.sqrt(),c=iG(s,r),d=Dx({f0:c,f90:1,dotVH:t}),p=d.oneMinus(),y=s.lessThan(r).select(Math.PI,0),_=re(Math.PI).sub(y),v=kfe(i.clamp(0,.9999)),b=iG(v,s.toVec3()),E=Dx({f0:b,f90:1,dotVH:l}),T=ge(v.x.lessThan(s).select(Math.PI,0),v.y.lessThan(s).select(Math.PI,0),v.z.lessThan(s).select(Math.PI,0)),M=s.mul(n,l,2),R=ge(_).add(T),N=d.mul(E).clamp(1e-5,.9999),P=N.sqrt(),U=p.pow2().mul(E).div(ge(1).sub(N)),F=d.add(U).toVar(),O=U.sub(p).toVar();return rr({start:1,end:2,condition:"<=",name:"m"},({m:B})=>{O.mulAssign(P);const q=Hfe(re(B).mul(M),re(B).mul(R)).mul(2);F.addAssign(O.mul(q))}),F.max(ge(0))}).setLayout({name:"evalIridescence",type:"vec3",inputs:[{name:"outsideIOR",type:"float"},{name:"eta2",type:"float"},{name:"cosTheta1",type:"float"},{name:"thinFilmThickness",type:"float"},{name:"baseF0",type:"vec3"}]}),jS=Te(({normal:r,viewDir:e,roughness:t})=>{const n=r.dot(e).saturate(),i=t.mul(t),s=t.add(.1).reciprocal(),a=re(-1.9362).add(t.mul(1.0678)).add(i.mul(.4573)).sub(s.mul(.8469)),o=re(-.6014).add(t.mul(.5538)).sub(i.mul(.467)).sub(s.mul(.1255));return a.mul(n).add(o).exp().saturate()}),aD=ge(.04),oD=re(1);class pq extends SN{constructor(e=!1,t=!1,n=!1,i=!1,s=!1,a=!1){super(),this.clearcoat=e,this.sheen=t,this.iridescence=n,this.anisotropy=i,this.transmission=s,this.dispersion=a,this.clearcoatRadiance=null,this.clearcoatSpecularDirect=null,this.clearcoatSpecularIndirect=null,this.sheenSpecularDirect=null,this.sheenSpecularIndirect=null,this.iridescenceFresnel=null,this.iridescenceF0=null,this.iridescenceF0Dielectric=null,this.iridescenceF0Metallic=null}start(e){if(this.clearcoat===!0&&(this.clearcoatRadiance=ge().toVar("clearcoatRadiance"),this.clearcoatSpecularDirect=ge().toVar("clearcoatSpecularDirect"),this.clearcoatSpecularIndirect=ge().toVar("clearcoatSpecularIndirect")),this.sheen===!0&&(this.sheenSpecularDirect=ge().toVar("sheenSpecularDirect"),this.sheenSpecularIndirect=ge().toVar("sheenSpecularIndirect")),this.iridescence===!0){const t=Ri.dot(mr).clamp(),n=rG({outsideIOR:re(1),eta2:ER,cosTheta1:t,thinFilmThickness:MR,baseF0:Cm}),i=rG({outsideIOR:re(1),eta2:ER,cosTheta1:t,thinFilmThickness:MR,baseF0:nr.rgb});this.iridescenceFresnel=yi(n,i,yh),this.iridescenceF0Dielectric=hU({f:n,f90:1,dotVH:t}),this.iridescenceF0Metallic=hU({f:i,f90:1,dotVH:t}),this.iridescenceF0=yi(this.iridescenceF0Dielectric,this.iridescenceF0Metallic,yh)}if(this.transmission===!0){const t=cd,n=PW.sub(cd).normalize(),i=Wm,s=e.context;s.backdrop=Vfe(i,n,td,c0,x0,Yv,t,ec,hc,Ch,jT,jP,ZP,YP,this.dispersion?KP:null),s.backdropAlpha=RR,nr.a.mulAssign(yi(1,s.backdrop.a,RR))}super.start(e)}computeMultiscattering(e,t,n,i,s=null){const a=Ri.dot(mr).clamp(),o=A1({roughness:td,dotNV:a}),l=s?oN.mix(i,s):i,c=l.mul(o.x).add(n.mul(o.y)),p=o.x.add(o.y).oneMinus(),y=l.add(l.oneMinus().mul(.047619)),_=c.mul(y).div(p.mul(y).oneMinus());e.addAssign(c),t.addAssign(_.mul(p))}direct({lightDirection:e,lightColor:t,reflectedLight:n}){const s=Ri.dot(e).clamp().mul(t).toVar();if(this.sheen===!0){this.sheenSpecularDirect.addAssign(s.mul(Ufe({lightDirection:e})));const a=jS({normal:Ri,viewDir:mr,roughness:Kp}),o=jS({normal:Ri,viewDir:e,roughness:Kp}),l=nu.r.max(nu.g).max(nu.b).mul(a.max(o)).oneMinus();s.mulAssign(l)}if(this.clearcoat===!0){const o=b0.dot(e).clamp().mul(t);this.clearcoatSpecularDirect.addAssign(o.mul(HB({lightDirection:e,f0:aD,f90:oD,roughness:M1,normalView:b0})))}n.directDiffuse.addAssign(s.mul(by({diffuseColor:c0}))),n.directSpecular.addAssign(s.mul(Nfe({lightDirection:e,f0:x0,f90:1,roughness:td,f:this.iridescenceFresnel,USE_IRIDESCENCE:this.iridescence,USE_ANISOTROPY:this.anisotropy})))}directRectArea({lightColor:e,lightPosition:t,halfWidth:n,halfHeight:i,reflectedLight:s,ltc_1:a,ltc_2:o}){const l=t.add(n).sub(i),c=t.sub(n).sub(i),d=t.sub(n).add(i),p=t.add(n).add(i),y=Ri,_=mr,v=xs.toVar(),b=Lfe({N:y,V:_,roughness:td}),E=a.sample(b).toVar(),T=o.sample(b).toVar(),M=Ha(ge(E.x,0,E.y),ge(0,1,0),ge(E.z,0,E.w)).toVar(),R=x0.mul(T.x).add(x0.oneMinus().mul(T.y)).toVar();s.directSpecular.addAssign(e.mul(R).mul(j4({N:y,V:_,P:v,mInv:M,p0:l,p1:c,p2:d,p3:p}))),s.directDiffuse.addAssign(e.mul(c0).mul(j4({N:y,V:_,P:v,mInv:Ha(1,0,0,0,1,0,0,0,1),p0:l,p1:c,p2:d,p3:p})))}indirect(e){this.indirectDiffuse(e),this.indirectSpecular(e),this.ambientOcclusion(e)}indirectDiffuse(e){const{irradiance:t,reflectedLight:n}=e.context,i=t.mul(by({diffuseColor:c0})).toVar();if(this.sheen===!0){const s=jS({normal:Ri,viewDir:mr,roughness:Kp}),a=nu.r.max(nu.g).max(nu.b).mul(s).oneMinus();i.mulAssign(a)}n.indirectDiffuse.addAssign(i)}indirectSpecular(e){const{radiance:t,iblIrradiance:n,reflectedLight:i}=e.context;if(this.sheen===!0&&this.sheenSpecularIndirect.addAssign(n.mul(nu,jS({normal:Ri,viewDir:mr,roughness:Kp}))),this.clearcoat===!0){const E=b0.dot(mr).clamp(),T=fq({dotNV:E,specularColor:aD,specularF90:oD,roughness:M1});this.clearcoatSpecularIndirect.addAssign(this.clearcoatRadiance.mul(T))}const s=ge().toVar("singleScatteringDielectric"),a=ge().toVar("multiScatteringDielectric"),o=ge().toVar("singleScatteringMetallic"),l=ge().toVar("multiScatteringMetallic");this.computeMultiscattering(s,a,Yv,Cm,this.iridescenceF0Dielectric),this.computeMultiscattering(o,l,Yv,nr.rgb,this.iridescenceF0Metallic);const c=yi(s,o,yh),d=yi(a,l,yh),p=s.add(a),y=c0.mul(p.oneMinus()),_=n.mul(1/Math.PI),v=t.mul(c).add(d.mul(_)).toVar(),b=y.mul(_).toVar();if(this.sheen===!0){const E=jS({normal:Ri,viewDir:mr,roughness:Kp}),T=nu.r.max(nu.g).max(nu.b).mul(E).oneMinus();v.mulAssign(T),b.mulAssign(T)}i.indirectSpecular.addAssign(v),i.indirectDiffuse.addAssign(b)}ambientOcclusion(e){const{ambientOcclusion:t,reflectedLight:n}=e.context,s=Ri.dot(mr).clamp().add(t),a=td.mul(-16).oneMinus().negate().exp2(),o=t.sub(s.pow(a).oneMinus()).clamp();this.clearcoat===!0&&this.clearcoatSpecularIndirect.mulAssign(t),this.sheen===!0&&this.sheenSpecularIndirect.mulAssign(t),n.indirectDiffuse.mulAssign(t),n.indirectSpecular.mulAssign(o)}finish({context:e}){const{outgoingLight:t}=e;if(this.clearcoat===!0){const n=b0.dot(mr).clamp(),i=Dx({dotVH:n,f0:aD,f90:oD}),s=t.mul(TR.mul(i).oneMinus()).add(this.clearcoatSpecularDirect.add(this.clearcoatSpecularIndirect).mul(TR));t.assign(s)}if(this.sheen===!0){const n=t.add(this.sheenSpecularDirect,this.sheenSpecularIndirect.mul(1/Math.PI));t.assign(n)}}}const sG=re(1),gU=re(-2),KA=re(.8),lD=re(-1),QA=re(.4),uD=re(2),JA=re(.305),cD=re(3),aG=re(.21),Wfe=re(4),oG=re(4),qfe=re(16),Xfe=Te(([r])=>{const e=ge(Sr(r)).toVar(),t=re(-1).toVar();return Tn(e.x.greaterThan(e.z),()=>{Tn(e.x.greaterThan(e.y),()=>{t.assign(za(r.x.greaterThan(0),0,3))}).Else(()=>{t.assign(za(r.y.greaterThan(0),1,4))})}).Else(()=>{Tn(e.z.greaterThan(e.y),()=>{t.assign(za(r.z.greaterThan(0),2,5))}).Else(()=>{t.assign(za(r.y.greaterThan(0),1,4))})}),t}).setLayout({name:"getFace",type:"float",inputs:[{name:"direction",type:"vec3"}]}),$fe=Te(([r,e])=>{const t=St().toVar();return Tn(e.equal(0),()=>{t.assign(St(r.z,r.y).div(Sr(r.x)))}).ElseIf(e.equal(1),()=>{t.assign(St(r.x.negate(),r.z.negate()).div(Sr(r.y)))}).ElseIf(e.equal(2),()=>{t.assign(St(r.x.negate(),r.y).div(Sr(r.z)))}).ElseIf(e.equal(3),()=>{t.assign(St(r.z.negate(),r.y).div(Sr(r.x)))}).ElseIf(e.equal(4),()=>{t.assign(St(r.x.negate(),r.z).div(Sr(r.y)))}).Else(()=>{t.assign(St(r.x,r.y).div(Sr(r.z)))}),Vn(.5,t.add(1))}).setLayout({name:"getUV",type:"vec2",inputs:[{name:"direction",type:"vec3"},{name:"face",type:"float"}]}),jfe=Te(([r])=>{const e=re(0).toVar();return Tn(r.greaterThanEqual(KA),()=>{e.assign(sG.sub(r).mul(lD.sub(gU)).div(sG.sub(KA)).add(gU))}).ElseIf(r.greaterThanEqual(QA),()=>{e.assign(KA.sub(r).mul(uD.sub(lD)).div(KA.sub(QA)).add(lD))}).ElseIf(r.greaterThanEqual(JA),()=>{e.assign(QA.sub(r).mul(cD.sub(uD)).div(QA.sub(JA)).add(uD))}).ElseIf(r.greaterThanEqual(aG),()=>{e.assign(JA.sub(r).mul(Wfe.sub(cD)).div(JA.sub(aG)).add(cD))}).Else(()=>{e.assign(re(-2).mul(od(Vn(1.16,r))))}),e}).setLayout({name:"roughnessToMip",type:"float",inputs:[{name:"roughness",type:"float"}]}),mq=Te(([r,e])=>{const t=r.toVar();t.assign(Vn(2,t).sub(1));const n=ge(t,1).toVar();return Tn(e.equal(0),()=>{n.assign(n.zyx)}).ElseIf(e.equal(1),()=>{n.assign(n.xzy),n.xz.mulAssign(-1)}).ElseIf(e.equal(2),()=>{n.x.mulAssign(-1)}).ElseIf(e.equal(3),()=>{n.assign(n.zyx),n.xz.mulAssign(-1)}).ElseIf(e.equal(4),()=>{n.assign(n.xzy),n.xy.mulAssign(-1)}).ElseIf(e.equal(5),()=>{n.z.mulAssign(-1)}),n}).setLayout({name:"getDirection",type:"vec3",inputs:[{name:"uv",type:"vec2"},{name:"face",type:"float"}]}),gq=Te(([r,e,t,n,i,s])=>{const a=re(t),o=ge(e),l=Jc(jfe(a),gU,s),c=Qc(l),d=ld(l),p=ge(w1(r,o,d,n,i,s)).toVar();return Tn(c.notEqual(0),()=>{const y=ge(w1(r,o,d.add(1),n,i,s)).toVar();p.assign(yi(p,y,c))}),p}),w1=Te(([r,e,t,n,i,s])=>{const a=re(t).toVar(),o=ge(e),l=re(Xfe(o)).toVar(),c=re(Kr(oG.sub(a),0)).toVar();a.assign(Kr(a,oG));const d=re(Cx(a)).toVar(),p=St($fe(o,l).mul(d.sub(2)).add(1)).toVar();return Tn(l.greaterThan(2),()=>{p.y.addAssign(d),l.subAssign(3)}),p.x.addAssign(l.mul(d)),p.x.addAssign(c.mul(Vn(3,qfe))),p.y.addAssign(Vn(4,Cx(s).sub(d))),p.x.mulAssign(n),p.y.mulAssign(i),r.sample(p).grad(St(),St())}),fD=Te(({envMap:r,mipInt:e,outputDirection:t,theta:n,axis:i,CUBEUV_TEXEL_WIDTH:s,CUBEUV_TEXEL_HEIGHT:a,CUBEUV_MAX_MIP:o})=>{const l=qc(n),c=t.mul(l).add(i.cross(t).mul(Qo(n))).add(i.mul(i.dot(t).mul(l.oneMinus())));return w1(r,c,e,s,a,o)}),yq=Te(({n:r,latitudinal:e,poleAxis:t,outputDirection:n,weights:i,samples:s,dTheta:a,mipInt:o,envMap:l,CUBEUV_TEXEL_WIDTH:c,CUBEUV_TEXEL_HEIGHT:d,CUBEUV_MAX_MIP:p})=>{const y=ge(za(e,t,Vh(t,n))).toVar();Tn(y.equal(ge(0)),()=>{y.assign(ge(n.z,0,n.x.negate()))}),y.assign(al(y));const _=ge().toVar();return _.addAssign(i.element(0).mul(fD({theta:0,axis:y,outputDirection:n,mipInt:o,envMap:l,CUBEUV_TEXEL_WIDTH:c,CUBEUV_TEXEL_HEIGHT:d,CUBEUV_MAX_MIP:p}))),rr({start:de(1),end:r},({i:v})=>{Tn(v.greaterThanEqual(s),()=>{X7()});const b=re(a.mul(re(v))).toVar();_.addAssign(i.element(v).mul(fD({theta:b.mul(-1),axis:y,outputDirection:n,mipInt:o,envMap:l,CUBEUV_TEXEL_WIDTH:c,CUBEUV_TEXEL_HEIGHT:d,CUBEUV_MAX_MIP:p}))),_.addAssign(i.element(v).mul(fD({theta:b,axis:y,outputDirection:n,mipInt:o,envMap:l,CUBEUV_TEXEL_WIDTH:c,CUBEUV_TEXEL_HEIGHT:d,CUBEUV_MAX_MIP:p})))}),En(_,1)}),Yfe=Te(([r])=>{const e=vt(r).toVar();return e.assign(e.shiftLeft(vt(16)).bitOr(e.shiftRight(vt(16)))),e.assign(e.bitAnd(vt(1431655765)).shiftLeft(vt(1)).bitOr(e.bitAnd(vt(2863311530)).shiftRight(vt(1)))),e.assign(e.bitAnd(vt(858993459)).shiftLeft(vt(2)).bitOr(e.bitAnd(vt(3435973836)).shiftRight(vt(2)))),e.assign(e.bitAnd(vt(252645135)).shiftLeft(vt(4)).bitOr(e.bitAnd(vt(4042322160)).shiftRight(vt(4)))),e.assign(e.bitAnd(vt(16711935)).shiftLeft(vt(8)).bitOr(e.bitAnd(vt(4278255360)).shiftRight(vt(8)))),re(e).mul(23283064365386963e-26)}),Zfe=Te(([r,e])=>St(re(r).div(re(e)),Yfe(r))),Kfe=Te(([r,e,t])=>{const n=ge(e).toVar(),i=re(t),s=i.mul(i).toVar(),a=al(ge(s.mul(n.x),s.mul(n.y),n.z)).toVar(),o=a.x.mul(a.x).add(a.y.mul(a.y)),l=za(o.greaterThan(0),ge(a.y.negate(),a.x,0).div(go(o)),ge(1,0,0)).toVar(),c=Vh(a,l).toVar(),d=go(r.x),p=Vn(2,3.14159265359).mul(r.y),y=d.mul(qc(p)).toVar(),_=d.mul(Qo(p)).toVar(),v=Vn(.5,a.z.add(1));_.assign(v.oneMinus().mul(go(y.mul(y).oneMinus())).add(v.mul(_)));const b=l.mul(y).add(c.mul(_)).add(a.mul(go(Kr(0,y.mul(y).add(_.mul(_)).oneMinus()))));return al(ge(s.mul(b.x),s.mul(b.y),Kr(0,b.z)))}),_q=Te(({roughness:r,mipInt:e,envMap:t,N_immutable:n,GGX_SAMPLES:i,CUBEUV_TEXEL_WIDTH:s,CUBEUV_TEXEL_HEIGHT:a,CUBEUV_MAX_MIP:o})=>{const l=ge(n).toVar(),c=ge(0).toVar(),d=re(0).toVar();return Tn(r.lessThan(.001),()=>{c.assign(w1(t,l,e,s,a,o))}).Else(()=>{const p=za(Sr(l.z).lessThan(.999),ge(0,0,1),ge(1,0,0)),y=al(Vh(p,l)).toVar(),_=Vh(l,y).toVar();rr({start:vt(0),end:i},({i:v})=>{const b=Zfe(v,i),E=Kfe(b,ge(0,0,1),r),T=al(y.mul(E.x).add(_.mul(E.y)).add(l.mul(E.z))),M=al(T.mul(uc(l,T).mul(2)).sub(l)),R=Kr(uc(l,M),0);Tn(R.greaterThan(0),()=>{const N=w1(t,M,e,s,a,o);c.addAssign(N.mul(R)),d.addAssign(R)})}),Tn(d.greaterThan(0),()=>{c.assign(c.div(d))})}),En(c,1)}),fm=4,lG=[.125,.215,.35,.446,.526,.582],f0=20,Qfe=512,YS=new rc(-1,1,1,-1,0,1),Jfe=new Br(90,1),uG=new Kt;let dD=null,hD=0,pD=0;const ede=new ne,UR=new WeakMap,tde=[3,1,5,0,4,2],mD=mq(hr(),kh("faceIndex")).normalize(),EN=ge(mD.x,mD.y,mD.z);class nde{constructor(e){this._renderer=e,this._pingPongRenderTarget=null,this._lodMax=0,this._cubeSize=0,this._sizeLods=[],this._sigmas=[],this._lodMeshes=[],this._blurMaterial=null,this._ggxMaterial=null,this._cubemapMaterial=null,this._equirectMaterial=null,this._backgroundBox=null}get _hasInitialized(){return this._renderer.hasInitialized()}fromScene(e,t=0,n=.1,i=100,s={}){const{size:a=256,position:o=ede,renderTarget:l=null}=s;if(this._setSize(a),this._hasInitialized===!1){Ve('PMREMGenerator: ".fromScene()" called before the backend is initialized. Try using "await renderer.init()" instead.');const d=l||this._allocateTarget();return s.renderTarget=d,this.fromSceneAsync(e,t,n,i,s),d}dD=this._renderer.getRenderTarget(),hD=this._renderer.getActiveCubeFace(),pD=this._renderer.getActiveMipmapLevel();const c=l||this._allocateTarget();return c.depthBuffer=!0,this._init(c),this._sceneToCubeUV(e,n,i,c,o),t>0&&this._blur(c,0,0,t),this._applyPMREM(c),this._cleanup(c),c}async fromSceneAsync(e,t=0,n=.1,i=100,s={}){return cr('PMREMGenerator: ".fromSceneAsync()" is deprecated. Use "await renderer.init()" instead.'),await this._renderer.init(),this.fromScene(e,t,n,i,s)}fromEquirectangular(e,t=null){if(this._hasInitialized===!1){Ve('PMREMGenerator: .fromEquirectangular() called before the backend is initialized. Try using "await renderer.init()" instead.'),this._setSizeFromTexture(e);const n=t||this._allocateTarget();return this.fromEquirectangularAsync(e,n),n}return this._fromTexture(e,t)}async fromEquirectangularAsync(e,t=null){return cr('PMREMGenerator: ".fromEquirectangularAsync()" is deprecated. Use "await renderer.init()" instead.'),await this._renderer.init(),this._fromTexture(e,t)}fromCubemap(e,t=null){if(this._hasInitialized===!1){Ve("PMREMGenerator: .fromCubemap() called before the backend is initialized. Try using .fromCubemapAsync() instead."),this._setSizeFromTexture(e);const n=t||this._allocateTarget();return this.fromCubemapAsync(e,t),n}return this._fromTexture(e,t)}async fromCubemapAsync(e,t=null){return cr('PMREMGenerator: ".fromCubemapAsync()" is deprecated. Use "await renderer.init()" instead.'),await this._renderer.init(),this._fromTexture(e,t)}async compileCubemapShader(){this._cubemapMaterial===null&&(this._cubemapMaterial=fG(),await this._compileMaterial(this._cubemapMaterial))}async compileEquirectangularShader(){this._equirectMaterial===null&&(this._equirectMaterial=dG(),await this._compileMaterial(this._equirectMaterial))}dispose(){this._dispose(),this._cubemapMaterial!==null&&this._cubemapMaterial.dispose(),this._equirectMaterial!==null&&this._equirectMaterial.dispose(),this._backgroundBox!==null&&(this._backgroundBox.geometry.dispose(),this._backgroundBox.material.dispose())}_setSizeFromTexture(e){e.mapping===ol||e.mapping===oc?this._setSize(e.image.length===0?16:e.image[0].width||e.image[0].image.width):this._setSize(e.image.width/4)}_setSize(e){this._lodMax=Math.floor(Math.log2(e)),this._cubeSize=Math.pow(2,this._lodMax)}_dispose(){this._blurMaterial!==null&&this._blurMaterial.dispose(),this._ggxMaterial!==null&&this._ggxMaterial.dispose(),this._pingPongRenderTarget!==null&&this._pingPongRenderTarget.dispose();for(let e=0;e<this._lodMeshes.length;e++)this._lodMeshes[e].geometry.dispose()}_cleanup(e){this._renderer.setRenderTarget(dD,hD,pD),e.scissorTest=!1,vv(e,0,0,e.width,e.height)}_fromTexture(e,t){this._setSizeFromTexture(e),dD=this._renderer.getRenderTarget(),hD=this._renderer.getActiveCubeFace(),pD=this._renderer.getActiveMipmapLevel();const n=t||this._allocateTarget();return this._init(n),this._textureToCubeUV(e,n),this._applyPMREM(n),this._cleanup(n),n}_allocateTarget(){const e=3*Math.max(this._cubeSize,112),t=4*this._cubeSize;return cG(e,t)}_init(e){if(this._pingPongRenderTarget===null||this._pingPongRenderTarget.width!==e.width||this._pingPongRenderTarget.height!==e.height){this._pingPongRenderTarget!==null&&this._dispose(),this._pingPongRenderTarget=cG(e.width,e.height);const{_lodMax:t}=this;({lodMeshes:this._lodMeshes,sizeLods:this._sizeLods,sigmas:this._sigmas}=ide(t)),this._blurMaterial=rde(t,e.width,e.height),this._ggxMaterial=sde(t,e.width,e.height)}}async _compileMaterial(e){const t=new ar(new Qn,e);await this._renderer.compile(t,YS)}_sceneToCubeUV(e,t,n,i,s){const a=Jfe;a.near=t,a.far=n;const o=[1,1,1,1,-1,1],l=[1,-1,1,-1,1,-1],c=this._renderer,d=c.autoClear;c.getClearColor(uG),c.autoClear=!1,this._backgroundBox===null&&(this._backgroundBox=new ar(new Xh,new lo({name:"PMREM.Background",side:gr,depthWrite:!1,depthTest:!1})));const p=this._backgroundBox,y=p.material;let _=!1;const v=e.background;v?v.isColor&&(y.color.copy(v),e.background=null,_=!0):(y.color.copy(uG),_=!0),c.setRenderTarget(i),c.clear(),_&&c.render(p,a);for(let b=0;b<6;b++){const E=b%3;E===0?(a.up.set(0,o[b],0),a.position.set(s.x,s.y,s.z),a.lookAt(s.x+l[b],s.y,s.z)):E===1?(a.up.set(0,0,o[b]),a.position.set(s.x,s.y,s.z),a.lookAt(s.x,s.y+l[b],s.z)):(a.up.set(0,o[b],0),a.position.set(s.x,s.y,s.z),a.lookAt(s.x,s.y,s.z+l[b]));const T=this._cubeSize;vv(i,E*T,b>2?T:0,T,T),c.render(e,a)}c.autoClear=d,e.background=v}_textureToCubeUV(e,t){const n=this._renderer,i=e.mapping===ol||e.mapping===oc;i?this._cubemapMaterial===null&&(this._cubemapMaterial=fG(e)):this._equirectMaterial===null&&(this._equirectMaterial=dG(e));const s=i?this._cubemapMaterial:this._equirectMaterial;s.fragmentNode.value=e;const a=this._lodMeshes[0];a.material=s;const o=this._cubeSize;vv(t,0,0,3*o,2*o),n.setRenderTarget(t),n.render(a,YS)}_applyPMREM(e){const t=this._renderer,n=t.autoClear;t.autoClear=!1;const i=this._lodMeshes.length;for(let s=1;s<i;s++)this._applyGGXFilter(e,s-1,s);t.autoClear=n}_applyGGXFilter(e,t,n){const i=this._renderer,s=this._pingPongRenderTarget,a=this._ggxMaterial,o=this._lodMeshes[n];o.material=a;const l=UR.get(a),c=n/(this._lodMeshes.length-1),d=t/(this._lodMeshes.length-1),p=Math.sqrt(c*c-d*d),y=0+c*1.25,_=p*y,{_lodMax:v}=this,b=this._sizeLods[n],E=3*b*(n>v-fm?n-v+fm:0),T=4*(this._cubeSize-b);e.texture.frame=(e.texture.frame||0)+1,l.envMap.value=e.texture,l.roughness.value=_,l.mipInt.value=v-t,vv(s,E,T,3*b,2*b),i.setRenderTarget(s),i.render(o,YS),s.texture.frame=(s.texture.frame||0)+1,l.envMap.value=s.texture,l.roughness.value=0,l.mipInt.value=v-n,vv(e,E,T,3*b,2*b),i.setRenderTarget(e),i.render(o,YS)}_blur(e,t,n,i,s){const a=this._pingPongRenderTarget;this._halfBlur(e,a,t,n,i,"latitudinal",s),this._halfBlur(a,e,n,n,i,"longitudinal",s)}_halfBlur(e,t,n,i,s,a,o){const l=this._renderer,c=this._blurMaterial;a!=="latitudinal"&&a!=="longitudinal"&&Ze("blur direction must be either latitudinal or longitudinal!");const d=3,p=this._lodMeshes[i];p.material=c;const y=UR.get(c),_=this._sizeLods[n]-1,v=isFinite(s)?Math.PI/(2*_):2*Math.PI/(2*f0-1),b=s/v,E=isFinite(s)?1+Math.floor(d*b):f0;E>f0&&Ve(`sigmaRadians, ${s}, is too large and will clip, as it requested ${E} samples when the maximum is set to ${f0}`);const T=[];let M=0;for(let L=0;L<f0;++L){const F=L/b,O=Math.exp(-F*F/2);T.push(O),L===0?M+=O:L<E&&(M+=2*O)}for(let L=0;L<T.length;L++)T[L]=T[L]/M;e.texture.frame=(e.texture.frame||0)+1,y.envMap.value=e.texture,y.samples.value=E,y.weights.array=T,y.latitudinal.value=a==="latitudinal"?1:0,o&&(y.poleAxis.value=o);const{_lodMax:R}=this;y.dTheta.value=v,y.mipInt.value=R-n;const N=this._sizeLods[i],P=3*N*(i>R-fm?i-R+fm:0),U=4*(this._cubeSize-N);vv(t,P,U,3*N,2*N),l.setRenderTarget(t),l.render(p,YS)}}function ide(r){const e=[],t=[],n=[];let i=r;const s=r-fm+1+lG.length;for(let a=0;a<s;a++){const o=Math.pow(2,i);e.push(o);let l=1/o;a>r-fm?l=lG[a-r+fm-1]:a===0&&(l=0),t.push(l);const c=1/(o-2),d=-c,p=1+c,y=[d,d,p,d,p,p,d,d,p,p,d,p],_=6,v=6,b=3,E=2,T=1,M=new Float32Array(b*v*_),R=new Float32Array(E*v*_),N=new Float32Array(T*v*_);for(let U=0;U<_;U++){const L=U%3*2/3-1,F=U>2?0:-1,O=[L,F,0,L+2/3,F,0,L+2/3,F+1,0,L,F,0,L+2/3,F+1,0,L,F+1,0],B=tde[U];M.set(O,b*v*B),R.set(y,E*v*B);const q=[B,B,B,B,B,B];N.set(q,T*v*B)}const P=new Qn;P.setAttribute("position",new Ji(M,b)),P.setAttribute("uv",new Ji(R,E)),P.setAttribute("faceIndex",new Ji(N,T)),n.push(new ar(P,null)),i>fm&&i--}return{lodMeshes:n,sizeLods:e,sigmas:t}}function cG(r,e){const t={magFilter:ei,minFilter:ei,generateMipmaps:!1,type:vi,format:Qi,colorSpace:vu},n=new sf(r,e,t);return n.texture.mapping=Ph,n.texture.name="PMREM.cubeUv",n.texture.isPMREMTexture=!0,n.scissorTest=!0,n}function vv(r,e,t,n,i){r.viewport.set(e,t,n,i),r.scissor.set(e,t,n,i)}function MN(r){const e=new ds;return e.depthTest=!1,e.depthWrite=!1,e.blending=yo,e.name=`PMREM_${r}`,e}function rde(r,e,t){const n=fo(new Array(f0).fill(0)),i=_n(new ne(0,1,0)),s=_n(0),a=re(f0),o=_n(0),l=_n(1),c=Li(),d=_n(0),p=re(1/e),y=re(1/t),_=re(r),v={n:a,latitudinal:o,weights:n,poleAxis:i,outputDirection:EN,dTheta:s,samples:l,envMap:c,mipInt:d,CUBEUV_TEXEL_WIDTH:p,CUBEUV_TEXEL_HEIGHT:y,CUBEUV_MAX_MIP:_},b=MN("blur");return b.fragmentNode=yq({...v,latitudinal:o.equal(1)}),UR.set(b,v),b}function sde(r,e,t){const n=Li(),i=_n(0),s=_n(0),a=re(1/e),o=re(1/t),l=re(r),c={envMap:n,roughness:i,mipInt:s,CUBEUV_TEXEL_WIDTH:a,CUBEUV_TEXEL_HEIGHT:o,CUBEUV_MAX_MIP:l},d=MN("ggx");return d.fragmentNode=_q({...c,N_immutable:EN,GGX_SAMPLES:vt(Qfe)}),UR.set(d,c),d}function fG(r){const e=MN("cubemap");return e.fragmentNode=il(r,EN),e}function dG(r){const e=MN("equirect");return e.fragmentNode=Li(r,VB(EN),0),e}const hG=new WeakMap;function ade(r){const e=Math.log2(r)-2,t=1/r;return{texelWidth:1/(3*Math.max(Math.pow(2,e),112)),texelHeight:t,maxMip:e}}function ode(r,e,t){const n=lde(e);let i=n.get(r);if((i!==void 0?i.pmremVersion:-1)!==r.pmremVersion){const a=r.image;if(r.isCubeTexture)if(cde(a))i=t.fromCubemap(r,i);else return null;else if(fde(a))i=t.fromEquirectangular(r,i);else return null;i.pmremVersion=r.pmremVersion,n.set(r,i)}return i.texture}function lde(r){let e=hG.get(r);return e===void 0&&(e=new WeakMap,hG.set(r,e)),e}class ude extends Qr{static get type(){return"PMREMNode"}constructor(e,t=null,n=null){super("vec3"),this._value=e,this._pmrem=null,this.uvNode=t,this.levelNode=n,this._generator=null;const i=new sr;i.isRenderTargetTexture=!0,this._texture=Li(i),this._width=_n(0),this._height=_n(0),this._maxMip=_n(0),this.updateBeforeType=$n.RENDER}set value(e){this._value=e,this._pmrem=null}get value(){return this._value}updateFromTexture(e){const t=ade(e.image.height);this._texture.value=e,this._width.value=t.texelWidth,this._height.value=t.texelHeight,this._maxMip.value=t.maxMip}updateBefore(e){let t=this._pmrem;const n=t?t.pmremVersion:-1,i=this._value;n!==i.pmremVersion&&(i.isPMREMTexture===!0?t=i:t=ode(i,e.renderer,this._generator),t!==null&&(this._pmrem=t,this.updateFromTexture(t)))}setup(e){this._generator===null&&(this._generator=new nde(e.renderer)),this.updateBefore(e);let t=this.uvNode;t===null&&e.context.getUV&&(t=e.context.getUV(this,e)),t=NB.mul(ge(t.x,t.y.negate(),t.z));let n=this.levelNode;return n===null&&e.context.getTextureLevel&&(n=e.context.getTextureLevel(this)),gq(this._texture,t,n,this._width,this._height,this._maxMip)}dispose(){super.dispose(),this._generator!==null&&this._generator.dispose()}}function cde(r){if(r==null)return!1;let e=0;const t=6;for(let n=0;n<t;n++)r[n]!==void 0&&e++;return e===t}function fde(r){return r==null?!1:r.height>0}const qB=Gn(ude).setParameterLength(1,3),pG=new WeakMap;class dde extends jx{static get type(){return"EnvironmentNode"}constructor(e=null){super(),this.envNode=e}setup(e){const{material:t}=e;let n=this.envNode;if(n.isTextureNode||n.isMaterialReferenceNode){const p=n.isTextureNode?n.value:t[n.property];let y=pG.get(p);y===void 0&&(y=qB(p),pG.set(p,y)),n=y}const s=t.useAnisotropy===!0||t.anisotropy>0?s7:Ri,a=n.context(mG(td,s)).mul(Gw),o=n.context(hde(Wm)).mul(Math.PI).mul(Gw),l=Qv(a),c=Qv(o);e.context.radiance.addAssign(l),e.context.iblIrradiance.addAssign(c);const d=e.context.lightingModel.clearcoatRadiance;if(d){const p=n.context(mG(M1,b0)).mul(Gw),y=Qv(p);d.addAssign(y)}}}const mG=(r,e)=>{let t=null;return{getUV:()=>(t===null&&(t=mr.negate().reflect(e),t=dB(r).mix(t,e).normalize(),t=t.transformDirection(hc)),t),getTextureLevel:()=>r}},hde=r=>({getUV:()=>r,getTextureLevel:()=>re(1)}),pde=new WC;class vq extends ds{static get type(){return"MeshStandardNodeMaterial"}constructor(e){super(),this.isMeshStandardNodeMaterial=!0,this.lights=!0,this.emissiveNode=null,this.metalnessNode=null,this.roughnessNode=null,this.setDefaultValues(pde),this.setValues(e)}setupEnvironment(e){let t=super.setupEnvironment(e);return t===null&&e.environmentNode&&(t=e.environmentNode),t?new dde(t):null}setupLightingModel(){return new pq}setupSpecular(){const e=yi(ge(.04),nr.rgb,yh);Cm.assign(ge(.04)),x0.assign(e),Yv.assign(1)}setupVariants(){const e=this.metalnessNode?re(this.metalnessNode):p7;yh.assign(e);let t=this.roughnessNode?re(this.roughnessNode):h7;t=kB({roughness:t}),td.assign(t),this.setupSpecular(),c0.assign(nr.rgb.mul(e.oneMinus()))}copy(e){return this.emissiveNode=e.emissiveNode,this.metalnessNode=e.metalnessNode,this.roughnessNode=e.roughnessNode,super.copy(e)}}const mde=new bL;class xq extends vq{static get type(){return"MeshPhysicalNodeMaterial"}constructor(e){super(),this.isMeshPhysicalNodeMaterial=!0,this.clearcoatNode=null,this.clearcoatRoughnessNode=null,this.clearcoatNormalNode=null,this.sheenNode=null,this.sheenRoughnessNode=null,this.iridescenceNode=null,this.iridescenceIORNode=null,this.iridescenceThicknessNode=null,this.specularIntensityNode=null,this.specularColorNode=null,this.iorNode=null,this.transmissionNode=null,this.thicknessNode=null,this.attenuationDistanceNode=null,this.attenuationColorNode=null,this.dispersionNode=null,this.anisotropyNode=null,this.setDefaultValues(mde),this.setValues(e)}get useClearcoat(){return this.clearcoat>0||this.clearcoatNode!==null}get useIridescence(){return this.iridescence>0||this.iridescenceNode!==null}get useSheen(){return this.sheen>0||this.sheenNode!==null}get useAnisotropy(){return this.anisotropy>0||this.anisotropyNode!==null}get useTransmission(){return this.transmission>0||this.transmissionNode!==null}get useDispersion(){return this.dispersion>0||this.dispersionNode!==null}setupSpecular(){const e=this.iorNode?re(this.iorNode):R7;jT.assign(e),Cm.assign(zl(fB(jT.sub(1).div(jT.add(1))).mul(d7),ge(1)).mul(dU)),x0.assign(yi(Cm,nr.rgb,yh)),Yv.assign(yi(dU,1,yh))}setupLightingModel(){return new pq(this.useClearcoat,this.useSheen,this.useIridescence,this.useAnisotropy,this.useTransmission,this.useDispersion)}setupVariants(e){if(super.setupVariants(e),this.useClearcoat){const t=this.clearcoatNode?re(this.clearcoatNode):g7,n=this.clearcoatRoughnessNode?re(this.clearcoatRoughnessNode):y7;TR.assign(t),M1.assign(kB({roughness:n}))}if(this.useSheen){const t=this.sheenNode?ge(this.sheenNode):x7,n=this.sheenRoughnessNode?re(this.sheenRoughnessNode):b7;nu.assign(t),Kp.assign(n)}if(this.useIridescence){const t=this.iridescenceNode?re(this.iridescenceNode):T7,n=this.iridescenceIORNode?re(this.iridescenceIORNode):E7,i=this.iridescenceThicknessNode?re(this.iridescenceThicknessNode):M7;oN.assign(t),ER.assign(n),MR.assign(i)}if(this.useAnisotropy){const t=(this.anisotropyNode?St(this.anisotropyNode):S7).toVar();Zp.assign(t.length()),Tn(Zp.equal(0),()=>{t.assign(St(1,0))}).Else(()=>{t.divAssign(St(Zp)),Zp.assign(Zp.saturate())}),AR.assign(Zp.pow2().mix(td.pow2(),1)),$T.assign(S0[0].mul(t.x).add(S0[1].mul(t.y))),I0.assign(S0[1].mul(t.x).sub(S0[0].mul(t.y)))}if(this.useTransmission){const t=this.transmissionNode?re(this.transmissionNode):A7,n=this.thicknessNode?re(this.thicknessNode):w7,i=this.attenuationDistanceNode?re(this.attenuationDistanceNode):C7,s=this.attenuationColorNode?ge(this.attenuationColorNode):N7;if(RR.assign(t),jP.assign(n),YP.assign(i),ZP.assign(s),this.useDispersion){const a=this.dispersionNode?re(this.dispersionNode):B7;KP.assign(a)}}}setupClearcoatNormal(){return this.clearcoatNormalNode?ge(this.clearcoatNormalNode):_7}setup(e){e.context.setupClearcoatNormal=()=>Kv(this.setupClearcoatNormal(e),"NORMAL","vec3"),super.setup(e)}copy(e){return this.clearcoatNode=e.clearcoatNode,this.clearcoatRoughnessNode=e.clearcoatRoughnessNode,this.clearcoatNormalNode=e.clearcoatNormalNode,this.sheenNode=e.sheenNode,this.sheenRoughnessNode=e.sheenRoughnessNode,this.iridescenceNode=e.iridescenceNode,this.iridescenceIORNode=e.iridescenceIORNode,this.iridescenceThicknessNode=e.iridescenceThicknessNode,this.specularIntensityNode=e.specularIntensityNode,this.specularColorNode=e.specularColorNode,this.transmissionNode=e.transmissionNode,this.thicknessNode=e.thicknessNode,this.attenuationDistanceNode=e.attenuationDistanceNode,this.attenuationColorNode=e.attenuationColorNode,this.dispersionNode=e.dispersionNode,this.anisotropyNode=e.anisotropyNode,super.copy(e)}}const gde=Te(({normal:r,lightDirection:e,builder:t})=>{const n=r.dot(e),i=St(n.mul(.5).add(.5),0);if(t.material.gradientMap){const s=ph("gradientMap","texture").context({getUV:()=>i});return ge(s.r)}else{const s=i.fwidth().mul(.5);return yi(ge(.7),ge(1),ef(re(.7).sub(s.x),re(.7).add(s.x),i.x))}});class yde extends SN{direct({lightDirection:e,lightColor:t,reflectedLight:n},i){const s=gde({normal:gN,lightDirection:e,builder:i}).mul(t);n.directDiffuse.addAssign(s.mul(by({diffuseColor:nr.rgb})))}indirect(e){const{ambientOcclusion:t,irradiance:n,reflectedLight:i}=e.context;i.indirectDiffuse.addAssign(n.mul(by({diffuseColor:nr}))),i.indirectDiffuse.mulAssign(t)}}const _de=new TL;class vde extends ds{static get type(){return"MeshToonNodeMaterial"}constructor(e){super(),this.isMeshToonNodeMaterial=!0,this.lights=!0,this.setDefaultValues(_de),this.setValues(e)}setupLightingModel(){return new yde}}const bq=Te(()=>{const r=ge(mr.z,0,mr.x.negate()).normalize(),e=mr.cross(r);return St(r.dot(Ri),e.dot(Ri)).mul(.495).add(.5)}).once(["NORMAL","VERTEX"])().toVar("matcapUV"),xde=new RL;class bde extends ds{static get type(){return"MeshMatcapNodeMaterial"}constructor(e){super(),this.isMeshMatcapNodeMaterial=!0,this.setDefaultValues(xde),this.setValues(e)}setupVariants(e){const t=bq;let n;e.material.matcap?n=ph("matcap","texture").context({getUV:()=>t}):n=ge(yi(.2,.8,t.y)),nr.rgb.mulAssign(n.rgb)}}class Sde extends Qr{static get type(){return"RotateNode"}constructor(e,t){super(),this.positionNode=e,this.rotationNode=t}getNodeType(e){return this.positionNode.getNodeType(e)}setup(e){const{rotationNode:t,positionNode:n}=this;if(this.getNodeType(e)==="vec2"){const s=t.cos(),a=t.sin();return aN(s,a,a.negate(),s).mul(n)}else{const s=t,a=gm(En(1,0,0,0),En(0,qc(s.x),Qo(s.x).negate(),0),En(0,Qo(s.x),qc(s.x),0),En(0,0,0,1)),o=gm(En(qc(s.y),0,Qo(s.y),0),En(0,1,0,0),En(Qo(s.y).negate(),0,qc(s.y),0),En(0,0,0,1)),l=gm(En(qc(s.z),Qo(s.z).negate(),0,0),En(Qo(s.z),qc(s.z),0,0),En(0,0,1,0),En(0,0,0,1));return a.mul(o).mul(l).mul(En(n,1)).xyz}}}const uE=Gn(Sde).setParameterLength(2),Tde=new wC;class Sq extends ds{static get type(){return"SpriteNodeMaterial"}constructor(e){super(),this.isSpriteNodeMaterial=!0,this._useSizeAttenuation=!0,this.positionNode=null,this.rotationNode=null,this.scaleNode=null,this.transparent=!0,this.setDefaultValues(Tde),this.setValues(e)}setupPositionView(e){const{object:t,camera:n}=e,{positionNode:i,rotationNode:s,scaleNode:a,sizeAttenuation:o}=this,l=Hm.mul(ge(i||0));let c=St(ec[0].xyz.length(),ec[1].xyz.length());a!==null&&(c=c.mul(St(a))),n.isPerspectiveCamera&&o===!1&&(c=c.mul(l.z.negate()));let d=oE.xy;if(t.center&&t.center.isVector2===!0){const _=_ue("center","vec2",t);d=d.sub(_.sub(.5))}d=d.mul(c);const p=re(s||v7),y=uE(d,p);return En(l.xy.add(y),l.zw)}copy(e){return this.positionNode=e.positionNode,this.rotationNode=e.rotationNode,this.scaleNode=e.scaleNode,super.copy(e)}get sizeAttenuation(){return this._useSizeAttenuation}set sizeAttenuation(e){this._useSizeAttenuation!==e&&(this._useSizeAttenuation=e,this.needsUpdate=!0)}}const Ede=new CC,Mde=new tt;class Ade extends Sq{static get type(){return"PointsNodeMaterial"}constructor(e){super(),this.sizeNode=null,this.isPointsNodeMaterial=!0,this.setDefaultValues(Ede),this.setValues(e)}setupPositionView(){const{positionNode:e}=this;return Hm.mul(ge(e||Yr)).xyz}setupVertexSprite(e){const{material:t,camera:n}=e,{rotationNode:i,scaleNode:s,sizeNode:a,sizeAttenuation:o}=this;let l=super.setupVertex(e);if(t.isNodeMaterial!==!0)return l;let c=a!==null?St(a):P7;c=c.mul(UW),n.isPerspectiveCamera&&o===!0&&(c=c.mul(wde.div(xs.z.negate()))),s&&s.isNode&&(c=c.mul(St(s)));let d=oE.xy;if(i&&i.isNode){const p=re(i);d=uE(d,p)}return d=d.mul(c),d=d.div(AB.div(2)),d=d.mul(l.w),l=l.add(En(d,0,0)),l}setupVertex(e){return e.object.isPoints?super.setupVertex(e):this.setupVertexSprite(e)}get alphaToCoverage(){return this._useAlphaToCoverage}set alphaToCoverage(e){this._useAlphaToCoverage!==e&&(this._useAlphaToCoverage=e,this.needsUpdate=!0)}}const wde=_n(1).onFrameUpdate(function({renderer:r}){const e=r.getSize(Mde);this.value=.5*e.y});class Rde extends SN{constructor(){super(),this.shadowNode=re(1).toVar("shadowMask")}direct({lightNode:e}){e.shadowNode!==null&&this.shadowNode.mulAssign(e.shadowNode)}finish({context:e}){nr.a.mulAssign(this.shadowNode.oneMinus()),e.outgoingLight.rgb.assign(nr.rgb)}}const Cde=new vL;class Nde extends ds{static get type(){return"ShadowNodeMaterial"}constructor(e){super(),this.isShadowNodeMaterial=!0,this.lights=!0,this.transparent=!0,this.setDefaultValues(Cde),this.setValues(e)}setupLightingModel(){return new Rde}}Ah("vec3");Ah("vec3");Ah("vec3");class Dde{constructor(e,t,n){this.renderer=e,this.nodes=t,this.info=n,this._context=typeof self<"u"?self:null,this._animationLoop=null,this._requestId=null}start(){const e=(t,n)=>{this._requestId=this._context.requestAnimationFrame(e),this.info.autoReset===!0&&this.info.reset(),this.nodes.nodeFrame.update(),this.info.frame=this.nodes.nodeFrame.frameId,this.renderer._inspector.begin(),this._animationLoop!==null&&this._animationLoop(t,n),this.renderer._inspector.finish()};e()}stop(){this._context.cancelAnimationFrame(this._requestId),this._requestId=null}getAnimationLoop(){return this._animationLoop}setAnimationLoop(e){this._animationLoop=e}getContext(){return this._context}setContext(e){this._context=e}dispose(){this.stop()}}class tf{constructor(){this.weakMaps={}}_getWeakMap(e){const t=e.length;let n=this.weakMaps[t];return n===void 0&&(n=new WeakMap,this.weakMaps[t]=n),n}get(e){let t=this._getWeakMap(e);for(let n=0;n<e.length-1;n++)if(t=t.get(e[n]),t===void 0)return;return t.get(e[e.length-1])}set(e,t){let n=this._getWeakMap(e);for(let i=0;i<e.length-1;i++){const s=e[i];n.has(s)===!1&&n.set(s,new WeakMap),n=n.get(s)}return n.set(e[e.length-1],t),this}delete(e){let t=this._getWeakMap(e);for(let n=0;n<e.length-1;n++)if(t=t.get(e[n]),t===void 0)return!1;return t.delete(e[e.length-1])}}let Ode=0;function Ude(r){const e=Object.keys(r);let t=Object.getPrototypeOf(r);for(;t;){const n=Object.getOwnPropertyDescriptors(t);for(const i in n)if(n[i]!==void 0){const s=n[i];s&&typeof s.get=="function"&&e.push(i)}t=Object.getPrototypeOf(t)}return e}class Lde{constructor(e,t,n,i,s,a,o,l,c,d){this.id=Ode++,this._nodes=e,this._geometries=t,this.renderer=n,this.object=i,this.material=s,this.scene=a,this.camera=o,this.lightsNode=l,this.context=c,this.geometry=i.geometry,this.version=s.version,this.drawRange=null,this.attributes=null,this.attributesId=null,this.pipeline=null,this.group=null,this.vertexBuffers=null,this.drawParams=null,this.bundle=null,this.clippingContext=d,this.clippingContextCacheKey=d!==null?d.cacheKey:"",this.initialNodesCacheKey=this.getDynamicCacheKey(),this.initialCacheKey=this.getCacheKey(),this._nodeBuilderState=null,this._bindings=null,this._monitor=null,this.onDispose=null,this.isRenderObject=!0,this.onMaterialDispose=()=>{this.dispose()},this.onGeometryDispose=()=>{this.attributes=null,this.attributesId=null},this.material.addEventListener("dispose",this.onMaterialDispose),this.geometry.addEventListener("dispose",this.onGeometryDispose)}updateClipping(e){this.clippingContext=e}get clippingNeedsUpdate(){return this.clippingContext===null||this.clippingContext.cacheKey===this.clippingContextCacheKey?!1:(this.clippingContextCacheKey=this.clippingContext.cacheKey,!0)}get hardwareClippingPlanes(){return this.material.hardwareClipping===!0?this.clippingContext.unionClippingCount:0}getNodeBuilderState(){return this._nodeBuilderState||(this._nodeBuilderState=this._nodes.getForRender(this))}getMonitor(){return this._monitor||(this._monitor=this.getNodeBuilderState().observer)}getBindings(){return this._bindings||(this._bindings=this.getNodeBuilderState().createBindings())}getBindingGroup(e){for(const t of this.getBindings())if(t.name===e)return t}getIndex(){return this._geometries.getIndex(this)}getIndirect(){return this._geometries.getIndirect(this)}getIndirectOffset(){return this._geometries.getIndirectOffset(this)}getChainArray(){return[this.object,this.material,this.context,this.lightsNode]}setGeometry(e){this.geometry=e,this.attributes=null,this.attributesId=null}getAttributes(){if(this.attributes!==null)return this.attributes;const e=this.getNodeBuilderState().nodeAttributes,t=this.geometry,n=[],i=new Set,s={};for(const a of e){let o;if(a.node&&a.node.attribute?o=a.node.attribute:(o=t.getAttribute(a.name),s[a.name]=o.version),o===void 0)continue;n.push(o);const l=o.isInterleavedBufferAttribute?o.data:o;i.add(l)}return this.attributes=n,this.attributesId=s,this.vertexBuffers=Array.from(i.values()),n}getVertexBuffers(){return this.vertexBuffers===null&&this.getAttributes(),this.vertexBuffers}getDrawParameters(){const{object:e,material:t,geometry:n,group:i,drawRange:s}=this,a=this.drawParams||(this.drawParams={vertexCount:0,firstVertex:0,instanceCount:0,firstInstance:0}),o=this.getIndex(),l=o!==null;let c=1;if(n.isInstancedBufferGeometry===!0?c=n.instanceCount:e.count!==void 0&&(c=Math.max(0,e.count)),c===0)return null;if(a.instanceCount=c,e.isBatchedMesh===!0)return a;let d=1;t.wireframe===!0&&!e.isPoints&&!e.isLineSegments&&!e.isLine&&!e.isLineLoop&&(d=2);let p=s.start*d,y=(s.start+s.count)*d;i!==null&&(p=Math.max(p,i.start*d),y=Math.min(y,(i.start+i.count)*d));const _=n.attributes.position;let v=1/0;l?v=o.count:_!=null&&(v=_.count),p=Math.max(p,0),y=Math.min(y,v);const b=y-p;return b<0||b===1/0?null:(a.vertexCount=b,a.firstVertex=p,a)}getGeometryCacheKey(){const{geometry:e}=this;let t="";for(const n of Object.keys(e.attributes).sort()){const i=e.attributes[n];t+=n+",",i.data&&(t+=i.data.stride+","),i.offset&&(t+=i.offset+","),i.itemSize&&(t+=i.itemSize+","),i.normalized&&(t+="n,")}for(const n of Object.keys(e.morphAttributes).sort()){const i=e.morphAttributes[n];t+="morph-"+n+",";for(let s=0,a=i.length;s<a;s++){const o=i[s];t+=o.id+","}}return e.index&&(t+="index,"),t}getMaterialCacheKey(){const{object:e,material:t,renderer:n}=this;let i=t.customProgramCacheKey();for(const s of Ude(t)){if(/^(is[A-Z]|_)|^(visible|version|uuid|name|opacity|userData)$/.test(s))continue;const a=t[s];let o;if(a!==null){const l=typeof a;l==="number"?o=a!==0?"1":"0":l==="object"?(o="{",a.isTexture&&(o+=a.mapping,n.backend.isWebGPUBackend===!0&&(o+=a.magFilter,o+=a.minFilter,o+=a.wrapS,o+=a.wrapT,o+=a.wrapR)),o+="}"):o=String(a)}else o=String(a);i+=o+","}return i+=this.clippingContextCacheKey+",",e.geometry&&(i+=this.getGeometryCacheKey()),e.skeleton&&(i+=e.skeleton.bones.length+","),e.isBatchedMesh&&(i+=e._matricesTexture.uuid+",",e._colorsTexture!==null&&(i+=e._colorsTexture.uuid+",")),(e.isInstancedMesh||e.count>1||Array.isArray(e.morphTargetInfluences))&&(i+=e.uuid+","),i+=this.context.id+",",i+=e.receiveShadow+",",iE(i)}get needsGeometryUpdate(){if(this.geometry.id!==this.object.geometry.id)return!0;if(this.attributes!==null){const e=this.attributesId;for(const t in e){const n=this.geometry.getAttribute(t);if(n===void 0||e[t]!==n.id)return!0}}return!1}get needsUpdate(){return this.initialNodesCacheKey!==this.getDynamicCacheKey()||this.clippingNeedsUpdate}getDynamicCacheKey(){let e=0;return this.material.isShadowPassMaterial!==!0&&(e=this._nodes.getCacheKey(this.scene,this.lightsNode)),this.camera.isArrayCamera&&(e=qT(e,this.camera.cameras.length)),this.object.receiveShadow&&(e=qT(e,1)),e=qT(e,this.camera.id,this.renderer.contextNode.id,this.renderer.contextNode.version),e}getCacheKey(){return this.getMaterialCacheKey()+this.getDynamicCacheKey()}dispose(){this.material.removeEventListener("dispose",this.onMaterialDispose),this.geometry.removeEventListener("dispose",this.onGeometryDispose),this.onDispose()}}const Qg=[];class Pde{constructor(e,t,n,i,s,a){this.renderer=e,this.nodes=t,this.geometries=n,this.pipelines=i,this.bindings=s,this.info=a,this.chainMaps={}}get(e,t,n,i,s,a,o,l){const c=this.getChainMap(l);Qg[0]=e,Qg[1]=t,Qg[2]=a,Qg[3]=s;let d=c.get(Qg);return d===void 0?(d=this.createRenderObject(this.nodes,this.geometries,this.renderer,e,t,n,i,s,a,o,l),c.set(Qg,d)):(d.updateClipping(o),d.needsGeometryUpdate&&d.setGeometry(e.geometry),(d.version!==t.version||d.needsUpdate)&&(d.initialCacheKey!==d.getCacheKey()?(d.dispose(),d=this.get(e,t,n,i,s,a,o,l)):d.version=t.version)),Qg.length=0,d}getChainMap(e="default"){return this.chainMaps[e]||(this.chainMaps[e]=new tf)}dispose(){this.chainMaps={}}createRenderObject(e,t,n,i,s,a,o,l,c,d,p){const y=this.getChainMap(p),_=new Lde(e,t,n,i,s,a,o,l,c,d);return _.onDispose=()=>{this.pipelines.delete(_),this.bindings.deleteForRender(_),this.nodes.delete(_),y.delete(_.getChainArray())},_}}class qm{constructor(){this.data=new WeakMap}get(e){let t=this.data.get(e);return t===void 0&&(t={},this.data.set(e,t)),t}delete(e){let t=null;return this.data.has(e)&&(t=this.data.get(e),this.data.delete(e)),t}has(e){return this.data.has(e)}dispose(){this.data=new WeakMap}}const tc={VERTEX:1,INDEX:2,STORAGE:3,INDIRECT:4},em=16,Bde=211,Ide=212;class Fde extends qm{constructor(e){super(),this.backend=e}delete(e){const t=super.delete(e);return t!==null&&this.backend.destroyAttribute(e),t}update(e,t){const n=this.get(e);if(n.version===void 0)t===tc.VERTEX?this.backend.createAttribute(e):t===tc.INDEX?this.backend.createIndexAttribute(e):t===tc.STORAGE?this.backend.createStorageAttribute(e):t===tc.INDIRECT&&this.backend.createIndirectStorageAttribute(e),n.version=this._getBufferAttribute(e).version;else{const i=this._getBufferAttribute(e);(n.version<i.version||i.usage===tm)&&(this.backend.updateAttribute(e),n.version=i.version)}}_getBufferAttribute(e){return e.isInterleavedBufferAttribute&&(e=e.data),e}}function Tq(r){return r.index!==null?r.index.version:r.attributes.position.version}function gG(r){const e=[],t=r.index,n=r.attributes.position;if(t!==null){const s=t.array;for(let a=0,o=s.length;a<o;a+=3){const l=s[a+0],c=s[a+1],d=s[a+2];e.push(l,c,c,d,d,l)}}else{const s=n.array;for(let a=0,o=s.length/3-1;a<o;a+=3){const l=a+0,c=a+1,d=a+2;e.push(l,c,c,d,d,l)}}const i=new(rL(e)?EC:TC)(e,1);return i.version=Tq(r),i}class zde extends qm{constructor(e,t){super(),this.attributes=e,this.info=t,this.wireframes=new WeakMap,this.attributeCall=new WeakMap,this._geometryDisposeListeners=new Map}has(e){const t=e.geometry;return super.has(t)&&this.get(t).initialized===!0}updateForRender(e){this.has(e)===!1&&this.initGeometry(e),this.updateAttributes(e)}initGeometry(e){const t=e.geometry,n=this.get(t);n.initialized=!0,this.info.memory.geometries++;const i=()=>{this.info.memory.geometries--;const s=t.index,a=e.getAttributes();s!==null&&this.attributes.delete(s);for(const l of a)this.attributes.delete(l);const o=this.wireframes.get(t);o!==void 0&&this.attributes.delete(o),t.removeEventListener("dispose",i),this._geometryDisposeListeners.delete(t)};t.addEventListener("dispose",i),this._geometryDisposeListeners.set(t,i)}updateAttributes(e){const t=e.getAttributes();for(const s of t)s.isStorageBufferAttribute||s.isStorageInstancedBufferAttribute?this.updateAttribute(s,tc.STORAGE):this.updateAttribute(s,tc.VERTEX);const n=this.getIndex(e);n!==null&&this.updateAttribute(n,tc.INDEX);const i=e.geometry.indirect;i!==null&&this.updateAttribute(i,tc.INDIRECT)}updateAttribute(e,t){const n=this.info.render.calls;e.isInterleavedBufferAttribute?this.attributeCall.get(e)===void 0?(this.attributes.update(e,t),this.attributeCall.set(e,n)):this.attributeCall.get(e.data)!==n&&(this.attributes.update(e,t),this.attributeCall.set(e.data,n),this.attributeCall.set(e,n)):this.attributeCall.get(e)!==n&&(this.attributes.update(e,t),this.attributeCall.set(e,n))}getIndirect(e){return e.geometry.indirect}getIndirectOffset(e){return e.geometry.indirectOffset}getIndex(e){const{geometry:t,material:n}=e;let i=t.index;if(n.wireframe===!0){const s=this.wireframes;let a=s.get(t);a===void 0?(a=gG(t),s.set(t,a)):a.version!==Tq(t)&&(this.attributes.delete(a),a=gG(t),s.set(t,a)),i=a}return i}dispose(){for(const[e,t]of this._geometryDisposeListeners.entries())e.removeEventListener("dispose",t);this._geometryDisposeListeners.clear()}}class Vde{constructor(){this.autoReset=!0,this.frame=0,this.calls=0,this.render={calls:0,frameCalls:0,drawCalls:0,triangles:0,points:0,lines:0,timestamp:0},this.compute={calls:0,frameCalls:0,timestamp:0},this.memory={geometries:0,textures:0}}update(e,t,n){this.render.drawCalls++,e.isMesh||e.isSprite?this.render.triangles+=n*(t/3):e.isPoints?this.render.points+=n*t:e.isLineSegments?this.render.lines+=n*(t/2):e.isLine?this.render.lines+=n*(t-1):Ze("WebGPUInfo: Unknown object type.")}reset(){this.render.drawCalls=0,this.render.frameCalls=0,this.compute.frameCalls=0,this.render.triangles=0,this.render.points=0,this.render.lines=0}dispose(){this.reset(),this.calls=0,this.render.calls=0,this.compute.calls=0,this.render.timestamp=0,this.compute.timestamp=0,this.memory.geometries=0,this.memory.textures=0}}class Eq{constructor(e){this.cacheKey=e,this.usedTimes=0}}class Gde extends Eq{constructor(e,t,n){super(e),this.vertexProgram=t,this.fragmentProgram=n}}class kde extends Eq{constructor(e,t){super(e),this.computeProgram=t,this.isComputePipeline=!0}}let Hde=0;class gD{constructor(e,t,n,i=null,s=null){this.id=Hde++,this.code=e,this.stage=t,this.name=n,this.transforms=i,this.attributes=s,this.usedTimes=0}}class Wde extends qm{constructor(e,t){super(),this.backend=e,this.nodes=t,this.bindings=null,this.caches=new Map,this.programs={vertex:new Map,fragment:new Map,compute:new Map}}getForCompute(e,t){const{backend:n}=this,i=this.get(e);if(this._needsComputeUpdate(e)){const s=i.pipeline;s&&(s.usedTimes--,s.computeProgram.usedTimes--);const a=this.nodes.getForCompute(e);let o=this.programs.compute.get(a.computeShader);o===void 0&&(s&&s.computeProgram.usedTimes===0&&this._releaseProgram(s.computeProgram),o=new gD(a.computeShader,"compute",e.name,a.transforms,a.nodeAttributes),this.programs.compute.set(a.computeShader,o),n.createProgram(o));const l=this._getComputeCacheKey(e,o);let c=this.caches.get(l);c===void 0&&(s&&s.usedTimes===0&&this._releasePipeline(s),c=this._getComputePipeline(e,o,l,t)),c.usedTimes++,o.usedTimes++,i.version=e.version,i.pipeline=c}return i.pipeline}getForRender(e,t=null){const{backend:n}=this,i=this.get(e);if(this._needsRenderUpdate(e)){const s=i.pipeline;s&&(s.usedTimes--,s.vertexProgram.usedTimes--,s.fragmentProgram.usedTimes--);const a=e.getNodeBuilderState(),o=e.material?e.material.name:"";let l=this.programs.vertex.get(a.vertexShader);l===void 0&&(s&&s.vertexProgram.usedTimes===0&&this._releaseProgram(s.vertexProgram),l=new gD(a.vertexShader,"vertex",o),this.programs.vertex.set(a.vertexShader,l),n.createProgram(l));let c=this.programs.fragment.get(a.fragmentShader);c===void 0&&(s&&s.fragmentProgram.usedTimes===0&&this._releaseProgram(s.fragmentProgram),c=new gD(a.fragmentShader,"fragment",o),this.programs.fragment.set(a.fragmentShader,c),n.createProgram(c));const d=this._getRenderCacheKey(e,l,c);let p=this.caches.get(d);p===void 0?(s&&s.usedTimes===0&&this._releasePipeline(s),p=this._getRenderPipeline(e,l,c,d,t)):e.pipeline=p,p.usedTimes++,l.usedTimes++,c.usedTimes++,i.pipeline=p}return i.pipeline}delete(e){const t=this.get(e).pipeline;return t&&(t.usedTimes--,t.usedTimes===0&&this._releasePipeline(t),t.isComputePipeline?(t.computeProgram.usedTimes--,t.computeProgram.usedTimes===0&&this._releaseProgram(t.computeProgram)):(t.fragmentProgram.usedTimes--,t.vertexProgram.usedTimes--,t.vertexProgram.usedTimes===0&&this._releaseProgram(t.vertexProgram),t.fragmentProgram.usedTimes===0&&this._releaseProgram(t.fragmentProgram))),super.delete(e)}dispose(){super.dispose(),this.caches=new Map,this.programs={vertex:new Map,fragment:new Map,compute:new Map}}updateForRender(e){this.getForRender(e)}_getComputePipeline(e,t,n,i){n=n||this._getComputeCacheKey(e,t);let s=this.caches.get(n);return s===void 0&&(s=new kde(n,t),this.caches.set(n,s),this.backend.createComputePipeline(s,i)),s}_getRenderPipeline(e,t,n,i,s){i=i||this._getRenderCacheKey(e,t,n);let a=this.caches.get(i);return a===void 0&&(a=new Gde(i,t,n),this.caches.set(i,a),e.pipeline=a,this.backend.createRenderPipeline(e,s)),a}_getComputeCacheKey(e,t){return e.id+","+t.id}_getRenderCacheKey(e,t,n){return t.id+","+n.id+","+this.backend.getRenderCacheKey(e)}_releasePipeline(e){this.caches.delete(e.cacheKey)}_releaseProgram(e){const t=e.code,n=e.stage;this.programs[n].delete(t)}_needsComputeUpdate(e){const t=this.get(e);return t.pipeline===void 0||t.version!==e.version}_needsRenderUpdate(e){return this.get(e).pipeline===void 0||this.backend.needsRenderUpdate(e)}}class qde extends qm{constructor(e,t,n,i,s,a){super(),this.backend=e,this.textures=n,this.pipelines=s,this.attributes=i,this.nodes=t,this.info=a,this.pipelines.bindings=this}getForRender(e){const t=e.getBindings();for(const n of t){const i=this.get(n);i.bindGroup===void 0&&(this._init(n),this.backend.createBindings(n,t,0),i.bindGroup=n)}return t}getForCompute(e){const t=this.nodes.getForCompute(e).bindings;for(const n of t){const i=this.get(n);i.bindGroup===void 0&&(this._init(n),this.backend.createBindings(n,t,0),i.bindGroup=n)}return t}updateForCompute(e){this._updateBindings(this.getForCompute(e))}updateForRender(e){this._updateBindings(this.getForRender(e))}deleteForCompute(e){const t=this.nodes.getForCompute(e).bindings;for(const n of t)this.backend.deleteBindGroupData(n),this.delete(n)}deleteForRender(e){const t=e.getBindings();for(const n of t)this.backend.deleteBindGroupData(n),this.delete(n)}_updateBindings(e){for(const t of e)this._update(t,e)}_init(e){for(const t of e.bindings)if(t.isSampledTexture)this.textures.updateTexture(t.texture);else if(t.isSampler)this.textures.updateSampler(t.texture);else if(t.isStorageBuffer){const n=t.attribute,i=n.isIndirectStorageBufferAttribute?tc.INDIRECT:tc.STORAGE;this.attributes.update(n,i)}}_update(e,t){const{backend:n}=this;let i=!1,s=!0,a=0,o=0;for(const l of e.bindings)if(this.nodes.updateGroup(l)!==!1){if(l.isStorageBuffer){const d=l.attribute,p=d.isIndirectStorageBufferAttribute?tc.INDIRECT:tc.STORAGE;this.attributes.update(d,p)}if(l.isUniformBuffer)l.update()&&n.updateBinding(l);else if(l.isSampledTexture){const d=l.update(),p=l.texture,y=this.textures.get(p);if(d&&(this.textures.updateTexture(p),l.generation!==y.generation&&(l.generation=y.generation,i=!0,s=!1)),n.get(p).externalTexture!==void 0||y.isDefaultTexture?s=!1:(a=a*10+p.id,o+=p.version),p.isStorageTexture===!0&&p.mipmapsAutoUpdate===!0){const v=this.get(p);l.store===!0?v.needsMipmap=!0:this.textures.needsMipmaps(p)&&v.needsMipmap===!0&&(this.backend.generateMipmaps(p),v.needsMipmap=!1)}}else if(l.isSampler&&l.update()){const p=this.textures.updateSampler(l.texture);l.samplerKey!==p&&(l.samplerKey=p,i=!0,s=!1)}}i===!0&&this.backend.updateBindings(e,t,s?a:0,o)}}function Xde(r,e){return r.groupOrder!==e.groupOrder?r.groupOrder-e.groupOrder:r.renderOrder!==e.renderOrder?r.renderOrder-e.renderOrder:r.z!==e.z?r.z-e.z:r.id-e.id}function yG(r,e){return r.groupOrder!==e.groupOrder?r.groupOrder-e.groupOrder:r.renderOrder!==e.renderOrder?r.renderOrder-e.renderOrder:r.z!==e.z?e.z-r.z:r.id-e.id}function _G(r){return(r.transmission>0||r.transmissionNode&&r.transmissionNode.isNode)&&r.side===xa&&r.forceSinglePass===!1}class $de{constructor(e,t,n){this.renderItems=[],this.renderItemsIndex=0,this.opaque=[],this.transparentDoublePass=[],this.transparent=[],this.bundles=[],this.lightsNode=e.getNode(t,n),this.lightsArray=[],this.scene=t,this.camera=n,this.occlusionQueryCount=0}begin(){return this.renderItemsIndex=0,this.opaque.length=0,this.transparentDoublePass.length=0,this.transparent.length=0,this.bundles.length=0,this.lightsArray.length=0,this.occlusionQueryCount=0,this}getNextRenderItem(e,t,n,i,s,a,o){let l=this.renderItems[this.renderItemsIndex];return l===void 0?(l={id:e.id,object:e,geometry:t,material:n,groupOrder:i,renderOrder:e.renderOrder,z:s,group:a,clippingContext:o},this.renderItems[this.renderItemsIndex]=l):(l.id=e.id,l.object=e,l.geometry=t,l.material=n,l.groupOrder=i,l.renderOrder=e.renderOrder,l.z=s,l.group=a,l.clippingContext=o),this.renderItemsIndex++,l}push(e,t,n,i,s,a,o){const l=this.getNextRenderItem(e,t,n,i,s,a,o);e.occlusionTest===!0&&this.occlusionQueryCount++,n.transparent===!0||n.transmission>0||n.transmissionNode&&n.transmissionNode.isNode||n.backdropNode&&n.backdropNode.isNode?(_G(n)&&this.transparentDoublePass.push(l),this.transparent.push(l)):this.opaque.push(l)}unshift(e,t,n,i,s,a,o){const l=this.getNextRenderItem(e,t,n,i,s,a,o);n.transparent===!0||n.transmission>0||n.transmissionNode&&n.transmissionNode.isNode||n.backdropNode&&n.backdropNode.isNode?(_G(n)&&this.transparentDoublePass.unshift(l),this.transparent.unshift(l)):this.opaque.unshift(l)}pushBundle(e){this.bundles.push(e)}pushLight(e){this.lightsArray.push(e)}sort(e,t){this.opaque.length>1&&this.opaque.sort(e||Xde),this.transparentDoublePass.length>1&&this.transparentDoublePass.sort(t||yG),this.transparent.length>1&&this.transparent.sort(t||yG)}finish(){this.lightsNode.setLights(this.lightsArray);for(let e=this.renderItemsIndex,t=this.renderItems.length;e<t;e++){const n=this.renderItems[e];if(n.id===null)break;n.id=null,n.object=null,n.geometry=null,n.material=null,n.groupOrder=null,n.renderOrder=null,n.z=null,n.group=null,n.clippingContext=null}}}const ZS=[];class jde{constructor(e){this.lighting=e,this.lists=new tf}get(e,t){const n=this.lists;ZS[0]=e,ZS[1]=t;let i=n.get(ZS);return i===void 0&&(i=new $de(this.lighting,e,t),n.set(ZS,i)),ZS.length=0,i}dispose(){this.lists=new tf}}let Yde=0;class Zde{constructor(){this.id=Yde++,this.color=!0,this.clearColor=!0,this.clearColorValue={r:0,g:0,b:0,a:1},this.depth=!0,this.clearDepth=!0,this.clearDepthValue=1,this.stencil=!1,this.clearStencil=!0,this.clearStencilValue=1,this.viewport=!1,this.viewportValue=new zn,this.scissor=!1,this.scissorValue=new zn,this.renderTarget=null,this.textures=null,this.depthTexture=null,this.activeCubeFace=0,this.activeMipmapLevel=0,this.sampleCount=1,this.width=0,this.height=0,this.occlusionQueryCount=0,this.clippingContext=null,this.isRenderContext=!0}getCacheKey(){return Mq(this)}}function Mq(r){const{textures:e,activeCubeFace:t,activeMipmapLevel:n}=r,i=[t,n];for(const s of e)i.push(s.id);return Xx(i)}const xv=[],Kde=new Fm,Qde=new G1;class Jde{constructor(){this.chainMaps={}}get(e,t,n=null,i=null){xv[0]=e,xv[1]=t,i!==null&&(xv[2]=i);let s;if(n===null)s="default";else{const l=n.texture.format;s=`${n.textures.length}:${l}:${n.samples}:${n.depthBuffer}:${n.stencilBuffer}`}const a=this._getChainMap(s);let o=a.get(xv);return o===void 0&&(o=new Zde,a.set(xv,o)),xv.length=0,n!==null&&(o.sampleCount=n.samples===0?1:n.samples),o}getForClear(e=null){return this.get(Kde,Qde,e)}_getChainMap(e){return this.chainMaps[e]||(this.chainMaps[e]=new tf)}dispose(){this.chainMaps={}}}const ehe=new ne;class the extends qm{constructor(e,t,n){super(),this.renderer=e,this.backend=t,this.info=n}updateRenderTarget(e,t=0){const n=this.get(e),i=e.samples===0?1:e.samples,s=n.depthTextureMips||(n.depthTextureMips={}),a=e.textures,o=this.getSize(a[0]),l=o.width>>t,c=o.height>>t;let d=e.depthTexture||s[t];const p=e.depthBuffer===!0||e.stencilBuffer===!0;let y=!1;d===void 0&&p&&(d=new Ga,d.format=e.stencilBuffer?ho:ba,d.type=e.stencilBuffer?Dl:Hi,d.image.width=l,d.image.height=c,d.image.depth=o.depth,d.renderTarget=e,d.isArrayTexture=e.multiview===!0&&o.depth>1,s[t]=d),(n.width!==o.width||o.height!==n.height)&&(y=!0,d&&(d.needsUpdate=!0,d.image.width=l,d.image.height=c,d.image.depth=d.isArrayTexture?d.image.depth:1)),n.width=o.width,n.height=o.height,n.textures=a,n.depthTexture=d||null,n.depth=e.depthBuffer,n.stencil=e.stencilBuffer,n.renderTarget=e,n.sampleCount!==i&&(y=!0,d&&(d.needsUpdate=!0),n.sampleCount=i);const _={sampleCount:i};if(e.isXRRenderTarget!==!0){for(let v=0;v<a.length;v++){const b=a[v];y&&(b.needsUpdate=!0),this.updateTexture(b,_)}d&&this.updateTexture(d,_)}n.initialized!==!0&&(n.initialized=!0,n.onDispose=()=>{this._destroyRenderTarget(e)},e.addEventListener("dispose",n.onDispose))}updateTexture(e,t={}){const n=this.get(e);if(n.initialized===!0&&n.version===e.version)return;const i=e.isRenderTargetTexture||e.isDepthTexture||e.isFramebufferTexture,s=this.backend;if(i&&n.initialized===!0&&s.destroyTexture(e),e.isFramebufferTexture){const c=this.renderer.getRenderTarget();c?e.type=c.texture.type:e.type=ir}const{width:a,height:o,depth:l}=this.getSize(e);if(t.width=a,t.height=o,t.depth=l,t.needsMipmaps=this.needsMipmaps(e),t.levels=t.needsMipmaps?this.getMipLevels(e,a,o):1,e.isCubeTexture&&e.mipmaps.length>0&&t.levels++,i||e.isStorageTexture===!0||e.isExternalTexture===!0)s.createTexture(e,t),n.generation=e.version;else if(e.version>0){const c=e.image;if(c===void 0)Ve("Renderer: Texture marked for update but image is undefined.");else if(c.complete===!1)Ve("Renderer: Texture marked for update but image is incomplete.");else{if(e.images){const p=[];for(const y of e.images)p.push(y);t.images=p}else t.image=c;(n.isDefaultTexture===void 0||n.isDefaultTexture===!0)&&(s.createTexture(e,t),n.isDefaultTexture=!1,n.generation=e.version),e.source.dataReady===!0&&s.updateTexture(e,t);const d=e.isStorageTexture===!0&&e.mipmapsAutoUpdate===!1;t.needsMipmaps&&e.mipmaps.length===0&&!d&&s.generateMipmaps(e),e.onUpdate&&e.onUpdate(e)}}else s.createDefaultTexture(e),n.isDefaultTexture=!0,n.generation=e.version;n.initialized!==!0&&(n.initialized=!0,n.generation=e.version,this.info.memory.textures++,e.isVideoTexture&&Nn.enabled===!0&&Nn.getTransfer(e.colorSpace)!==an&&Ve("WebGPURenderer: Video textures must use a color space with a sRGB transfer function, e.g. SRGBColorSpace."),n.onDispose=()=>{this._destroyTexture(e)},e.addEventListener("dispose",n.onDispose)),n.version=e.version}updateSampler(e){return this.backend.updateSampler(e)}getSize(e,t=ehe){let n=e.images?e.images[0]:e.image;return n?(n.image!==void 0&&(n=n.image),typeof HTMLVideoElement<"u"&&n instanceof HTMLVideoElement?(t.width=n.videoWidth||1,t.height=n.videoHeight||1,t.depth=1):typeof VideoFrame<"u"&&n instanceof VideoFrame?(t.width=n.displayWidth||1,t.height=n.displayHeight||1,t.depth=1):(t.width=n.width||1,t.height=n.height||1,t.depth=e.isCubeTexture?6:n.depth||1)):t.width=t.height=t.depth=1,t}getMipLevels(e,t,n){let i;return e.mipmaps.length>0?i=e.mipmaps.length:e.isCompressedTexture===!0?i=1:i=Math.floor(Math.log2(Math.max(t,n)))+1,i}needsMipmaps(e){return e.generateMipmaps===!0||e.mipmaps.length>0}_destroyRenderTarget(e){if(this.has(e)===!0){const t=this.get(e),n=t.textures,i=t.depthTexture;e.removeEventListener("dispose",t.onDispose);for(let s=0;s<n.length;s++)this._destroyTexture(n[s]);i&&this._destroyTexture(i),this.delete(e),this.backend.delete(e)}}_destroyTexture(e){if(this.has(e)===!0){const t=this.get(e);e.removeEventListener("dispose",t.onDispose);const n=t.isDefaultTexture;this.backend.destroyTexture(e,n),this.delete(e),this.info.memory.textures--}}}class XB extends Kt{constructor(e,t,n,i=1){super(e,t,n),this.a=i}set(e,t,n,i=1){return this.a=i,super.set(e,t,n)}copy(e){return e.a!==void 0&&(this.a=e.a),super.copy(e)}clone(){return new this.constructor(this.r,this.g,this.b,this.a)}}class Aq extends Wi{static get type(){return"ParameterNode"}constructor(e,t=null){super(e,t),this.isParameterNode=!0}getMemberType(e,t){const n=this.getNodeType(e),i=e.getStructTypeNode(n);let s;return i!==null?s=i.getMemberType(e,t):(Ze(`TSL: Member "${t}" not found in struct "${n}".`),s="float"),s}getHash(){return this.uuid}generate(){return this.name}}const nhe=(r,e)=>new Aq(r,e);class ihe extends on{static get type(){return"StackNode"}constructor(e=null){super(),this.nodes=[],this.outputNode=null,this.parent=e,this._currentCond=null,this._expressionNode=null,this._currentNode=null,this.isStackNode=!0}getElementType(e){return this.hasOutput?this.outputNode.getElementType(e):"void"}getNodeType(e){return this.hasOutput?this.outputNode.getNodeType(e):"void"}getMemberType(e,t){return this.hasOutput?this.outputNode.getMemberType(e,t):"void"}addToStack(e,t=this.nodes.length){return e.isNode!==!0?(Ze("TSL: Invalid node added to stack."),this):(this.nodes.splice(t,0,e),this)}addToStackBefore(e){const t=this._currentNode?this.nodes.indexOf(this._currentNode):0;return this.addToStack(e,t)}If(e,t){const n=new Fv(t);return this._currentCond=za(e,n),this.addToStack(this._currentCond)}ElseIf(e,t){const n=new Fv(t),i=za(e,n);return this._currentCond.elseNode=i,this._currentCond=i,this}Else(e){return this._currentCond.elseNode=new Fv(e),this}Switch(e){return this._expressionNode=Xt(e),this}Case(...e){const t=[];if(e.length>=2)for(let o=0;o<e.length-1;o++)t.push(this._expressionNode.equal(Xt(e[o])));else Ze("TSL: Invalid parameter length. Case() requires at least two parameters.");const n=e[e.length-1],i=new Fv(n);let s=t[0];for(let o=1;o<t.length;o++)s=s.or(t[o]);const a=za(s,i);return this._currentCond===null?(this._currentCond=a,this.addToStack(this._currentCond)):(this._currentCond.elseNode=a,this._currentCond=a,this)}Default(e){return this.Else(e),this}setup(e){const t=e.getNodeProperties(this);let n=0;for(const i of this.getChildren())i.isVarNode&&i.isIntent(e)&&i.isAssign(e)!==!0||(t["node"+n++]=i);return t.outputNode||null}get hasOutput(){return this.outputNode&&this.outputNode.isNode}build(e,...t){const n=kP(),i=e.buildStage;T1(this),e.setActiveStack(this);const s=c=>{if(this._currentNode=c,!(c.isVarNode&&c.isIntent(e)&&c.isAssign(e)!==!0)){if(i==="setup")c.build(e);else if(i==="analyze")c.build(e,this);else if(i==="generate"){const d=e.getDataFromNode(c,"any").stages,p=d&&d[e.shaderStage];if(c.isVarNode&&p&&p.length===1&&p[0]&&p[0].isStackNode)return;c.build(e,"void")}}},a=[...this.nodes];for(const c of a)s(c);this._currentNode=null;const o=this.nodes.filter(c=>a.indexOf(c)===-1);for(const c of o)s(c);let l;return this.hasOutput?l=this.outputNode.build(e,...t):l=super.build(e,...t),T1(n),e.removeActiveStack(this),l}}const Hw=Gn(ihe).setParameterLength(0,1);function rhe(r){return Object.entries(r).map(([e,t])=>typeof t=="string"?{name:e,type:t,atomic:!1}:{name:e,type:t.type,atomic:t.atomic||!1})}class she extends on{static get type(){return"StructTypeNode"}constructor(e,t=null){super("struct"),this.membersLayout=rhe(e),this.name=t,this.isStructLayoutNode=!0}getLength(){const e=Float32Array.BYTES_PER_ELEMENT;let t=1,n=0;for(const i of this.membersLayout){const s=i.type,a=wle(s),o=Rle(s)/e;t=Math.max(t,o);const c=n%t%o;c!==0&&(n+=o-c),n+=a}return Math.ceil(n/t)*t}getMemberType(e,t){const n=this.membersLayout.find(i=>i.name===t);return n?n.type:"void"}getNodeType(e){return e.getStructTypeFromNode(this,this.membersLayout,this.name).name}setup(e){e.getStructTypeFromNode(this,this.membersLayout,this.name),e.addInclude(this)}generate(e){return this.getNodeType(e)}}class ahe extends on{static get type(){return"StructNode"}constructor(e,t){super("vec3"),this.structTypeNode=e,this.values=t,this.isStructNode=!0}getNodeType(e){return this.structTypeNode.getNodeType(e)}getMemberType(e,t){return this.structTypeNode.getMemberType(e,t)}generate(e){const t=e.getVarFromNode(this),n=t.type,i=e.getPropertyName(t);return e.addLineFlowCode(`${i} = ${e.generateStruct(n,this.structTypeNode.membersLayout,this.values)}`,this),t.name}}const ohe=(r,e=null)=>{const t=new she(r,e),n=(...i)=>{let s=null;if(i.length>0)if(i[0].isNode){s={};const a=Object.keys(r);for(let o=0;o<i.length;o++)s[a[o]]=i[o]}else s=i[0];return new ahe(t,s)};return n.layout=t,n.isStruct=!0,n};class wq extends on{static get type(){return"OutputStructNode"}constructor(...e){super(),this.members=e,this.isOutputStructNode=!0}getNodeType(e){const t=e.getNodeProperties(this);if(t.membersLayout===void 0){const n=this.members,i=[];for(let s=0;s<n.length;s++){const a="m"+s,o=n[s].getNodeType(e);i.push({name:a,type:o,index:s})}t.membersLayout=i,t.structType=e.getOutputStructTypeFromNode(this,t.membersLayout)}return t.structType.name}generate(e){const t=e.getOutputStructName(),n=this.members,i=t!==""?t+".":"";for(let s=0;s<n.length;s++){const a=n[s].build(e);e.addLineFlowCode(`${i}m${s} = ${a}`,this)}return t}}const lhe=Gn(wq);function Rq(r,e){for(let t=0;t<r.length;t++)if(r[t].name===e)return t;return-1}class uhe extends wq{static get type(){return"MRTNode"}constructor(e){super(),this.outputNodes=e,this.isMRTNode=!0}has(e){return this.outputNodes[e]!==void 0}get(e){return this.outputNodes[e]}merge(e){const t={...this.outputNodes,...e.outputNodes};return Cq(t)}setup(e){const t=this.outputNodes,n=e.renderer.getRenderTarget(),i=[],s=n.textures;for(const a in t){const o=Rq(s,a);i[o]=En(t[a])}return this.members=i,super.setup(e)}}const Cq=Gn(uhe);class cE extends Qr{static get type(){return"BitcastNode"}constructor(e,t,n=null){super(),this.valueNode=e,this.conversionType=t,this.inputType=n,this.isBitcastNode=!0}getNodeType(e){if(this.inputType!==null){const t=this.valueNode.getNodeType(e),n=e.getTypeLength(t);return e.getTypeFromLength(n,this.conversionType)}return this.conversionType}generate(e){const t=this.getNodeType(e);let n="";if(this.inputType!==null){const i=this.valueNode.getNodeType(e);n=e.getTypeLength(i)===1?this.inputType:e.changeComponentType(i,this.inputType)}else n=this.valueNode.getNodeType(e);return`${e.getBitcastMethod(t,n)}( ${this.valueNode.build(e,n)} )`}}const Nq=Mt(cE).setParameterLength(2),che=r=>new cE(r,"int","float"),Dq=r=>new cE(r,"uint","float"),fhe=r=>new cE(r,"float","int"),dhe=r=>new cE(r,"float","uint"),ew={};class yu extends Pe{static get type(){return"BitcountNode"}constructor(e,t){super(e,t),this.isBitcountNode=!0}_resolveElementType(e,t,n){n==="int"?t.assign(Nq(e,"uint")):t.assign(e)}_returnDataNode(e){switch(e){case"uint":return vt;case"int":return de;case"uvec2":return HP;case"uvec3":return Ly;case"uvec4":return $P;case"ivec2":return Vs;case"ivec3":return WP;case"ivec4":return XP}}_createTrailingZerosBaseLayout(e,t){const n=this._returnDataNode(t);return Te(([s])=>{const a=vt(0);this._resolveElementType(s,a,t);const o=re(a.bitAnd(aB(a))),c=Dq(o).shiftRight(23).sub(127);return n(c)}).setLayout({name:e,type:t,inputs:[{name:"value",type:t}]})}_createLeadingZerosBaseLayout(e,t){const n=this._returnDataNode(t);return Te(([s])=>{Tn(s.equal(vt(0)),()=>vt(32));const a=vt(0),o=vt(0);return this._resolveElementType(s,a,t),Tn(a.shiftRight(16).equal(0),()=>{o.addAssign(16),a.shiftLeftAssign(16)}),Tn(a.shiftRight(24).equal(0),()=>{o.addAssign(8),a.shiftLeftAssign(8)}),Tn(a.shiftRight(28).equal(0),()=>{o.addAssign(4),a.shiftLeftAssign(4)}),Tn(a.shiftRight(30).equal(0),()=>{o.addAssign(2),a.shiftLeftAssign(2)}),Tn(a.shiftRight(31).equal(0),()=>{o.addAssign(1)}),n(o)}).setLayout({name:e,type:t,inputs:[{name:"value",type:t}]})}_createOneBitsBaseLayout(e,t){const n=this._returnDataNode(t);return Te(([s])=>{const a=vt(0);this._resolveElementType(s,a,t),a.assign(a.sub(a.shiftRight(vt(1)).bitAnd(vt(1431655765)))),a.assign(a.bitAnd(vt(858993459)).add(a.shiftRight(vt(2)).bitAnd(vt(858993459))));const o=a.add(a.shiftRight(vt(4))).bitAnd(vt(252645135)).mul(vt(16843009)).shiftRight(vt(24));return n(o)}).setLayout({name:e,type:t,inputs:[{name:"value",type:t}]})}_createMainLayout(e,t,n,i){const s=this._returnDataNode(t);return Te(([o])=>{if(n===1)return s(i(o));{const l=s(0),c=["x","y","z","w"];for(let d=0;d<n;d++){const p=c[d];l[p].assign(i(o[p]))}return l}}).setLayout({name:e,type:t,inputs:[{name:"value",type:t}]})}setup(e){const{method:t,aNode:n}=this,{renderer:i}=e;if(i.backend.isWebGPUBackend)return super.setup(e);const s=this.getInputType(e),a=e.getElementType(s),o=e.getTypeLength(s),l=`${t}_base_${a}`,c=`${t}_${s}`;let d=ew[l];if(d===void 0){switch(t){case yu.COUNT_LEADING_ZEROS:{d=this._createLeadingZerosBaseLayout(l,a);break}case yu.COUNT_TRAILING_ZEROS:{d=this._createTrailingZerosBaseLayout(l,a);break}case yu.COUNT_ONE_BITS:{d=this._createOneBitsBaseLayout(l,a);break}}ew[l]=d}let p=ew[c];return p===void 0&&(p=this._createMainLayout(c,s,o,d),ew[c]=p),Te(()=>p(n))()}}yu.COUNT_TRAILING_ZEROS="countTrailingZeros";yu.COUNT_LEADING_ZEROS="countLeadingZeros";yu.COUNT_ONE_BITS="countOneBits";const hhe=Mt(yu,yu.COUNT_TRAILING_ZEROS).setParameterLength(1),phe=Mt(yu,yu.COUNT_LEADING_ZEROS).setParameterLength(1),mhe=Mt(yu,yu.COUNT_ONE_BITS).setParameterLength(1),ghe=Te(([r])=>{const e=r.toUint().mul(747796405).add(2891336453),t=e.shiftRight(e.shiftRight(28).add(4)).bitXor(e).mul(277803737);return t.shiftRight(22).bitXor(t).toFloat().mul(1/2**32)}),yU=(r,e)=>Ju(Vn(4,r.mul(_i(1,r))),e),yhe=(r,e)=>r.lessThan(.5)?yU(r.mul(2),e).div(2):_i(1,yU(Vn(_i(1,r),2),e).div(2)),_he=(r,e,t)=>Ju(Su(Ju(r,e),Ns(Ju(r,e),Ju(_i(1,r),t))),1/e),vhe=(r,e)=>Qo(CR.mul(e.mul(r).sub(1))).div(CR.mul(e.mul(r).sub(1)));class $B extends Qr{static get type(){return"PackFloatNode"}constructor(e,t){super(),this.vectorNode=t,this.encoding=e,this.isPackFloatNode=!0}getNodeType(){return"uint"}generate(e){const t=this.vectorNode.getNodeType(e);return`${e.getFloatPackingMethod(this.encoding)}(${this.vectorNode.build(e,t)})`}}const xhe=Mt($B,"snorm").setParameterLength(1),bhe=Mt($B,"unorm").setParameterLength(1),She=Mt($B,"float16").setParameterLength(1);class jB extends Qr{static get type(){return"UnpackFloatNode"}constructor(e,t){super(),this.uintNode=t,this.encoding=e,this.isUnpackFloatNode=!0}getNodeType(){return"vec2"}generate(e){const t=this.uintNode.getNodeType(e);return`${e.getFloatUnpackingMethod(this.encoding)}(${this.uintNode.build(e,t)})`}}const The=Mt(jB,"snorm").setParameterLength(1),Ehe=Mt(jB,"unorm").setParameterLength(1),Mhe=Mt(jB,"float16").setParameterLength(1),ch=Te(([r])=>r.fract().sub(.5).abs()).setLayout({name:"tri",type:"float",inputs:[{name:"x",type:"float"}]}),Ahe=Te(([r])=>ge(ch(r.z.add(ch(r.y.mul(1)))),ch(r.z.add(ch(r.x.mul(1)))),ch(r.y.add(ch(r.x.mul(1)))))).setLayout({name:"tri3",type:"vec3",inputs:[{name:"p",type:"vec3"}]}),whe=Te(([r,e,t])=>{const n=ge(r).toVar(),i=re(1.4).toVar(),s=re(0).toVar(),a=ge(n).toVar();return rr({start:re(0),end:re(3),type:"float",condition:"<="},()=>{const o=ge(Ahe(a.mul(2))).toVar();n.addAssign(o.add(t.mul(re(.1).mul(e)))),a.mulAssign(1.8),i.mulAssign(1.5),n.mulAssign(1.2);const l=re(ch(n.z.add(ch(n.x.add(ch(n.y)))))).toVar();s.addAssign(l.div(i)),a.addAssign(.14)}),s}).setLayout({name:"triNoise3D",type:"float",inputs:[{name:"position",type:"vec3"},{name:"speed",type:"float"},{name:"time",type:"float"}]});class Rhe extends on{static get type(){return"FunctionOverloadingNode"}constructor(e=[],...t){super(),this.functionNodes=e,this.parametersNodes=t,this._candidateFn=null,this.global=!0}getNodeType(e){return this.getCandidateFn(e).shaderNode.layout.type}getCandidateFn(e){const t=this.parametersNodes;let n=this._candidateFn;if(n===null){let i=null,s=-1;for(const a of this.functionNodes){const l=a.shaderNode.layout;if(l===null)throw new Error("FunctionOverloadingNode: FunctionNode must be a layout.");const c=l.inputs;if(t.length===c.length){let d=0;for(let p=0;p<t.length;p++){const y=t[p],_=c[p];y.getNodeType(e)===_.type&&d++}d>s&&(i=a,s=d)}}this._candidateFn=n=i}return n}setup(e){return this.getCandidateFn(e)(...this.parametersNodes)}}const Che=Gn(Rhe),Wa=r=>(...e)=>Che(r,...e),Yx=_n(0).setGroup(yn).onRenderUpdate(r=>r.time),Nhe=_n(0).setGroup(yn).onRenderUpdate(r=>r.deltaTime),Oq=_n(0,"uint").setGroup(yn).onRenderUpdate(r=>r.frameId),Dhe=(r=Yx)=>r.add(.75).mul(Math.PI*2).sin().mul(.5).add(.5),Ohe=(r=Yx)=>r.fract().round(),Uhe=(r=Yx)=>r.add(.5).fract().mul(2).sub(1).abs(),Lhe=(r=Yx)=>r.fract();function Phe(r,e=null){return jh(e,{getUV:r})}const Bhe=Te(([r,e,t=St(.5)])=>uE(r.sub(t),e).add(t)),Ihe=Te(([r,e,t=St(.5)])=>{const n=r.sub(t),i=n.dot(n),a=i.mul(i).mul(e);return r.add(n.mul(a))}),Fhe=Te(({position:r=null,horizontal:e=!0,vertical:t=!1})=>{let n;r!==null?(n=ec.toVar(),n[3][0]=r.x,n[3][1]=r.y,n[3][2]=r.z):n=ec;const i=hc.mul(n);return S1(e)&&(i[0][0]=ec[0].length(),i[0][1]=0,i[0][2]=0),S1(t)&&(i[1][0]=0,i[1][1]=ec[1].length(),i[1][2]=0),i[2][0]=0,i[2][1]=0,i[2][2]=1,Ch.mul(i).mul(Yr)}),zhe=Te(([r=null])=>{const e=OR();return OR(BB(r)).sub(e).lessThan(0).select(Rh,r)});class Vhe extends on{static get type(){return"SpriteSheetUVNode"}constructor(e,t=hr(),n=re(0)){super("vec2"),this.countNode=e,this.uvNode=t,this.frameNode=n}setup(){const{frameNode:e,uvNode:t,countNode:n}=this,{width:i,height:s}=n,a=e.mod(i.mul(s)).floor(),o=a.mod(i),l=s.sub(a.add(1).div(i).ceil()),c=n.reciprocal(),d=St(o,l);return t.add(d).mul(c)}}const Ghe=Gn(Vhe).setParameterLength(3),Uq=Te(([r,e=null,t=null,n=re(1),i=Yr,s=Vl])=>{let a=s.abs().normalize();a=a.div(a.dot(ge(1)));const o=i.yz.mul(n),l=i.zx.mul(n),c=i.xy.mul(n),d=r.value,p=e!==null?e.value:d,y=t!==null?t.value:d,_=Li(d,o).mul(a.x),v=Li(p,l).mul(a.y),b=Li(y,c).mul(a.z);return Ns(_,v,b)}),khe=(...r)=>Uq(...r),bv=new Hc,Jg=new ne,Sv=new ne,yD=new ne,KS=new gn,tw=new ne(0,0,-1),$f=new zn,QS=new ne,nw=new ne,JS=new zn,iw=new tt,LR=new sf,Hhe=Rh.flipX();LR.depthTexture=new Ga(1,1);let rw=!1;class YB extends gd{static get type(){return"ReflectorNode"}constructor(e={}){super(e.defaultTexture||LR.texture,Hhe),this._reflectorBaseNode=e.reflector||new Whe(this,e),this._depthNode=null,this.setUpdateMatrix(!1)}get reflector(){return this._reflectorBaseNode}get target(){return this._reflectorBaseNode.target}getDepthNode(){if(this._depthNode===null){if(this._reflectorBaseNode.depth!==!0)throw new Error("THREE.ReflectorNode: Depth node can only be requested when the reflector is created with { depth: true }. ");this._depthNode=Xt(new YB({defaultTexture:LR.depthTexture,reflector:this._reflectorBaseNode}))}return this._depthNode}setup(e){return e.object.isQuadMesh||this._reflectorBaseNode.build(e),super.setup(e)}clone(){const e=new this.constructor(this.reflectorNode);return e.uvNode=this.uvNode,e.levelNode=this.levelNode,e.biasNode=this.biasNode,e.sampler=this.sampler,e.depthNode=this.depthNode,e.compareNode=this.compareNode,e.gradNode=this.gradNode,e.offsetNode=this.offsetNode,e._reflectorBaseNode=this._reflectorBaseNode,e}dispose(){super.dispose(),this._reflectorBaseNode.dispose()}}class Whe extends on{static get type(){return"ReflectorBaseNode"}constructor(e,t={}){super();const{target:n=new Fi,resolutionScale:i=1,generateMipmaps:s=!1,bounces:a=!0,depth:o=!1,samples:l=0}=t;this.textureNode=e,this.target=n,this.resolutionScale=i,t.resolution!==void 0&&(cr('ReflectorNode: The "resolution" parameter has been renamed to "resolutionScale".'),this.resolutionScale=t.resolution),this.generateMipmaps=s,this.bounces=a,this.depth=o,this.samples=l,this.updateBeforeType=a?$n.RENDER:$n.FRAME,this.virtualCameras=new WeakMap,this.renderTargets=new Map,this.forceUpdate=!1,this.hasOutput=!1}_updateResolution(e,t){const n=this.resolutionScale;t.getDrawingBufferSize(iw),e.setSize(Math.round(iw.width*n),Math.round(iw.height*n))}setup(e){return this._updateResolution(LR,e.renderer),super.setup(e)}dispose(){super.dispose();for(const e of this.renderTargets.values())e.dispose()}getVirtualCamera(e){let t=this.virtualCameras.get(e);return t===void 0&&(t=e.clone(),this.virtualCameras.set(e,t)),t}getRenderTarget(e){let t=this.renderTargets.get(e);return t===void 0&&(t=new sf(0,0,{type:vi,samples:this.samples}),this.generateMipmaps===!0&&(t.texture.minFilter=jw,t.texture.generateMipmaps=!0),this.depth===!0&&(t.depthTexture=new Ga),this.renderTargets.set(e,t)),t}updateBefore(e){if(this.bounces===!1&&rw)return!1;rw=!0;const{scene:t,camera:n,renderer:i,material:s}=e,{target:a}=this,o=this.getVirtualCamera(n),l=this.getRenderTarget(o);i.getDrawingBufferSize(iw),this._updateResolution(l,i),Sv.setFromMatrixPosition(a.matrixWorld),yD.setFromMatrixPosition(n.matrixWorld),KS.extractRotation(a.matrixWorld),Jg.set(0,0,1),Jg.applyMatrix4(KS),QS.subVectors(Sv,yD);const c=QS.dot(Jg)>0;let d=!1;if(c===!0&&this.forceUpdate===!1){if(this.hasOutput===!1){rw=!1;return}d=!0}QS.reflect(Jg).negate(),QS.add(Sv),KS.extractRotation(n.matrixWorld),tw.set(0,0,-1),tw.applyMatrix4(KS),tw.add(yD),nw.subVectors(Sv,tw),nw.reflect(Jg).negate(),nw.add(Sv),o.coordinateSystem=n.coordinateSystem,o.position.copy(QS),o.up.set(0,1,0),o.up.applyMatrix4(KS),o.up.reflect(Jg),o.lookAt(nw),o.near=n.near,o.far=n.far,o.updateMatrixWorld(),o.projectionMatrix.copy(n.projectionMatrix),bv.setFromNormalAndCoplanarPoint(Jg,Sv),bv.applyMatrix4(o.matrixWorldInverse),$f.set(bv.normal.x,bv.normal.y,bv.normal.z,bv.constant);const p=o.projectionMatrix;JS.x=(Math.sign($f.x)+p.elements[8])/p.elements[0],JS.y=(Math.sign($f.y)+p.elements[9])/p.elements[5],JS.z=-1,JS.w=(1+p.elements[10])/p.elements[14],$f.multiplyScalar(1/$f.dot(JS));const y=0;p.elements[2]=$f.x,p.elements[6]=$f.y,p.elements[10]=i.coordinateSystem===Il?$f.z-y:$f.z+1-y,p.elements[14]=$f.w,this.textureNode.value=l.texture,this.depth===!0&&(this.textureNode.getDepthNode().value=l.depthTexture),s.visible=!1;const _=i.getRenderTarget(),v=i.getMRT(),b=i.autoClear;i.setMRT(null),i.setRenderTarget(l),i.autoClear=!0;const E=t.name;t.name=(t.name||"Scene")+" [ Reflector ]",d?(i.clear(),this.hasOutput=!1):(i.render(t,o),this.hasOutput=!0),t.name=E,i.setMRT(v),i.setRenderTarget(_),i.autoClear=b,s.visible=!0,rw=!1,this.forceUpdate=!1}get resolution(){return cr('ReflectorNode: The "resolution" property has been renamed to "resolutionScale".'),this.resolutionScale}set resolution(e){cr('ReflectorNode: The "resolution" property has been renamed to "resolutionScale".'),this.resolutionScale=e}}const qhe=r=>new YB(r),_D=new rc(-1,1,1,-1,0,1);class Xhe extends Qn{constructor(e=!1){super();const t=e===!1?[0,-1,0,1,2,1]:[0,2,0,0,2,0];this.setAttribute("position",new hn([-1,3,0,-1,-1,0,3,-1,0],3)),this.setAttribute("uv",new hn(t,2))}}const $he=new Xhe;class AN extends ar{constructor(e=null){super($he,e),this.camera=_D,this.isQuadMesh=!0}async renderAsync(e){cr('QuadMesh: "renderAsync()" has been deprecated. Use "render()" and "await renderer.init();" when creating the renderer.'),await e.init(),e.render(this,_D)}render(e){e.render(this,_D)}}const jhe=new tt;class Yhe extends gd{static get type(){return"RTTNode"}constructor(e,t=null,n=null,i={type:vi}){const s=new sf(t,n,i);super(s.texture,hr()),this.isRTTNode=!0,this.node=e,this.width=t,this.height=n,this.pixelRatio=1,this.renderTarget=s,this.textureNeedsUpdate=!0,this.autoUpdate=!0,this._rttNode=null,this._quadMesh=new AN(new ds),this.updateBeforeType=$n.RENDER}get autoResize(){return this.width===null}setup(e){return this._rttNode=this.node.context(e.getSharedContext()),this._quadMesh.material.name="RTT",this._quadMesh.material.needsUpdate=!0,super.setup(e)}setSize(e,t){this.width=e,this.height=t;const n=e*this.pixelRatio,i=t*this.pixelRatio;this.renderTarget.setSize(n,i),this.textureNeedsUpdate=!0}setPixelRatio(e){this.pixelRatio=e,this.setSize(this.width,this.height)}updateBefore({renderer:e}){if(this.textureNeedsUpdate===!1&&this.autoUpdate===!1)return;if(this.textureNeedsUpdate=!1,this.autoResize===!0){const i=e.getPixelRatio(),s=e.getSize(jhe),a=Math.floor(s.width*i),o=Math.floor(s.height*i);(a!==this.renderTarget.width||o!==this.renderTarget.height)&&(this.renderTarget.setSize(a,o),this.textureNeedsUpdate=!0)}let t="RTT";this.node.name&&(t=this.node.name+" [ "+t+" ]"),this._quadMesh.material.fragmentNode=this._rttNode,this._quadMesh.name=t;const n=e.getRenderTarget();e.setRenderTarget(this.renderTarget),this._quadMesh.render(e),e.setRenderTarget(n)}clone(){const e=new gd(this.value,this.uvNode,this.levelNode);return e.sampler=this.sampler,e.referenceNode=this,e}}const Lq=(r,...e)=>Xt(new Yhe(Xt(r),...e)),Zhe=(r,...e)=>r.isSampleNode||r.isTextureNode?r:r.isPassNode?r.getTextureNode():Lq(r,...e),Dv=Te(([r,e,t],n)=>{let i;n.renderer.coordinateSystem===Il?(r=St(r.x,r.y.oneMinus()).mul(2).sub(1),i=En(ge(r,e),1)):i=En(ge(r.x,r.y.oneMinus(),e).mul(2).sub(1),1);const s=En(t.mul(i));return s.xyz.div(s.w)}),Khe=Te(([r,e])=>{const t=e.mul(En(r,1)),n=t.xy.div(t.w).mul(.5).add(.5).toVar();return St(n.x,n.y.oneMinus())}),Qhe=Te(([r,e,t])=>{const n=wh(as(e)),i=Vs(r.mul(n)).toVar(),s=as(e,i).toVar(),a=as(e,i.sub(Vs(2,0))).toVar(),o=as(e,i.sub(Vs(1,0))).toVar(),l=as(e,i.add(Vs(1,0))).toVar(),c=as(e,i.add(Vs(2,0))).toVar(),d=as(e,i.add(Vs(0,2))).toVar(),p=as(e,i.add(Vs(0,1))).toVar(),y=as(e,i.sub(Vs(0,1))).toVar(),_=as(e,i.sub(Vs(0,2))).toVar(),v=Sr(_i(re(2).mul(o).sub(a),s)).toVar(),b=Sr(_i(re(2).mul(l).sub(c),s)).toVar(),E=Sr(_i(re(2).mul(p).sub(d),s)).toVar(),T=Sr(_i(re(2).mul(y).sub(_),s)).toVar(),M=Dv(r,s,t).toVar(),R=v.lessThan(b).select(M.sub(Dv(r.sub(St(re(1).div(n.x),0)),o,t)),M.negate().add(Dv(r.add(St(re(1).div(n.x),0)),l,t))),N=E.lessThan(T).select(M.sub(Dv(r.add(St(0,re(1).div(n.y))),p,t)),M.negate().add(Dv(r.sub(St(0,re(1).div(n.y))),y,t)));return al(Vh(R,N))}),ZB=Te(([r])=>Qc(re(52.9829189).mul(Qc(uc(r,St(.06711056,.00583715)))))).setLayout({name:"interleavedGradientNoise",type:"float",inputs:[{name:"position",type:"vec2"}]}),Xc=Te(([r,e,t])=>{const n=re(2.399963229728653),i=go(re(r).add(.5).div(re(e))),s=re(r).mul(n).add(t);return St(qc(s),Qo(s)).mul(i)}).setLayout({name:"vogelDiskSample",type:"vec2",inputs:[{name:"sampleIndex",type:"int"},{name:"samplesCount",type:"int"},{name:"phi",type:"float"}]});class Jhe extends on{static get type(){return"SampleNode"}constructor(e,t=null){super(),this.callback=e,this.uvNode=t,this.isSampleNode=!0}setup(){return this.sample(hr())}sample(e){return this.callback(e)}}const epe=(r,e=null)=>new Jhe(r,Xt(e));class Al extends on{static get type(){return"EventNode"}constructor(e,t){super("void"),this.eventType=e,this.callback=t,e===Al.OBJECT?this.updateType=$n.OBJECT:e===Al.MATERIAL?this.updateType=$n.RENDER:e===Al.BEFORE_OBJECT?this.updateBeforeType=$n.OBJECT:e===Al.BEFORE_MATERIAL&&(this.updateBeforeType=$n.RENDER)}update(e){this.callback(e)}updateBefore(e){this.callback(e)}}Al.OBJECT="object";Al.MATERIAL="material";Al.BEFORE_OBJECT="beforeObject";Al.BEFORE_MATERIAL="beforeMaterial";const wN=(r,e)=>new Al(r,e).toStack(),tpe=r=>wN(Al.OBJECT,r),npe=r=>wN(Al.MATERIAL,r),ipe=r=>wN(Al.BEFORE_OBJECT,r),rpe=r=>wN(Al.BEFORE_MATERIAL,r);class spe extends ic{constructor(e,t,n=Float32Array){const i=ArrayBuffer.isView(e)?e:new n(e*t);super(i,t),this.isStorageInstancedBufferAttribute=!0}}class ape extends Ji{constructor(e,t,n=Float32Array){const i=ArrayBuffer.isView(e)?e:new n(e*t);super(i,t),this.isStorageBufferAttribute=!0}}const ope=(r,e="float")=>{let t,n;e.isStruct===!0?(t=e.layout.getLength(),n=SR("float")):(t=YH(e),n=SR(e));const i=new ape(r,t,n);return Nh(i,e,r)},lpe=(r,e="float")=>{let t,n;e.isStruct===!0?(t=e.layout.getLength(),n=SR("float")):(t=YH(e),n=SR(e));const i=new spe(r,t,n);return Nh(i,e,r)};class upe extends on{static get type(){return"PointUVNode"}constructor(){super("vec2"),this.isPointUVNode=!0}generate(){return"vec2( gl_PointCoord.x, 1.0 - gl_PointCoord.y )"}}const cpe=kt(upe),eT=new ll,vD=new gn;class wl extends on{static get type(){return"SceneNode"}constructor(e=wl.BACKGROUND_BLURRINESS,t=null){super(),this.scope=e,this.scene=t}setup(e){const t=this.scope,n=this.scene!==null?this.scene:e.scene;let i;return t===wl.BACKGROUND_BLURRINESS?i=fr("backgroundBlurriness","float",n):t===wl.BACKGROUND_INTENSITY?i=fr("backgroundIntensity","float",n):t===wl.BACKGROUND_ROTATION?i=_n("mat4").setName("backgroundRotation").setGroup(yn).onRenderUpdate(()=>{const s=n.background;return s!==null&&s.isTexture&&s.mapping!==Uh?(eT.copy(n.backgroundRotation),eT.x*=-1,eT.y*=-1,eT.z*=-1,vD.makeRotationFromEuler(eT)):vD.identity(),vD}):Ze("SceneNode: Unknown scope:",t),i}}wl.BACKGROUND_BLURRINESS="backgroundBlurriness";wl.BACKGROUND_INTENSITY="backgroundIntensity";wl.BACKGROUND_ROTATION="backgroundRotation";const Pq=kt(wl,wl.BACKGROUND_BLURRINESS),_U=kt(wl,wl.BACKGROUND_INTENSITY),Bq=kt(wl,wl.BACKGROUND_ROTATION);class fpe extends gd{static get type(){return"StorageTextureNode"}constructor(e,t,n=null){super(e,t),this.storeNode=n,this.mipLevel=0,this.isStorageTextureNode=!0,this.access=Fa.WRITE_ONLY}getInputType(){return"storageTexture"}setup(e){super.setup(e);const t=e.getNodeProperties(this);return t.storeNode=this.storeNode,t}setAccess(e){return this.access=e,this}setMipLevel(e){return this.mipLevel=e,this}generate(e,t){let n;return this.storeNode!==null?n=this.generateStore(e):n=super.generate(e,t),n}toReadWrite(){return this.setAccess(Fa.READ_WRITE)}toReadOnly(){return this.setAccess(Fa.READ_ONLY)}toWriteOnly(){return this.setAccess(Fa.WRITE_ONLY)}generateStore(e){const t=e.getNodeProperties(this),{uvNode:n,storeNode:i,depthNode:s}=t,a=super.generate(e,"property"),o=n.build(e,this.value.is3DTexture===!0?"uvec3":"uvec2"),l=i.build(e,"vec4"),c=s?s.build(e,"int"):null,d=e.generateTextureStore(e,a,o,c,l);e.addLineFlowCode(d,this)}clone(){const e=super.clone();return e.storeNode=this.storeNode,e.mipLevel=this.mipLevel,e}}const Iq=Gn(fpe).setParameterLength(1,3),dpe=(r,e,t)=>{const n=Iq(r,e,t);return t!==null&&n.toStack(),n},hpe=Te(({texture:r,uv:e})=>{const n=ge().toVar();return Tn(e.x.lessThan(1e-4),()=>{n.assign(ge(1,0,0))}).ElseIf(e.y.lessThan(1e-4),()=>{n.assign(ge(0,1,0))}).ElseIf(e.z.lessThan(1e-4),()=>{n.assign(ge(0,0,1))}).ElseIf(e.x.greaterThan(1-1e-4),()=>{n.assign(ge(-1,0,0))}).ElseIf(e.y.greaterThan(1-1e-4),()=>{n.assign(ge(0,-1,0))}).ElseIf(e.z.greaterThan(1-1e-4),()=>{n.assign(ge(0,0,-1))}).Else(()=>{const s=r.sample(e.add(ge(-.01,0,0))).r.sub(r.sample(e.add(ge(.01,0,0))).r),a=r.sample(e.add(ge(0,-.01,0))).r.sub(r.sample(e.add(ge(0,.01,0))).r),o=r.sample(e.add(ge(0,0,-.01))).r.sub(r.sample(e.add(ge(0,0,.01))).r);n.assign(ge(s,a,o))}),n.normalize()});class ppe extends gd{static get type(){return"Texture3DNode"}constructor(e,t=null,n=null){super(e,t,n),this.isTexture3DNode=!0}getInputType(){return"texture3D"}getDefaultUV(){return ge(.5,.5,.5)}setUpdateMatrix(){}setupUV(e,t){const n=this.value;return e.isFlipY()&&(n.isRenderTargetTexture===!0||n.isFramebufferTexture===!0)&&(this.sampler?t=t.flipY():t=t.setY(de(wh(this,this.levelNode).y).sub(t.y).sub(1))),t}generateUV(e,t){return t.build(e,this.sampler===!0?"vec3":"ivec3")}generateOffset(e,t){return t.build(e,"ivec3")}normal(e){return hpe({texture:this,uv:e})}}const RN=Gn(ppe).setParameterLength(1,3),mpe=(...r)=>RN(...r).setSampler(!1),gpe=(r,e,t)=>RN(r,e).level(t);class ype extends yN{static get type(){return"UserDataNode"}constructor(e,t,n=null){super(e,t,n),this.userData=n}updateReference(e){return this.reference=this.userData!==null?this.userData:e.object.userData,this.reference}}const _pe=(r,e,t)=>new ype(r,e,t),vG=new WeakMap;class vpe extends Qr{static get type(){return"VelocityNode"}constructor(){super("vec2"),this.projectionMatrix=null,this.updateType=$n.OBJECT,this.updateAfterType=$n.OBJECT,this.previousModelWorldMatrix=_n(new gn),this.previousProjectionMatrix=_n(new gn).setGroup(yn),this.previousCameraViewMatrix=_n(new gn)}setProjectionMatrix(e){this.projectionMatrix=e}update({frameId:e,camera:t,object:n}){const i=xG(n);this.previousModelWorldMatrix.value.copy(i);const s=Fq(t);s.frameId!==e&&(s.frameId=e,s.previousProjectionMatrix===void 0?(s.previousProjectionMatrix=new gn,s.previousCameraViewMatrix=new gn,s.currentProjectionMatrix=new gn,s.currentCameraViewMatrix=new gn,s.previousProjectionMatrix.copy(this.projectionMatrix||t.projectionMatrix),s.previousCameraViewMatrix.copy(t.matrixWorldInverse)):(s.previousProjectionMatrix.copy(s.currentProjectionMatrix),s.previousCameraViewMatrix.copy(s.currentCameraViewMatrix)),s.currentProjectionMatrix.copy(this.projectionMatrix||t.projectionMatrix),s.currentCameraViewMatrix.copy(t.matrixWorldInverse),this.previousProjectionMatrix.value.copy(s.previousProjectionMatrix),this.previousCameraViewMatrix.value.copy(s.previousCameraViewMatrix))}updateAfter({object:e}){xG(e).copy(e.matrixWorld)}setup(){const e=this.projectionMatrix===null?Ch:_n(this.projectionMatrix),t=this.previousCameraViewMatrix.mul(this.previousModelWorldMatrix),n=e.mul(Hm).mul(Yr),i=this.previousProjectionMatrix.mul(t).mul(DR),s=n.xy.div(n.w),a=i.xy.div(i.w);return _i(s,a)}}function Fq(r){let e=vG.get(r);return e===void 0&&(e={},vG.set(r,e)),e}function xG(r,e=0){const t=Fq(r);let n=t[e];return n===void 0&&(t[e]=n=new gn,t[e].copy(r.matrixWorld)),n}const xpe=kt(vpe),bpe=Te(([r])=>KB(r.rgb)),Spe=Te(([r,e=re(1)])=>e.mix(KB(r.rgb),r.rgb)),Tpe=Te(([r,e=re(1)])=>{const t=Ns(r.r,r.g,r.b).div(3),n=r.r.max(r.g.max(r.b)),i=n.sub(t).mul(e).mul(-3);return yi(r.rgb,n,i)}),Epe=Te(([r,e=re(1)])=>{const t=ge(.57735,.57735,.57735),n=e.cos();return ge(r.rgb.mul(n).add(t.cross(r.rgb).mul(e.sin()).add(t.mul(uc(t,r.rgb).mul(n.oneMinus())))))}),KB=(r,e=ge(Nn.getLuminanceCoefficients(new ne)))=>uc(r,e),Mpe=Te(([r,e=ge(1),t=ge(0),n=ge(1),i=re(1),s=ge(Nn.getLuminanceCoefficients(new ne,vu))])=>{const a=r.rgb.dot(ge(s)),o=Kr(r.rgb.mul(e).add(t),0).toVar(),l=o.pow(n).toVar();return Tn(o.r.greaterThan(0),()=>{o.r.assign(l.r)}),Tn(o.g.greaterThan(0),()=>{o.g.assign(l.g)}),Tn(o.b.greaterThan(0),()=>{o.b.assign(l.b)}),o.assign(a.add(o.sub(a).mul(i))),En(o.rgb,r.a)});class Ape extends Qr{static get type(){return"PosterizeNode"}constructor(e,t){super(),this.sourceNode=e,this.stepsNode=t}setup(){const{sourceNode:e,stepsNode:t}=this;return e.mul(t).floor().div(t)}}const wpe=Gn(Ape).setParameterLength(2),sw=new tt;class zq extends gd{static get type(){return"PassTextureNode"}constructor(e,t){super(t),this.passNode=e,this.setUpdateMatrix(!1)}setup(e){return this.passNode.build(e),super.setup(e)}clone(){return new this.constructor(this.passNode,this.value)}}class bG extends zq{static get type(){return"PassMultipleTextureNode"}constructor(e,t,n=!1){super(e,null),this.textureName=t,this.previousTexture=n}updateTexture(){this.value=this.previousTexture?this.passNode.getPreviousTexture(this.textureName):this.passNode.getTexture(this.textureName)}setup(e){return this.updateTexture(),super.setup(e)}clone(){const e=new this.constructor(this.passNode,this.textureName,this.previousTexture);return e.uvNode=this.uvNode,e.levelNode=this.levelNode,e.biasNode=this.biasNode,e.sampler=this.sampler,e.depthNode=this.depthNode,e.compareNode=this.compareNode,e.gradNode=this.gradNode,e.offsetNode=this.offsetNode,e}}class yd extends Qr{static get type(){return"PassNode"}constructor(e,t,n,i={}){super("vec4"),this.scope=e,this.scene=t,this.camera=n,this.options=i,this._pixelRatio=1,this._width=1,this._height=1;const s=new Ga;s.isRenderTargetTexture=!0,s.name="depth";const a=new sf(this._width*this._pixelRatio,this._height*this._pixelRatio,{type:vi,...i});a.texture.name="output",a.depthTexture=s,this.renderTarget=a,this.overrideMaterial=null,this.transparent=!0,this.opaque=!0,this.contextNode=null,this._contextNodeCache=null,this._textures={output:a.texture,depth:s},this._textureNodes={},this._linearDepthNodes={},this._viewZNodes={},this._previousTextures={},this._previousTextureNodes={},this._cameraNear=_n(0),this._cameraFar=_n(0),this._mrt=null,this._layers=null,this._resolutionScale=1,this._viewport=null,this._scissor=null,this.isPassNode=!0,this.updateBeforeType=$n.FRAME,this.global=!0}setResolutionScale(e){return this._resolutionScale=e,this}getResolutionScale(){return this._resolutionScale}setResolution(e){return Ve("PassNode: .setResolution() is deprecated. Use .setResolutionScale() instead."),this.setResolutionScale(e)}getResolution(){return Ve("PassNode: .getResolution() is deprecated. Use .getResolutionScale() instead."),this.getResolutionScale()}setLayers(e){return this._layers=e,this}getLayers(){return this._layers}setMRT(e){return this._mrt=e,this}getMRT(){return this._mrt}getTexture(e){let t=this._textures[e];return t===void 0&&(t=this.renderTarget.texture.clone(),t.name=e,this._textures[e]=t,this.renderTarget.textures.push(t)),t}getPreviousTexture(e){let t=this._previousTextures[e];return t===void 0&&(t=this.getTexture(e).clone(),this._previousTextures[e]=t),t}toggleTexture(e){const t=this._previousTextures[e];if(t!==void 0){const n=this._textures[e],i=this.renderTarget.textures.indexOf(n);this.renderTarget.textures[i]=t,this._textures[e]=t,this._previousTextures[e]=n,this._textureNodes[e].updateTexture(),this._previousTextureNodes[e].updateTexture()}}getTextureNode(e="output"){let t=this._textureNodes[e];return t===void 0&&(t=new bG(this,e),t.updateTexture(),this._textureNodes[e]=t),t}getPreviousTextureNode(e="output"){let t=this._previousTextureNodes[e];return t===void 0&&(this._textureNodes[e]===void 0&&this.getTextureNode(e),t=new bG(this,e,!0),t.updateTexture(),this._previousTextureNodes[e]=t),t}getViewZNode(e="depth"){let t=this._viewZNodes[e];if(t===void 0){const n=this._cameraNear,i=this._cameraFar;this._viewZNodes[e]=t=IB(this.getTextureNode(e),n,i)}return t}getLinearDepthNode(e="depth"){let t=this._linearDepthNodes[e];if(t===void 0){const n=this._cameraNear,i=this._cameraFar,s=this.getViewZNode(e);this._linearDepthNodes[e]=t=Jv(s,n,i)}return t}async compileAsync(e){const t=e.getRenderTarget(),n=e.getMRT();e.setRenderTarget(this.renderTarget),e.setMRT(this._mrt),await e.compileAsync(this.scene,this.camera),e.setRenderTarget(t),e.setMRT(n)}setup({renderer:e}){return this.renderTarget.samples=this.options.samples===void 0?e.samples:this.options.samples,this.renderTarget.texture.type=e.getOutputBufferType(),this.scope===yd.COLOR?this.getTextureNode():this.getLinearDepthNode()}updateBefore(e){const{renderer:t}=e,{scene:n}=this;let i,s;const a=t.getOutputRenderTarget();a&&a.isXRRenderTarget===!0?(s=1,i=t.xr.getCamera(),t.xr.updateCamera(i),sw.set(a.width,a.height)):(i=this.camera,s=t.getPixelRatio(),t.getSize(sw)),this._pixelRatio=s,this.setSize(sw.width,sw.height);const o=t.getRenderTarget(),l=t.getMRT(),c=t.autoClear,d=t.transparent,p=t.opaque,y=i.layers.mask,_=t.contextNode,v=n.overrideMaterial;this._cameraNear.value=i.near,this._cameraFar.value=i.far,this._layers!==null&&(i.layers.mask=this._layers.mask);for(const E in this._previousTextures)this.toggleTexture(E);this.overrideMaterial!==null&&(n.overrideMaterial=this.overrideMaterial),t.setRenderTarget(this.renderTarget),t.setMRT(this._mrt),t.autoClear=!0,t.transparent=this.transparent,t.opaque=this.opaque,this.contextNode!==null&&((this._contextNodeCache===null||this._contextNodeCache.version!==this.version)&&(this._contextNodeCache={version:this.version,context:jh({...t.contextNode.getFlowContextData(),...this.contextNode.getFlowContextData()})}),t.contextNode=this._contextNodeCache.context);const b=n.name;n.name=this.name?this.name:n.name,t.render(n,i),n.name=b,n.overrideMaterial=v,t.setRenderTarget(o),t.setMRT(l),t.autoClear=c,t.transparent=d,t.opaque=p,t.contextNode=_,i.layers.mask=y}setSize(e,t){this._width=e,this._height=t;const n=Math.floor(this._width*this._pixelRatio*this._resolutionScale),i=Math.floor(this._height*this._pixelRatio*this._resolutionScale);this.renderTarget.setSize(n,i),this._scissor!==null&&this.renderTarget.scissor.copy(this._scissor),this._viewport!==null&&this.renderTarget.viewport.copy(this._viewport)}setScissor(e,t,n,i){e===null?this._scissor=null:(this._scissor===null&&(this._scissor=new zn),e.isVector4?this._scissor.copy(e):this._scissor.set(e,t,n,i),this._scissor.multiplyScalar(this._pixelRatio*this._resolutionScale).floor())}setViewport(e,t,n,i){e===null?this._viewport=null:(this._viewport===null&&(this._viewport=new zn),e.isVector4?this._viewport.copy(e):this._viewport.set(e,t,n,i),this._viewport.multiplyScalar(this._pixelRatio*this._resolutionScale).floor())}setPixelRatio(e){this._pixelRatio=e,this.setSize(this._width,this._height)}dispose(){this.renderTarget.dispose()}}yd.COLOR="color";yd.DEPTH="depth";const Rpe=(r,e,t)=>new yd(yd.COLOR,r,e,t),Cpe=(r,e)=>new zq(r,e),Npe=(r,e,t)=>new yd(yd.DEPTH,r,e,t);class Dpe extends yd{static get type(){return"ToonOutlinePassNode"}constructor(e,t,n,i,s){super(yd.COLOR,e,t),this.colorNode=n,this.thicknessNode=i,this.alphaNode=s,this._materialCache=new WeakMap,this.name="Outline Pass"}updateBefore(e){const{renderer:t}=e,n=t.getRenderObjectFunction();t.setRenderObjectFunction((i,s,a,o,l,c,d,p)=>{if((l.isMeshToonMaterial||l.isMeshToonNodeMaterial)&&l.wireframe===!1){const y=this._getOutlineMaterial(l);t.renderObject(i,s,a,o,y,c,d,p)}t.renderObject(i,s,a,o,l,c,d,p)}),super.updateBefore(e),t.setRenderObjectFunction(n)}_createMaterial(){const e=new ds;e.isMeshToonOutlineMaterial=!0,e.name="Toon_Outline",e.side=gr;const t=Vl.negate(),n=Ch.mul(Hm),i=re(1),s=n.mul(En(Yr,1)),a=n.mul(En(Yr.add(t),1)),o=al(s.sub(a));return e.vertexNode=s.add(o.mul(this.thicknessNode).mul(s.w).mul(i)),e.colorNode=En(this.colorNode,this.alphaNode),e}_getOutlineMaterial(e){let t=this._materialCache.get(e);return t===void 0&&(t=this._createMaterial(),this._materialCache.set(e,t)),t}}const Ope=(r,e,t=new Kt(0,0,0),n=.003,i=1)=>Xt(new Dpe(r,e,Xt(t),Xt(n),Xt(i))),Vq=Te(([r,e])=>r.mul(e).clamp()).setLayout({name:"linearToneMapping",type:"vec3",inputs:[{name:"color",type:"vec3"},{name:"exposure",type:"float"}]}),Gq=Te(([r,e])=>(r=r.mul(e),r.div(r.add(1)).clamp())).setLayout({name:"reinhardToneMapping",type:"vec3",inputs:[{name:"color",type:"vec3"},{name:"exposure",type:"float"}]}),kq=Te(([r,e])=>{r=r.mul(e),r=r.sub(.004).max(0);const t=r.mul(r.mul(6.2).add(.5)),n=r.mul(r.mul(6.2).add(1.7)).add(.06);return t.div(n).pow(2.2)}).setLayout({name:"cineonToneMapping",type:"vec3",inputs:[{name:"color",type:"vec3"},{name:"exposure",type:"float"}]}),Upe=Te(([r])=>{const e=r.mul(r.add(.0245786)).sub(90537e-9),t=r.mul(r.add(.432951).mul(.983729)).add(.238081);return e.div(t)}),Hq=Te(([r,e])=>{const t=Ha(.59719,.35458,.04823,.076,.90834,.01566,.0284,.13383,.83777),n=Ha(1.60475,-.53108,-.07367,-.10208,1.10813,-.00605,-.00327,-.07276,1.07602);return r=r.mul(e).div(.6),r=t.mul(r),r=Upe(r),r=n.mul(r),r.clamp()}).setLayout({name:"acesFilmicToneMapping",type:"vec3",inputs:[{name:"color",type:"vec3"},{name:"exposure",type:"float"}]}),Lpe=Ha(ge(1.6605,-.1246,-.0182),ge(-.5876,1.1329,-.1006),ge(-.0728,-.0083,1.1187)),Ppe=Ha(ge(.6274,.0691,.0164),ge(.3293,.9195,.088),ge(.0433,.0113,.8956)),Bpe=Te(([r])=>{const e=ge(r).toVar(),t=ge(e.mul(e)).toVar(),n=ge(t.mul(t)).toVar();return re(15.5).mul(n.mul(t)).sub(Vn(40.14,n.mul(e))).add(Vn(31.96,n).sub(Vn(6.868,t.mul(e))).add(Vn(.4298,t).add(Vn(.1191,e).sub(.00232))))}),Wq=Te(([r,e])=>{const t=ge(r).toVar(),n=Ha(ge(.856627153315983,.137318972929847,.11189821299995),ge(.0951212405381588,.761241990602591,.0767994186031903),ge(.0482516061458583,.101439036467562,.811302368396859)),i=Ha(ge(1.1271005818144368,-.1413297634984383,-.14132976349843826),ge(-.11060664309660323,1.157823702216272,-.11060664309660294),ge(-.016493938717834573,-.016493938717834257,1.2519364065950405)),s=re(-12.47393),a=re(4.026069);return t.mulAssign(e),t.assign(Ppe.mul(t)),t.assign(n.mul(t)),t.assign(Kr(t,1e-10)),t.assign(od(t)),t.assign(t.sub(s).div(a.sub(s))),t.assign(Jc(t,0,1)),t.assign(Bpe(t)),t.assign(i.mul(t)),t.assign(Ju(Kr(ge(0),t),ge(2.2))),t.assign(Lpe.mul(t)),t.assign(Jc(t,0,1)),t}).setLayout({name:"agxToneMapping",type:"vec3",inputs:[{name:"color",type:"vec3"},{name:"exposure",type:"float"}]}),qq=Te(([r,e])=>{const t=re(.76),n=re(.15);r=r.mul(e);const i=zl(r.r,zl(r.g,r.b)),s=za(i.lessThan(.08),i.sub(Vn(6.25,i.mul(i))),.04);r.subAssign(s);const a=Kr(r.r,Kr(r.g,r.b));Tn(a.lessThan(t),()=>r);const o=_i(1,t),l=_i(1,o.mul(o).div(a.add(o.sub(t))));r.mulAssign(l.div(a));const c=_i(1,Su(1,n.mul(a.sub(l)).add(1)));return yi(r,ge(l),c)}).setLayout({name:"neutralToneMapping",type:"vec3",inputs:[{name:"color",type:"vec3"},{name:"exposure",type:"float"}]});class ga extends on{static get type(){return"CodeNode"}constructor(e="",t=[],n=""){super("code"),this.isCodeNode=!0,this.global=!0,this.code=e,this.includes=t,this.language=n}setIncludes(e){return this.includes=e,this}getIncludes(){return this.includes}generate(e){const t=this.getIncludes(e);for(const i of t)i.build(e);const n=e.getCodeFromNode(this,this.getNodeType(e));return n.code=this.code,n.code}serialize(e){super.serialize(e),e.code=this.code,e.language=this.language}deserialize(e){super.deserialize(e),this.code=e.code,this.language=e.language}}const CN=Gn(ga).setParameterLength(1,3),Ipe=(r,e)=>CN(r,e,"js"),Fpe=(r,e)=>CN(r,e,"wgsl"),zpe=(r,e)=>CN(r,e,"glsl");class Xq extends ga{static get type(){return"FunctionNode"}constructor(e="",t=[],n=""){super(e,t,n)}getNodeType(e){return this.getNodeFunction(e).type}getMemberType(e,t){const n=this.getNodeType(e);return e.getStructTypeNode(n).getMemberType(e,t)}getInputs(e){return this.getNodeFunction(e).inputs}getNodeFunction(e){const t=e.getDataFromNode(this);let n=t.nodeFunction;return n===void 0&&(n=e.parser.parseFunction(this.code),t.nodeFunction=n),n}generate(e,t){super.generate(e);const n=this.getNodeFunction(e),i=n.name,s=n.type,a=e.getCodeFromNode(this,s);i!==""&&(a.name=i);const o=e.getPropertyName(a),l=this.getNodeFunction(e).getCode(o);return a.code=l+`
`,t==="property"?o:e.format(`${o}()`,s,t)}}const $q=(r,e=[],t="")=>{for(let s=0;s<e.length;s++){const a=e[s];typeof a=="function"&&(e[s]=a.functionNode)}const n=new Xq(r,e,t),i=(...s)=>n.call(...s);return i.functionNode=n,i},Vpe=(r,e)=>$q(r,e,"glsl"),Gpe=(r,e)=>$q(r,e,"wgsl");class kpe extends on{static get type(){return"ScriptableValueNode"}constructor(e=null){super(),this._value=e,this._cache=null,this.inputType=null,this.outputType=null,this.events=new Gl,this.isScriptableValueNode=!0}get isScriptableOutputNode(){return this.outputType!==null}set value(e){this._value!==e&&(this._cache&&this.inputType==="URL"&&this.value.value instanceof ArrayBuffer&&(URL.revokeObjectURL(this._cache),this._cache=null),this._value=e,this.events.dispatchEvent({type:"change"}),this.refresh())}get value(){return this._value}refresh(){this.events.dispatchEvent({type:"refresh"})}getValue(){const e=this.value;if(e&&this._cache===null&&this.inputType==="URL"&&e.value instanceof ArrayBuffer)this._cache=URL.createObjectURL(new Blob([e.value]));else if(e&&e.value!==null&&e.value!==void 0&&((this.inputType==="URL"||this.inputType==="String")&&typeof e.value=="string"||this.inputType==="Number"&&typeof e.value=="number"||this.inputType==="Vector2"&&e.value.isVector2||this.inputType==="Vector3"&&e.value.isVector3||this.inputType==="Vector4"&&e.value.isVector4||this.inputType==="Color"&&e.value.isColor||this.inputType==="Matrix3"&&e.value.isMatrix3||this.inputType==="Matrix4"&&e.value.isMatrix4))return e.value;return this._cache||e}getNodeType(e){return this.value&&this.value.isNode?this.value.getNodeType(e):"float"}setup(){return this.value&&this.value.isNode?this.value:re()}serialize(e){super.serialize(e),this.value!==null?this.inputType==="ArrayBuffer"?e.value=KH(this.value):e.value=this.value?this.value.toJSON(e.meta).uuid:null:e.value=null,e.inputType=this.inputType,e.outputType=this.outputType}deserialize(e){super.deserialize(e);let t=null;e.value!==null&&(e.inputType==="ArrayBuffer"?t=QH(e.value):e.inputType==="Texture"?t=e.meta.textures[e.value]:t=e.meta.nodes[e.value]||null),this.value=t,this.inputType=e.inputType,this.outputType=e.outputType}}const Ww=Gn(kpe).setParameterLength(1);class jq extends Map{get(e,t=null,...n){if(this.has(e))return super.get(e);if(t!==null){const i=t(...n);return this.set(e,i),i}}}class Hpe{constructor(e){this.scriptableNode=e}get parameters(){return this.scriptableNode.parameters}get layout(){return this.scriptableNode.getLayout()}getInputLayout(e){return this.scriptableNode.getInputLayout(e)}get(e){const t=this.parameters[e];return t?t.getValue():null}}const qw=new jq;class Wpe extends on{static get type(){return"ScriptableNode"}constructor(e=null,t={}){super(),this.codeNode=e,this.parameters=t,this._local=new jq,this._output=Ww(null),this._outputs={},this._source=this.source,this._method=null,this._object=null,this._value=null,this._needsOutputUpdate=!0,this.onRefresh=this.onRefresh.bind(this),this.isScriptableNode=!0}get source(){return this.codeNode?this.codeNode.code:""}setLocal(e,t){return this._local.set(e,t)}getLocal(e){return this._local.get(e)}onRefresh(){this._refresh()}getInputLayout(e){for(const t of this.getLayout())if(t.inputType&&(t.id===e||t.name===e))return t}getOutputLayout(e){for(const t of this.getLayout())if(t.outputType&&(t.id===e||t.name===e))return t}setOutput(e,t){const n=this._outputs;return n[e]===void 0?n[e]=Ww(t):n[e].value=t,this}getOutput(e){return this._outputs[e]}getParameter(e){return this.parameters[e]}setParameter(e,t){const n=this.parameters;return t&&t.isScriptableNode?(this.deleteParameter(e),n[e]=t,n[e].getDefaultOutput().events.addEventListener("refresh",this.onRefresh)):t&&t.isScriptableValueNode?(this.deleteParameter(e),n[e]=t,n[e].events.addEventListener("refresh",this.onRefresh)):n[e]===void 0?(n[e]=Ww(t),n[e].events.addEventListener("refresh",this.onRefresh)):n[e].value=t,this}getValue(){return this.getDefaultOutput().getValue()}deleteParameter(e){let t=this.parameters[e];return t&&(t.isScriptableNode&&(t=t.getDefaultOutput()),t.events.removeEventListener("refresh",this.onRefresh)),this}clearParameters(){for(const e of Object.keys(this.parameters))this.deleteParameter(e);return this.needsUpdate=!0,this}call(e,...t){const i=this.getObject()[e];if(typeof i=="function")return i(...t)}async callAsync(e,...t){const i=this.getObject()[e];if(typeof i=="function")return i.constructor.name==="AsyncFunction"?await i(...t):i(...t)}getNodeType(e){return this.getDefaultOutputNode().getNodeType(e)}refresh(e=null){e!==null?this.getOutput(e).refresh():this._refresh()}getObject(){if(this.needsUpdate&&this.dispose(),this._object!==null)return this._object;const e=()=>this.refresh(),t=(c,d)=>this.setOutput(c,d),n=new Hpe(this),i=qw.get("THREE"),s=qw.get("TSL"),a=this.getMethod(),o=[n,this._local,qw,e,t,i,s];this._object=a(...o);const l=this._object.layout;if(l&&(l.cache===!1&&this._local.clear(),this._output.outputType=l.outputType||null,Array.isArray(l.elements)))for(const c of l.elements){const d=c.id||c.name;c.inputType&&(this.getParameter(d)===void 0&&this.setParameter(d,null),this.getParameter(d).inputType=c.inputType),c.outputType&&(this.getOutput(d)===void 0&&this.setOutput(d,null),this.getOutput(d).outputType=c.outputType)}return this._object}deserialize(e){super.deserialize(e);for(const t in this.parameters){let n=this.parameters[t];n.isScriptableNode&&(n=n.getDefaultOutput()),n.events.addEventListener("refresh",this.onRefresh)}}getLayout(){return this.getObject().layout}getDefaultOutputNode(){const e=this.getDefaultOutput().value;return e&&e.isNode?e:re()}getDefaultOutput(){return this._exec()._output}getMethod(){if(this.needsUpdate&&this.dispose(),this._method!==null)return this._method;const e=["parameters","local","global","refresh","setOutput","THREE","TSL"],n=["layout","init","main","dispose"].join(", "),i="var "+n+`; var output = {};
`,s=`
return { ...output, `+n+" };",a=i+this.codeNode.code+s;return this._method=new Function(...e,a),this._method}dispose(){this._method!==null&&(this._object&&typeof this._object.dispose=="function"&&this._object.dispose(),this._method=null,this._object=null,this._source=null,this._value=null,this._needsOutputUpdate=!0,this._output.value=null,this._outputs={})}setup(){return this.getDefaultOutputNode()}getCacheKey(e){const t=[iE(this.source),this.getDefaultOutputNode().getCacheKey(e)];for(const n in this.parameters)t.push(this.parameters[n].getCacheKey(e));return Xx(t)}set needsUpdate(e){e===!0&&this.dispose()}get needsUpdate(){return this.source!==this._source}_exec(){return this.codeNode===null?this:(this._needsOutputUpdate===!0&&(this._value=this.call("main"),this._needsOutputUpdate=!1),this._output.value=this._value,this)}_refresh(){this.needsUpdate=!0,this._exec(),this._output.refresh()}}const qpe=Gn(Wpe).setParameterLength(1,2);function Yq(r){let e;const t=r.context.getViewZ;return t!==void 0&&(e=t(this)),(e||xs.z).negate()}const QB=Te(([r,e],t)=>{const n=Yq(t);return ef(r,e,n)}),JB=Te(([r],e)=>{const t=Yq(e);return r.mul(r,t,t).negate().exp().oneMinus()}),R1=Te(([r,e])=>En(e.toFloat().mix(Zv.rgb,r.toVec3()),Zv.a));function Xpe(r,e,t){return Ve('TSL: "rangeFog( color, near, far )" is deprecated. Use "fog( color, rangeFogFactor( near, far ) )" instead.'),R1(r,QB(e,t))}function $pe(r,e){return Ve('TSL: "densityFog( color, density )" is deprecated. Use "fog( color, densityFogFactor( density ) )" instead.'),R1(r,JB(e))}let e0=null,t0=null;class jpe extends on{static get type(){return"RangeNode"}constructor(e=re(),t=re()){super(),this.minNode=e,this.maxNode=t}getVectorLength(e){const t=this.getConstNode(this.minNode),n=this.getConstNode(this.maxNode),i=e.getTypeLength(cm(t.value)),s=e.getTypeLength(cm(n.value));return i>s?i:s}getNodeType(e){return e.object.count>1?e.getTypeFromLength(this.getVectorLength(e)):"float"}getConstNode(e){let t=null;if(e.traverse(n=>{n.isConstNode===!0&&(t=n)}),t===null)throw new Error('THREE.TSL: No "ConstNode" found in node graph.');return t}setup(e){const t=e.object;let n=null;if(t.count>1){const i=this.getConstNode(this.minNode),s=this.getConstNode(this.maxNode),a=i.value,o=s.value,l=e.getTypeLength(cm(a)),c=e.getTypeLength(cm(o));e0=e0||new zn,t0=t0||new zn,e0.setScalar(0),t0.setScalar(0),l===1?e0.setScalar(a):a.isColor?e0.set(a.r,a.g,a.b,1):e0.set(a.x,a.y,a.z||0,a.w||0),c===1?t0.setScalar(o):o.isColor?t0.set(o.r,o.g,o.b,1):t0.set(o.x,o.y,o.z||0,o.w||0);const d=4,p=d*t.count,y=new Float32Array(p);for(let v=0;v<p;v++){const b=v%d,E=e0.getComponent(b),T=t0.getComponent(b);y[v]=oL.lerp(E,T,Math.random())}const _=this.getNodeType(e);if(t.count<=4096)n=aE(y,"vec4",t.count).element(fd).convert(_);else{const v=new ic(y,4);e.geometry.setAttribute("__range"+this.id,v),n=NR(v).convert(_)}}else n=re(0);return n}}const Ype=Gn(jpe).setParameterLength(2);class Zpe extends on{static get type(){return"ComputeBuiltinNode"}constructor(e,t){super(t),this._builtinName=e}getHash(e){return this.getBuiltinName(e)}getNodeType(){return this.nodeType}setBuiltinName(e){return this._builtinName=e,this}getBuiltinName(){return this._builtinName}hasBuiltin(e){return e.hasBuiltin(this._builtinName)}generate(e,t){const n=this.getBuiltinName(e),i=this.getNodeType(e);return e.shaderStage==="compute"?e.format(n,i,t):(Ve(`ComputeBuiltinNode: Compute built-in value ${n} can not be accessed in the ${e.shaderStage} stage`),e.generateConst(i))}serialize(e){super.serialize(e),e.global=this.global,e._builtinName=this._builtinName}deserialize(e){super.deserialize(e),this.global=e.global,this._builtinName=e._builtinName}}const fE=(r,e)=>new Zpe(r,e),Kpe=fE("numWorkgroups","uvec3"),Qpe=fE("workgroupId","uvec3"),Jpe=fE("globalId","uvec3"),eme=fE("localId","uvec3"),tme=fE("subgroupSize","uint");class nme extends on{constructor(e){super(),this.scope=e}generate(e){const{scope:t}=this,{renderer:n}=e;n.backend.isWebGLBackend===!0?e.addFlowCode(`	// ${t}Barrier 
`):e.addLineFlowCode(`${t}Barrier()`,this)}}const eI=Gn(nme),ime=()=>eI("workgroup").toStack(),rme=()=>eI("storage").toStack(),sme=()=>eI("texture").toStack();class ame extends Uy{constructor(e,t){super(e,t),this.isWorkgroupInfoElementNode=!0}generate(e,t){let n;const i=e.context.assign;if(n=super.generate(e),i!==!0){const s=this.getNodeType(e);n=e.format(n,s,t)}return n}}class ome extends on{constructor(e,t,n=0){super(t),this.bufferType=t,this.bufferCount=n,this.isWorkgroupInfoNode=!0,this.elementType=t,this.scope=e,this.name=""}setName(e){return this.name=e,this}label(e){return Ve('TSL: "label()" has been deprecated. Use "setName()" instead.'),this.setName(e)}setScope(e){return this.scope=e,this}getElementType(){return this.elementType}getInputType(){return`${this.scope}Array`}element(e){return new ame(this,e)}generate(e){const t=this.name!==""?this.name:`${this.scope}Array_${this.id}`;return e.getScopedArray(t,this.scope.toLowerCase(),this.bufferType,this.bufferCount)}}const lme=(r,e)=>new ome("Workgroup",r,e);class ra extends on{static get type(){return"AtomicFunctionNode"}constructor(e,t,n){super("uint"),this.method=e,this.pointerNode=t,this.valueNode=n,this.parents=!0}getInputType(e){return this.pointerNode.getNodeType(e)}getNodeType(e){return this.getInputType(e)}generate(e){const t=e.getNodeProperties(this),n=t.parents,i=this.method,s=this.getNodeType(e),a=this.getInputType(e),o=this.pointerNode,l=this.valueNode,c=[];c.push(`&${o.build(e,a)}`),l!==null&&c.push(l.build(e,a));const d=`${e.getMethod(i,s)}( ${c.join(", ")} )`;if(n?n.length===1&&n[0].isStackNode===!0:!1)e.addLineFlowCode(d,this);else return t.constNode===void 0&&(t.constNode=Gh(d,s).toConst()),t.constNode.build(e)}}ra.ATOMIC_LOAD="atomicLoad";ra.ATOMIC_STORE="atomicStore";ra.ATOMIC_ADD="atomicAdd";ra.ATOMIC_SUB="atomicSub";ra.ATOMIC_MAX="atomicMax";ra.ATOMIC_MIN="atomicMin";ra.ATOMIC_AND="atomicAnd";ra.ATOMIC_OR="atomicOr";ra.ATOMIC_XOR="atomicXor";const ume=Gn(ra),Sd=(r,e,t)=>ume(r,e,t).toStack(),cme=r=>Sd(ra.ATOMIC_LOAD,r,null),fme=(r,e)=>Sd(ra.ATOMIC_STORE,r,e),dme=(r,e)=>Sd(ra.ATOMIC_ADD,r,e),hme=(r,e)=>Sd(ra.ATOMIC_SUB,r,e),pme=(r,e)=>Sd(ra.ATOMIC_MAX,r,e),mme=(r,e)=>Sd(ra.ATOMIC_MIN,r,e),gme=(r,e)=>Sd(ra.ATOMIC_AND,r,e),yme=(r,e)=>Sd(ra.ATOMIC_OR,r,e),_me=(r,e)=>Sd(ra.ATOMIC_XOR,r,e);class jt extends Qr{static get type(){return"SubgroupFunctionNode"}constructor(e,t=null,n=null){super(),this.method=e,this.aNode=t,this.bNode=n}getInputType(e){const t=this.aNode?this.aNode.getNodeType(e):null,n=this.bNode?this.bNode.getNodeType(e):null,i=e.isMatrix(t)?0:e.getTypeLength(t),s=e.isMatrix(n)?0:e.getTypeLength(n);return i>s?t:n}getNodeType(e){const t=this.method;return t===jt.SUBGROUP_ELECT?"bool":t===jt.SUBGROUP_BALLOT?"uvec4":this.getInputType(e)}generate(e,t){const n=this.method,i=this.getNodeType(e),s=this.getInputType(e),a=this.aNode,o=this.bNode,l=[];if(n===jt.SUBGROUP_BROADCAST||n===jt.SUBGROUP_SHUFFLE||n===jt.QUAD_BROADCAST){const d=o.getNodeType(e);l.push(a.build(e,i),o.build(e,d==="float"?"int":i))}else n===jt.SUBGROUP_SHUFFLE_XOR||n===jt.SUBGROUP_SHUFFLE_DOWN||n===jt.SUBGROUP_SHUFFLE_UP?l.push(a.build(e,i),o.build(e,"uint")):(a!==null&&l.push(a.build(e,s)),o!==null&&l.push(o.build(e,s)));const c=l.length===0?"()":`( ${l.join(", ")} )`;return e.format(`${e.getMethod(n,i)}${c}`,i,t)}serialize(e){super.serialize(e),e.method=this.method}deserialize(e){super.deserialize(e),this.method=e.method}}jt.SUBGROUP_ELECT="subgroupElect";jt.SUBGROUP_BALLOT="subgroupBallot";jt.SUBGROUP_ADD="subgroupAdd";jt.SUBGROUP_INCLUSIVE_ADD="subgroupInclusiveAdd";jt.SUBGROUP_EXCLUSIVE_AND="subgroupExclusiveAdd";jt.SUBGROUP_MUL="subgroupMul";jt.SUBGROUP_INCLUSIVE_MUL="subgroupInclusiveMul";jt.SUBGROUP_EXCLUSIVE_MUL="subgroupExclusiveMul";jt.SUBGROUP_AND="subgroupAnd";jt.SUBGROUP_OR="subgroupOr";jt.SUBGROUP_XOR="subgroupXor";jt.SUBGROUP_MIN="subgroupMin";jt.SUBGROUP_MAX="subgroupMax";jt.SUBGROUP_ALL="subgroupAll";jt.SUBGROUP_ANY="subgroupAny";jt.SUBGROUP_BROADCAST_FIRST="subgroupBroadcastFirst";jt.QUAD_SWAP_X="quadSwapX";jt.QUAD_SWAP_Y="quadSwapY";jt.QUAD_SWAP_DIAGONAL="quadSwapDiagonal";jt.SUBGROUP_BROADCAST="subgroupBroadcast";jt.SUBGROUP_SHUFFLE="subgroupShuffle";jt.SUBGROUP_SHUFFLE_XOR="subgroupShuffleXor";jt.SUBGROUP_SHUFFLE_UP="subgroupShuffleUp";jt.SUBGROUP_SHUFFLE_DOWN="subgroupShuffleDown";jt.QUAD_BROADCAST="quadBroadcast";const vme=Mt(jt,jt.SUBGROUP_ELECT).setParameterLength(0),xme=Mt(jt,jt.SUBGROUP_BALLOT).setParameterLength(1),bme=Mt(jt,jt.SUBGROUP_ADD).setParameterLength(1),Sme=Mt(jt,jt.SUBGROUP_INCLUSIVE_ADD).setParameterLength(1),Tme=Mt(jt,jt.SUBGROUP_EXCLUSIVE_AND).setParameterLength(1),Eme=Mt(jt,jt.SUBGROUP_MUL).setParameterLength(1),Mme=Mt(jt,jt.SUBGROUP_INCLUSIVE_MUL).setParameterLength(1),Ame=Mt(jt,jt.SUBGROUP_EXCLUSIVE_MUL).setParameterLength(1),wme=Mt(jt,jt.SUBGROUP_AND).setParameterLength(1),Rme=Mt(jt,jt.SUBGROUP_OR).setParameterLength(1),Cme=Mt(jt,jt.SUBGROUP_XOR).setParameterLength(1),Nme=Mt(jt,jt.SUBGROUP_MIN).setParameterLength(1),Dme=Mt(jt,jt.SUBGROUP_MAX).setParameterLength(1),Ome=Mt(jt,jt.SUBGROUP_ALL).setParameterLength(0),Ume=Mt(jt,jt.SUBGROUP_ANY).setParameterLength(0),Lme=Mt(jt,jt.SUBGROUP_BROADCAST_FIRST).setParameterLength(2),Pme=Mt(jt,jt.QUAD_SWAP_X).setParameterLength(1),Bme=Mt(jt,jt.QUAD_SWAP_Y).setParameterLength(1),Ime=Mt(jt,jt.QUAD_SWAP_DIAGONAL).setParameterLength(1),Fme=Mt(jt,jt.SUBGROUP_BROADCAST).setParameterLength(2),zme=Mt(jt,jt.SUBGROUP_SHUFFLE).setParameterLength(2),Vme=Mt(jt,jt.SUBGROUP_SHUFFLE_XOR).setParameterLength(2),Gme=Mt(jt,jt.SUBGROUP_SHUFFLE_UP).setParameterLength(2),kme=Mt(jt,jt.SUBGROUP_SHUFFLE_DOWN).setParameterLength(2),Hme=Mt(jt,jt.QUAD_BROADCAST).setParameterLength(1);let aw;function NN(r){aw=aw||new WeakMap;let e=aw.get(r);return e===void 0&&aw.set(r,e={}),e}function DN(r){const e=NN(r);return e.shadowMatrix||(e.shadowMatrix=_n("mat4").setGroup(yn).onRenderUpdate(t=>((r.castShadow!==!0||t.renderer.shadowMap.enabled===!1)&&(r.shadow.camera.coordinateSystem!==t.camera.coordinateSystem&&(r.shadow.camera.coordinateSystem=t.camera.coordinateSystem,r.shadow.camera.updateProjectionMatrix()),r.shadow.updateMatrices(r)),r.shadow.matrix)))}function Zq(r,e=cd){const t=DN(r).mul(e);return t.xyz.div(t.w)}function tI(r){const e=NN(r);return e.position||(e.position=_n(new ne).setGroup(yn).onRenderUpdate((t,n)=>n.value.setFromMatrixPosition(r.matrixWorld)))}function Kq(r){const e=NN(r);return e.targetPosition||(e.targetPosition=_n(new ne).setGroup(yn).onRenderUpdate((t,n)=>n.value.setFromMatrixPosition(r.target.matrixWorld)))}function nI(r){const e=NN(r);return e.viewPosition||(e.viewPosition=_n(new ne).setGroup(yn).onRenderUpdate(({camera:t},n)=>{n.value=n.value||new ne,n.value.setFromMatrixPosition(r.matrixWorld),n.value.applyMatrix4(t.matrixWorldInverse)}))}const iI=r=>hc.transformDirection(tI(r).sub(Kq(r))),Wme=r=>r.sort((e,t)=>e.id-t.id),qme=(r,e)=>{for(const t of e)if(t.isAnalyticLightNode&&t.light.id===r)return t;return null},xD=new WeakMap,tT=[];class rI extends on{static get type(){return"LightsNode"}constructor(){super("vec3"),this.totalDiffuseNode=Ah("vec3","totalDiffuse"),this.totalSpecularNode=Ah("vec3","totalSpecular"),this.outgoingLightNode=Ah("vec3","outgoingLight"),this._lights=[],this._lightNodes=null,this._lightNodesHash=null,this.global=!0}customCacheKey(){const e=this._lights;for(let n=0;n<e.length;n++){const i=e[n];if(tT.push(i.id),tT.push(i.castShadow?1:0),i.isSpotLight===!0){const s=i.map!==null?i.map.id:-1,a=i.colorNode?i.colorNode.getCacheKey():-1;tT.push(s,a)}}const t=Xx(tT);return tT.length=0,t}getHash(e){if(this._lightNodesHash===null){this._lightNodes===null&&this.setupLightsNode(e);const t=[];for(const n of this._lightNodes)t.push(n.getHash());this._lightNodesHash="lights-"+t.join(",")}return this._lightNodesHash}analyze(e){const t=e.getNodeProperties(this);for(const n of t.nodes)n.build(e);t.outputNode.build(e)}setupLightsNode(e){const t=[],n=this._lightNodes,i=Wme(this._lights),s=e.renderer.library;for(const a of i)if(a.isNode)t.push(Xt(a));else{let o=null;if(n!==null&&(o=qme(a.id,n)),o===null){const l=s.getLightNodeClass(a.constructor);if(l===null){Ve(`LightsNode.setupNodeLights: Light node not found for ${a.constructor.name}`);continue}let c=null;xD.has(a)?c=xD.get(a):(c=new l(a),xD.set(a,c)),t.push(c)}}this._lightNodes=t}setupDirectLight(e,t,n){const{lightingModel:i,reflectedLight:s}=e.context;i.direct({...n,lightNode:t,reflectedLight:s},e)}setupDirectRectAreaLight(e,t,n){const{lightingModel:i,reflectedLight:s}=e.context;i.directRectArea({...n,lightNode:t,reflectedLight:s},e)}setupLights(e,t){for(const n of t)n.build(e)}getLightNodes(e){return this._lightNodes===null&&this.setupLightsNode(e),this._lightNodes}setup(e){const t=e.lightsNode;e.lightsNode=this;let n=this.outgoingLightNode;const i=e.context,s=i.lightingModel,a=e.getNodeProperties(this);if(s){const{totalDiffuseNode:o,totalSpecularNode:l}=this;i.outgoingLight=n;const c=e.addStack();a.nodes=c.nodes,s.start(e);const{backdrop:d,backdropAlpha:p}=i,{directDiffuse:y,directSpecular:_,indirectDiffuse:v,indirectSpecular:b}=i.reflectedLight;let E=y.add(v);d!==null&&(p!==null?E=ge(p.mix(E,d)):E=ge(d)),o.assign(E),l.assign(_.add(b)),n.assign(o.add(l)),s.finish(e),n=n.bypass(e.removeStack())}else a.nodes=[];return e.lightsNode=t,n}setLights(e){return this._lights=e,this._lightNodes=null,this._lightNodesHash=null,this}getLights(){return this._lights}get hasLights(){return this._lights.length>0}}const Xme=(r=[])=>new rI().setLights(r);class $me extends on{static get type(){return"ShadowBaseNode"}constructor(e){super(),this.light=e,this.updateBeforeType=$n.RENDER,this.isShadowBaseNode=!0}setupShadowPosition({context:e,material:t}){sI.assign(t.receivedShadowPositionNode||e.shadowPositionWorld||cd)}}const sI=Ah("vec3","shadowPositionWorld");function jme(r,e={}){return e.toneMapping=r.toneMapping,e.toneMappingExposure=r.toneMappingExposure,e.outputColorSpace=r.outputColorSpace,e.renderTarget=r.getRenderTarget(),e.activeCubeFace=r.getActiveCubeFace(),e.activeMipmapLevel=r.getActiveMipmapLevel(),e.renderObjectFunction=r.getRenderObjectFunction(),e.pixelRatio=r.getPixelRatio(),e.mrt=r.getMRT(),e.clearColor=r.getClearColor(e.clearColor||new Kt),e.clearAlpha=r.getClearAlpha(),e.autoClear=r.autoClear,e.scissorTest=r.getScissorTest(),e}function Yme(r,e){return e=jme(r,e),r.setMRT(null),r.setRenderObjectFunction(null),r.setClearColor(0,1),r.autoClear=!0,e}function Zme(r,e){r.toneMapping=e.toneMapping,r.toneMappingExposure=e.toneMappingExposure,r.outputColorSpace=e.outputColorSpace,r.setRenderTarget(e.renderTarget,e.activeCubeFace,e.activeMipmapLevel),r.setRenderObjectFunction(e.renderObjectFunction),r.setPixelRatio(e.pixelRatio),r.setMRT(e.mrt),r.setClearColor(e.clearColor,e.clearAlpha),r.autoClear=e.autoClear,r.setScissorTest(e.scissorTest)}function Kme(r,e={}){return e.background=r.background,e.backgroundNode=r.backgroundNode,e.overrideMaterial=r.overrideMaterial,e}function Qme(r,e){return e=Kme(r,e),r.background=null,r.backgroundNode=null,r.overrideMaterial=null,e}function Jme(r,e){r.background=e.background,r.backgroundNode=e.backgroundNode,r.overrideMaterial=e.overrideMaterial}function ege(r,e,t){return t=Yme(r,t),t=Qme(e,t),t}function tge(r,e,t){Zme(r,t),Jme(e,t)}const PR=new WeakMap,Qq=Te(({depthTexture:r,shadowCoord:e,depthLayer:t})=>{let n=Li(r,e.xy).setName("t_basic");return r.isArrayTexture&&(n=n.depth(t)),n.compare(e.z)}),Jq=Te(({depthTexture:r,shadowCoord:e,shadow:t,depthLayer:n})=>{const i=(d,p)=>{let y=Li(r,d);return r.isArrayTexture&&(y=y.depth(n)),y.compare(p)},s=fr("mapSize","vec2",t).setGroup(yn),a=fr("radius","float",t).setGroup(yn),o=St(1).div(s),l=a.mul(o.x),c=ZB(Py.xy).mul(6.28318530718);return Ns(i(e.xy.add(Xc(0,5,c).mul(l)),e.z),i(e.xy.add(Xc(1,5,c).mul(l)),e.z),i(e.xy.add(Xc(2,5,c).mul(l)),e.z),i(e.xy.add(Xc(3,5,c).mul(l)),e.z),i(e.xy.add(Xc(4,5,c).mul(l)),e.z)).mul(1/5)}),eX=Te(({depthTexture:r,shadowCoord:e,shadow:t,depthLayer:n})=>{const i=(p,y)=>{let _=Li(r,p);return r.isArrayTexture&&(_=_.depth(n)),_.compare(y)},s=fr("mapSize","vec2",t).setGroup(yn),a=St(1).div(s),o=a.x,l=a.y,c=e.xy,d=Qc(c.mul(s).add(.5));return c.subAssign(d.mul(a)),Ns(i(c,e.z),i(c.add(St(o,0)),e.z),i(c.add(St(0,l)),e.z),i(c.add(a),e.z),yi(i(c.add(St(o.negate(),0)),e.z),i(c.add(St(o.mul(2),0)),e.z),d.x),yi(i(c.add(St(o.negate(),l)),e.z),i(c.add(St(o.mul(2),l)),e.z),d.x),yi(i(c.add(St(0,l.negate())),e.z),i(c.add(St(0,l.mul(2))),e.z),d.y),yi(i(c.add(St(o,l.negate())),e.z),i(c.add(St(o,l.mul(2))),e.z),d.y),yi(yi(i(c.add(St(o.negate(),l.negate())),e.z),i(c.add(St(o.mul(2),l.negate())),e.z),d.x),yi(i(c.add(St(o.negate(),l.mul(2))),e.z),i(c.add(St(o.mul(2),l.mul(2))),e.z),d.x),d.y)).mul(1/9)}),tX=Te(({depthTexture:r,shadowCoord:e,depthLayer:t})=>{let n=Li(r).sample(e.xy);r.isArrayTexture&&(n=n.depth(t)),n=n.rg;const i=n.x,s=Kr(1e-7,n.y.mul(n.y)),a=dN(e.z,i);Tn(a.equal(1),()=>re(1));const o=e.z.sub(i);let l=s.div(s.add(o.mul(o)));return l=Jc(_i(l,.3).div(.65)),Kr(a,l)}),nge=Te(([r,e,t])=>{let n=cd.sub(r).length();return n=n.sub(e).div(t.sub(e)),n=n.saturate(),n}),ige=r=>{const e=r.shadow.camera,t=fr("near","float",e).setGroup(yn),n=fr("far","float",e).setGroup(yn),i=BW(r);return nge(i,t,n)},nX=r=>{let e=PR.get(r);if(e===void 0){const t=r.isPointLight?ige(r):null;e=new ds,e.colorNode=En(0,0,0,1),e.depthNode=t,e.isShadowPassMaterial=!0,e.name="ShadowMaterial",e.fog=!1,PR.set(r,e)}return e},iX=r=>{const e=PR.get(r);e!==void 0&&(e.dispose(),PR.delete(r))},SG=new tf,Tv=[],rX=(r,e,t,n)=>{Tv[0]=r,Tv[1]=e;let i=SG.get(Tv);return(i===void 0||i.shadowType!==t||i.useVelocity!==n)&&(i=(s,a,o,l,c,d,...p)=>{(s.castShadow===!0||s.receiveShadow&&t===$c)&&(n&&(ZH(s).useVelocity=!0),s.onBeforeShadow(r,s,o,e.camera,l,a.overrideMaterial,d),r.renderObject(s,a,o,l,c,d,...p),s.onAfterShadow(r,s,o,e.camera,l,a.overrideMaterial,d))},i.shadowType=t,i.useVelocity=n,SG.set(Tv,i)),Tv[0]=null,Tv[1]=null,i},rge=Te(({samples:r,radius:e,size:t,shadowPass:n,depthLayer:i})=>{const s=re(0).toVar("meanVertical"),a=re(0).toVar("squareMeanVertical"),o=r.lessThanEqual(re(1)).select(re(0),re(2).div(r.sub(1))),l=r.lessThanEqual(re(1)).select(re(0),re(-1));rr({start:de(0),end:de(r),type:"int",condition:"<"},({i:d})=>{const p=l.add(re(d).mul(o));let y=n.sample(Ns(Py.xy,St(0,p).mul(e)).div(t));n.value.isArrayTexture&&(y=y.depth(i)),y=y.x,s.addAssign(y),a.addAssign(y.mul(y))}),s.divAssign(r),a.divAssign(r);const c=go(a.sub(s.mul(s)).max(0));return St(s,c)}),sge=Te(({samples:r,radius:e,size:t,shadowPass:n,depthLayer:i})=>{const s=re(0).toVar("meanHorizontal"),a=re(0).toVar("squareMeanHorizontal"),o=r.lessThanEqual(re(1)).select(re(0),re(2).div(r.sub(1))),l=r.lessThanEqual(re(1)).select(re(0),re(-1));rr({start:de(0),end:de(r),type:"int",condition:"<"},({i:d})=>{const p=l.add(re(d).mul(o));let y=n.sample(Ns(Py.xy,St(p,0).mul(e)).div(t));n.value.isArrayTexture&&(y=y.depth(i)),s.addAssign(y.x),a.addAssign(Ns(y.y.mul(y.y),y.x.mul(y.x)))}),s.divAssign(r),a.divAssign(r);const c=go(a.sub(s.mul(s)).max(0));return St(s,c)}),age=[Qq,Jq,eX,tX];let bD;const ow=new AN;class sX extends $me{static get type(){return"ShadowNode"}constructor(e,t=null){super(e),this.shadow=t||e.shadow,this.shadowMap=null,this.vsmShadowMapVertical=null,this.vsmShadowMapHorizontal=null,this.vsmMaterialVertical=null,this.vsmMaterialHorizontal=null,this._node=null,this._currentShadowType=null,this._cameraFrameId=new WeakMap,this.isShadowNode=!0,this.depthLayer=0}setupShadowFilter(e,{filterFn:t,depthTexture:n,shadowCoord:i,shadow:s,depthLayer:a}){const o=i.x.greaterThanEqual(0).and(i.x.lessThanEqual(1)).and(i.y.greaterThanEqual(0)).and(i.y.lessThanEqual(1)).and(i.z.lessThanEqual(1)),l=t({depthTexture:n,shadowCoord:i,shadow:s,depthLayer:a});return o.select(l,re(1))}setupShadowCoord(e,t){const{shadow:n}=this,{renderer:i}=e,s=fr("bias","float",n).setGroup(yn);let a=t,o;if(n.camera.isOrthographicCamera||i.logarithmicDepthBuffer!==!0)a=a.xyz.div(a.w),o=a.z,i.coordinateSystem===Il&&(o=o.mul(2).sub(1));else{const l=a.w;a=a.xy.div(l);const c=fr("near","float",n.camera).setGroup(yn),d=fr("far","float",n.camera).setGroup(yn);o=FB(l.negate(),c,d)}return a=ge(a.x,a.y.oneMinus(),o.add(s)),a}getShadowFilterFn(e){return age[e]}setupRenderTarget(e,t){const n=new Ga(e.mapSize.width,e.mapSize.height);n.name="ShadowDepthTexture",n.compareFunction=zx;const i=t.createRenderTarget(e.mapSize.width,e.mapSize.height);return i.texture.name="ShadowMap",i.texture.type=e.mapType,i.depthTexture=n,{shadowMap:i,depthTexture:n}}setupShadow(e){const{renderer:t,camera:n}=e,{light:i,shadow:s}=this,a=t.shadowMap.type,{depthTexture:o,shadowMap:l}=this.setupRenderTarget(s,e);if(s.camera.coordinateSystem=n.coordinateSystem,s.camera.updateProjectionMatrix(),a===$c&&s.isPointLightShadow!==!0){o.compareFunction=null,l.depth>1?(l._vsmShadowMapVertical||(l._vsmShadowMapVertical=e.createRenderTarget(s.mapSize.width,s.mapSize.height,{format:po,type:vi,depth:l.depth,depthBuffer:!1}),l._vsmShadowMapVertical.texture.name="VSMVertical"),this.vsmShadowMapVertical=l._vsmShadowMapVertical,l._vsmShadowMapHorizontal||(l._vsmShadowMapHorizontal=e.createRenderTarget(s.mapSize.width,s.mapSize.height,{format:po,type:vi,depth:l.depth,depthBuffer:!1}),l._vsmShadowMapHorizontal.texture.name="VSMHorizontal"),this.vsmShadowMapHorizontal=l._vsmShadowMapHorizontal):(this.vsmShadowMapVertical=e.createRenderTarget(s.mapSize.width,s.mapSize.height,{format:po,type:vi,depthBuffer:!1}),this.vsmShadowMapHorizontal=e.createRenderTarget(s.mapSize.width,s.mapSize.height,{format:po,type:vi,depthBuffer:!1}));let R=Li(o);o.isArrayTexture&&(R=R.depth(this.depthLayer));let N=Li(this.vsmShadowMapVertical.texture);o.isArrayTexture&&(N=N.depth(this.depthLayer));const P=fr("blurSamples","float",s).setGroup(yn),U=fr("radius","float",s).setGroup(yn),L=fr("mapSize","vec2",s).setGroup(yn);let F=this.vsmMaterialVertical||(this.vsmMaterialVertical=new ds);F.fragmentNode=rge({samples:P,radius:U,size:L,shadowPass:R,depthLayer:this.depthLayer}).context(e.getSharedContext()),F.name="VSMVertical",F=this.vsmMaterialHorizontal||(this.vsmMaterialHorizontal=new ds),F.fragmentNode=sge({samples:P,radius:U,size:L,shadowPass:N,depthLayer:this.depthLayer}).context(e.getSharedContext()),F.name="VSMHorizontal"}const c=fr("intensity","float",s).setGroup(yn),d=fr("normalBias","float",s).setGroup(yn),p=DN(i).mul(sI.add(Wm.mul(d))),y=this.setupShadowCoord(e,p),_=s.filterNode||this.getShadowFilterFn(t.shadowMap.type)||null;if(_===null)throw new Error("THREE.WebGPURenderer: Shadow map type not supported yet.");const v=a===$c&&s.isPointLightShadow!==!0?this.vsmShadowMapHorizontal.texture:o,b=this.setupShadowFilter(e,{filterFn:_,shadowTexture:l.texture,depthTexture:v,shadowCoord:y,shadow:s,depthLayer:this.depthLayer});let E;l.texture.isCubeTexture?E=il(l.texture,y.xyz):(E=Li(l.texture,y),o.isArrayTexture&&(E=E.depth(this.depthLayer)));const T=yi(1,b.rgb.mix(E,1),c.mul(E.a)).toVar();this.shadowMap=l,this.shadow.map=l;const M=`${this.light.type} Shadow [ ${this.light.name||"ID: "+this.light.id} ]`;return T.toInspector(`${M} / Color`,()=>this.shadowMap.texture.isCubeTexture?il(this.shadowMap.texture):Li(this.shadowMap.texture)).toInspector(`${M} / Depth`,()=>this.shadowMap.texture.isCubeTexture?il(this.shadowMap.texture).r.oneMinus():as(this.shadowMap.depthTexture,hr().mul(wh(Li(this.shadowMap.depthTexture)))).r.oneMinus())}setup(e){if(e.renderer.shadowMap.enabled!==!1)return Te(()=>{const t=e.renderer.shadowMap.type;this._currentShadowType!==t&&(this._reset(),this._node=null);let n=this._node;return this.setupShadowPosition(e),n===null&&(this._node=n=this.setupShadow(e),this._currentShadowType=t),e.material.shadowNode&&Ve('NodeMaterial: ".shadowNode" is deprecated. Use ".castShadowNode" instead.'),e.material.receivedShadowNode&&(n=e.material.receivedShadowNode(n)),n})()}renderShadow(e){const{shadow:t,shadowMap:n,light:i}=this,{renderer:s,scene:a}=e;t.updateMatrices(i),n.setSize(t.mapSize.width,t.mapSize.height,n.depth);const o=a.name;a.name=`Shadow Map [ ${i.name||"ID: "+i.id} ]`,s.render(a,t.camera),a.name=o}updateShadow(e){const{shadowMap:t,light:n,shadow:i}=this,{renderer:s,scene:a,camera:o}=e,l=s.shadowMap.type,c=t.depthTexture.version;this._depthVersionCached=c;const d=i.camera.layers.mask;(i.camera.layers.mask&4294967294)===0&&(i.camera.layers.mask=o.layers.mask);const p=s.getRenderObjectFunction(),y=s.getMRT(),_=y?y.has("velocity"):!1;bD=ege(s,a,bD),a.overrideMaterial=nX(n),s.setRenderObjectFunction(rX(s,i,l,_)),s.setClearColor(0,0),s.setRenderTarget(t),this.renderShadow(e),s.setRenderObjectFunction(p),l===$c&&i.isPointLightShadow!==!0&&this.vsmPass(s),i.camera.layers.mask=d,tge(s,a,bD)}vsmPass(e){const{shadow:t}=this,n=this.shadowMap.depth;this.vsmShadowMapVertical.setSize(t.mapSize.width,t.mapSize.height,n),this.vsmShadowMapHorizontal.setSize(t.mapSize.width,t.mapSize.height,n),e.setRenderTarget(this.vsmShadowMapVertical),ow.material=this.vsmMaterialVertical,ow.render(e),e.setRenderTarget(this.vsmShadowMapHorizontal),ow.material=this.vsmMaterialHorizontal,ow.render(e)}dispose(){this._reset(),super.dispose()}_reset(){this._currentShadowType=null,iX(this.light),this.shadowMap&&(this.shadowMap.dispose(),this.shadowMap=null),this.vsmShadowMapVertical!==null&&(this.vsmShadowMapVertical.dispose(),this.vsmShadowMapVertical=null,this.vsmMaterialVertical.dispose(),this.vsmMaterialVertical=null),this.vsmShadowMapHorizontal!==null&&(this.vsmShadowMapHorizontal.dispose(),this.vsmShadowMapHorizontal=null,this.vsmMaterialHorizontal.dispose(),this.vsmMaterialHorizontal=null)}updateBefore(e){const{shadow:t}=this;let n=t.needsUpdate||t.autoUpdate;n&&(this._cameraFrameId[e.camera]===e.frameId&&(n=!1),this._cameraFrameId[e.camera]=e.frameId),n&&(this.updateShadow(e),this.shadowMap.depthTexture.version===this._depthVersionCached&&(t.needsUpdate=!1))}}const aX=(r,e)=>new sX(r,e),oge=new Kt,TG=new gn,nT=new ne,SD=new ne,lge=[new ne(1,0,0),new ne(-1,0,0),new ne(0,-1,0),new ne(0,1,0),new ne(0,0,1),new ne(0,0,-1)],uge=[new ne(0,-1,0),new ne(0,-1,0),new ne(0,0,-1),new ne(0,0,1),new ne(0,-1,0),new ne(0,-1,0)],cge=[new ne(1,0,0),new ne(-1,0,0),new ne(0,1,0),new ne(0,-1,0),new ne(0,0,1),new ne(0,0,-1)],fge=[new ne(0,-1,0),new ne(0,-1,0),new ne(0,0,1),new ne(0,0,-1),new ne(0,-1,0),new ne(0,-1,0)],oX=Te(({depthTexture:r,bd3D:e,dp:t})=>il(r,e).compare(t)),lX=Te(({depthTexture:r,bd3D:e,dp:t,shadow:n})=>{const i=fr("radius","float",n).setGroup(yn),s=fr("mapSize","vec2",n).setGroup(yn),a=i.div(s.x),o=Sr(e),l=al(Vh(e,o.x.greaterThan(o.z).select(ge(0,1,0),ge(1,0,0)))),c=Vh(e,l),d=ZB(Py.xy).mul(6.28318530718),p=Xc(0,5,d),y=Xc(1,5,d),_=Xc(2,5,d),v=Xc(3,5,d),b=Xc(4,5,d);return il(r,e.add(l.mul(p.x).add(c.mul(p.y)).mul(a))).compare(t).add(il(r,e.add(l.mul(y.x).add(c.mul(y.y)).mul(a))).compare(t)).add(il(r,e.add(l.mul(_.x).add(c.mul(_.y)).mul(a))).compare(t)).add(il(r,e.add(l.mul(v.x).add(c.mul(v.y)).mul(a))).compare(t)).add(il(r,e.add(l.mul(b.x).add(c.mul(b.y)).mul(a))).compare(t)).mul(1/5)}),dge=Te(({filterFn:r,depthTexture:e,shadowCoord:t,shadow:n})=>{const i=t.xyz.toVar(),s=i.length(),a=_n("float").setGroup(yn).onRenderUpdate(()=>n.camera.near),o=_n("float").setGroup(yn).onRenderUpdate(()=>n.camera.far),l=fr("bias","float",n).setGroup(yn),c=re(1).toVar();return Tn(s.sub(o).lessThanEqual(0).and(s.sub(a).greaterThanEqual(0)),()=>{const d=s.sub(a).div(o.sub(a)).toVar();d.addAssign(l);const p=i.normalize();c.assign(r({depthTexture:e,bd3D:p,dp:d,shadow:n}))}),c});class hge extends sX{static get type(){return"PointShadowNode"}constructor(e,t=null){super(e,t)}getShadowFilterFn(e){return e===YU?oX:lX}setupShadowCoord(e,t){return t}setupShadowFilter(e,{filterFn:t,depthTexture:n,shadowCoord:i,shadow:s}){return dge({filterFn:t,depthTexture:n,shadowCoord:i,shadow:s})}setupRenderTarget(e,t){const n=new fL(e.mapSize.width);n.name="PointShadowDepthTexture",n.compareFunction=zx;const i=t.createCubeRenderTarget(e.mapSize.width);return i.texture.name="PointShadowMap",i.depthTexture=n,{shadowMap:i,depthTexture:n}}renderShadow(e){const{shadow:t,shadowMap:n,light:i}=this,{renderer:s,scene:a}=e,o=t.camera,l=t.matrix,c=s.coordinateSystem===Il,d=c?lge:cge,p=c?uge:fge;n.setSize(t.mapSize.width,t.mapSize.width);const y=s.autoClear,_=s.getClearColor(oge),v=s.getClearAlpha();s.autoClear=!1,s.setClearColor(t.clearColor,t.clearAlpha);for(let b=0;b<6;b++){s.setRenderTarget(n,b),s.clear();const E=i.distance||o.far;E!==o.far&&(o.far=E,o.updateProjectionMatrix()),nT.setFromMatrixPosition(i.matrixWorld),o.position.copy(nT),SD.copy(o.position),SD.add(d[b]),o.up.copy(p[b]),o.lookAt(SD),o.updateMatrixWorld(),l.makeTranslation(-nT.x,-nT.y,-nT.z),TG.multiplyMatrices(o.projectionMatrix,o.matrixWorldInverse),t._frustum.setFromProjectionMatrix(TG,o.coordinateSystem,o.reversedDepth);const T=a.name;a.name=`Point Light Shadow [ ${i.name||"ID: "+i.id} ] - Face ${b+1}`,s.render(a,o),a.name=T}s.autoClear=y,s.setClearColor(_,v)}}const uX=(r,e)=>new hge(r,e);class By extends jx{static get type(){return"AnalyticLightNode"}constructor(e=null){super(),this.light=e,this.color=new Kt,this.colorNode=e&&e.colorNode||_n(this.color).setGroup(yn),this.baseColorNode=null,this.shadowNode=null,this.shadowColorNode=null,this.isAnalyticLightNode=!0,this.updateType=$n.FRAME,e&&e.shadow&&(this._shadowDisposeListener=()=>{this.disposeShadow()},e.addEventListener("dispose",this._shadowDisposeListener))}dispose(){this._shadowDisposeListener&&this.light.removeEventListener("dispose",this._shadowDisposeListener),super.dispose()}disposeShadow(){this.shadowNode!==null&&(this.shadowNode.dispose(),this.shadowNode=null),this.shadowColorNode=null,this.baseColorNode!==null&&(this.colorNode=this.baseColorNode,this.baseColorNode=null)}getHash(){return this.light.uuid}getLightVector(e){return nI(this.light).sub(e.context.positionView||xs)}setupDirect(){}setupDirectRectArea(){}setupShadowNode(){return aX(this.light)}setupShadow(e){const{renderer:t}=e;if(t.shadowMap.enabled===!1)return;let n=this.shadowColorNode;if(n===null){const i=this.light.shadow.shadowNode;let s;i!==void 0?s=Xt(i):s=this.setupShadowNode(),this.shadowNode=s,this.shadowColorNode=n=this.colorNode.mul(s),this.baseColorNode=this.colorNode}e.context.getShadow&&(n=e.context.getShadow(this,e)),this.colorNode=n}setup(e){this.colorNode=this.baseColorNode||this.colorNode,this.light.castShadow?e.object.receiveShadow&&this.setupShadow(e):this.shadowNode!==null&&(this.shadowNode.dispose(),this.shadowNode=null,this.shadowColorNode=null);const t=this.setupDirect(e),n=this.setupDirectRectArea(e);t&&e.lightsNode.setupDirectLight(e,this,t),n&&e.lightsNode.setupDirectRectAreaLight(e,this,n)}update(){const{light:e}=this;this.color.copy(e.color).multiplyScalar(e.intensity)}}const aI=Te(({lightDistance:r,cutoffDistance:e,decayExponent:t})=>{const n=r.pow(t).max(.01).reciprocal();return e.greaterThan(0).select(n.mul(r.div(e).pow4().oneMinus().clamp().pow2()),n)}),cX=({color:r,lightVector:e,cutoffDistance:t,decayExponent:n})=>{const i=e.normalize(),s=e.length(),a=aI({lightDistance:s,cutoffDistance:t,decayExponent:n}),o=r.mul(a);return{lightDirection:i,lightColor:o}};class pge extends By{static get type(){return"PointLightNode"}constructor(e=null){super(e),this.cutoffDistanceNode=_n(0).setGroup(yn),this.decayExponentNode=_n(2).setGroup(yn)}update(e){const{light:t}=this;super.update(e),this.cutoffDistanceNode.value=t.distance,this.decayExponentNode.value=t.decay}setupShadowNode(){return uX(this.light)}setupDirect(e){return cX({color:this.colorNode,lightVector:this.getLightVector(e),cutoffDistance:this.cutoffDistanceNode,decayExponent:this.decayExponentNode})}}const mge=Te(([r=hr()])=>{const e=r.mul(2),t=e.x.floor(),n=e.y.floor();return t.add(n).mod(2).sign()}),gge=Te(([r=hr()],{renderer:e,material:t})=>{const n=hB(r.mul(2).sub(1));let i;if(t.alphaToCoverage&&e.currentSamples>0){const s=re(n.fwidth()).toVar();i=ef(s.oneMinus(),s.add(1),n).oneMinus()}else i=za(n.greaterThan(1),0,1);return i}),KT=Te(([r,e,t])=>{const n=re(t).toVar(),i=re(e).toVar(),s=lc(r).toVar();return za(s,i,n)}).setLayout({name:"mx_select",type:"float",inputs:[{name:"b",type:"bool"},{name:"t",type:"float"},{name:"f",type:"float"}]}),BR=Te(([r,e])=>{const t=lc(e).toVar(),n=re(r).toVar();return za(t,n.negate(),n)}).setLayout({name:"mx_negate_if",type:"float",inputs:[{name:"val",type:"float"},{name:"b",type:"bool"}]}),Cs=Te(([r])=>{const e=re(r).toVar();return de(ld(e))}).setLayout({name:"mx_floor",type:"int",inputs:[{name:"x",type:"float"}]}),zr=Te(([r,e])=>{const t=re(r).toVar();return e.assign(Cs(t)),t.sub(re(e))}),yge=Te(([r,e,t,n,i,s])=>{const a=re(s).toVar(),o=re(i).toVar(),l=re(n).toVar(),c=re(t).toVar(),d=re(e).toVar(),p=re(r).toVar(),y=re(_i(1,o)).toVar();return _i(1,a).mul(p.mul(y).add(d.mul(o))).add(a.mul(c.mul(y).add(l.mul(o))))}).setLayout({name:"mx_bilerp_0",type:"float",inputs:[{name:"v0",type:"float"},{name:"v1",type:"float"},{name:"v2",type:"float"},{name:"v3",type:"float"},{name:"s",type:"float"},{name:"t",type:"float"}]}),_ge=Te(([r,e,t,n,i,s])=>{const a=re(s).toVar(),o=re(i).toVar(),l=ge(n).toVar(),c=ge(t).toVar(),d=ge(e).toVar(),p=ge(r).toVar(),y=re(_i(1,o)).toVar();return _i(1,a).mul(p.mul(y).add(d.mul(o))).add(a.mul(c.mul(y).add(l.mul(o))))}).setLayout({name:"mx_bilerp_1",type:"vec3",inputs:[{name:"v0",type:"vec3"},{name:"v1",type:"vec3"},{name:"v2",type:"vec3"},{name:"v3",type:"vec3"},{name:"s",type:"float"},{name:"t",type:"float"}]}),fX=Wa([yge,_ge]),vge=Te(([r,e,t,n,i,s,a,o,l,c,d])=>{const p=re(d).toVar(),y=re(c).toVar(),_=re(l).toVar(),v=re(o).toVar(),b=re(a).toVar(),E=re(s).toVar(),T=re(i).toVar(),M=re(n).toVar(),R=re(t).toVar(),N=re(e).toVar(),P=re(r).toVar(),U=re(_i(1,_)).toVar(),L=re(_i(1,y)).toVar();return re(_i(1,p)).toVar().mul(L.mul(P.mul(U).add(N.mul(_))).add(y.mul(R.mul(U).add(M.mul(_))))).add(p.mul(L.mul(T.mul(U).add(E.mul(_))).add(y.mul(b.mul(U).add(v.mul(_))))))}).setLayout({name:"mx_trilerp_0",type:"float",inputs:[{name:"v0",type:"float"},{name:"v1",type:"float"},{name:"v2",type:"float"},{name:"v3",type:"float"},{name:"v4",type:"float"},{name:"v5",type:"float"},{name:"v6",type:"float"},{name:"v7",type:"float"},{name:"s",type:"float"},{name:"t",type:"float"},{name:"r",type:"float"}]}),xge=Te(([r,e,t,n,i,s,a,o,l,c,d])=>{const p=re(d).toVar(),y=re(c).toVar(),_=re(l).toVar(),v=ge(o).toVar(),b=ge(a).toVar(),E=ge(s).toVar(),T=ge(i).toVar(),M=ge(n).toVar(),R=ge(t).toVar(),N=ge(e).toVar(),P=ge(r).toVar(),U=re(_i(1,_)).toVar(),L=re(_i(1,y)).toVar();return re(_i(1,p)).toVar().mul(L.mul(P.mul(U).add(N.mul(_))).add(y.mul(R.mul(U).add(M.mul(_))))).add(p.mul(L.mul(T.mul(U).add(E.mul(_))).add(y.mul(b.mul(U).add(v.mul(_))))))}).setLayout({name:"mx_trilerp_1",type:"vec3",inputs:[{name:"v0",type:"vec3"},{name:"v1",type:"vec3"},{name:"v2",type:"vec3"},{name:"v3",type:"vec3"},{name:"v4",type:"vec3"},{name:"v5",type:"vec3"},{name:"v6",type:"vec3"},{name:"v7",type:"vec3"},{name:"s",type:"float"},{name:"t",type:"float"},{name:"r",type:"float"}]}),dX=Wa([vge,xge]),bge=Te(([r,e,t])=>{const n=re(t).toVar(),i=re(e).toVar(),s=vt(r).toVar(),a=vt(s.bitAnd(vt(7))).toVar(),o=re(KT(a.lessThan(vt(4)),i,n)).toVar(),l=re(Vn(2,KT(a.lessThan(vt(4)),n,i))).toVar();return BR(o,lc(a.bitAnd(vt(1)))).add(BR(l,lc(a.bitAnd(vt(2)))))}).setLayout({name:"mx_gradient_float_0",type:"float",inputs:[{name:"hash",type:"uint"},{name:"x",type:"float"},{name:"y",type:"float"}]}),Sge=Te(([r,e,t,n])=>{const i=re(n).toVar(),s=re(t).toVar(),a=re(e).toVar(),o=vt(r).toVar(),l=vt(o.bitAnd(vt(15))).toVar(),c=re(KT(l.lessThan(vt(8)),a,s)).toVar(),d=re(KT(l.lessThan(vt(4)),s,KT(l.equal(vt(12)).or(l.equal(vt(14))),a,i))).toVar();return BR(c,lc(l.bitAnd(vt(1)))).add(BR(d,lc(l.bitAnd(vt(2)))))}).setLayout({name:"mx_gradient_float_1",type:"float",inputs:[{name:"hash",type:"uint"},{name:"x",type:"float"},{name:"y",type:"float"},{name:"z",type:"float"}]}),_a=Wa([bge,Sge]),Tge=Te(([r,e,t])=>{const n=re(t).toVar(),i=re(e).toVar(),s=Ly(r).toVar();return ge(_a(s.x,i,n),_a(s.y,i,n),_a(s.z,i,n))}).setLayout({name:"mx_gradient_vec3_0",type:"vec3",inputs:[{name:"hash",type:"uvec3"},{name:"x",type:"float"},{name:"y",type:"float"}]}),Ege=Te(([r,e,t,n])=>{const i=re(n).toVar(),s=re(t).toVar(),a=re(e).toVar(),o=Ly(r).toVar();return ge(_a(o.x,a,s,i),_a(o.y,a,s,i),_a(o.z,a,s,i))}).setLayout({name:"mx_gradient_vec3_1",type:"vec3",inputs:[{name:"hash",type:"uvec3"},{name:"x",type:"float"},{name:"y",type:"float"},{name:"z",type:"float"}]}),Wu=Wa([Tge,Ege]),Mge=Te(([r])=>{const e=re(r).toVar();return Vn(.6616,e)}).setLayout({name:"mx_gradient_scale2d_0",type:"float",inputs:[{name:"v",type:"float"}]}),Age=Te(([r])=>{const e=re(r).toVar();return Vn(.982,e)}).setLayout({name:"mx_gradient_scale3d_0",type:"float",inputs:[{name:"v",type:"float"}]}),wge=Te(([r])=>{const e=ge(r).toVar();return Vn(.6616,e)}).setLayout({name:"mx_gradient_scale2d_1",type:"vec3",inputs:[{name:"v",type:"vec3"}]}),hX=Wa([Mge,wge]),Rge=Te(([r])=>{const e=ge(r).toVar();return Vn(.982,e)}).setLayout({name:"mx_gradient_scale3d_1",type:"vec3",inputs:[{name:"v",type:"vec3"}]}),pX=Wa([Age,Rge]),ou=Te(([r,e])=>{const t=de(e).toVar(),n=vt(r).toVar();return n.shiftLeft(t).bitOr(n.shiftRight(de(32).sub(t)))}).setLayout({name:"mx_rotl32",type:"uint",inputs:[{name:"x",type:"uint"},{name:"k",type:"int"}]}),mX=Te(([r,e,t])=>{r.subAssign(t),r.bitXorAssign(ou(t,de(4))),t.addAssign(e),e.subAssign(r),e.bitXorAssign(ou(r,de(6))),r.addAssign(t),t.subAssign(e),t.bitXorAssign(ou(e,de(8))),e.addAssign(r),r.subAssign(t),r.bitXorAssign(ou(t,de(16))),t.addAssign(e),e.subAssign(r),e.bitXorAssign(ou(r,de(19))),r.addAssign(t),t.subAssign(e),t.bitXorAssign(ou(e,de(4))),e.addAssign(r)}),dE=Te(([r,e,t])=>{const n=vt(t).toVar(),i=vt(e).toVar(),s=vt(r).toVar();return n.bitXorAssign(i),n.subAssign(ou(i,de(14))),s.bitXorAssign(n),s.subAssign(ou(n,de(11))),i.bitXorAssign(s),i.subAssign(ou(s,de(25))),n.bitXorAssign(i),n.subAssign(ou(i,de(16))),s.bitXorAssign(n),s.subAssign(ou(n,de(4))),i.bitXorAssign(s),i.subAssign(ou(s,de(14))),n.bitXorAssign(i),n.subAssign(ou(i,de(24))),n}).setLayout({name:"mx_bjfinal",type:"uint",inputs:[{name:"a",type:"uint"},{name:"b",type:"uint"},{name:"c",type:"uint"}]}),xo=Te(([r])=>{const e=vt(r).toVar();return re(e).div(re(vt(de(4294967295))))}).setLayout({name:"mx_bits_to_01",type:"float",inputs:[{name:"bits",type:"uint"}]}),dd=Te(([r])=>{const e=re(r).toVar();return e.mul(e).mul(e).mul(e.mul(e.mul(6).sub(15)).add(10))}).setLayout({name:"mx_fade",type:"float",inputs:[{name:"t",type:"float"}]}),Cge=Te(([r])=>{const e=de(r).toVar(),t=vt(vt(1)).toVar(),n=vt(vt(de(3735928559)).add(t.shiftLeft(vt(2))).add(vt(13))).toVar();return dE(n.add(vt(e)),n,n)}).setLayout({name:"mx_hash_int_0",type:"uint",inputs:[{name:"x",type:"int"}]}),Nge=Te(([r,e])=>{const t=de(e).toVar(),n=de(r).toVar(),i=vt(vt(2)).toVar(),s=vt().toVar(),a=vt().toVar(),o=vt().toVar();return s.assign(a.assign(o.assign(vt(de(3735928559)).add(i.shiftLeft(vt(2))).add(vt(13))))),s.addAssign(vt(n)),a.addAssign(vt(t)),dE(s,a,o)}).setLayout({name:"mx_hash_int_1",type:"uint",inputs:[{name:"x",type:"int"},{name:"y",type:"int"}]}),Dge=Te(([r,e,t])=>{const n=de(t).toVar(),i=de(e).toVar(),s=de(r).toVar(),a=vt(vt(3)).toVar(),o=vt().toVar(),l=vt().toVar(),c=vt().toVar();return o.assign(l.assign(c.assign(vt(de(3735928559)).add(a.shiftLeft(vt(2))).add(vt(13))))),o.addAssign(vt(s)),l.addAssign(vt(i)),c.addAssign(vt(n)),dE(o,l,c)}).setLayout({name:"mx_hash_int_2",type:"uint",inputs:[{name:"x",type:"int"},{name:"y",type:"int"},{name:"z",type:"int"}]}),Oge=Te(([r,e,t,n])=>{const i=de(n).toVar(),s=de(t).toVar(),a=de(e).toVar(),o=de(r).toVar(),l=vt(vt(4)).toVar(),c=vt().toVar(),d=vt().toVar(),p=vt().toVar();return c.assign(d.assign(p.assign(vt(de(3735928559)).add(l.shiftLeft(vt(2))).add(vt(13))))),c.addAssign(vt(o)),d.addAssign(vt(a)),p.addAssign(vt(s)),mX(c,d,p),c.addAssign(vt(i)),dE(c,d,p)}).setLayout({name:"mx_hash_int_3",type:"uint",inputs:[{name:"x",type:"int"},{name:"y",type:"int"},{name:"z",type:"int"},{name:"xx",type:"int"}]}),Uge=Te(([r,e,t,n,i])=>{const s=de(i).toVar(),a=de(n).toVar(),o=de(t).toVar(),l=de(e).toVar(),c=de(r).toVar(),d=vt(vt(5)).toVar(),p=vt().toVar(),y=vt().toVar(),_=vt().toVar();return p.assign(y.assign(_.assign(vt(de(3735928559)).add(d.shiftLeft(vt(2))).add(vt(13))))),p.addAssign(vt(c)),y.addAssign(vt(l)),_.addAssign(vt(o)),mX(p,y,_),p.addAssign(vt(a)),y.addAssign(vt(s)),dE(p,y,_)}).setLayout({name:"mx_hash_int_4",type:"uint",inputs:[{name:"x",type:"int"},{name:"y",type:"int"},{name:"z",type:"int"},{name:"xx",type:"int"},{name:"yy",type:"int"}]}),dr=Wa([Cge,Nge,Dge,Oge,Uge]),Lge=Te(([r,e])=>{const t=de(e).toVar(),n=de(r).toVar(),i=vt(dr(n,t)).toVar(),s=Ly().toVar();return s.x.assign(i.bitAnd(de(255))),s.y.assign(i.shiftRight(de(8)).bitAnd(de(255))),s.z.assign(i.shiftRight(de(16)).bitAnd(de(255))),s}).setLayout({name:"mx_hash_vec3_0",type:"uvec3",inputs:[{name:"x",type:"int"},{name:"y",type:"int"}]}),Pge=Te(([r,e,t])=>{const n=de(t).toVar(),i=de(e).toVar(),s=de(r).toVar(),a=vt(dr(s,i,n)).toVar(),o=Ly().toVar();return o.x.assign(a.bitAnd(de(255))),o.y.assign(a.shiftRight(de(8)).bitAnd(de(255))),o.z.assign(a.shiftRight(de(16)).bitAnd(de(255))),o}).setLayout({name:"mx_hash_vec3_1",type:"uvec3",inputs:[{name:"x",type:"int"},{name:"y",type:"int"},{name:"z",type:"int"}]}),qu=Wa([Lge,Pge]),Bge=Te(([r])=>{const e=St(r).toVar(),t=de().toVar(),n=de().toVar(),i=re(zr(e.x,t)).toVar(),s=re(zr(e.y,n)).toVar(),a=re(dd(i)).toVar(),o=re(dd(s)).toVar(),l=re(fX(_a(dr(t,n),i,s),_a(dr(t.add(de(1)),n),i.sub(1),s),_a(dr(t,n.add(de(1))),i,s.sub(1)),_a(dr(t.add(de(1)),n.add(de(1))),i.sub(1),s.sub(1)),a,o)).toVar();return hX(l)}).setLayout({name:"mx_perlin_noise_float_0",type:"float",inputs:[{name:"p",type:"vec2"}]}),Ige=Te(([r])=>{const e=ge(r).toVar(),t=de().toVar(),n=de().toVar(),i=de().toVar(),s=re(zr(e.x,t)).toVar(),a=re(zr(e.y,n)).toVar(),o=re(zr(e.z,i)).toVar(),l=re(dd(s)).toVar(),c=re(dd(a)).toVar(),d=re(dd(o)).toVar(),p=re(dX(_a(dr(t,n,i),s,a,o),_a(dr(t.add(de(1)),n,i),s.sub(1),a,o),_a(dr(t,n.add(de(1)),i),s,a.sub(1),o),_a(dr(t.add(de(1)),n.add(de(1)),i),s.sub(1),a.sub(1),o),_a(dr(t,n,i.add(de(1))),s,a,o.sub(1)),_a(dr(t.add(de(1)),n,i.add(de(1))),s.sub(1),a,o.sub(1)),_a(dr(t,n.add(de(1)),i.add(de(1))),s,a.sub(1),o.sub(1)),_a(dr(t.add(de(1)),n.add(de(1)),i.add(de(1))),s.sub(1),a.sub(1),o.sub(1)),l,c,d)).toVar();return pX(p)}).setLayout({name:"mx_perlin_noise_float_1",type:"float",inputs:[{name:"p",type:"vec3"}]}),oI=Wa([Bge,Ige]),Fge=Te(([r])=>{const e=St(r).toVar(),t=de().toVar(),n=de().toVar(),i=re(zr(e.x,t)).toVar(),s=re(zr(e.y,n)).toVar(),a=re(dd(i)).toVar(),o=re(dd(s)).toVar(),l=ge(fX(Wu(qu(t,n),i,s),Wu(qu(t.add(de(1)),n),i.sub(1),s),Wu(qu(t,n.add(de(1))),i,s.sub(1)),Wu(qu(t.add(de(1)),n.add(de(1))),i.sub(1),s.sub(1)),a,o)).toVar();return hX(l)}).setLayout({name:"mx_perlin_noise_vec3_0",type:"vec3",inputs:[{name:"p",type:"vec2"}]}),zge=Te(([r])=>{const e=ge(r).toVar(),t=de().toVar(),n=de().toVar(),i=de().toVar(),s=re(zr(e.x,t)).toVar(),a=re(zr(e.y,n)).toVar(),o=re(zr(e.z,i)).toVar(),l=re(dd(s)).toVar(),c=re(dd(a)).toVar(),d=re(dd(o)).toVar(),p=ge(dX(Wu(qu(t,n,i),s,a,o),Wu(qu(t.add(de(1)),n,i),s.sub(1),a,o),Wu(qu(t,n.add(de(1)),i),s,a.sub(1),o),Wu(qu(t.add(de(1)),n.add(de(1)),i),s.sub(1),a.sub(1),o),Wu(qu(t,n,i.add(de(1))),s,a,o.sub(1)),Wu(qu(t.add(de(1)),n,i.add(de(1))),s.sub(1),a,o.sub(1)),Wu(qu(t,n.add(de(1)),i.add(de(1))),s,a.sub(1),o.sub(1)),Wu(qu(t.add(de(1)),n.add(de(1)),i.add(de(1))),s.sub(1),a.sub(1),o.sub(1)),l,c,d)).toVar();return pX(p)}).setLayout({name:"mx_perlin_noise_vec3_1",type:"vec3",inputs:[{name:"p",type:"vec3"}]}),hE=Wa([Fge,zge]),Vge=Te(([r])=>{const e=re(r).toVar(),t=de(Cs(e)).toVar();return xo(dr(t))}).setLayout({name:"mx_cell_noise_float_0",type:"float",inputs:[{name:"p",type:"float"}]}),Gge=Te(([r])=>{const e=St(r).toVar(),t=de(Cs(e.x)).toVar(),n=de(Cs(e.y)).toVar();return xo(dr(t,n))}).setLayout({name:"mx_cell_noise_float_1",type:"float",inputs:[{name:"p",type:"vec2"}]}),kge=Te(([r])=>{const e=ge(r).toVar(),t=de(Cs(e.x)).toVar(),n=de(Cs(e.y)).toVar(),i=de(Cs(e.z)).toVar();return xo(dr(t,n,i))}).setLayout({name:"mx_cell_noise_float_2",type:"float",inputs:[{name:"p",type:"vec3"}]}),Hge=Te(([r])=>{const e=En(r).toVar(),t=de(Cs(e.x)).toVar(),n=de(Cs(e.y)).toVar(),i=de(Cs(e.z)).toVar(),s=de(Cs(e.w)).toVar();return xo(dr(t,n,i,s))}).setLayout({name:"mx_cell_noise_float_3",type:"float",inputs:[{name:"p",type:"vec4"}]}),Wge=Wa([Vge,Gge,kge,Hge]),qge=Te(([r])=>{const e=re(r).toVar(),t=de(Cs(e)).toVar();return ge(xo(dr(t,de(0))),xo(dr(t,de(1))),xo(dr(t,de(2))))}).setLayout({name:"mx_cell_noise_vec3_0",type:"vec3",inputs:[{name:"p",type:"float"}]}),Xge=Te(([r])=>{const e=St(r).toVar(),t=de(Cs(e.x)).toVar(),n=de(Cs(e.y)).toVar();return ge(xo(dr(t,n,de(0))),xo(dr(t,n,de(1))),xo(dr(t,n,de(2))))}).setLayout({name:"mx_cell_noise_vec3_1",type:"vec3",inputs:[{name:"p",type:"vec2"}]}),$ge=Te(([r])=>{const e=ge(r).toVar(),t=de(Cs(e.x)).toVar(),n=de(Cs(e.y)).toVar(),i=de(Cs(e.z)).toVar();return ge(xo(dr(t,n,i,de(0))),xo(dr(t,n,i,de(1))),xo(dr(t,n,i,de(2))))}).setLayout({name:"mx_cell_noise_vec3_2",type:"vec3",inputs:[{name:"p",type:"vec3"}]}),jge=Te(([r])=>{const e=En(r).toVar(),t=de(Cs(e.x)).toVar(),n=de(Cs(e.y)).toVar(),i=de(Cs(e.z)).toVar(),s=de(Cs(e.w)).toVar();return ge(xo(dr(t,n,i,s,de(0))),xo(dr(t,n,i,s,de(1))),xo(dr(t,n,i,s,de(2))))}).setLayout({name:"mx_cell_noise_vec3_3",type:"vec3",inputs:[{name:"p",type:"vec4"}]}),ON=Wa([qge,Xge,$ge,jge]),IR=Te(([r,e,t,n])=>{const i=re(n).toVar(),s=re(t).toVar(),a=de(e).toVar(),o=ge(r).toVar(),l=re(0).toVar(),c=re(1).toVar();return rr(a,()=>{l.addAssign(c.mul(oI(o))),c.mulAssign(i),o.mulAssign(s)}),l}).setLayout({name:"mx_fractal_noise_float",type:"float",inputs:[{name:"p",type:"vec3"},{name:"octaves",type:"int"},{name:"lacunarity",type:"float"},{name:"diminish",type:"float"}]}),UN=Te(([r,e,t,n])=>{const i=re(n).toVar(),s=re(t).toVar(),a=de(e).toVar(),o=ge(r).toVar(),l=ge(0).toVar(),c=re(1).toVar();return rr(a,()=>{l.addAssign(c.mul(hE(o))),c.mulAssign(i),o.mulAssign(s)}),l}).setLayout({name:"mx_fractal_noise_vec3",type:"vec3",inputs:[{name:"p",type:"vec3"},{name:"octaves",type:"int"},{name:"lacunarity",type:"float"},{name:"diminish",type:"float"}]}),Yge=Te(([r,e,t,n])=>{const i=re(n).toVar(),s=re(t).toVar(),a=de(e).toVar(),o=ge(r).toVar();return St(IR(o,a,s,i),IR(o.add(ge(de(19),de(193),de(17))),a,s,i))}).setLayout({name:"mx_fractal_noise_vec2",type:"vec2",inputs:[{name:"p",type:"vec3"},{name:"octaves",type:"int"},{name:"lacunarity",type:"float"},{name:"diminish",type:"float"}]}),Zge=Te(([r,e,t,n])=>{const i=re(n).toVar(),s=re(t).toVar(),a=de(e).toVar(),o=ge(r).toVar(),l=ge(UN(o,a,s,i)).toVar(),c=re(IR(o.add(ge(de(19),de(193),de(17))),a,s,i)).toVar();return En(l,c)}).setLayout({name:"mx_fractal_noise_vec4",type:"vec4",inputs:[{name:"p",type:"vec3"},{name:"octaves",type:"int"},{name:"lacunarity",type:"float"},{name:"diminish",type:"float"}]}),Kge=Te(([r,e,t,n,i,s,a])=>{const o=de(a).toVar(),l=re(s).toVar(),c=de(i).toVar(),d=de(n).toVar(),p=de(t).toVar(),y=de(e).toVar(),_=St(r).toVar(),v=ge(ON(St(y.add(d),p.add(c)))).toVar(),b=St(v.x,v.y).toVar();b.subAssign(.5),b.mulAssign(l),b.addAssign(.5);const E=St(St(re(y),re(p)).add(b)).toVar(),T=St(E.sub(_)).toVar();return Tn(o.equal(de(2)),()=>Sr(T.x).add(Sr(T.y))),Tn(o.equal(de(3)),()=>Kr(Sr(T.x),Sr(T.y))),uc(T,T)}).setLayout({name:"mx_worley_distance_0",type:"float",inputs:[{name:"p",type:"vec2"},{name:"x",type:"int"},{name:"y",type:"int"},{name:"xoff",type:"int"},{name:"yoff",type:"int"},{name:"jitter",type:"float"},{name:"metric",type:"int"}]}),Qge=Te(([r,e,t,n,i,s,a,o,l])=>{const c=de(l).toVar(),d=re(o).toVar(),p=de(a).toVar(),y=de(s).toVar(),_=de(i).toVar(),v=de(n).toVar(),b=de(t).toVar(),E=de(e).toVar(),T=ge(r).toVar(),M=ge(ON(ge(E.add(_),b.add(y),v.add(p)))).toVar();M.subAssign(.5),M.mulAssign(d),M.addAssign(.5);const R=ge(ge(re(E),re(b),re(v)).add(M)).toVar(),N=ge(R.sub(T)).toVar();return Tn(c.equal(de(2)),()=>Sr(N.x).add(Sr(N.y)).add(Sr(N.z))),Tn(c.equal(de(3)),()=>Kr(Sr(N.x),Sr(N.y),Sr(N.z))),uc(N,N)}).setLayout({name:"mx_worley_distance_1",type:"float",inputs:[{name:"p",type:"vec3"},{name:"x",type:"int"},{name:"y",type:"int"},{name:"z",type:"int"},{name:"xoff",type:"int"},{name:"yoff",type:"int"},{name:"zoff",type:"int"},{name:"jitter",type:"float"},{name:"metric",type:"int"}]}),Zx=Wa([Kge,Qge]),Jge=Te(([r,e,t])=>{const n=de(t).toVar(),i=re(e).toVar(),s=St(r).toVar(),a=de().toVar(),o=de().toVar(),l=St(zr(s.x,a),zr(s.y,o)).toVar(),c=re(1e6).toVar();return rr({start:-1,end:de(1),name:"x",condition:"<="},({x:d})=>{rr({start:-1,end:de(1),name:"y",condition:"<="},({y:p})=>{const y=re(Zx(l,d,p,a,o,i,n)).toVar();c.assign(zl(c,y))})}),Tn(n.equal(de(0)),()=>{c.assign(go(c))}),c}).setLayout({name:"mx_worley_noise_float_0",type:"float",inputs:[{name:"p",type:"vec2"},{name:"jitter",type:"float"},{name:"metric",type:"int"}]}),e0e=Te(([r,e,t])=>{const n=de(t).toVar(),i=re(e).toVar(),s=St(r).toVar(),a=de().toVar(),o=de().toVar(),l=St(zr(s.x,a),zr(s.y,o)).toVar(),c=St(1e6,1e6).toVar();return rr({start:-1,end:de(1),name:"x",condition:"<="},({x:d})=>{rr({start:-1,end:de(1),name:"y",condition:"<="},({y:p})=>{const y=re(Zx(l,d,p,a,o,i,n)).toVar();Tn(y.lessThan(c.x),()=>{c.y.assign(c.x),c.x.assign(y)}).ElseIf(y.lessThan(c.y),()=>{c.y.assign(y)})})}),Tn(n.equal(de(0)),()=>{c.assign(go(c))}),c}).setLayout({name:"mx_worley_noise_vec2_0",type:"vec2",inputs:[{name:"p",type:"vec2"},{name:"jitter",type:"float"},{name:"metric",type:"int"}]}),t0e=Te(([r,e,t])=>{const n=de(t).toVar(),i=re(e).toVar(),s=St(r).toVar(),a=de().toVar(),o=de().toVar(),l=St(zr(s.x,a),zr(s.y,o)).toVar(),c=ge(1e6,1e6,1e6).toVar();return rr({start:-1,end:de(1),name:"x",condition:"<="},({x:d})=>{rr({start:-1,end:de(1),name:"y",condition:"<="},({y:p})=>{const y=re(Zx(l,d,p,a,o,i,n)).toVar();Tn(y.lessThan(c.x),()=>{c.z.assign(c.y),c.y.assign(c.x),c.x.assign(y)}).ElseIf(y.lessThan(c.y),()=>{c.z.assign(c.y),c.y.assign(y)}).ElseIf(y.lessThan(c.z),()=>{c.z.assign(y)})})}),Tn(n.equal(de(0)),()=>{c.assign(go(c))}),c}).setLayout({name:"mx_worley_noise_vec3_0",type:"vec3",inputs:[{name:"p",type:"vec2"},{name:"jitter",type:"float"},{name:"metric",type:"int"}]}),n0e=Te(([r,e,t])=>{const n=de(t).toVar(),i=re(e).toVar(),s=ge(r).toVar(),a=de().toVar(),o=de().toVar(),l=de().toVar(),c=ge(zr(s.x,a),zr(s.y,o),zr(s.z,l)).toVar(),d=re(1e6).toVar();return rr({start:-1,end:de(1),name:"x",condition:"<="},({x:p})=>{rr({start:-1,end:de(1),name:"y",condition:"<="},({y})=>{rr({start:-1,end:de(1),name:"z",condition:"<="},({z:_})=>{const v=re(Zx(c,p,y,_,a,o,l,i,n)).toVar();d.assign(zl(d,v))})})}),Tn(n.equal(de(0)),()=>{d.assign(go(d))}),d}).setLayout({name:"mx_worley_noise_float_1",type:"float",inputs:[{name:"p",type:"vec3"},{name:"jitter",type:"float"},{name:"metric",type:"int"}]}),i0e=Wa([Jge,n0e]),r0e=Te(([r,e,t])=>{const n=de(t).toVar(),i=re(e).toVar(),s=ge(r).toVar(),a=de().toVar(),o=de().toVar(),l=de().toVar(),c=ge(zr(s.x,a),zr(s.y,o),zr(s.z,l)).toVar(),d=St(1e6,1e6).toVar();return rr({start:-1,end:de(1),name:"x",condition:"<="},({x:p})=>{rr({start:-1,end:de(1),name:"y",condition:"<="},({y})=>{rr({start:-1,end:de(1),name:"z",condition:"<="},({z:_})=>{const v=re(Zx(c,p,y,_,a,o,l,i,n)).toVar();Tn(v.lessThan(d.x),()=>{d.y.assign(d.x),d.x.assign(v)}).ElseIf(v.lessThan(d.y),()=>{d.y.assign(v)})})})}),Tn(n.equal(de(0)),()=>{d.assign(go(d))}),d}).setLayout({name:"mx_worley_noise_vec2_1",type:"vec2",inputs:[{name:"p",type:"vec3"},{name:"jitter",type:"float"},{name:"metric",type:"int"}]}),s0e=Wa([e0e,r0e]),a0e=Te(([r,e,t])=>{const n=de(t).toVar(),i=re(e).toVar(),s=ge(r).toVar(),a=de().toVar(),o=de().toVar(),l=de().toVar(),c=ge(zr(s.x,a),zr(s.y,o),zr(s.z,l)).toVar(),d=ge(1e6,1e6,1e6).toVar();return rr({start:-1,end:de(1),name:"x",condition:"<="},({x:p})=>{rr({start:-1,end:de(1),name:"y",condition:"<="},({y})=>{rr({start:-1,end:de(1),name:"z",condition:"<="},({z:_})=>{const v=re(Zx(c,p,y,_,a,o,l,i,n)).toVar();Tn(v.lessThan(d.x),()=>{d.z.assign(d.y),d.y.assign(d.x),d.x.assign(v)}).ElseIf(v.lessThan(d.y),()=>{d.z.assign(d.y),d.y.assign(v)}).ElseIf(v.lessThan(d.z),()=>{d.z.assign(v)})})})}),Tn(n.equal(de(0)),()=>{d.assign(go(d))}),d}).setLayout({name:"mx_worley_noise_vec3_1",type:"vec3",inputs:[{name:"p",type:"vec3"},{name:"jitter",type:"float"},{name:"metric",type:"int"}]}),lI=Wa([t0e,a0e]),o0e=Te(([r,e,t,n,i,s,a,o,l,c,d])=>{const p=de(r).toVar(),y=St(e).toVar(),_=St(t).toVar(),v=St(n).toVar(),b=re(i).toVar(),E=re(s).toVar(),T=re(a).toVar(),M=lc(o).toVar(),R=de(l).toVar(),N=re(c).toVar(),P=re(d).toVar(),U=y.mul(_).add(v),L=re(0).toVar();return Tn(p.equal(de(0)),()=>{L.assign(hE(U))}),Tn(p.equal(de(1)),()=>{L.assign(ON(U))}),Tn(p.equal(de(2)),()=>{L.assign(lI(U,b,de(0)))}),Tn(p.equal(de(3)),()=>{L.assign(UN(ge(U,0),R,N,P))}),L.assign(L.mul(T.sub(E)).add(E)),Tn(M,()=>{L.assign(Jc(L,E,T))}),L}).setLayout({name:"mx_unifiednoise2d",type:"float",inputs:[{name:"noiseType",type:"int"},{name:"texcoord",type:"vec2"},{name:"freq",type:"vec2"},{name:"offset",type:"vec2"},{name:"jitter",type:"float"},{name:"outmin",type:"float"},{name:"outmax",type:"float"},{name:"clampoutput",type:"bool"},{name:"octaves",type:"int"},{name:"lacunarity",type:"float"},{name:"diminish",type:"float"}]}),l0e=Te(([r,e,t,n,i,s,a,o,l,c,d])=>{const p=de(r).toVar(),y=ge(e).toVar(),_=ge(t).toVar(),v=ge(n).toVar(),b=re(i).toVar(),E=re(s).toVar(),T=re(a).toVar(),M=lc(o).toVar(),R=de(l).toVar(),N=re(c).toVar(),P=re(d).toVar(),U=y.mul(_).add(v),L=re(0).toVar();return Tn(p.equal(de(0)),()=>{L.assign(hE(U))}),Tn(p.equal(de(1)),()=>{L.assign(ON(U))}),Tn(p.equal(de(2)),()=>{L.assign(lI(U,b,de(0)))}),Tn(p.equal(de(3)),()=>{L.assign(UN(U,R,N,P))}),L.assign(L.mul(T.sub(E)).add(E)),Tn(M,()=>{L.assign(Jc(L,E,T))}),L}).setLayout({name:"mx_unifiednoise3d",type:"float",inputs:[{name:"noiseType",type:"int"},{name:"position",type:"vec3"},{name:"freq",type:"vec3"},{name:"offset",type:"vec3"},{name:"jitter",type:"float"},{name:"outmin",type:"float"},{name:"outmax",type:"float"},{name:"clampoutput",type:"bool"},{name:"octaves",type:"int"},{name:"lacunarity",type:"float"},{name:"diminish",type:"float"}]}),u0e=Te(([r])=>{const e=r.y,t=r.z,n=ge().toVar();return Tn(e.lessThan(1e-4),()=>{n.assign(ge(t,t,t))}).Else(()=>{let i=r.x;i=i.sub(ld(i)).mul(6).toVar();const s=de(uB(i)),a=i.sub(re(s)),o=t.mul(e.oneMinus()),l=t.mul(e.mul(a).oneMinus()),c=t.mul(e.mul(a.oneMinus()).oneMinus());Tn(s.equal(de(0)),()=>{n.assign(ge(t,c,o))}).ElseIf(s.equal(de(1)),()=>{n.assign(ge(l,t,o))}).ElseIf(s.equal(de(2)),()=>{n.assign(ge(o,t,c))}).ElseIf(s.equal(de(3)),()=>{n.assign(ge(o,l,t))}).ElseIf(s.equal(de(4)),()=>{n.assign(ge(c,o,t))}).Else(()=>{n.assign(ge(t,o,l))})}),n}).setLayout({name:"mx_hsvtorgb",type:"vec3",inputs:[{name:"hsv",type:"vec3"}]}),c0e=Te(([r])=>{const e=ge(r).toVar(),t=re(e.x).toVar(),n=re(e.y).toVar(),i=re(e.z).toVar(),s=re(zl(t,zl(n,i))).toVar(),a=re(Kr(t,Kr(n,i))).toVar(),o=re(a.sub(s)).toVar(),l=re().toVar(),c=re().toVar(),d=re().toVar();return d.assign(a),Tn(a.greaterThan(0),()=>{c.assign(o.div(a))}).Else(()=>{c.assign(0)}),Tn(c.lessThanEqual(0),()=>{l.assign(0)}).Else(()=>{Tn(t.greaterThanEqual(a),()=>{l.assign(n.sub(i).div(o))}).ElseIf(n.greaterThanEqual(a),()=>{l.assign(Ns(2,i.sub(t).div(o)))}).Else(()=>{l.assign(Ns(4,t.sub(n).div(o)))}),l.mulAssign(1/6),Tn(l.lessThan(0),()=>{l.addAssign(1)})}),ge(l,c,d)}).setLayout({name:"mx_rgbtohsv",type:"vec3",inputs:[{name:"c",type:"vec3"}]}),f0e=Te(([r])=>{const e=ge(r).toVar(),t=qP(eB(e,ge(.04045))).toVar(),n=ge(e.div(12.92)).toVar(),i=ge(Ju(Kr(e.add(ge(.055)),ge(0)).div(1.055),ge(2.4))).toVar();return yi(n,i,t)}).setLayout({name:"mx_srgb_texture_to_lin_rec709",type:"vec3",inputs:[{name:"color",type:"vec3"}]}),gX=(r,e)=>{r=re(r),e=re(e);const t=St(e.dFdx(),e.dFdy()).length().mul(.7071067811865476);return ef(r.sub(t),r.add(t),e)},yX=(r,e,t,n)=>yi(r,e,t[n].clamp()),d0e=(r,e,t=hr())=>yX(r,e,t,"x"),h0e=(r,e,t=hr())=>yX(r,e,t,"y"),p0e=(r,e,t,n,i=hr())=>{const s=i.x.clamp(),a=i.y.clamp(),o=yi(r,e,s),l=yi(t,n,s);return yi(o,l,a)},_X=(r,e,t,n,i)=>yi(r,e,gX(t,n[i])),m0e=(r,e,t,n=hr())=>_X(r,e,t,n,"x"),g0e=(r,e,t,n=hr())=>_X(r,e,t,n,"y"),y0e=(r=1,e=0,t=hr())=>t.mul(r).add(e),_0e=(r,e=1)=>(r=re(r),r.abs().pow(e).mul(r.sign())),v0e=(r,e=1,t=.5)=>re(r).sub(t).mul(e).add(t),x0e=(r=hr(),e=1,t=0)=>oI(r.convert("vec2|vec3")).mul(e).add(t),b0e=(r=hr(),e=1,t=0)=>hE(r.convert("vec2|vec3")).mul(e).add(t),S0e=(r=hr(),e=1,t=0)=>(r=r.convert("vec2|vec3"),En(hE(r),oI(r.add(St(19,73)))).mul(e).add(t)),T0e=(r,e=hr(),t=St(1,1),n=St(0,0),i=1,s=0,a=1,o=!1,l=1,c=2,d=.5)=>o0e(r,e.convert("vec2|vec3"),t,n,i,s,a,o,l,c,d),E0e=(r,e=hr(),t=St(1,1),n=St(0,0),i=1,s=0,a=1,o=!1,l=1,c=2,d=.5)=>l0e(r,e.convert("vec2|vec3"),t,n,i,s,a,o,l,c,d),M0e=(r=hr(),e=1)=>i0e(r.convert("vec2|vec3"),e,de(1)),A0e=(r=hr(),e=1)=>s0e(r.convert("vec2|vec3"),e,de(1)),w0e=(r=hr(),e=1)=>lI(r.convert("vec2|vec3"),e,de(1)),R0e=(r=hr())=>Wge(r.convert("vec2|vec3")),C0e=(r=hr(),e=3,t=2,n=.5,i=1)=>IR(r,de(e),t,n).mul(i),N0e=(r=hr(),e=3,t=2,n=.5,i=1)=>Yge(r,de(e),t,n).mul(i),D0e=(r=hr(),e=3,t=2,n=.5,i=1)=>UN(r,de(e),t,n).mul(i),O0e=(r=hr(),e=3,t=2,n=.5,i=1)=>Zge(r,de(e),t,n).mul(i),U0e=(r,e=re(0))=>Ns(r,e),L0e=(r,e=re(0))=>_i(r,e),P0e=(r,e=re(1))=>Vn(r,e),B0e=(r,e=re(1))=>Su(r,e),I0e=(r,e=re(1))=>sE(r,e),F0e=(r,e=re(1))=>Ju(r,e),z0e=(r=re(0),e=re(1))=>fN(r,e),V0e=()=>Yx,G0e=()=>Oq,k0e=(r,e=re(1))=>_i(e,r),H0e=(r,e,t,n)=>r.greaterThan(e).mix(t,n),W0e=(r,e,t,n)=>r.greaterThanEqual(e).mix(t,n),q0e=(r,e,t,n)=>r.equal(e).mix(t,n),X0e=(r,e=null)=>{if(typeof e=="string"){const t={x:0,r:0,y:1,g:1,z:2,b:2,w:3,a:3},n=e.replace(/^out/,"").toLowerCase();if(t[n]!==void 0)return r.element(t[n])}if(typeof e=="number")return r.element(e);if(typeof e=="string"&&e.length===1){const t={x:0,r:0,y:1,g:1,z:2,b:2,w:3,a:3};if(t[e]!==void 0)return r.element(t[e])}return r},$0e=(r,e=St(.5,.5),t=St(1,1),n=re(0),i=St(0,0))=>{let s=r;if(e&&(s=s.sub(e)),t&&(s=s.mul(t)),n){const a=n.mul(Math.PI/180),o=a.cos(),l=a.sin();s=St(s.x.mul(o).sub(s.y.mul(l)),s.x.mul(l).add(s.y.mul(o)))}return e&&(s=s.add(e)),i&&(s=s.add(i)),s},j0e=(r,e)=>{r=St(r),e=re(e);const t=e.mul(Math.PI/180);return uE(r,t)},Y0e=(r,e,t)=>{r=ge(r),e=re(e),t=ge(t);const n=e.mul(Math.PI/180),i=t.normalize(),s=n.cos(),a=n.sin(),o=re(1).sub(s);return r.mul(s).add(i.cross(r).mul(a)).add(i.mul(i.dot(r)).mul(o))},Z0e=(r,e)=>(r=ge(r),e=re(e),OB(r,e)),K0e=Te(([r,e,t])=>{const n=al(r).toVar(),i=_i(re(.5).mul(e.sub(t)),cd).div(n).toVar(),s=_i(re(-.5).mul(e.sub(t)),cd).div(n).toVar(),a=ge().toVar();a.x=n.x.greaterThan(re(0)).select(i.x,s.x),a.y=n.y.greaterThan(re(0)).select(i.y,s.y),a.z=n.z.greaterThan(re(0)).select(i.z,s.z);const o=zl(a.x,a.y,a.z).toVar();return cd.add(n.mul(o)).toVar().sub(t)}),vX=Te(([r,e])=>{const t=r.x,n=r.y,i=r.z;let s=e.element(0).mul(.886227);return s=s.add(e.element(1).mul(2*.511664).mul(n)),s=s.add(e.element(2).mul(2*.511664).mul(i)),s=s.add(e.element(3).mul(2*.511664).mul(t)),s=s.add(e.element(4).mul(2*.429043).mul(t).mul(n)),s=s.add(e.element(5).mul(2*.429043).mul(n).mul(i)),s=s.add(e.element(6).mul(i.mul(i).mul(.743125).sub(.247708))),s=s.add(e.element(7).mul(2*.429043).mul(t).mul(i)),s=s.add(e.element(8).mul(.429043).mul(Vn(t,t).sub(Vn(n,n)))),s});var I=Object.freeze({__proto__:null,BRDF_GGX:HB,BRDF_Lambert:by,BasicPointShadowFilter:oX,BasicShadowFilter:Qq,Break:X7,Const:fW,Continue:Ice,DFGLUT:A1,D_GGX:cq,Discard:wW,EPSILON:tB,F_Schlick:Dx,Fn:Te,HALF_PI:uue,INFINITY:aue,If:Tn,Loop:rr,NodeAccess:Fa,NodeShaderStage:bT,NodeType:Cle,NodeUpdateType:$n,OnBeforeMaterialUpdate:rpe,OnBeforeObjectUpdate:ipe,OnMaterialUpdate:npe,OnObjectUpdate:tpe,PCFShadowFilter:Jq,PCFSoftShadowFilter:eX,PI:CR,PI2:oue,PointShadowFilter:lX,Return:Mue,Schlick_to_F0:hU,ScriptableNodeResources:qw,ShaderNode:Fv,Stack:sN,Switch:Kle,TBNViewMatrix:S0,TWO_PI:lue,VSMShadowFilter:tX,V_GGX_SmithCorrelated:uq,Var:cW,VarIntent:dW,abs:Sr,acesFilmicToneMapping:Hq,acos:rB,add:Ns,addMethodChaining:Ke,addNodeElement:Cue,agxToneMapping:Wq,all:P9,alphaT:AR,and:x9,anisotropy:Zp,anisotropyB:I0,anisotropyT:$T,any:B9,append:tue,array:h9,arrayBuffer:Jle,asin:V9,assign:p9,atan:fN,atan2:rW,atomicAdd:dme,atomicAnd:gme,atomicFunc:Sd,atomicLoad:cme,atomicMax:pme,atomicMin:mme,atomicOr:yme,atomicStore:fme,atomicSub:hme,atomicXor:_me,attenuationColor:ZP,attenuationDistance:YP,attribute:kh,attributeArray:ope,backgroundBlurriness:Pq,backgroundIntensity:_U,backgroundRotation:Bq,batch:H7,bentNormalView:s7,billboarding:Fhe,bitAnd:E9,bitNot:M9,bitOr:A9,bitXor:w9,bitangentGeometry:mce,bitangentLocal:gce,bitangentView:i7,bitangentWorld:yce,bitcast:Nq,blendBurn:Q7,blendColor:efe,blendDodge:J7,blendOverlay:tq,blendScreen:eq,blur:yq,bool:lc,buffer:aE,bufferAttribute:xB,builtin:Yh,builtinAOContext:lW,builtinShadowContext:oW,bumpMap:OB,burn:nfe,bvec2:a9,bvec3:qP,bvec4:o9,bypass:TW,cache:SW,call:m9,cameraFar:Jp,cameraIndex:km,cameraNear:Qp,cameraNormalMatrix:Wue,cameraPosition:PW,cameraProjectionMatrix:Ch,cameraProjectionMatrixInverse:kue,cameraViewMatrix:hc,cameraViewport:que,cameraWorldMatrix:Hue,cbrt:J9,cdl:Mpe,ceil:cN,checker:mge,cineonToneMapping:kq,clamp:Jc,clearcoat:TR,clearcoatNormalView:b0,clearcoatRoughness:M1,code:CN,color:s9,colorSpaceToWorking:pN,colorToDirection:vce,compute:bW,computeKernel:bB,computeSkinning:Pce,context:jh,convert:u9,convertColorSpace:gue,convertToTexture:Zhe,cos:qc,countLeadingZeros:phe,countOneBits:mhe,countTrailingZeros:hhe,cross:Vh,cubeTexture:il,cubeTextureBase:DB,dFdx:oB,dFdy:lB,dashSize:Fw,debug:CW,decrement:U9,decrementBefore:D9,defaultBuildStages:QO,defaultShaderStages:JH,defined:S1,degrees:F9,deltaTime:Nhe,densityFog:$pe,densityFogFactor:JB,depth:zB,depthPass:Npe,determinant:q9,difference:Z9,diffuseColor:nr,diffuseContribution:c0,directPointLight:cX,directionToColor:a7,directionToFaceDirection:$x,dispersion:KP,disposeShadowMaterial:iX,distance:Y9,div:Su,dodge:ife,dot:uc,drawIndex:V7,dynamicBufferAttribute:bue,element:l9,emissive:nU,equal:JP,equals:$9,equirectUV:VB,exp:nB,exp2:Cx,expression:Gh,faceDirection:RB,faceForward:mB,faceforward:cue,float:re,floatBitsToInt:che,floatBitsToUint:Dq,floor:ld,fog:R1,fract:Qc,frameGroup:d9,frameId:Oq,frontFacing:zW,fwidth:cB,gain:yhe,gapSize:iU,getConstNodeType:r9,getCurrentStack:kP,getDirection:mq,getDistanceAttenuation:aI,getGeometryRoughness:lq,getNormalFromDepth:Qhe,getParallaxCorrectNormal:K0e,getRoughness:kB,getScreenPosition:Khe,getShIrradianceAt:vX,getShadowMaterial:nX,getShadowRenderObjectFunction:rX,getTextureIndex:Rq,getViewPosition:Dv,ggxConvolution:_q,globalId:Jpe,glsl:zpe,glslFn:Vpe,grayscale:bpe,greaterThan:eB,greaterThanEqual:v9,hash:ghe,highpModelNormalViewMatrix:aU,highpModelViewMatrix:sU,hue:Epe,increment:O9,incrementBefore:N9,inspector:DW,instance:Oce,instanceIndex:fd,instancedArray:lpe,instancedBufferAttribute:NR,instancedDynamicBufferAttribute:rU,instancedMesh:k7,int:de,intBitsToFloat:fhe,interleavedGradientNoise:ZB,inverse:X9,inverseSqrt:iB,inversesqrt:fue,invocationLocalIndex:Dce,invocationSubgroupIndex:Nce,ior:jT,iridescence:oN,iridescenceIOR:ER,iridescenceThickness:MR,isolate:Qv,ivec2:Vs,ivec3:WP,ivec4:XP,js:Ipe,label:uW,length:ud,lengthSq:hB,lessThan:y9,lessThanEqual:_9,lightPosition:tI,lightProjectionUV:Zq,lightShadowMatrix:DN,lightTargetDirection:iI,lightTargetPosition:Kq,lightViewPosition:nI,lightingContext:j7,lights:Xme,linearDepth:OR,linearToneMapping:Vq,localId:eme,log:uN,log2:od,logarithmicDepthToViewZ:Xce,luminance:KB,mat2:aN,mat3:Ha,mat4:gm,matcapUV:bq,materialAO:I7,materialAlphaTest:o7,materialAnisotropy:S7,materialAnisotropyVector:Nv,materialAttenuationColor:N7,materialAttenuationDistance:C7,materialClearcoat:g7,materialClearcoatNormal:_7,materialClearcoatRoughness:y7,materialColor:l7,materialDispersion:B7,materialEmissive:c7,materialEnvIntensity:Gw,materialEnvRotation:NB,materialIOR:R7,materialIridescence:T7,materialIridescenceIOR:E7,materialIridescenceThickness:M7,materialLightMap:LB,materialLineDashOffset:L7,materialLineDashSize:O7,materialLineGapSize:U7,materialLineScale:D7,materialLineWidth:Ece,materialMetalness:p7,materialNormal:m7,materialOpacity:UB,materialPointSize:P7,materialReference:ph,materialReflectivity:kw,materialRefractionRatio:HW,materialRotation:v7,materialRoughness:h7,materialSheen:x7,materialSheenRoughness:b7,materialShininess:u7,materialSpecular:f7,materialSpecularColor:d7,materialSpecularIntensity:dU,materialSpecularStrength:YT,materialThickness:w7,materialTransmission:A7,max:Kr,maxMipLevel:SB,mediumpModelViewMatrix:FW,metalness:yh,min:zl,mix:yi,mixElement:tW,mod:sE,modInt:L9,modelDirection:Kue,modelNormalMatrix:IW,modelPosition:Que,modelRadius:tce,modelScale:Jue,modelViewMatrix:Hm,modelViewPosition:ece,modelViewProjection:F7,modelWorldMatrix:ec,modelWorldMatrixInverse:nce,morphReference:$7,mrt:Cq,mul:Vn,mx_aastep:gX,mx_add:U0e,mx_atan2:z0e,mx_cell_noise_float:R0e,mx_contrast:v0e,mx_divide:B0e,mx_fractal_noise_float:C0e,mx_fractal_noise_vec2:N0e,mx_fractal_noise_vec3:D0e,mx_fractal_noise_vec4:O0e,mx_frame:G0e,mx_heighttonormal:Z0e,mx_hsvtorgb:u0e,mx_ifequal:q0e,mx_ifgreater:H0e,mx_ifgreatereq:W0e,mx_invert:k0e,mx_modulo:I0e,mx_multiply:P0e,mx_noise_float:x0e,mx_noise_vec3:b0e,mx_noise_vec4:S0e,mx_place2d:$0e,mx_power:F0e,mx_ramp4:p0e,mx_ramplr:d0e,mx_ramptb:h0e,mx_rgbtohsv:c0e,mx_rotate2d:j0e,mx_rotate3d:Y0e,mx_safepower:_0e,mx_separate:X0e,mx_splitlr:m0e,mx_splittb:g0e,mx_srgb_texture_to_lin_rec709:f0e,mx_subtract:L0e,mx_timer:V0e,mx_transform_uv:y0e,mx_unifiednoise2d:T0e,mx_unifiednoise3d:E0e,mx_worley_noise_float:M0e,mx_worley_noise_vec2:A0e,mx_worley_noise_vec3:w0e,negate:aB,neutralToneMapping:qq,nodeArray:B0,nodeImmutable:kt,nodeObject:Xt,nodeObjectIntent:ST,nodeObjects:rN,nodeProxy:Gn,nodeProxyIntent:Mt,normalFlat:VW,normalGeometry:gN,normalLocal:Vl,normalMap:fU,normalView:Ri,normalViewGeometry:Nx,normalWorld:Wm,normalWorldGeometry:GW,normalize:al,not:S9,notEqual:g9,numWorkgroups:Kpe,objectDirection:Xue,objectGroup:QP,objectPosition:BW,objectRadius:Zue,objectScale:jue,objectViewPosition:Yue,objectWorldMatrix:$ue,oneMinus:G9,or:b9,orthographicDepthToViewZ:qce,oscSawtooth:Lhe,oscSine:Dhe,oscSquare:Ohe,oscTriangle:Uhe,output:Zv,outputStruct:lhe,overlay:sfe,overloadingFn:Wa,packHalf2x16:She,packSnorm2x16:xhe,packUnorm2x16:bhe,parabola:yU,parallaxDirection:r7,parallaxUV:_ce,parameter:nhe,pass:Rpe,passTexture:Cpe,pcurve:_he,perspectiveDepthToViewZ:IB,pmremTexture:qB,pointShadow:uX,pointUV:cpe,pointWidth:nue,positionGeometry:oE,positionLocal:Yr,positionPrevious:DR,positionView:xs,positionViewDirection:mr,positionWorld:cd,positionWorldDirection:wB,posterize:wpe,pow:Ju,pow2:fB,pow3:K9,pow4:dB,premultiplyAlpha:nq,property:Ah,quadBroadcast:Hme,quadSwapDiagonal:Ime,quadSwapX:Pme,quadSwapY:Bme,radians:I9,rand:eW,range:Ype,rangeFog:Xpe,rangeFogFactor:QB,reciprocal:H9,reference:fr,referenceBuffer:oU,reflect:j9,reflectVector:XW,reflectView:WW,reflector:qhe,refract:pB,refractVector:$W,refractView:qW,reinhardToneMapping:Gq,remap:MW,remapClamp:AW,renderGroup:yn,renderOutput:RW,rendererReference:_W,replaceDefaultUV:Phe,rotate:uE,rotateUV:Bhe,roughness:td,round:k9,rtt:Lq,sRGBTransferEOTF:pW,sRGBTransferOETF:mW,sample:epe,sampler:Pue,samplerComparison:Bue,saturate:hN,saturation:Spe,screen:rfe,screenCoordinate:Py,screenDPR:UW,screenSize:xy,screenUV:Rh,scriptable:qpe,scriptableValue:Ww,select:za,setCurrentStack:T1,setName:gB,shaderStages:JO,shadow:aX,shadowPositionWorld:sI,shapeCircle:gge,sharedUniformGroup:lN,sheen:nu,sheenRoughness:Kp,shiftLeft:R9,shiftRight:C9,shininess:wR,sign:sB,sin:Qo,sinc:vhe,skinning:q7,smoothstep:ef,smoothstepElement:nW,specularColor:Cm,specularColorBlended:x0,specularF90:Yv,spherizeUV:Ihe,split:eue,spritesheetUV:Ghe,sqrt:go,stack:Hw,step:dN,stepElement:iW,storage:Nh,storageBarrier:rme,storageObject:Rce,storageTexture:Iq,string:Qle,struct:ohe,sub:_i,subBuild:Kv,subgroupAdd:bme,subgroupAll:Ome,subgroupAnd:wme,subgroupAny:Ume,subgroupBallot:xme,subgroupBroadcast:Fme,subgroupBroadcastFirst:Lme,subgroupElect:vme,subgroupExclusiveAdd:Tme,subgroupExclusiveMul:Ame,subgroupInclusiveAdd:Sme,subgroupInclusiveMul:Mme,subgroupIndex:Cce,subgroupMax:Dme,subgroupMin:Nme,subgroupMul:Eme,subgroupOr:Rme,subgroupShuffle:zme,subgroupShuffleDown:kme,subgroupShuffleUp:Gme,subgroupShuffleXor:Vme,subgroupSize:tme,subgroupXor:Cme,tan:z9,tangentGeometry:_N,tangentLocal:lE,tangentView:vN,tangentWorld:n7,texture:Li,texture3D:RN,texture3DLevel:gpe,texture3DLoad:mpe,textureBarrier:sme,textureBicubic:Bfe,textureBicubicLevel:WB,textureCubeUV:gq,textureLevel:Lue,textureLoad:as,textureSize:wh,textureStore:dpe,thickness:jP,time:Yx,toneMapping:vW,toneMappingExposure:xW,toonOutlinePass:Ope,transformDirection:Q9,transformNormal:kW,transformNormalToView:CB,transformedClearcoatNormalView:ace,transformedNormalView:rce,transformedNormalWorld:sce,transmission:RR,transpose:W9,triNoise3D:whe,triplanarTexture:khe,triplanarTextures:Uq,trunc:uB,uint:vt,uintBitsToFloat:dhe,uniform:_n,uniformArray:fo,uniformCubeTexture:lce,uniformFlow:aW,uniformGroup:f9,uniformTexture:Uue,unpackHalf2x16:Mhe,unpackNormal:cU,unpackSnorm2x16:The,unpackUnorm2x16:Ehe,unpremultiplyAlpha:tfe,userData:_pe,uv:hr,uvec2:HP,uvec3:Ly,uvec4:$P,varying:bd,varyingProperty:E1,vec2:St,vec3:ge,vec4:En,vectorComponents:Oy,velocity:xpe,vertexColor:K7,vertexIndex:z7,vertexStage:hW,vibrance:Tpe,viewZToLogarithmicDepth:FB,viewZToOrthographicDepth:Jv,viewZToPerspectiveDepth:Y7,viewport:MB,viewportCoordinate:LW,viewportDepthTexture:BB,viewportLinearDepth:$ce,viewportMipTexture:PB,viewportResolution:Gue,viewportSafeUV:zhe,viewportSharedTexture:ffe,viewportSize:AB,viewportTexture:Hce,viewportUV:Vue,vogelDiskSample:Xc,wgsl:Fpe,wgslFn:Gpe,workgroupArray:lme,workgroupBarrier:ime,workgroupId:Qpe,workingToColorSpace:gW,xor:T9});const Gc=new XB;class Q0e extends qm{constructor(e,t){super(),this.renderer=e,this.nodes=t}update(e,t,n){const i=this.renderer,s=this.nodes.getBackgroundNode(e)||e.background;let a=!1;if(s===null)i._clearColor.getRGB(Gc),Gc.a=i._clearColor.a;else if(s.isColor===!0)s.getRGB(Gc),Gc.a=1,a=!0;else if(s.isNode===!0){const c=this.get(e),d=s;Gc.copy(i._clearColor);let p=c.backgroundMesh;if(p===void 0){let R=function(){s.removeEventListener("dispose",R),p.material.dispose(),p.geometry.dispose()};var l=R;const _=En(d).mul(_U).context({getUV:()=>Bq.mul(GW),getTextureLevel:()=>Pq}),v=Ch.element(3).element(3).equal(1),b=Su(1,Ch.element(1).element(1)).mul(3),E=v.select(Yr.mul(b),Yr);let T=Ch.mul(Hm.mul(En(E,0)));T=T.setZ(T.w);const M=new ds;M.name="Background.material",M.side=gr,M.depthTest=!1,M.depthWrite=!1,M.allowOverride=!1,M.fog=!1,M.lights=!1,M.vertexNode=T,M.colorNode=_,c.backgroundMeshNode=_,c.backgroundMesh=p=new ar(new Hx(1,32,32),M),p.frustumCulled=!1,p.name="Background.mesh",s.addEventListener("dispose",R)}const y=d.getCacheKey();c.backgroundCacheKey!==y&&(c.backgroundMeshNode.node=En(d).mul(_U),c.backgroundMeshNode.needsUpdate=!0,p.material.needsUpdate=!0,c.backgroundCacheKey=y),t.unshift(p,p.geometry,p.material,0,0,null,null)}else Ze("Renderer: Unsupported background configuration.",s);const o=i.xr.getEnvironmentBlendMode();if(o==="additive"?Gc.set(0,0,0,1):o==="alpha-blend"&&Gc.set(0,0,0,0),i.autoClear===!0||a===!0){const c=n.clearColorValue;c.r=Gc.r,c.g=Gc.g,c.b=Gc.b,c.a=Gc.a,(i.backend.isWebGLBackend===!0||i.alpha===!0)&&(c.r*=c.a,c.g*=c.a,c.b*=c.a),n.depthClearValue=i._clearDepth,n.stencilClearValue=i._clearStencil,n.clearColor=i.autoClearColor===!0,n.clearDepth=i.autoClearDepth===!0,n.clearStencil=i.autoClearStencil===!0}else n.clearColor=!1,n.clearDepth=!1,n.clearStencil=!1}}let J0e=0;class vU{constructor(e="",t=[],n=0,i=[]){this.name=e,this.bindings=t,this.index=n,this.bindingsReference=i,this.id=J0e++}}class eye{constructor(e,t,n,i,s,a,o,l,c,d=[]){this.vertexShader=e,this.fragmentShader=t,this.computeShader=n,this.transforms=d,this.nodeAttributes=i,this.bindings=s,this.updateNodes=a,this.updateBeforeNodes=o,this.updateAfterNodes=l,this.observer=c,this.usedTimes=0}createBindings(){const e=[];for(const t of this.bindings)if(t.bindings[0].groupNode.shared!==!0){const i=new vU(t.name,[],t.index,t.bindingsReference);e.push(i);for(const s of t.bindings)i.bindings.push(s.clone())}else e.push(t);return e}}class EG{constructor(e,t,n=null){this.isNodeAttribute=!0,this.name=e,this.type=t,this.node=n}}class tye{constructor(e,t,n){this.isNodeUniform=!0,this.name=e,this.type=t,this.node=n}get value(){return this.node.value}set value(e){this.node.value=e}get id(){return this.node.id}get groupNode(){return this.node.groupNode}}class xX{constructor(e,t,n=!1,i=null){this.isNodeVar=!0,this.name=e,this.type=t,this.readOnly=n,this.count=i}}class nye extends xX{constructor(e,t,n=null,i=null){super(e,t),this.needsInterpolation=!1,this.isNodeVarying=!0,this.interpolationType=n,this.interpolationSampling=i}}class iye{constructor(e,t,n=""){this.name=e,this.type=t,this.code=n,Object.defineProperty(this,"isNodeCode",{value:!0})}}let rye=0;class TD{constructor(e=null){this.id=rye++,this.nodesData=new WeakMap,this.parent=e}getData(e){let t=this.nodesData.get(e);return t===void 0&&this.parent!==null&&(t=this.parent.getData(e)),t}setData(e,t){this.nodesData.set(e,t)}}class sye{constructor(e,t){this.name=e,this.members=t,this.output=!1}}class Xm{constructor(e,t){this.name=e,this.value=t,this.boundary=0,this.itemSize=0,this.offset=0}setValue(e){this.value=e}getValue(){return this.value}}class aye extends Xm{constructor(e,t=0){super(e,t),this.isNumberUniform=!0,this.boundary=4,this.itemSize=1}}class oye extends Xm{constructor(e,t=new tt){super(e,t),this.isVector2Uniform=!0,this.boundary=8,this.itemSize=2}}class lye extends Xm{constructor(e,t=new ne){super(e,t),this.isVector3Uniform=!0,this.boundary=16,this.itemSize=3}}class uye extends Xm{constructor(e,t=new zn){super(e,t),this.isVector4Uniform=!0,this.boundary=16,this.itemSize=4}}class cye extends Xm{constructor(e,t=new Kt){super(e,t),this.isColorUniform=!0,this.boundary=16,this.itemSize=3}}class fye extends Xm{constructor(e,t=new K1){super(e,t),this.isMatrix2Uniform=!0,this.boundary=8,this.itemSize=4}}class dye extends Xm{constructor(e,t=new Zn){super(e,t),this.isMatrix3Uniform=!0,this.boundary=48,this.itemSize=12}}class hye extends Xm{constructor(e,t=new gn){super(e,t),this.isMatrix4Uniform=!0,this.boundary=64,this.itemSize=16}}class pye extends aye{constructor(e){super(e.name,e.value),this.nodeUniform=e}getValue(){return this.nodeUniform.value}getType(){return this.nodeUniform.type}}class mye extends oye{constructor(e){super(e.name,e.value),this.nodeUniform=e}getValue(){return this.nodeUniform.value}getType(){return this.nodeUniform.type}}class gye extends lye{constructor(e){super(e.name,e.value),this.nodeUniform=e}getValue(){return this.nodeUniform.value}getType(){return this.nodeUniform.type}}class yye extends uye{constructor(e){super(e.name,e.value),this.nodeUniform=e}getValue(){return this.nodeUniform.value}getType(){return this.nodeUniform.type}}class _ye extends cye{constructor(e){super(e.name,e.value),this.nodeUniform=e}getValue(){return this.nodeUniform.value}getType(){return this.nodeUniform.type}}class vye extends fye{constructor(e){super(e.name,e.value),this.nodeUniform=e}getValue(){return this.nodeUniform.value}getType(){return this.nodeUniform.type}}class xye extends dye{constructor(e){super(e.name,e.value),this.nodeUniform=e}getValue(){return this.nodeUniform.value}getType(){return this.nodeUniform.type}}class bye extends hye{constructor(e){super(e.name,e.value),this.nodeUniform=e}getValue(){return this.nodeUniform.value}getType(){return this.nodeUniform.type}}let Sye=0;const Tye=new WeakMap,MG=new WeakMap,Eye=new Map([[Int8Array,"int"],[Int16Array,"int"],[Int32Array,"int"],[Uint8Array,"uint"],[Uint16Array,"uint"],[Uint32Array,"uint"],[Float32Array,"float"]]),lw=r=>/e/g.test(r)?String(r).replace(/\+/g,""):(r=Number(r),r+(r%1?"":".0"));class bX{constructor(e,t,n){this.object=e,this.material=e&&e.material||null,this.geometry=e&&e.geometry||null,this.renderer=t,this.parser=n,this.scene=null,this.camera=null,this.nodes=[],this.sequentialNodes=[],this.updateNodes=[],this.updateBeforeNodes=[],this.updateAfterNodes=[],this.hashNodes={},this.observer=null,this.lightsNode=null,this.environmentNode=null,this.fogNode=null,this.clippingContext=null,this.vertexShader=null,this.fragmentShader=null,this.computeShader=null,this.flowNodes={vertex:[],fragment:[],compute:[]},this.flowCode={vertex:"",fragment:"",compute:""},this.uniforms={vertex:[],fragment:[],compute:[],index:0},this.structs={vertex:[],fragment:[],compute:[],index:0},this.types={vertex:[],fragment:[],compute:[],index:0},this.bindings={vertex:{},fragment:{},compute:{}},this.bindingsIndexes={},this.bindGroups=null,this.attributes=[],this.bufferAttributes=[],this.varyings=[],this.codes={},this.vars={},this.declarations={},this.flow={code:""},this.chaining=[],this.stack=Hw(),this.stacks=[],this.tab="	",this.currentFunctionNode=null,this.context={material:this.material},this.cache=new TD,this.globalCache=this.cache,this.flowsData=new WeakMap,this.shaderStage=null,this.buildStage=null,this.subBuildLayers=[],this.activeStacks=[],this.subBuildFn=null,this.fnCall=null,Object.defineProperty(this,"id",{value:Sye++})}isOpaque(){const e=this.material;return e.transparent===!1&&e.blending===Nl&&e.alphaToCoverage===!1}getBindGroupsCache(){let e=MG.get(this.renderer);return e===void 0&&(e=new tf,MG.set(this.renderer,e)),e}createRenderTarget(e,t,n){return new sf(e,t,n)}createCubeRenderTarget(e,t){return new iq(e,t)}includes(e){return this.nodes.includes(e)}getOutputStructName(){}_getBindGroup(e,t){const n=this.getBindGroupsCache(),i=[];let s=!0;for(const o of t)i.push(o),s=s&&o.groupNode.shared!==!0;let a;return s?(a=n.get(i),a===void 0&&(a=new vU(e,i,this.bindingsIndexes[e].group,i),n.set(i,a))):a=new vU(e,i,this.bindingsIndexes[e].group,i),a}getBindGroupArray(e,t){const n=this.bindings[t];let i=n[e];return i===void 0&&(this.bindingsIndexes[e]===void 0&&(this.bindingsIndexes[e]={binding:0,group:Object.keys(this.bindingsIndexes).length}),n[e]=i=[]),i}getBindings(){let e=this.bindGroups;if(e===null){const t={},n=this.bindings;for(const i of JO)for(const s in n[i]){const a=n[i][s];(t[s]||(t[s]=[])).push(...a)}e=[];for(const i in t){const s=t[i],a=this._getBindGroup(i,s);e.push(a)}this.bindGroups=e}return e}sortBindingGroups(){const e=this.getBindings();e.sort((t,n)=>t.bindings[0].groupNode.order-n.bindings[0].groupNode.order);for(let t=0;t<e.length;t++){const n=e[t];this.bindingsIndexes[n.name].group=t,n.index=t}}setHashNode(e,t){this.hashNodes[t]=e}addNode(e){this.nodes.includes(e)===!1&&(this.nodes.push(e),this.setHashNode(e,e.getHash(this)))}addSequentialNode(e){this.sequentialNodes.includes(e)===!1&&this.sequentialNodes.push(e)}buildUpdateNodes(){for(const e of this.nodes)e.getUpdateType()!==$n.NONE&&this.updateNodes.push(e);for(const e of this.sequentialNodes){const t=e.getUpdateBeforeType(),n=e.getUpdateAfterType();t!==$n.NONE&&this.updateBeforeNodes.push(e),n!==$n.NONE&&this.updateAfterNodes.push(e)}}get currentNode(){return this.chaining[this.chaining.length-1]}isFilteredTexture(e){return e.magFilter===ei||e.magFilter===dm||e.magFilter===jc||e.magFilter===Pa||e.minFilter===ei||e.minFilter===dm||e.minFilter===jc||e.minFilter===Pa}addChain(e){this.chaining.push(e)}removeChain(e){if(this.chaining.pop()!==e)throw new Error("NodeBuilder: Invalid node chaining!")}getMethod(e){return e}getTernary(){return null}getNodeFromHash(e){return this.hashNodes[e]}addFlow(e,t){return this.flowNodes[e].push(t),t}setContext(e){this.context=e}getContext(){return this.context}addContext(e){const t=this.getContext();return this.setContext({...this.context,...e}),t}getSharedContext(){const e={...this.context};return delete e.material,delete e.getUV,delete e.getOutput,delete e.getTextureLevel,delete e.getAO,delete e.getShadow,e}setCache(e){this.cache=e}getCache(){return this.cache}getCacheFromNode(e,t=!0){const n=this.getDataFromNode(e);return n.cache===void 0&&(n.cache=new TD(t?this.getCache():null)),n.cache}isAvailable(){return!1}getVertexIndex(){Ve("Abstract function.")}getInstanceIndex(){Ve("Abstract function.")}getDrawIndex(){Ve("Abstract function.")}getFrontFacing(){Ve("Abstract function.")}getFragCoord(){Ve("Abstract function.")}isFlipY(){return!1}increaseUsage(e){const t=this.getDataFromNode(e);return t.usageCount=t.usageCount===void 0?1:t.usageCount+1,t.usageCount}generateTexture(){Ve("Abstract function.")}generateTextureLod(){Ve("Abstract function.")}generateArrayDeclaration(e,t){return this.getType(e)+"[ "+t+" ]"}generateArray(e,t,n=null){let i=this.generateArrayDeclaration(e,t)+"( ";for(let s=0;s<t;s++){const a=n?n[s]:null;a!==null?i+=a.build(this,e):i+=this.generateConst(e),s<t-1&&(i+=", ")}return i+=" )",i}generateStruct(e,t,n=null){const i=[];for(const s of t){const{name:a,type:o}=s;n&&n[a]&&n[a].isNode?i.push(n[a].build(this,o)):i.push(this.generateConst(o))}return e+"( "+i.join(", ")+" )"}generateConst(e,t=null){if(t===null&&(e==="float"||e==="int"||e==="uint"?t=0:e==="bool"?t=!1:e==="color"?t=new Kt:e==="vec2"||e==="uvec2"||e==="ivec2"?t=new tt:e==="vec3"||e==="uvec3"||e==="ivec3"?t=new ne:(e==="vec4"||e==="uvec4"||e==="ivec4")&&(t=new zn)),e==="float")return lw(t);if(e==="int")return`${Math.round(t)}`;if(e==="uint")return t>=0?`${Math.round(t)}u`:"0u";if(e==="bool")return t?"true":"false";if(e==="color")return`${this.getType("vec3")}( ${lw(t.r)}, ${lw(t.g)}, ${lw(t.b)} )`;const n=this.getTypeLength(e),i=this.getComponentType(e),s=a=>this.generateConst(i,a);if(n===2)return`${this.getType(e)}( ${s(t.x)}, ${s(t.y)} )`;if(n===3)return`${this.getType(e)}( ${s(t.x)}, ${s(t.y)}, ${s(t.z)} )`;if(n===4&&e!=="mat2")return`${this.getType(e)}( ${s(t.x)}, ${s(t.y)}, ${s(t.z)}, ${s(t.w)} )`;if(n>=4&&t&&(t.isMatrix2||t.isMatrix3||t.isMatrix4))return`${this.getType(e)}( ${t.elements.map(s).join(", ")} )`;if(n>4)return`${this.getType(e)}()`;throw new Error(`NodeBuilder: Type '${e}' not found in generate constant attempt.`)}getType(e){return e==="color"?"vec3":e}hasGeometryAttribute(e){return this.geometry&&this.geometry.getAttribute(e)!==void 0}getAttribute(e,t){const n=this.attributes;for(const s of n)if(s.name===e)return s;const i=new EG(e,t);return this.registerDeclaration(i),n.push(i),i}getPropertyName(e){return e.name}isVector(e){return/vec\d/.test(e)}isMatrix(e){return/mat\d/.test(e)}isReference(e){return e==="void"||e==="property"||e==="sampler"||e==="samplerComparison"||e==="texture"||e==="cubeTexture"||e==="storageTexture"||e==="depthTexture"||e==="texture3D"}needsToWorkingColorSpace(){return!1}getComponentTypeFromTexture(e){const t=e.type;if(e.isDataTexture){if(t===Hs)return"int";if(t===Hi)return"uint"}return"float"}getElementType(e){return e==="mat2"?"vec2":e==="mat3"?"vec3":e==="mat4"?"vec4":this.getComponentType(e)}getComponentType(e){if(e=this.getVectorType(e),e==="float"||e==="bool"||e==="int"||e==="uint")return e;const t=/(b|i|u|)(vec|mat)([2-4])/.exec(e);return t===null?null:t[1]==="b"?"bool":t[1]==="i"?"int":t[1]==="u"?"uint":"float"}getVectorType(e){return e==="color"?"vec3":e==="texture"||e==="cubeTexture"||e==="storageTexture"||e==="texture3D"?"vec4":e}getTypeFromLength(e,t="float"){if(e===1)return t;let n=jH(e);const i=t==="float"?"":t[0];return/mat2/.test(t)===!0&&(n=n.replace("vec","mat")),i+n}getTypeFromArray(e){return Eye.get(e.constructor)}isInteger(e){return/int|uint|(i|u)vec/.test(e)}getTypeFromAttribute(e){let t=e;e.isInterleavedBufferAttribute&&(t=e.data);const n=t.array,i=e.itemSize,s=e.normalized;let a;return!(e instanceof lL)&&s!==!0&&(a=this.getTypeFromArray(n)),this.getTypeFromLength(i,a)}getTypeLength(e){const t=this.getVectorType(e),n=/vec([2-4])/.exec(t);return n!==null?Number(n[1]):t==="float"||t==="bool"||t==="int"||t==="uint"?1:/mat2/.test(e)===!0?4:/mat3/.test(e)===!0?9:/mat4/.test(e)===!0?16:0}getVectorFromMatrix(e){return e.replace("mat","vec")}changeComponentType(e,t){return this.getTypeFromLength(this.getTypeLength(e),t)}getIntegerType(e){const t=this.getComponentType(e);return t==="int"||t==="uint"?e:this.changeComponentType(e,"int")}setActiveStack(e){this.activeStacks.push(e)}removeActiveStack(e){if(this.activeStacks[this.activeStacks.length-1]===e)this.activeStacks.pop();else throw new Error("NodeBuilder: Invalid active stack removal.")}getActiveStack(){return this.activeStacks[this.activeStacks.length-1]}getBaseStack(){return this.activeStacks[0]}addStack(){this.stack=Hw(this.stack);const e=kP();return this.stacks.push(e),T1(this.stack),this.stack}removeStack(){const e=this.stack;for(const t of e.nodes){const n=this.getDataFromNode(t);n.stack=e}return this.stack=e.parent,T1(this.stacks.pop()),e}getDataFromNode(e,t=this.shaderStage,n=null){n=n===null?e.isGlobal(this)?this.globalCache:this.cache:n;let i=n.getData(e);i===void 0&&(i={},n.setData(e,i)),i[t]===void 0&&(i[t]={});let s=i[t];const a=i.any?i.any.subBuilds:null,o=this.getClosestSubBuild(a);return o&&(s.subBuildsCache===void 0&&(s.subBuildsCache={}),s=s.subBuildsCache[o]||(s.subBuildsCache[o]={}),s.subBuilds=a),s}getNodeProperties(e,t="any"){const n=this.getDataFromNode(e,t);return n.properties||(n.properties={outputNode:null})}getBufferAttributeFromNode(e,t){const n=this.getDataFromNode(e,"vertex");let i=n.bufferAttribute;if(i===void 0){const s=this.uniforms.index++;i=new EG("nodeAttribute"+s,t,e),this.bufferAttributes.push(i),n.bufferAttribute=i}return i}getStructTypeNode(e,t=this.shaderStage){return this.types[t][e]||null}getStructTypeFromNode(e,t,n=null,i=this.shaderStage){const s=this.getDataFromNode(e,i,this.globalCache);let a=s.structType;if(a===void 0){const o=this.structs.index++;n===null&&(n="StructType"+o),a=new sye(n,t),this.structs[i].push(a),this.types[i][n]=e,s.structType=a}return a}getOutputStructTypeFromNode(e,t){const n=this.getStructTypeFromNode(e,t,"OutputType","fragment");return n.output=!0,n}getUniformFromNode(e,t,n=this.shaderStage,i=null){const s=this.getDataFromNode(e,n,this.globalCache);let a=s.uniform;if(a===void 0){const o=this.uniforms.index++;a=new tye(i||"nodeUniform"+o,t,e),this.uniforms[n].push(a),this.registerDeclaration(a),s.uniform=a}return a}getVarFromNode(e,t=null,n=e.getNodeType(this),i=this.shaderStage,s=!1){const a=this.getDataFromNode(e,i),o=this.getSubBuildProperty("variable",a.subBuilds);let l=a[o];if(l===void 0){const c=s?"_const":"_var",d=this.vars[i]||(this.vars[i]=[]),p=this.vars[c]||(this.vars[c]=0);t===null&&(t=(s?"nodeConst":"nodeVar")+p,this.vars[c]++),o!=="variable"&&(t=this.getSubBuildProperty(t,a.subBuilds));const y=e.getArrayCount(this);l=new xX(t,n,s,y),s||d.push(l),this.registerDeclaration(l),a[o]=l}return l}isDeterministic(e){if(e.isMathNode)return this.isDeterministic(e.aNode)&&(e.bNode?this.isDeterministic(e.bNode):!0)&&(e.cNode?this.isDeterministic(e.cNode):!0);if(e.isOperatorNode)return this.isDeterministic(e.aNode)&&(e.bNode?this.isDeterministic(e.bNode):!0);if(e.isArrayNode){if(e.values!==null){for(const t of e.values)if(!this.isDeterministic(t))return!1}return!0}else if(e.isConstNode)return!0;return!1}getVaryingFromNode(e,t=null,n=e.getNodeType(this),i=null,s=null){const a=this.getDataFromNode(e,"any"),o=this.getSubBuildProperty("varying",a.subBuilds);let l=a[o];if(l===void 0){const c=this.varyings,d=c.length;t===null&&(t="nodeVarying"+d),o!=="varying"&&(t=this.getSubBuildProperty(t,a.subBuilds)),l=new nye(t,n,i,s),c.push(l),this.registerDeclaration(l),a[o]=l}return l}registerDeclaration(e){const t=this.shaderStage,n=this.declarations[t]||(this.declarations[t]={}),i=this.getPropertyName(e);let s=1,a=i;for(;n[a]!==void 0;)a=i+"_"+s++;s>1&&(e.name=a,Ve(`TSL: Declaration name '${i}' of '${e.type}' already in use. Renamed to '${a}'.`)),n[a]=e}getCodeFromNode(e,t,n=this.shaderStage){const i=this.getDataFromNode(e);let s=i.code;if(s===void 0){const a=this.codes[n]||(this.codes[n]=[]),o=a.length;s=new iye("nodeCode"+o,t),a.push(s),i.code=s}return s}addFlowCodeHierarchy(e,t){const{flowCodes:n,flowCodeBlock:i}=this.getDataFromNode(e);let s=!0,a=t;for(;a;){if(i.get(a)===!0){s=!1;break}a=this.getDataFromNode(a).parentNodeBlock}if(s)for(const o of n)this.addLineFlowCode(o)}addLineFlowCodeBlock(e,t,n){const i=this.getDataFromNode(e),s=i.flowCodes||(i.flowCodes=[]),a=i.flowCodeBlock||(i.flowCodeBlock=new WeakMap);s.push(t),a.set(n,!0)}addLineFlowCode(e,t=null){return e===""?this:(t!==null&&this.context.nodeBlock&&this.addLineFlowCodeBlock(t,e,this.context.nodeBlock),e=this.tab+e,/;\s*$/.test(e)||(e=e+`;
`),this.flow.code+=e,this)}addFlowCode(e){return this.flow.code+=e,this}addFlowTab(){return this.tab+="	",this}removeFlowTab(){return this.tab=this.tab.slice(0,-1),this}getFlowData(e){return this.flowsData.get(e)}flowNode(e){const t=e.getNodeType(this),n=this.flowChildNode(e,t);return this.flowsData.set(e,n),n}addInclude(e){this.currentFunctionNode!==null&&this.currentFunctionNode.includes.push(e)}buildFunctionNode(e){const t=new Xq,n=this.currentFunctionNode;return this.currentFunctionNode=t,t.code=this.buildFunctionCode(e),this.currentFunctionNode=n,t}flowShaderNode(e){const t=e.layout,n={[Symbol.iterator](){let a=0;const o=Object.values(this);return{next:()=>({value:o[a],done:a++>=o.length})}}};for(const a of t.inputs)n[a.name]=new Aq(a.type,a.name);e.layout=null;const i=e.call(n),s=this.flowStagesNode(i,t.type);return e.layout=t,s}flowBuildStage(e,t,n=null){const i=this.getBuildStage();this.setBuildStage(t);const s=e.build(this,n);return this.setBuildStage(i),s}flowStagesNode(e,t=null){const n=this.flow,i=this.vars,s=this.declarations,a=this.cache,o=this.buildStage,l=this.stack,c={code:""};this.flow=c,this.vars={},this.declarations={},this.cache=new TD,this.stack=Hw();for(const d of QO)this.setBuildStage(d),c.result=e.build(this,t);return c.vars=this.getVars(this.shaderStage),this.flow=n,this.vars=i,this.declarations=s,this.cache=a,this.stack=l,this.setBuildStage(o),c}getFunctionOperator(){return null}buildFunctionCode(){Ve("Abstract function.")}flowChildNode(e,t=null){const n=this.flow,i={code:""};return this.flow=i,i.result=e.build(this,t),this.flow=n,i}flowNodeFromShaderStage(e,t,n=null,i=null){const s=this.tab,a=this.cache,o=this.shaderStage,l=this.context;this.setShaderStage(e);const c={...this.context};delete c.nodeBlock,this.cache=this.globalCache,this.tab="	",this.context=c;let d=null;if(this.buildStage==="generate"){const p=this.flowChildNode(t,n);i!==null&&(p.code+=`${this.tab+i} = ${p.result};
`),this.flowCode[e]=this.flowCode[e]+p.code,d=p}else d=t.build(this);return this.setShaderStage(o),this.cache=a,this.tab=s,this.context=l,d}getAttributesArray(){return this.attributes.concat(this.bufferAttributes)}getAttributes(){Ve("Abstract function.")}getVaryings(){Ve("Abstract function.")}getVar(e,t,n=null){return`${n!==null?this.generateArrayDeclaration(e,n):this.getType(e)} ${t}`}getVars(e){let t="";const n=this.vars[e];if(n!==void 0)for(const i of n)t+=`${this.getVar(i.type,i.name)}; `;return t}getUniforms(){Ve("Abstract function.")}getCodes(e){const t=this.codes[e];let n="";if(t!==void 0)for(const i of t)n+=i.code+`
`;return n}getHash(){return this.vertexShader+this.fragmentShader+this.computeShader}setShaderStage(e){this.shaderStage=e}getShaderStage(){return this.shaderStage}setBuildStage(e){this.buildStage=e}getBuildStage(){return this.buildStage}buildCode(){Ve("Abstract function.")}get subBuild(){return this.subBuildLayers[this.subBuildLayers.length-1]||null}addSubBuild(e){this.subBuildLayers.push(e)}removeSubBuild(){return this.subBuildLayers.pop()}getClosestSubBuild(e){let t;if(e&&e.isNode?e.isShaderCallNodeInternal?t=e.shaderNode.subBuilds:e.isStackNode?t=[e.subBuild]:t=this.getDataFromNode(e,"any").subBuilds:e instanceof Set?t=[...e]:t=e,!t)return null;const n=this.subBuildLayers;for(let i=t.length-1;i>=0;i--){const s=t[i];if(n.includes(s))return s}return null}getSubBuildOutput(e){return this.getSubBuildProperty("outputNode",e)}getSubBuildProperty(e="",t=null){let n;t!==null?n=this.getClosestSubBuild(t):n=this.subBuildFn;let i;return n?i=e?n+"_"+e:n:i=e,i}build(){const{object:e,material:t,renderer:n}=this;if(t!==null){let i=n.library.fromMaterial(t);i===null&&(Ze(`NodeMaterial: Material "${t.type}" is not compatible.`),i=new ds),i.build(this)}else this.addFlow("compute",e);for(const i of QO){this.setBuildStage(i),this.context.vertex&&this.context.vertex.isNode&&this.flowNodeFromShaderStage("vertex",this.context.vertex);for(const s of JO){this.setShaderStage(s);const a=this.flowNodes[s];for(const o of a)i==="generate"?this.flowNode(o):o.build(this)}}return this.setBuildStage(null),this.setShaderStage(null),this.buildCode(),this.buildUpdateNodes(),this}getSharedDataFromNode(e){let t=Tye.get(e);return t===void 0&&(t={}),t}getNodeUniform(e,t){const n=this.getSharedDataFromNode(e);let i=n.cache;if(i===void 0){if(t==="float"||t==="int"||t==="uint")i=new pye(e);else if(t==="vec2"||t==="ivec2"||t==="uvec2")i=new mye(e);else if(t==="vec3"||t==="ivec3"||t==="uvec3")i=new gye(e);else if(t==="vec4"||t==="ivec4"||t==="uvec4")i=new yye(e);else if(t==="color")i=new _ye(e);else if(t==="mat2")i=new vye(e);else if(t==="mat3")i=new xye(e);else if(t==="mat4")i=new bye(e);else throw new Error(`Uniform "${t}" not implemented.`);n.cache=i}return i}format(e,t,n){if(t=this.getVectorType(t),n=this.getVectorType(n),t===n||n===null||this.isReference(n))return e;const i=this.getTypeLength(t),s=this.getTypeLength(n);return i===16&&s===9?`${this.getType(n)}( ${e}[ 0 ].xyz, ${e}[ 1 ].xyz, ${e}[ 2 ].xyz )`:i===9&&s===4?`${this.getType(n)}( ${e}[ 0 ].xy, ${e}[ 1 ].xy )`:i>4||s>4||s===0?e:i===s?`${this.getType(n)}( ${e} )`:i>s?(e=n==="bool"?`all( ${e} )`:`${e}.${"xyz".slice(0,s)}`,this.format(e,this.getTypeFromLength(s,this.getComponentType(t)),n)):s===4&&i>1?`${this.getType(n)}( ${this.format(e,t,"vec3")}, 1.0 )`:i===2?`${this.getType(n)}( ${this.format(e,t,"vec2")}, 0.0 )`:(i===1&&s>1&&t!==this.getComponentType(n)&&(e=`${this.getType(this.getComponentType(n))}( ${e} )`),`${this.getType(n)}( ${e} )`)}getSignature(){return`// Three.js r${Lm} - Node System
`}}class AG{constructor(){this.time=0,this.deltaTime=0,this.frameId=0,this.renderId=0,this.updateMap=new WeakMap,this.updateBeforeMap=new WeakMap,this.updateAfterMap=new WeakMap,this.renderer=null,this.material=null,this.camera=null,this.object=null,this.scene=null}_getMaps(e,t){let n=e.get(t);return n===void 0&&(n={renderId:0,frameId:0},e.set(t,n)),n}updateBeforeNode(e){const t=e.getUpdateBeforeType(),n=e.updateReference(this);if(t===$n.FRAME){const i=this._getMaps(this.updateBeforeMap,n);if(i.frameId!==this.frameId){const s=i.frameId;i.frameId=this.frameId,e.updateBefore(this)===!1&&(i.frameId=s)}}else if(t===$n.RENDER){const i=this._getMaps(this.updateBeforeMap,n);if(i.renderId!==this.renderId){const s=i.renderId;i.renderId=this.renderId,e.updateBefore(this)===!1&&(i.renderId=s)}}else t===$n.OBJECT&&e.updateBefore(this)}updateAfterNode(e){const t=e.getUpdateAfterType(),n=e.updateReference(this);if(t===$n.FRAME){const i=this._getMaps(this.updateAfterMap,n);i.frameId!==this.frameId&&e.updateAfter(this)!==!1&&(i.frameId=this.frameId)}else if(t===$n.RENDER){const i=this._getMaps(this.updateAfterMap,n);i.renderId!==this.renderId&&e.updateAfter(this)!==!1&&(i.renderId=this.renderId)}else t===$n.OBJECT&&e.updateAfter(this)}updateNode(e){const t=e.getUpdateType(),n=e.updateReference(this);if(t===$n.FRAME){const i=this._getMaps(this.updateMap,n);i.frameId!==this.frameId&&e.update(this)!==!1&&(i.frameId=this.frameId)}else if(t===$n.RENDER){const i=this._getMaps(this.updateMap,n);i.renderId!==this.renderId&&e.update(this)!==!1&&(i.renderId=this.renderId)}else t===$n.OBJECT&&e.update(this)}update(){this.frameId++,this.lastTime===void 0&&(this.lastTime=performance.now()),this.deltaTime=(performance.now()-this.lastTime)/1e3,this.lastTime=performance.now(),this.time+=this.deltaTime}}class uI{constructor(e,t,n=null,i="",s=!1){this.type=e,this.name=t,this.count=n,this.qualifier=i,this.isConst=s}}uI.isNodeFunctionInput=!0;class Mye extends By{static get type(){return"DirectionalLightNode"}constructor(e=null){super(e)}setupDirect(){const e=this.colorNode;return{lightDirection:iI(this.light),lightColor:e}}}const ED=new gn,uw=new gn;let iT=null;class Aye extends By{static get type(){return"RectAreaLightNode"}constructor(e=null){super(e),this.halfHeight=_n(new ne).setGroup(yn),this.halfWidth=_n(new ne).setGroup(yn),this.updateType=$n.RENDER}update(e){super.update(e);const{light:t}=this,n=e.camera.matrixWorldInverse;uw.identity(),ED.copy(t.matrixWorld),ED.premultiply(n),uw.extractRotation(ED),this.halfWidth.value.set(t.width*.5,0,0),this.halfHeight.value.set(0,t.height*.5,0),this.halfWidth.value.applyMatrix4(uw),this.halfHeight.value.applyMatrix4(uw)}setupDirectRectArea(e){let t,n;e.isAvailable("float32Filterable")?(t=Li(iT.LTC_FLOAT_1),n=Li(iT.LTC_FLOAT_2)):(t=Li(iT.LTC_HALF_1),n=Li(iT.LTC_HALF_2));const{colorNode:i,light:s}=this,a=nI(s);return{lightColor:i,lightPosition:a,halfWidth:this.halfWidth,halfHeight:this.halfHeight,ltc_1:t,ltc_2:n}}static setLTC(e){iT=e}}class cI extends By{static get type(){return"SpotLightNode"}constructor(e=null){super(e),this.coneCosNode=_n(0).setGroup(yn),this.penumbraCosNode=_n(0).setGroup(yn),this.cutoffDistanceNode=_n(0).setGroup(yn),this.decayExponentNode=_n(0).setGroup(yn),this.colorNode=_n(this.color).setGroup(yn)}update(e){super.update(e);const{light:t}=this;this.coneCosNode.value=Math.cos(t.angle),this.penumbraCosNode.value=Math.cos(t.angle*(1-t.penumbra)),this.cutoffDistanceNode.value=t.distance,this.decayExponentNode.value=t.decay}getSpotAttenuation(e,t){const{coneCosNode:n,penumbraCosNode:i}=this;return ef(n,i,t)}getLightCoord(e){const t=e.getNodeProperties(this);let n=t.projectionUV;return n===void 0&&(n=Zq(this.light,e.context.positionWorld),t.projectionUV=n),n}setupDirect(e){const{colorNode:t,cutoffDistanceNode:n,decayExponentNode:i,light:s}=this,a=this.getLightVector(e),o=a.normalize(),l=o.dot(iI(s)),c=this.getSpotAttenuation(e,l),d=a.length(),p=aI({lightDistance:d,cutoffDistance:n,decayExponent:i});let y=t.mul(c).mul(p),_,v;return s.colorNode?(v=this.getLightCoord(e),_=s.colorNode(v)):s.map&&(v=this.getLightCoord(e),_=Li(s.map,v.xy).onRenderUpdate(()=>s.map)),_&&(y=v.mul(2).sub(1).abs().lessThan(1).all().select(y.mul(_),y)),{lightColor:y,lightDirection:o}}}class wye extends cI{static get type(){return"IESSpotLightNode"}getSpotAttenuation(e,t){const n=this.light.iesMap;let i=null;if(n&&n.isTexture===!0){const s=t.acos().mul(1/Math.PI);i=Li(n,St(s,0),0).r}else i=super.getSpotAttenuation(t);return i}}const Rye=Te(([r,e])=>{const t=r.abs().sub(e);return ud(Kr(t,0)).add(zl(Kr(t.x,t.y),0))});class Cye extends cI{static get type(){return"ProjectorLightNode"}update(e){super.update(e);const t=this.light;if(this.penumbraCosNode.value=Math.min(Math.cos(t.angle*(1-t.penumbra)),.99999),t.aspect===null){let n=1;t.map!==null&&(n=t.map.width/t.map.height),t.shadow.aspect=n}else t.shadow.aspect=t.aspect}getSpotAttenuation(e){const t=re(0),n=this.penumbraCosNode,i=DN(this.light).mul(e.context.positionWorld||cd);return Tn(i.w.greaterThan(0),()=>{const s=i.xyz.div(i.w),a=Rye(s.xy.sub(St(.5)),St(.5)),o=Su(-1,_i(1,rB(n)).sub(1));t.assign(hN(a.mul(-2).mul(o)))}),t}}class Nye extends By{static get type(){return"AmbientLightNode"}constructor(e=null){super(e)}setup({context:e}){e.irradiance.addAssign(this.colorNode)}}class Dye extends By{static get type(){return"HemisphereLightNode"}constructor(e=null){super(e),this.lightPositionNode=tI(e),this.lightDirectionNode=this.lightPositionNode.normalize(),this.groundColorNode=_n(new Kt).setGroup(yn)}update(e){const{light:t}=this;super.update(e),this.lightPositionNode.object3d=t,this.groundColorNode.value.copy(t.groundColor).multiplyScalar(t.intensity)}setup(e){const{colorNode:t,groundColorNode:n,lightDirectionNode:i}=this,a=Wm.dot(i).mul(.5).add(.5),o=yi(n,t,a);e.context.irradiance.addAssign(o)}}class Oye extends By{static get type(){return"LightProbeNode"}constructor(e=null){super(e);const t=[];for(let n=0;n<9;n++)t.push(new ne);this.lightProbe=fo(t)}update(e){const{light:t}=this;super.update(e);for(let n=0;n<9;n++)this.lightProbe.array[n].copy(t.sh.coefficients[n]).multiplyScalar(t.intensity)}setup(e){const t=vX(Wm,this.lightProbe);e.context.irradiance.addAssign(t)}}class SX{parseFunction(){Ve("Abstract function.")}}class fI{constructor(e,t,n="",i=""){this.type=e,this.inputs=t,this.name=n,this.precision=i}getCode(){Ve("Abstract function.")}}fI.isNodeFunction=!0;const Uye=/^\s*(highp|mediump|lowp)?\s*([a-z_0-9]+)\s*([a-z_0-9]+)?\s*\(([\s\S]*?)\)/i,Lye=/[a-z_0-9]+/ig,wG="#pragma main",Pye=r=>{r=r.trim();const e=r.indexOf(wG),t=e!==-1?r.slice(e+wG.length):r,n=t.match(Uye);if(n!==null&&n.length===5){const i=n[4],s=[];let a=null;for(;(a=Lye.exec(i))!==null;)s.push(a);const o=[];let l=0;for(;l<s.length;){const v=s[l][0]==="const";v===!0&&l++;let b=s[l][0];b==="in"||b==="out"||b==="inout"?l++:b="";const E=s[l++][0];let T=Number.parseInt(s[l][0]);Number.isNaN(T)===!1?l++:T=null;const M=s[l++][0];o.push(new uI(E,M,T,b,v))}const c=t.substring(n[0].length),d=n[3]!==void 0?n[3]:"",p=n[2],y=n[1]!==void 0?n[1]:"",_=e!==-1?r.slice(0,e):"";return{type:p,inputs:o,name:d,precision:y,inputsCode:i,blockCode:c,headerCode:_}}else throw new Error("FunctionNode: Function is not a GLSL code.")};class Bye extends fI{constructor(e){const{type:t,inputs:n,name:i,precision:s,inputsCode:a,blockCode:o,headerCode:l}=Pye(e);super(t,n,i,s),this.inputsCode=a,this.blockCode=o,this.headerCode=l}getCode(e=this.name){let t;const n=this.blockCode;if(n!==""){const{type:i,inputsCode:s,headerCode:a,precision:o}=this;let l=`${i} ${e} ( ${s.trim()} )`;o!==""&&(l=`${o} ${l}`),t=a+l+n}else t="";return t}}class Iye extends SX{parseFunction(e){return new Bye(e)}}const RG=new WeakMap,jf=[],qp=[];class Fye extends qm{constructor(e,t){super(),this.renderer=e,this.backend=t,this.nodeFrame=new AG,this.nodeBuilderCache=new Map,this.callHashCache=new tf,this.groupsData=new tf,this.cacheLib={}}updateGroup(e){const t=e.groupNode,n=t.name;if(n===QP.name)return!0;if(n===yn.name){const s=this.get(e),a=this.nodeFrame.renderId;return s.renderId!==a?(s.renderId=a,!0):!1}if(n===d9.name){const s=this.get(e),a=this.nodeFrame.frameId;return s.frameId!==a?(s.frameId=a,!0):!1}jf[0]=t,jf[1]=e;let i=this.groupsData.get(jf);return i===void 0&&this.groupsData.set(jf,i={}),jf.length=0,i.version!==t.version?(i.version=t.version,!0):!1}getForRenderCacheKey(e){return e.initialCacheKey}getForRender(e){const t=this.get(e);let n=t.nodeBuilderState;if(n===void 0){const{nodeBuilderCache:i}=this,s=this.getForRenderCacheKey(e);if(n=i.get(s),n===void 0){const a=l=>{const c=this.backend.createNodeBuilder(e.object,this.renderer);return c.scene=e.scene,c.material=l,c.camera=e.camera,c.context.material=l,c.lightsNode=e.lightsNode,c.environmentNode=this.getEnvironmentNode(e.scene),c.fogNode=this.getFogNode(e.scene),c.clippingContext=e.clippingContext,this.renderer.getOutputRenderTarget()&&this.renderer.getOutputRenderTarget().multiview&&c.enableMultiview(),c};let o=a(e.material);try{o.build()}catch(l){o=a(new ds),o.build(),Ze("TSL: "+l)}n=this._createNodeBuilderState(o),i.set(s,n)}n.usedTimes++,t.nodeBuilderState=n}return n}delete(e){if(e.isRenderObject){const t=this.get(e).nodeBuilderState;t.usedTimes--,t.usedTimes===0&&this.nodeBuilderCache.delete(this.getForRenderCacheKey(e))}return super.delete(e)}getForCompute(e){const t=this.get(e);let n=t.nodeBuilderState;if(n===void 0){const i=this.backend.createNodeBuilder(e,this.renderer);i.build(),n=this._createNodeBuilderState(i),t.nodeBuilderState=n}return n}_createNodeBuilderState(e){return new eye(e.vertexShader,e.fragmentShader,e.computeShader,e.getAttributesArray(),e.getBindings(),e.updateNodes,e.updateBeforeNodes,e.updateAfterNodes,e.observer,e.transforms)}getEnvironmentNode(e){this.updateEnvironment(e);let t=null;if(e.environmentNode&&e.environmentNode.isNode)t=e.environmentNode;else{const n=this.get(e);n.environmentNode&&(t=n.environmentNode)}return t}getBackgroundNode(e){this.updateBackground(e);let t=null;if(e.backgroundNode&&e.backgroundNode.isNode)t=e.backgroundNode;else{const n=this.get(e);n.backgroundNode&&(t=n.backgroundNode)}return t}getFogNode(e){return this.updateFog(e),e.fogNode||this.get(e).fogNode||null}getCacheKey(e,t){jf[0]=e,jf[1]=t;const n=this.renderer.info.calls,i=this.callHashCache.get(jf)||{};if(i.callId!==n){const s=this.getEnvironmentNode(e),a=this.getFogNode(e);t&&qp.push(t.getCacheKey(!0)),s&&qp.push(s.getCacheKey()),a&&qp.push(a.getCacheKey()),qp.push(this.renderer.getOutputRenderTarget()&&this.renderer.getOutputRenderTarget().multiview?1:0),qp.push(this.renderer.shadowMap.enabled?1:0),qp.push(this.renderer.shadowMap.type),i.callId=n,i.cacheKey=Xx(qp),this.callHashCache.set(jf,i),qp.length=0}return jf.length=0,i.cacheKey}get isToneMappingState(){return!this.renderer.getRenderTarget()}updateBackground(e){const t=this.get(e),n=e.background;if(n){const i=e.backgroundBlurriness===0&&t.backgroundBlurriness>0||e.backgroundBlurriness>0&&t.backgroundBlurriness===0;if(t.background!==n||i){const s=this.getCacheNode("background",n,()=>{if(n.isCubeTexture===!0||n.mapping===Lh||n.mapping===ym||n.mapping===Ph){if(e.backgroundBlurriness>0||n.mapping===Ph)return qB(n);{let a;return n.isCubeTexture===!0?a=il(n):a=Li(n),sq(a)}}else{if(n.isTexture===!0)return Li(n,Rh.flipY()).setUpdateMatrix(!0);n.isColor!==!0&&Ze("WebGPUNodes: Unsupported background configuration.",n)}},i);t.backgroundNode=s,t.background=n,t.backgroundBlurriness=e.backgroundBlurriness}}else t.backgroundNode&&(delete t.backgroundNode,delete t.background)}getCacheNode(e,t,n,i=!1){const s=this.cacheLib[e]||(this.cacheLib[e]=new WeakMap);let a=s.get(t);return(a===void 0||i)&&(a=n(),s.set(t,a)),a}updateFog(e){const t=this.get(e),n=e.fog;if(n){if(t.fog!==n){const i=this.getCacheNode("fog",n,()=>{if(n.isFogExp2){const s=fr("color","color",n).setGroup(yn),a=fr("density","float",n).setGroup(yn);return R1(s,JB(a))}else if(n.isFog){const s=fr("color","color",n).setGroup(yn),a=fr("near","float",n).setGroup(yn),o=fr("far","float",n).setGroup(yn);return R1(s,QB(a,o))}else Ze("Renderer: Unsupported fog configuration.",n)});t.fogNode=i,t.fog=n}}else delete t.fogNode,delete t.fog}updateEnvironment(e){const t=this.get(e),n=e.environment;if(n){if(t.environment!==n){const i=this.getCacheNode("environment",n,()=>{if(n.isCubeTexture===!0)return il(n);if(n.isTexture===!0)return Li(n);Ze("Nodes: Unsupported environment configuration.",n)});t.environmentNode=i,t.environment=n}}else t.environmentNode&&(delete t.environmentNode,delete t.environment)}getNodeFrame(e=this.renderer,t=null,n=null,i=null,s=null){const a=this.nodeFrame;return a.renderer=e,a.scene=t,a.object=n,a.camera=i,a.material=s,a}getNodeFrameForRender(e){return this.getNodeFrame(e.renderer,e.scene,e.object,e.camera,e.material)}getOutputCacheKey(){const e=this.renderer;return e.toneMapping+","+e.currentColorSpace+","+e.xr.isPresenting}hasOutputChange(e){return RG.get(e)!==this.getOutputCacheKey()}getOutputNode(e){const t=this.renderer,n=this.getOutputCacheKey(),i=e.isArrayTexture?RN(e,ge(Rh,Yh("gl_ViewID_OVR"))).renderOutput(t.toneMapping,t.currentColorSpace):Li(e,Rh).renderOutput(t.toneMapping,t.currentColorSpace);return RG.set(e,n),i}updateBefore(e){const t=e.getNodeBuilderState();for(const n of t.updateBeforeNodes)this.getNodeFrameForRender(e).updateBeforeNode(n)}updateAfter(e){const t=e.getNodeBuilderState();for(const n of t.updateAfterNodes)this.getNodeFrameForRender(e).updateAfterNode(n)}updateForCompute(e){const t=this.getNodeFrame(),n=this.getForCompute(e);for(const i of n.updateNodes)t.updateNode(i)}updateForRender(e){const t=this.getNodeFrameForRender(e),n=e.getNodeBuilderState();for(const i of n.updateNodes)t.updateNode(i)}needsRefresh(e){const t=this.getNodeFrameForRender(e);return e.getMonitor().needsRefresh(e,t)}dispose(){super.dispose(),this.nodeFrame=new AG,this.nodeBuilderCache=new Map,this.cacheLib={}}}const MD=new Hc;class FR{constructor(e=null){this.version=0,this.clipIntersection=null,this.cacheKey="",this.shadowPass=!1,this.viewNormalMatrix=new Zn,this.clippingGroupContexts=new WeakMap,this.intersectionPlanes=[],this.unionPlanes=[],this.parentVersion=null,e!==null&&(this.viewNormalMatrix=e.viewNormalMatrix,this.clippingGroupContexts=e.clippingGroupContexts,this.shadowPass=e.shadowPass,this.viewMatrix=e.viewMatrix)}projectPlanes(e,t,n){const i=e.length;for(let s=0;s<i;s++){MD.copy(e[s]).applyMatrix4(this.viewMatrix,this.viewNormalMatrix);const a=t[n+s],o=MD.normal;a.x=-o.x,a.y=-o.y,a.z=-o.z,a.w=MD.constant}}updateGlobal(e,t){this.shadowPass=e.overrideMaterial!==null&&e.overrideMaterial.isShadowPassMaterial,this.viewMatrix=t.matrixWorldInverse,this.viewNormalMatrix.getNormalMatrix(this.viewMatrix)}update(e,t){let n=!1;e.version!==this.parentVersion&&(this.intersectionPlanes=Array.from(e.intersectionPlanes),this.unionPlanes=Array.from(e.unionPlanes),this.parentVersion=e.version),this.clipIntersection!==t.clipIntersection&&(this.clipIntersection=t.clipIntersection,this.clipIntersection?this.unionPlanes.length=e.unionPlanes.length:this.intersectionPlanes.length=e.intersectionPlanes.length);const i=t.clippingPlanes,s=i.length;let a,o;if(this.clipIntersection?(a=this.intersectionPlanes,o=e.intersectionPlanes.length):(a=this.unionPlanes,o=e.unionPlanes.length),a.length!==o+s){a.length=o+s;for(let l=0;l<s;l++)a[o+l]=new zn;n=!0}this.projectPlanes(i,a,o),n&&(this.version++,this.cacheKey=`${this.intersectionPlanes.length}:${this.unionPlanes.length}`)}getGroupContext(e){if(this.shadowPass&&!e.clipShadows)return this;let t=this.clippingGroupContexts.get(e);return t===void 0&&(t=new FR(this),this.clippingGroupContexts.set(e,t)),t.update(this,e),t}get unionClippingCount(){return this.unionPlanes.length}}class zye{constructor(e,t){this.bundleGroup=e,this.camera=t}}const rT=[];class Vye{constructor(){this.bundles=new tf}get(e,t){const n=this.bundles;rT[0]=e,rT[1]=t;let i=n.get(rT);return i===void 0&&(i=new zye(e,t),n.set(rT,i)),rT.length=0,i}dispose(){this.bundles=new tf}}class TX{constructor(){this.lightNodes=new WeakMap,this.materialNodes=new Map,this.toneMappingNodes=new Map}fromMaterial(e){if(e.isNodeMaterial)return e;let t=null;const n=this.getMaterialNodeClass(e.type);if(n!==null){t=new n;for(const i in e)t[i]=e[i]}return t}addToneMapping(e,t){this.addType(e,t,this.toneMappingNodes)}getToneMappingFunction(e){return this.toneMappingNodes.get(e)||null}getMaterialNodeClass(e){return this.materialNodes.get(e)||null}addMaterial(e,t){this.addType(e,t,this.materialNodes)}getLightNodeClass(e){return this.lightNodes.get(e)||null}addLight(e,t){this.addClass(e,t,this.lightNodes)}addType(e,t,n){if(n.has(t)){Ve(`Redefinition of node ${t}`);return}if(typeof e!="function")throw new Error(`Node class ${e.name} is not a class.`);if(typeof t=="function"||typeof t=="object")throw new Error(`Base class ${t} is not a class.`);n.set(t,e)}addClass(e,t,n){if(n.has(t)){Ve(`Redefinition of node ${t.name}`);return}if(typeof e!="function")throw new Error(`Node class ${e.name} is not a class.`);if(typeof t!="function")throw new Error(`Base class ${t.name} is not a class.`);n.set(t,e)}}const Gye=new rI,sT=[];class kye extends tf{constructor(){super()}createNode(e=[]){return new rI().setLights(e)}getNode(e,t){if(e.isQuadMesh)return Gye;sT[0]=e,sT[1]=t;let n=this.get(sT);return n===void 0&&(n=this.createNode(),this.set(sT,n)),sT.length=0,n}}class TT extends sf{constructor(e=1,t=1,n={}){super(e,t,n),this.isXRRenderTarget=!0,this._hasExternalTextures=!1,this._autoAllocateDepthBuffer=!0,this._isOpaqueFramebuffer=!1}copy(e){return super.copy(e),this._hasExternalTextures=e._hasExternalTextures,this._autoAllocateDepthBuffer=e._autoAllocateDepthBuffer,this._isOpaqueFramebuffer=e._isOpaqueFramebuffer,this}}const CG=new ne,NG=new ne;class Hye extends Gl{constructor(e,t=!1){super(),this.enabled=!1,this.isPresenting=!1,this.cameraAutoUpdate=!0,this._renderer=e,this._cameraL=new Br,this._cameraL.viewport=new zn,this._cameraR=new Br,this._cameraR.viewport=new zn,this._cameras=[this._cameraL,this._cameraR],this._cameraXR=new HL,this._currentDepthNear=null,this._currentDepthFar=null,this._controllers=[],this._controllerInputSources=[],this._xrRenderTarget=null,this._layers=[],this._sessionUsesLayers=!1,this._supportsGlBinding=typeof XRWebGLBinding<"u",this._frameBufferTargets=null,this._createXRLayer=Yye.bind(this),this._gl=null,this._currentAnimationContext=null,this._currentAnimationLoop=null,this._currentPixelRatio=null,this._currentSize=new tt,this._onSessionEvent=Xye.bind(this),this._onSessionEnd=$ye.bind(this),this._onInputSourcesChange=jye.bind(this),this._onAnimationFrame=Zye.bind(this),this._referenceSpace=null,this._referenceSpaceType="local-floor",this._customReferenceSpace=null,this._framebufferScaleFactor=1,this._foveation=1,this._session=null,this._glBaseLayer=null,this._glBinding=null,this._glProjLayer=null,this._xrFrame=null,this._supportsLayers=this._supportsGlBinding&&"createProjectionLayer"in XRWebGLBinding.prototype,this._useMultiviewIfPossible=t,this._useMultiview=!1}getController(e){return this._getController(e).getTargetRaySpace()}getControllerGrip(e){return this._getController(e).getGripSpace()}getHand(e){return this._getController(e).getHandSpace()}getFoveation(){if(!(this._glProjLayer===null&&this._glBaseLayer===null))return this._foveation}setFoveation(e){this._foveation=e,this._glProjLayer!==null&&(this._glProjLayer.fixedFoveation=e),this._glBaseLayer!==null&&this._glBaseLayer.fixedFoveation!==void 0&&(this._glBaseLayer.fixedFoveation=e)}getFramebufferScaleFactor(){return this._framebufferScaleFactor}setFramebufferScaleFactor(e){this._framebufferScaleFactor=e,this.isPresenting===!0&&Ve("XRManager: Cannot change framebuffer scale while presenting.")}getReferenceSpaceType(){return this._referenceSpaceType}setReferenceSpaceType(e){this._referenceSpaceType=e,this.isPresenting===!0&&Ve("XRManager: Cannot change reference space type while presenting.")}getReferenceSpace(){return this._customReferenceSpace||this._referenceSpace}setReferenceSpace(e){this._customReferenceSpace=e}getCamera(){return this._cameraXR}getEnvironmentBlendMode(){if(this._session!==null)return this._session.environmentBlendMode}getBinding(){return this._glBinding===null&&this._supportsGlBinding&&(this._glBinding=new XRWebGLBinding(this._session,this._gl)),this._glBinding}getFrame(){return this._xrFrame}useMultiview(){return this._useMultiview}createQuadLayer(e,t,n,i,s,a,o,l={}){const c=new $h(e,t),d=new TT(s,a,{format:Qi,type:ir,depthTexture:new Ga(s,a,l.stencil?Dl:Hi,void 0,void 0,void 0,void 0,void 0,void 0,l.stencil?ho:ba),stencilBuffer:l.stencil,resolveDepthBuffer:!1,resolveStencilBuffer:!1});d._autoAllocateDepthBuffer=!0;const p=new lo({color:16777215,side:Cl});p.map=d.texture,p.map.offset.y=1,p.map.repeat.y=-1;const y=new ar(c,p);y.position.copy(n),y.quaternion.copy(i);const _={type:"quad",width:e,height:t,translation:n,quaternion:i,pixelwidth:s,pixelheight:a,plane:y,material:p,rendercall:o,renderTarget:d};if(this._layers.push(_),this._session!==null){_.plane.material=new lo({color:16777215,side:Cl}),_.plane.material.blending=A0,_.plane.material.blendEquation=La,_.plane.material.blendSrc=Qf,_.plane.material.blendDst=Qf,_.xrlayer=this._createXRLayer(_);const v=this._session.renderState.layers;v.unshift(_.xrlayer),this._session.updateRenderState({layers:v})}else d.isXRRenderTarget=!1;return y}createCylinderLayer(e,t,n,i,s,a,o,l,c={}){const d=new kx(e,e,e*t/n,64,64,!0,Math.PI-t/2,t),p=new TT(a,o,{format:Qi,type:ir,depthTexture:new Ga(a,o,c.stencil?Dl:Hi,void 0,void 0,void 0,void 0,void 0,void 0,c.stencil?ho:ba),stencilBuffer:c.stencil,resolveDepthBuffer:!1,resolveStencilBuffer:!1});p._autoAllocateDepthBuffer=!0;const y=new lo({color:16777215,side:gr});y.map=p.texture,y.map.offset.y=1,y.map.repeat.y=-1;const _=new ar(d,y);_.position.copy(i),_.quaternion.copy(s);const v={type:"cylinder",radius:e,centralAngle:t,aspectratio:n,translation:i,quaternion:s,pixelwidth:a,pixelheight:o,plane:_,material:y,rendercall:l,renderTarget:p};if(this._layers.push(v),this._session!==null){v.plane.material=new lo({color:16777215,side:gr}),v.plane.material.blending=A0,v.plane.material.blendEquation=La,v.plane.material.blendSrc=Qf,v.plane.material.blendDst=Qf,v.xrlayer=this._createXRLayer(v);const b=this._session.renderState.layers;b.unshift(v.xrlayer),this._session.updateRenderState({layers:b})}else p.isXRRenderTarget=!1;return _}renderLayers(){const e=new ne,t=new Va,n=this._renderer,i=this.isPresenting,s=n.getOutputRenderTarget(),a=n._frameBufferTarget;this.isPresenting=!1;const o=new tt;n.getSize(o);const l=n._quad;for(const c of this._layers)if(c.renderTarget.isXRRenderTarget=this._session!==null,c.renderTarget._hasExternalTextures=c.renderTarget.isXRRenderTarget,c.renderTarget.isXRRenderTarget&&this._sessionUsesLayers){c.xrlayer.transform=new XRRigidTransform(c.plane.getWorldPosition(e),c.plane.getWorldQuaternion(t));const d=this._glBinding.getSubImage(c.xrlayer,this._xrFrame);n.backend.setXRRenderTargetTextures(c.renderTarget,d.colorTexture,void 0),n._setXRLayerSize(c.renderTarget.width,c.renderTarget.height),n.setOutputRenderTarget(c.renderTarget),n.setRenderTarget(null),n._frameBufferTarget=null,this._frameBufferTargets||(this._frameBufferTargets=new WeakMap);const{frameBufferTarget:p,quad:y}=this._frameBufferTargets.get(c.renderTarget)||{frameBufferTarget:null,quad:null};p?(n._frameBufferTarget=p,n._quad=y):(n._quad=new AN(new ds),this._frameBufferTargets.set(c.renderTarget,{frameBufferTarget:n._getFrameBufferTarget(),quad:n._quad})),c.rendercall(),n._frameBufferTarget=null}else n.setRenderTarget(c.renderTarget),c.rendercall();n.setRenderTarget(null),n.setOutputRenderTarget(s),n._frameBufferTarget=a,n._setXRLayerSize(o.x,o.y),n._quad=l,this.isPresenting=i}getSession(){return this._session}async setSession(e){const t=this._renderer,n=t.backend;this._gl=t.getContext();const i=this._gl,s=i.getContextAttributes();if(this._session=e,e!==null){if(n.isWebGPUBackend===!0)throw new Error('THREE.XRManager: XR is currently not supported with a WebGPU backend. Use WebGL by passing "{ forceWebGL: true }" to the constructor of the renderer.');if(e.addEventListener("select",this._onSessionEvent),e.addEventListener("selectstart",this._onSessionEvent),e.addEventListener("selectend",this._onSessionEvent),e.addEventListener("squeeze",this._onSessionEvent),e.addEventListener("squeezestart",this._onSessionEvent),e.addEventListener("squeezeend",this._onSessionEvent),e.addEventListener("end",this._onSessionEnd),e.addEventListener("inputsourceschange",this._onInputSourcesChange),await n.makeXRCompatible(),this._currentPixelRatio=t.getPixelRatio(),t.getSize(this._currentSize),this._currentAnimationContext=t._animation.getContext(),this._currentAnimationLoop=t._animation.getAnimationLoop(),t._animation.stop(),this._supportsLayers===!0){let a=null,o=null,l=null;t.depth&&(l=t.stencil?i.DEPTH24_STENCIL8:i.DEPTH_COMPONENT24,a=t.stencil?ho:ba,o=t.stencil?Dl:Hi);const c={colorFormat:i.RGBA8,depthFormat:l,scaleFactor:this._framebufferScaleFactor,clearOnAccess:!1};this._useMultiviewIfPossible&&t.hasFeature("OVR_multiview2")&&(c.textureType="texture-array",this._useMultiview=!0),this._glBinding=this.getBinding();const d=this._glBinding.createProjectionLayer(c),p=[d];this._glProjLayer=d,t.setPixelRatio(1),t._setXRLayerSize(d.textureWidth,d.textureHeight);const y=this._useMultiview?2:1,_=new Ga(d.textureWidth,d.textureHeight,o,void 0,void 0,void 0,void 0,void 0,void 0,a,y);if(this._xrRenderTarget=new TT(d.textureWidth,d.textureHeight,{format:Qi,type:ir,colorSpace:t.outputColorSpace,depthTexture:_,stencilBuffer:t.stencil,samples:s.antialias?4:0,resolveDepthBuffer:d.ignoreDepthValues===!1,resolveStencilBuffer:d.ignoreDepthValues===!1,depth:this._useMultiview?2:1,multiview:this._useMultiview}),this._xrRenderTarget._hasExternalTextures=!0,this._xrRenderTarget.depth=this._useMultiview?2:1,this._sessionUsesLayers=e.enabledFeatures.includes("layers"),this._referenceSpace=await e.requestReferenceSpace(this.getReferenceSpaceType()),this._sessionUsesLayers)for(const v of this._layers)v.plane.material=new lo({color:16777215,side:v.type==="cylinder"?gr:Cl}),v.plane.material.blending=A0,v.plane.material.blendEquation=La,v.plane.material.blendSrc=Qf,v.plane.material.blendDst=Qf,v.xrlayer=this._createXRLayer(v),p.unshift(v.xrlayer);e.updateRenderState({layers:p})}else{const a={antialias:t.currentSamples>0,alpha:!0,depth:t.depth,stencil:t.stencil,framebufferScaleFactor:this.getFramebufferScaleFactor()},o=new XRWebGLLayer(e,i,a);this._glBaseLayer=o,e.updateRenderState({baseLayer:o}),t.setPixelRatio(1),t._setXRLayerSize(o.framebufferWidth,o.framebufferHeight),this._xrRenderTarget=new TT(o.framebufferWidth,o.framebufferHeight,{format:Qi,type:ir,colorSpace:t.outputColorSpace,stencilBuffer:t.stencil,resolveDepthBuffer:o.ignoreDepthValues===!1,resolveStencilBuffer:o.ignoreDepthValues===!1}),this._xrRenderTarget._isOpaqueFramebuffer=!0,this._referenceSpace=await e.requestReferenceSpace(this.getReferenceSpaceType())}this.setFoveation(this.getFoveation()),t._animation.setAnimationLoop(this._onAnimationFrame),t._animation.setContext(e),t._animation.start(),this.isPresenting=!0,this.dispatchEvent({type:"sessionstart"})}}updateCamera(e){const t=this._session;if(t===null)return;const n=e.near,i=e.far,s=this._cameraXR,a=this._cameraL,o=this._cameraR;s.near=o.near=a.near=n,s.far=o.far=a.far=i,s.isMultiViewCamera=this._useMultiview,(this._currentDepthNear!==s.near||this._currentDepthFar!==s.far)&&(t.updateRenderState({depthNear:s.near,depthFar:s.far}),this._currentDepthNear=s.near,this._currentDepthFar=s.far),s.layers.mask=e.layers.mask|6,a.layers.mask=s.layers.mask&3,o.layers.mask=s.layers.mask&5;const l=e.parent,c=s.cameras;DG(s,l);for(let d=0;d<c.length;d++)DG(c[d],l);c.length===2?Wye(s,a,o):s.projectionMatrix.copy(a.projectionMatrix),qye(e,s,l)}_getController(e){let t=this._controllers[e];return t===void 0&&(t=new wT,this._controllers[e]=t),t}}function Wye(r,e,t){CG.setFromMatrixPosition(e.matrixWorld),NG.setFromMatrixPosition(t.matrixWorld);const n=CG.distanceTo(NG),i=e.projectionMatrix.elements,s=t.projectionMatrix.elements,a=i[14]/(i[10]-1),o=i[14]/(i[10]+1),l=(i[9]+1)/i[5],c=(i[9]-1)/i[5],d=(i[8]-1)/i[0],p=(s[8]+1)/s[0],y=a*d,_=a*p,v=n/(-d+p),b=v*-d;if(e.matrixWorld.decompose(r.position,r.quaternion,r.scale),r.translateX(b),r.translateZ(v),r.matrixWorld.compose(r.position,r.quaternion,r.scale),r.matrixWorldInverse.copy(r.matrixWorld).invert(),i[10]===-1)r.projectionMatrix.copy(e.projectionMatrix),r.projectionMatrixInverse.copy(e.projectionMatrixInverse);else{const E=a+v,T=o+v,M=y-b,R=_+(n-b),N=l*o/T*E,P=c*o/T*E;r.projectionMatrix.makePerspective(M,R,N,P,E,T),r.projectionMatrixInverse.copy(r.projectionMatrix).invert()}}function DG(r,e){e===null?r.matrixWorld.copy(r.matrix):r.matrixWorld.multiplyMatrices(e.matrixWorld,r.matrix),r.matrixWorldInverse.copy(r.matrixWorld).invert()}function qye(r,e,t){t===null?r.matrix.copy(e.matrixWorld):(r.matrix.copy(t.matrixWorld),r.matrix.invert(),r.matrix.multiply(e.matrixWorld)),r.matrix.decompose(r.position,r.quaternion,r.scale),r.updateMatrixWorld(!0),r.projectionMatrix.copy(e.projectionMatrix),r.projectionMatrixInverse.copy(e.projectionMatrixInverse),r.isPerspectiveCamera&&(r.fov=py*2*Math.atan(1/r.projectionMatrix.elements[5]),r.zoom=1)}function Xye(r){const e=this._controllerInputSources.indexOf(r.inputSource);if(e===-1)return;const t=this._controllers[e];if(t!==void 0){const n=this.getReferenceSpace();t.update(r.inputSource,r.frame,n),t.dispatchEvent({type:r.type,data:r.inputSource})}}function $ye(){const r=this._session,e=this._renderer;r.removeEventListener("select",this._onSessionEvent),r.removeEventListener("selectstart",this._onSessionEvent),r.removeEventListener("selectend",this._onSessionEvent),r.removeEventListener("squeeze",this._onSessionEvent),r.removeEventListener("squeezestart",this._onSessionEvent),r.removeEventListener("squeezeend",this._onSessionEvent),r.removeEventListener("end",this._onSessionEnd),r.removeEventListener("inputsourceschange",this._onInputSourcesChange);for(let t=0;t<this._controllers.length;t++){const n=this._controllerInputSources[t];n!==null&&(this._controllerInputSources[t]=null,this._controllers[t].disconnect(n))}if(this._currentDepthNear=null,this._currentDepthFar=null,e._resetXRState(),this._session=null,this._xrRenderTarget=null,this._glBinding=null,this._glBaseLayer=null,this._glProjLayer=null,this._sessionUsesLayers===!0)for(const t of this._layers)t.renderTarget=new TT(t.pixelwidth,t.pixelheight,{format:Qi,type:ir,depthTexture:new Ga(t.pixelwidth,t.pixelheight,t.stencilBuffer?Dl:Hi,void 0,void 0,void 0,void 0,void 0,void 0,t.stencilBuffer?ho:ba),stencilBuffer:t.stencilBuffer,resolveDepthBuffer:!1,resolveStencilBuffer:!1}),t.renderTarget.isXRRenderTarget=!1,t.plane.material=t.material,t.material.map=t.renderTarget.texture,t.material.map.offset.y=1,t.material.map.repeat.y=-1,delete t.xrlayer;this.isPresenting=!1,this._useMultiview=!1,e._animation.stop(),e._animation.setAnimationLoop(this._currentAnimationLoop),e._animation.setContext(this._currentAnimationContext),e._animation.start(),e.setPixelRatio(this._currentPixelRatio),e.setSize(this._currentSize.width,this._currentSize.height,!1),this.dispatchEvent({type:"sessionend"})}function jye(r){const e=this._controllers,t=this._controllerInputSources;for(let n=0;n<r.removed.length;n++){const i=r.removed[n],s=t.indexOf(i);s>=0&&(t[s]=null,e[s].disconnect(i))}for(let n=0;n<r.added.length;n++){const i=r.added[n];let s=t.indexOf(i);if(s===-1){for(let o=0;o<e.length;o++)if(o>=t.length){t.push(i),s=o;break}else if(t[o]===null){t[o]=i,s=o;break}if(s===-1)break}const a=e[s];a&&a.connect(i)}}function Yye(r){return r.type==="quad"?this._glBinding.createQuadLayer({transform:new XRRigidTransform(r.translation,r.quaternion),width:r.width/2,height:r.height/2,space:this._referenceSpace,viewPixelWidth:r.pixelwidth,viewPixelHeight:r.pixelheight,clearOnAccess:!1}):this._glBinding.createCylinderLayer({transform:new XRRigidTransform(r.translation,r.quaternion),radius:r.radius,centralAngle:r.centralAngle,aspectRatio:r.aspectRatio,space:this._referenceSpace,viewPixelWidth:r.pixelwidth,viewPixelHeight:r.pixelheight,clearOnAccess:!1})}function Zye(r,e){if(e===void 0)return;const t=this._cameraXR,n=this._renderer,i=n.backend,s=this._glBaseLayer,a=this.getReferenceSpace(),o=e.getViewerPose(a);if(this._xrFrame=e,o!==null){const l=o.views;this._glBaseLayer!==null&&i.setXRTarget(s.framebuffer);let c=!1;l.length!==t.cameras.length&&(t.cameras.length=0,c=!0);for(let d=0;d<l.length;d++){const p=l[d];let y;if(this._supportsLayers===!0){const v=this._glBinding.getViewSubImage(this._glProjLayer,p);y=v.viewport,d===0&&i.setXRRenderTargetTextures(this._xrRenderTarget,v.colorTexture,this._glProjLayer.ignoreDepthValues&&!this._useMultiview?void 0:v.depthStencilTexture)}else y=s.getViewport(p);let _=this._cameras[d];_===void 0&&(_=new Br,_.layers.enable(d),_.viewport=new zn,this._cameras[d]=_),_.matrix.fromArray(p.transform.matrix),_.matrix.decompose(_.position,_.quaternion,_.scale),_.projectionMatrix.fromArray(p.projectionMatrix),_.projectionMatrixInverse.copy(_.projectionMatrix).invert(),_.viewport.set(y.x,y.y,y.width,y.height),d===0&&(t.matrix.copy(_.matrix),t.matrix.decompose(t.position,t.quaternion,t.scale)),c===!0&&t.cameras.push(_)}n.setOutputRenderTarget(this._xrRenderTarget)}for(let l=0;l<this._controllers.length;l++){const c=this._controllerInputSources[l],d=this._controllers[l];c!==null&&d!==void 0&&d.update(c,e,a)}this._currentAnimationLoop&&this._currentAnimationLoop(r,e),e.detectedPlanes&&this.dispatchEvent({type:"planesdetected",data:e}),this._xrFrame=null}class Kye extends Gl{constructor(e){super(),this.domElement=e,this._pixelRatio=1,this._width=this.domElement.width,this._height=this.domElement.height,this._viewport=new zn(0,0,this._width,this._height),this._scissor=new zn(0,0,this._width,this._height),this._scissorTest=!1,this.colorTexture=new NC,this.depthTexture=new Ga}getPixelRatio(){return this._pixelRatio}getDrawingBufferSize(e){return e.set(this._width*this._pixelRatio,this._height*this._pixelRatio).floor()}getSize(e){return e.set(this._width,this._height)}setPixelRatio(e=1){this._pixelRatio!==e&&(this._pixelRatio=e,this.setSize(this._width,this._height,!1))}setDrawingBufferSize(e,t,n){this.xr&&this.xr.isPresenting||(this._width=e,this._height=t,this._pixelRatio=n,this.domElement.width=Math.floor(e*n),this.domElement.height=Math.floor(t*n),this.setViewport(0,0,e,t),this._dispatchResize())}setSize(e,t,n=!0){this.xr&&this.xr.isPresenting||(this._width=e,this._height=t,this.domElement.width=Math.floor(e*this._pixelRatio),this.domElement.height=Math.floor(t*this._pixelRatio),n===!0&&(this.domElement.style.width=e+"px",this.domElement.style.height=t+"px"),this.setViewport(0,0,e,t),this._dispatchResize())}getScissor(e){const t=this._scissor;return e.x=t.x,e.y=t.y,e.width=t.width,e.height=t.height,e}setScissor(e,t,n,i){const s=this._scissor;e.isVector4?s.copy(e):s.set(e,t,n,i)}getScissorTest(){return this._scissorTest}setScissorTest(e){this._scissorTest=e}getViewport(e){return e.copy(this._viewport)}setViewport(e,t,n,i,s=0,a=1){const o=this._viewport;e.isVector4?o.copy(e):o.set(e,t,n,i),o.minDepth=s,o.maxDepth=a}_dispatchResize(){this.dispatchEvent({type:"resize"})}dispose(){this.dispatchEvent({type:"dispose"})}}const OG=new Fm,Ev=new tt,AD=new zn,wD=new Ry,RD=new W1,cw=new gn,ah=new zn;class Qye{constructor(e,t={}){this.isRenderer=!0;const{logarithmicDepthBuffer:n=!1,alpha:i=!0,depth:s=!0,stencil:a=!1,antialias:o=!1,samples:l=0,getFallback:c=null,outputBufferType:d=vi,multiview:p=!1}=t;this.backend=e,this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.alpha=i,this.logarithmicDepthBuffer=n,this.outputColorSpace=ea,this.toneMapping=ta,this.toneMappingExposure=1,this.sortObjects=!0,this.depth=s,this.stencil=a,this.info=new Vde,this.contextNode=jh(),this.library=new TX,this.lighting=new kye,this._samples=l||o===!0?4:0,this._onCanvasTargetResize=this._onCanvasTargetResize.bind(this),this._canvasTarget=new Kye(e.getDomElement()),this._canvasTarget.addEventListener("resize",this._onCanvasTargetResize),this._canvasTarget.isDefaultCanvasTarget=!0,this._inspector=new NW,this._inspector.setRenderer(this),this._getFallback=c,this._attributes=null,this._geometries=null,this._nodes=null,this._animation=null,this._bindings=null,this._objects=null,this._pipelines=null,this._bundles=null,this._renderLists=null,this._renderContexts=null,this._textures=null,this._background=null,this._quad=new AN(new ds),this._quad.name="Output Color Transform",this._quad.material.name="outputColorTransform",this._currentRenderContext=null,this._opaqueSort=null,this._transparentSort=null,this._frameBufferTarget=null;const y=this.alpha===!0?0:1;this._clearColor=new XB(0,0,0,y),this._clearDepth=1,this._clearStencil=0,this._renderTarget=null,this._activeCubeFace=0,this._activeMipmapLevel=0,this._outputRenderTarget=null,this._mrt=null,this._renderObjectFunction=null,this._currentRenderObjectFunction=null,this._currentRenderBundle=null,this._handleObjectFunction=this._renderObjectDirect,this._isDeviceLost=!1,this.onDeviceLost=this._onDeviceLost,this._outputBufferType=d,this._cacheShadowNodes=new WeakMap,this._initialized=!1,this._initPromise=null,this._compilationPromises=null,this.transparent=!0,this.opaque=!0,this.shadowMap={enabled:!1,type:M0},this.xr=new Hye(this,p),this.debug={checkShaderErrors:!0,onShaderError:null,getShaderAsync:async(_,v,b)=>{await this.compileAsync(_,v);const E=this._renderLists.get(_,v),T=this._renderContexts.get(_,v,this._renderTarget,this._mrt),M=_.overrideMaterial||b.material,R=this._objects.get(b,M,_,v,E.lightsNode,T,T.clippingContext),{fragmentShader:N,vertexShader:P}=R.getNodeBuilderState();return{fragmentShader:N,vertexShader:P}}}}async init(){return this._initPromise!==null?this._initPromise:(this._initPromise=new Promise(async(e,t)=>{let n=this.backend;try{await n.init(this)}catch(i){if(this._getFallback!==null)try{this.backend=n=this._getFallback(i),await n.init(this)}catch(s){t(s);return}else{t(i);return}}this._nodes=new Fye(this,n),this._animation=new Dde(this,this._nodes,this.info),this._attributes=new Fde(n),this._background=new Q0e(this,this._nodes),this._geometries=new zde(this._attributes,this.info),this._textures=new the(this,n,this.info),this._pipelines=new Wde(n,this._nodes),this._bindings=new qde(n,this._nodes,this._textures,this._attributes,this._pipelines,this.info),this._objects=new Pde(this,this._nodes,this._geometries,this._pipelines,this._bindings,this.info),this._renderLists=new jde(this.lighting),this._bundles=new Vye,this._renderContexts=new Jde,this._animation.start(),this._initialized=!0,this._inspector.init(),e(this)}),this._initPromise)}get domElement(){return this._canvasTarget.domElement}get coordinateSystem(){return this.backend.coordinateSystem}async compileAsync(e,t,n=null){if(this._isDeviceLost===!0)return;this._initialized===!1&&await this.init();const i=this._nodes.nodeFrame,s=i.renderId,a=this._currentRenderContext,o=this._currentRenderObjectFunction,l=this._compilationPromises,c=e.isScene===!0?e:OG;n===null&&(n=e);const d=this._renderTarget,p=this._renderContexts.get(n,t,d,this._mrt),y=this._activeMipmapLevel,_=[];this._currentRenderContext=p,this._currentRenderObjectFunction=this.renderObject,this._handleObjectFunction=this._createObjectPipeline,this._compilationPromises=_,i.renderId++,i.update(),p.depth=this.depth,p.stencil=this.stencil,p.clippingContext||(p.clippingContext=new FR),p.clippingContext.updateGlobal(c,t),c.onBeforeRender(this,e,t,d);const v=this._renderLists.get(e,t);if(v.begin(),this._projectObject(e,t,0,v,p.clippingContext),n!==e&&n.traverseVisible(function(R){R.isLight&&R.layers.test(t.layers)&&v.pushLight(R)}),v.finish(),d!==null){this._textures.updateRenderTarget(d,y);const R=this._textures.get(d);p.textures=R.textures,p.depthTexture=R.depthTexture}else p.textures=null,p.depthTexture=null;this._background.update(c,v,p);const b=v.opaque,E=v.transparent,T=v.transparentDoublePass,M=v.lightsNode;this.opaque===!0&&b.length>0&&this._renderObjects(b,t,c,M),this.transparent===!0&&E.length>0&&this._renderTransparents(E,T,t,c,M),i.renderId=s,this._currentRenderContext=a,this._currentRenderObjectFunction=o,this._compilationPromises=l,this._handleObjectFunction=this._renderObjectDirect,await Promise.all(_)}async renderAsync(e,t){cr('Renderer: "renderAsync()" has been deprecated. Use "render()" and "await renderer.init();" when creating the renderer.'),await this.init(),this.render(e,t)}async waitForGPU(){Ze("Renderer: waitForGPU() has been removed. Read https://github.com/mrdoob/three.js/issues/32012 for more information.")}set inspector(e){this._inspector!==null&&this._inspector.setRenderer(null),this._inspector=e,this._inspector.setRenderer(this)}get inspector(){return this._inspector}set highPrecision(e){const t=this.contextNode.value;e===!0?(t.modelViewMatrix=sU,t.modelNormalViewMatrix=aU):this.highPrecision&&(delete t.modelViewMatrix,delete t.modelNormalViewMatrix)}get highPrecision(){const e=this.contextNode.value;return e.modelViewMatrix===sU&&e.modelNormalViewMatrix===aU}setMRT(e){return this._mrt=e,this}getMRT(){return this._mrt}getOutputBufferType(){return this._outputBufferType}getColorBufferType(){return cr('Renderer: ".getColorBufferType()" has been renamed to ".getOutputBufferType()".'),this.getOutputBufferType()}_onDeviceLost(e){let t=`THREE.WebGPURenderer: ${e.api} Device Lost:

Message: ${e.message}`;e.reason&&(t+=`
Reason: ${e.reason}`),Ze(t),this._isDeviceLost=!0}_renderBundle(e,t,n){const{bundleGroup:i,camera:s,renderList:a}=e,o=this._currentRenderContext,l=this._bundles.get(i,s),c=this.backend.get(l);c.renderContexts===void 0&&(c.renderContexts=new Set);const d=i.version!==c.version,p=c.renderContexts.has(o)===!1||d;if(c.renderContexts.add(o),p){this.backend.beginBundle(o),(c.renderObjects===void 0||d)&&(c.renderObjects=[]),this._currentRenderBundle=l;const{transparentDoublePass:y,transparent:_,opaque:v}=a;this.opaque===!0&&v.length>0&&this._renderObjects(v,s,t,n),this.transparent===!0&&_.length>0&&this._renderTransparents(_,y,s,t,n),this._currentRenderBundle=null,this.backend.finishBundle(o,l),c.version=i.version}else{const{renderObjects:y}=c;for(let _=0,v=y.length;_<v;_++){const b=y[_];this._nodes.needsRefresh(b)&&(this._nodes.updateBefore(b),this._nodes.updateForRender(b),this._bindings.updateForRender(b),this._nodes.updateAfter(b))}}this.backend.addBundle(o,l)}render(e,t){if(this._initialized===!1)throw new Error('Renderer: .render() called before the backend is initialized. Use "await renderer.init();" before rendering.');this._renderScene(e,t)}get initialized(){return this._initialized}_getFrameBufferTarget(){const{currentToneMapping:e,currentColorSpace:t}=this,n=e!==ta,i=t!==Nn.workingColorSpace;if(n===!1&&i===!1)return null;const{width:s,height:a}=this.getDrawingBufferSize(Ev),{depth:o,stencil:l}=this;let c=this._frameBufferTarget;c===null&&(c=new sf(s,a,{depthBuffer:o,stencilBuffer:l,type:this._outputBufferType,format:Qi,colorSpace:Nn.workingColorSpace,generateMipmaps:!1,minFilter:ei,magFilter:ei,samples:this.samples}),c.isPostProcessingRenderTarget=!0,this._frameBufferTarget=c);const d=this.getOutputRenderTarget();c.depthBuffer=o,c.stencilBuffer=l,d!==null?c.setSize(d.width,d.height,d.depth):c.setSize(s,a,1);const p=this._canvasTarget;return c.viewport.copy(p._viewport),c.scissor.copy(p._scissor),c.viewport.multiplyScalar(p._pixelRatio),c.scissor.multiplyScalar(p._pixelRatio),c.scissorTest=p._scissorTest,c.multiview=d!==null?d.multiview:!1,c.resolveDepthBuffer=d!==null?d.resolveDepthBuffer:!0,c._autoAllocateDepthBuffer=d!==null?d._autoAllocateDepthBuffer:!1,c}_renderScene(e,t,n=!0){if(this._isDeviceLost===!0)return;const i=n?this._getFrameBufferTarget():null,s=this._nodes.nodeFrame,a=s.renderId,o=this._currentRenderContext,l=this._currentRenderObjectFunction,c=e.isScene===!0?e:OG,d=this._renderTarget||this._outputRenderTarget,p=this._activeCubeFace,y=this._activeMipmapLevel;let _;i!==null?(_=i,this.setRenderTarget(_)):_=d;const v=this._renderContexts.get(e,t,_,this._mrt);this._currentRenderContext=v,this._currentRenderObjectFunction=this._renderObjectFunction||this.renderObject,this.info.calls++,this.info.render.calls++,this.info.render.frameCalls++,s.renderId=this.info.calls,this.backend.updateTimeStampUID(v),this.inspector.beginRender(this.backend.getTimestampUID(v),e,t,_);const b=this.coordinateSystem,E=this.xr;if(t.coordinateSystem!==b&&E.isPresenting===!1&&(t.coordinateSystem=b,t.updateProjectionMatrix(),t.isArrayCamera))for(const se of t.cameras)se.coordinateSystem=b,se.updateProjectionMatrix();e.matrixWorldAutoUpdate===!0&&e.updateMatrixWorld(),t.parent===null&&t.matrixWorldAutoUpdate===!0&&t.updateMatrixWorld(),E.enabled===!0&&E.isPresenting===!0&&(E.cameraAutoUpdate===!0&&E.updateCamera(t),t=E.getCamera());const T=this._canvasTarget;let M=T._viewport,R=T._scissor,N=T._pixelRatio;_!==null&&(M=_.viewport,R=_.scissor,N=1),this.getDrawingBufferSize(Ev),AD.set(0,0,Ev.width,Ev.height);const P=M.minDepth===void 0?0:M.minDepth,U=M.maxDepth===void 0?1:M.maxDepth;v.viewportValue.copy(M).multiplyScalar(N).floor(),v.viewportValue.width>>=y,v.viewportValue.height>>=y,v.viewportValue.minDepth=P,v.viewportValue.maxDepth=U,v.viewport=v.viewportValue.equals(AD)===!1,v.scissorValue.copy(R).multiplyScalar(N).floor(),v.scissor=T._scissorTest&&v.scissorValue.equals(AD)===!1,v.scissorValue.width>>=y,v.scissorValue.height>>=y,v.clippingContext||(v.clippingContext=new FR),v.clippingContext.updateGlobal(c,t),c.onBeforeRender(this,e,t,_);const L=t.isArrayCamera?RD:wD;t.isArrayCamera||(cw.multiplyMatrices(t.projectionMatrix,t.matrixWorldInverse),L.setFromProjectionMatrix(cw,t.coordinateSystem,t.reversedDepth));const F=this._renderLists.get(e,t);if(F.begin(),this._projectObject(e,t,0,F,v.clippingContext),F.finish(),this.sortObjects===!0&&F.sort(this._opaqueSort,this._transparentSort),_!==null){this._textures.updateRenderTarget(_,y);const se=this._textures.get(_);v.textures=se.textures,v.depthTexture=se.depthTexture,v.width=se.width,v.height=se.height,v.renderTarget=_,v.depth=_.depthBuffer,v.stencil=_.stencilBuffer}else v.textures=null,v.depthTexture=null,v.width=Ev.width,v.height=Ev.height,v.depth=this.depth,v.stencil=this.stencil;v.width>>=y,v.height>>=y,v.activeCubeFace=p,v.activeMipmapLevel=y,v.occlusionQueryCount=F.occlusionQueryCount,v.scissorValue.max(ah.set(0,0,0,0)),v.scissorValue.x+v.scissorValue.width>v.width&&(v.scissorValue.width=Math.max(v.width-v.scissorValue.x,0)),v.scissorValue.y+v.scissorValue.height>v.height&&(v.scissorValue.height=Math.max(v.height-v.scissorValue.y,0)),this._background.update(c,F,v),v.camera=t,this.backend.beginRender(v);const{bundles:O,lightsNode:B,transparentDoublePass:q,transparent:j,opaque:Q}=F;return O.length>0&&this._renderBundles(O,c,B),this.opaque===!0&&Q.length>0&&this._renderObjects(Q,t,c,B),this.transparent===!0&&j.length>0&&this._renderTransparents(j,q,t,c,B),this.backend.finishRender(v),s.renderId=a,this._currentRenderContext=o,this._currentRenderObjectFunction=l,i!==null&&(this.setRenderTarget(d,p,y),this._renderOutput(_)),c.onAfterRender(this,e,t,_),this.inspector.finishRender(this.backend.getTimestampUID(v)),v}_setXRLayerSize(e,t){this._canvasTarget._width=e,this._canvasTarget._height=t,this.setViewport(0,0,e,t)}_renderOutput(e){const t=this._quad;this._nodes.hasOutputChange(e.texture)&&(t.material.fragmentNode=this._nodes.getOutputNode(e.texture),t.material.needsUpdate=!0);const n=this.autoClear,i=this.xr.enabled;this.autoClear=!1,this.xr.enabled=!1,this._renderScene(t,t.camera,!1),this.autoClear=n,this.xr.enabled=i}getMaxAnisotropy(){return this.backend.getMaxAnisotropy()}getActiveCubeFace(){return this._activeCubeFace}getActiveMipmapLevel(){return this._activeMipmapLevel}async setAnimationLoop(e){this._initialized===!1&&await this.init(),this._animation.setAnimationLoop(e)}getAnimationLoop(){return this._animation.getAnimationLoop()}async getArrayBufferAsync(e){return await this.backend.getArrayBufferAsync(e)}getContext(){return this.backend.getContext()}getPixelRatio(){return this._canvasTarget.getPixelRatio()}getDrawingBufferSize(e){return this._canvasTarget.getDrawingBufferSize(e)}getSize(e){return this._canvasTarget.getSize(e)}setPixelRatio(e=1){this._canvasTarget.setPixelRatio(e)}setDrawingBufferSize(e,t,n){this.xr&&this.xr.isPresenting||this._canvasTarget.setDrawingBufferSize(e,t,n)}setSize(e,t,n=!0){this.xr&&this.xr.isPresenting||this._canvasTarget.setSize(e,t,n)}setOpaqueSort(e){this._opaqueSort=e}setTransparentSort(e){this._transparentSort=e}getScissor(e){return this._canvasTarget.getScissor(e)}setScissor(e,t,n,i){this._canvasTarget.setScissor(e,t,n,i)}getScissorTest(){return this._canvasTarget.getScissorTest()}setScissorTest(e){this._canvasTarget.setScissorTest(e),this.backend.setScissorTest(e)}getViewport(e){return this._canvasTarget.getViewport(e)}setViewport(e,t,n,i,s=0,a=1){this._canvasTarget.setViewport(e,t,n,i,s,a)}getClearColor(e){return e.copy(this._clearColor)}setClearColor(e,t=1){this._clearColor.set(e),this._clearColor.a=t}getClearAlpha(){return this._clearColor.a}setClearAlpha(e){this._clearColor.a=e}getClearDepth(){return this._clearDepth}setClearDepth(e){this._clearDepth=e}getClearStencil(){return this._clearStencil}setClearStencil(e){this._clearStencil=e}isOccluded(e){const t=this._currentRenderContext;return t&&this.backend.isOccluded(t,e)}clear(e=!0,t=!0,n=!0){if(this._initialized===!1)throw new Error('Renderer: .clear() called before the backend is initialized. Use "await renderer.init();" before before using this method.');const i=this._renderTarget||this._getFrameBufferTarget();let s=null;if(i!==null){this._textures.updateRenderTarget(i);const a=this._textures.get(i);s=this._renderContexts.getForClear(i),s.textures=a.textures,s.depthTexture=a.depthTexture,s.width=a.width,s.height=a.height,s.renderTarget=i,s.depth=i.depthBuffer,s.stencil=i.stencilBuffer,s.clearColorValue=this.backend.getClearColor(),s.activeCubeFace=this.getActiveCubeFace(),s.activeMipmapLevel=this.getActiveMipmapLevel()}this.backend.clear(e,t,n,s),i!==null&&this._renderTarget===null&&this._renderOutput(i)}clearColor(){this.clear(!0,!1,!1)}clearDepth(){this.clear(!1,!0,!1)}clearStencil(){this.clear(!1,!1,!0)}async clearAsync(e=!0,t=!0,n=!0){cr('Renderer: "clearAsync()" has been deprecated. Use "clear()" and "await renderer.init();" when creating the renderer.'),await this.init(),this.clear(e,t,n)}async clearColorAsync(){cr('Renderer: "clearColorAsync()" has been deprecated. Use "clearColor()" and "await renderer.init();" when creating the renderer.'),this.clear(!0,!1,!1)}async clearDepthAsync(){cr('Renderer: "clearDepthAsync()" has been deprecated. Use "clearDepth()" and "await renderer.init();" when creating the renderer.'),this.clear(!1,!0,!1)}async clearStencilAsync(){cr('Renderer: "clearStencilAsync()" has been deprecated. Use "clearStencil()" and "await renderer.init();" when creating the renderer.'),this.clear(!1,!1,!0)}get needsFrameBufferTarget(){const e=this.currentToneMapping!==ta,t=this.currentColorSpace!==Nn.workingColorSpace;return e||t}get samples(){return this._samples}get currentSamples(){let e=this._samples;return this._renderTarget!==null?e=this._renderTarget.samples:this.needsFrameBufferTarget&&(e=0),e}get currentToneMapping(){return this.isOutputTarget?this.toneMapping:ta}get currentColorSpace(){return this.isOutputTarget?this.outputColorSpace:Nn.workingColorSpace}get isOutputTarget(){return this._renderTarget===this._outputRenderTarget||this._renderTarget===null}dispose(){this._initialized===!0&&(this.info.dispose(),this.backend.dispose(),this._animation.dispose(),this._objects.dispose(),this._geometries.dispose(),this._pipelines.dispose(),this._nodes.dispose(),this._bindings.dispose(),this._renderLists.dispose(),this._renderContexts.dispose(),this._textures.dispose(),this._frameBufferTarget!==null&&this._frameBufferTarget.dispose(),Object.values(this.backend.timestampQueryPool).forEach(e=>{e!==null&&e.dispose()})),this.setRenderTarget(null),this.setAnimationLoop(null)}setRenderTarget(e,t=0,n=0){this._renderTarget=e,this._activeCubeFace=t,this._activeMipmapLevel=n}getRenderTarget(){return this._renderTarget}setOutputRenderTarget(e){this._outputRenderTarget=e}getOutputRenderTarget(){return this._outputRenderTarget}setCanvasTarget(e){this._canvasTarget.removeEventListener("resize",this._onCanvasTargetResize),this._canvasTarget=e,this._canvasTarget.addEventListener("resize",this._onCanvasTargetResize)}getCanvasTarget(){return this._canvasTarget}_resetXRState(){this.backend.setXRTarget(null),this.setOutputRenderTarget(null),this.setRenderTarget(null),this._frameBufferTarget.dispose(),this._frameBufferTarget=null}setRenderObjectFunction(e){this._renderObjectFunction=e}getRenderObjectFunction(){return this._renderObjectFunction}compute(e,t=null){if(this._isDeviceLost===!0)return;if(this._initialized===!1)return Ve("Renderer: .compute() called before the backend is initialized. Try using .computeAsync() instead."),this.computeAsync(e,t);const n=this._nodes.nodeFrame,i=n.renderId;this.info.calls++,this.info.compute.calls++,this.info.compute.frameCalls++,n.renderId=this.info.calls,this.backend.updateTimeStampUID(e),this.inspector.beginCompute(this.backend.getTimestampUID(e),e);const s=this.backend,a=this._pipelines,o=this._bindings,l=this._nodes,c=Array.isArray(e)?e:[e];if(c[0]===void 0||c[0].isComputeNode!==!0)throw new Error("THREE.Renderer: .compute() expects a ComputeNode.");s.beginCompute(e);for(const d of c){if(a.has(d)===!1){const _=()=>{d.removeEventListener("dispose",_),a.delete(d),o.deleteForCompute(d),l.delete(d)};d.addEventListener("dispose",_);const v=d.onInitFunction;v!==null&&v.call(d,{renderer:this})}l.updateForCompute(d),o.updateForCompute(d);const p=o.getForCompute(d),y=a.getForCompute(d,p);s.compute(e,d,p,y,t)}s.finishCompute(e),n.renderId=i,this.inspector.finishCompute(this.backend.getTimestampUID(e))}async computeAsync(e,t=null){this._initialized===!1&&await this.init(),this.compute(e,t)}async hasFeatureAsync(e){return cr('Renderer: "hasFeatureAsync()" has been deprecated. Use "hasFeature()" and "await renderer.init();" when creating the renderer.'),await this.init(),this.hasFeature(e)}async resolveTimestampsAsync(e="render"){return this._initialized===!1&&await this.init(),this.backend.resolveTimestampsAsync(e)}hasFeature(e){if(this._initialized===!1)throw new Error('Renderer: .hasFeature() called before the backend is initialized. Use "await renderer.init();" before before using this method.');return this.backend.hasFeature(e)}hasInitialized(){return this._initialized}async initTextureAsync(e){cr('Renderer: "initTextureAsync()" has been deprecated. Use "initTexture()" and "await renderer.init();" when creating the renderer.'),await this.init(),this.initTexture(e)}initTexture(e){if(this._initialized===!1)throw new Error('Renderer: .initTexture() called before the backend is initialized. Use "await renderer.init();" before before using this method.');this._textures.updateTexture(e)}copyFramebufferToTexture(e,t=null){if(t!==null)if(t.isVector2)t=ah.set(t.x,t.y,e.image.width,e.image.height).floor();else if(t.isVector4)t=ah.copy(t).floor();else{Ze("Renderer.copyFramebufferToTexture: Invalid rectangle.");return}else t=ah.set(0,0,e.image.width,e.image.height);let n=this._currentRenderContext,i;n!==null?i=n.renderTarget:(i=this._renderTarget||this._getFrameBufferTarget(),i!==null&&(this._textures.updateRenderTarget(i),n=this._textures.get(i))),this._textures.updateTexture(e,{renderTarget:i}),this.backend.copyFramebufferToTexture(e,n,t),this._inspector.copyFramebufferToTexture(e)}copyTextureToTexture(e,t,n=null,i=null,s=0,a=0){this._textures.updateTexture(e),this._textures.updateTexture(t),this.backend.copyTextureToTexture(e,t,n,i,s,a),this._inspector.copyTextureToTexture(e,t)}async readRenderTargetPixelsAsync(e,t,n,i,s,a=0,o=0){return this.backend.copyTextureToBuffer(e.textures[a],t,n,i,s,o)}_projectObject(e,t,n,i,s){if(e.visible===!1)return;if(e.layers.test(t.layers)){if(e.isGroup)n=e.renderOrder,e.isClippingGroup&&e.enabled&&(s=s.getGroupContext(e));else if(e.isLOD)e.autoUpdate===!0&&e.update(t);else if(e.isLight)i.pushLight(e);else if(e.isSprite){const l=t.isArrayCamera?RD:wD;if(!e.frustumCulled||l.intersectsSprite(e,t)){this.sortObjects===!0&&ah.setFromMatrixPosition(e.matrixWorld).applyMatrix4(cw);const{geometry:c,material:d}=e;d.visible&&i.push(e,c,d,n,ah.z,null,s)}}else if(e.isLineLoop)Ze("Renderer: Objects of type THREE.LineLoop are not supported. Please use THREE.Line or THREE.LineSegments.");else if(e.isMesh||e.isLine||e.isPoints){const l=t.isArrayCamera?RD:wD;if(!e.frustumCulled||l.intersectsObject(e,t)){const{geometry:c,material:d}=e;if(this.sortObjects===!0&&(c.boundingSphere===null&&c.computeBoundingSphere(),ah.copy(c.boundingSphere.center).applyMatrix4(e.matrixWorld).applyMatrix4(cw)),Array.isArray(d)){const p=c.groups;for(let y=0,_=p.length;y<_;y++){const v=p[y],b=d[v.materialIndex];b&&b.visible&&i.push(e,c,b,n,ah.z,v,s)}}else d.visible&&i.push(e,c,d,n,ah.z,null,s)}}}if(e.isBundleGroup===!0&&this.backend.beginBundle!==void 0){const l=i;i=this._renderLists.get(e,t),i.begin(),l.pushBundle({bundleGroup:e,camera:t,renderList:i}),i.finish()}const o=e.children;for(let l=0,c=o.length;l<c;l++)this._projectObject(o[l],t,n,i,s)}_renderBundles(e,t,n){for(const i of e)this._renderBundle(i,t,n)}_renderTransparents(e,t,n,i,s){if(t.length>0){for(const{material:a}of t)a.side=gr;this._renderObjects(t,n,i,s,"backSide");for(const{material:a}of t)a.side=Cl;this._renderObjects(e,n,i,s);for(const{material:a}of t)a.side=xa}else this._renderObjects(e,n,i,s)}_renderObjects(e,t,n,i,s=null){for(let a=0,o=e.length;a<o;a++){const{object:l,geometry:c,material:d,group:p,clippingContext:y}=e[a];this._currentRenderObjectFunction(l,n,t,c,d,p,i,y,s)}}_getShadowNodes(e){const t=e.version;let n=this._cacheShadowNodes.get(e);if(n===void 0||n.version!==t){const i=e.map!==null,s=e.colorNode&&e.colorNode.isNode,a=e.castShadowNode&&e.castShadowNode.isNode;let o=null,l=null,c=null;if(i||s||a){let d,p;a?(d=e.castShadowNode.rgb,p=e.castShadowNode.a):(d=ge(0),p=re(1)),i&&(p=p.mul(fr("map","texture",e).a)),s&&(p=p.mul(e.colorNode.a)),l=En(d,p)}e.depthNode&&e.depthNode.isNode&&(c=e.depthNode),e.castShadowPositionNode&&e.castShadowPositionNode.isNode?o=e.castShadowPositionNode:e.positionNode&&e.positionNode.isNode&&(o=e.positionNode),n={version:t,colorNode:l,depthNode:c,positionNode:o},this._cacheShadowNodes.set(e,n)}return n}renderObject(e,t,n,i,s,a,o,l=null,c=null){let d=!1,p,y,_,v;if(e.onBeforeRender(this,t,n,i,s,a),s.allowOverride===!0&&t.overrideMaterial!==null){const b=t.overrideMaterial;if(d=!0,p=t.overrideMaterial.colorNode,y=t.overrideMaterial.depthNode,_=t.overrideMaterial.positionNode,v=t.overrideMaterial.side,s.positionNode&&s.positionNode.isNode&&(b.positionNode=s.positionNode),b.alphaTest=s.alphaTest,b.alphaMap=s.alphaMap,b.transparent=s.transparent||s.transmission>0||s.transmissionNode&&s.transmissionNode.isNode||s.backdropNode&&s.backdropNode.isNode,b.isShadowPassMaterial){const{colorNode:E,depthNode:T,positionNode:M}=this._getShadowNodes(s);b.side=s.shadowSide===null?s.side:s.shadowSide,E!==null&&(b.colorNode=E),T!==null&&(b.depthNode=T),M!==null&&(b.positionNode=M)}s=b}s.transparent===!0&&s.side===xa&&s.forceSinglePass===!1?(s.side=gr,this._handleObjectFunction(e,s,t,n,o,a,l,"backSide"),s.side=Cl,this._handleObjectFunction(e,s,t,n,o,a,l,c),s.side=xa):this._handleObjectFunction(e,s,t,n,o,a,l,c),d&&(t.overrideMaterial.colorNode=p,t.overrideMaterial.depthNode=y,t.overrideMaterial.positionNode=_,t.overrideMaterial.side=v),e.onAfterRender(this,t,n,i,s,a)}_renderObjectDirect(e,t,n,i,s,a,o,l){const c=this._objects.get(e,t,n,i,s,this._currentRenderContext,o,l);c.drawRange=e.geometry.drawRange,c.group=a;const d=this._nodes.needsRefresh(c);d&&(this._nodes.updateBefore(c),this._geometries.updateForRender(c),this._nodes.updateForRender(c),this._bindings.updateForRender(c)),this._pipelines.updateForRender(c),this._currentRenderBundle!==null&&(this.backend.get(this._currentRenderBundle).renderObjects.push(c),c.bundle=this._currentRenderBundle.bundleGroup),this.backend.draw(c,this.info),d&&this._nodes.updateAfter(c)}_createObjectPipeline(e,t,n,i,s,a,o,l){const c=this._objects.get(e,t,n,i,s,this._currentRenderContext,o,l);c.drawRange=e.geometry.drawRange,c.group=a,this._nodes.updateBefore(c),this._geometries.updateForRender(c),this._nodes.updateForRender(c),this._bindings.updateForRender(c),this._pipelines.getForRender(c,this._compilationPromises),this._nodes.updateAfter(c)}_onCanvasTargetResize(){this._initialized&&this.backend.updateSize()}get compile(){return this.compileAsync}}class EX{constructor(e=""){this.name=e,this.visibility=0}setVisibility(e){this.visibility|=e}getVisibility(){return this.visibility}clone(){return Object.assign(new this.constructor,this)}}function Jye(r){return r+(em-r%em)%em}class MX extends EX{constructor(e,t=null){super(e),this.isBuffer=!0,this.bytesPerElement=Float32Array.BYTES_PER_ELEMENT,this._buffer=t,this._updateRanges=[]}get updateRanges(){return this._updateRanges}addUpdateRange(e,t){this.updateRanges.push({start:e,count:t})}clearUpdateRanges(){this.updateRanges.length=0}get byteLength(){return Jye(this._buffer.byteLength)}get buffer(){return this._buffer}update(){return!0}}class AX extends MX{constructor(e,t=null){super(e,t),this.isUniformBuffer=!0}}let e_e=0;class wX extends AX{constructor(e,t){super("UniformBuffer_"+e_e++,e?e.value:null),this.nodeUniform=e,this.groupNode=t,this.isNodeUniformBuffer=!0}set updateRanges(e){this.nodeUniform.updateRanges=e}get updateRanges(){return this.nodeUniform.updateRanges}addUpdateRange(e,t){this.nodeUniform.addUpdateRange(e,t)}clearUpdateRanges(){this.nodeUniform.clearUpdateRanges()}get buffer(){return this.nodeUniform.value}}class t_e extends AX{constructor(e){super(e),this.isUniformsGroup=!0,this._values=null,this.uniforms=[]}addUniform(e){return this.uniforms.push(e),this}removeUniform(e){const t=this.uniforms.indexOf(e);return t!==-1&&this.uniforms.splice(t,1),this}get values(){return this._values===null&&(this._values=Array.from(this.buffer)),this._values}get buffer(){let e=this._buffer;if(e===null){const t=this.byteLength;e=new Float32Array(new ArrayBuffer(t)),this._buffer=e}return e}get byteLength(){const e=this.bytesPerElement;let t=0;for(let n=0,i=this.uniforms.length;n<i;n++){const s=this.uniforms[n],a=s.boundary,o=s.itemSize*e,l=t%em,c=l%a,d=l+c;t+=c,d!==0&&em-d<o&&(t+=em-d),s.offset=t/e,t+=o}return Math.ceil(t/em)*em}update(){let e=!1;for(const t of this.uniforms)this.updateByType(t)===!0&&(e=!0);return e}updateByType(e){if(e.isNumberUniform)return this.updateNumber(e);if(e.isVector2Uniform)return this.updateVector2(e);if(e.isVector3Uniform)return this.updateVector3(e);if(e.isVector4Uniform)return this.updateVector4(e);if(e.isColorUniform)return this.updateColor(e);if(e.isMatrix3Uniform)return this.updateMatrix3(e);if(e.isMatrix4Uniform)return this.updateMatrix4(e);Ze("WebGPUUniformsGroup: Unsupported uniform type.",e)}updateNumber(e){let t=!1;const n=this.values,i=e.getValue(),s=e.offset,a=e.getType();if(n[s]!==i){const o=this._getBufferForType(a);o[s]=n[s]=i,t=!0}return t}updateVector2(e){let t=!1;const n=this.values,i=e.getValue(),s=e.offset,a=e.getType();if(n[s+0]!==i.x||n[s+1]!==i.y){const o=this._getBufferForType(a);o[s+0]=n[s+0]=i.x,o[s+1]=n[s+1]=i.y,t=!0}return t}updateVector3(e){let t=!1;const n=this.values,i=e.getValue(),s=e.offset,a=e.getType();if(n[s+0]!==i.x||n[s+1]!==i.y||n[s+2]!==i.z){const o=this._getBufferForType(a);o[s+0]=n[s+0]=i.x,o[s+1]=n[s+1]=i.y,o[s+2]=n[s+2]=i.z,t=!0}return t}updateVector4(e){let t=!1;const n=this.values,i=e.getValue(),s=e.offset,a=e.getType();if(n[s+0]!==i.x||n[s+1]!==i.y||n[s+2]!==i.z||n[s+4]!==i.w){const o=this._getBufferForType(a);o[s+0]=n[s+0]=i.x,o[s+1]=n[s+1]=i.y,o[s+2]=n[s+2]=i.z,o[s+3]=n[s+3]=i.w,t=!0}return t}updateColor(e){let t=!1;const n=this.values,i=e.getValue(),s=e.offset;if(n[s+0]!==i.r||n[s+1]!==i.g||n[s+2]!==i.b){const a=this.buffer;a[s+0]=n[s+0]=i.r,a[s+1]=n[s+1]=i.g,a[s+2]=n[s+2]=i.b,t=!0}return t}updateMatrix3(e){let t=!1;const n=this.values,i=e.getValue().elements,s=e.offset;if(n[s+0]!==i[0]||n[s+1]!==i[1]||n[s+2]!==i[2]||n[s+4]!==i[3]||n[s+5]!==i[4]||n[s+6]!==i[5]||n[s+8]!==i[6]||n[s+9]!==i[7]||n[s+10]!==i[8]){const a=this.buffer;a[s+0]=n[s+0]=i[0],a[s+1]=n[s+1]=i[1],a[s+2]=n[s+2]=i[2],a[s+4]=n[s+4]=i[3],a[s+5]=n[s+5]=i[4],a[s+6]=n[s+6]=i[5],a[s+8]=n[s+8]=i[6],a[s+9]=n[s+9]=i[7],a[s+10]=n[s+10]=i[8],t=!0}return t}updateMatrix4(e){let t=!1;const n=this.values,i=e.getValue().elements,s=e.offset;return i_e(n,i,s)===!1&&(this.buffer.set(i,s),n_e(n,i,s),t=!0),t}_getBufferForType(e){return e==="int"||e==="ivec2"||e==="ivec3"||e==="ivec4"?new Int32Array(this.buffer.buffer):e==="uint"||e==="uvec2"||e==="uvec3"||e==="uvec4"?new Uint32Array(this.buffer.buffer):this.buffer}}function n_e(r,e,t){for(let n=0,i=e.length;n<i;n++)r[t+n]=e[n]}function i_e(r,e,t){for(let n=0,i=e.length;n<i;n++)if(r[t+n]!==e[n])return!1;return!0}let r_e=0;class RX extends t_e{constructor(e,t){super(e),this.id=r_e++,this.groupNode=t,this.isNodeUniformsGroup=!0}}class CX extends EX{constructor(e,t){super(e),this._texture=null,this._onTextureDispose=()=>{this.generation=null,this.version=0},this.texture=t,this.version=t?t.version:0,this.generation=null,this.samplerKey="",this.isSampler=!0}set texture(e){this._texture!==e&&(this._texture&&this._texture.removeEventListener("dispose",this._onTextureDispose),this._texture=e,this.generation=null,this.version=0,this._texture&&this._texture.addEventListener("dispose",this._onTextureDispose))}get texture(){return this._texture}update(){const{texture:e,version:t}=this;return t!==e.version?(this.version=e.version,!0):!1}clone(){const e=super.clone();return e._texture=null,e._onTextureDispose=()=>{e.generation=null,e.version=0},e.texture=this.texture,e}}let s_e=0;class a_e extends CX{constructor(e,t){super(e,t),this.id=s_e++,this.store=!1,this.mipLevel=0,this.isSampledTexture=!0}}class LN extends a_e{constructor(e,t,n,i=null){super(e,t?t.value:null),this.textureNode=t,this.groupNode=n,this.access=i}update(){const{textureNode:e}=this;return this.texture!==e.value?(this.texture=e.value,!0):super.update()}}class NX extends LN{constructor(e,t,n,i=null){super(e,t,n,i),this.isSampledCubeTexture=!0}}class xU extends LN{constructor(e,t,n,i=null){super(e,t,n,i),this.isSampledTexture3D=!0}}const UG={bitcast_int_uint:new ga("uint tsl_bitcast_int_to_uint ( int x ) { return floatBitsToUint( intBitsToFloat ( x ) ); }"),bitcast_uint_int:new ga("uint tsl_bitcast_uint_to_int ( uint x ) { return floatBitsToInt( uintBitsToFloat ( x ) ); }")},o_e={textureDimensions:"textureSize",equals:"equal",bitcast_float_int:"floatBitsToInt",bitcast_int_float:"intBitsToFloat",bitcast_uint_float:"uintBitsToFloat",bitcast_float_uint:"floatBitsToUint",bitcast_uint_int:"tsl_bitcast_uint_to_int",bitcast_int_uint:"tsl_bitcast_int_to_uint",floatpack_snorm_2x16:"packSnorm2x16",floatpack_unorm_2x16:"packUnorm2x16",floatpack_float16_2x16:"packHalf2x16",floatunpack_snorm_2x16:"unpackSnorm2x16",floatunpack_unorm_2x16:"unpackUnorm2x16",floatunpack_float16_2x16:"unpackHalf2x16"},l_e={low:"lowp",medium:"mediump",high:"highp"},LG={swizzleAssign:!0,storageBuffer:!1},PG={perspective:"smooth",linear:"noperspective"},BG={centroid:"centroid"},IG=`
precision highp float;
precision highp int;
precision highp sampler2D;
precision highp sampler3D;
precision highp samplerCube;
precision highp sampler2DArray;

precision highp usampler2D;
precision highp usampler3D;
precision highp usamplerCube;
precision highp usampler2DArray;

precision highp isampler2D;
precision highp isampler3D;
precision highp isamplerCube;
precision highp isampler2DArray;

precision lowp sampler2DShadow;
precision lowp sampler2DArrayShadow;
precision lowp samplerCubeShadow;
`;class u_e extends bX{constructor(e,t){super(e,t,new Iye),this.uniformGroups={},this.transforms=[],this.extensions={},this.builtins={vertex:[],fragment:[],compute:[]}}needsToWorkingColorSpace(e){return e.isVideoTexture===!0&&e.colorSpace!==Jo}_include(e){const t=UG[e];return t.build(this),this.addInclude(t),t}getMethod(e){return UG[e]!==void 0&&this._include(e),o_e[e]||e}getBitcastMethod(e,t){return this.getMethod(`bitcast_${t}_${e}`)}getFloatPackingMethod(e){return this.getMethod(`floatpack_${e}_2x16`)}getFloatUnpackingMethod(e){return this.getMethod(`floatunpack_${e}_2x16`)}getTernary(e,t,n){return`${e} ? ${t} : ${n}`}getOutputStructName(){return""}buildFunctionCode(e){const t=e.layout,n=this.flowShaderNode(e),i=[];for(const a of t.inputs)i.push(this.getType(a.type)+" "+a.name);return`${this.getType(t.type)} ${t.name}( ${i.join(", ")} ) {

	${n.vars}

${n.code}
	return ${n.result};

}`}setupPBO(e){const t=e.value;if(t.pbo===void 0){const n=t.array,i=t.count*t.itemSize,{itemSize:s}=t,a=t.array.constructor.name.toLowerCase().includes("int");let o=a?Bm:Pm;s===2?o=a?My:po:s===3?o=a?Rk:Fx:s===4&&(o=a?Ay:Qi);const l={Float32Array:Ci,Uint8Array:ir,Uint16Array:Zu,Uint32Array:Hi,Int8Array:_h,Int16Array:vh,Int32Array:Hs,Uint8ClampedArray:ir},c=Math.pow(2,Math.ceil(Math.log2(Math.sqrt(i/s))));let d=Math.ceil(i/s/c);c*d*s<i&&d++;const p=c*d*s,y=new n.constructor(p);y.set(n,0),t.array=y;const _=new Ol(t.array,c,d,o,l[t.array.constructor.name]||Ci);_.needsUpdate=!0,_.isPBOTexture=!0;const v=new gd(_,null,null);v.setPrecision("high"),t.pboNode=v,t.pbo=v.value,this.getUniformFromNode(t.pboNode,"texture",this.shaderStage,this.context.nodeName)}}getPropertyName(e,t=this.shaderStage){return e.isNodeUniform&&e.node.isTextureNode!==!0&&e.node.isBufferNode!==!0?t.charAt(0)+"_"+e.name:super.getPropertyName(e,t)}generatePBO(e){const{node:t,indexNode:n}=e,i=t.value;if(this.renderer.backend.has(i)){const d=this.renderer.backend.get(i);d.pbo=i.pbo}const s=this.getUniformFromNode(i.pboNode,"texture",this.shaderStage,this.context.nodeName),a=this.getPropertyName(s);this.increaseUsage(n);const o=n.build(this,"uint"),l=this.getDataFromNode(e);let c=l.propertyName;if(c===void 0){const d=this.getVarFromNode(e);c=this.getPropertyName(d);const p=this.getDataFromNode(t);let y=p.propertySizeName;y===void 0&&(y=c+"Size",this.getVarFromNode(t,y,"uint"),this.addLineFlowCode(`${y} = uint( textureSize( ${a}, 0 ).x )`,e),p.propertySizeName=y);const{itemSize:_}=i,v="."+Oy.join("").slice(0,_),b=`ivec2(${o} % ${y}, ${o} / ${y})`,E=this.generateTextureLoad(null,a,b,"0",null,null);let T="vec4";i.pbo.type===Hi?T="uvec4":i.pbo.type===Hs&&(T="ivec4"),this.addLineFlowCode(`${c} = ${T}(${E})${v}`,e),l.propertyName=c}return c}generateTextureLoad(e,t,n,i,s,a){i===null&&(i="0");let o;return s?a?o=`texelFetchOffset( ${t}, ivec3( ${n}, ${s} ), ${i}, ${a} )`:o=`texelFetch( ${t}, ivec3( ${n}, ${s} ), ${i} )`:a?o=`texelFetchOffset( ${t}, ${n}, ${i}, ${a} )`:o=`texelFetch( ${t}, ${n}, ${i} )`,e!==null&&e.isDepthTexture&&(o+=".x"),o}generateTexture(e,t,n,i,s){return i&&(n=`vec3( ${n}, ${i} )`),e.isDepthTexture?s?`textureOffset( ${t}, ${n}, ${s} ).x`:`texture( ${t}, ${n} ).x`:s?`textureOffset( ${t}, ${n}, ${s} )`:`texture( ${t}, ${n} )`}generateTextureLevel(e,t,n,i,s){return s?`textureLodOffset( ${t}, ${n}, ${i}, ${s} )`:`textureLod( ${t}, ${n}, ${i} )`}generateTextureBias(e,t,n,i,s){return s?`textureOffset( ${t}, ${n}, ${s}, ${i} )`:`texture( ${t}, ${n}, ${i} )`}generateTextureGrad(e,t,n,i,s){return s?`textureGradOffset( ${t}, ${n}, ${i[0]}, ${i[1]}, ${s} )`:`textureGrad( ${t}, ${n}, ${i[0]}, ${i[1]} )`}generateTextureCompare(e,t,n,i,s,a,o=this.shaderStage){if(o==="fragment")return e.isCubeTexture?`texture( ${t}, vec4( ${n}, ${i} ) )`:s?a?`textureOffset( ${t}, vec4( ${n}, ${s}, ${i} ), ${a} )`:`texture( ${t}, vec4( ${n}, ${s}, ${i} ) )`:a?`textureOffset( ${t}, vec3( ${n}, ${i} ), ${a} )`:`texture( ${t}, vec3( ${n}, ${i} ) )`;Ze(`WebGPURenderer: THREE.DepthTexture.compareFunction() does not support ${o} shader.`)}getVars(e){const t=[],n=this.vars[e];if(n!==void 0)for(const i of n)t.push(`${this.getVar(i.type,i.name,i.count)};`);return t.join(`
	`)}getUniforms(e){const t=this.uniforms[e],n=[],i={};for(const a of t){let o=null,l=!1;if(a.type==="texture"||a.type==="texture3D"){const d=a.node.value;let p="";(d.isDataTexture===!0||d.isData3DTexture===!0)&&(d.type===Hi?p="u":d.type===Hs&&(p="i")),a.type==="texture3D"&&d.isArrayTexture===!1?o=`${p}sampler3D ${a.name};`:d.compareFunction?d.isArrayTexture===!0?o=`sampler2DArrayShadow ${a.name};`:o=`sampler2DShadow ${a.name};`:d.isArrayTexture===!0||d.isDataArrayTexture===!0||d.isCompressedArrayTexture===!0?o=`${p}sampler2DArray ${a.name};`:o=`${p}sampler2D ${a.name};`}else if(a.type==="cubeTexture")o=`samplerCube ${a.name};`;else if(a.type==="cubeDepthTexture")o=`samplerCubeShadow ${a.name};`;else if(a.type==="buffer"){const d=a.node,p=this.getType(d.bufferType),y=d.bufferCount,_=y>0?y:"";o=`${d.name} {
	${p} ${a.name}[${_}];
};
`}else o=`${this.getVectorType(a.type)} ${this.getPropertyName(a,e)};`,l=!0;const c=a.node.precision;if(c!==null&&(o=l_e[c]+" "+o),l){o="	"+o;const d=a.groupNode.name;(i[d]||(i[d]=[])).push(o)}else o="uniform "+o,n.push(o)}let s="";for(const a in i){const o=i[a];s+=this._getGLSLUniformStruct(e+"_"+a,o.join(`
`))+`
`}return s+=n.join(`
`),s}getTypeFromAttribute(e){let t=super.getTypeFromAttribute(e);if(/^[iu]/.test(t)&&e.gpuType!==Hs){let n=e;e.isInterleavedBufferAttribute&&(n=e.data);const i=n.array;i instanceof Uint32Array||i instanceof Int32Array||(t=t.slice(1))}return t}getAttributes(e){let t="";if(e==="vertex"||e==="compute"){const n=this.getAttributesArray();let i=0;for(const s of n)t+=`layout( location = ${i++} ) in ${s.type} ${s.name};
`}return t}getStructMembers(e){const t=[];for(const n of e.members)t.push(`	${n.type} ${n.name};`);return t.join(`
`)}getStructs(e){const t=[],n=this.structs[e],i=[];for(const s of n)if(s.output)for(const a of s.members)i.push(`layout( location = ${a.index} ) out ${a.type} ${a.name};`);else{let a="struct "+s.name+` {
`;a+=this.getStructMembers(s),a+=`
};
`,t.push(a)}return i.length===0&&i.push("layout( location = 0 ) out vec4 fragColor;"),`
`+i.join(`
`)+`

`+t.join(`
`)}getVaryings(e){let t="";const n=this.varyings;if(e==="vertex"||e==="compute")for(const i of n){e==="compute"&&(i.needsInterpolation=!0);const s=this.getType(i.type);if(i.needsInterpolation)if(i.interpolationType){const a=PG[i.interpolationType]||i.interpolationType,o=BG[i.interpolationSampling]||"";t+=`${a} ${o} out ${s} ${i.name};
`}else{const a=s.includes("int")||s.includes("uv")||s.includes("iv")?"flat ":"";t+=`${a}out ${s} ${i.name};
`}else t+=`${s} ${i.name};
`}else if(e==="fragment"){for(const i of n)if(i.needsInterpolation){const s=this.getType(i.type);if(i.interpolationType){const a=PG[i.interpolationType]||i.interpolationType,o=BG[i.interpolationSampling]||"";t+=`${a} ${o} in ${s} ${i.name};
`}else{const a=s.includes("int")||s.includes("uv")||s.includes("iv")?"flat ":"";t+=`${a}in ${s} ${i.name};
`}}}for(const i of this.builtins[e])t+=`${i};
`;return t}getVertexIndex(){return"uint( gl_VertexID )"}getInstanceIndex(){return"uint( gl_InstanceID )"}getInvocationLocalIndex(){return`uint( gl_InstanceID ) % ${this.object.workgroupSize.reduce((n,i)=>n*i,1)}u`}getSubgroupSize(){Ze("GLSLNodeBuilder: WebGLBackend does not support the subgroupSize node")}getInvocationSubgroupIndex(){Ze("GLSLNodeBuilder: WebGLBackend does not support the invocationSubgroupIndex node")}getSubgroupIndex(){Ze("GLSLNodeBuilder: WebGLBackend does not support the subgroupIndex node")}getDrawIndex(){return this.renderer.backend.extensions.has("WEBGL_multi_draw")?"uint( gl_DrawID )":null}getFrontFacing(){return"gl_FrontFacing"}getFragCoord(){return"gl_FragCoord.xy"}getFragDepth(){return"gl_FragDepth"}enableExtension(e,t,n=this.shaderStage){const i=this.extensions[n]||(this.extensions[n]=new Map);i.has(e)===!1&&i.set(e,{name:e,behavior:t})}getExtensions(e){const t=[];if(e==="vertex"){const i=this.renderer.backend.extensions;this.object.isBatchedMesh&&i.has("WEBGL_multi_draw")&&this.enableExtension("GL_ANGLE_multi_draw","require",e)}const n=this.extensions[e];if(n!==void 0)for(const{name:i,behavior:s}of n.values())t.push(`#extension ${i} : ${s}`);return t.join(`
`)}getClipDistance(){return"gl_ClipDistance"}isAvailable(e){let t=LG[e];if(t===void 0){let n;switch(t=!1,e){case"float32Filterable":n="OES_texture_float_linear";break;case"clipDistance":n="WEBGL_clip_cull_distance";break}if(n!==void 0){const i=this.renderer.backend.extensions;i.has(n)&&(i.get(n),t=!0)}LG[e]=t}return t}isFlipY(){return!0}enableHardwareClipping(e){this.enableExtension("GL_ANGLE_clip_cull_distance","require"),this.builtins.vertex.push(`out float gl_ClipDistance[ ${e} ]`)}enableMultiview(){this.enableExtension("GL_OVR_multiview2","require","fragment"),this.enableExtension("GL_OVR_multiview2","require","vertex"),this.builtins.vertex.push("layout(num_views = 2) in")}registerTransform(e,t){this.transforms.push({varyingName:e,attributeNode:t})}getTransforms(){const e=this.transforms;let t="";for(let n=0;n<e.length;n++){const i=e[n],s=this.getPropertyName(i.attributeNode);s&&(t+=`${i.varyingName} = ${s};
	`)}return t}_getGLSLUniformStruct(e,t){return`
layout( std140 ) uniform ${e} {
${t}
};`}_getGLSLVertexCode(e){return`#version 300 es

${this.getSignature()}

// extensions
${e.extensions}

// precision
${IG}

// uniforms
${e.uniforms}

// varyings
${e.varyings}

// attributes
${e.attributes}

// codes
${e.codes}

void main() {

	// vars
	${e.vars}

	// transforms
	${e.transforms}

	// flow
	${e.flow}

	gl_PointSize = 1.0;

}
`}_getGLSLFragmentCode(e){return`#version 300 es

${this.getSignature()}

// extensions
${e.extensions}

// precision
${IG}

// structs
${e.structs}

// uniforms
${e.uniforms}

// varyings
${e.varyings}

// codes
${e.codes}

void main() {

	// vars
	${e.vars}

	// flow
	${e.flow}

}
`}buildCode(){const e=this.material!==null?{fragment:{},vertex:{}}:{compute:{}};this.sortBindingGroups();for(const t in e){let n=`// code

`;n+=this.flowCode[t];const i=this.flowNodes[t],s=i[i.length-1];for(const o of i){const l=this.getFlowData(o),c=o.name;c&&(n.length>0&&(n+=`
`),n+=`	// flow -> ${c}
	`),n+=`${l.code}
	`,o===s&&t!=="compute"&&(n+=`// result
	`,t==="vertex"?(n+="gl_Position = ",n+=`${l.result};`):t==="fragment"&&(o.outputNode.isOutputStructNode||(n+="fragColor = ",n+=`${l.result};`)))}const a=e[t];a.extensions=this.getExtensions(t),a.uniforms=this.getUniforms(t),a.attributes=this.getAttributes(t),a.varyings=this.getVaryings(t),a.vars=this.getVars(t),a.structs=this.getStructs(t),a.codes=this.getCodes(t),a.transforms=this.getTransforms(t),a.flow=n}this.material!==null?(this.vertexShader=this._getGLSLVertexCode(e.vertex),this.fragmentShader=this._getGLSLFragmentCode(e.fragment)):this.computeShader=this._getGLSLVertexCode(e.compute)}getUniformFromNode(e,t,n,i=null){const s=super.getUniformFromNode(e,t,n,i),a=this.getDataFromNode(e,n,this.globalCache);let o=a.uniformGPU;if(o===void 0){const l=e.groupNode,c=l.name,d=this.getBindGroupArray(c,n);if(t==="texture")o=new LN(s.name,s.node,l),d.push(o);else if(t==="cubeTexture"||t==="cubeDepthTexture")o=new NX(s.name,s.node,l),d.push(o);else if(t==="texture3D")o=new xU(s.name,s.node,l),d.push(o);else if(t==="buffer"){s.name=`buffer${e.id}`;const p=this.getSharedDataFromNode(e);let y=p.buffer;y===void 0&&(e.name=`NodeBuffer_${e.id}`,y=new wX(e,l),y.name=e.name,p.buffer=y),d.push(y),o=y}else{const p=this.uniformGroups[n]||(this.uniformGroups[n]={});let y=p[c];y===void 0&&(y=new RX(n+"_"+c,l),p[c]=y,d.push(y)),o=this.getNodeUniform(s,t),y.addUniform(o)}a.uniformGPU=o}return s}}let CD=null,Mv=null;class DX{constructor(e={}){this.parameters=Object.assign({},e),this.data=new WeakMap,this.renderer=null,this.domElement=null,this.timestampQueryPool={[Yc.RENDER]:null,[Yc.COMPUTE]:null},this.trackTimestamp=e.trackTimestamp===!0}async init(e){this.renderer=e}get coordinateSystem(){}beginRender(){}finishRender(){}beginCompute(){}finishCompute(){}draw(){}compute(){}createProgram(){}destroyProgram(){}createBindings(){}updateBindings(){}updateBinding(){}createRenderPipeline(){}createComputePipeline(){}needsRenderUpdate(){}getRenderCacheKey(){}createNodeBuilder(){}updateSampler(){}createDefaultTexture(){}createTexture(){}updateTexture(){}generateMipmaps(){}destroyTexture(){}async copyTextureToBuffer(){}copyTextureToTexture(){}copyFramebufferToTexture(){}createAttribute(){}createIndexAttribute(){}createStorageAttribute(){}updateAttribute(){}destroyAttribute(){}getContext(){}updateSize(){}updateViewport(){}updateTimeStampUID(e){const t=this.get(e),n=this.renderer.info.frame;let i;e.isComputeNode===!0?i="c:"+this.renderer.info.compute.frameCalls:i="r:"+this.renderer.info.render.frameCalls,t.timestampUID=i+":"+e.id+":f"+n}getTimestampUID(e){return this.get(e).timestampUID}getTimestampFrames(e){const t=this.timestampQueryPool[e];return t?t.getTimestampFrames():[]}_getQueryPool(e){const t=e.startsWith("c:")?Yc.COMPUTE:Yc.RENDER;return this.timestampQueryPool[t]}getTimestamp(e){return this._getQueryPool(e).getTimestamp(e)}hasTimestamp(e){return this._getQueryPool(e).hasTimestamp(e)}isOccluded(){}async resolveTimestampsAsync(e="render"){if(!this.trackTimestamp){cr("WebGPURenderer: Timestamp tracking is disabled.");return}const t=this.timestampQueryPool[e];if(!t)return;const n=await t.resolveQueriesAsync();return this.renderer.info[e].timestamp=n,n}async getArrayBufferAsync(){}async hasFeatureAsync(){}hasFeature(){}getMaxAnisotropy(){}getDrawingBufferSize(){return CD=CD||new tt,this.renderer.getDrawingBufferSize(CD)}setScissorTest(){}getClearColor(){const e=this.renderer;return Mv=Mv||new XB,e.getClearColor(Mv),Mv.getRGB(Mv),Mv}getDomElement(){let e=this.domElement;return e===null&&(e=this.parameters.canvas!==void 0?this.parameters.canvas:sL(),"setAttribute"in e&&e.setAttribute("data-engine",`three.js r${Lm} webgpu`),this.domElement=e),e}set(e,t){this.data.set(e,t)}get(e){let t=this.data.get(e);return t===void 0&&(t={},this.data.set(e,t)),t}has(e){return this.data.has(e)}delete(e){this.data.delete(e)}deleteBindGroupData(){}dispose(){}}let c_e=0;class f_e{constructor(e,t){this.buffers=[e.bufferGPU,t],this.type=e.type,this.bufferType=e.bufferType,this.pbo=e.pbo,this.byteLength=e.byteLength,this.bytesPerElement=e.BYTES_PER_ELEMENT,this.version=e.version,this.isInteger=e.isInteger,this.activeBufferIndex=0,this.baseId=e.id}get id(){return`${this.baseId}|${this.activeBufferIndex}`}get bufferGPU(){return this.buffers[this.activeBufferIndex]}get transformBuffer(){return this.buffers[this.activeBufferIndex^1]}switchBuffers(){this.activeBufferIndex^=1}}class d_e{constructor(e){this.backend=e}createAttribute(e,t){const n=this.backend,{gl:i}=n,s=e.array,a=e.usage||i.STATIC_DRAW,o=e.isInterleavedBufferAttribute?e.data:e,l=n.get(o);let c=l.bufferGPU;c===void 0&&(c=this._createBuffer(i,t,s,a),l.bufferGPU=c,l.bufferType=t,l.version=o.version);let d;if(s instanceof Float32Array)d=i.FLOAT;else if(typeof Float16Array<"u"&&s instanceof Float16Array)d=i.HALF_FLOAT;else if(s instanceof Uint16Array)e.isFloat16BufferAttribute?d=i.HALF_FLOAT:d=i.UNSIGNED_SHORT;else if(s instanceof Int16Array)d=i.SHORT;else if(s instanceof Uint32Array)d=i.UNSIGNED_INT;else if(s instanceof Int32Array)d=i.INT;else if(s instanceof Int8Array)d=i.BYTE;else if(s instanceof Uint8Array)d=i.UNSIGNED_BYTE;else if(s instanceof Uint8ClampedArray)d=i.UNSIGNED_BYTE;else throw new Error("THREE.WebGLBackend: Unsupported buffer data format: "+s);let p={bufferGPU:c,bufferType:t,type:d,byteLength:s.byteLength,bytesPerElement:s.BYTES_PER_ELEMENT,version:e.version,pbo:e.pbo,isInteger:d===i.INT||d===i.UNSIGNED_INT||e.gpuType===Hs,id:c_e++};if(e.isStorageBufferAttribute||e.isStorageInstancedBufferAttribute){const y=this._createBuffer(i,t,s,a);p=new f_e(p,y)}n.set(e,p)}updateAttribute(e){const t=this.backend,{gl:n}=t,i=e.array,s=e.isInterleavedBufferAttribute?e.data:e,a=t.get(s),o=a.bufferType,l=e.isInterleavedBufferAttribute?e.data.updateRanges:e.updateRanges;if(n.bindBuffer(o,a.bufferGPU),l.length===0)n.bufferSubData(o,0,i);else{for(let c=0,d=l.length;c<d;c++){const p=l[c];n.bufferSubData(o,p.start*i.BYTES_PER_ELEMENT,i,p.start,p.count)}s.clearUpdateRanges()}n.bindBuffer(o,null),a.version=s.version}destroyAttribute(e){const t=this.backend,{gl:n}=t;e.isInterleavedBufferAttribute&&t.delete(e.data);const i=t.get(e);n.deleteBuffer(i.bufferGPU),t.delete(e)}async getArrayBufferAsync(e){const t=this.backend,{gl:n}=t,i=e.isInterleavedBufferAttribute?e.data:e,{bufferGPU:s}=t.get(i),a=e.array,o=a.byteLength;n.bindBuffer(n.COPY_READ_BUFFER,s);const l=n.createBuffer();n.bindBuffer(n.COPY_WRITE_BUFFER,l),n.bufferData(n.COPY_WRITE_BUFFER,o,n.STREAM_READ),n.copyBufferSubData(n.COPY_READ_BUFFER,n.COPY_WRITE_BUFFER,0,0,o),await t.utils._clientWaitAsync();const c=new e.array.constructor(a.length);return n.bindBuffer(n.COPY_WRITE_BUFFER,l),n.getBufferSubData(n.COPY_WRITE_BUFFER,0,c),n.deleteBuffer(l),n.bindBuffer(n.COPY_READ_BUFFER,null),n.bindBuffer(n.COPY_WRITE_BUFFER,null),c.buffer}_createBuffer(e,t,n,i){const s=e.createBuffer();return e.bindBuffer(t,s),e.bufferData(t,n,i),e.bindBuffer(t,null),s}}let ND,aT;class h_e{constructor(e){this.backend=e,this.gl=this.backend.gl,this.enabled={},this.currentFlipSided=null,this.currentCullFace=null,this.currentProgram=null,this.currentBlendingEnabled=!1,this.currentBlending=null,this.currentBlendSrc=null,this.currentBlendDst=null,this.currentBlendSrcAlpha=null,this.currentBlendDstAlpha=null,this.currentPremultipledAlpha=null,this.currentPolygonOffsetFactor=null,this.currentPolygonOffsetUnits=null,this.currentColorMask=null,this.currentDepthFunc=null,this.currentDepthMask=null,this.currentStencilFunc=null,this.currentStencilRef=null,this.currentStencilFuncMask=null,this.currentStencilFail=null,this.currentStencilZFail=null,this.currentStencilZPass=null,this.currentStencilMask=null,this.currentLineWidth=null,this.currentClippingPlanes=0,this.currentVAO=null,this.currentIndex=null,this.currentBoundFramebuffers={},this.currentDrawbuffers=new WeakMap,this.maxTextures=this.gl.getParameter(this.gl.MAX_TEXTURE_IMAGE_UNITS),this.currentTextureSlot=null,this.currentBoundTextures={},this.currentBoundBufferBases={},this._init()}_init(){const e=this.gl;ND={[La]:e.FUNC_ADD,[eC]:e.FUNC_SUBTRACT,[tC]:e.FUNC_REVERSE_SUBTRACT},aT={[Qf]:e.ZERO,[nC]:e.ONE,[iC]:e.SRC_COLOR,[nx]:e.SRC_ALPHA,[uC]:e.SRC_ALPHA_SATURATE,[oC]:e.DST_COLOR,[sC]:e.DST_ALPHA,[rC]:e.ONE_MINUS_SRC_COLOR,[ix]:e.ONE_MINUS_SRC_ALPHA,[lC]:e.ONE_MINUS_DST_COLOR,[aC]:e.ONE_MINUS_DST_ALPHA};const t=e.getParameter(e.SCISSOR_BOX),n=e.getParameter(e.VIEWPORT);this.currentScissor=new zn().fromArray(t),this.currentViewport=new zn().fromArray(n),this._tempVec4=new zn}enable(e){const{enabled:t}=this;t[e]!==!0&&(this.gl.enable(e),t[e]=!0)}disable(e){const{enabled:t}=this;t[e]!==!1&&(this.gl.disable(e),t[e]=!1)}setFlipSided(e){if(this.currentFlipSided!==e){const{gl:t}=this;e?t.frontFace(t.CW):t.frontFace(t.CCW),this.currentFlipSided=e}}setCullFace(e){const{gl:t}=this;e!==$U?(this.enable(t.CULL_FACE),e!==this.currentCullFace&&(e===$w?t.cullFace(t.BACK):e===jU?t.cullFace(t.FRONT):t.cullFace(t.FRONT_AND_BACK))):this.disable(t.CULL_FACE),this.currentCullFace=e}setLineWidth(e){const{currentLineWidth:t,gl:n}=this;e!==t&&(n.lineWidth(e),this.currentLineWidth=e)}setMRTBlending(e){const t=this.gl,n=this.backend.drawBuffersIndexedExt;if(n)for(let i=1;i<e.length;i++)n.blendFuncSeparateiOES(i,t.ONE,t.ZERO,t.ONE,t.ZERO)}setBlending(e,t,n,i,s,a,o,l){const{gl:c}=this;if(e===yo){this.currentBlendingEnabled===!0&&(this.disable(c.BLEND),this.currentBlendingEnabled=!1);return}if(this.currentBlendingEnabled===!1&&(this.enable(c.BLEND),this.currentBlendingEnabled=!0),e!==A0){if(e!==this.currentBlending||l!==this.currentPremultipledAlpha){if((this.currentBlendEquation!==La||this.currentBlendEquationAlpha!==La)&&(c.blendEquation(c.FUNC_ADD),this.currentBlendEquation=La,this.currentBlendEquationAlpha=La),l)switch(e){case Nl:c.blendFuncSeparate(c.ONE,c.ONE_MINUS_SRC_ALPHA,c.ONE,c.ONE_MINUS_SRC_ALPHA);break;case V0:c.blendFunc(c.ONE,c.ONE);break;case G0:c.blendFuncSeparate(c.ZERO,c.ONE_MINUS_SRC_COLOR,c.ZERO,c.ONE);break;case k0:c.blendFuncSeparate(c.DST_COLOR,c.ONE_MINUS_SRC_ALPHA,c.ZERO,c.ONE);break;default:Ze("WebGLState: Invalid blending: ",e);break}else switch(e){case Nl:c.blendFuncSeparate(c.SRC_ALPHA,c.ONE_MINUS_SRC_ALPHA,c.ONE,c.ONE_MINUS_SRC_ALPHA);break;case V0:c.blendFuncSeparate(c.SRC_ALPHA,c.ONE,c.ONE,c.ONE);break;case G0:Ze("WebGLState: SubtractiveBlending requires material.premultipliedAlpha = true");break;case k0:Ze("WebGLState: MultiplyBlending requires material.premultipliedAlpha = true");break;default:Ze("WebGLState: Invalid blending: ",e);break}this.currentBlendSrc=null,this.currentBlendDst=null,this.currentBlendSrcAlpha=null,this.currentBlendDstAlpha=null,this.currentBlending=e,this.currentPremultipledAlpha=l}return}s=s||t,a=a||n,o=o||i,(t!==this.currentBlendEquation||s!==this.currentBlendEquationAlpha)&&(c.blendEquationSeparate(ND[t],ND[s]),this.currentBlendEquation=t,this.currentBlendEquationAlpha=s),(n!==this.currentBlendSrc||i!==this.currentBlendDst||a!==this.currentBlendSrcAlpha||o!==this.currentBlendDstAlpha)&&(c.blendFuncSeparate(aT[n],aT[i],aT[a],aT[o]),this.currentBlendSrc=n,this.currentBlendDst=i,this.currentBlendSrcAlpha=a,this.currentBlendDstAlpha=o),this.currentBlending=e,this.currentPremultipledAlpha=!1}setColorMask(e){this.currentColorMask!==e&&(this.gl.colorMask(e,e,e,e),this.currentColorMask=e)}setDepthTest(e){const{gl:t}=this;e?this.enable(t.DEPTH_TEST):this.disable(t.DEPTH_TEST)}setDepthMask(e){this.currentDepthMask!==e&&(this.gl.depthMask(e),this.currentDepthMask=e)}setDepthFunc(e){if(this.currentDepthFunc!==e){const{gl:t}=this;switch(e){case rx:t.depthFunc(t.NEVER);break;case sx:t.depthFunc(t.ALWAYS);break;case ax:t.depthFunc(t.LESS);break;case Oh:t.depthFunc(t.LEQUAL);break;case ox:t.depthFunc(t.EQUAL);break;case lx:t.depthFunc(t.GEQUAL);break;case ux:t.depthFunc(t.GREATER);break;case cx:t.depthFunc(t.NOTEQUAL);break;default:t.depthFunc(t.LEQUAL)}this.currentDepthFunc=e}}scissor(e,t,n,i){const s=this._tempVec4.set(e,t,n,i);if(this.currentScissor.equals(s)===!1){const{gl:a}=this;a.scissor(s.x,s.y,s.z,s.w),this.currentScissor.copy(s)}}viewport(e,t,n,i){const s=this._tempVec4.set(e,t,n,i);if(this.currentViewport.equals(s)===!1){const{gl:a}=this;a.viewport(s.x,s.y,s.z,s.w),this.currentViewport.copy(s)}}setScissorTest(e){const t=this.gl;e?this.enable(t.SCISSOR_TEST):this.disable(t.SCISSOR_TEST)}setStencilTest(e){const{gl:t}=this;e?this.enable(t.STENCIL_TEST):this.disable(t.STENCIL_TEST)}setStencilMask(e){this.currentStencilMask!==e&&(this.gl.stencilMask(e),this.currentStencilMask=e)}setStencilFunc(e,t,n){(this.currentStencilFunc!==e||this.currentStencilRef!==t||this.currentStencilFuncMask!==n)&&(this.gl.stencilFunc(e,t,n),this.currentStencilFunc=e,this.currentStencilRef=t,this.currentStencilFuncMask=n)}setStencilOp(e,t,n){(this.currentStencilFail!==e||this.currentStencilZFail!==t||this.currentStencilZPass!==n)&&(this.gl.stencilOp(e,t,n),this.currentStencilFail=e,this.currentStencilZFail=t,this.currentStencilZPass=n)}setMaterial(e,t,n){const{gl:i}=this;e.side===xa?this.disable(i.CULL_FACE):this.enable(i.CULL_FACE);let s=e.side===gr;t&&(s=!s),this.setFlipSided(s),e.blending===Nl&&e.transparent===!1?this.setBlending(yo):this.setBlending(e.blending,e.blendEquation,e.blendSrc,e.blendDst,e.blendEquationAlpha,e.blendSrcAlpha,e.blendDstAlpha,e.premultipliedAlpha),this.setDepthFunc(e.depthFunc),this.setDepthTest(e.depthTest),this.setDepthMask(e.depthWrite),this.setColorMask(e.colorWrite);const a=e.stencilWrite;if(this.setStencilTest(a),a&&(this.setStencilMask(e.stencilWriteMask),this.setStencilFunc(e.stencilFunc,e.stencilRef,e.stencilFuncMask),this.setStencilOp(e.stencilFail,e.stencilZFail,e.stencilZPass)),this.setPolygonOffset(e.polygonOffset,e.polygonOffsetFactor,e.polygonOffsetUnits),e.alphaToCoverage===!0&&this.backend.renderer.currentSamples>0?this.enable(i.SAMPLE_ALPHA_TO_COVERAGE):this.disable(i.SAMPLE_ALPHA_TO_COVERAGE),n>0&&this.currentClippingPlanes!==n)for(let l=0;l<8;l++)l<n?this.enable(12288+l):this.disable(12288+l)}setPolygonOffset(e,t,n){const{gl:i}=this;e?(this.enable(i.POLYGON_OFFSET_FILL),(this.currentPolygonOffsetFactor!==t||this.currentPolygonOffsetUnits!==n)&&(i.polygonOffset(t,n),this.currentPolygonOffsetFactor=t,this.currentPolygonOffsetUnits=n)):this.disable(i.POLYGON_OFFSET_FILL)}useProgram(e){return this.currentProgram!==e?(this.gl.useProgram(e),this.currentProgram=e,!0):!1}setVertexState(e,t=null){const n=this.gl;return this.currentVAO!==e||this.currentIndex!==t?(n.bindVertexArray(e),t!==null&&n.bindBuffer(n.ELEMENT_ARRAY_BUFFER,t),this.currentVAO=e,this.currentIndex=t,!0):!1}resetVertexState(){const e=this.gl;e.bindVertexArray(null),e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,null),this.currentVAO=null,this.currentIndex=null}bindFramebuffer(e,t){const{gl:n,currentBoundFramebuffers:i}=this;return i[e]!==t?(n.bindFramebuffer(e,t),i[e]=t,e===n.DRAW_FRAMEBUFFER&&(i[n.FRAMEBUFFER]=t),e===n.FRAMEBUFFER&&(i[n.DRAW_FRAMEBUFFER]=t),!0):!1}drawBuffers(e,t){const{gl:n}=this;let i=[],s=!1;if(e.textures!==null){i=this.currentDrawbuffers.get(t),i===void 0&&(i=[],this.currentDrawbuffers.set(t,i));const a=e.textures;if(i.length!==a.length||i[0]!==n.COLOR_ATTACHMENT0){for(let o=0,l=a.length;o<l;o++)i[o]=n.COLOR_ATTACHMENT0+o;i.length=a.length,s=!0}}else i[0]!==n.BACK&&(i[0]=n.BACK,s=!0);s&&n.drawBuffers(i)}activeTexture(e){const{gl:t,currentTextureSlot:n,maxTextures:i}=this;e===void 0&&(e=t.TEXTURE0+i-1),n!==e&&(t.activeTexture(e),this.currentTextureSlot=e)}bindTexture(e,t,n){const{gl:i,currentTextureSlot:s,currentBoundTextures:a,maxTextures:o}=this;n===void 0&&(s===null?n=i.TEXTURE0+o-1:n=s);let l=a[n];l===void 0&&(l={type:void 0,texture:void 0},a[n]=l),(l.type!==e||l.texture!==t)&&(s!==n&&(i.activeTexture(n),this.currentTextureSlot=n),i.bindTexture(e,t),l.type=e,l.texture=t)}bindBufferBase(e,t,n){const{gl:i}=this,s=`${e}-${t}`;return this.currentBoundBufferBases[s]!==n?(i.bindBufferBase(e,t,n),this.currentBoundBufferBases[s]=n,!0):!1}unbindTexture(){const{gl:e,currentTextureSlot:t,currentBoundTextures:n}=this,i=n[t];i!==void 0&&i.type!==void 0&&(e.bindTexture(i.type,null),i.type=void 0,i.texture=void 0)}}class p_e{constructor(e){this.backend=e,this.gl=this.backend.gl,this.extensions=e.extensions}convert(e,t=Jo){const{gl:n,extensions:i}=this;let s;const a=Nn.getTransfer(t);if(e===ir)return n.UNSIGNED_BYTE;if(e===B1)return n.UNSIGNED_SHORT_4_4_4_4;if(e===I1)return n.UNSIGNED_SHORT_5_5_5_1;if(e===F1)return n.UNSIGNED_INT_5_9_9_9_REV;if(e===z1)return n.UNSIGNED_INT_10F_11F_11F_REV;if(e===_h)return n.BYTE;if(e===vh)return n.SHORT;if(e===Zu)return n.UNSIGNED_SHORT;if(e===Hs)return n.INT;if(e===Hi)return n.UNSIGNED_INT;if(e===Ci)return n.FLOAT;if(e===vi)return n.HALF_FLOAT;if(e===mC)return n.ALPHA;if(e===Fx)return n.RGB;if(e===Qi)return n.RGBA;if(e===ba)return n.DEPTH_COMPONENT;if(e===ho)return n.DEPTH_STENCIL;if(e===Pm)return n.RED;if(e===Bm)return n.RED_INTEGER;if(e===po)return n.RG;if(e===My)return n.RG_INTEGER;if(e===Ay)return n.RGBA_INTEGER;if(e===xh||e===bh||e===Sh||e===Th)if(a===an)if(s=i.get("WEBGL_compressed_texture_s3tc_srgb"),s!==null){if(e===xh)return s.COMPRESSED_SRGB_S3TC_DXT1_EXT;if(e===bh)return s.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT;if(e===Sh)return s.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT;if(e===Th)return s.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT}else return null;else if(s=i.get("WEBGL_compressed_texture_s3tc"),s!==null){if(e===xh)return s.COMPRESSED_RGB_S3TC_DXT1_EXT;if(e===bh)return s.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(e===Sh)return s.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(e===Th)return s.COMPRESSED_RGBA_S3TC_DXT5_EXT}else return null;if(e===fx||e===dx||e===hx||e===px)if(s=i.get("WEBGL_compressed_texture_pvrtc"),s!==null){if(e===fx)return s.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(e===dx)return s.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(e===hx)return s.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(e===px)return s.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}else return null;if(e===H0||e===W0||e===q0||e===X0||e===$0||e===_m||e===j0)if(s=i.get("WEBGL_compressed_texture_etc"),s!==null){if(e===H0||e===W0)return a===an?s.COMPRESSED_SRGB8_ETC2:s.COMPRESSED_RGB8_ETC2;if(e===q0)return a===an?s.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC:s.COMPRESSED_RGBA8_ETC2_EAC;if(e===X0)return s.COMPRESSED_R11_EAC;if(e===$0)return s.COMPRESSED_SIGNED_R11_EAC;if(e===_m)return s.COMPRESSED_RG11_EAC;if(e===j0)return s.COMPRESSED_SIGNED_RG11_EAC}else return null;if(e===Y0||e===Z0||e===K0||e===Q0||e===J0||e===ey||e===ty||e===ny||e===iy||e===ry||e===sy||e===ay||e===oy||e===ly)if(s=i.get("WEBGL_compressed_texture_astc"),s!==null){if(e===Y0)return a===an?s.COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR:s.COMPRESSED_RGBA_ASTC_4x4_KHR;if(e===Z0)return a===an?s.COMPRESSED_SRGB8_ALPHA8_ASTC_5x4_KHR:s.COMPRESSED_RGBA_ASTC_5x4_KHR;if(e===K0)return a===an?s.COMPRESSED_SRGB8_ALPHA8_ASTC_5x5_KHR:s.COMPRESSED_RGBA_ASTC_5x5_KHR;if(e===Q0)return a===an?s.COMPRESSED_SRGB8_ALPHA8_ASTC_6x5_KHR:s.COMPRESSED_RGBA_ASTC_6x5_KHR;if(e===J0)return a===an?s.COMPRESSED_SRGB8_ALPHA8_ASTC_6x6_KHR:s.COMPRESSED_RGBA_ASTC_6x6_KHR;if(e===ey)return a===an?s.COMPRESSED_SRGB8_ALPHA8_ASTC_8x5_KHR:s.COMPRESSED_RGBA_ASTC_8x5_KHR;if(e===ty)return a===an?s.COMPRESSED_SRGB8_ALPHA8_ASTC_8x6_KHR:s.COMPRESSED_RGBA_ASTC_8x6_KHR;if(e===ny)return a===an?s.COMPRESSED_SRGB8_ALPHA8_ASTC_8x8_KHR:s.COMPRESSED_RGBA_ASTC_8x8_KHR;if(e===iy)return a===an?s.COMPRESSED_SRGB8_ALPHA8_ASTC_10x5_KHR:s.COMPRESSED_RGBA_ASTC_10x5_KHR;if(e===ry)return a===an?s.COMPRESSED_SRGB8_ALPHA8_ASTC_10x6_KHR:s.COMPRESSED_RGBA_ASTC_10x6_KHR;if(e===sy)return a===an?s.COMPRESSED_SRGB8_ALPHA8_ASTC_10x8_KHR:s.COMPRESSED_RGBA_ASTC_10x8_KHR;if(e===ay)return a===an?s.COMPRESSED_SRGB8_ALPHA8_ASTC_10x10_KHR:s.COMPRESSED_RGBA_ASTC_10x10_KHR;if(e===oy)return a===an?s.COMPRESSED_SRGB8_ALPHA8_ASTC_12x10_KHR:s.COMPRESSED_RGBA_ASTC_12x10_KHR;if(e===ly)return a===an?s.COMPRESSED_SRGB8_ALPHA8_ASTC_12x12_KHR:s.COMPRESSED_RGBA_ASTC_12x12_KHR}else return null;if(e===uy)if(s=i.get("EXT_texture_compression_bptc"),s!==null){if(e===uy)return a===an?s.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT:s.COMPRESSED_RGBA_BPTC_UNORM_EXT}else return null;if(e===cy||e===fy||e===vm||e===dy)if(s=i.get("EXT_texture_compression_rgtc"),s!==null){if(e===cy)return s.COMPRESSED_RED_RGTC1_EXT;if(e===fy)return s.COMPRESSED_SIGNED_RED_RGTC1_EXT;if(e===vm)return s.COMPRESSED_RED_GREEN_RGTC2_EXT;if(e===dy)return s.COMPRESSED_SIGNED_RED_GREEN_RGTC2_EXT}else return null;return e===Dl?n.UNSIGNED_INT_24_8:n[e]!==void 0?n[e]:null}_clientWaitAsync(){const{gl:e}=this,t=e.fenceSync(e.SYNC_GPU_COMMANDS_COMPLETE,0);return e.flush(),new Promise((n,i)=>{function s(){const a=e.clientWaitSync(t,e.SYNC_FLUSH_COMMANDS_BIT,0);if(a===e.WAIT_FAILED){e.deleteSync(t),i();return}if(a===e.TIMEOUT_EXPIRED){requestAnimationFrame(s);return}e.deleteSync(t),n()}s()})}}let FG=!1,fw,DD,zG;class m_e{constructor(e){this.backend=e,this.gl=e.gl,this.extensions=e.extensions,this.defaultTextures={},this._srcFramebuffer=null,this._dstFramebuffer=null,FG===!1&&(this._init(),FG=!0)}_init(){const e=this.gl;fw={[Bh]:e.REPEAT,[Dr]:e.CLAMP_TO_EDGE,[Ih]:e.MIRRORED_REPEAT},DD={[Ki]:e.NEAREST,[P1]:e.NEAREST_MIPMAP_NEAREST,[jc]:e.NEAREST_MIPMAP_LINEAR,[ei]:e.LINEAR,[dm]:e.LINEAR_MIPMAP_NEAREST,[Pa]:e.LINEAR_MIPMAP_LINEAR},zG={[yC]:e.NEVER,[bC]:e.ALWAYS,[zx]:e.LESS,[Vx]:e.LEQUAL,[_C]:e.EQUAL,[Gx]:e.GEQUAL,[vC]:e.GREATER,[xC]:e.NOTEQUAL}}getGLTextureType(e){const{gl:t}=this;let n;return e.isCubeTexture===!0?n=t.TEXTURE_CUBE_MAP:e.isArrayTexture===!0||e.isDataArrayTexture===!0||e.isCompressedArrayTexture===!0?n=t.TEXTURE_2D_ARRAY:e.isData3DTexture===!0?n=t.TEXTURE_3D:n=t.TEXTURE_2D,n}getInternalFormat(e,t,n,i,s=!1){const{gl:a,extensions:o}=this;if(e!==null){if(a[e]!==void 0)return a[e];Ve("WebGLBackend: Attempt to use non-existing WebGL internal format '"+e+"'")}let l=t;if(t===a.RED&&(n===a.FLOAT&&(l=a.R32F),n===a.HALF_FLOAT&&(l=a.R16F),n===a.UNSIGNED_BYTE&&(l=a.R8),n===a.UNSIGNED_SHORT&&(l=a.R16),n===a.UNSIGNED_INT&&(l=a.R32UI),n===a.BYTE&&(l=a.R8I),n===a.SHORT&&(l=a.R16I),n===a.INT&&(l=a.R32I)),t===a.RED_INTEGER&&(n===a.UNSIGNED_BYTE&&(l=a.R8UI),n===a.UNSIGNED_SHORT&&(l=a.R16UI),n===a.UNSIGNED_INT&&(l=a.R32UI),n===a.BYTE&&(l=a.R8I),n===a.SHORT&&(l=a.R16I),n===a.INT&&(l=a.R32I)),t===a.RG&&(n===a.FLOAT&&(l=a.RG32F),n===a.HALF_FLOAT&&(l=a.RG16F),n===a.UNSIGNED_BYTE&&(l=a.RG8),n===a.UNSIGNED_SHORT&&(l=a.RG16),n===a.UNSIGNED_INT&&(l=a.RG32UI),n===a.BYTE&&(l=a.RG8I),n===a.SHORT&&(l=a.RG16I),n===a.INT&&(l=a.RG32I)),t===a.RG_INTEGER&&(n===a.UNSIGNED_BYTE&&(l=a.RG8UI),n===a.UNSIGNED_SHORT&&(l=a.RG16UI),n===a.UNSIGNED_INT&&(l=a.RG32UI),n===a.BYTE&&(l=a.RG8I),n===a.SHORT&&(l=a.RG16I),n===a.INT&&(l=a.RG32I)),t===a.RGB){const c=s?hy:Nn.getTransfer(i);n===a.FLOAT&&(l=a.RGB32F),n===a.HALF_FLOAT&&(l=a.RGB16F),n===a.UNSIGNED_BYTE&&(l=a.RGB8),n===a.UNSIGNED_SHORT&&(l=a.RGB16),n===a.UNSIGNED_INT&&(l=a.RGB32UI),n===a.BYTE&&(l=a.RGB8I),n===a.SHORT&&(l=a.RGB16I),n===a.INT&&(l=a.RGB32I),n===a.UNSIGNED_BYTE&&(l=c===an?a.SRGB8:a.RGB8),n===a.UNSIGNED_SHORT_5_6_5&&(l=a.RGB565),n===a.UNSIGNED_SHORT_5_5_5_1&&(l=a.RGB5_A1),n===a.UNSIGNED_SHORT_4_4_4_4&&(l=a.RGB4),n===a.UNSIGNED_INT_5_9_9_9_REV&&(l=a.RGB9_E5),n===a.UNSIGNED_INT_10F_11F_11F_REV&&(l=a.R11F_G11F_B10F)}if(t===a.RGB_INTEGER&&(n===a.UNSIGNED_BYTE&&(l=a.RGB8UI),n===a.UNSIGNED_SHORT&&(l=a.RGB16UI),n===a.UNSIGNED_INT&&(l=a.RGB32UI),n===a.BYTE&&(l=a.RGB8I),n===a.SHORT&&(l=a.RGB16I),n===a.INT&&(l=a.RGB32I)),t===a.RGBA){const c=s?hy:Nn.getTransfer(i);n===a.FLOAT&&(l=a.RGBA32F),n===a.HALF_FLOAT&&(l=a.RGBA16F),n===a.UNSIGNED_BYTE&&(l=a.RGBA8),n===a.UNSIGNED_SHORT&&(l=a.RGBA16),n===a.UNSIGNED_INT&&(l=a.RGBA32UI),n===a.BYTE&&(l=a.RGBA8I),n===a.SHORT&&(l=a.RGBA16I),n===a.INT&&(l=a.RGBA32I),n===a.UNSIGNED_BYTE&&(l=c===an?a.SRGB8_ALPHA8:a.RGBA8),n===a.UNSIGNED_SHORT_4_4_4_4&&(l=a.RGBA4),n===a.UNSIGNED_SHORT_5_5_5_1&&(l=a.RGB5_A1)}return t===a.RGBA_INTEGER&&(n===a.UNSIGNED_BYTE&&(l=a.RGBA8UI),n===a.UNSIGNED_SHORT&&(l=a.RGBA16UI),n===a.UNSIGNED_INT&&(l=a.RGBA32UI),n===a.BYTE&&(l=a.RGBA8I),n===a.SHORT&&(l=a.RGBA16I),n===a.INT&&(l=a.RGBA32I)),t===a.DEPTH_COMPONENT&&(n===a.UNSIGNED_SHORT&&(l=a.DEPTH_COMPONENT16),n===a.UNSIGNED_INT&&(l=a.DEPTH_COMPONENT24),n===a.FLOAT&&(l=a.DEPTH_COMPONENT32F)),t===a.DEPTH_STENCIL&&n===a.UNSIGNED_INT_24_8&&(l=a.DEPTH24_STENCIL8),(l===a.R16F||l===a.R32F||l===a.RG16F||l===a.RG32F||l===a.RGBA16F||l===a.RGBA32F)&&o.get("EXT_color_buffer_float"),l}setTextureParameters(e,t){const{gl:n,extensions:i,backend:s}=this,a=Nn.getPrimaries(Nn.workingColorSpace),o=t.colorSpace===Jo?null:Nn.getPrimaries(t.colorSpace),l=t.colorSpace===Jo||a===o?n.NONE:n.BROWSER_DEFAULT_WEBGL;n.pixelStorei(n.UNPACK_FLIP_Y_WEBGL,t.flipY),n.pixelStorei(n.UNPACK_PREMULTIPLY_ALPHA_WEBGL,t.premultiplyAlpha),n.pixelStorei(n.UNPACK_ALIGNMENT,t.unpackAlignment),n.pixelStorei(n.UNPACK_COLORSPACE_CONVERSION_WEBGL,l),n.texParameteri(e,n.TEXTURE_WRAP_S,fw[t.wrapS]),n.texParameteri(e,n.TEXTURE_WRAP_T,fw[t.wrapT]),(e===n.TEXTURE_3D||e===n.TEXTURE_2D_ARRAY)&&(t.isArrayTexture||n.texParameteri(e,n.TEXTURE_WRAP_R,fw[t.wrapR])),n.texParameteri(e,n.TEXTURE_MAG_FILTER,DD[t.magFilter]);const c=t.mipmaps!==void 0&&t.mipmaps.length>0,d=t.minFilter===ei&&c?Pa:t.minFilter;if(n.texParameteri(e,n.TEXTURE_MIN_FILTER,DD[d]),t.compareFunction&&(n.texParameteri(e,n.TEXTURE_COMPARE_MODE,n.COMPARE_REF_TO_TEXTURE),n.texParameteri(e,n.TEXTURE_COMPARE_FUNC,zG[t.compareFunction])),i.has("EXT_texture_filter_anisotropic")===!0){if(t.magFilter===Ki||t.minFilter!==jc&&t.minFilter!==Pa||t.type===Ci&&i.has("OES_texture_float_linear")===!1)return;if(t.anisotropy>1){const p=i.get("EXT_texture_filter_anisotropic");n.texParameterf(e,p.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(t.anisotropy,s.getMaxAnisotropy()))}}}createDefaultTexture(e){const{gl:t,backend:n,defaultTextures:i}=this,s=this.getGLTextureType(e);let a=i[s];a===void 0&&(a=t.createTexture(),n.state.bindTexture(s,a),t.texParameteri(s,t.TEXTURE_MIN_FILTER,t.NEAREST),t.texParameteri(s,t.TEXTURE_MAG_FILTER,t.NEAREST),i[s]=a),n.set(e,{textureGPU:a,glTextureType:s})}createTexture(e,t){const{gl:n,backend:i}=this,{levels:s,width:a,height:o,depth:l}=t,c=i.utils.convert(e.format,e.colorSpace),d=i.utils.convert(e.type),p=this.getInternalFormat(e.internalFormat,c,d,e.colorSpace,e.isVideoTexture),y=n.createTexture(),_=this.getGLTextureType(e);i.state.bindTexture(_,y),this.setTextureParameters(_,e),e.isArrayTexture||e.isDataArrayTexture||e.isCompressedArrayTexture?n.texStorage3D(n.TEXTURE_2D_ARRAY,s,p,a,o,l):e.isData3DTexture?n.texStorage3D(n.TEXTURE_3D,s,p,a,o,l):e.isVideoTexture||n.texStorage2D(_,s,p,a,o),i.set(e,{textureGPU:y,glTextureType:_,glFormat:c,glType:d,glInternalFormat:p})}copyBufferToTexture(e,t){const{gl:n,backend:i}=this,{textureGPU:s,glTextureType:a,glFormat:o,glType:l}=i.get(t),{width:c,height:d}=t.source.data;n.bindBuffer(n.PIXEL_UNPACK_BUFFER,e),i.state.bindTexture(a,s),n.pixelStorei(n.UNPACK_FLIP_Y_WEBGL,!1),n.pixelStorei(n.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!1),n.texSubImage2D(a,0,0,0,c,d,o,l,0),n.bindBuffer(n.PIXEL_UNPACK_BUFFER,null),i.state.unbindTexture()}updateTexture(e,t){const{gl:n}=this,{width:i,height:s}=t,{textureGPU:a,glTextureType:o,glFormat:l,glType:c,glInternalFormat:d}=this.backend.get(e);if(!(e.isRenderTargetTexture||a===void 0))if(this.backend.state.bindTexture(o,a),this.setTextureParameters(o,e),e.isCompressedTexture){const p=e.mipmaps,y=t.image;for(let _=0;_<p.length;_++){const v=p[_];e.isCompressedArrayTexture?e.format!==n.RGBA?l!==null?n.compressedTexSubImage3D(n.TEXTURE_2D_ARRAY,_,0,0,0,v.width,v.height,y.depth,l,v.data):Ve("WebGLBackend: Attempt to load unsupported compressed texture format in .uploadTexture()"):n.texSubImage3D(n.TEXTURE_2D_ARRAY,_,0,0,0,v.width,v.height,y.depth,l,c,v.data):l!==null?n.compressedTexSubImage2D(n.TEXTURE_2D,_,0,0,v.width,v.height,l,v.data):Ve("WebGLBackend: Unsupported compressed texture format")}}else if(e.isCubeTexture){const p=t.images,y=e.mipmaps;for(let _=0;_<6;_++){const v=dw(p[_]);n.texSubImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+_,0,0,0,i,s,l,c,v);for(let b=0;b<y.length;b++){const E=y[b],T=dw(E.images[_]);n.texSubImage2D(n.TEXTURE_CUBE_MAP_POSITIVE_X+_,b+1,0,0,T.width,T.height,l,c,T)}}}else if(e.isDataArrayTexture||e.isArrayTexture){const p=t.image;if(e.layerUpdates.size>0){const y=iR(p.width,p.height,e.format,e.type);for(const _ of e.layerUpdates){const v=p.data.subarray(_*y/p.data.BYTES_PER_ELEMENT,(_+1)*y/p.data.BYTES_PER_ELEMENT);n.texSubImage3D(n.TEXTURE_2D_ARRAY,0,0,0,_,p.width,p.height,1,l,c,v)}e.clearLayerUpdates()}else n.texSubImage3D(n.TEXTURE_2D_ARRAY,0,0,0,0,p.width,p.height,p.depth,l,c,p.data)}else if(e.isData3DTexture){const p=t.image;n.texSubImage3D(n.TEXTURE_3D,0,0,0,0,p.width,p.height,p.depth,l,c,p.data)}else if(e.isVideoTexture)e.update(),n.texImage2D(o,0,d,l,c,t.image);else{const p=e.mipmaps;if(p.length>0)for(let y=0,_=p.length;y<_;y++){const v=p[y],b=dw(v);n.texSubImage2D(o,y,0,0,v.width,v.height,l,c,b)}else{const y=dw(t.image);n.texSubImage2D(o,0,0,0,i,s,l,c,y)}}}generateMipmaps(e){const{gl:t,backend:n}=this,{textureGPU:i,glTextureType:s}=n.get(e);n.state.bindTexture(s,i),t.generateMipmap(s)}deallocateRenderBuffers(e){const{gl:t,backend:n}=this;if(e){const i=n.get(e);if(i.renderBufferStorageSetup=void 0,i.framebuffers){for(const s in i.framebuffers)t.deleteFramebuffer(i.framebuffers[s]);delete i.framebuffers}if(i.depthRenderbuffer&&(t.deleteRenderbuffer(i.depthRenderbuffer),delete i.depthRenderbuffer),i.stencilRenderbuffer&&(t.deleteRenderbuffer(i.stencilRenderbuffer),delete i.stencilRenderbuffer),i.msaaFrameBuffer&&(t.deleteFramebuffer(i.msaaFrameBuffer),delete i.msaaFrameBuffer),i.msaaRenderbuffers){for(let s=0;s<i.msaaRenderbuffers.length;s++)t.deleteRenderbuffer(i.msaaRenderbuffers[s]);delete i.msaaRenderbuffers}}}destroyTexture(e,t=!1){const{gl:n,backend:i}=this,{textureGPU:s,renderTarget:a}=i.get(e);this.deallocateRenderBuffers(a),t===!1&&n.deleteTexture(s),i.delete(e)}copyTextureToTexture(e,t,n=null,i=null,s=0,a=0){const{gl:o,backend:l}=this,{state:c}=this.backend,{textureGPU:d,glTextureType:p,glType:y,glFormat:_}=l.get(t);c.bindTexture(p,d);let v,b,E,T,M,R,N,P,U;const L=e.isCompressedTexture?e.mipmaps[a]:e.image;if(n!==null)v=n.max.x-n.min.x,b=n.max.y-n.min.y,E=n.isBox3?n.max.z-n.min.z:1,T=n.min.x,M=n.min.y,R=n.isBox3?n.min.z:0;else{const ae=Math.pow(2,-s);v=Math.floor(L.width*ae),b=Math.floor(L.height*ae),e.isDataArrayTexture||e.isArrayTexture?E=L.depth:e.isData3DTexture?E=Math.floor(L.depth*ae):E=1,T=0,M=0,R=0}i!==null?(N=i.x,P=i.y,U=i.z):(N=0,P=0,U=0),o.pixelStorei(o.UNPACK_FLIP_Y_WEBGL,t.flipY),o.pixelStorei(o.UNPACK_PREMULTIPLY_ALPHA_WEBGL,t.premultiplyAlpha),o.pixelStorei(o.UNPACK_ALIGNMENT,t.unpackAlignment);const F=o.getParameter(o.UNPACK_ROW_LENGTH),O=o.getParameter(o.UNPACK_IMAGE_HEIGHT),B=o.getParameter(o.UNPACK_SKIP_PIXELS),q=o.getParameter(o.UNPACK_SKIP_ROWS),j=o.getParameter(o.UNPACK_SKIP_IMAGES);o.pixelStorei(o.UNPACK_ROW_LENGTH,L.width),o.pixelStorei(o.UNPACK_IMAGE_HEIGHT,L.height),o.pixelStorei(o.UNPACK_SKIP_PIXELS,T),o.pixelStorei(o.UNPACK_SKIP_ROWS,M),o.pixelStorei(o.UNPACK_SKIP_IMAGES,R);const Q=e.isDataArrayTexture||e.isData3DTexture||t.isArrayTexture,se=t.isDataArrayTexture||t.isData3DTexture||t.isArrayTexture;if(e.isDepthTexture){const ae=l.get(e),V=l.get(t),X=l.get(ae.renderTarget),ee=l.get(V.renderTarget),fe=X.framebuffers[ae.cacheKey],Y=ee.framebuffers[V.cacheKey];c.bindFramebuffer(o.READ_FRAMEBUFFER,fe),c.bindFramebuffer(o.DRAW_FRAMEBUFFER,Y);for(let K=0;K<E;K++)Q&&(o.framebufferTextureLayer(o.READ_FRAMEBUFFER,o.COLOR_ATTACHMENT0,ae.textureGPU,s,R+K),o.framebufferTextureLayer(o.DRAW_FRAMEBUFFER,o.COLOR_ATTACHMENT0,d,a,U+K)),o.blitFramebuffer(T,M,v,b,N,P,v,b,o.DEPTH_BUFFER_BIT,o.NEAREST);c.bindFramebuffer(o.READ_FRAMEBUFFER,null),c.bindFramebuffer(o.DRAW_FRAMEBUFFER,null)}else if(s!==0||e.isRenderTargetTexture||l.has(e)){const ae=l.get(e);this._srcFramebuffer===null&&(this._srcFramebuffer=o.createFramebuffer()),this._dstFramebuffer===null&&(this._dstFramebuffer=o.createFramebuffer()),c.bindFramebuffer(o.READ_FRAMEBUFFER,this._srcFramebuffer),c.bindFramebuffer(o.DRAW_FRAMEBUFFER,this._dstFramebuffer);for(let V=0;V<E;V++)Q?o.framebufferTextureLayer(o.READ_FRAMEBUFFER,o.COLOR_ATTACHMENT0,ae.textureGPU,s,R+V):o.framebufferTexture2D(o.READ_FRAMEBUFFER,o.COLOR_ATTACHMENT0,o.TEXTURE_2D,ae.textureGPU,s),se?o.framebufferTextureLayer(o.DRAW_FRAMEBUFFER,o.COLOR_ATTACHMENT0,d,a,U+V):o.framebufferTexture2D(o.DRAW_FRAMEBUFFER,o.COLOR_ATTACHMENT0,o.TEXTURE_2D,d,a),s!==0?o.blitFramebuffer(T,M,v,b,N,P,v,b,o.COLOR_BUFFER_BIT,o.NEAREST):se?o.copyTexSubImage3D(p,a,N,P,U+V,T,M,v,b):o.copyTexSubImage2D(p,a,N,P,T,M,v,b);c.bindFramebuffer(o.READ_FRAMEBUFFER,null),c.bindFramebuffer(o.DRAW_FRAMEBUFFER,null)}else se?e.isDataTexture||e.isData3DTexture?o.texSubImage3D(p,a,N,P,U,v,b,E,_,y,L.data):t.isCompressedArrayTexture?o.compressedTexSubImage3D(p,a,N,P,U,v,b,E,_,L.data):o.texSubImage3D(p,a,N,P,U,v,b,E,_,y,L):e.isDataTexture?o.texSubImage2D(o.TEXTURE_2D,a,N,P,v,b,_,y,L.data):e.isCompressedTexture?o.compressedTexSubImage2D(o.TEXTURE_2D,a,N,P,L.width,L.height,_,L.data):o.texSubImage2D(o.TEXTURE_2D,a,N,P,v,b,_,y,L);o.pixelStorei(o.UNPACK_ROW_LENGTH,F),o.pixelStorei(o.UNPACK_IMAGE_HEIGHT,O),o.pixelStorei(o.UNPACK_SKIP_PIXELS,B),o.pixelStorei(o.UNPACK_SKIP_ROWS,q),o.pixelStorei(o.UNPACK_SKIP_IMAGES,j),a===0&&t.generateMipmaps&&o.generateMipmap(p),c.unbindTexture()}copyFramebufferToTexture(e,t,n){const{gl:i}=this,{state:s}=this.backend,{textureGPU:a}=this.backend.get(e),{x:o,y:l,z:c,w:d}=n,p=e.isDepthTexture===!0||t.renderTarget&&t.renderTarget.samples>0,y=t.renderTarget?t.renderTarget.height:this.backend.getDrawingBufferSize().y;if(p){const _=o!==0||l!==0;let v,b;if(e.isDepthTexture===!0?(v=i.DEPTH_BUFFER_BIT,b=i.DEPTH_ATTACHMENT,t.stencil&&(v|=i.STENCIL_BUFFER_BIT)):(v=i.COLOR_BUFFER_BIT,b=i.COLOR_ATTACHMENT0),_){const E=this.backend.get(t.renderTarget),T=E.framebuffers[t.getCacheKey()],M=E.msaaFrameBuffer;s.bindFramebuffer(i.DRAW_FRAMEBUFFER,T),s.bindFramebuffer(i.READ_FRAMEBUFFER,M);const R=y-l-d;i.blitFramebuffer(o,R,o+c,R+d,o,R,o+c,R+d,v,i.NEAREST),s.bindFramebuffer(i.READ_FRAMEBUFFER,T),s.bindTexture(i.TEXTURE_2D,a),i.copyTexSubImage2D(i.TEXTURE_2D,0,0,0,o,R,c,d),s.unbindTexture()}else{const E=i.createFramebuffer();s.bindFramebuffer(i.DRAW_FRAMEBUFFER,E),i.framebufferTexture2D(i.DRAW_FRAMEBUFFER,b,i.TEXTURE_2D,a,0),i.blitFramebuffer(0,0,c,d,0,0,c,d,v,i.NEAREST),i.deleteFramebuffer(E)}}else s.bindTexture(i.TEXTURE_2D,a),i.copyTexSubImage2D(i.TEXTURE_2D,0,0,0,o,y-d-l,c,d),s.unbindTexture();e.generateMipmaps&&this.generateMipmaps(e),this.backend._setFramebuffer(t)}setupRenderBufferStorage(e,t,n,i=!1){const{gl:s}=this,a=t.renderTarget,{depthTexture:o,depthBuffer:l,stencilBuffer:c,width:d,height:p}=a;if(s.bindRenderbuffer(s.RENDERBUFFER,e),l&&!c){let y=s.DEPTH_COMPONENT24;i===!0?this.extensions.get("WEBGL_multisampled_render_to_texture").renderbufferStorageMultisampleEXT(s.RENDERBUFFER,a.samples,y,d,p):n>0?(o&&o.isDepthTexture&&o.type===s.FLOAT&&(y=s.DEPTH_COMPONENT32F),s.renderbufferStorageMultisample(s.RENDERBUFFER,n,y,d,p)):s.renderbufferStorage(s.RENDERBUFFER,y,d,p),s.framebufferRenderbuffer(s.FRAMEBUFFER,s.DEPTH_ATTACHMENT,s.RENDERBUFFER,e)}else l&&c&&(n>0?s.renderbufferStorageMultisample(s.RENDERBUFFER,n,s.DEPTH24_STENCIL8,d,p):s.renderbufferStorage(s.RENDERBUFFER,s.DEPTH_STENCIL,d,p),s.framebufferRenderbuffer(s.FRAMEBUFFER,s.DEPTH_STENCIL_ATTACHMENT,s.RENDERBUFFER,e));s.bindRenderbuffer(s.RENDERBUFFER,null)}async copyTextureToBuffer(e,t,n,i,s,a){const{backend:o,gl:l}=this,{textureGPU:c,glFormat:d,glType:p}=this.backend.get(e),y=l.createFramebuffer();o.state.bindFramebuffer(l.READ_FRAMEBUFFER,y);const _=e.isCubeTexture?l.TEXTURE_CUBE_MAP_POSITIVE_X+a:l.TEXTURE_2D;l.framebufferTexture2D(l.READ_FRAMEBUFFER,l.COLOR_ATTACHMENT0,_,c,0);const v=this._getTypedArrayType(p),b=this._getBytesPerTexel(p,d),T=i*s*b,M=l.createBuffer();l.bindBuffer(l.PIXEL_PACK_BUFFER,M),l.bufferData(l.PIXEL_PACK_BUFFER,T,l.STREAM_READ),l.readPixels(t,n,i,s,d,p,0),l.bindBuffer(l.PIXEL_PACK_BUFFER,null),await o.utils._clientWaitAsync();const R=new v(T/v.BYTES_PER_ELEMENT);return l.bindBuffer(l.PIXEL_PACK_BUFFER,M),l.getBufferSubData(l.PIXEL_PACK_BUFFER,0,R),l.bindBuffer(l.PIXEL_PACK_BUFFER,null),o.state.bindFramebuffer(l.READ_FRAMEBUFFER,null),l.deleteFramebuffer(y),R}_getTypedArrayType(e){const{gl:t}=this;if(e===t.UNSIGNED_BYTE)return Uint8Array;if(e===t.UNSIGNED_SHORT_4_4_4_4||e===t.UNSIGNED_SHORT_5_5_5_1||e===t.UNSIGNED_SHORT_5_6_5||e===t.UNSIGNED_SHORT)return Uint16Array;if(e===t.UNSIGNED_INT)return Uint32Array;if(e===t.HALF_FLOAT)return Uint16Array;if(e===t.FLOAT)return Float32Array;throw new Error(`Unsupported WebGL type: ${e}`)}_getBytesPerTexel(e,t){const{gl:n}=this;let i=0;if(e===n.UNSIGNED_BYTE&&(i=1),(e===n.UNSIGNED_SHORT_4_4_4_4||e===n.UNSIGNED_SHORT_5_5_5_1||e===n.UNSIGNED_SHORT_5_6_5||e===n.UNSIGNED_SHORT||e===n.HALF_FLOAT)&&(i=2),(e===n.UNSIGNED_INT||e===n.FLOAT)&&(i=4),t===n.RGBA)return i*4;if(t===n.RGB)return i*3;if(t===n.ALPHA)return i}dispose(){const{gl:e}=this;this._srcFramebuffer!==null&&e.deleteFramebuffer(this._srcFramebuffer),this._dstFramebuffer!==null&&e.deleteFramebuffer(this._dstFramebuffer)}}function dw(r){return r.isDataTexture?r.image.data:typeof HTMLImageElement<"u"&&r instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&r instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&r instanceof ImageBitmap||typeof OffscreenCanvas<"u"&&r instanceof OffscreenCanvas?r:r.data}class g_e{constructor(e){this.backend=e,this.gl=this.backend.gl,this.availableExtensions=this.gl.getSupportedExtensions(),this.extensions={}}get(e){let t=this.extensions[e];return t===void 0&&(t=this.gl.getExtension(e),this.extensions[e]=t),t}has(e){return this.availableExtensions.includes(e)}}class y_e{constructor(e){this.backend=e,this.maxAnisotropy=null}getMaxAnisotropy(){if(this.maxAnisotropy!==null)return this.maxAnisotropy;const e=this.backend.gl,t=this.backend.extensions;if(t.has("EXT_texture_filter_anisotropic")===!0){const n=t.get("EXT_texture_filter_anisotropic");this.maxAnisotropy=e.getParameter(n.MAX_TEXTURE_MAX_ANISOTROPY_EXT)}else this.maxAnisotropy=0;return this.maxAnisotropy}}const VG={WEBGL_multi_draw:"WEBGL_multi_draw",WEBGL_compressed_texture_astc:"texture-compression-astc",WEBGL_compressed_texture_etc:"texture-compression-etc2",WEBGL_compressed_texture_etc1:"texture-compression-etc1",WEBGL_compressed_texture_pvrtc:"texture-compression-pvrtc",WEBGL_compressed_texture_s3tc:"texture-compression-s3tc",EXT_texture_compression_bptc:"texture-compression-bc",EXT_disjoint_timer_query_webgl2:"timestamp-query",OVR_multiview2:"OVR_multiview2"};class __e{constructor(e){this.gl=e.gl,this.extensions=e.extensions,this.info=e.renderer.info,this.mode=null,this.index=0,this.type=null,this.object=null}render(e,t){const{gl:n,mode:i,object:s,type:a,info:o,index:l}=this;l!==0?n.drawElements(i,t,a,e):n.drawArrays(i,e,t),o.update(s,t,1)}renderInstances(e,t,n){const{gl:i,mode:s,type:a,index:o,object:l,info:c}=this;n!==0&&(o!==0?i.drawElementsInstanced(s,t,a,e,n):i.drawArraysInstanced(s,e,t,n),c.update(l,t,n))}renderMultiDraw(e,t,n){const{extensions:i,mode:s,object:a,info:o}=this;if(n===0)return;const l=i.get("WEBGL_multi_draw");if(l===null)for(let c=0;c<n;c++)this.render(e[c],t[c]);else{this.index!==0?l.multiDrawElementsWEBGL(s,t,0,this.type,e,0,n):l.multiDrawArraysWEBGL(s,e,0,t,0,n);let c=0;for(let d=0;d<n;d++)c+=t[d];o.update(a,c,1)}}renderMultiDrawInstances(e,t,n,i){const{extensions:s,mode:a,object:o,info:l}=this;if(n===0)return;const c=s.get("WEBGL_multi_draw");if(c===null)for(let d=0;d<n;d++)this.renderInstances(e[d],t[d],i[d]);else{this.index!==0?c.multiDrawElementsInstancedWEBGL(a,t,0,this.type,e,0,i,0,n):c.multiDrawArraysInstancedWEBGL(a,e,0,t,0,i,0,n);let d=0;for(let p=0;p<n;p++)d+=t[p]*i[p];l.update(o,d,1)}}}class OX{constructor(e=256){this.trackTimestamp=!0,this.maxQueries=e,this.currentQueryIndex=0,this.queryOffsets=new Map,this.isDisposed=!1,this.lastValue=0,this.frames=[],this.pendingResolve=!1,this.timestamps=new Map}getTimestampFrames(){return this.frames}getTimestamp(e){let t=this.timestamps.get(e);return t===void 0&&(Ve(`TimestampQueryPool: No timestamp available for uid ${e}.`),t=0),t}hasTimestamp(e){return this.timestamps.has(e)}allocateQueriesForContext(){}async resolveQueriesAsync(){}dispose(){}}class v_e extends OX{constructor(e,t,n=2048){if(super(n),this.gl=e,this.type=t,this.ext=e.getExtension("EXT_disjoint_timer_query_webgl2")||e.getExtension("EXT_disjoint_timer_query"),!this.ext){Ve("EXT_disjoint_timer_query not supported; timestamps will be disabled."),this.trackTimestamp=!1;return}this.queries=[];for(let i=0;i<this.maxQueries;i++)this.queries.push(e.createQuery());this.activeQuery=null,this.queryStates=new Map}allocateQueriesForContext(e){if(!this.trackTimestamp)return null;if(this.currentQueryIndex+2>this.maxQueries)return cr(`WebGPUTimestampQueryPool [${this.type}]: Maximum number of queries exceeded, when using trackTimestamp it is necessary to resolves the queries via renderer.resolveTimestampsAsync( THREE.TimestampQuery.${this.type.toUpperCase()} ).`),null;const t=this.currentQueryIndex;return this.currentQueryIndex+=2,this.queryStates.set(t,"inactive"),this.queryOffsets.set(e,t),t}beginQuery(e){if(!this.trackTimestamp||this.isDisposed)return;const t=this.queryOffsets.get(e);if(t==null||this.activeQuery!==null)return;const n=this.queries[t];if(n)try{this.queryStates.get(t)==="inactive"&&(this.gl.beginQuery(this.ext.TIME_ELAPSED_EXT,n),this.activeQuery=t,this.queryStates.set(t,"started"))}catch(i){Ze("Error in beginQuery:",i),this.activeQuery=null,this.queryStates.set(t,"inactive")}}endQuery(e){if(!this.trackTimestamp||this.isDisposed)return;const t=this.queryOffsets.get(e);if(t!=null&&this.activeQuery===t)try{this.gl.endQuery(this.ext.TIME_ELAPSED_EXT),this.queryStates.set(t,"ended"),this.activeQuery=null}catch(n){Ze("Error in endQuery:",n),this.queryStates.set(t,"inactive"),this.activeQuery=null}}async resolveQueriesAsync(){if(!this.trackTimestamp||this.pendingResolve)return this.lastValue;this.pendingResolve=!0;try{const e=new Map;for(const[s,a]of this.queryOffsets)if(this.queryStates.get(a)==="ended"){const l=this.queries[a];e.set(s,this.resolveQuery(l))}if(e.size===0)return this.lastValue;const t={},n=[];for(const[s,a]of e){const o=s.match(/^(.*):f(\d+)$/),l=parseInt(o[2]);n.includes(l)===!1&&n.push(l),t[l]===void 0&&(t[l]=0);const c=await a;this.timestamps.set(s,c),t[l]+=c}const i=t[n[n.length-1]];return this.lastValue=i,this.frames=n,this.currentQueryIndex=0,this.queryOffsets.clear(),this.queryStates.clear(),this.activeQuery=null,i}catch(e){return Ze("Error resolving queries:",e),this.lastValue}finally{this.pendingResolve=!1}}async resolveQuery(e){return new Promise(t=>{if(this.isDisposed){t(this.lastValue);return}let n,i=!1;const s=()=>{n&&(clearTimeout(n),n=null)},a=l=>{i||(i=!0,s(),t(l))},o=()=>{if(this.isDisposed){a(this.lastValue);return}try{if(this.gl.getParameter(this.ext.GPU_DISJOINT_EXT)){a(this.lastValue);return}if(!this.gl.getQueryParameter(e,this.gl.QUERY_RESULT_AVAILABLE)){n=setTimeout(o,1);return}const d=this.gl.getQueryParameter(e,this.gl.QUERY_RESULT);t(Number(d)/1e6)}catch(l){Ze("Error checking query:",l),t(this.lastValue)}};o()})}dispose(){if(!this.isDisposed&&(this.isDisposed=!0,!!this.trackTimestamp)){for(const e of this.queries)this.gl.deleteQuery(e);this.queries=[],this.queryStates.clear(),this.queryOffsets.clear(),this.lastValue=0,this.activeQuery=null}}}class GG extends DX{constructor(e={}){super(e),this.isWebGLBackend=!0,this.attributeUtils=null,this.extensions=null,this.capabilities=null,this.textureUtils=null,this.bufferRenderer=null,this.gl=null,this.state=null,this.utils=null,this.vaoCache={},this.transformFeedbackCache={},this.discard=!1,this.disjoint=null,this.parallel=null,this._currentContext=null,this._knownBindings=new WeakSet,this._supportsInvalidateFramebuffer=typeof navigator>"u"?!1:/OculusBrowser/g.test(navigator.userAgent),this._xrFramebuffer=null}init(e){super.init(e);const t=this.parameters,n={antialias:e.currentSamples>0,alpha:!0,depth:e.depth,stencil:e.stencil},i=t.context!==void 0?t.context:e.domElement.getContext("webgl2",n);function s(a){a.preventDefault();const o={api:"WebGL",message:a.statusMessage||"Unknown reason",reason:null,originalEvent:a};e.onDeviceLost(o)}this._onContextLost=s,e.domElement.addEventListener("webglcontextlost",s,!1),this.gl=i,this.extensions=new g_e(this),this.capabilities=new y_e(this),this.attributeUtils=new d_e(this),this.textureUtils=new m_e(this),this.bufferRenderer=new __e(this),this.state=new h_e(this),this.utils=new p_e(this),this.extensions.get("EXT_color_buffer_float"),this.extensions.get("WEBGL_clip_cull_distance"),this.extensions.get("OES_texture_float_linear"),this.extensions.get("EXT_color_buffer_half_float"),this.extensions.get("WEBGL_multisampled_render_to_texture"),this.extensions.get("WEBGL_render_shared_exponent"),this.extensions.get("WEBGL_multi_draw"),this.extensions.get("OVR_multiview2"),this.disjoint=this.extensions.get("EXT_disjoint_timer_query_webgl2"),this.parallel=this.extensions.get("KHR_parallel_shader_compile"),this.drawBuffersIndexedExt=this.extensions.get("OES_draw_buffers_indexed")}get coordinateSystem(){return Ba}async getArrayBufferAsync(e){return await this.attributeUtils.getArrayBufferAsync(e)}async makeXRCompatible(){this.gl.getContextAttributes().xrCompatible!==!0&&await this.gl.makeXRCompatible()}setXRTarget(e){this._xrFramebuffer=e}setXRRenderTargetTextures(e,t,n=null){const i=this.gl;if(this.set(e.texture,{textureGPU:t,glInternalFormat:i.RGBA8}),n!==null){const s=e.stencilBuffer?i.DEPTH24_STENCIL8:i.DEPTH_COMPONENT24;this.set(e.depthTexture,{textureGPU:n,glInternalFormat:s}),this.extensions.has("WEBGL_multisampled_render_to_texture")===!0&&e._autoAllocateDepthBuffer===!0&&e.multiview===!1&&Ve("WebGLBackend: Render-to-texture extension was disabled because an external texture was provided"),e._autoAllocateDepthBuffer=!1}}initTimestampQuery(e,t){if(!this.disjoint||!this.trackTimestamp)return;this.timestampQueryPool[e]||(this.timestampQueryPool[e]=new v_e(this.gl,e,2048));const n=this.timestampQueryPool[e];n.allocateQueriesForContext(t)!==null&&n.beginQuery(t)}prepareTimestampBuffer(e,t){if(!this.disjoint||!this.trackTimestamp)return;this.timestampQueryPool[e].endQuery(t)}getContext(){return this.gl}beginRender(e){const{state:t}=this,n=this.get(e);if(e.viewport)this.updateViewport(e);else{const{width:s,height:a}=this.getDrawingBufferSize();t.viewport(0,0,s,a)}if(e.scissor){const{x:s,y:a,width:o,height:l}=e.scissorValue;t.scissor(s,e.height-l-a,o,l)}this.initTimestampQuery(Yc.RENDER,this.getTimestampUID(e)),n.previousContext=this._currentContext,this._currentContext=e,this._setFramebuffer(e),this.clear(e.clearColor,e.clearDepth,e.clearStencil,e,!1);const i=e.occlusionQueryCount;i>0&&(n.currentOcclusionQueries=n.occlusionQueries,n.currentOcclusionQueryObjects=n.occlusionQueryObjects,n.lastOcclusionObject=null,n.occlusionQueries=new Array(i),n.occlusionQueryObjects=new Array(i),n.occlusionQueryIndex=0)}finishRender(e){const{gl:t,state:n}=this,i=this.get(e),s=i.previousContext;n.resetVertexState();const a=e.occlusionQueryCount;a>0&&(a>i.occlusionQueryIndex&&t.endQuery(t.ANY_SAMPLES_PASSED),this.resolveOccludedAsync(e));const o=e.textures;if(o!==null)for(let l=0;l<o.length;l++){const c=o[l];c.generateMipmaps&&this.generateMipmaps(c)}if(this._currentContext=s,this._resolveRenderTarget(e),s!==null)if(this._setFramebuffer(s),s.viewport)this.updateViewport(s);else{const{width:l,height:c}=this.getDrawingBufferSize();n.viewport(0,0,l,c)}this.prepareTimestampBuffer(Yc.RENDER,this.getTimestampUID(e))}resolveOccludedAsync(e){const t=this.get(e),{currentOcclusionQueries:n,currentOcclusionQueryObjects:i}=t;if(n&&i){const s=new WeakSet,{gl:a}=this;t.currentOcclusionQueryObjects=null,t.currentOcclusionQueries=null;const o=()=>{let l=0;for(let c=0;c<n.length;c++){const d=n[c];d!==null&&a.getQueryParameter(d,a.QUERY_RESULT_AVAILABLE)&&(a.getQueryParameter(d,a.QUERY_RESULT)===0&&s.add(i[c]),n[c]=null,a.deleteQuery(d),l++)}l<n.length?requestAnimationFrame(o):t.occluded=s};o()}}isOccluded(e,t){const n=this.get(e);return n.occluded&&n.occluded.has(t)}updateViewport(e){const{state:t}=this,{x:n,y:i,width:s,height:a}=e.viewportValue;t.viewport(n,e.height-a-i,s,a)}setScissorTest(e){this.state.setScissorTest(e)}getClearColor(){const e=super.getClearColor();return e.r*=e.a,e.g*=e.a,e.b*=e.a,e}clear(e,t,n,i=null,s=!0,a=!0){const{gl:o,renderer:l}=this;i===null&&(i={textures:null,clearColorValue:this.getClearColor()});let c=0;if(e&&(c|=o.COLOR_BUFFER_BIT),t&&(c|=o.DEPTH_BUFFER_BIT),n&&(c|=o.STENCIL_BUFFER_BIT),c!==0){let d;i.clearColorValue?d=i.clearColorValue:d=this.getClearColor();const p=l.getClearDepth(),y=l.getClearStencil();if(t&&this.state.setDepthMask(!0),i.textures===null)o.clearColor(d.r,d.g,d.b,d.a),o.clear(c);else{if(s&&this._setFramebuffer(i),e)for(let _=0;_<i.textures.length;_++)_===0?o.clearBufferfv(o.COLOR,_,[d.r,d.g,d.b,d.a]):o.clearBufferfv(o.COLOR,_,[0,0,0,1]);t&&n?o.clearBufferfi(o.DEPTH_STENCIL,0,p,y):t?o.clearBufferfv(o.DEPTH,0,[p]):n&&o.clearBufferiv(o.STENCIL,0,[y]),s&&a&&this._resolveRenderTarget(i)}}}beginCompute(e){const{state:t,gl:n}=this;t.bindFramebuffer(n.FRAMEBUFFER,null),this.initTimestampQuery(Yc.COMPUTE,this.getTimestampUID(e))}compute(e,t,n,i,s=null){const{state:a,gl:o}=this;this.discard===!1&&(a.enable(o.RASTERIZER_DISCARD),this.discard=!0);const{programGPU:l,transformBuffers:c,attributes:d}=this.get(i),p=this._getVaoKey(d),y=this.vaoCache[p];y===void 0?this.vaoCache[p]=this._createVao(d):a.setVertexState(y),a.useProgram(l),this._bindUniforms(n);const _=this._getTransformFeedback(c);o.bindTransformFeedback(o.TRANSFORM_FEEDBACK,_),o.beginTransformFeedback(o.POINTS),s=s!==null?s:t.count,Array.isArray(s)?(cr("WebGLBackend.compute(): The count parameter must be a single number, not an array."),s=s[0]):s&&typeof s=="object"&&s.isIndirectStorageBufferAttribute&&(cr("WebGLBackend.compute(): The count parameter must be a single number, not IndirectStorageBufferAttribute"),s=t.count),d[0].isStorageInstancedBufferAttribute?o.drawArraysInstanced(o.POINTS,0,1,s):o.drawArrays(o.POINTS,0,s),o.endTransformFeedback(),o.bindTransformFeedback(o.TRANSFORM_FEEDBACK,null);for(let v=0;v<c.length;v++){const b=c[v];b.pbo&&this.has(b.pbo)&&this.textureUtils.copyBufferToTexture(b.transformBuffer,b.pbo),b.switchBuffers()}}finishCompute(e){const{state:t,gl:n}=this;this.discard=!1,t.disable(n.RASTERIZER_DISCARD),this.prepareTimestampBuffer(Yc.COMPUTE,this.getTimestampUID(e)),this._currentContext&&this._setFramebuffer(this._currentContext)}_isRenderCameraDepthArray(e){return e.depthTexture&&e.depthTexture.isArrayTexture&&e.camera.isArrayCamera}draw(e){const{object:t,pipeline:n,material:i,context:s,hardwareClippingPlanes:a}=e,{programGPU:o}=this.get(n),{gl:l,state:c}=this,d=this.get(s),p=e.getDrawParameters();if(p===null)return;this._bindUniforms(e.getBindings());const y=t.isMesh&&t.matrixWorld.determinant()<0;c.setMaterial(i,y,a),s.textures!==null&&s.textures.length>1&&c.setMRTBlending(s.textures),c.useProgram(o);const _=e.getAttributes(),v=this.get(_);let b=v.vaoGPU;if(b===void 0){const F=this._getVaoKey(_);b=this.vaoCache[F],b===void 0&&(b=this._createVao(_),this.vaoCache[F]=b,v.vaoGPU=b)}const E=e.getIndex(),T=E!==null?this.get(E).bufferGPU:null;c.setVertexState(b,T);const M=d.lastOcclusionObject;if(M!==t&&M!==void 0){if(M!==null&&M.occlusionTest===!0&&(l.endQuery(l.ANY_SAMPLES_PASSED),d.occlusionQueryIndex++),t.occlusionTest===!0){const F=l.createQuery();l.beginQuery(l.ANY_SAMPLES_PASSED,F),d.occlusionQueries[d.occlusionQueryIndex]=F,d.occlusionQueryObjects[d.occlusionQueryIndex]=t}d.lastOcclusionObject=t}const R=this.bufferRenderer;t.isPoints?R.mode=l.POINTS:t.isLineSegments?R.mode=l.LINES:t.isLine?R.mode=l.LINE_STRIP:t.isLineLoop?R.mode=l.LINE_LOOP:i.wireframe===!0?(c.setLineWidth(i.wireframeLinewidth*this.renderer.getPixelRatio()),R.mode=l.LINES):R.mode=l.TRIANGLES;const{vertexCount:N,instanceCount:P}=p;let{firstVertex:U}=p;if(R.object=t,E!==null){U*=E.array.BYTES_PER_ELEMENT;const F=this.get(E);R.index=E.count,R.type=F.type}else R.index=0;const L=()=>{t.isBatchedMesh?t._multiDrawInstances!==null?(cr("WebGLBackend: renderMultiDrawInstances has been deprecated and will be removed in r184. Append to renderMultiDraw arguments and use indirection."),R.renderMultiDrawInstances(t._multiDrawStarts,t._multiDrawCounts,t._multiDrawCount,t._multiDrawInstances)):this.hasFeature("WEBGL_multi_draw")?R.renderMultiDraw(t._multiDrawStarts,t._multiDrawCounts,t._multiDrawCount):cr("WebGLBackend: WEBGL_multi_draw not supported."):P>1?R.renderInstances(U,N,P):R.render(U,N)};if(e.camera.isArrayCamera===!0&&e.camera.cameras.length>0&&e.camera.isMultiViewCamera===!1){const F=this.get(e.camera),O=e.camera.cameras,B=e.getBindingGroup("cameraIndex").bindings[0];if(F.indexesGPU===void 0||F.indexesGPU.length!==O.length){const V=new Uint32Array([0,0,0,0]),X=[];for(let ee=0,fe=O.length;ee<fe;ee++){const Y=l.createBuffer();V[0]=ee,l.bindBuffer(l.UNIFORM_BUFFER,Y),l.bufferData(l.UNIFORM_BUFFER,V,l.STATIC_DRAW),X.push(Y)}F.indexesGPU=X}const q=this.get(B),j=this.renderer.getPixelRatio(),Q=this._currentContext.renderTarget,se=this._isRenderCameraDepthArray(this._currentContext),ae=this._currentContext.activeCubeFace;if(se){const V=this.get(Q.depthTexture);if(V.clearedRenderId!==this.renderer._nodes.nodeFrame.renderId){V.clearedRenderId=this.renderer._nodes.nodeFrame.renderId;const{stencilBuffer:X}=Q;for(let ee=0,fe=O.length;ee<fe;ee++)this.renderer._activeCubeFace=ee,this._currentContext.activeCubeFace=ee,this._setFramebuffer(this._currentContext),this.clear(!1,!0,X,this._currentContext,!1,!1);this.renderer._activeCubeFace=ae,this._currentContext.activeCubeFace=ae}}for(let V=0,X=O.length;V<X;V++){const ee=O[V];if(t.layers.test(ee.layers)){se&&(this.renderer._activeCubeFace=V,this._currentContext.activeCubeFace=V,this._setFramebuffer(this._currentContext));const fe=ee.viewport;if(fe!==void 0){const Y=fe.x*j,K=fe.y*j,he=fe.width*j,Ce=fe.height*j;c.viewport(Math.floor(Y),Math.floor(e.context.height-Ce-K),Math.floor(he),Math.floor(Ce))}c.bindBufferBase(l.UNIFORM_BUFFER,q.index,F.indexesGPU[V]),L()}this._currentContext.activeCubeFace=ae,this.renderer._activeCubeFace=ae}}else L()}needsRenderUpdate(){return!1}getRenderCacheKey(){return""}createDefaultTexture(e){this.textureUtils.createDefaultTexture(e)}createTexture(e,t){this.textureUtils.createTexture(e,t)}updateTexture(e,t){this.textureUtils.updateTexture(e,t)}generateMipmaps(e){this.textureUtils.generateMipmaps(e)}destroyTexture(e,t=!1){this.textureUtils.destroyTexture(e,t)}async copyTextureToBuffer(e,t,n,i,s,a){return this.textureUtils.copyTextureToBuffer(e,t,n,i,s,a)}updateSampler(){return""}createNodeBuilder(e,t){return new u_e(e,t)}createProgram(e){const t=this.gl,{stage:n,code:i}=e,s=n==="fragment"?t.createShader(t.FRAGMENT_SHADER):t.createShader(t.VERTEX_SHADER);t.shaderSource(s,i),t.compileShader(s),this.set(e,{shaderGPU:s})}destroyProgram(e){this.delete(e)}createRenderPipeline(e,t){const n=this.gl,i=e.pipeline,{fragmentProgram:s,vertexProgram:a}=i,o=n.createProgram(),l=this.get(s).shaderGPU,c=this.get(a).shaderGPU;if(n.attachShader(o,l),n.attachShader(o,c),n.linkProgram(o),this.set(i,{programGPU:o,fragmentShader:l,vertexShader:c}),t!==null&&this.parallel){const d=new Promise(p=>{const y=this.parallel,_=()=>{n.getProgramParameter(o,y.COMPLETION_STATUS_KHR)?(this._completeCompile(e,i),p()):requestAnimationFrame(_)};_()});t.push(d);return}this._completeCompile(e,i)}_handleSource(e,t){const n=e.split(`
`),i=[],s=Math.max(t-6,0),a=Math.min(t+6,n.length);for(let o=s;o<a;o++){const l=o+1;i.push(`${l===t?">":" "} ${l}: ${n[o]}`)}return i.join(`
`)}_getShaderErrors(e,t,n){const i=e.getShaderParameter(t,e.COMPILE_STATUS),a=(e.getShaderInfoLog(t)||"").trim();if(i&&a==="")return"";const o=/ERROR: 0:(\d+)/.exec(a);if(o){const l=parseInt(o[1]);return n.toUpperCase()+`

`+a+`

`+this._handleSource(e.getShaderSource(t),l)}else return a}_logProgramError(e,t,n){if(this.renderer.debug.checkShaderErrors){const i=this.gl,a=(i.getProgramInfoLog(e)||"").trim();if(i.getProgramParameter(e,i.LINK_STATUS)===!1)if(typeof this.renderer.debug.onShaderError=="function")this.renderer.debug.onShaderError(i,e,n,t);else{const o=this._getShaderErrors(i,n,"vertex"),l=this._getShaderErrors(i,t,"fragment");Ze("THREE.WebGLProgram: Shader Error "+i.getError()+" - VALIDATE_STATUS "+i.getProgramParameter(e,i.VALIDATE_STATUS)+`

Program Info Log: `+a+`
`+o+`
`+l)}else a!==""&&Ve("WebGLProgram: Program Info Log:",a)}}_completeCompile(e,t){const{state:n,gl:i}=this,s=this.get(t),{programGPU:a,fragmentShader:o,vertexShader:l}=s;i.getProgramParameter(a,i.LINK_STATUS)===!1&&this._logProgramError(a,o,l),n.useProgram(a);const c=e.getBindings();this._setupBindings(c,a),this.set(t,{programGPU:a})}createComputePipeline(e,t){const{state:n,gl:i}=this,s={stage:"fragment",code:`#version 300 es
precision highp float;
void main() {}`};this.createProgram(s);const{computeProgram:a}=e,o=i.createProgram(),l=this.get(s).shaderGPU,c=this.get(a).shaderGPU,d=a.transforms,p=[],y=[];for(let E=0;E<d.length;E++){const T=d[E];p.push(T.varyingName),y.push(T.attributeNode)}i.attachShader(o,l),i.attachShader(o,c),i.transformFeedbackVaryings(o,p,i.SEPARATE_ATTRIBS),i.linkProgram(o),i.getProgramParameter(o,i.LINK_STATUS)===!1&&this._logProgramError(o,l,c),n.useProgram(o),this._setupBindings(t,o);const _=a.attributes,v=[],b=[];for(let E=0;E<_.length;E++){const T=_[E].node.attribute;v.push(T),this.has(T)||this.attributeUtils.createAttribute(T,i.ARRAY_BUFFER)}for(let E=0;E<y.length;E++){const T=y[E].attribute;this.has(T)||this.attributeUtils.createAttribute(T,i.ARRAY_BUFFER);const M=this.get(T);b.push(M)}this.set(e,{programGPU:o,transformBuffers:b,attributes:v})}createBindings(e,t){if(this._knownBindings.has(t)===!1){this._knownBindings.add(t);let n=0,i=0;for(const s of t){this.set(s,{textures:i,uniformBuffers:n});for(const a of s.bindings)a.isUniformBuffer&&n++,a.isSampledTexture&&i++}}this.updateBindings(e,t)}updateBindings(e){const{gl:t}=this,n=this.get(e);let i=n.uniformBuffers,s=n.textures;for(const a of e.bindings){const o=this.get(a);if(a.isUniformsGroup||a.isUniformBuffer){const l=a.buffer;let{bufferGPU:c}=this.get(l);c===void 0?(c=t.createBuffer(),t.bindBuffer(t.UNIFORM_BUFFER,c),t.bufferData(t.UNIFORM_BUFFER,l.byteLength,t.DYNAMIC_DRAW),this.set(l,{bufferGPU:c})):t.bindBuffer(t.UNIFORM_BUFFER,c);const d=a.updateRanges;if(t.bindBuffer(t.UNIFORM_BUFFER,c),d.length===0)t.bufferData(t.UNIFORM_BUFFER,l,t.DYNAMIC_DRAW);else{const p=mx(l),y=p?1:l.BYTES_PER_ELEMENT;for(let _=0,v=d.length;_<v;_++){const b=d[_],E=b.start*y,T=b.count*y,M=E*(p?l.BYTES_PER_ELEMENT:1);t.bufferSubData(t.UNIFORM_BUFFER,M,l,E,T)}}o.index=i++,o.bufferGPU=c,this.set(a,o)}else if(a.isSampledTexture){const{textureGPU:l,glTextureType:c}=this.get(a.texture);o.index=s++,o.textureGPU=l,o.glTextureType=c,this.set(a,o)}}}updateBinding(e){const t=this.gl;if(e.isUniformsGroup||e.isUniformBuffer){const i=this.get(e).bufferGPU,s=e.buffer,a=e.updateRanges;if(t.bindBuffer(t.UNIFORM_BUFFER,i),a.length===0)t.bufferData(t.UNIFORM_BUFFER,s,t.DYNAMIC_DRAW);else{const o=mx(s),l=o?1:s.BYTES_PER_ELEMENT;for(let c=0,d=a.length;c<d;c++){const p=a[c],y=p.start*l,_=p.count*l,v=y*(o?s.BYTES_PER_ELEMENT:1);t.bufferSubData(t.UNIFORM_BUFFER,v,s,y,_)}}}}createIndexAttribute(e){const t=this.gl;this.attributeUtils.createAttribute(e,t.ELEMENT_ARRAY_BUFFER)}createAttribute(e){if(this.has(e))return;const t=this.gl;this.attributeUtils.createAttribute(e,t.ARRAY_BUFFER)}createStorageAttribute(e){if(this.has(e))return;const t=this.gl;this.attributeUtils.createAttribute(e,t.ARRAY_BUFFER)}updateAttribute(e){this.attributeUtils.updateAttribute(e)}destroyAttribute(e){this.attributeUtils.destroyAttribute(e)}hasFeature(e){const t=Object.keys(VG).filter(i=>VG[i]===e),n=this.extensions;for(let i=0;i<t.length;i++)if(n.has(t[i]))return!0;return!1}getMaxAnisotropy(){return this.capabilities.getMaxAnisotropy()}copyTextureToTexture(e,t,n=null,i=null,s=0,a=0){this.textureUtils.copyTextureToTexture(e,t,n,i,s,a)}copyFramebufferToTexture(e,t,n){this.textureUtils.copyFramebufferToTexture(e,t,n)}_setFramebuffer(e){const{gl:t,state:n}=this;let i=null;if(e.textures!==null){const s=e.renderTarget,a=this.get(s),{samples:o,depthBuffer:l,stencilBuffer:c}=s,d=s.isWebGLCubeRenderTarget===!0,p=s.isRenderTarget3D===!0,y=s.depth>1,_=s.isXRRenderTarget===!0,v=_===!0&&s._hasExternalTextures===!0;let b=a.msaaFrameBuffer,E=a.depthRenderbuffer;const T=this.extensions.get("WEBGL_multisampled_render_to_texture"),M=this.extensions.get("OVR_multiview2"),R=this._useMultisampledExtension(s),N=Mq(e);let P;if(d?(a.cubeFramebuffers||(a.cubeFramebuffers={}),P=a.cubeFramebuffers[N]):_&&v===!1?P=this._xrFramebuffer:(a.framebuffers||(a.framebuffers={}),P=a.framebuffers[N]),P===void 0){P=t.createFramebuffer(),n.bindFramebuffer(t.FRAMEBUFFER,P);const U=e.textures,L=[];if(d){a.cubeFramebuffers[N]=P;const{textureGPU:O}=this.get(U[0]),B=this.renderer._activeCubeFace,q=this.renderer._activeMipmapLevel;t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_CUBE_MAP_POSITIVE_X+B,O,q)}else{a.framebuffers[N]=P;for(let O=0;O<U.length;O++){const B=U[O],q=this.get(B);q.renderTarget=e.renderTarget,q.cacheKey=N;const j=t.COLOR_ATTACHMENT0+O;if(s.multiview)M.framebufferTextureMultisampleMultiviewOVR(t.FRAMEBUFFER,j,q.textureGPU,0,o,0,2);else if(p||y){const Q=this.renderer._activeCubeFace,se=this.renderer._activeMipmapLevel;t.framebufferTextureLayer(t.FRAMEBUFFER,j,q.textureGPU,se,Q)}else if(R)T.framebufferTexture2DMultisampleEXT(t.FRAMEBUFFER,j,t.TEXTURE_2D,q.textureGPU,0,o);else{const Q=this.renderer._activeMipmapLevel;t.framebufferTexture2D(t.FRAMEBUFFER,j,t.TEXTURE_2D,q.textureGPU,Q)}}}const F=c?t.DEPTH_STENCIL_ATTACHMENT:t.DEPTH_ATTACHMENT;if(s._autoAllocateDepthBuffer===!0){const O=t.createRenderbuffer();this.textureUtils.setupRenderBufferStorage(O,e,0,R),a.xrDepthRenderbuffer=O,L.push(c?t.DEPTH_STENCIL_ATTACHMENT:t.DEPTH_ATTACHMENT),t.bindRenderbuffer(t.RENDERBUFFER,O),t.framebufferRenderbuffer(t.FRAMEBUFFER,F,t.RENDERBUFFER,O)}else if(e.depthTexture!==null){L.push(c?t.DEPTH_STENCIL_ATTACHMENT:t.DEPTH_ATTACHMENT);const O=this.get(e.depthTexture);if(O.renderTarget=e.renderTarget,O.cacheKey=N,s.multiview)M.framebufferTextureMultisampleMultiviewOVR(t.FRAMEBUFFER,F,O.textureGPU,0,o,0,2);else if(v&&R)T.framebufferTexture2DMultisampleEXT(t.FRAMEBUFFER,F,t.TEXTURE_2D,O.textureGPU,0,o);else if(e.depthTexture.isArrayTexture){const B=this.renderer._activeCubeFace;t.framebufferTextureLayer(t.FRAMEBUFFER,F,O.textureGPU,0,B)}else if(e.depthTexture.isCubeTexture){const B=this.renderer._activeCubeFace;t.framebufferTexture2D(t.FRAMEBUFFER,F,t.TEXTURE_CUBE_MAP_POSITIVE_X+B,O.textureGPU,0)}else t.framebufferTexture2D(t.FRAMEBUFFER,F,t.TEXTURE_2D,O.textureGPU,0)}a.depthInvalidationArray=L}else{if(this._isRenderCameraDepthArray(e)){n.bindFramebuffer(t.FRAMEBUFFER,P);const L=this.renderer._activeCubeFace,F=this.get(e.depthTexture),O=c?t.DEPTH_STENCIL_ATTACHMENT:t.DEPTH_ATTACHMENT;t.framebufferTextureLayer(t.FRAMEBUFFER,O,F.textureGPU,0,L)}if((_||R||s.multiview)&&s._isOpaqueFramebuffer!==!0){n.bindFramebuffer(t.FRAMEBUFFER,P);const L=this.get(e.textures[0]);s.multiview?M.framebufferTextureMultisampleMultiviewOVR(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,L.textureGPU,0,o,0,2):R?T.framebufferTexture2DMultisampleEXT(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,L.textureGPU,0,o):t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,L.textureGPU,0);const F=c?t.DEPTH_STENCIL_ATTACHMENT:t.DEPTH_ATTACHMENT;if(s._autoAllocateDepthBuffer===!0){const O=a.xrDepthRenderbuffer;t.bindRenderbuffer(t.RENDERBUFFER,O),t.framebufferRenderbuffer(t.FRAMEBUFFER,F,t.RENDERBUFFER,O)}else{const O=this.get(e.depthTexture);s.multiview?M.framebufferTextureMultisampleMultiviewOVR(t.FRAMEBUFFER,F,O.textureGPU,0,o,0,2):R?T.framebufferTexture2DMultisampleEXT(t.FRAMEBUFFER,F,t.TEXTURE_2D,O.textureGPU,0,o):t.framebufferTexture2D(t.FRAMEBUFFER,F,t.TEXTURE_2D,O.textureGPU,0)}}}if(o>0&&R===!1&&!s.multiview){if(b===void 0){const U=[];b=t.createFramebuffer(),n.bindFramebuffer(t.FRAMEBUFFER,b);const L=[],F=e.textures;for(let O=0;O<F.length;O++){L[O]=t.createRenderbuffer(),t.bindRenderbuffer(t.RENDERBUFFER,L[O]),U.push(t.COLOR_ATTACHMENT0+O);const B=e.textures[O],q=this.get(B);t.renderbufferStorageMultisample(t.RENDERBUFFER,o,q.glInternalFormat,e.width,e.height),t.framebufferRenderbuffer(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0+O,t.RENDERBUFFER,L[O])}if(t.bindRenderbuffer(t.RENDERBUFFER,null),a.msaaFrameBuffer=b,a.msaaRenderbuffers=L,l&&E===void 0){E=t.createRenderbuffer(),this.textureUtils.setupRenderBufferStorage(E,e,o),a.depthRenderbuffer=E;const O=c?t.DEPTH_STENCIL_ATTACHMENT:t.DEPTH_ATTACHMENT;U.push(O)}a.invalidationArray=U}i=a.msaaFrameBuffer}else i=P;n.drawBuffers(e,P)}n.bindFramebuffer(t.FRAMEBUFFER,i)}_getVaoKey(e){let t="";for(let n=0;n<e.length;n++){const i=this.get(e[n]);t+=":"+i.id}return t}_createVao(e){const{gl:t}=this,n=t.createVertexArray();t.bindVertexArray(n);for(let i=0;i<e.length;i++){const s=e[i],a=this.get(s);t.bindBuffer(t.ARRAY_BUFFER,a.bufferGPU),t.enableVertexAttribArray(i);let o,l;s.isInterleavedBufferAttribute===!0?(o=s.data.stride*a.bytesPerElement,l=s.offset*a.bytesPerElement):(o=0,l=0),a.isInteger?t.vertexAttribIPointer(i,s.itemSize,a.type,o,l):t.vertexAttribPointer(i,s.itemSize,a.type,s.normalized,o,l),s.isInstancedBufferAttribute&&!s.isInterleavedBufferAttribute?t.vertexAttribDivisor(i,s.meshPerAttribute):s.isInterleavedBufferAttribute&&s.data.isInstancedInterleavedBuffer&&t.vertexAttribDivisor(i,s.data.meshPerAttribute)}return t.bindBuffer(t.ARRAY_BUFFER,null),n}_getTransformFeedback(e){let t="";for(let s=0;s<e.length;s++)t+=":"+e[s].id;let n=this.transformFeedbackCache[t];if(n!==void 0)return n;const{gl:i}=this;n=i.createTransformFeedback(),i.bindTransformFeedback(i.TRANSFORM_FEEDBACK,n);for(let s=0;s<e.length;s++){const a=e[s];i.bindBufferBase(i.TRANSFORM_FEEDBACK_BUFFER,s,a.transformBuffer)}return i.bindTransformFeedback(i.TRANSFORM_FEEDBACK,null),this.transformFeedbackCache[t]=n,n}_setupBindings(e,t){const n=this.gl;for(const i of e)for(const s of i.bindings){const o=this.get(s).index;if(s.isUniformsGroup||s.isUniformBuffer){const l=n.getUniformBlockIndex(t,s.name);n.uniformBlockBinding(t,l,o)}else if(s.isSampledTexture){const l=n.getUniformLocation(t,s.name);n.uniform1i(l,o)}}}_bindUniforms(e){const{gl:t,state:n}=this;for(const i of e)for(const s of i.bindings){const a=this.get(s),o=a.index;s.isUniformsGroup||s.isUniformBuffer?n.bindBufferBase(t.UNIFORM_BUFFER,o,a.bufferGPU):s.isSampledTexture&&n.bindTexture(a.glTextureType,a.textureGPU,t.TEXTURE0+o)}}_resolveRenderTarget(e){const{gl:t,state:n}=this,i=e.renderTarget;if(e.textures!==null&&i){const s=this.get(i);if(i.samples>0&&this._useMultisampledExtension(i)===!1){const a=s.framebuffers[e.getCacheKey()];let o=t.COLOR_BUFFER_BIT;i.resolveDepthBuffer&&(i.depthBuffer&&(o|=t.DEPTH_BUFFER_BIT),i.stencilBuffer&&i.resolveStencilBuffer&&(o|=t.STENCIL_BUFFER_BIT));const l=s.msaaFrameBuffer,c=s.msaaRenderbuffers,d=e.textures,p=d.length>1;if(n.bindFramebuffer(t.READ_FRAMEBUFFER,l),n.bindFramebuffer(t.DRAW_FRAMEBUFFER,a),p)for(let y=0;y<d.length;y++)t.framebufferRenderbuffer(t.READ_FRAMEBUFFER,t.COLOR_ATTACHMENT0+y,t.RENDERBUFFER,null),t.framebufferTexture2D(t.DRAW_FRAMEBUFFER,t.COLOR_ATTACHMENT0+y,t.TEXTURE_2D,null,0);for(let y=0;y<d.length;y++){if(p){const{textureGPU:_}=this.get(d[y]);t.framebufferRenderbuffer(t.READ_FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.RENDERBUFFER,c[y]),t.framebufferTexture2D(t.DRAW_FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,_,0)}if(e.scissor){const{x:_,y:v,width:b,height:E}=e.scissorValue,T=e.height-E-v;t.blitFramebuffer(_,T,_+b,T+E,_,T,_+b,T+E,o,t.NEAREST)}else t.blitFramebuffer(0,0,e.width,e.height,0,0,e.width,e.height,o,t.NEAREST)}if(p)for(let y=0;y<d.length;y++){const{textureGPU:_}=this.get(d[y]);t.framebufferRenderbuffer(t.READ_FRAMEBUFFER,t.COLOR_ATTACHMENT0+y,t.RENDERBUFFER,c[y]),t.framebufferTexture2D(t.DRAW_FRAMEBUFFER,t.COLOR_ATTACHMENT0+y,t.TEXTURE_2D,_,0)}this._supportsInvalidateFramebuffer===!0&&t.invalidateFramebuffer(t.READ_FRAMEBUFFER,s.invalidationArray)}else if(i.resolveDepthBuffer===!1&&s.framebuffers){const a=s.framebuffers[e.getCacheKey()];n.bindFramebuffer(t.DRAW_FRAMEBUFFER,a),t.invalidateFramebuffer(t.DRAW_FRAMEBUFFER,s.depthInvalidationArray)}}}_useMultisampledExtension(e){return e.multiview===!0?!0:e.samples>0&&this.extensions.has("WEBGL_multisampled_render_to_texture")===!0&&e._autoAllocateDepthBuffer!==!1}dispose(){this.textureUtils!==null&&this.textureUtils.dispose();const e=this.extensions.get("WEBGL_lose_context");e&&e.loseContext(),this.renderer.domElement.removeEventListener("webglcontextlost",this._onContextLost)}}const zv={PointList:"point-list",LineList:"line-list",LineStrip:"line-strip",TriangleList:"triangle-list",TriangleStrip:"triangle-strip"},T0=typeof self<"u"?self.GPUShaderStage:{VERTEX:1,FRAGMENT:2,COMPUTE:4},Ua={Never:"never",Less:"less",Equal:"equal",LessEqual:"less-equal",Greater:"greater",NotEqual:"not-equal",GreaterEqual:"greater-equal",Always:"always"},Xo={Store:"store"},tr={Load:"load",Clear:"clear"},kG={CCW:"ccw",CW:"cw"},HG={None:"none",Back:"back"},Ox={Uint16:"uint16",Uint32:"uint32"},be={R8Unorm:"r8unorm",R8Snorm:"r8snorm",R8Uint:"r8uint",R8Sint:"r8sint",R16Uint:"r16uint",R16Sint:"r16sint",R16Float:"r16float",RG8Unorm:"rg8unorm",RG8Snorm:"rg8snorm",RG8Uint:"rg8uint",RG8Sint:"rg8sint",R32Uint:"r32uint",R32Sint:"r32sint",R32Float:"r32float",RG16Uint:"rg16uint",RG16Sint:"rg16sint",RG16Float:"rg16float",RGBA8Unorm:"rgba8unorm",RGBA8UnormSRGB:"rgba8unorm-srgb",RGBA8Snorm:"rgba8snorm",RGBA8Uint:"rgba8uint",RGBA8Sint:"rgba8sint",BGRA8Unorm:"bgra8unorm",BGRA8UnormSRGB:"bgra8unorm-srgb",RGB9E5UFloat:"rgb9e5ufloat",RGB10A2Unorm:"rgb10a2unorm",RG11B10UFloat:"rg11b10ufloat",RG32Uint:"rg32uint",RG32Sint:"rg32sint",RG32Float:"rg32float",RGBA16Uint:"rgba16uint",RGBA16Sint:"rgba16sint",RGBA16Float:"rgba16float",RGBA32Uint:"rgba32uint",RGBA32Sint:"rgba32sint",RGBA32Float:"rgba32float",Depth16Unorm:"depth16unorm",Depth24Plus:"depth24plus",Depth24PlusStencil8:"depth24plus-stencil8",Depth32Float:"depth32float",Depth32FloatStencil8:"depth32float-stencil8",BC1RGBAUnorm:"bc1-rgba-unorm",BC1RGBAUnormSRGB:"bc1-rgba-unorm-srgb",BC2RGBAUnorm:"bc2-rgba-unorm",BC2RGBAUnormSRGB:"bc2-rgba-unorm-srgb",BC3RGBAUnorm:"bc3-rgba-unorm",BC3RGBAUnormSRGB:"bc3-rgba-unorm-srgb",BC4RUnorm:"bc4-r-unorm",BC4RSnorm:"bc4-r-snorm",BC5RGUnorm:"bc5-rg-unorm",BC5RGSnorm:"bc5-rg-snorm",BC6HRGBUFloat:"bc6h-rgb-ufloat",BC6HRGBFloat:"bc6h-rgb-float",BC7RGBAUnorm:"bc7-rgba-unorm",BC7RGBAUnormSRGB:"bc7-rgba-unorm-srgb",ETC2RGB8Unorm:"etc2-rgb8unorm",ETC2RGB8UnormSRGB:"etc2-rgb8unorm-srgb",ETC2RGB8A1Unorm:"etc2-rgb8a1unorm",ETC2RGB8A1UnormSRGB:"etc2-rgb8a1unorm-srgb",ETC2RGBA8Unorm:"etc2-rgba8unorm",ETC2RGBA8UnormSRGB:"etc2-rgba8unorm-srgb",EACR11Unorm:"eac-r11unorm",EACR11Snorm:"eac-r11snorm",EACRG11Unorm:"eac-rg11unorm",EACRG11Snorm:"eac-rg11snorm",ASTC4x4Unorm:"astc-4x4-unorm",ASTC4x4UnormSRGB:"astc-4x4-unorm-srgb",ASTC5x4Unorm:"astc-5x4-unorm",ASTC5x4UnormSRGB:"astc-5x4-unorm-srgb",ASTC5x5Unorm:"astc-5x5-unorm",ASTC5x5UnormSRGB:"astc-5x5-unorm-srgb",ASTC6x5Unorm:"astc-6x5-unorm",ASTC6x5UnormSRGB:"astc-6x5-unorm-srgb",ASTC6x6Unorm:"astc-6x6-unorm",ASTC6x6UnormSRGB:"astc-6x6-unorm-srgb",ASTC8x5Unorm:"astc-8x5-unorm",ASTC8x5UnormSRGB:"astc-8x5-unorm-srgb",ASTC8x6Unorm:"astc-8x6-unorm",ASTC8x6UnormSRGB:"astc-8x6-unorm-srgb",ASTC8x8Unorm:"astc-8x8-unorm",ASTC8x8UnormSRGB:"astc-8x8-unorm-srgb",ASTC10x5Unorm:"astc-10x5-unorm",ASTC10x5UnormSRGB:"astc-10x5-unorm-srgb",ASTC10x6Unorm:"astc-10x6-unorm",ASTC10x6UnormSRGB:"astc-10x6-unorm-srgb",ASTC10x8Unorm:"astc-10x8-unorm",ASTC10x8UnormSRGB:"astc-10x8-unorm-srgb",ASTC10x10Unorm:"astc-10x10-unorm",ASTC10x10UnormSRGB:"astc-10x10-unorm-srgb",ASTC12x10Unorm:"astc-12x10-unorm",ASTC12x10UnormSRGB:"astc-12x10-unorm-srgb",ASTC12x12Unorm:"astc-12x12-unorm",ASTC12x12UnormSRGB:"astc-12x12-unorm-srgb"},OD={ClampToEdge:"clamp-to-edge",Repeat:"repeat",MirrorRepeat:"mirror-repeat"},d0={Linear:"linear",Nearest:"nearest"},Ti={Zero:"zero",One:"one",Src:"src",OneMinusSrc:"one-minus-src",SrcAlpha:"src-alpha",OneMinusSrcAlpha:"one-minus-src-alpha",Dst:"dst",OneMinusDst:"one-minus-dst",DstAlpha:"dst-alpha",OneMinusDstAlpha:"one-minus-dst-alpha",SrcAlphaSaturated:"src-alpha-saturated",Constant:"constant",OneMinusConstant:"one-minus-constant"},n0={Add:"add",Subtract:"subtract",ReverseSubtract:"reverse-subtract",Min:"min",Max:"max"},WG={None:0,All:15},Xp={Keep:"keep",Zero:"zero",Replace:"replace",Invert:"invert",IncrementClamp:"increment-clamp",DecrementClamp:"decrement-clamp",IncrementWrap:"increment-wrap",DecrementWrap:"decrement-wrap"},UD={Storage:"storage",ReadOnlyStorage:"read-only-storage"},LD={WriteOnly:"write-only",ReadOnly:"read-only",ReadWrite:"read-write"},qG={NonFiltering:"non-filtering",Comparison:"comparison"},i0={Float:"float",UnfilterableFloat:"unfilterable-float",Depth:"depth",SInt:"sint",UInt:"uint"},XG={TwoD:"2d",ThreeD:"3d"},Gs={TwoD:"2d",TwoDArray:"2d-array",Cube:"cube",ThreeD:"3d"},x_e={All:"all"},hw={Vertex:"vertex",Instance:"instance"},bU={CoreFeaturesAndLimits:"core-features-and-limits",DepthClipControl:"depth-clip-control",Depth32FloatStencil8:"depth32float-stencil8",TextureCompressionBC:"texture-compression-bc",TextureCompressionBCSliced3D:"texture-compression-bc-sliced-3d",TextureCompressionETC2:"texture-compression-etc2",TextureCompressionASTC:"texture-compression-astc",TextureCompressionASTCSliced3D:"texture-compression-astc-sliced-3d",TimestampQuery:"timestamp-query",IndirectFirstInstance:"indirect-first-instance",ShaderF16:"shader-f16",RG11B10UFloat:"rg11b10ufloat-renderable",BGRA8UNormStorage:"bgra8unorm-storage",Float32Filterable:"float32-filterable",Float32Blendable:"float32-blendable",ClipDistances:"clip-distances",DualSourceBlending:"dual-source-blending",Subgroups:"subgroups",TextureFormatsTier1:"texture-formats-tier1",TextureFormatsTier2:"texture-formats-tier2"},$G={"texture-compression-s3tc":"texture-compression-bc","texture-compression-etc1":"texture-compression-etc2"};class b_e extends CX{constructor(e,t,n){super(e,t?t.value:null),this.textureNode=t,this.groupNode=n}update(){const{textureNode:e}=this;return this.texture!==e.value?(this.texture=e.value,!0):super.update()}}class S_e extends MX{constructor(e,t){super(e,t?t.array:null),this.attribute=t,this.isStorageBuffer=!0}}let T_e=0;class E_e extends S_e{constructor(e,t){super("StorageBuffer_"+T_e++,e?e.value:null),this.nodeUniform=e,this.access=e?e.access:Fa.READ_WRITE,this.groupNode=t}get buffer(){return this.nodeUniform.value}}class M_e extends qm{constructor(e){super(),this.device=e;const t=`
struct VarysStruct {
	@builtin( position ) Position: vec4<f32>,
	@location( 0 ) vTex : vec2<f32>
};

@vertex
fn main( @builtin( vertex_index ) vertexIndex : u32 ) -> VarysStruct {

	var Varys : VarysStruct;

	var pos = array< vec2<f32>, 4 >(
		vec2<f32>( -1.0,  1.0 ),
		vec2<f32>(  1.0,  1.0 ),
		vec2<f32>( -1.0, -1.0 ),
		vec2<f32>(  1.0, -1.0 )
	);

	var tex = array< vec2<f32>, 4 >(
		vec2<f32>( 0.0, 0.0 ),
		vec2<f32>( 1.0, 0.0 ),
		vec2<f32>( 0.0, 1.0 ),
		vec2<f32>( 1.0, 1.0 )
	);

	Varys.vTex = tex[ vertexIndex ];
	Varys.Position = vec4<f32>( pos[ vertexIndex ], 0.0, 1.0 );

	return Varys;

}
`,n=`
@group( 0 ) @binding( 0 )
var imgSampler : sampler;

@group( 0 ) @binding( 1 )
var img : texture_2d<f32>;

@fragment
fn main( @location( 0 ) vTex : vec2<f32> ) -> @location( 0 ) vec4<f32> {

	return textureSample( img, imgSampler, vTex );

}
`,i=`
@group( 0 ) @binding( 0 )
var imgSampler : sampler;

@group( 0 ) @binding( 1 )
var img : texture_2d<f32>;

@fragment
fn main( @location( 0 ) vTex : vec2<f32> ) -> @location( 0 ) vec4<f32> {

	return textureSample( img, imgSampler, vec2( vTex.x, 1.0 - vTex.y ) );

}
`;this.mipmapSampler=e.createSampler({minFilter:d0.Linear}),this.flipYSampler=e.createSampler({minFilter:d0.Nearest}),this.transferPipelines={},this.flipYPipelines={},this.mipmapVertexShaderModule=e.createShaderModule({label:"mipmapVertex",code:t}),this.mipmapFragmentShaderModule=e.createShaderModule({label:"mipmapFragment",code:n}),this.flipYFragmentShaderModule=e.createShaderModule({label:"flipYFragment",code:i})}getTransferPipeline(e){let t=this.transferPipelines[e];return t===void 0&&(t=this.device.createRenderPipeline({label:`mipmap-${e}`,vertex:{module:this.mipmapVertexShaderModule,entryPoint:"main"},fragment:{module:this.mipmapFragmentShaderModule,entryPoint:"main",targets:[{format:e}]},primitive:{topology:zv.TriangleStrip,stripIndexFormat:Ox.Uint32},layout:"auto"}),this.transferPipelines[e]=t),t}getFlipYPipeline(e){let t=this.flipYPipelines[e];return t===void 0&&(t=this.device.createRenderPipeline({label:`flipY-${e}`,vertex:{module:this.mipmapVertexShaderModule,entryPoint:"main"},fragment:{module:this.flipYFragmentShaderModule,entryPoint:"main",targets:[{format:e}]},primitive:{topology:zv.TriangleStrip,stripIndexFormat:Ox.Uint32},layout:"auto"}),this.flipYPipelines[e]=t),t}flipY(e,t,n=0){const i=t.format,{width:s,height:a}=t.size,o=this.getTransferPipeline(i),l=this.getFlipYPipeline(i),c=this.device.createTexture({size:{width:s,height:a,depthOrArrayLayers:1},format:i,usage:GPUTextureUsage.RENDER_ATTACHMENT|GPUTextureUsage.TEXTURE_BINDING}),d=e.createView({baseMipLevel:0,mipLevelCount:1,dimension:Gs.TwoD,baseArrayLayer:n}),p=c.createView({baseMipLevel:0,mipLevelCount:1,dimension:Gs.TwoD,baseArrayLayer:0}),y=this.device.createCommandEncoder({}),_=(v,b,E)=>{const T=v.getBindGroupLayout(0),M=this.device.createBindGroup({layout:T,entries:[{binding:0,resource:this.flipYSampler},{binding:1,resource:b}]}),R=y.beginRenderPass({colorAttachments:[{view:E,loadOp:tr.Clear,storeOp:Xo.Store,clearValue:[0,0,0,0]}]});R.setPipeline(v),R.setBindGroup(0,M),R.draw(4,1,0,0),R.end()};_(o,d,p),_(l,p,d),this.device.queue.submit([y.finish()]),c.destroy()}generateMipmaps(e,t,n=0,i=null){const s=this.get(e);s.layers===void 0&&(s.layers=[]);const a=s.layers[n]||this._mipmapCreateBundles(e,t,n),o=i||this.device.createCommandEncoder({label:"mipmapEncoder"});this._mipmapRunBundles(o,a),i===null&&this.device.queue.submit([o.finish()]),s.layers[n]=a}_mipmapCreateBundles(e,t,n){const i=this.getTransferPipeline(t.format),s=i.getBindGroupLayout(0);let a=e.createView({baseMipLevel:0,mipLevelCount:1,dimension:Gs.TwoD,baseArrayLayer:n});const o=[];for(let l=1;l<t.mipLevelCount;l++){const c=this.device.createBindGroup({layout:s,entries:[{binding:0,resource:this.mipmapSampler},{binding:1,resource:a}]}),d=e.createView({baseMipLevel:l,mipLevelCount:1,dimension:Gs.TwoD,baseArrayLayer:n}),p={colorAttachments:[{view:d,loadOp:tr.Clear,storeOp:Xo.Store,clearValue:[0,0,0,0]}]},y=this.device.createRenderBundleEncoder({colorFormats:[t.format]});y.setPipeline(i),y.setBindGroup(0,c),y.draw(4,1,0,0),o.push({renderBundles:[y.finish()],passDescriptor:p}),a=d}return o}_mipmapRunBundles(e,t){const n=t.length;for(let i=0;i<n;i++){const s=t[i],a=e.beginRenderPass(s.passDescriptor);a.executeBundles(s.renderBundles),a.end()}}}const A_e={[yC]:"never",[zx]:"less",[_C]:"equal",[Vx]:"less-equal",[vC]:"greater",[Gx]:"greater-equal",[bC]:"always",[xC]:"not-equal"},w_e=[0,1,3,2,4,5];class R_e{constructor(e){this.backend=e,this._passUtils=null,this.defaultTexture={},this.defaultCubeTexture={},this.defaultVideoFrame=null,this._samplerCache=new Map}updateSampler(e){const t=this.backend,n=e.minFilter+"-"+e.magFilter+"-"+e.wrapS+"-"+e.wrapT+"-"+(e.wrapR||"0")+"-"+e.anisotropy+"-"+(e.compareFunction||0);let i=this._samplerCache.get(n);if(i===void 0){const a={addressModeU:this._convertAddressMode(e.wrapS),addressModeV:this._convertAddressMode(e.wrapT),addressModeW:this._convertAddressMode(e.wrapR),magFilter:this._convertFilterMode(e.magFilter),minFilter:this._convertFilterMode(e.minFilter),mipmapFilter:this._convertFilterMode(e.minFilter),maxAnisotropy:1};a.magFilter===d0.Linear&&a.minFilter===d0.Linear&&a.mipmapFilter===d0.Linear&&(a.maxAnisotropy=e.anisotropy),e.isDepthTexture&&e.compareFunction!==null&&(a.compare=A_e[e.compareFunction]),i={sampler:t.device.createSampler(a),usedTimes:0},this._samplerCache.set(n,i)}const s=t.get(e);if(s.sampler!==i.sampler){if(s.sampler!==void 0){const a=this._samplerCache.get(s.samplerKey);a.usedTimes--,a.usedTimes===0&&this._samplerCache.delete(s.samplerKey)}s.samplerKey=n,s.sampler=i.sampler,i.usedTimes++}return n}createDefaultTexture(e){let t;const n=SU(e);e.isCubeTexture?t=this._getDefaultCubeTextureGPU(n):t=this._getDefaultTextureGPU(n),this.backend.get(e).texture=t}createTexture(e,t={}){const n=this.backend,i=n.get(e);if(i.initialized)throw new Error("WebGPUTextureUtils: Texture already initialized.");if(e.isExternalTexture){i.texture=e.sourceTexture,i.initialized=!0;return}t.needsMipmaps===void 0&&(t.needsMipmaps=!1),t.levels===void 0&&(t.levels=1),t.depth===void 0&&(t.depth=1);const{width:s,height:a,depth:o,levels:l}=t;e.isFramebufferTexture&&(t.renderTarget?t.format=this.backend.utils.getCurrentColorFormat(t.renderTarget):t.format=this.backend.utils.getPreferredCanvasFormat());const c=this._getDimension(e),d=e.internalFormat||t.format||SU(e,n.device);i.format=d;const{samples:p,primarySamples:y,isMSAA:_}=n.utils.getTextureSampleData(e);let v=GPUTextureUsage.TEXTURE_BINDING|GPUTextureUsage.COPY_DST|GPUTextureUsage.COPY_SRC;e.isStorageTexture===!0&&(v|=GPUTextureUsage.STORAGE_BINDING),e.isCompressedTexture!==!0&&e.isCompressedArrayTexture!==!0&&d!==be.RGB9E5UFloat&&(v|=GPUTextureUsage.RENDER_ATTACHMENT);const b={label:e.name,size:{width:s,height:a,depthOrArrayLayers:o},mipLevelCount:l,sampleCount:y,dimension:c,format:d,usage:v};if(d===void 0){Ve("WebGPURenderer: Texture format not supported."),this.createDefaultTexture(e);return}if(e.isCubeTexture&&(b.textureBindingViewDimension=Gs.Cube),i.texture=n.device.createTexture(b),_){const E=Object.assign({},b);E.label=E.label+"-msaa",E.sampleCount=p,E.mipLevelCount=1,i.msaaTexture=n.device.createTexture(E)}i.initialized=!0,i.textureDescriptorGPU=b}destroyTexture(e,t=!1){const n=this.backend,i=n.get(e);i.texture!==void 0&&t===!1&&i.texture.destroy(),i.msaaTexture!==void 0&&i.msaaTexture.destroy(),n.delete(e)}generateMipmaps(e,t=null){const n=this.backend.get(e);if(e.isCubeTexture)for(let i=0;i<6;i++)this._generateMipmaps(n.texture,n.textureDescriptorGPU,i,t);else{const i=e.image.depth||1;for(let s=0;s<i;s++)this._generateMipmaps(n.texture,n.textureDescriptorGPU,s,t)}}getColorBuffer(){const e=this.backend,t=e.renderer.getCanvasTarget(),{width:n,height:i}=e.getDrawingBufferSize(),s=e.renderer.currentSamples,a=t.colorTexture,o=e.get(a);if(a.width===n&&a.height===i&&a.samples===s)return o.texture;let l=o.texture;return l&&l.destroy(),l=e.device.createTexture({label:"colorBuffer",size:{width:n,height:i,depthOrArrayLayers:1},sampleCount:e.utils.getSampleCount(e.renderer.currentSamples),format:e.utils.getPreferredCanvasFormat(),usage:GPUTextureUsage.RENDER_ATTACHMENT|GPUTextureUsage.COPY_SRC}),a.source.width=n,a.source.height=i,a.samples=s,o.texture=l,l}getDepthBuffer(e=!0,t=!1){const n=this.backend,i=n.renderer.getCanvasTarget(),{width:s,height:a}=n.getDrawingBufferSize(),o=n.renderer.currentSamples,l=i.depthTexture;if(l.width===s&&l.height===a&&l.samples===o&&l.depth===e&&l.stencil===t)return n.get(l).texture;const c=n.get(l).texture;let d,p;if(t?(d=ho,p=Dl):e&&(d=ba,p=Hi),c!==void 0){if(l.image.width===s&&l.image.height===a&&l.format===d&&l.type===p&&l.samples===o)return c;this.destroyTexture(l)}return l.name="depthBuffer",l.format=d,l.type=p,l.image.width=s,l.image.height=a,l.samples=o,this.createTexture(l,{width:s,height:a}),n.get(l).texture}updateTexture(e,t){const n=this.backend.get(e),i=e.mipmaps,{textureDescriptorGPU:s}=n;if(!(e.isRenderTargetTexture||s===void 0)){if(e.isDataTexture)if(i.length>0)for(let a=0,o=i.length;a<o;a++){const l=i[a];this._copyBufferToTexture(l,n.texture,s,0,e.flipY,0,a)}else this._copyBufferToTexture(t.image,n.texture,s,0,e.flipY);else if(e.isArrayTexture||e.isDataArrayTexture||e.isData3DTexture)for(let a=0;a<t.image.depth;a++)this._copyBufferToTexture(t.image,n.texture,s,a,e.flipY,a);else if(e.isCompressedTexture||e.isCompressedArrayTexture)this._copyCompressedBufferToTexture(e.mipmaps,n.texture,s);else if(e.isCubeTexture)this._copyCubeMapToTexture(e,n.texture,s);else if(i.length>0)for(let a=0,o=i.length;a<o;a++){const l=i[a];this._copyImageToTexture(l,n.texture,s,0,e.flipY,e.premultiplyAlpha,a)}else this._copyImageToTexture(t.image,n.texture,s,0,e.flipY,e.premultiplyAlpha);n.version=e.version}}async copyTextureToBuffer(e,t,n,i,s,a){const o=this.backend.device,l=this.backend.get(e),c=l.texture,d=l.textureDescriptorGPU.format,p=this._getBytesPerTexel(d);let y=i*p;y=Math.ceil(y/256)*256;const _=o.createBuffer({size:(s-1)*y+i*p,usage:GPUBufferUsage.COPY_DST|GPUBufferUsage.MAP_READ}),v=o.createCommandEncoder();v.copyTextureToBuffer({texture:c,origin:{x:t,y:n,z:a}},{buffer:_,bytesPerRow:y},{width:i,height:s});const b=this._getTypedArrayType(d);o.queue.submit([v.finish()]),await _.mapAsync(GPUMapMode.READ);const E=_.getMappedRange();return new b(E)}dispose(){this._samplerCache.clear()}_getDefaultTextureGPU(e){let t=this.defaultTexture[e];if(t===void 0){const n=new sr;n.minFilter=Ki,n.magFilter=Ki,this.createTexture(n,{width:1,height:1,format:e}),this.defaultTexture[e]=t=n}return this.backend.get(t).texture}_getDefaultCubeTextureGPU(e){let t=this.defaultCubeTexture[e];if(t===void 0){const n=new Im;n.minFilter=Ki,n.magFilter=Ki,this.createTexture(n,{width:1,height:1,depth:6}),this.defaultCubeTexture[e]=t=n}return this.backend.get(t).texture}_copyCubeMapToTexture(e,t,n){const i=e.images,s=e.mipmaps;for(let a=0;a<6;a++){const o=i[a],l=e.flipY===!0?w_e[a]:a;o.isDataTexture?this._copyBufferToTexture(o.image,t,n,l,e.flipY):this._copyImageToTexture(o,t,n,l,e.flipY,e.premultiplyAlpha);for(let c=0;c<s.length;c++){const p=s[c].images[a];p.isDataTexture?this._copyBufferToTexture(p.image,t,n,l,e.flipY,0,c+1):this._copyImageToTexture(p,t,n,l,e.flipY,e.premultiplyAlpha,c+1)}}}_copyImageToTexture(e,t,n,i,s,a,o=0){const l=this.backend.device,c=o>0?e.width:n.size.width,d=o>0?e.height:n.size.height;try{l.queue.copyExternalImageToTexture({source:e,flipY:s},{texture:t,mipLevel:o,origin:{x:0,y:0,z:i},premultipliedAlpha:a},{width:c,height:d,depthOrArrayLayers:1})}catch{}}_getPassUtils(){let e=this._passUtils;return e===null&&(this._passUtils=e=new M_e(this.backend.device)),e}_generateMipmaps(e,t,n=0,i=null){this._getPassUtils().generateMipmaps(e,t,n,i)}_flipY(e,t,n=0){this._getPassUtils().flipY(e,t,n)}_copyBufferToTexture(e,t,n,i,s,a=0,o=0){const l=this.backend.device,c=e.data,d=this._getBytesPerTexel(n.format),p=e.width*d;l.queue.writeTexture({texture:t,mipLevel:o,origin:{x:0,y:0,z:i}},c,{offset:e.width*e.height*d*a,bytesPerRow:p},{width:e.width,height:e.height,depthOrArrayLayers:1}),s===!0&&this._flipY(t,n,i)}_copyCompressedBufferToTexture(e,t,n){const i=this.backend.device,s=this._getBlockData(n.format),a=n.size.depthOrArrayLayers>1;for(let o=0;o<e.length;o++){const l=e[o],c=l.width,d=l.height,p=a?n.size.depthOrArrayLayers:1,y=Math.ceil(c/s.width)*s.byteLength,_=y*Math.ceil(d/s.height);for(let v=0;v<p;v++)i.queue.writeTexture({texture:t,mipLevel:o,origin:{x:0,y:0,z:v}},l.data,{offset:v*_,bytesPerRow:y,rowsPerImage:Math.ceil(d/s.height)},{width:Math.ceil(c/s.width)*s.width,height:Math.ceil(d/s.height)*s.height,depthOrArrayLayers:1})}}_getBlockData(e){if(e===be.BC1RGBAUnorm||e===be.BC1RGBAUnormSRGB)return{byteLength:8,width:4,height:4};if(e===be.BC2RGBAUnorm||e===be.BC2RGBAUnormSRGB)return{byteLength:16,width:4,height:4};if(e===be.BC3RGBAUnorm||e===be.BC3RGBAUnormSRGB)return{byteLength:16,width:4,height:4};if(e===be.BC4RUnorm||e===be.BC4RSnorm)return{byteLength:8,width:4,height:4};if(e===be.BC5RGUnorm||e===be.BC5RGSnorm)return{byteLength:16,width:4,height:4};if(e===be.BC6HRGBUFloat||e===be.BC6HRGBFloat)return{byteLength:16,width:4,height:4};if(e===be.BC7RGBAUnorm||e===be.BC7RGBAUnormSRGB)return{byteLength:16,width:4,height:4};if(e===be.ETC2RGB8Unorm||e===be.ETC2RGB8UnormSRGB)return{byteLength:8,width:4,height:4};if(e===be.ETC2RGB8A1Unorm||e===be.ETC2RGB8A1UnormSRGB)return{byteLength:8,width:4,height:4};if(e===be.ETC2RGBA8Unorm||e===be.ETC2RGBA8UnormSRGB)return{byteLength:16,width:4,height:4};if(e===be.EACR11Unorm)return{byteLength:8,width:4,height:4};if(e===be.EACR11Snorm)return{byteLength:8,width:4,height:4};if(e===be.EACRG11Unorm)return{byteLength:16,width:4,height:4};if(e===be.EACRG11Snorm)return{byteLength:16,width:4,height:4};if(e===be.ASTC4x4Unorm||e===be.ASTC4x4UnormSRGB)return{byteLength:16,width:4,height:4};if(e===be.ASTC5x4Unorm||e===be.ASTC5x4UnormSRGB)return{byteLength:16,width:5,height:4};if(e===be.ASTC5x5Unorm||e===be.ASTC5x5UnormSRGB)return{byteLength:16,width:5,height:5};if(e===be.ASTC6x5Unorm||e===be.ASTC6x5UnormSRGB)return{byteLength:16,width:6,height:5};if(e===be.ASTC6x6Unorm||e===be.ASTC6x6UnormSRGB)return{byteLength:16,width:6,height:6};if(e===be.ASTC8x5Unorm||e===be.ASTC8x5UnormSRGB)return{byteLength:16,width:8,height:5};if(e===be.ASTC8x6Unorm||e===be.ASTC8x6UnormSRGB)return{byteLength:16,width:8,height:6};if(e===be.ASTC8x8Unorm||e===be.ASTC8x8UnormSRGB)return{byteLength:16,width:8,height:8};if(e===be.ASTC10x5Unorm||e===be.ASTC10x5UnormSRGB)return{byteLength:16,width:10,height:5};if(e===be.ASTC10x6Unorm||e===be.ASTC10x6UnormSRGB)return{byteLength:16,width:10,height:6};if(e===be.ASTC10x8Unorm||e===be.ASTC10x8UnormSRGB)return{byteLength:16,width:10,height:8};if(e===be.ASTC10x10Unorm||e===be.ASTC10x10UnormSRGB)return{byteLength:16,width:10,height:10};if(e===be.ASTC12x10Unorm||e===be.ASTC12x10UnormSRGB)return{byteLength:16,width:12,height:10};if(e===be.ASTC12x12Unorm||e===be.ASTC12x12UnormSRGB)return{byteLength:16,width:12,height:12}}_convertAddressMode(e){let t=OD.ClampToEdge;return e===Bh?t=OD.Repeat:e===Ih&&(t=OD.MirrorRepeat),t}_convertFilterMode(e){let t=d0.Linear;return(e===Ki||e===P1||e===jc)&&(t=d0.Nearest),t}_getBytesPerTexel(e){if(e===be.R8Unorm||e===be.R8Snorm||e===be.R8Uint||e===be.R8Sint)return 1;if(e===be.R16Uint||e===be.R16Sint||e===be.R16Float||e===be.RG8Unorm||e===be.RG8Snorm||e===be.RG8Uint||e===be.RG8Sint)return 2;if(e===be.R32Uint||e===be.R32Sint||e===be.R32Float||e===be.RG16Uint||e===be.RG16Sint||e===be.RG16Float||e===be.RGBA8Unorm||e===be.RGBA8UnormSRGB||e===be.RGBA8Snorm||e===be.RGBA8Uint||e===be.RGBA8Sint||e===be.BGRA8Unorm||e===be.BGRA8UnormSRGB||e===be.RGB9E5UFloat||e===be.RGB10A2Unorm||e===be.RG11B10UFloat||e===be.Depth32Float||e===be.Depth24Plus||e===be.Depth24PlusStencil8||e===be.Depth32FloatStencil8)return 4;if(e===be.RG32Uint||e===be.RG32Sint||e===be.RG32Float||e===be.RGBA16Uint||e===be.RGBA16Sint||e===be.RGBA16Float)return 8;if(e===be.RGBA32Uint||e===be.RGBA32Sint||e===be.RGBA32Float)return 16}_getTypedArrayType(e){if(e===be.R8Uint)return Uint8Array;if(e===be.R8Sint)return Int8Array;if(e===be.R8Unorm)return Uint8Array;if(e===be.R8Snorm)return Int8Array;if(e===be.RG8Uint)return Uint8Array;if(e===be.RG8Sint)return Int8Array;if(e===be.RG8Unorm)return Uint8Array;if(e===be.RG8Snorm)return Int8Array;if(e===be.RGBA8Uint)return Uint8Array;if(e===be.RGBA8Sint)return Int8Array;if(e===be.RGBA8Unorm||e===be.RGBA8UnormSRGB)return Uint8Array;if(e===be.RGBA8Snorm)return Int8Array;if(e===be.R16Uint)return Uint16Array;if(e===be.R16Sint)return Int16Array;if(e===be.RG16Uint)return Uint16Array;if(e===be.RG16Sint)return Int16Array;if(e===be.RGBA16Uint)return Uint16Array;if(e===be.RGBA16Sint)return Int16Array;if(e===be.R16Float||e===be.RG16Float||e===be.RGBA16Float)return Uint16Array;if(e===be.R32Uint)return Uint32Array;if(e===be.R32Sint)return Int32Array;if(e===be.R32Float)return Float32Array;if(e===be.RG32Uint)return Uint32Array;if(e===be.RG32Sint)return Int32Array;if(e===be.RG32Float)return Float32Array;if(e===be.RGBA32Uint)return Uint32Array;if(e===be.RGBA32Sint)return Int32Array;if(e===be.RGBA32Float)return Float32Array;if(e===be.BGRA8Unorm||e===be.BGRA8UnormSRGB)return Uint8Array;if(e===be.RGB10A2Unorm||e===be.RGB9E5UFloat||e===be.RG11B10UFloat)return Uint32Array;if(e===be.Depth32Float)return Float32Array;if(e===be.Depth24Plus||e===be.Depth24PlusStencil8)return Uint32Array;if(e===be.Depth32FloatStencil8)return Float32Array}_getDimension(e){let t;return e.is3DTexture||e.isData3DTexture?t=XG.ThreeD:t=XG.TwoD,t}}function SU(r,e=null){const t=r.format,n=r.type,i=r.colorSpace,s=Nn.getTransfer(i);let a;if(r.isCompressedTexture===!0||r.isCompressedArrayTexture===!0)switch(t){case xh:case bh:a=s===an?be.BC1RGBAUnormSRGB:be.BC1RGBAUnorm;break;case Sh:a=s===an?be.BC2RGBAUnormSRGB:be.BC2RGBAUnorm;break;case Th:a=s===an?be.BC3RGBAUnormSRGB:be.BC3RGBAUnorm;break;case cy:a=be.BC4RUnorm;break;case fy:a=be.BC4RSnorm;break;case vm:a=be.BC5RGUnorm;break;case dy:a=be.BC5RGSnorm;break;case uy:a=s===an?be.BC7RGBAUnormSRGB:be.BC7RGBAUnorm;break;case W0:case H0:a=s===an?be.ETC2RGB8UnormSRGB:be.ETC2RGB8Unorm;break;case q0:a=s===an?be.ETC2RGBA8UnormSRGB:be.ETC2RGBA8Unorm;break;case X0:a=be.EACR11Unorm;break;case $0:a=be.EACR11Snorm;break;case _m:a=be.EACRG11Unorm;break;case j0:a=be.EACRG11Snorm;break;case Y0:a=s===an?be.ASTC4x4UnormSRGB:be.ASTC4x4Unorm;break;case Z0:a=s===an?be.ASTC5x4UnormSRGB:be.ASTC5x4Unorm;break;case K0:a=s===an?be.ASTC5x5UnormSRGB:be.ASTC5x5Unorm;break;case Q0:a=s===an?be.ASTC6x5UnormSRGB:be.ASTC6x5Unorm;break;case J0:a=s===an?be.ASTC6x6UnormSRGB:be.ASTC6x6Unorm;break;case ey:a=s===an?be.ASTC8x5UnormSRGB:be.ASTC8x5Unorm;break;case ty:a=s===an?be.ASTC8x6UnormSRGB:be.ASTC8x6Unorm;break;case ny:a=s===an?be.ASTC8x8UnormSRGB:be.ASTC8x8Unorm;break;case iy:a=s===an?be.ASTC10x5UnormSRGB:be.ASTC10x5Unorm;break;case ry:a=s===an?be.ASTC10x6UnormSRGB:be.ASTC10x6Unorm;break;case sy:a=s===an?be.ASTC10x8UnormSRGB:be.ASTC10x8Unorm;break;case ay:a=s===an?be.ASTC10x10UnormSRGB:be.ASTC10x10Unorm;break;case oy:a=s===an?be.ASTC12x10UnormSRGB:be.ASTC12x10Unorm;break;case ly:a=s===an?be.ASTC12x12UnormSRGB:be.ASTC12x12Unorm;break;case Qi:a=s===an?be.RGBA8UnormSRGB:be.RGBA8Unorm;break;default:Ze("WebGPURenderer: Unsupported texture format.",t)}else switch(t){case Qi:switch(n){case _h:a=be.RGBA8Snorm;break;case vh:a=be.RGBA16Sint;break;case Zu:a=be.RGBA16Uint;break;case Hi:a=be.RGBA32Uint;break;case Hs:a=be.RGBA32Sint;break;case ir:a=s===an?be.RGBA8UnormSRGB:be.RGBA8Unorm;break;case vi:a=be.RGBA16Float;break;case Ci:a=be.RGBA32Float;break;default:Ze("WebGPURenderer: Unsupported texture type with RGBAFormat.",n)}break;case Fx:switch(n){case F1:a=be.RGB9E5UFloat;break;case z1:a=be.RG11B10UFloat;break;default:Ze("WebGPURenderer: Unsupported texture type with RGBFormat.",n)}break;case Pm:switch(n){case _h:a=be.R8Snorm;break;case vh:a=be.R16Sint;break;case Zu:a=be.R16Uint;break;case Hi:a=be.R32Uint;break;case Hs:a=be.R32Sint;break;case ir:a=be.R8Unorm;break;case vi:a=be.R16Float;break;case Ci:a=be.R32Float;break;default:Ze("WebGPURenderer: Unsupported texture type with RedFormat.",n)}break;case po:switch(n){case _h:a=be.RG8Snorm;break;case vh:a=be.RG16Sint;break;case Zu:a=be.RG16Uint;break;case Hi:a=be.RG32Uint;break;case Hs:a=be.RG32Sint;break;case ir:a=be.RG8Unorm;break;case vi:a=be.RG16Float;break;case Ci:a=be.RG32Float;break;default:Ze("WebGPURenderer: Unsupported texture type with RGFormat.",n)}break;case ba:switch(n){case Zu:a=be.Depth16Unorm;break;case Hi:a=be.Depth24Plus;break;case Ci:a=be.Depth32Float;break;default:Ze("WebGPURenderer: Unsupported texture type with DepthFormat.",n)}break;case ho:switch(n){case Dl:a=be.Depth24PlusStencil8;break;case Ci:e&&e.features.has(bU.Depth32FloatStencil8)===!1&&Ze('WebGPURenderer: Depth textures with DepthStencilFormat + FloatType can only be used with the "depth32float-stencil8" GPU feature.'),a=be.Depth32FloatStencil8;break;default:Ze("WebGPURenderer: Unsupported texture type with DepthStencilFormat.",n)}break;case Bm:switch(n){case Hs:a=be.R32Sint;break;case Hi:a=be.R32Uint;break;default:Ze("WebGPURenderer: Unsupported texture type with RedIntegerFormat.",n)}break;case My:switch(n){case Hs:a=be.RG32Sint;break;case Hi:a=be.RG32Uint;break;default:Ze("WebGPURenderer: Unsupported texture type with RGIntegerFormat.",n)}break;case Ay:switch(n){case Hs:a=be.RGBA32Sint;break;case Hi:a=be.RGBA32Uint;break;default:Ze("WebGPURenderer: Unsupported texture type with RGBAIntegerFormat.",n)}break;default:Ze("WebGPURenderer: Unsupported texture format.",t)}return a}const C_e=/^[fn]*\s*([a-z_0-9]+)?\s*\(([\s\S]*?)\)\s*[\-\>]*\s*([a-z_0-9]+(?:<[\s\S]+?>)?)/i,N_e=/([a-z_0-9]+)\s*:\s*([a-z_0-9]+(?:<[\s\S]+?>)?)/ig,jG={f32:"float",i32:"int",u32:"uint",bool:"bool","vec2<f32>":"vec2","vec2<i32>":"ivec2","vec2<u32>":"uvec2","vec2<bool>":"bvec2",vec2f:"vec2",vec2i:"ivec2",vec2u:"uvec2",vec2b:"bvec2","vec3<f32>":"vec3","vec3<i32>":"ivec3","vec3<u32>":"uvec3","vec3<bool>":"bvec3",vec3f:"vec3",vec3i:"ivec3",vec3u:"uvec3",vec3b:"bvec3","vec4<f32>":"vec4","vec4<i32>":"ivec4","vec4<u32>":"uvec4","vec4<bool>":"bvec4",vec4f:"vec4",vec4i:"ivec4",vec4u:"uvec4",vec4b:"bvec4","mat2x2<f32>":"mat2",mat2x2f:"mat2","mat3x3<f32>":"mat3",mat3x3f:"mat3","mat4x4<f32>":"mat4",mat4x4f:"mat4",sampler:"sampler",texture_1d:"texture",texture_2d:"texture",texture_2d_array:"texture",texture_multisampled_2d:"cubeTexture",texture_depth_2d:"depthTexture",texture_depth_2d_array:"depthTexture",texture_depth_multisampled_2d:"depthTexture",texture_depth_cube:"depthTexture",texture_depth_cube_array:"depthTexture",texture_3d:"texture3D",texture_cube:"cubeTexture",texture_cube_array:"cubeTexture",texture_storage_1d:"storageTexture",texture_storage_2d:"storageTexture",texture_storage_2d_array:"storageTexture",texture_storage_3d:"storageTexture"},D_e=r=>{r=r.trim();const e=r.match(C_e);if(e!==null&&e.length===4){const t=e[2],n=[];let i=null;for(;(i=N_e.exec(t))!==null;)n.push({name:i[1],type:i[2]});const s=[];for(let d=0;d<n.length;d++){const{name:p,type:y}=n[d];let _=y;_.startsWith("ptr")?_="pointer":(_.startsWith("texture")&&(_=y.split("<")[0]),_=jG[_]),s.push(new uI(_,p))}const a=r.substring(e[0].length),o=e[3]||"void",l=e[1]!==void 0?e[1]:"";return{type:jG[o]||o,inputs:s,name:l,inputsCode:t,blockCode:a,outputType:o}}else throw new Error("FunctionNode: Function is not a WGSL code.")};class O_e extends fI{constructor(e){const{type:t,inputs:n,name:i,inputsCode:s,blockCode:a,outputType:o}=D_e(e);super(t,n,i),this.inputsCode=s,this.blockCode=a,this.outputType=o}getCode(e=this.name){const t=this.outputType!=="void"?"-> "+this.outputType:"";return`fn ${e} ( ${this.inputsCode.trim()} ) ${t}`+this.blockCode}}class U_e extends SX{parseFunction(e){return new O_e(e)}}const L_e={[Fa.READ_ONLY]:"read",[Fa.WRITE_ONLY]:"write",[Fa.READ_WRITE]:"read_write"},YG={[Bh]:"repeat",[Dr]:"clamp",[Ih]:"mirror"},pw={vertex:T0.VERTEX,fragment:T0.FRAGMENT,compute:T0.COMPUTE},ZG={instance:!0,swizzleAssign:!1,storageBuffer:!0},P_e={"^^":"tsl_xor"},B_e={float:"f32",int:"i32",uint:"u32",bool:"bool",color:"vec3<f32>",vec2:"vec2<f32>",ivec2:"vec2<i32>",uvec2:"vec2<u32>",bvec2:"vec2<bool>",vec3:"vec3<f32>",ivec3:"vec3<i32>",uvec3:"vec3<u32>",bvec3:"vec3<bool>",vec4:"vec4<f32>",ivec4:"vec4<i32>",uvec4:"vec4<u32>",bvec4:"vec4<bool>",mat2:"mat2x2<f32>",mat3:"mat3x3<f32>",mat4:"mat4x4<f32>"},KG={},oT={tsl_xor:new ga("fn tsl_xor( a : bool, b : bool ) -> bool { return ( a || b ) && !( a && b ); }"),mod_float:new ga("fn tsl_mod_float( x : f32, y : f32 ) -> f32 { return x - y * floor( x / y ); }"),mod_vec2:new ga("fn tsl_mod_vec2( x : vec2f, y : vec2f ) -> vec2f { return x - y * floor( x / y ); }"),mod_vec3:new ga("fn tsl_mod_vec3( x : vec3f, y : vec3f ) -> vec3f { return x - y * floor( x / y ); }"),mod_vec4:new ga("fn tsl_mod_vec4( x : vec4f, y : vec4f ) -> vec4f { return x - y * floor( x / y ); }"),equals_bool:new ga("fn tsl_equals_bool( a : bool, b : bool ) -> bool { return a == b; }"),equals_bvec2:new ga("fn tsl_equals_bvec2( a : vec2f, b : vec2f ) -> vec2<bool> { return vec2<bool>( a.x == b.x, a.y == b.y ); }"),equals_bvec3:new ga("fn tsl_equals_bvec3( a : vec3f, b : vec3f ) -> vec3<bool> { return vec3<bool>( a.x == b.x, a.y == b.y, a.z == b.z ); }"),equals_bvec4:new ga("fn tsl_equals_bvec4( a : vec4f, b : vec4f ) -> vec4<bool> { return vec4<bool>( a.x == b.x, a.y == b.y, a.z == b.z, a.w == b.w ); }"),repeatWrapping_float:new ga("fn tsl_repeatWrapping_float( coord: f32 ) -> f32 { return fract( coord ); }"),mirrorWrapping_float:new ga("fn tsl_mirrorWrapping_float( coord: f32 ) -> f32 { let mirrored = fract( coord * 0.5 ) * 2.0; return 1.0 - abs( 1.0 - mirrored ); }"),clampWrapping_float:new ga("fn tsl_clampWrapping_float( coord: f32 ) -> f32 { return clamp( coord, 0.0, 1.0 ); }"),biquadraticTexture:new ga(`
fn tsl_biquadraticTexture( map : texture_2d<f32>, coord : vec2f, iRes : vec2u, level : u32 ) -> vec4f {

	let res = vec2f( iRes );

	let uvScaled = coord * res;
	let uvWrapping = ( ( uvScaled % res ) + res ) % res;

	// https://www.shadertoy.com/view/WtyXRy

	let uv = uvWrapping - 0.5;
	let iuv = floor( uv );
	let f = fract( uv );

	let rg1 = textureLoad( map, vec2u( iuv + vec2( 0.5, 0.5 ) ) % iRes, level );
	let rg2 = textureLoad( map, vec2u( iuv + vec2( 1.5, 0.5 ) ) % iRes, level );
	let rg3 = textureLoad( map, vec2u( iuv + vec2( 0.5, 1.5 ) ) % iRes, level );
	let rg4 = textureLoad( map, vec2u( iuv + vec2( 1.5, 1.5 ) ) % iRes, level );

	return mix( mix( rg1, rg2, f.x ), mix( rg3, rg4, f.x ), f.y );

}
`)},I_e={dFdx:"dpdx",dFdy:"- dpdy",mod_float:"tsl_mod_float",mod_vec2:"tsl_mod_vec2",mod_vec3:"tsl_mod_vec3",mod_vec4:"tsl_mod_vec4",equals_bool:"tsl_equals_bool",equals_bvec2:"tsl_equals_bvec2",equals_bvec3:"tsl_equals_bvec3",equals_bvec4:"tsl_equals_bvec4",inversesqrt:"inverseSqrt",bitcast:"bitcast<f32>",floatpack_snorm_2x16:"pack2x16snorm",floatpack_unorm_2x16:"pack2x16unorm",floatpack_float16_2x16:"pack2x16float",floatunpack_snorm_2x16:"unpack2x16snorm",floatunpack_unorm_2x16:"unpack2x16unorm",floatunpack_float16_2x16:"unpack2x16float"};let UX="";(typeof navigator<"u"&&/Firefox|Deno/g.test(navigator.userAgent))!==!0&&(UX+=`diagnostic( off, derivative_uniformity );
`);class F_e extends bX{constructor(e,t){super(e,t,new U_e),this.uniformGroups={},this.builtins={},this.directives={},this.scopedArrays=new Map}_generateTextureSample(e,t,n,i,s,a=this.shaderStage){return a==="fragment"?i?s?`textureSample( ${t}, ${t}_sampler, ${n}, ${i}, ${s} )`:`textureSample( ${t}, ${t}_sampler, ${n}, ${i} )`:s?`textureSample( ${t}, ${t}_sampler, ${n}, ${s} )`:`textureSample( ${t}, ${t}_sampler, ${n} )`:this.generateTextureSampleLevel(e,t,n,"0",i)}generateTextureSampleLevel(e,t,n,i,s,a){return this.isUnfilterable(e)===!1?a?`textureSampleLevel( ${t}, ${t}_sampler, ${n}, ${i}, ${a} )`:`textureSampleLevel( ${t}, ${t}_sampler, ${n}, ${i} )`:this.isFilteredTexture(e)?this.generateFilteredTexture(e,t,n,a,i):this.generateTextureLod(e,t,n,s,a,i)}generateWrapFunction(e){const t=`tsl_coord_${YG[e.wrapS]}S_${YG[e.wrapT]}_${e.is3DTexture||e.isData3DTexture?"3d":"2d"}T`;let n=KG[t];if(n===void 0){const i=[],s=e.is3DTexture||e.isData3DTexture?"vec3f":"vec2f";let a=`fn ${t}( coord : ${s} ) -> ${s} {

	return ${s}(
`;const o=(l,c)=>{l===Bh?(i.push(oT.repeatWrapping_float),a+=`		tsl_repeatWrapping_float( coord.${c} )`):l===Dr?(i.push(oT.clampWrapping_float),a+=`		tsl_clampWrapping_float( coord.${c} )`):l===Ih?(i.push(oT.mirrorWrapping_float),a+=`		tsl_mirrorWrapping_float( coord.${c} )`):(a+=`		coord.${c}`,Ve(`WebGPURenderer: Unsupported texture wrap type "${l}" for vertex shader.`))};o(e.wrapS,"x"),a+=`,
`,o(e.wrapT,"y"),(e.is3DTexture||e.isData3DTexture)&&(a+=`,
`,o(e.wrapR,"z")),a+=`
	);

}
`,KG[t]=n=new ga(a,i)}return n.build(this),t}generateArrayDeclaration(e,t){return`array< ${this.getType(e)}, ${t} >`}generateTextureDimension(e,t,n){const i=this.getDataFromNode(e,this.shaderStage,this.globalCache);i.dimensionsSnippet===void 0&&(i.dimensionsSnippet={});let s=i.dimensionsSnippet[n];if(i.dimensionsSnippet[n]===void 0){let a,o;const{primarySamples:l}=this.renderer.backend.utils.getTextureSampleData(e),c=l>1;e.is3DTexture||e.isData3DTexture?o="vec3<u32>":o="vec2<u32>",c||e.isStorageTexture?a=t:a=`${t}${n?`, u32( ${n} )`:""}`,s=new zw(new Vw(`textureDimensions( ${a} )`,o)),i.dimensionsSnippet[n]=s,(e.isArrayTexture||e.isDataArrayTexture||e.is3DTexture||e.isData3DTexture)&&(i.arrayLayerCount=new zw(new Vw(`textureNumLayers(${t})`,"u32"))),e.isTextureCube&&(i.cubeFaceCount=new zw(new Vw("6u","u32")))}return s.build(this)}generateFilteredTexture(e,t,n,i,s="0u"){this._include("biquadraticTexture");const a=this.generateWrapFunction(e),o=this.generateTextureDimension(e,t,s);return i&&(n=`${n} + vec2<f32>(${i}) / ${o}`),`tsl_biquadraticTexture( ${t}, ${a}( ${n} ), ${o}, u32( ${s} ) )`}generateTextureLod(e,t,n,i,s,a="0u"){const o=this.generateWrapFunction(e),l=this.generateTextureDimension(e,t,a),c=e.is3DTexture||e.isData3DTexture?"vec3":"vec2";s&&(n=`${n} + ${c}<f32>(${s}) / ${c}<f32>( ${l} )`);const d=`${c}<u32>( ${o}( ${n} ) * ${c}<f32>( ${l} ) )`;return this.generateTextureLoad(e,t,d,a,i,null)}generateTextureLoad(e,t,n,i,s,a){i===null&&(i="0u"),a&&(n=`${n} + ${a}`);let o;return s?o=`textureLoad( ${t}, ${n}, ${s}, u32( ${i} ) )`:(o=`textureLoad( ${t}, ${n}, u32( ${i} ) )`,this.renderer.backend.compatibilityMode&&e.isDepthTexture&&(o+=".x")),o}generateTextureStore(e,t,n,i,s){let a;return i?a=`textureStore( ${t}, ${n}, ${i}, ${s} )`:a=`textureStore( ${t}, ${n}, ${s} )`,a}isSampleCompare(e){return e.isDepthTexture===!0&&e.compareFunction!==null}isUnfilterable(e){return this.getComponentTypeFromTexture(e)!=="float"||!this.isAvailable("float32Filterable")&&e.isDataTexture===!0&&e.type===Ci||this.isSampleCompare(e)===!1&&e.minFilter===Ki&&e.magFilter===Ki||this.renderer.backend.utils.getTextureSampleData(e).primarySamples>1}generateTexture(e,t,n,i,s,a=this.shaderStage){let o=null;return this.isUnfilterable(e)?o=this.generateTextureLod(e,t,n,i,s,"0",a):o=this._generateTextureSample(e,t,n,i,s,a),o}generateTextureGrad(e,t,n,i,s,a,o=this.shaderStage){if(o==="fragment")return a?`textureSampleGrad( ${t}, ${t}_sampler, ${n},  ${i[0]}, ${i[1]}, ${a} )`:`textureSampleGrad( ${t}, ${t}_sampler, ${n},  ${i[0]}, ${i[1]} )`;Ze(`WebGPURenderer: THREE.TextureNode.gradient() does not support ${o} shader.`)}generateTextureCompare(e,t,n,i,s,a,o=this.shaderStage){if(o==="fragment")return e.isDepthTexture===!0&&e.isArrayTexture===!0?a?`textureSampleCompare( ${t}, ${t}_sampler, ${n}, ${s}, ${i}, ${a} )`:`textureSampleCompare( ${t}, ${t}_sampler, ${n}, ${s}, ${i} )`:a?`textureSampleCompare( ${t}, ${t}_sampler, ${n}, ${i}, ${a} )`:`textureSampleCompare( ${t}, ${t}_sampler, ${n}, ${i} )`;Ze(`WebGPURenderer: THREE.DepthTexture.compareFunction() does not support ${o} shader.`)}generateTextureLevel(e,t,n,i,s,a){return this.isUnfilterable(e)===!1?a?`textureSampleLevel( ${t}, ${t}_sampler, ${n}, ${i}, ${a} )`:`textureSampleLevel( ${t}, ${t}_sampler, ${n}, ${i} )`:this.isFilteredTexture(e)?this.generateFilteredTexture(e,t,n,a,i):this.generateTextureLod(e,t,n,s,a,i)}generateTextureBias(e,t,n,i,s,a,o=this.shaderStage){if(o==="fragment")return a?`textureSampleBias( ${t}, ${t}_sampler, ${n}, ${i}, ${a} )`:`textureSampleBias( ${t}, ${t}_sampler, ${n}, ${i} )`;Ze(`WebGPURenderer: THREE.TextureNode.biasNode does not support ${o} shader.`)}getPropertyName(e,t=this.shaderStage){if(e.isNodeVarying===!0&&e.needsInterpolation===!0){if(t==="vertex")return`varyings.${e.name}`}else if(e.isNodeUniform===!0){const n=e.name,i=e.type;return i==="texture"||i==="cubeTexture"||i==="cubeDepthTexture"||i==="storageTexture"||i==="texture3D"?n:i==="buffer"||i==="storageBuffer"||i==="indirectStorageBuffer"?this.isCustomStruct(e)?n:n+".value":e.groupNode.name+"."+n}return super.getPropertyName(e)}getOutputStructName(){return"output"}getFunctionOperator(e){const t=P_e[e];return t!==void 0?(this._include(t),t):null}getNodeAccess(e,t){return t!=="compute"?e.isAtomic===!0?(Ve("WebGPURenderer: Atomic operations are only supported in compute shaders."),Fa.READ_WRITE):Fa.READ_ONLY:e.access}getStorageAccess(e,t){return L_e[this.getNodeAccess(e,t)]}getUniformFromNode(e,t,n,i=null){const s=super.getUniformFromNode(e,t,n,i),a=this.getDataFromNode(e,n,this.globalCache);if(a.uniformGPU===void 0){let o;const l=e.groupNode,c=l.name,d=this.getBindGroupArray(c,n);if(t==="texture"||t==="cubeTexture"||t==="cubeDepthTexture"||t==="storageTexture"||t==="texture3D"){let p=null;const y=this.getNodeAccess(e,n);if(t==="texture"||t==="storageTexture"?e.value.is3DTexture===!0?p=new xU(s.name,s.node,l,y):p=new LN(s.name,s.node,l,y):t==="cubeTexture"||t==="cubeDepthTexture"?p=new NX(s.name,s.node,l,y):t==="texture3D"&&(p=new xU(s.name,s.node,l,y)),p.store=e.isStorageTextureNode===!0,p.mipLevel=p.store?e.mipLevel:0,p.setVisibility(pw[n]),this.isUnfilterable(e.value)===!1&&p.store===!1){const _=new b_e(`${s.name}_sampler`,s.node,l);_.setVisibility(pw[n]),d.push(_,p),o=[_,p]}else d.push(p),o=[p]}else if(t==="buffer"||t==="storageBuffer"||t==="indirectStorageBuffer"){const p=this.getSharedDataFromNode(e);let y=p.buffer;if(y===void 0){const _=t==="buffer"?wX:E_e;y=new _(e,l),p.buffer=y}y.setVisibility(y.getVisibility()|pw[n]),d.push(y),o=y,s.name=i||"NodeBuffer_"+s.id}else{const p=this.uniformGroups[n]||(this.uniformGroups[n]={});let y=p[c];y===void 0&&(y=new RX(c,l),y.setVisibility(pw[n]),p[c]=y,d.push(y)),o=this.getNodeUniform(s,t),y.addUniform(o)}a.uniformGPU=o}return s}getBuiltin(e,t,n,i=this.shaderStage){const s=this.builtins[i]||(this.builtins[i]=new Map);return s.has(e)===!1&&s.set(e,{name:e,property:t,type:n}),t}hasBuiltin(e,t=this.shaderStage){return this.builtins[t]!==void 0&&this.builtins[t].has(e)}getVertexIndex(){return this.shaderStage==="vertex"?this.getBuiltin("vertex_index","vertexIndex","u32","attribute"):"vertexIndex"}buildFunctionCode(e){const t=e.layout,n=this.flowShaderNode(e),i=[];for(const a of t.inputs)i.push(a.name+" : "+this.getType(a.type));let s=`fn ${t.name}( ${i.join(", ")} ) -> ${this.getType(t.type)} {
${n.vars}
${n.code}
`;return n.result&&(s+=`	return ${n.result};
`),s+=`
}
`,s}getInstanceIndex(){return this.shaderStage==="vertex"?this.getBuiltin("instance_index","instanceIndex","u32","attribute"):"instanceIndex"}getInvocationLocalIndex(){return this.getBuiltin("local_invocation_index","invocationLocalIndex","u32","attribute")}getSubgroupSize(){return this.enableSubGroups(),this.getBuiltin("subgroup_size","subgroupSize","u32","attribute")}getInvocationSubgroupIndex(){return this.enableSubGroups(),this.getBuiltin("subgroup_invocation_id","invocationSubgroupIndex","u32","attribute")}getSubgroupIndex(){return this.enableSubGroups(),this.getBuiltin("subgroup_id","subgroupIndex","u32","attribute")}getDrawIndex(){return null}getFrontFacing(){return this.getBuiltin("front_facing","isFront","bool")}getFragCoord(){return this.getBuiltin("position","fragCoord","vec4<f32>")+".xy"}getFragDepth(){return"output."+this.getBuiltin("frag_depth","depth","f32","output")}getClipDistance(){return"varyings.hw_clip_distances"}isFlipY(){return!1}enableDirective(e,t=this.shaderStage){(this.directives[t]||(this.directives[t]=new Set)).add(e)}getDirectives(e){const t=[],n=this.directives[e];if(n!==void 0)for(const i of n)t.push(`enable ${i};`);return t.join(`
`)}enableSubGroups(){this.enableDirective("subgroups")}enableSubgroupsF16(){this.enableDirective("subgroups-f16")}enableClipDistances(){this.enableDirective("clip_distances")}enableShaderF16(){this.enableDirective("f16")}enableDualSourceBlending(){this.enableDirective("dual_source_blending")}enableHardwareClipping(e){this.enableClipDistances(),this.getBuiltin("clip_distances","hw_clip_distances",`array<f32, ${e} >`,"vertex")}getBuiltins(e){const t=[],n=this.builtins[e];if(n!==void 0)for(const{name:i,property:s,type:a}of n.values())t.push(`@builtin( ${i} ) ${s} : ${a}`);return t.join(`,
	`)}getScopedArray(e,t,n,i){return this.scopedArrays.has(e)===!1&&this.scopedArrays.set(e,{name:e,scope:t,bufferType:n,bufferCount:i}),e}getScopedArrays(e){if(e!=="compute")return;const t=[];for(const{name:n,scope:i,bufferType:s,bufferCount:a}of this.scopedArrays.values()){const o=this.getType(s);t.push(`var<${i}> ${n}: array< ${o}, ${a} >;`)}return t.join(`
`)}getAttributes(e){const t=[];if(e==="compute"&&(this.getBuiltin("global_invocation_id","globalId","vec3<u32>","attribute"),this.getBuiltin("workgroup_id","workgroupId","vec3<u32>","attribute"),this.getBuiltin("local_invocation_id","localId","vec3<u32>","attribute"),this.getBuiltin("num_workgroups","numWorkgroups","vec3<u32>","attribute"),this.renderer.hasFeature("subgroups")&&(this.enableDirective("subgroups",e),this.getBuiltin("subgroup_size","subgroupSize","u32","attribute"))),e==="vertex"||e==="compute"){const n=this.getBuiltins("attribute");n&&t.push(n);const i=this.getAttributesArray();for(let s=0,a=i.length;s<a;s++){const o=i[s],l=o.name,c=this.getType(o.type);t.push(`@location( ${s} ) ${l} : ${c}`)}}return t.join(`,
	`)}getStructMembers(e){const t=[];for(const n of e.members){const i=e.output?"@location( "+n.index+" ) ":"";let s=this.getType(n.type);n.atomic&&(s="atomic< "+s+" >"),t.push(`	${i+n.name} : ${s}`)}return e.output&&t.push(`	${this.getBuiltins("output")}`),t.join(`,
`)}getStructs(e){let t="";const n=this.structs[e];if(n.length>0){const i=[];for(const s of n){let a=`struct ${s.name} {
`;a+=this.getStructMembers(s),a+=`
};`,i.push(a)}t=`
`+i.join(`

`)+`
`}return t}getVar(e,t,n=null){let i=`var ${t} : `;return n!==null?i+=this.generateArrayDeclaration(e,n):i+=this.getType(e),i}getVars(e){const t=[],n=this.vars[e];if(n!==void 0)for(const i of n)t.push(`	${this.getVar(i.type,i.name,i.count)};`);return`
${t.join(`
`)}
`}getVaryings(e){const t=[];if(e==="vertex"&&this.getBuiltin("position","Vertex","vec4<f32>","vertex"),e==="vertex"||e==="fragment"){const s=this.varyings,a=this.vars[e];for(let o=0;o<s.length;o++){const l=s[o];if(l.needsInterpolation){let c=`@location( ${o} )`;if(l.interpolationType){const d=l.interpolationSampling!==null?`, ${l.interpolationSampling} )`:" )";c+=` @interpolate( ${l.interpolationType}${d}`}else/^(int|uint|ivec|uvec)/.test(l.type)&&(c+=` @interpolate( ${this.renderer.backend.compatibilityMode?"flat, either":"flat"} )`);t.push(`${c} ${l.name} : ${this.getType(l.type)}`)}else e==="vertex"&&a.includes(l)===!1&&a.push(l)}}const n=this.getBuiltins(e);n&&t.push(n);const i=t.join(`,
	`);return e==="vertex"?this._getWGSLStruct("VaryingsStruct","	"+i):i}isCustomStruct(e){const t=e.value,n=e.node,i=(t.isBufferAttribute||t.isInstancedBufferAttribute)&&n.structTypeNode!==null,s=n.value&&n.value.array&&typeof n.value.itemSize=="number"&&n.value.array.length>n.value.itemSize;return i&&!s}getUniforms(e){const t=this.uniforms[e],n=[],i=[],s=[],a={};for(const l of t){const c=l.groupNode.name,d=this.bindingsIndexes[c];if(l.type==="texture"||l.type==="cubeTexture"||l.type==="cubeDepthTexture"||l.type==="storageTexture"||l.type==="texture3D"){const p=l.node.value;this.isUnfilterable(p)===!1&&l.node.isStorageTextureNode!==!0&&(this.isSampleCompare(p)?n.push(`@binding( ${d.binding++} ) @group( ${d.group} ) var ${l.name}_sampler : sampler_comparison;`):n.push(`@binding( ${d.binding++} ) @group( ${d.group} ) var ${l.name}_sampler : sampler;`));let y,_="";const{primarySamples:v}=this.renderer.backend.utils.getTextureSampleData(p);if(v>1&&(_="_multisampled"),p.isCubeTexture===!0&&p.isDepthTexture===!0)y="texture_depth_cube";else if(p.isCubeTexture===!0)y="texture_cube<f32>";else if(p.isDepthTexture===!0)this.renderer.backend.compatibilityMode&&p.compareFunction===null?y=`texture${_}_2d<f32>`:y=`texture_depth${_}_2d${p.isArrayTexture===!0?"_array":""}`;else if(l.node.isStorageTextureNode===!0){const b=SU(p),E=this.getStorageAccess(l.node,e),T=l.node.value.is3DTexture,M=l.node.value.isArrayTexture;y=`texture_storage_${T?"3d":`2d${M?"_array":""}`}<${b}, ${E}>`}else if(p.isArrayTexture===!0||p.isDataArrayTexture===!0||p.isCompressedArrayTexture===!0)y="texture_2d_array<f32>";else if(p.is3DTexture===!0||p.isData3DTexture===!0)y="texture_3d<f32>";else{const b=this.getComponentTypeFromTexture(p).charAt(0);y=`texture${_}_2d<${b}32>`}n.push(`@binding( ${d.binding++} ) @group( ${d.group} ) var ${l.name} : ${y};`)}else if(l.type==="buffer"||l.type==="storageBuffer"||l.type==="indirectStorageBuffer"){const p=l.node,y=this.getType(p.getNodeType(this)),_=p.bufferCount,v=_>0&&l.type==="buffer"?", "+_:"",b=p.isStorageBufferNode?`storage, ${this.getStorageAccess(p,e)}`:"uniform";if(this.isCustomStruct(l))i.push(`@binding( ${d.binding++} ) @group( ${d.group} ) var<${b}> ${l.name} : ${y};`);else{const T=`	value : array< ${p.isAtomic?`atomic<${y}>`:`${y}`}${v} >`;i.push(this._getWGSLStructBinding(l.name,T,b,d.binding++,d.group))}}else{const p=this.getType(this.getVectorType(l.type)),y=l.groupNode.name;(a[y]||(a[y]={index:d.binding++,id:d.group,snippets:[]})).snippets.push(`	${l.name} : ${p}`)}}for(const l in a){const c=a[l];s.push(this._getWGSLStructBinding(l,c.snippets.join(`,
`),"uniform",c.index,c.id))}return[...n,...i,...s].join(`
`)}buildCode(){const e=this.material!==null?{fragment:{},vertex:{}}:{compute:{}};this.sortBindingGroups();for(const t in e){this.shaderStage=t;const n=e[t];n.uniforms=this.getUniforms(t),n.attributes=this.getAttributes(t),n.varyings=this.getVaryings(t),n.structs=this.getStructs(t),n.vars=this.getVars(t),n.codes=this.getCodes(t),n.directives=this.getDirectives(t),n.scopedArrays=this.getScopedArrays(t);let i=`// code

`;i+=this.flowCode[t];const s=this.flowNodes[t],a=s[s.length-1],o=a.outputNode,l=o!==void 0&&o.isOutputStructNode===!0;for(const c of s){const d=this.getFlowData(c),p=c.name;if(p&&(i.length>0&&(i+=`
`),i+=`	// flow -> ${p}
`),i+=`${d.code}
	`,c===a&&t!=="compute"){if(i+=`// result

	`,t==="vertex")i+=`varyings.Vertex = ${d.result};`;else if(t==="fragment")if(l)n.returnType=o.getNodeType(this),n.structs+="var<private> output : "+n.returnType+";",i+=`return ${d.result};`;else{let y="	@location(0) color: vec4<f32>";const _=this.getBuiltins("output");_&&(y+=`,
	`+_),n.returnType="OutputStruct",n.structs+=this._getWGSLStruct("OutputStruct",y),n.structs+=`
var<private> output : OutputStruct;`,i+=`output.color = ${d.result};

	return output;`}}}n.flow=i}if(this.shaderStage=null,this.material!==null)this.vertexShader=this._getWGSLVertexCode(e.vertex),this.fragmentShader=this._getWGSLFragmentCode(e.fragment);else{const t=this.object.workgroupSize;this.computeShader=this._getWGSLComputeCode(e.compute,t)}}getMethod(e,t=null){let n;return t!==null&&(n=this._getWGSLMethod(e+"_"+t)),n===void 0&&(n=this._getWGSLMethod(e)),n||e}getBitcastMethod(e){return`bitcast<${this.getType(e)}>`}getFloatPackingMethod(e){return this.getMethod(`floatpack_${e}_2x16`)}getFloatUnpackingMethod(e){return this.getMethod(`floatunpack_${e}_2x16`)}getTernary(e,t,n){return`select( ${n}, ${t}, ${e} )`}getType(e){return B_e[e]||e}isAvailable(e){let t=ZG[e];return t===void 0&&(e==="float32Filterable"?t=this.renderer.hasFeature("float32-filterable"):e==="clipDistance"&&(t=this.renderer.hasFeature("clip-distances")),ZG[e]=t),t}_getWGSLMethod(e){return oT[e]!==void 0&&this._include(e),I_e[e]}_include(e){const t=oT[e];return t.build(this),this.addInclude(t),t}_getWGSLVertexCode(e){return`${this.getSignature()}
// directives
${e.directives}

// structs
${e.structs}

// uniforms
${e.uniforms}

// varyings
${e.varyings}
var<private> varyings : VaryingsStruct;

// codes
${e.codes}

@vertex
fn main( ${e.attributes} ) -> VaryingsStruct {

	// vars
	${e.vars}

	// flow
	${e.flow}

	return varyings;

}
`}_getWGSLFragmentCode(e){return`${this.getSignature()}
// global
${UX}

// structs
${e.structs}

// uniforms
${e.uniforms}

// codes
${e.codes}

@fragment
fn main( ${e.varyings} ) -> ${e.returnType} {

	// vars
	${e.vars}

	// flow
	${e.flow}

}
`}_getWGSLComputeCode(e,t){const[n,i,s]=t;return`${this.getSignature()}
// directives
${e.directives}

// system
var<private> instanceIndex : u32;

// locals
${e.scopedArrays}

// structs
${e.structs}

// uniforms
${e.uniforms}

// codes
${e.codes}

@compute @workgroup_size( ${n}, ${i}, ${s} )
fn main( ${e.attributes} ) {

	// system
	instanceIndex = globalId.x
		+ globalId.y * ( ${n} * numWorkgroups.x )
		+ globalId.z * ( ${n} * numWorkgroups.x ) * ( ${i} * numWorkgroups.y );

	// vars
	${e.vars}

	// flow
	${e.flow}

}
`}_getWGSLStruct(e,t){return`
struct ${e} {
${t}
};`}_getWGSLStructBinding(e,t,n,i=0,s=0){const a=e+"Struct";return`${this._getWGSLStruct(a,t)}
@binding( ${i} ) @group( ${s} )
var<${n}> ${e} : ${a};`}}class z_e{constructor(e){this.backend=e}getCurrentDepthStencilFormat(e){let t;return e.depthTexture!==null?t=this.getTextureFormatGPU(e.depthTexture):e.depth&&e.stencil?t=be.Depth24PlusStencil8:e.depth&&(t=be.Depth24Plus),t}getTextureFormatGPU(e){return this.backend.get(e).format}getTextureSampleData(e){let t;if(e.isFramebufferTexture)t=1;else if(e.isDepthTexture&&!e.renderTarget){const s=this.backend.renderer,a=s.getRenderTarget();t=a?a.samples:s.currentSamples}else e.renderTarget&&(t=e.renderTarget.samples);t=t||1;const n=t>1&&e.renderTarget!==null&&e.isDepthTexture!==!0&&e.isFramebufferTexture!==!0;return{samples:t,primarySamples:n?1:t,isMSAA:n}}getCurrentColorFormat(e){let t;return e.textures!==null?t=this.getTextureFormatGPU(e.textures[0]):t=this.getPreferredCanvasFormat(),t}getCurrentColorFormats(e){return e.textures!==null?e.textures.map(t=>this.getTextureFormatGPU(t)):[this.getPreferredCanvasFormat()]}getCurrentColorSpace(e){return e.textures!==null?e.textures[0].colorSpace:this.backend.renderer.outputColorSpace}getPrimitiveTopology(e,t){if(e.isPoints)return zv.PointList;if(e.isLineSegments||e.isMesh&&t.wireframe===!0)return zv.LineList;if(e.isLine)return zv.LineStrip;if(e.isMesh)return zv.TriangleList}getSampleCount(e){return e>=4?4:1}getSampleCountRenderContext(e){return e.textures!==null?this.getSampleCount(e.sampleCount):this.getSampleCount(this.backend.renderer.currentSamples)}getPreferredCanvasFormat(){const t=this.backend.parameters.outputType;if(t===void 0)return navigator.gpu.getPreferredCanvasFormat();if(t===ir)return be.BGRA8Unorm;if(t===vi)return be.RGBA16Float;throw new Error("Unsupported output buffer type.")}}const LX=new Map([[Int8Array,["sint8","snorm8"]],[Uint8Array,["uint8","unorm8"]],[Int16Array,["sint16","snorm16"]],[Uint16Array,["uint16","unorm16"]],[Int32Array,["sint32","snorm32"]],[Uint32Array,["uint32","unorm32"]],[Float32Array,["float32"]]]);typeof Float16Array<"u"&&LX.set(Float16Array,["float16"]);const V_e=new Map([[lL,["float16"]]]),G_e=new Map([[Int32Array,"sint32"],[Int16Array,"sint32"],[Uint32Array,"uint32"],[Uint16Array,"uint32"],[Float32Array,"float32"]]);class k_e{constructor(e){this.backend=e}createAttribute(e,t){const n=this._getBufferAttribute(e),i=this.backend,s=i.get(n);let a=s.buffer;if(a===void 0){const o=i.device;let l=n.array;if(e.normalized===!1){if(l.constructor===Int16Array||l.constructor===Int8Array)l=new Int32Array(l);else if((l.constructor===Uint16Array||l.constructor===Uint8Array)&&(l=new Uint32Array(l),t&GPUBufferUsage.INDEX))for(let p=0;p<l.length;p++)l[p]===65535&&(l[p]=4294967295)}if(n.array=l,(n.isStorageBufferAttribute||n.isStorageInstancedBufferAttribute)&&n.itemSize===3){l=new l.constructor(n.count*4);for(let p=0;p<n.count;p++)l.set(n.array.subarray(p*3,p*3+3),p*4);n.itemSize=4,n.array=l,s._force3to4BytesAlignment=!0}const c=l.byteLength,d=c+(4-c%4)%4;a=o.createBuffer({label:n.name,size:d,usage:t,mappedAtCreation:!0}),new l.constructor(a.getMappedRange()).set(l),a.unmap(),s.buffer=a}}updateAttribute(e){const t=this._getBufferAttribute(e),n=this.backend,i=n.device,s=n.get(t),a=n.get(t).buffer;let o=t.array;if(s._force3to4BytesAlignment===!0){o=new o.constructor(t.count*4);for(let c=0;c<t.count;c++)o.set(t.array.subarray(c*3,c*3+3),c*4);t.array=o}const l=t.updateRanges;if(l.length===0)i.queue.writeBuffer(a,0,o,0);else{const c=mx(o),d=c?1:o.BYTES_PER_ELEMENT;for(let p=0,y=l.length;p<y;p++){const _=l[p];let v,b;if(s._force3to4BytesAlignment===!0){const T=Math.floor(_.start/3),M=Math.ceil(_.count/3);v=T*4*d,b=M*4*d}else v=_.start*d,b=_.count*d;const E=v*(c?o.BYTES_PER_ELEMENT:1);i.queue.writeBuffer(a,E,o,v,b)}t.clearUpdateRanges()}}createShaderVertexBuffers(e){const t=e.getAttributes(),n=new Map;for(let i=0;i<t.length;i++){const s=t[i],a=s.array.BYTES_PER_ELEMENT,o=this._getBufferAttribute(s);let l=n.get(o);if(l===void 0){let p,y;s.isInterleavedBufferAttribute===!0?(p=s.data.stride*a,y=s.data.isInstancedInterleavedBuffer?hw.Instance:hw.Vertex):(p=s.itemSize*a,y=s.isInstancedBufferAttribute?hw.Instance:hw.Vertex),s.normalized===!1&&(s.array.constructor===Int16Array||s.array.constructor===Uint16Array)&&(p=4),l={arrayStride:p,attributes:[],stepMode:y},n.set(o,l)}const c=this._getVertexFormat(s),d=s.isInterleavedBufferAttribute===!0?s.offset*a:0;l.attributes.push({shaderLocation:i,offset:d,format:c})}return Array.from(n.values())}destroyAttribute(e){const t=this.backend;t.get(this._getBufferAttribute(e)).buffer.destroy(),t.delete(e)}async getArrayBufferAsync(e){const t=this.backend,n=t.device,s=t.get(this._getBufferAttribute(e)).buffer,a=s.size,o=n.createBuffer({label:`${e.name}_readback`,size:a,usage:GPUBufferUsage.COPY_DST|GPUBufferUsage.MAP_READ}),l=n.createCommandEncoder({label:`readback_encoder_${e.name}`});l.copyBufferToBuffer(s,0,o,0,a);const c=l.finish();n.queue.submit([c]),await o.mapAsync(GPUMapMode.READ);const d=o.getMappedRange(),p=new e.array.constructor(d.slice(0));return o.unmap(),p.buffer}_getVertexFormat(e){const{itemSize:t,normalized:n}=e,i=e.array.constructor,s=e.constructor;let a;if(t===1)a=G_e.get(i);else{const l=(V_e.get(s)||LX.get(i))[n?1:0];if(l){const c=i.BYTES_PER_ELEMENT*t,p=Math.floor((c+3)/4)*4/i.BYTES_PER_ELEMENT;if(p%1)throw new Error("THREE.WebGPUAttributeUtils: Bad vertex format item size.");a=`${l}x${p}`}}return a||Ze("WebGPUAttributeUtils: Vertex format not supported yet."),a}_getBufferAttribute(e){return e.isInterleavedBufferAttribute&&(e=e.data),e}}class H_e{constructor(e){this.layoutGPU=e,this.usedTimes=0}}class W_e{constructor(e){this.backend=e,this._bindGroupLayoutCache=new Map}createBindingsLayout(e){const t=this.backend,n=t.device,i=t.get(e);if(i.layout)return i.layout.layoutGPU;const s=this._createLayoutEntries(e),a=JSON.stringify(s);let o=this._bindGroupLayoutCache.get(a);return o===void 0&&(o=new H_e(n.createBindGroupLayout({entries:s})),this._bindGroupLayoutCache.set(a,o)),o.usedTimes++,i.layout=o,i.layoutKey=a,o.layoutGPU}createBindings(e,t,n,i=0){const{backend:s}=this,a=s.get(e),o=this.createBindingsLayout(e);let l;n>0&&(a.groups===void 0&&(a.groups=[],a.versions=[]),a.versions[n]===i&&(l=a.groups[n])),l===void 0&&(l=this.createBindGroup(e,o),n>0&&(a.groups[n]=l,a.versions[n]=i)),a.group=l}updateBinding(e){const t=this.backend,n=t.device,i=e.buffer,s=t.get(e).buffer,a=e.updateRanges;if(a.length===0)n.queue.writeBuffer(s,0,i,0);else{const o=mx(i),l=o?1:i.BYTES_PER_ELEMENT;for(let c=0,d=a.length;c<d;c++){const p=a[c],y=p.start*l,_=p.count*l,v=y*(o?i.BYTES_PER_ELEMENT:1);n.queue.writeBuffer(s,v,i,y,_)}e.clearUpdateRanges()}}createBindGroupIndex(e,t){const i=this.backend.device,s=GPUBufferUsage.UNIFORM|GPUBufferUsage.COPY_DST,a=e[0],o=i.createBuffer({label:"bindingCameraIndex_"+a,size:16,usage:s});i.queue.writeBuffer(o,0,e,0);const l=[{binding:0,resource:{buffer:o}}];return i.createBindGroup({label:"bindGroupCameraIndex_"+a,layout:t,entries:l})}createBindGroup(e,t){const n=this.backend,i=n.device;let s=0;const a=[];for(const o of e.bindings){if(o.isUniformBuffer){const l=n.get(o);if(l.buffer===void 0){const c=o.byteLength,d=GPUBufferUsage.UNIFORM|GPUBufferUsage.COPY_DST,p=[];o.visibility&T0.VERTEX&&p.push("vertex"),o.visibility&T0.FRAGMENT&&p.push("fragment"),o.visibility&T0.COMPUTE&&p.push("compute");const y=`(${p.join(",")})`,_=i.createBuffer({label:`bindingBuffer${o.id}_${o.name}_${y}`,size:c,usage:d});l.buffer=_}a.push({binding:s,resource:{buffer:l.buffer}})}else if(o.isStorageBuffer){const l=n.get(o);if(l.buffer===void 0){const c=o.attribute;l.buffer=n.get(c).buffer}a.push({binding:s,resource:{buffer:l.buffer}})}else if(o.isSampledTexture){const l=n.get(o.texture);let c;if(l.externalTexture!==void 0)c=i.importExternalTexture({source:l.externalTexture});else{const d=o.store?1:l.texture.mipLevelCount,p=o.store?o.mipLevel:0;let y=`view-${l.texture.width}-${l.texture.height}`;if(l.texture.depthOrArrayLayers>1&&(y+=`-${l.texture.depthOrArrayLayers}`),y+=`-${d}-${p}`,c=l[y],c===void 0){const _=x_e.All;let v;o.isSampledCubeTexture?v=Gs.Cube:o.isSampledTexture3D?v=Gs.ThreeD:o.texture.isArrayTexture||o.texture.isDataArrayTexture||o.texture.isCompressedArrayTexture?v=Gs.TwoDArray:v=Gs.TwoD,c=l[y]=l.texture.createView({aspect:_,dimension:v,mipLevelCount:d,baseMipLevel:p})}}a.push({binding:s,resource:c})}else if(o.isSampler){const l=n.get(o.texture);a.push({binding:s,resource:l.sampler})}s++}return i.createBindGroup({label:"bindGroup_"+e.name,layout:t,entries:a})}_createLayoutEntries(e){const t=[];let n=0;for(const i of e.bindings){const s=this.backend,a={binding:n,visibility:i.visibility};if(i.isUniformBuffer||i.isStorageBuffer){const o={};i.isStorageBuffer&&(i.visibility&T0.COMPUTE&&(i.access===Fa.READ_WRITE||i.access===Fa.WRITE_ONLY)?o.type=UD.Storage:o.type=UD.ReadOnlyStorage),a.buffer=o}else if(i.isSampledTexture&&i.store){const o={};o.format=this.backend.get(i.texture).texture.format;const l=i.access;l===Fa.READ_WRITE?o.access=LD.ReadWrite:l===Fa.WRITE_ONLY?o.access=LD.WriteOnly:o.access=LD.ReadOnly,i.texture.isArrayTexture?o.viewDimension=Gs.TwoDArray:i.texture.is3DTexture&&(o.viewDimension=Gs.ThreeD),a.storageTexture=o}else if(i.isSampledTexture){const o={},{primarySamples:l}=s.utils.getTextureSampleData(i.texture);if(l>1&&(o.multisampled=!0,i.texture.isDepthTexture||(o.sampleType=i0.UnfilterableFloat)),i.texture.isDepthTexture)s.compatibilityMode&&i.texture.compareFunction===null?o.sampleType=i0.UnfilterableFloat:o.sampleType=i0.Depth;else if(i.texture.isDataTexture||i.texture.isDataArrayTexture||i.texture.isData3DTexture){const c=i.texture.type;c===Hs?o.sampleType=i0.SInt:c===Hi?o.sampleType=i0.UInt:c===Ci&&(this.backend.hasFeature("float32-filterable")?o.sampleType=i0.Float:o.sampleType=i0.UnfilterableFloat)}i.isSampledCubeTexture?o.viewDimension=Gs.Cube:i.texture.isArrayTexture||i.texture.isDataArrayTexture||i.texture.isCompressedArrayTexture?o.viewDimension=Gs.TwoDArray:i.isSampledTexture3D&&(o.viewDimension=Gs.ThreeD),a.texture=o}else if(i.isSampler){const o={};i.texture.isDepthTexture&&(i.texture.compareFunction!==null?o.type=qG.Comparison:s.compatibilityMode&&(o.type=qG.NonFiltering)),a.sampler=o}else Ze(`WebGPUBindingUtils: Unsupported binding "${i}".`);t.push(a),n++}return t}deleteBindGroupData(e){const{backend:t}=this,n=t.get(e);n.layout&&(n.layout.usedTimes--,n.layout.usedTimes===0&&this._bindGroupLayoutCache.delete(n.layoutKey),n.layout=void 0,n.layoutKey=void 0)}dispose(){this._bindGroupLayoutCache.clear()}}class q_e{constructor(e){this.backend=e,this._activePipelines=new WeakMap}setPipeline(e,t){this._activePipelines.get(e)!==t&&(e.setPipeline(t),this._activePipelines.set(e,t))}_getSampleCount(e){return this.backend.utils.getSampleCountRenderContext(e)}createRenderPipeline(e,t){const{object:n,material:i,geometry:s,pipeline:a}=e,{vertexProgram:o,fragmentProgram:l}=a,c=this.backend,d=c.device,p=c.utils,y=c.get(a),_=[];for(const Q of e.getBindings()){const se=c.get(Q),{layoutGPU:ae}=se.layout;_.push(ae)}const v=c.attributeUtils.createShaderVertexBuffers(e);let b;i.blending!==yo&&(i.blending!==Nl||i.transparent!==!1)&&(b=this._getBlending(i));let E={};i.stencilWrite===!0&&(E={compare:this._getStencilCompare(i),failOp:this._getStencilOperation(i.stencilFail),depthFailOp:this._getStencilOperation(i.stencilZFail),passOp:this._getStencilOperation(i.stencilZPass)});const T=this._getColorWriteMask(i),M=[];if(e.context.textures!==null){const Q=e.context.textures;for(let se=0;se<Q.length;se++){const ae=p.getTextureFormatGPU(Q[se]);se===0?M.push({format:ae,blend:b,writeMask:T}):M.push({format:ae,writeMask:T})}}else{const Q=p.getCurrentColorFormat(e.context);M.push({format:Q,blend:b,writeMask:T})}const R=c.get(o).module,N=c.get(l).module,P=this._getPrimitiveState(n,s,i),U=this._getDepthCompare(i),L=p.getCurrentDepthStencilFormat(e.context),F=this._getSampleCount(e.context),O={label:`renderPipeline_${i.name||i.type}_${i.id}`,vertex:Object.assign({},R,{buffers:v}),fragment:Object.assign({},N,{targets:M}),primitive:P,multisample:{count:F,alphaToCoverageEnabled:i.alphaToCoverage&&F>1},layout:d.createPipelineLayout({bindGroupLayouts:_})},B={},q=e.context.depth,j=e.context.stencil;if((q===!0||j===!0)&&(q===!0&&(B.format=L,B.depthWriteEnabled=i.depthWrite,B.depthCompare=U),j===!0&&(B.stencilFront=E,B.stencilBack={},B.stencilReadMask=i.stencilFuncMask,B.stencilWriteMask=i.stencilWriteMask),i.polygonOffset===!0&&(B.depthBias=i.polygonOffsetUnits,B.depthBiasSlopeScale=i.polygonOffsetFactor,B.depthBiasClamp=0),O.depthStencil=B),d.pushErrorScope("validation"),t===null)y.pipeline=d.createRenderPipeline(O),d.popErrorScope().then(Q=>{Q!==null&&(y.error=!0,Ze(Q.message))});else{const Q=new Promise(async se=>{try{y.pipeline=await d.createRenderPipelineAsync(O)}catch{}const ae=await d.popErrorScope();ae!==null&&(y.error=!0,Ze(ae.message)),se()});t.push(Q)}}createBundleEncoder(e,t="renderBundleEncoder"){const n=this.backend,{utils:i,device:s}=n,a=i.getCurrentDepthStencilFormat(e),o=i.getCurrentColorFormats(e),l=this._getSampleCount(e),c={label:t,colorFormats:o,depthStencilFormat:a,sampleCount:l};return s.createRenderBundleEncoder(c)}createComputePipeline(e,t){const n=this.backend,i=n.device,s=n.get(e.computeProgram).module,a=n.get(e),o=[];for(const l of t){const c=n.get(l),{layoutGPU:d}=c.layout;o.push(d)}a.pipeline=i.createComputePipeline({compute:s,layout:i.createPipelineLayout({bindGroupLayouts:o})})}_getBlending(e){let t,n;const i=e.blending,s=e.blendSrc,a=e.blendDst,o=e.blendEquation;if(i===A0){const l=e.blendSrcAlpha!==null?e.blendSrcAlpha:s,c=e.blendDstAlpha!==null?e.blendDstAlpha:a,d=e.blendEquationAlpha!==null?e.blendEquationAlpha:o;t={srcFactor:this._getBlendFactor(s),dstFactor:this._getBlendFactor(a),operation:this._getBlendOperation(o)},n={srcFactor:this._getBlendFactor(l),dstFactor:this._getBlendFactor(c),operation:this._getBlendOperation(d)}}else{const l=e.premultipliedAlpha,c=(d,p,y,_)=>{t={srcFactor:d,dstFactor:p,operation:n0.Add},n={srcFactor:y,dstFactor:_,operation:n0.Add}};if(l)switch(i){case Nl:c(Ti.One,Ti.OneMinusSrcAlpha,Ti.One,Ti.OneMinusSrcAlpha);break;case V0:c(Ti.One,Ti.One,Ti.One,Ti.One);break;case G0:c(Ti.Zero,Ti.OneMinusSrc,Ti.Zero,Ti.One);break;case k0:c(Ti.Dst,Ti.OneMinusSrcAlpha,Ti.Zero,Ti.One);break}else switch(i){case Nl:c(Ti.SrcAlpha,Ti.OneMinusSrcAlpha,Ti.One,Ti.OneMinusSrcAlpha);break;case V0:c(Ti.SrcAlpha,Ti.One,Ti.One,Ti.One);break;case G0:Ze("WebGPURenderer: SubtractiveBlending requires material.premultipliedAlpha = true");break;case k0:Ze("WebGPURenderer: MultiplyBlending requires material.premultipliedAlpha = true");break}}if(t!==void 0&&n!==void 0)return{color:t,alpha:n};Ze("WebGPURenderer: Invalid blending: ",i)}_getBlendFactor(e){let t;switch(e){case Qf:t=Ti.Zero;break;case nC:t=Ti.One;break;case iC:t=Ti.Src;break;case rC:t=Ti.OneMinusSrc;break;case nx:t=Ti.SrcAlpha;break;case ix:t=Ti.OneMinusSrcAlpha;break;case oC:t=Ti.Dst;break;case lC:t=Ti.OneMinusDst;break;case sC:t=Ti.DstAlpha;break;case aC:t=Ti.OneMinusDstAlpha;break;case uC:t=Ti.SrcAlphaSaturated;break;case Bde:t=Ti.Constant;break;case Ide:t=Ti.OneMinusConstant;break;default:Ze("WebGPURenderer: Blend factor not supported.",e)}return t}_getStencilCompare(e){let t;const n=e.stencilFunc;switch(n){case Gk:t=Ua.Never;break;case Qw:t=Ua.Always;break;case kk:t=Ua.Less;break;case Wk:t=Ua.LessEqual;break;case Hk:t=Ua.Equal;break;case $k:t=Ua.GreaterEqual;break;case qk:t=Ua.Greater;break;case Xk:t=Ua.NotEqual;break;default:Ze("WebGPURenderer: Invalid stencil function.",n)}return t}_getStencilOperation(e){let t;switch(e){case Yp:t=Xp.Keep;break;case Lk:t=Xp.Zero;break;case Pk:t=Xp.Replace;break;case Vk:t=Xp.Invert;break;case Bk:t=Xp.IncrementClamp;break;case Ik:t=Xp.DecrementClamp;break;case Fk:t=Xp.IncrementWrap;break;case zk:t=Xp.DecrementWrap;break;default:Ze("WebGPURenderer: Invalid stencil operation.",t)}return t}_getBlendOperation(e){let t;switch(e){case La:t=n0.Add;break;case eC:t=n0.Subtract;break;case tC:t=n0.ReverseSubtract;break;case ZU:t=n0.Min;break;case KU:t=n0.Max;break;default:Ze("WebGPUPipelineUtils: Blend equation not supported.",e)}return t}_getPrimitiveState(e,t,n){const i={},s=this.backend.utils;i.topology=s.getPrimitiveTopology(e,n),t.index!==null&&e.isLine===!0&&e.isLineSegments!==!0&&(i.stripIndexFormat=t.index.array instanceof Uint16Array?Ox.Uint16:Ox.Uint32);let a=n.side===gr;return e.isMesh&&e.matrixWorld.determinant()<0&&(a=!a),i.frontFace=a===!0?kG.CW:kG.CCW,i.cullMode=n.side===xa?HG.None:HG.Back,i}_getColorWriteMask(e){return e.colorWrite===!0?WG.All:WG.None}_getDepthCompare(e){let t;if(e.depthTest===!1)t=Ua.Always;else{const n=e.depthFunc;switch(n){case rx:t=Ua.Never;break;case sx:t=Ua.Always;break;case ax:t=Ua.Less;break;case Oh:t=Ua.LessEqual;break;case ox:t=Ua.Equal;break;case lx:t=Ua.GreaterEqual;break;case ux:t=Ua.Greater;break;case cx:t=Ua.NotEqual;break;default:Ze("WebGPUPipelineUtils: Invalid depth function.",n)}}return t}}class X_e extends OX{constructor(e,t,n=2048){super(n),this.device=e,this.type=t,this.querySet=this.device.createQuerySet({type:"timestamp",count:this.maxQueries,label:`queryset_global_timestamp_${t}`});const i=this.maxQueries*8;this.resolveBuffer=this.device.createBuffer({label:`buffer_timestamp_resolve_${t}`,size:i,usage:GPUBufferUsage.QUERY_RESOLVE|GPUBufferUsage.COPY_SRC}),this.resultBuffer=this.device.createBuffer({label:`buffer_timestamp_result_${t}`,size:i,usage:GPUBufferUsage.COPY_DST|GPUBufferUsage.MAP_READ})}allocateQueriesForContext(e){if(!this.trackTimestamp||this.isDisposed)return null;if(this.currentQueryIndex+2>this.maxQueries)return cr(`WebGPUTimestampQueryPool [${this.type}]: Maximum number of queries exceeded, when using trackTimestamp it is necessary to resolves the queries via renderer.resolveTimestampsAsync( THREE.TimestampQuery.${this.type.toUpperCase()} ).`),null;const t=this.currentQueryIndex;return this.currentQueryIndex+=2,this.queryOffsets.set(e,t),t}async resolveQueriesAsync(){if(!this.trackTimestamp||this.currentQueryIndex===0||this.isDisposed)return this.lastValue;if(this.pendingResolve)return this.pendingResolve;this.pendingResolve=this._resolveQueries();try{return await this.pendingResolve}finally{this.pendingResolve=null}}async _resolveQueries(){if(this.isDisposed)return this.lastValue;try{if(this.resultBuffer.mapState!=="unmapped")return this.lastValue;const e=new Map(this.queryOffsets),t=this.currentQueryIndex,n=t*8;this.currentQueryIndex=0,this.queryOffsets.clear();const i=this.device.createCommandEncoder();i.resolveQuerySet(this.querySet,0,t,this.resolveBuffer,0),i.copyBufferToBuffer(this.resolveBuffer,0,this.resultBuffer,0,n);const s=i.finish();if(this.device.queue.submit([s]),this.resultBuffer.mapState!=="unmapped")return this.lastValue;if(await this.resultBuffer.mapAsync(GPUMapMode.READ,0,n),this.isDisposed)return this.resultBuffer.mapState==="mapped"&&this.resultBuffer.unmap(),this.lastValue;const a=new BigUint64Array(this.resultBuffer.getMappedRange(0,n)),o={},l=[];for(const[d,p]of e){const y=d.match(/^(.*):f(\d+)$/),_=parseInt(y[2]);l.includes(_)===!1&&l.push(_),o[_]===void 0&&(o[_]=0);const v=a[p],b=a[p+1],E=Number(b-v)/1e6;this.timestamps.set(d,E),o[_]+=E}const c=o[l[l.length-1]];return this.resultBuffer.unmap(),this.lastValue=c,this.frames=l,c}catch(e){return Ze("Error resolving queries:",e),this.resultBuffer.mapState==="mapped"&&this.resultBuffer.unmap(),this.lastValue}}async dispose(){if(!this.isDisposed){if(this.isDisposed=!0,this.pendingResolve)try{await this.pendingResolve}catch(e){Ze("Error waiting for pending resolve:",e)}if(this.resultBuffer&&this.resultBuffer.mapState==="mapped")try{this.resultBuffer.unmap()}catch(e){Ze("Error unmapping buffer:",e)}this.querySet&&(this.querySet.destroy(),this.querySet=null),this.resolveBuffer&&(this.resolveBuffer.destroy(),this.resolveBuffer=null),this.resultBuffer&&(this.resultBuffer.destroy(),this.resultBuffer=null),this.queryOffsets.clear(),this.pendingResolve=null}}}class $_e extends DX{constructor(e={}){super(e),this.isWebGPUBackend=!0,this.parameters.alpha=e.alpha===void 0?!0:e.alpha,this.parameters.compatibilityMode=e.compatibilityMode===void 0?!1:e.compatibilityMode,this.parameters.requiredLimits=e.requiredLimits===void 0?{}:e.requiredLimits,this.compatibilityMode=this.parameters.compatibilityMode,this.device=null,this.defaultRenderPassdescriptor=null,this.utils=new z_e(this),this.attributeUtils=new k_e(this),this.bindingUtils=new W_e(this),this.pipelineUtils=new q_e(this),this.textureUtils=new R_e(this),this.occludedResolveCache=new Map}async init(e){await super.init(e);const t=this.parameters;let n;if(t.device===void 0){const i={powerPreference:t.powerPreference,featureLevel:t.compatibilityMode?"compatibility":void 0},s=typeof navigator<"u"?await navigator.gpu.requestAdapter(i):null;if(s===null)throw new Error("WebGPUBackend: Unable to create WebGPU adapter.");const a=Object.values(bU),o=[];for(const c of a)s.features.has(c)&&o.push(c);const l={requiredFeatures:o,requiredLimits:t.requiredLimits};n=await s.requestDevice(l)}else n=t.device;n.lost.then(i=>{if(i.reason==="destroyed")return;const s={api:"WebGPU",message:i.message||"Unknown reason",reason:i.reason||null,originalEvent:i};e.onDeviceLost(s)}),this.device=n,this.trackTimestamp=this.trackTimestamp&&this.hasFeature(bU.TimestampQuery),this.updateSize()}get context(){const e=this.renderer.getCanvasTarget(),t=this.get(e);let n=t.context;if(n===void 0){const i=this.parameters;e.isDefaultCanvasTarget===!0&&i.context!==void 0?n=i.context:n=e.domElement.getContext("webgpu"),"setAttribute"in e.domElement&&e.domElement.setAttribute("data-engine",`three.js r${Lm} webgpu`);const s=i.alpha?"premultiplied":"opaque",a=i.outputType===vi?"extended":"standard";n.configure({device:this.device,format:this.utils.getPreferredCanvasFormat(),usage:GPUTextureUsage.RENDER_ATTACHMENT|GPUTextureUsage.COPY_SRC,alphaMode:s,toneMapping:{mode:a}}),t.context=n}return n}get coordinateSystem(){return Il}async getArrayBufferAsync(e){return await this.attributeUtils.getArrayBufferAsync(e)}getContext(){return this.context}_getDefaultRenderPassDescriptor(){const e=this.renderer,t=e.getCanvasTarget(),n=this.get(t),i=e.currentSamples;let s=n.descriptor;if(s===void 0||n.samples!==i){s={colorAttachments:[{view:null}]},(e.depth===!0||e.stencil===!0)&&(s.depthStencilAttachment={view:this.textureUtils.getDepthBuffer(e.depth,e.stencil).createView()});const o=s.colorAttachments[0];i>0?o.view=this.textureUtils.getColorBuffer().createView():o.resolveTarget=void 0,n.descriptor=s,n.samples=i}const a=s.colorAttachments[0];return i>0?a.resolveTarget=this.context.getCurrentTexture().createView():a.view=this.context.getCurrentTexture().createView(),s}_isRenderCameraDepthArray(e){return e.depthTexture&&e.depthTexture.image.depth>1&&e.camera.isArrayCamera}_getRenderPassDescriptor(e,t={}){const n=e.renderTarget,i=this.get(n);let s=i.descriptors;(s===void 0||i.width!==n.width||i.height!==n.height||i.samples!==n.samples)&&(s={},i.descriptors=s);const a=e.getCacheKey();let o=s[a];if(o===void 0){const c=e.textures,d=[];let p;const y=this._isRenderCameraDepthArray(e);for(let _=0;_<c.length;_++){const v=this.get(c[_]),b={label:`colorAttachment_${_}`,baseMipLevel:e.activeMipmapLevel,mipLevelCount:1,baseArrayLayer:e.activeCubeFace,arrayLayerCount:1,dimension:Gs.TwoD};if(n.isRenderTarget3D)p=e.activeCubeFace,b.baseArrayLayer=0,b.dimension=Gs.ThreeD,b.depthOrArrayLayers=c[_].image.depth;else if(n.isRenderTarget&&c[_].image.depth>1)if(y===!0){const E=e.camera.cameras;for(let T=0;T<E.length;T++){const M={...b,baseArrayLayer:T,arrayLayerCount:1,dimension:Gs.TwoD},R=v.texture.createView(M);d.push({view:R,resolveTarget:void 0,depthSlice:void 0})}}else b.dimension=Gs.TwoDArray,b.depthOrArrayLayers=c[_].image.depth;if(y!==!0){const E=v.texture.createView(b);let T,M;v.msaaTexture!==void 0?(T=v.msaaTexture.createView(),M=E):(T=E,M=void 0),d.push({view:T,resolveTarget:M,depthSlice:p})}}if(o={textureViews:d},e.depth){const _=this.get(e.depthTexture),v={};(e.depthTexture.isArrayTexture||e.depthTexture.isCubeTexture)&&(v.dimension=Gs.TwoD,v.arrayLayerCount=1,v.baseArrayLayer=e.activeCubeFace),o.depthStencilView=_.texture.createView(v)}s[a]=o,i.width=n.width,i.height=n.height,i.samples=n.samples,i.activeMipmapLevel=e.activeMipmapLevel,i.activeCubeFace=e.activeCubeFace}const l={colorAttachments:[]};for(let c=0;c<o.textureViews.length;c++){const d=o.textureViews[c];let p={r:0,g:0,b:0,a:1};c===0&&t.clearValue&&(p=t.clearValue),l.colorAttachments.push({view:d.view,depthSlice:d.depthSlice,resolveTarget:d.resolveTarget,loadOp:t.loadOp||tr.Load,storeOp:t.storeOp||Xo.Store,clearValue:p})}return o.depthStencilView&&(l.depthStencilAttachment={view:o.depthStencilView}),l}beginRender(e){const t=this.get(e),n=this.device,i=e.occlusionQueryCount;let s;i>0&&(t.currentOcclusionQuerySet&&t.currentOcclusionQuerySet.destroy(),t.currentOcclusionQueryBuffer&&t.currentOcclusionQueryBuffer.destroy(),t.currentOcclusionQuerySet=t.occlusionQuerySet,t.currentOcclusionQueryBuffer=t.occlusionQueryBuffer,t.currentOcclusionQueryObjects=t.occlusionQueryObjects,s=n.createQuerySet({type:"occlusion",count:i,label:`occlusionQuerySet_${e.id}`}),t.occlusionQuerySet=s,t.occlusionQueryIndex=0,t.occlusionQueryObjects=new Array(i),t.lastOcclusionObject=null);let a;e.textures===null?a=this._getDefaultRenderPassDescriptor():a=this._getRenderPassDescriptor(e,{loadOp:tr.Load}),this.initTimestampQuery(Yc.RENDER,this.getTimestampUID(e),a),a.occlusionQuerySet=s;const o=a.depthStencilAttachment;if(e.textures!==null){const c=a.colorAttachments;for(let d=0;d<c.length;d++){const p=c[d];e.clearColor?(p.clearValue=d===0?e.clearColorValue:{r:0,g:0,b:0,a:1},p.loadOp=tr.Clear):p.loadOp=tr.Load,p.storeOp=Xo.Store}}else{const c=a.colorAttachments[0];e.clearColor?(c.clearValue=e.clearColorValue,c.loadOp=tr.Clear):c.loadOp=tr.Load,c.storeOp=Xo.Store}e.depth&&(e.clearDepth?(o.depthClearValue=e.clearDepthValue,o.depthLoadOp=tr.Clear):o.depthLoadOp=tr.Load,o.depthStoreOp=Xo.Store),e.stencil&&(e.clearStencil?(o.stencilClearValue=e.clearStencilValue,o.stencilLoadOp=tr.Clear):o.stencilLoadOp=tr.Load,o.stencilStoreOp=Xo.Store);const l=n.createCommandEncoder({label:"renderContext_"+e.id});if(this._isRenderCameraDepthArray(e)===!0){const c=e.camera.cameras;!t.layerDescriptors||t.layerDescriptors.length!==c.length?this._createDepthLayerDescriptors(e,t,a,c):this._updateDepthLayerDescriptors(e,t,c),t.bundleEncoders=[],t.bundleSets=[];for(let d=0;d<c.length;d++){const p=this.pipelineUtils.createBundleEncoder(e,"renderBundleArrayCamera_"+d),y={attributes:{},bindingGroups:[],pipeline:null,index:null};t.bundleEncoders.push(p),t.bundleSets.push(y)}t.currentPass=null}else{const c=l.beginRenderPass(a);t.currentPass=c,e.viewport&&this.updateViewport(e),e.scissor&&this.updateScissor(e)}t.descriptor=a,t.encoder=l,t.currentSets={attributes:{},bindingGroups:[],pipeline:null,index:null},t.renderBundles=[]}_createDepthLayerDescriptors(e,t,n,i){const s=n.depthStencilAttachment;t.layerDescriptors=[];const a=this.get(e.depthTexture);a.viewCache||(a.viewCache=[]);for(let o=0;o<i.length;o++){const l={...n,colorAttachments:[{...n.colorAttachments[0],view:n.colorAttachments[o].view}]};if(n.depthStencilAttachment){const c=o;a.viewCache[c]||(a.viewCache[c]=a.texture.createView({dimension:Gs.TwoD,baseArrayLayer:o,arrayLayerCount:1})),l.depthStencilAttachment={view:a.viewCache[c],depthLoadOp:s.depthLoadOp||tr.Clear,depthStoreOp:s.depthStoreOp||Xo.Store,depthClearValue:s.depthClearValue||1},e.stencil&&(l.depthStencilAttachment.stencilLoadOp=s.stencilLoadOp,l.depthStencilAttachment.stencilStoreOp=s.stencilStoreOp,l.depthStencilAttachment.stencilClearValue=s.stencilClearValue)}else l.depthStencilAttachment={...s};t.layerDescriptors.push(l)}}_updateDepthLayerDescriptors(e,t,n){for(let i=0;i<n.length;i++){const s=t.layerDescriptors[i];if(s.depthStencilAttachment){const a=s.depthStencilAttachment;e.depth&&(e.clearDepth?(a.depthClearValue=e.clearDepthValue,a.depthLoadOp=tr.Clear):a.depthLoadOp=tr.Load),e.stencil&&(e.clearStencil?(a.stencilClearValue=e.clearStencilValue,a.stencilLoadOp=tr.Clear):a.stencilLoadOp=tr.Load)}}}finishRender(e){const t=this.get(e),n=e.occlusionQueryCount;t.renderBundles.length>0&&t.currentPass.executeBundles(t.renderBundles),n>t.occlusionQueryIndex&&t.currentPass.endOcclusionQuery();const i=t.encoder;if(this._isRenderCameraDepthArray(e)===!0){const s=[];for(let a=0;a<t.bundleEncoders.length;a++){const o=t.bundleEncoders[a];s.push(o.finish())}for(let a=0;a<t.layerDescriptors.length;a++)if(a<s.length){const o=t.layerDescriptors[a],l=i.beginRenderPass(o);if(e.viewport){const{x:c,y:d,width:p,height:y,minDepth:_,maxDepth:v}=e.viewportValue;l.setViewport(c,d,p,y,_,v)}if(e.scissor){const{x:c,y:d,width:p,height:y}=e.scissorValue;l.setScissorRect(c,d,p,y)}l.executeBundles([s[a]]),l.end()}}else t.currentPass&&t.currentPass.end();if(n>0){const s=n*8;let a=this.occludedResolveCache.get(s);a===void 0&&(a=this.device.createBuffer({size:s,usage:GPUBufferUsage.QUERY_RESOLVE|GPUBufferUsage.COPY_SRC}),this.occludedResolveCache.set(s,a));const o=this.device.createBuffer({size:s,usage:GPUBufferUsage.COPY_DST|GPUBufferUsage.MAP_READ});t.encoder.resolveQuerySet(t.occlusionQuerySet,0,n,a,0),t.encoder.copyBufferToBuffer(a,0,o,0,s),t.occlusionQueryBuffer=o,this.resolveOccludedAsync(e)}if(this.device.queue.submit([t.encoder.finish()]),e.textures!==null){const s=e.textures;for(let a=0;a<s.length;a++){const o=s[a];o.generateMipmaps===!0&&this.textureUtils.generateMipmaps(o)}}}isOccluded(e,t){const n=this.get(e);return n.occluded&&n.occluded.has(t)}async resolveOccludedAsync(e){const t=this.get(e),{currentOcclusionQueryBuffer:n,currentOcclusionQueryObjects:i}=t;if(n&&i){const s=new WeakSet;t.currentOcclusionQueryObjects=null,t.currentOcclusionQueryBuffer=null,await n.mapAsync(GPUMapMode.READ);const a=n.getMappedRange(),o=new BigUint64Array(a);for(let l=0;l<i.length;l++)o[l]===BigInt(0)&&s.add(i[l]);n.destroy(),t.occluded=s}}updateViewport(e){const{currentPass:t}=this.get(e),{x:n,y:i,width:s,height:a,minDepth:o,maxDepth:l}=e.viewportValue;t.setViewport(n,i,s,a,o,l)}updateScissor(e){const{currentPass:t}=this.get(e),{x:n,y:i,width:s,height:a}=e.scissorValue;t.setScissorRect(n,i,s,a)}getClearColor(){const e=super.getClearColor();return this.renderer.alpha===!0&&(e.r*=e.a,e.g*=e.a,e.b*=e.a),e}clear(e,t,n,i=null){const s=this.device,a=this.renderer;let o=[],l,c,d,p;if(e){const v=this.getClearColor();c={r:v.r,g:v.g,b:v.b,a:v.a}}if(i===null){d=a.depth,p=a.stencil;const v=this._getDefaultRenderPassDescriptor();if(e){o=v.colorAttachments;const b=o[0];b.clearValue=c,b.loadOp=tr.Clear,b.storeOp=Xo.Store}(d||p)&&(l=v.depthStencilAttachment)}else{d=i.depth,p=i.stencil;const v={loadOp:e?tr.Clear:tr.Load,clearValue:e?c:void 0};d&&(v.depthLoadOp=t?tr.Clear:tr.Load,v.depthClearValue=t?a.getClearDepth():void 0,v.depthStoreOp=Xo.Store),p&&(v.stencilLoadOp=n?tr.Clear:tr.Load,v.stencilClearValue=n?a.getClearStencil():void 0,v.stencilStoreOp=Xo.Store);const b=this._getRenderPassDescriptor(i,v);o=b.colorAttachments,l=b.depthStencilAttachment}d&&l&&(t?(l.depthLoadOp=tr.Clear,l.depthClearValue=a.getClearDepth(),l.depthStoreOp=Xo.Store):(l.depthLoadOp=tr.Load,l.depthStoreOp=Xo.Store)),p&&l&&(n?(l.stencilLoadOp=tr.Clear,l.stencilClearValue=a.getClearStencil(),l.stencilStoreOp=Xo.Store):(l.stencilLoadOp=tr.Load,l.stencilStoreOp=Xo.Store));const y=s.createCommandEncoder({label:"clear"});y.beginRenderPass({colorAttachments:o,depthStencilAttachment:l}).end(),s.queue.submit([y.finish()])}beginCompute(e){const t=this.get(e),n={label:"computeGroup_"+e.id};this.initTimestampQuery(Yc.COMPUTE,this.getTimestampUID(e),n),t.cmdEncoderGPU=this.device.createCommandEncoder({label:"computeGroup_"+e.id}),t.passEncoderGPU=t.cmdEncoderGPU.beginComputePass(n)}compute(e,t,n,i,s=null){const a=this.get(t),{passEncoderGPU:o}=this.get(e),l=this.get(i).pipeline;this.pipelineUtils.setPipeline(o,l);for(let c=0,d=n.length;c<d;c++){const p=n[c],y=this.get(p);o.setBindGroup(c,y.group)}if(s===null&&(s=t.count),s&&typeof s=="object"&&s.isIndirectStorageBufferAttribute){const c=this.get(s).buffer;o.dispatchWorkgroupsIndirect(c,0);return}if(typeof s=="number"){const c=s;if(a.dispatchSize===void 0||a.count!==c){a.dispatchSize=[0,1,1],a.count=c;const d=t.workgroupSize;let p=d[0];for(let v=1;v<d.length;v++)p*=d[v];const y=Math.ceil(c/p),_=this.device.limits.maxComputeWorkgroupsPerDimension;s=[y,1,1],y>_&&(s[0]=Math.min(y,_),s[1]=Math.ceil(y/_)),a.dispatchSize=s}s=a.dispatchSize}o.dispatchWorkgroups(s[0],s[1]||1,s[2]||1)}finishCompute(e){const t=this.get(e);t.passEncoderGPU.end(),this.device.queue.submit([t.cmdEncoderGPU.finish()])}draw(e,t){const{object:n,material:i,context:s,pipeline:a}=e,o=e.getBindings(),l=this.get(s),c=this.get(a),d=c.pipeline;if(c.error===!0)return;const p=e.getIndex(),y=p!==null,_=e.getDrawParameters();if(_===null)return;const v=(E,T)=>{this.pipelineUtils.setPipeline(E,d),T.pipeline=d;const M=T.bindingGroups;for(let N=0,P=o.length;N<P;N++){const U=o[N],L=this.get(U);M[U.index]!==U.id&&(E.setBindGroup(U.index,L.group),M[U.index]=U.id)}if(y===!0&&T.index!==p){const N=this.get(p).buffer,P=p.array instanceof Uint16Array?Ox.Uint16:Ox.Uint32;E.setIndexBuffer(N,P),T.index=p}const R=e.getVertexBuffers();for(let N=0,P=R.length;N<P;N++){const U=R[N];if(T.attributes[N]!==U){const L=this.get(U).buffer;E.setVertexBuffer(N,L),T.attributes[N]=U}}s.stencil===!0&&i.stencilWrite===!0&&l.currentStencilRef!==i.stencilRef&&(E.setStencilReference(i.stencilRef),l.currentStencilRef=i.stencilRef)},b=(E,T)=>{if(v(E,T),n.isBatchedMesh===!0){const M=n._multiDrawStarts,R=n._multiDrawCounts,N=n._multiDrawCount,P=n._multiDrawInstances;P!==null&&cr("WebGPUBackend: renderMultiDrawInstances has been deprecated and will be removed in r184. Append to renderMultiDraw arguments and use indirection.");for(let U=0;U<N;U++){const L=P?P[U]:1,F=L>1?0:U;y===!0?E.drawIndexed(R[U],L,M[U]/p.array.BYTES_PER_ELEMENT,0,F):E.draw(R[U],L,M[U],F),t.update(n,R[U],L)}}else if(y===!0){const{vertexCount:M,instanceCount:R,firstVertex:N}=_,P=e.getIndirect();if(P!==null){const U=this.get(P).buffer,L=e.getIndirectOffset(),F=Array.isArray(L)?L:[L];for(let O=0;O<F.length;O++)E.drawIndexedIndirect(U,F[O])}else E.drawIndexed(M,R,N,0,0);t.update(n,M,R)}else{const{vertexCount:M,instanceCount:R,firstVertex:N}=_,P=e.getIndirect();if(P!==null){const U=this.get(P).buffer,L=e.getIndirectOffset(),F=Array.isArray(L)?L:[L];for(let O=0;O<F.length;O++)E.drawIndirect(U,F[O])}else E.draw(M,R,N,0);t.update(n,M,R)}};if(e.camera.isArrayCamera&&e.camera.cameras.length>0){const E=this.get(e.camera),T=e.camera.cameras,M=e.getBindingGroup("cameraIndex");if(E.indexesGPU===void 0||E.indexesGPU.length!==T.length){const N=this.get(M),P=[],U=new Uint32Array([0,0,0,0]);for(let L=0,F=T.length;L<F;L++){U[0]=L;const{layoutGPU:O}=N.layout,B=this.bindingUtils.createBindGroupIndex(U,O);P.push(B)}E.indexesGPU=P}const R=this.renderer.getPixelRatio();for(let N=0,P=T.length;N<P;N++){const U=T[N];if(n.layers.test(U.layers)){const L=U.viewport;let F=l.currentPass,O=l.currentSets;if(l.bundleEncoders){const B=l.bundleEncoders[N],q=l.bundleSets[N];F=B,O=q}L&&F.setViewport(Math.floor(L.x*R),Math.floor(L.y*R),Math.floor(L.width*R),Math.floor(L.height*R),s.viewportValue.minDepth,s.viewportValue.maxDepth),M&&E.indexesGPU&&(F.setBindGroup(M.index,E.indexesGPU[N]),O.bindingGroups[M.index]=M.id),b(F,O)}}}else if(l.currentPass){if(l.occlusionQuerySet!==void 0){const E=l.lastOcclusionObject;E!==n&&(E!==null&&E.occlusionTest===!0&&(l.currentPass.endOcclusionQuery(),l.occlusionQueryIndex++),n.occlusionTest===!0&&(l.currentPass.beginOcclusionQuery(l.occlusionQueryIndex),l.occlusionQueryObjects[l.occlusionQueryIndex]=n),l.lastOcclusionObject=n)}b(l.currentPass,l.currentSets)}}needsRenderUpdate(e){const t=this.get(e),{object:n,material:i}=e,s=this.utils,a=s.getSampleCountRenderContext(e.context),o=s.getCurrentColorSpace(e.context),l=s.getCurrentColorFormat(e.context),c=s.getCurrentDepthStencilFormat(e.context),d=s.getPrimitiveTopology(n,i);let p=!1;return(t.material!==i||t.materialVersion!==i.version||t.transparent!==i.transparent||t.blending!==i.blending||t.premultipliedAlpha!==i.premultipliedAlpha||t.blendSrc!==i.blendSrc||t.blendDst!==i.blendDst||t.blendEquation!==i.blendEquation||t.blendSrcAlpha!==i.blendSrcAlpha||t.blendDstAlpha!==i.blendDstAlpha||t.blendEquationAlpha!==i.blendEquationAlpha||t.colorWrite!==i.colorWrite||t.depthWrite!==i.depthWrite||t.depthTest!==i.depthTest||t.depthFunc!==i.depthFunc||t.stencilWrite!==i.stencilWrite||t.stencilFunc!==i.stencilFunc||t.stencilFail!==i.stencilFail||t.stencilZFail!==i.stencilZFail||t.stencilZPass!==i.stencilZPass||t.stencilFuncMask!==i.stencilFuncMask||t.stencilWriteMask!==i.stencilWriteMask||t.side!==i.side||t.alphaToCoverage!==i.alphaToCoverage||t.sampleCount!==a||t.colorSpace!==o||t.colorFormat!==l||t.depthStencilFormat!==c||t.primitiveTopology!==d||t.clippingContextCacheKey!==e.clippingContextCacheKey)&&(t.material=i,t.materialVersion=i.version,t.transparent=i.transparent,t.blending=i.blending,t.premultipliedAlpha=i.premultipliedAlpha,t.blendSrc=i.blendSrc,t.blendDst=i.blendDst,t.blendEquation=i.blendEquation,t.blendSrcAlpha=i.blendSrcAlpha,t.blendDstAlpha=i.blendDstAlpha,t.blendEquationAlpha=i.blendEquationAlpha,t.colorWrite=i.colorWrite,t.depthWrite=i.depthWrite,t.depthTest=i.depthTest,t.depthFunc=i.depthFunc,t.stencilWrite=i.stencilWrite,t.stencilFunc=i.stencilFunc,t.stencilFail=i.stencilFail,t.stencilZFail=i.stencilZFail,t.stencilZPass=i.stencilZPass,t.stencilFuncMask=i.stencilFuncMask,t.stencilWriteMask=i.stencilWriteMask,t.side=i.side,t.alphaToCoverage=i.alphaToCoverage,t.sampleCount=a,t.colorSpace=o,t.colorFormat=l,t.depthStencilFormat=c,t.primitiveTopology=d,t.clippingContextCacheKey=e.clippingContextCacheKey,p=!0),p}getRenderCacheKey(e){const{object:t,material:n}=e,i=this.utils,s=e.context,a=t.isMesh&&t.matrixWorld.determinant()<0;return[n.transparent,n.blending,n.premultipliedAlpha,n.blendSrc,n.blendDst,n.blendEquation,n.blendSrcAlpha,n.blendDstAlpha,n.blendEquationAlpha,n.colorWrite,n.depthWrite,n.depthTest,n.depthFunc,n.stencilWrite,n.stencilFunc,n.stencilFail,n.stencilZFail,n.stencilZPass,n.stencilFuncMask,n.stencilWriteMask,n.side,a,i.getSampleCountRenderContext(s),i.getCurrentColorSpace(s),i.getCurrentColorFormat(s),i.getCurrentDepthStencilFormat(s),i.getPrimitiveTopology(t,n),e.getGeometryCacheKey(),e.clippingContextCacheKey].join()}updateSampler(e){return this.textureUtils.updateSampler(e)}createDefaultTexture(e){return this.textureUtils.createDefaultTexture(e)}createTexture(e,t){this.textureUtils.createTexture(e,t)}updateTexture(e,t){this.textureUtils.updateTexture(e,t)}generateMipmaps(e){this.textureUtils.generateMipmaps(e)}destroyTexture(e,t=!1){this.textureUtils.destroyTexture(e,t)}async copyTextureToBuffer(e,t,n,i,s,a){return this.textureUtils.copyTextureToBuffer(e,t,n,i,s,a)}initTimestampQuery(e,t,n){if(!this.trackTimestamp)return;this.timestampQueryPool[e]||(this.timestampQueryPool[e]=new X_e(this.device,e,2048));const i=this.timestampQueryPool[e],s=i.allocateQueriesForContext(t);n.timestampWrites={querySet:i.querySet,beginningOfPassWriteIndex:s,endOfPassWriteIndex:s+1}}createNodeBuilder(e,t){return new F_e(e,t)}createProgram(e){const t=this.get(e);t.module={module:this.device.createShaderModule({code:e.code,label:e.stage+(e.name!==""?`_${e.name}`:"")}),entryPoint:"main"}}destroyProgram(e){this.delete(e)}createRenderPipeline(e,t){this.pipelineUtils.createRenderPipeline(e,t)}createComputePipeline(e,t){this.pipelineUtils.createComputePipeline(e,t)}beginBundle(e){const t=this.get(e);t._currentPass=t.currentPass,t._currentSets=t.currentSets,t.currentSets={attributes:{},bindingGroups:[],pipeline:null,index:null},t.currentPass=this.pipelineUtils.createBundleEncoder(e)}finishBundle(e,t){const n=this.get(e),s=n.currentPass.finish();this.get(t).bundleGPU=s,n.currentSets=n._currentSets,n.currentPass=n._currentPass}addBundle(e,t){this.get(e).renderBundles.push(this.get(t).bundleGPU)}createBindings(e,t,n,i){this.bindingUtils.createBindings(e,t,n,i)}updateBindings(e,t,n,i){this.bindingUtils.createBindings(e,t,n,i)}updateBinding(e){this.bindingUtils.updateBinding(e)}deleteBindGroupData(e){this.bindingUtils.deleteBindGroupData(e)}createIndexAttribute(e){let t=GPUBufferUsage.INDEX|GPUBufferUsage.COPY_SRC|GPUBufferUsage.COPY_DST;(e.isStorageBufferAttribute||e.isStorageInstancedBufferAttribute)&&(t|=GPUBufferUsage.STORAGE),this.attributeUtils.createAttribute(e,t)}createAttribute(e){this.attributeUtils.createAttribute(e,GPUBufferUsage.VERTEX|GPUBufferUsage.COPY_SRC|GPUBufferUsage.COPY_DST)}createStorageAttribute(e){this.attributeUtils.createAttribute(e,GPUBufferUsage.STORAGE|GPUBufferUsage.VERTEX|GPUBufferUsage.COPY_SRC|GPUBufferUsage.COPY_DST)}createIndirectStorageAttribute(e){this.attributeUtils.createAttribute(e,GPUBufferUsage.STORAGE|GPUBufferUsage.INDIRECT|GPUBufferUsage.COPY_SRC|GPUBufferUsage.COPY_DST)}updateAttribute(e){this.attributeUtils.updateAttribute(e)}destroyAttribute(e){this.attributeUtils.destroyAttribute(e)}updateSize(){this.delete(this.renderer.getCanvasTarget())}getMaxAnisotropy(){return 16}hasFeature(e){return $G[e]!==void 0&&(e=$G[e]),this.device.features.has(e)}copyTextureToTexture(e,t,n=null,i=null,s=0,a=0){let o=0,l=0,c=0,d=0,p=0,y=0,_=e.image.width,v=e.image.height,b=1;n!==null&&(n.isBox3===!0?(d=n.min.x,p=n.min.y,y=n.min.z,_=n.max.x-n.min.x,v=n.max.y-n.min.y,b=n.max.z-n.min.z):(d=n.min.x,p=n.min.y,_=n.max.x-n.min.x,v=n.max.y-n.min.y,b=1)),i!==null&&(o=i.x,l=i.y,c=i.z||0);const E=this.device.createCommandEncoder({label:"copyTextureToTexture_"+e.id+"_"+t.id}),T=this.get(e).texture,M=this.get(t).texture;E.copyTextureToTexture({texture:T,mipLevel:s,origin:{x:d,y:p,z:y}},{texture:M,mipLevel:a,origin:{x:o,y:l,z:c}},[_,v,b]),this.device.queue.submit([E.finish()]),a===0&&t.generateMipmaps&&this.textureUtils.generateMipmaps(t)}copyFramebufferToTexture(e,t,n){const i=this.get(t);let s=null;t.renderTarget?e.isDepthTexture?s=this.get(t.depthTexture).texture:s=this.get(t.textures[0]).texture:e.isDepthTexture?s=this.textureUtils.getDepthBuffer(t.depth,t.stencil):s=this.context.getCurrentTexture();const a=this.get(e).texture;if(s.format!==a.format){Ze("WebGPUBackend: copyFramebufferToTexture: Source and destination formats do not match.",s.format,a.format);return}let o;if(i.currentPass?(i.currentPass.end(),o=i.encoder):o=this.device.createCommandEncoder({label:"copyFramebufferToTexture_"+e.id}),o.copyTextureToTexture({texture:s,origin:[n.x,n.y,0]},{texture:a},[n.z,n.w]),e.generateMipmaps&&this.textureUtils.generateMipmaps(e,o),i.currentPass){const{descriptor:l}=i;for(let c=0;c<l.colorAttachments.length;c++)l.colorAttachments[c].loadOp=tr.Load;t.depth&&(l.depthStencilAttachment.depthLoadOp=tr.Load),t.stencil&&(l.depthStencilAttachment.stencilLoadOp=tr.Load),i.currentPass=o.beginRenderPass(l),i.currentSets={attributes:{},bindingGroups:[],pipeline:null,index:null},t.viewport&&this.updateViewport(t),t.scissor&&this.updateScissor(t)}else this.device.queue.submit([o.finish()])}dispose(){if(this.bindingUtils.dispose(),this.textureUtils.dispose(),this.occludedResolveCache){for(const e of this.occludedResolveCache.values())e.destroy();this.occludedResolveCache.clear()}if(this.timestampQueryPool)for(const e of Object.values(this.timestampQueryPool))e!==null&&e.dispose();this.parameters.device===void 0&&this.device!==null&&this.device.destroy()}}class j_e extends Z1{constructor(e,t,n,i,s,a){super(e,t,n,i,s,a),this.iesMap=null}copy(e,t){return super.copy(e,t),this.iesMap=e.iesMap,this}}class Y_e extends Z1{constructor(e,t,n,i,s,a){super(e,t,n,i,s,a),this.aspect=null}copy(e,t){return super.copy(e,t),this.aspect=e.aspect,this}}class Z_e extends TX{constructor(){super(),this.addMaterial(Mfe,"MeshPhongMaterial"),this.addMaterial(vq,"MeshStandardMaterial"),this.addMaterial(xq,"MeshPhysicalMaterial"),this.addMaterial(vde,"MeshToonMaterial"),this.addMaterial(_fe,"MeshBasicMaterial"),this.addMaterial(Tfe,"MeshLambertMaterial"),this.addMaterial(hfe,"MeshNormalMaterial"),this.addMaterial(bde,"MeshMatcapMaterial"),this.addMaterial(ofe,"LineBasicMaterial"),this.addMaterial(ufe,"LineDashedMaterial"),this.addMaterial(Ade,"PointsMaterial"),this.addMaterial(Sq,"SpriteMaterial"),this.addMaterial(Nde,"ShadowMaterial"),this.addLight(pge,BL),this.addLight(Mye,IL),this.addLight(Aye,zL),this.addLight(cI,Z1),this.addLight(Nye,FL),this.addLight(Dye,LL),this.addLight(Oye,GL),this.addLight(wye,j_e),this.addLight(Cye,Y_e),this.addToneMapping(Vq,cC),this.addToneMapping(Gq,fC),this.addToneMapping(kq,dC),this.addToneMapping(Hq,L1),this.addToneMapping(Wq,hC),this.addToneMapping(qq,pC)}}class K_e extends Qye{constructor(e={}){let t;e.forceWebGL?t=GG:(t=$_e,e.getFallback=()=>(Ve("WebGPURenderer: WebGPU is not available, running under WebGL2 backend."),new GG(e)));const n=new t(e);super(n,e),this.library=new Z_e,this.isWebGPURenderer=!0,typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}}I.BRDF_GGX;I.BRDF_Lambert;I.BasicPointShadowFilter;I.BasicShadowFilter;I.Break;I.Const;I.Continue;I.DFGLUT;I.D_GGX;I.Discard;I.EPSILON;I.F_Schlick;I.Fn;I.INFINITY;I.If;I.Loop;I.NodeAccess;I.NodeShaderStage;I.NodeType;I.NodeUpdateType;I.PCFShadowFilter;I.PCFSoftShadowFilter;I.PI;I.PI2;I.TWO_PI;I.HALF_PI;I.PointShadowFilter;I.Return;I.Schlick_to_F0;I.ScriptableNodeResources;I.ShaderNode;I.Stack;I.Switch;I.TBNViewMatrix;I.VSMShadowFilter;I.V_GGX_SmithCorrelated;I.Var;I.VarIntent;I.abs;I.acesFilmicToneMapping;I.acos;I.add;I.addMethodChaining;I.addNodeElement;I.agxToneMapping;I.all;I.alphaT;I.and;I.anisotropy;I.anisotropyB;I.anisotropyT;I.any;I.append;I.array;I.arrayBuffer;I.asin;I.assign;I.atan;I.atan2;I.atomicAdd;I.atomicAnd;I.atomicFunc;I.atomicLoad;I.atomicMax;I.atomicMin;I.atomicOr;I.atomicStore;I.atomicSub;I.atomicXor;I.attenuationColor;I.attenuationDistance;I.attribute;I.attributeArray;I.backgroundBlurriness;I.backgroundIntensity;I.backgroundRotation;I.batch;I.bentNormalView;I.billboarding;I.bitAnd;I.bitNot;I.bitOr;I.bitXor;I.bitangentGeometry;I.bitangentLocal;I.bitangentView;I.bitangentWorld;I.bitcast;I.blendBurn;I.blendColor;I.blendDodge;I.blendOverlay;I.blendScreen;I.blur;I.bool;I.buffer;I.bufferAttribute;I.bumpMap;I.burn;I.builtin;I.builtinAOContext;I.builtinShadowContext;I.bvec2;I.bvec3;I.bvec4;I.bypass;I.cache;I.call;I.cameraFar;I.cameraIndex;I.cameraNear;I.cameraNormalMatrix;I.cameraPosition;I.cameraProjectionMatrix;I.cameraProjectionMatrixInverse;I.cameraViewMatrix;I.cameraViewport;I.cameraWorldMatrix;I.cbrt;I.cdl;I.ceil;I.checker;I.cineonToneMapping;I.clamp;I.clearcoat;I.clearcoatNormalView;I.clearcoatRoughness;I.code;I.color;I.colorSpaceToWorking;I.colorToDirection;I.compute;I.computeKernel;I.computeSkinning;I.context;I.convert;I.convertColorSpace;I.convertToTexture;I.countLeadingZeros;I.countOneBits;I.countTrailingZeros;I.cos;I.cross;I.cubeTexture;I.cubeTextureBase;I.dFdx;I.dFdy;I.dashSize;I.debug;I.decrement;I.decrementBefore;I.defaultBuildStages;I.defaultShaderStages;I.defined;I.degrees;I.deltaTime;I.densityFog;I.densityFogFactor;I.depth;I.depthPass;I.determinant;I.difference;I.diffuseColor;I.directPointLight;I.directionToColor;I.directionToFaceDirection;I.dispersion;I.distance;I.div;I.dodge;I.dot;I.drawIndex;I.dynamicBufferAttribute;I.element;I.emissive;I.equal;I.equals;I.equirectUV;I.exp;I.exp2;I.expression;I.faceDirection;I.faceForward;I.faceforward;I.float;I.floatBitsToInt;I.floatBitsToUint;I.floor;I.fog;I.fract;I.frameGroup;I.frameId;I.frontFacing;I.fwidth;I.gain;I.gapSize;I.getConstNodeType;I.getCurrentStack;I.getDirection;I.getDistanceAttenuation;I.getGeometryRoughness;I.getNormalFromDepth;I.interleavedGradientNoise;I.vogelDiskSample;I.getParallaxCorrectNormal;I.getRoughness;I.getScreenPosition;I.getShIrradianceAt;I.getShadowMaterial;I.getShadowRenderObjectFunction;I.getTextureIndex;I.getViewPosition;I.globalId;I.glsl;I.glslFn;I.grayscale;I.greaterThan;I.greaterThanEqual;I.hash;I.highpModelNormalViewMatrix;I.highpModelViewMatrix;I.hue;I.increment;I.incrementBefore;I.instance;I.instanceIndex;I.instancedArray;I.instancedBufferAttribute;I.instancedDynamicBufferAttribute;I.instancedMesh;I.int;I.intBitsToFloat;I.inverse;I.inverseSqrt;I.inversesqrt;I.invocationLocalIndex;I.invocationSubgroupIndex;I.ior;I.iridescence;I.iridescenceIOR;I.iridescenceThickness;I.ivec2;I.ivec3;I.ivec4;I.js;I.label;I.length;I.lengthSq;I.lessThan;I.lessThanEqual;I.lightPosition;I.lightProjectionUV;I.lightShadowMatrix;I.lightTargetDirection;I.lightTargetPosition;I.lightViewPosition;I.lightingContext;I.lights;I.linearDepth;I.linearToneMapping;I.localId;I.log;I.log2;I.logarithmicDepthToViewZ;I.luminance;I.mat2;I.mat3;I.mat4;I.matcapUV;I.materialAO;I.materialAlphaTest;I.materialAnisotropy;I.materialAnisotropyVector;I.materialAttenuationColor;I.materialAttenuationDistance;I.materialClearcoat;I.materialClearcoatNormal;I.materialClearcoatRoughness;I.materialColor;I.materialDispersion;I.materialEmissive;I.materialEnvIntensity;I.materialEnvRotation;I.materialIOR;I.materialIridescence;I.materialIridescenceIOR;I.materialIridescenceThickness;I.materialLightMap;I.materialLineDashOffset;I.materialLineDashSize;I.materialLineGapSize;I.materialLineScale;I.materialLineWidth;I.materialMetalness;I.materialNormal;I.materialOpacity;I.materialPointSize;I.materialReference;I.materialReflectivity;I.materialRefractionRatio;I.materialRotation;I.materialRoughness;I.materialSheen;I.materialSheenRoughness;I.materialShininess;I.materialSpecular;I.materialSpecularColor;I.materialSpecularIntensity;I.materialSpecularStrength;I.materialThickness;I.materialTransmission;I.max;I.maxMipLevel;I.mediumpModelViewMatrix;I.metalness;I.min;I.mix;I.mixElement;I.mod;I.modInt;I.modelDirection;I.modelNormalMatrix;I.modelPosition;I.modelRadius;I.modelScale;I.modelViewMatrix;I.modelViewPosition;I.modelViewProjection;I.modelWorldMatrix;I.modelWorldMatrixInverse;I.morphReference;I.mrt;I.mul;I.mx_aastep;I.mx_add;I.mx_atan2;I.mx_cell_noise_float;I.mx_contrast;I.mx_divide;I.mx_fractal_noise_float;I.mx_fractal_noise_vec2;I.mx_fractal_noise_vec3;I.mx_fractal_noise_vec4;I.mx_frame;I.mx_heighttonormal;I.mx_hsvtorgb;I.mx_ifequal;I.mx_ifgreater;I.mx_ifgreatereq;I.mx_invert;I.mx_modulo;I.mx_multiply;const Q_e=I.mx_noise_float;I.mx_noise_vec3;I.mx_noise_vec4;I.mx_place2d;I.mx_power;I.mx_ramp4;I.mx_ramplr;I.mx_ramptb;I.mx_rgbtohsv;I.mx_rotate2d;I.mx_rotate3d;I.mx_safepower;I.mx_separate;I.mx_splitlr;I.mx_splittb;I.mx_srgb_texture_to_lin_rec709;I.mx_subtract;I.mx_timer;I.mx_transform_uv;I.mx_unifiednoise2d;I.mx_unifiednoise3d;I.mx_worley_noise_float;I.mx_worley_noise_vec2;I.mx_worley_noise_vec3;I.negate;I.neutralToneMapping;I.nodeArray;I.nodeImmutable;I.nodeObject;I.nodeObjectIntent;I.nodeObjects;I.nodeProxy;I.nodeProxyIntent;I.normalFlat;I.normalGeometry;const J_e=I.normalLocal;I.normalMap;I.normalView;I.normalViewGeometry;I.normalWorld;I.normalWorldGeometry;I.normalize;I.not;I.notEqual;I.numWorkgroups;I.objectDirection;I.objectGroup;I.objectPosition;I.objectRadius;I.objectScale;I.objectViewPosition;I.objectWorldMatrix;I.OnBeforeObjectUpdate;I.OnBeforeMaterialUpdate;I.OnObjectUpdate;I.OnMaterialUpdate;I.oneMinus;I.or;I.orthographicDepthToViewZ;I.oscSawtooth;I.oscSine;I.oscSquare;I.oscTriangle;I.output;I.outputStruct;I.overlay;I.overloadingFn;I.packHalf2x16;I.packSnorm2x16;I.packUnorm2x16;I.parabola;I.parallaxDirection;I.parallaxUV;I.parameter;I.pass;I.passTexture;I.pcurve;I.perspectiveDepthToViewZ;I.pmremTexture;I.pointShadow;I.pointUV;I.pointWidth;I.positionGeometry;const mw=I.positionLocal;I.positionPrevious;I.positionView;I.positionViewDirection;I.positionWorld;I.positionWorldDirection;I.posterize;I.pow;I.pow2;I.pow3;I.pow4;I.premultiplyAlpha;I.property;I.radians;I.rand;I.range;I.rangeFog;I.rangeFogFactor;I.reciprocal;I.reference;I.referenceBuffer;I.reflect;I.reflectVector;I.reflectView;I.reflector;I.refract;I.refractVector;I.refractView;I.reinhardToneMapping;I.remap;I.remapClamp;I.renderGroup;I.renderOutput;I.rendererReference;I.replaceDefaultUV;I.rotate;I.rotateUV;I.roughness;I.round;I.rtt;I.sRGBTransferEOTF;I.sRGBTransferOETF;I.sample;I.sampler;I.samplerComparison;I.saturate;I.saturation;I.screen;I.screenCoordinate;I.screenDPR;I.screenSize;I.screenUV;I.scriptable;I.scriptableValue;I.select;I.setCurrentStack;I.setName;I.shaderStages;I.shadow;I.shadowPositionWorld;I.shapeCircle;I.sharedUniformGroup;I.sheen;I.sheenRoughness;I.shiftLeft;I.shiftRight;I.shininess;I.sign;const eve=I.sin;I.sinc;I.skinning;I.smoothstep;I.smoothstepElement;I.specularColor;I.specularF90;I.spherizeUV;I.split;I.spritesheetUV;I.sqrt;I.stack;I.step;I.stepElement;I.storage;I.storageBarrier;I.storageObject;I.storageTexture;I.string;I.struct;I.sub;I.subgroupAdd;I.subgroupAll;I.subgroupAnd;I.subgroupAny;I.subgroupBallot;I.subgroupBroadcast;I.subgroupBroadcastFirst;I.subBuild;I.subgroupElect;I.subgroupExclusiveAdd;I.subgroupExclusiveMul;I.subgroupInclusiveAdd;I.subgroupInclusiveMul;I.subgroupIndex;I.subgroupMax;I.subgroupMin;I.subgroupMul;I.subgroupOr;I.subgroupShuffle;I.subgroupShuffleDown;I.subgroupShuffleUp;I.subgroupShuffleXor;I.subgroupSize;I.subgroupXor;I.tan;I.tangentGeometry;I.tangentLocal;I.tangentView;I.tangentWorld;I.texture;I.texture3D;I.textureBarrier;I.textureBicubic;I.textureBicubicLevel;I.textureCubeUV;I.textureLoad;I.textureSize;I.textureLevel;I.textureStore;I.thickness;const tve=I.time;I.toneMapping;I.toneMappingExposure;I.toonOutlinePass;I.transformDirection;I.transformNormal;I.transformNormalToView;I.transformedClearcoatNormalView;I.transformedNormalView;I.transformedNormalWorld;I.transmission;I.transpose;I.triNoise3D;I.triplanarTexture;I.triplanarTextures;I.trunc;I.uint;I.uintBitsToFloat;const xl=I.uniform;I.uniformArray;I.uniformCubeTexture;I.uniformGroup;I.uniformFlow;I.uniformTexture;I.unpackHalf2x16;I.unpackSnorm2x16;I.unpackUnorm2x16;I.unpremultiplyAlpha;I.userData;I.uv;I.uvec2;I.uvec3;I.uvec4;I.varying;I.varyingProperty;I.vec2;const nve=I.vec3;I.vec4;I.vectorComponents;I.velocity;I.vertexColor;I.vertexIndex;I.vertexStage;I.vibrance;I.viewZToLogarithmicDepth;I.viewZToOrthographicDepth;I.viewZToPerspectiveDepth;I.viewport;I.viewportCoordinate;I.viewportDepthTexture;I.viewportLinearDepth;I.viewportMipTexture;I.viewportResolution;I.viewportSafeUV;I.viewportSharedTexture;I.viewportSize;I.viewportTexture;I.viewportUV;I.wgsl;I.wgslFn;I.workgroupArray;I.workgroupBarrier;I.workgroupId;I.workingToColorSpace;I.xor;var dI=bk();const ive=Ey(dI);function QG(r,e){if(typeof r=="function")return r(e);r!=null&&(r.current=e)}function Iy(...r){return e=>{let t=!1;const n=r.map(i=>{const s=QG(i,e);return!t&&typeof s=="function"&&(t=!0),s});if(t)return()=>{for(let i=0;i<n.length;i++){const s=n[i];typeof s=="function"?s():QG(r[i],null)}}}}function Fy(...r){return H.useCallback(Iy(...r),r)}var rve=Symbol.for("react.lazy"),zR=XU[" use ".trim().toString()];function sve(r){return typeof r=="object"&&r!==null&&"then"in r}function PX(r){return r!=null&&typeof r=="object"&&"$$typeof"in r&&r.$$typeof===rve&&"_payload"in r&&sve(r._payload)}function ave(r){const e=ove(r),t=H.forwardRef((n,i)=>{let{children:s,...a}=n;PX(s)&&typeof zR=="function"&&(s=zR(s._payload));const o=H.Children.toArray(s),l=o.find(uve);if(l){const c=l.props.children,d=o.map(p=>p===l?H.Children.count(c)>1?H.Children.only(null):H.isValidElement(c)?c.props.children:null:p);return Wt.jsx(e,{...a,ref:i,children:H.isValidElement(c)?H.cloneElement(c,void 0,d):null})}return Wt.jsx(e,{...a,ref:i,children:s})});return t.displayName=`${r}.Slot`,t}function ove(r){const e=H.forwardRef((t,n)=>{let{children:i,...s}=t;if(PX(i)&&typeof zR=="function"&&(i=zR(i._payload)),H.isValidElement(i)){const a=fve(i),o=cve(s,i.props);return i.type!==H.Fragment&&(o.ref=n?Iy(n,a):a),H.cloneElement(i,o)}return H.Children.count(i)>1?H.Children.only(null):null});return e.displayName=`${r}.SlotClone`,e}var lve=Symbol("radix.slottable");function uve(r){return H.isValidElement(r)&&typeof r.type=="function"&&"__radixId"in r.type&&r.type.__radixId===lve}function cve(r,e){const t={...e};for(const n in e){const i=r[n],s=e[n];/^on[A-Z]/.test(n)?i&&s?t[n]=(...o)=>{const l=s(...o);return i(...o),l}:i&&(t[n]=i):n==="style"?t[n]={...i,...s}:n==="className"&&(t[n]=[i,s].filter(Boolean).join(" "))}return{...r,...t}}function fve(r){let e=Object.getOwnPropertyDescriptor(r.props,"ref")?.get,t=e&&"isReactWarning"in e&&e.isReactWarning;return t?r.ref:(e=Object.getOwnPropertyDescriptor(r,"ref")?.get,t=e&&"isReactWarning"in e&&e.isReactWarning,t?r.props.ref:r.props.ref||r.ref)}var dve=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"],hve=dve.reduce((r,e)=>{const t=ave(`Primitive.${e}`),n=H.forwardRef((i,s)=>{const{asChild:a,...o}=i,l=a?t:e;return typeof window<"u"&&(window[Symbol.for("radix-ui")]=!0),Wt.jsx(l,{...o,ref:s})});return n.displayName=`Primitive.${e}`,{...r,[e]:n}},{}),Nm=globalThis?.document?H.useLayoutEffect:()=>{},pve="Portal",BX=H.forwardRef((r,e)=>{const{container:t,...n}=r,[i,s]=H.useState(!1);Nm(()=>s(!0),[]);const a=t||i&&globalThis?.document?.body;return a?ive.createPortal(Wt.jsx(hve.div,{...n,ref:e}),a):null});BX.displayName=pve;var mve=BX,JG=Object.prototype.hasOwnProperty;function C1(r,e){var t,n;if(r===e)return!0;if(r&&e&&(t=r.constructor)===e.constructor){if(t===Date)return r.getTime()===e.getTime();if(t===RegExp)return r.toString()===e.toString();if(t===Array){if((n=r.length)===e.length)for(;n--&&C1(r[n],e[n]););return n===-1}if(!t||typeof r=="object"){n=0;for(t in r)if(JG.call(r,t)&&++n&&!JG.call(e,t)||!(t in e)||!C1(r[t],e[t]))return!1;return Object.keys(e).length===n}}return r!==r&&e!==e}function PN(r,e){if(Object.is(r,e))return!0;if(typeof r!="object"||r===null||typeof e!="object"||e===null)return!1;const t=Object.keys(r);if(t.length!==Object.keys(e).length)return!1;for(let n=0;n<t.length;n++)if(!Object.prototype.hasOwnProperty.call(e,t[n])||!Object.is(r[t[n]],e[t[n]]))return!1;return!0}var BN=function(e,t,n,i){this.name=e,this.fn=t,this.args=n,this.modifiers=i};BN.prototype._test=function(e){var t=this.fn;try{ex(this.modifiers.slice(),t,this)(e)}catch{t=function(){return!1}}try{return ex(this.modifiers.slice(),t,this)(e)}catch{return!1}};BN.prototype._check=function(e){try{ex(this.modifiers.slice(),this.fn,this)(e)}catch{if(ex(this.modifiers.slice(),function(n){return n},this)(!1))return}if(!ex(this.modifiers.slice(),this.fn,this)(e))throw null};BN.prototype._testAsync=function(e){var t=this;return new Promise(function(n,i){FX(t.modifiers.slice(),t.fn,t)(e).then(function(s){s?n(e):i(null)}).catch(function(s){return i(s)})})};function IX(r,e){return e===void 0&&(e="simple"),typeof r=="object"?r[e]:r}function ex(r,e,t){if(r.length){var n=r.shift(),i=ex(r,e,t);return n.perform(i,t)}else return IX(e)}function FX(r,e,t){if(r.length){var n=r.shift(),i=FX(r,e,t);return n.performAsync(i,t)}else return function(s){return Promise.resolve(IX(e,"async")(s))}}var gve=function(e,t,n){this.name=e,this.perform=t,this.performAsync=n},hI=(function(r){function e(t,n,i,s){for(var a=[],o=arguments.length-4;o-- >0;)a[o]=arguments[o+4];r.call(this,a),r.captureStackTrace&&r.captureStackTrace(this,e),this.rule=t,this.value=n,this.cause=i,this.target=s}return r&&(e.__proto__=r),e.prototype=Object.create(r&&r.prototype),e.prototype.constructor=e,e})(Error),_d=function(e,t){e===void 0&&(e=[]),t===void 0&&(t=[]),this.chain=e,this.nextRuleModifiers=t};_d.prototype._applyRule=function(e,t){var n=this;return function(){for(var i=[],s=arguments.length;s--;)i[s]=arguments[s];return n.chain.push(new BN(t,e.apply(n,i),i,n.nextRuleModifiers)),n.nextRuleModifiers=[],n}};_d.prototype._applyModifier=function(e,t){return this.nextRuleModifiers.push(new gve(t,e.simple,e.async)),this};_d.prototype._clone=function(){return new _d(this.chain.slice(),this.nextRuleModifiers.slice())};_d.prototype.test=function(e){return this.chain.every(function(t){return t._test(e)})};_d.prototype.testAll=function(e){var t=[];return this.chain.forEach(function(n){try{n._check(e)}catch(i){t.push(new hI(n,e,i))}}),t};_d.prototype.check=function(e){this.chain.forEach(function(t){try{t._check(e)}catch(n){throw new hI(t,e,n)}})};_d.prototype.testAsync=function(e){var t=this;return new Promise(function(n,i){zX(e,t.chain.slice(),n,i)})};function zX(r,e,t,n){if(e.length){var i=e.shift();i._testAsync(r).then(function(){zX(r,e,t,n)},function(s){n(new hI(i,r,s))})}else t(r)}var e5=function(r,e){return e&&typeof r=="string"&&r.trim().length===0?!0:r==null};function yve(r,e){return e===void 0&&(e=!1),{simple:function(t){return e5(t,e)||r.check(t)===void 0},async:function(t){return e5(t,e)||r.testAsync(t)}}}function Rl(){return typeof Proxy<"u"?VX(new _d):TU(new _d)}var N1={};Rl.extend=function(r){Object.assign(N1,r)};Rl.clearCustomRules=function(){N1={}};function VX(r){return new Proxy(r,{get:function(t,n){if(n in t)return t[n];var i=VX(r._clone());if(n in VR)return i._applyModifier(VR[n],n);if(n in N1)return i._applyRule(N1[n],n);if(n in EU)return i._applyRule(EU[n],n)}})}function TU(r){var e=function(i,s){return Object.keys(i).forEach(function(a){s[a]=function(){for(var o=[],l=arguments.length;l--;)o[l]=arguments[l];var c=TU(s._clone()),d=c._applyRule(i[a],a).apply(void 0,o);return d}}),s},t=e(EU,r),n=e(N1,t);return Object.keys(VR).forEach(function(i){Object.defineProperty(n,i,{get:function(){var s=TU(n._clone());return s._applyModifier(VR[i],i)}})}),n}var VR={not:{simple:function(r){return function(e){return!r(e)}},async:function(r){return function(e){return Promise.resolve(r(e)).then(function(t){return!t}).catch(function(){return!0})}}},some:{simple:function(r){return function(e){return gw(e).some(function(t){try{return r(t)}catch{return!1}})}},async:function(r){return function(e){return Promise.all(gw(e).map(function(t){try{return r(t).catch(function(){return!1})}catch{return!1}})).then(function(t){return t.some(Boolean)})}}},every:{simple:function(r){return function(e){return e!==!1&&gw(e).every(r)}},async:function(r){return function(e){return Promise.all(gw(e).map(r)).then(function(t){return t.every(Boolean)})}}},strict:{simple:function(r,e){return function(t){return t5(e)&&t&&typeof t=="object"?Object.keys(e.args[0]).length===Object.keys(t).length&&r(t):r(t)}},async:function(r,e){return function(t){return Promise.resolve(r(t)).then(function(n){return t5(e)&&t&&typeof t=="object"?Object.keys(e.args[0]).length===Object.keys(t).length&&n:n}).catch(function(){return!1})}}}};function t5(r){return r&&r.name==="schema"&&r.args.length>0&&typeof r.args[0]=="object"}function gw(r){return typeof r=="string"?r.split(""):r}var EU={equal:function(r){return function(e){return e==r}},exact:function(r){return function(e){return e===r}},number:function(r){return r===void 0&&(r=!0),function(e){return typeof e=="number"&&(r||isFinite(e))}},integer:function(){return function(r){var e=Number.isInteger||_ve;return e(r)}},numeric:function(){return function(r){return!isNaN(parseFloat(r))&&isFinite(r)}},string:function(){return Av("string")},boolean:function(){return Av("boolean")},undefined:function(){return Av("undefined")},null:function(){return Av("null")},array:function(){return Av("array")},object:function(){return Av("object")},instanceOf:function(r){return function(e){return e instanceof r}},pattern:function(r){return function(e){return r.test(e)}},lowercase:function(){return function(r){return typeof r=="boolean"||r===r.toLowerCase()&&r.trim()!==""}},uppercase:function(){return function(r){return r===r.toUpperCase()&&r.trim()!==""}},vowel:function(){return function(r){return/^[aeiou]+$/i.test(r)}},consonant:function(){return function(r){return/^(?=[^aeiou])([a-z]+)$/i.test(r)}},first:function(r){return function(e){return e[0]==r}},last:function(r){return function(e){return e[e.length-1]==r}},empty:function(){return function(r){return r.length===0}},length:function(r,e){return function(t){return t.length>=r&&t.length<=(e||r)}},minLength:function(r){return function(e){return e.length>=r}},maxLength:function(r){return function(e){return e.length<=r}},negative:function(){return function(r){return r<0}},positive:function(){return function(r){return r>=0}},between:function(r,e){return function(t){return t>=r&&t<=e}},range:function(r,e){return function(t){return t>=r&&t<=e}},lessThan:function(r){return function(e){return e<r}},lessThanOrEqual:function(r){return function(e){return e<=r}},greaterThan:function(r){return function(e){return e>r}},greaterThanOrEqual:function(r){return function(e){return e>=r}},even:function(){return function(r){return r%2===0}},odd:function(){return function(r){return r%2!==0}},includes:function(r){return function(e){return~e.indexOf(r)}},schema:function(r){return vve(r)},passesAnyOf:function(){for(var r=[],e=arguments.length;e--;)r[e]=arguments[e];return function(t){return r.some(function(n){return n.test(t)})}},optional:yve};function Av(r){return function(e){return Array.isArray(e)&&r==="array"||e===null&&r==="null"||typeof e===r}}function _ve(r){return typeof r=="number"&&isFinite(r)&&Math.floor(r)===r}function vve(r){return{simple:function(e){var t=[];if(Object.keys(r).forEach(function(n){var i=r[n];try{i.check((e||{})[n])}catch(s){s.target=n,t.push(s)}}),t.length>0)throw t;return!0},async:function(e){var t=[],n=Object.keys(r).map(function(i){var s=r[i];return s.testAsync((e||{})[i]).catch(function(a){a.target=i,t.push(a)})});return Promise.all(n).then(function(){if(t.length>0)throw t;return!0})}}}var br="colors",Ho="sizes",xn="space",xve={gap:xn,gridGap:xn,columnGap:xn,gridColumnGap:xn,rowGap:xn,gridRowGap:xn,inset:xn,insetBlock:xn,insetBlockEnd:xn,insetBlockStart:xn,insetInline:xn,insetInlineEnd:xn,insetInlineStart:xn,margin:xn,marginTop:xn,marginRight:xn,marginBottom:xn,marginLeft:xn,marginBlock:xn,marginBlockEnd:xn,marginBlockStart:xn,marginInline:xn,marginInlineEnd:xn,marginInlineStart:xn,padding:xn,paddingTop:xn,paddingRight:xn,paddingBottom:xn,paddingLeft:xn,paddingBlock:xn,paddingBlockEnd:xn,paddingBlockStart:xn,paddingInline:xn,paddingInlineEnd:xn,paddingInlineStart:xn,top:xn,right:xn,bottom:xn,left:xn,scrollMargin:xn,scrollMarginTop:xn,scrollMarginRight:xn,scrollMarginBottom:xn,scrollMarginLeft:xn,scrollMarginX:xn,scrollMarginY:xn,scrollMarginBlock:xn,scrollMarginBlockEnd:xn,scrollMarginBlockStart:xn,scrollMarginInline:xn,scrollMarginInlineEnd:xn,scrollMarginInlineStart:xn,scrollPadding:xn,scrollPaddingTop:xn,scrollPaddingRight:xn,scrollPaddingBottom:xn,scrollPaddingLeft:xn,scrollPaddingX:xn,scrollPaddingY:xn,scrollPaddingBlock:xn,scrollPaddingBlockEnd:xn,scrollPaddingBlockStart:xn,scrollPaddingInline:xn,scrollPaddingInlineEnd:xn,scrollPaddingInlineStart:xn,fontSize:"fontSizes",background:br,backgroundColor:br,backgroundImage:br,borderImage:br,border:br,borderBlock:br,borderBlockEnd:br,borderBlockStart:br,borderBottom:br,borderBottomColor:br,borderColor:br,borderInline:br,borderInlineEnd:br,borderInlineStart:br,borderLeft:br,borderLeftColor:br,borderRight:br,borderRightColor:br,borderTop:br,borderTopColor:br,caretColor:br,color:br,columnRuleColor:br,fill:br,outline:br,outlineColor:br,stroke:br,textDecorationColor:br,fontFamily:"fonts",fontWeight:"fontWeights",lineHeight:"lineHeights",letterSpacing:"letterSpacings",blockSize:Ho,minBlockSize:Ho,maxBlockSize:Ho,inlineSize:Ho,minInlineSize:Ho,maxInlineSize:Ho,width:Ho,minWidth:Ho,maxWidth:Ho,height:Ho,minHeight:Ho,maxHeight:Ho,flexBasis:Ho,gridTemplateColumns:Ho,gridTemplateRows:Ho,borderWidth:"borderWidths",borderTopWidth:"borderWidths",borderRightWidth:"borderWidths",borderBottomWidth:"borderWidths",borderLeftWidth:"borderWidths",borderStyle:"borderStyles",borderTopStyle:"borderStyles",borderRightStyle:"borderStyles",borderBottomStyle:"borderStyles",borderLeftStyle:"borderStyles",borderRadius:"radii",borderTopLeftRadius:"radii",borderTopRightRadius:"radii",borderBottomRightRadius:"radii",borderBottomLeftRadius:"radii",boxShadow:"shadows",textShadow:"shadows",transition:"transitions",zIndex:"zIndices"},bve=(r,e)=>typeof e=="function"?{"()":Function.prototype.toString.call(e)}:e,Kx=()=>{const r=Object.create(null);return(e,t,...n)=>{const i=(s=>JSON.stringify(s,bve))(e);return i in r?r[i]:r[i]=t(e,...n)}},F0=Symbol.for("sxs.internal"),pI=(r,e)=>Object.defineProperties(r,Object.getOwnPropertyDescriptors(e)),n5=r=>{for(const e in r)return!0;return!1},{hasOwnProperty:Sve}=Object.prototype,MU=r=>r.includes("-")?r:r.replace(/[A-Z]/g,(e=>"-"+e.toLowerCase())),Tve=/\s+(?![^()]*\))/,wv=r=>e=>r(...typeof e=="string"?String(e).split(Tve):[e]),i5={appearance:r=>({WebkitAppearance:r,appearance:r}),backfaceVisibility:r=>({WebkitBackfaceVisibility:r,backfaceVisibility:r}),backdropFilter:r=>({WebkitBackdropFilter:r,backdropFilter:r}),backgroundClip:r=>({WebkitBackgroundClip:r,backgroundClip:r}),boxDecorationBreak:r=>({WebkitBoxDecorationBreak:r,boxDecorationBreak:r}),clipPath:r=>({WebkitClipPath:r,clipPath:r}),content:r=>({content:r.includes('"')||r.includes("'")||/^([A-Za-z]+\([^]*|[^]*-quote|inherit|initial|none|normal|revert|unset)$/.test(r)?r:`"${r}"`}),hyphens:r=>({WebkitHyphens:r,hyphens:r}),maskImage:r=>({WebkitMaskImage:r,maskImage:r}),maskSize:r=>({WebkitMaskSize:r,maskSize:r}),tabSize:r=>({MozTabSize:r,tabSize:r}),textSizeAdjust:r=>({WebkitTextSizeAdjust:r,textSizeAdjust:r}),userSelect:r=>({WebkitUserSelect:r,userSelect:r}),marginBlock:wv(((r,e)=>({marginBlockStart:r,marginBlockEnd:e||r}))),marginInline:wv(((r,e)=>({marginInlineStart:r,marginInlineEnd:e||r}))),maxSize:wv(((r,e)=>({maxBlockSize:r,maxInlineSize:e||r}))),minSize:wv(((r,e)=>({minBlockSize:r,minInlineSize:e||r}))),paddingBlock:wv(((r,e)=>({paddingBlockStart:r,paddingBlockEnd:e||r}))),paddingInline:wv(((r,e)=>({paddingInlineStart:r,paddingInlineEnd:e||r})))},PD=/([\d.]+)([^]*)/,Eve=(r,e)=>r.length?r.reduce(((t,n)=>(t.push(...e.map((i=>i.includes("&")?i.replace(/&/g,/[ +>|~]/.test(n)&&/&.*&/.test(i)?`:is(${n})`:n):n+" "+i))),t)),[]):e,Mve=(r,e)=>r in Ave&&typeof e=="string"?e.replace(/^((?:[^]*[^\w-])?)(fit-content|stretch)((?:[^\w-][^]*)?)$/,((t,n,i,s)=>n+(i==="stretch"?`-moz-available${s};${MU(r)}:${n}-webkit-fill-available`:`-moz-fit-content${s};${MU(r)}:${n}fit-content`)+s)):String(e),Ave={blockSize:1,height:1,inlineSize:1,maxBlockSize:1,maxHeight:1,maxInlineSize:1,maxWidth:1,minBlockSize:1,minHeight:1,minInlineSize:1,minWidth:1,width:1},Hh=r=>r?r+"-":"",GX=(r,e,t)=>r.replace(/([+-])?((?:\d+(?:\.\d*)?|\.\d+)(?:[Ee][+-]?\d+)?)?(\$|--)([$\w-]+)/g,((n,i,s,a,o)=>a=="$"==!!s?n:(i||a=="--"?"calc(":"")+"var(--"+(a==="$"?Hh(e)+(o.includes("$")?"":Hh(t))+o.replace(/\$/g,"-"):o)+")"+(i||a=="--"?"*"+(i||"")+(s||"1")+")":""))),wve=/\s*,\s*(?![^()]*\))/,Rve=Object.prototype.toString,Vv=(r,e,t,n,i)=>{let s,a,o;const l=(c,d,p)=>{let y,_;const v=b=>{for(y in b){const M=y.charCodeAt(0)===64,R=M&&Array.isArray(b[y])?b[y]:[b[y]];for(_ of R){const N=/[A-Z]/.test(T=y)?T:T.replace(/-[^]/g,(U=>U[1].toUpperCase())),P=typeof _=="object"&&_&&_.toString===Rve&&(!n.utils[N]||!d.length);if(N in n.utils&&!P){const U=n.utils[N];if(U!==a){a=U,v(U(_)),a=null;continue}}else if(N in i5){const U=i5[N];if(U!==o){o=U,v(U(_)),o=null;continue}}if(M&&(E=y.slice(1)in n.media?"@media "+n.media[y.slice(1)]:y,y=E.replace(/\(\s*([\w-]+)\s*(=|<|<=|>|>=)\s*([\w-]+)\s*(?:(<|<=|>|>=)\s*([\w-]+)\s*)?\)/g,((U,L,F,O,B,q)=>{const j=PD.test(L),Q=.0625*(j?-1:1),[se,ae]=j?[O,L]:[L,O];return"("+(F[0]==="="?"":F[0]===">"===j?"max-":"min-")+se+":"+(F[0]!=="="&&F.length===1?ae.replace(PD,((V,X,ee)=>Number(X)+Q*(F===">"?1:-1)+ee)):ae)+(B?") and ("+(B[0]===">"?"min-":"max-")+se+":"+(B.length===1?q.replace(PD,((V,X,ee)=>Number(X)+Q*(B===">"?-1:1)+ee)):q):"")+")"}))),P){const U=M?p.concat(y):[...p],L=M?[...d]:Eve(d,y.split(wve));s!==void 0&&i(r5(...s)),s=void 0,l(_,L,U)}else s===void 0&&(s=[[],d,p]),y=M||y.charCodeAt(0)!==36?y:`--${Hh(n.prefix)}${y.slice(1).replace(/\$/g,"-")}`,_=P?_:typeof _=="number"?_&&N in Cve?String(_)+"px":String(_):GX(Mve(N,_??""),n.prefix,n.themeMap[N]),s[0].push(`${M?`${y} `:`${MU(y)}:`}${_}`)}}var E,T};v(c),s!==void 0&&i(r5(...s)),s=void 0};l(r,e,t)},r5=(r,e,t)=>`${t.map((n=>`${n}{`)).join("")}${e.length?`${e.join(",")}{`:""}${r.join(";")}${e.length?"}":""}${Array(t.length?t.length+1:0).join("}")}`,Cve={animationDelay:1,animationDuration:1,backgroundSize:1,blockSize:1,border:1,borderBlock:1,borderBlockEnd:1,borderBlockEndWidth:1,borderBlockStart:1,borderBlockStartWidth:1,borderBlockWidth:1,borderBottom:1,borderBottomLeftRadius:1,borderBottomRightRadius:1,borderBottomWidth:1,borderEndEndRadius:1,borderEndStartRadius:1,borderInlineEnd:1,borderInlineEndWidth:1,borderInlineStart:1,borderInlineStartWidth:1,borderInlineWidth:1,borderLeft:1,borderLeftWidth:1,borderRadius:1,borderRight:1,borderRightWidth:1,borderSpacing:1,borderStartEndRadius:1,borderStartStartRadius:1,borderTop:1,borderTopLeftRadius:1,borderTopRightRadius:1,borderTopWidth:1,borderWidth:1,bottom:1,columnGap:1,columnRule:1,columnRuleWidth:1,columnWidth:1,containIntrinsicSize:1,flexBasis:1,fontSize:1,gap:1,gridAutoColumns:1,gridAutoRows:1,gridTemplateColumns:1,gridTemplateRows:1,height:1,inlineSize:1,inset:1,insetBlock:1,insetBlockEnd:1,insetBlockStart:1,insetInline:1,insetInlineEnd:1,insetInlineStart:1,left:1,letterSpacing:1,margin:1,marginBlock:1,marginBlockEnd:1,marginBlockStart:1,marginBottom:1,marginInline:1,marginInlineEnd:1,marginInlineStart:1,marginLeft:1,marginRight:1,marginTop:1,maxBlockSize:1,maxHeight:1,maxInlineSize:1,maxWidth:1,minBlockSize:1,minHeight:1,minInlineSize:1,minWidth:1,offsetDistance:1,offsetRotate:1,outline:1,outlineOffset:1,outlineWidth:1,overflowClipMargin:1,padding:1,paddingBlock:1,paddingBlockEnd:1,paddingBlockStart:1,paddingBottom:1,paddingInline:1,paddingInlineEnd:1,paddingInlineStart:1,paddingLeft:1,paddingRight:1,paddingTop:1,perspective:1,right:1,rowGap:1,scrollMargin:1,scrollMarginBlock:1,scrollMarginBlockEnd:1,scrollMarginBlockStart:1,scrollMarginBottom:1,scrollMarginInline:1,scrollMarginInlineEnd:1,scrollMarginInlineStart:1,scrollMarginLeft:1,scrollMarginRight:1,scrollMarginTop:1,scrollPadding:1,scrollPaddingBlock:1,scrollPaddingBlockEnd:1,scrollPaddingBlockStart:1,scrollPaddingBottom:1,scrollPaddingInline:1,scrollPaddingInlineEnd:1,scrollPaddingInlineStart:1,scrollPaddingLeft:1,scrollPaddingRight:1,scrollPaddingTop:1,shapeMargin:1,textDecoration:1,textDecorationThickness:1,textIndent:1,textUnderlineOffset:1,top:1,transitionDelay:1,transitionDuration:1,verticalAlign:1,width:1,wordSpacing:1},s5=r=>String.fromCharCode(r+(r>25?39:97)),z0=r=>(e=>{let t,n="";for(t=Math.abs(e);t>52;t=t/52|0)n=s5(t%52)+n;return s5(t%52)+n})(((e,t)=>{let n=t.length;for(;n;)e=33*e^t.charCodeAt(--n);return e})(5381,JSON.stringify(r))>>>0),ET=["themed","global","styled","onevar","resonevar","allvar","inline"],Nve=r=>{if(r.href&&!r.href.startsWith(location.origin))return!1;try{return!!r.cssRules}catch{return!1}},Dve=r=>{let e;const t=()=>{const{cssRules:i}=e.sheet;return[].map.call(i,((s,a)=>{const{cssText:o}=s;let l="";if(o.startsWith("--sxs"))return"";if(i[a-1]&&(l=i[a-1].cssText).startsWith("--sxs")){if(!s.cssRules.length)return"";for(const c in e.rules)if(e.rules[c].group===s)return`--sxs{--sxs:${[...e.rules[c].cache].join(" ")}}${o}`;return s.cssRules.length?`${l}${o}`:""}return o})).join("")},n=()=>{if(e){const{rules:o,sheet:l}=e;if(!l.deleteRule){for(;Object(Object(l.cssRules)[0]).type===3;)l.cssRules.splice(0,1);l.cssRules=[]}for(const c in o)delete o[c]}const i=Object(r).styleSheets||[];for(const o of i)if(Nve(o)){for(let l=0,c=o.cssRules;c[l];++l){const d=Object(c[l]);if(d.type!==1)continue;const p=Object(c[l+1]);if(p.type!==4)continue;++l;const{cssText:y}=d;if(!y.startsWith("--sxs"))continue;const _=y.slice(14,-3).trim().split(/\s+/),v=ET[_[0]];v&&(e||(e={sheet:o,reset:n,rules:{},toString:t}),e.rules[v]={group:p,index:l,cache:new Set(_)})}if(e)break}if(!e){const o=(l,c)=>({type:c,cssRules:[],insertRule(d,p){this.cssRules.splice(p,0,o(d,{import:3,undefined:1}[(d.toLowerCase().match(/^@([a-z]+)/)||[])[1]]||4))},get cssText(){return l==="@media{}"?`@media{${[].map.call(this.cssRules,(d=>d.cssText)).join("")}}`:l}});e={sheet:r?(r.head||r).appendChild(document.createElement("style")).sheet:o("","text/css"),rules:{},reset:n,toString:t}}const{sheet:s,rules:a}=e;for(let o=ET.length-1;o>=0;--o){const l=ET[o];if(!a[l]){const c=ET[o+1],d=a[c]?a[c].index:s.cssRules.length;s.insertRule("@media{}",d),s.insertRule(`--sxs{--sxs:${o}}`,d),a[l]={group:s.cssRules[d+1],index:d,cache:new Set([o])}}Ove(a[l])}};return n(),e},Ove=r=>{const e=r.group;let t=e.cssRules.length;r.apply=n=>{try{e.insertRule(n,t),++t}catch{}}},lT=Symbol(),Uve=Kx(),a5=(r,e)=>Uve(r,(()=>(...t)=>{let n={type:null,composers:new Set};for(const i of t)if(i!=null)if(i[F0]){n.type==null&&(n.type=i[F0].type);for(const s of i[F0].composers)n.composers.add(s)}else i.constructor!==Object||i.$$typeof?n.type==null&&(n.type=i):n.composers.add(Lve(i,r));return n.type==null&&(n.type="span"),n.composers.size||n.composers.add(["PJLV",{},[],[],{},[]]),Pve(r,n,e)})),Lve=({variants:r,compoundVariants:e,defaultVariants:t,...n},i)=>{const s=`${Hh(i.prefix)}c-${z0(n)}`,a=[],o=[],l=Object.create(null),c=[];for(const y in t)l[y]=String(t[y]);if(typeof r=="object"&&r)for(const y in r){d=l,p=y,Sve.call(d,p)||(l[y]="undefined");const _=r[y];for(const v in _){const b={[y]:String(v)};String(v)==="undefined"&&c.push(y);const E=_[v],T=[b,E,!n5(E)];a.push(T)}}var d,p;if(typeof e=="object"&&e)for(const y of e){let{css:_,...v}=y;_=typeof _=="object"&&_||{};for(const E in v)v[E]=String(v[E]);const b=[v,_,!n5(_)];o.push(b)}return[s,n,a,o,l,c]},Pve=(r,e,t)=>{const[n,i,s,a]=Bve(e.composers),o=typeof e.type=="function"||e.type.$$typeof?(p=>{function y(){for(let _=0;_<y[lT].length;_++){const[v,b]=y[lT][_];p.rules[v].apply(b)}return y[lT]=[],null}return y[lT]=[],y.rules={},ET.forEach((_=>y.rules[_]={apply:v=>y[lT].push([_,v])})),y})(t):null,l=(o||t).rules,c=`.${n}${i.length>1?`:where(.${i.slice(1).join(".")})`:""}`,d=p=>{p=typeof p=="object"&&p||Ive;const{css:y,..._}=p,v={};for(const T in s)if(delete _[T],T in p){let M=p[T];typeof M=="object"&&M?v[T]={"@initial":s[T],...M}:(M=String(M),v[T]=M!=="undefined"||a.has(T)?M:s[T])}else v[T]=s[T];const b=new Set([...i]);for(const[T,M,R,N]of e.composers){t.rules.styled.cache.has(T)||(t.rules.styled.cache.add(T),Vv(M,[`.${T}`],[],r,(L=>{l.styled.apply(L)})));const P=o5(R,v,r.media),U=o5(N,v,r.media,!0);for(const L of P)if(L!==void 0)for(const[F,O,B]of L){const q=`${T}-${z0(O)}-${F}`;b.add(q);const j=(B?t.rules.resonevar:t.rules.onevar).cache,Q=B?l.resonevar:l.onevar;j.has(q)||(j.add(q),Vv(O,[`.${q}`],[],r,(se=>{Q.apply(se)})))}for(const L of U)if(L!==void 0)for(const[F,O]of L){const B=`${T}-${z0(O)}-${F}`;b.add(B),t.rules.allvar.cache.has(B)||(t.rules.allvar.cache.add(B),Vv(O,[`.${B}`],[],r,(q=>{l.allvar.apply(q)})))}}if(typeof y=="object"&&y){const T=`${n}-i${z0(y)}-css`;b.add(T),t.rules.inline.cache.has(T)||(t.rules.inline.cache.add(T),Vv(y,[`.${T}`],[],r,(M=>{l.inline.apply(M)})))}for(const T of String(p.className||"").trim().split(/\s+/))T&&b.add(T);const E=_.className=[...b].join(" ");return{type:e.type,className:E,selector:c,props:_,toString:()=>E,deferredInjector:o}};return pI(d,{className:n,selector:c,[F0]:e,toString:()=>(t.rules.styled.cache.has(n)||d(),n)})},Bve=r=>{let e="";const t=[],n={},i=[];for(const[s,,,,a,o]of r){e===""&&(e=s),t.push(s),i.push(...o);for(const l in a){const c=a[l];(n[l]===void 0||c!=="undefined"||o.includes(c))&&(n[l]=c)}}return[e,t,n,new Set(i)]},o5=(r,e,t,n)=>{const i=[];e:for(let[s,a,o]of r){if(o)continue;let l,c=0,d=!1;for(l in s){const p=s[l];let y=e[l];if(y!==p){if(typeof y!="object"||!y)continue e;{let _,v,b=0;for(const E in y){if(p===String(y[E])){if(E!=="@initial"){const T=E.slice(1);(v=v||[]).push(T in t?t[T]:E.replace(/^@media ?/,"")),d=!0}c+=b,_=!0}++b}if(v&&v.length&&(a={["@media "+v.join(", ")]:a}),!_)continue e}}}(i[c]=i[c]||[]).push([n?"cv":`${l}-${s[l]}`,a,d])}return i},Ive={},Fve=Kx(),zve=(r,e)=>Fve(r,(()=>(...t)=>{const n=()=>{for(let i of t){i=typeof i=="object"&&i||{};let s=z0(i);if(!e.rules.global.cache.has(s)){if(e.rules.global.cache.add(s),"@import"in i){let a=[].indexOf.call(e.sheet.cssRules,e.rules.themed.group)-1;for(let o of[].concat(i["@import"]))o=o.includes('"')||o.includes("'")?o:`"${o}"`,e.sheet.insertRule(`@import ${o};`,a++);delete i["@import"]}Vv(i,[],[],r,(a=>{e.rules.global.apply(a)}))}}return""};return pI(n,{toString:n})})),Vve=Kx(),Gve=(r,e)=>Vve(r,(()=>t=>{const n=`${Hh(r.prefix)}k-${z0(t)}`,i=()=>{if(!e.rules.global.cache.has(n)){e.rules.global.cache.add(n);const s=[];Vv(t,[],[],r,(o=>s.push(o)));const a=`@keyframes ${n}{${s.join("")}}`;e.rules.global.apply(a)}return n};return pI(i,{get name(){return i()},toString:i})})),kve=class{constructor(r,e,t,n){this.token=r==null?"":String(r),this.value=e==null?"":String(e),this.scale=t==null?"":String(t),this.prefix=n==null?"":String(n)}get computedValue(){return"var("+this.variable+")"}get variable(){return"--"+Hh(this.prefix)+Hh(this.scale)+this.token}toString(){return this.computedValue}},Hve=Kx(),Wve=(r,e)=>Hve(r,(()=>(t,n)=>{n=typeof t=="object"&&t||Object(n);const i=`.${t=(t=typeof t=="string"?t:"")||`${Hh(r.prefix)}t-${z0(n)}`}`,s={},a=[];for(const l in n){s[l]={};for(const c in n[l]){const d=`--${Hh(r.prefix)}${l}-${c}`,p=GX(String(n[l][c]),r.prefix,l);s[l][c]=new kve(c,p,l,r.prefix),a.push(`${d}:${p}`)}}const o=()=>{if(a.length&&!e.rules.themed.cache.has(t)){e.rules.themed.cache.add(t);const l=`${n===r.theme?":root,":""}.${t}{${a.join(";")}}`;e.rules.themed.apply(l)}return t};return{...s,get className(){return o()},selector:i,toString:o}})),qve=Kx(),Xve=Kx(),$ve=r=>{const e=(t=>{let n=!1;const i=qve(t,(s=>{n=!0;const a="prefix"in(s=typeof s=="object"&&s||{})?String(s.prefix):"",o=typeof s.media=="object"&&s.media||{},l=typeof s.root=="object"?s.root||null:globalThis.document||null,c=typeof s.theme=="object"&&s.theme||{},d={prefix:a,media:o,theme:c,themeMap:typeof s.themeMap=="object"&&s.themeMap||{...xve},utils:typeof s.utils=="object"&&s.utils||{}},p=Dve(l),y={css:a5(d,p),globalCss:zve(d,p),keyframes:Gve(d,p),createTheme:Wve(d,p),reset(){p.reset(),y.theme.toString()},theme:{},sheet:p,config:d,prefix:a,getCssText:p.toString,toString:p.toString};return String(y.theme=y.createTheme(c)),y}));return n||i.reset(),i})(r);return e.styled=(({config:t,sheet:n})=>Xve(t,(()=>{const i=a5(t,n);return(...s)=>{const a=i(...s),o=a[F0].type,l=ve.forwardRef(((c,d)=>{const p=c&&c.as||o,{props:y,deferredInjector:_}=a(c);return delete y.as,y.ref=d,_?ve.createElement(ve.Fragment,null,ve.createElement(p,y),ve.createElement(_,null)):ve.createElement(p,y)}));return l.className=a.className,l.displayName=`Styled.${o.displayName||o.name||o}`,l.selector=a.selector,l.toString=()=>a.selector,l[F0]=a[F0],l}})))(e),e};function fh(r,e,{checkForDefaultPrevented:t=!0}={}){return function(i){if(r?.(i),t===!1||!i.defaultPrevented)return e?.(i)}}function kX(r,e=[]){let t=[];function n(s,a){const o=H.createContext(a),l=t.length;t=[...t,a];const c=p=>{const{scope:y,children:_,...v}=p,b=y?.[r]?.[l]||o,E=H.useMemo(()=>v,Object.values(v));return Wt.jsx(b.Provider,{value:E,children:_})};c.displayName=s+"Provider";function d(p,y){const _=y?.[r]?.[l]||o,v=H.useContext(_);if(v)return v;if(a!==void 0)return a;throw new Error(`\`${p}\` must be used within \`${s}\``)}return[c,d]}const i=()=>{const s=t.map(a=>H.createContext(a));return function(o){const l=o?.[r]||s;return H.useMemo(()=>({[`__scope${r}`]:{...o,[r]:l}}),[o,l])}};return i.scopeName=r,[n,jve(i,...e)]}function jve(...r){const e=r[0];if(r.length===1)return e;const t=()=>{const n=r.map(i=>({useScope:i(),scopeName:i.scopeName}));return function(s){const a=n.reduce((o,{useScope:l,scopeName:c})=>{const p=l(s)[`__scope${c}`];return{...o,...p}},{});return H.useMemo(()=>({[`__scope${e.scopeName}`]:a}),[a])}};return t.scopeName=e.scopeName,t}function Yve(r){const e=Zve(r),t=H.forwardRef((n,i)=>{const{children:s,...a}=n,o=H.Children.toArray(s),l=o.find(Qve);if(l){const c=l.props.children,d=o.map(p=>p===l?H.Children.count(c)>1?H.Children.only(null):H.isValidElement(c)?c.props.children:null:p);return Wt.jsx(e,{...a,ref:i,children:H.isValidElement(c)?H.cloneElement(c,void 0,d):null})}return Wt.jsx(e,{...a,ref:i,children:s})});return t.displayName=`${r}.Slot`,t}function Zve(r){const e=H.forwardRef((t,n)=>{const{children:i,...s}=t;if(H.isValidElement(i)){const a=exe(i),o=Jve(s,i.props);return i.type!==H.Fragment&&(o.ref=n?Iy(n,a):a),H.cloneElement(i,o)}return H.Children.count(i)>1?H.Children.only(null):null});return e.displayName=`${r}.SlotClone`,e}var Kve=Symbol("radix.slottable");function Qve(r){return H.isValidElement(r)&&typeof r.type=="function"&&"__radixId"in r.type&&r.type.__radixId===Kve}function Jve(r,e){const t={...e};for(const n in e){const i=r[n],s=e[n];/^on[A-Z]/.test(n)?i&&s?t[n]=(...o)=>{const l=s(...o);return i(...o),l}:i&&(t[n]=i):n==="style"?t[n]={...i,...s}:n==="className"&&(t[n]=[i,s].filter(Boolean).join(" "))}return{...r,...t}}function exe(r){let e=Object.getOwnPropertyDescriptor(r.props,"ref")?.get,t=e&&"isReactWarning"in e&&e.isReactWarning;return t?r.ref:(e=Object.getOwnPropertyDescriptor(r,"ref")?.get,t=e&&"isReactWarning"in e&&e.isReactWarning,t?r.props.ref:r.props.ref||r.ref)}var txe=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"],HX=txe.reduce((r,e)=>{const t=Yve(`Primitive.${e}`),n=H.forwardRef((i,s)=>{const{asChild:a,...o}=i,l=a?t:e;return typeof window<"u"&&(window[Symbol.for("radix-ui")]=!0),Wt.jsx(l,{...o,ref:s})});return n.displayName=`Primitive.${e}`,{...r,[e]:n}},{});function nxe(r,e){r&&dI.flushSync(()=>r.dispatchEvent(e))}function IN(r){const e=H.useRef(r);return H.useEffect(()=>{e.current=r}),H.useMemo(()=>(...t)=>e.current?.(...t),[])}function ixe(r,e=globalThis?.document){const t=IN(r);H.useEffect(()=>{const n=i=>{i.key==="Escape"&&t(i)};return e.addEventListener("keydown",n,{capture:!0}),()=>e.removeEventListener("keydown",n,{capture:!0})},[t,e])}var rxe="DismissableLayer",AU="dismissableLayer.update",sxe="dismissableLayer.pointerDownOutside",axe="dismissableLayer.focusOutside",l5,WX=H.createContext({layers:new Set,layersWithOutsidePointerEventsDisabled:new Set,branches:new Set}),qX=H.forwardRef((r,e)=>{const{disableOutsidePointerEvents:t=!1,onEscapeKeyDown:n,onPointerDownOutside:i,onFocusOutside:s,onInteractOutside:a,onDismiss:o,...l}=r,c=H.useContext(WX),[d,p]=H.useState(null),y=d?.ownerDocument??globalThis?.document,[,_]=H.useState({}),v=Fy(e,L=>p(L)),b=Array.from(c.layers),[E]=[...c.layersWithOutsidePointerEventsDisabled].slice(-1),T=b.indexOf(E),M=d?b.indexOf(d):-1,R=c.layersWithOutsidePointerEventsDisabled.size>0,N=M>=T,P=uxe(L=>{const F=L.target,O=[...c.branches].some(B=>B.contains(F));!N||O||(i?.(L),a?.(L),L.defaultPrevented||o?.())},y),U=cxe(L=>{const F=L.target;[...c.branches].some(B=>B.contains(F))||(s?.(L),a?.(L),L.defaultPrevented||o?.())},y);return ixe(L=>{M===c.layers.size-1&&(n?.(L),!L.defaultPrevented&&o&&(L.preventDefault(),o()))},y),H.useEffect(()=>{if(d)return t&&(c.layersWithOutsidePointerEventsDisabled.size===0&&(l5=y.body.style.pointerEvents,y.body.style.pointerEvents="none"),c.layersWithOutsidePointerEventsDisabled.add(d)),c.layers.add(d),u5(),()=>{t&&c.layersWithOutsidePointerEventsDisabled.size===1&&(y.body.style.pointerEvents=l5)}},[d,y,t,c]),H.useEffect(()=>()=>{d&&(c.layers.delete(d),c.layersWithOutsidePointerEventsDisabled.delete(d),u5())},[d,c]),H.useEffect(()=>{const L=()=>_({});return document.addEventListener(AU,L),()=>document.removeEventListener(AU,L)},[]),Wt.jsx(HX.div,{...l,ref:v,style:{pointerEvents:R?N?"auto":"none":void 0,...r.style},onFocusCapture:fh(r.onFocusCapture,U.onFocusCapture),onBlurCapture:fh(r.onBlurCapture,U.onBlurCapture),onPointerDownCapture:fh(r.onPointerDownCapture,P.onPointerDownCapture)})});qX.displayName=rxe;var oxe="DismissableLayerBranch",lxe=H.forwardRef((r,e)=>{const t=H.useContext(WX),n=H.useRef(null),i=Fy(e,n);return H.useEffect(()=>{const s=n.current;if(s)return t.branches.add(s),()=>{t.branches.delete(s)}},[t.branches]),Wt.jsx(HX.div,{...r,ref:i})});lxe.displayName=oxe;function uxe(r,e=globalThis?.document){const t=IN(r),n=H.useRef(!1),i=H.useRef(()=>{});return H.useEffect(()=>{const s=o=>{if(o.target&&!n.current){let l=function(){XX(sxe,t,c,{discrete:!0})};const c={originalEvent:o};o.pointerType==="touch"?(e.removeEventListener("click",i.current),i.current=l,e.addEventListener("click",i.current,{once:!0})):l()}else e.removeEventListener("click",i.current);n.current=!1},a=window.setTimeout(()=>{e.addEventListener("pointerdown",s)},0);return()=>{window.clearTimeout(a),e.removeEventListener("pointerdown",s),e.removeEventListener("click",i.current)}},[e,t]),{onPointerDownCapture:()=>n.current=!0}}function cxe(r,e=globalThis?.document){const t=IN(r),n=H.useRef(!1);return H.useEffect(()=>{const i=s=>{s.target&&!n.current&&XX(axe,t,{originalEvent:s},{discrete:!1})};return e.addEventListener("focusin",i),()=>e.removeEventListener("focusin",i)},[e,t]),{onFocusCapture:()=>n.current=!0,onBlurCapture:()=>n.current=!1}}function u5(){const r=new CustomEvent(AU);document.dispatchEvent(r)}function XX(r,e,t,{discrete:n}){const i=t.originalEvent.target,s=new CustomEvent(r,{bubbles:!1,cancelable:!0,detail:t});e&&i.addEventListener(r,e,{once:!0}),n?nxe(i,s):i.dispatchEvent(s)}var fxe=XU[" useId ".trim().toString()]||(()=>{}),dxe=0;function hxe(r){const[e,t]=H.useState(fxe());return Nm(()=>{t(n=>n??String(dxe++))},[r]),e?`radix-${e}`:""}const pxe=["top","right","bottom","left"],Dm=Math.min,uu=Math.max,GR=Math.round,yw=Math.floor,hd=r=>({x:r,y:r}),mxe={left:"right",right:"left",bottom:"top",top:"bottom"},gxe={start:"end",end:"start"};function wU(r,e,t){return uu(r,Dm(e,t))}function Wh(r,e){return typeof r=="function"?r(e):r}function qh(r){return r.split("-")[0]}function Qx(r){return r.split("-")[1]}function mI(r){return r==="x"?"y":"x"}function gI(r){return r==="y"?"height":"width"}const yxe=new Set(["top","bottom"]);function sd(r){return yxe.has(qh(r))?"y":"x"}function yI(r){return mI(sd(r))}function _xe(r,e,t){t===void 0&&(t=!1);const n=Qx(r),i=yI(r),s=gI(i);let a=i==="x"?n===(t?"end":"start")?"right":"left":n==="start"?"bottom":"top";return e.reference[s]>e.floating[s]&&(a=kR(a)),[a,kR(a)]}function vxe(r){const e=kR(r);return[RU(r),e,RU(e)]}function RU(r){return r.replace(/start|end/g,e=>gxe[e])}const c5=["left","right"],f5=["right","left"],xxe=["top","bottom"],bxe=["bottom","top"];function Sxe(r,e,t){switch(r){case"top":case"bottom":return t?e?f5:c5:e?c5:f5;case"left":case"right":return e?xxe:bxe;default:return[]}}function Txe(r,e,t,n){const i=Qx(r);let s=Sxe(qh(r),t==="start",n);return i&&(s=s.map(a=>a+"-"+i),e&&(s=s.concat(s.map(RU)))),s}function kR(r){return r.replace(/left|right|bottom|top/g,e=>mxe[e])}function Exe(r){return{top:0,right:0,bottom:0,left:0,...r}}function $X(r){return typeof r!="number"?Exe(r):{top:r,right:r,bottom:r,left:r}}function HR(r){const{x:e,y:t,width:n,height:i}=r;return{width:n,height:i,top:t,left:e,right:e+n,bottom:t+i,x:e,y:t}}function d5(r,e,t){let{reference:n,floating:i}=r;const s=sd(e),a=yI(e),o=gI(a),l=qh(e),c=s==="y",d=n.x+n.width/2-i.width/2,p=n.y+n.height/2-i.height/2,y=n[o]/2-i[o]/2;let _;switch(l){case"top":_={x:d,y:n.y-i.height};break;case"bottom":_={x:d,y:n.y+n.height};break;case"right":_={x:n.x+n.width,y:p};break;case"left":_={x:n.x-i.width,y:p};break;default:_={x:n.x,y:n.y}}switch(Qx(e)){case"start":_[a]-=y*(t&&c?-1:1);break;case"end":_[a]+=y*(t&&c?-1:1);break}return _}const Mxe=async(r,e,t)=>{const{placement:n="bottom",strategy:i="absolute",middleware:s=[],platform:a}=t,o=s.filter(Boolean),l=await(a.isRTL==null?void 0:a.isRTL(e));let c=await a.getElementRects({reference:r,floating:e,strategy:i}),{x:d,y:p}=d5(c,n,l),y=n,_={},v=0;for(let b=0;b<o.length;b++){const{name:E,fn:T}=o[b],{x:M,y:R,data:N,reset:P}=await T({x:d,y:p,initialPlacement:n,placement:y,strategy:i,middlewareData:_,rects:c,platform:a,elements:{reference:r,floating:e}});d=M??d,p=R??p,_={..._,[E]:{..._[E],...N}},P&&v<=50&&(v++,typeof P=="object"&&(P.placement&&(y=P.placement),P.rects&&(c=P.rects===!0?await a.getElementRects({reference:r,floating:e,strategy:i}):P.rects),{x:d,y:p}=d5(c,y,l)),b=-1)}return{x:d,y:p,placement:y,strategy:i,middlewareData:_}};async function D1(r,e){var t;e===void 0&&(e={});const{x:n,y:i,platform:s,rects:a,elements:o,strategy:l}=r,{boundary:c="clippingAncestors",rootBoundary:d="viewport",elementContext:p="floating",altBoundary:y=!1,padding:_=0}=Wh(e,r),v=$X(_),E=o[y?p==="floating"?"reference":"floating":p],T=HR(await s.getClippingRect({element:(t=await(s.isElement==null?void 0:s.isElement(E)))==null||t?E:E.contextElement||await(s.getDocumentElement==null?void 0:s.getDocumentElement(o.floating)),boundary:c,rootBoundary:d,strategy:l})),M=p==="floating"?{x:n,y:i,width:a.floating.width,height:a.floating.height}:a.reference,R=await(s.getOffsetParent==null?void 0:s.getOffsetParent(o.floating)),N=await(s.isElement==null?void 0:s.isElement(R))?await(s.getScale==null?void 0:s.getScale(R))||{x:1,y:1}:{x:1,y:1},P=HR(s.convertOffsetParentRelativeRectToViewportRelativeRect?await s.convertOffsetParentRelativeRectToViewportRelativeRect({elements:o,rect:M,offsetParent:R,strategy:l}):M);return{top:(T.top-P.top+v.top)/N.y,bottom:(P.bottom-T.bottom+v.bottom)/N.y,left:(T.left-P.left+v.left)/N.x,right:(P.right-T.right+v.right)/N.x}}const Axe=r=>({name:"arrow",options:r,async fn(e){const{x:t,y:n,placement:i,rects:s,platform:a,elements:o,middlewareData:l}=e,{element:c,padding:d=0}=Wh(r,e)||{};if(c==null)return{};const p=$X(d),y={x:t,y:n},_=yI(i),v=gI(_),b=await a.getDimensions(c),E=_==="y",T=E?"top":"left",M=E?"bottom":"right",R=E?"clientHeight":"clientWidth",N=s.reference[v]+s.reference[_]-y[_]-s.floating[v],P=y[_]-s.reference[_],U=await(a.getOffsetParent==null?void 0:a.getOffsetParent(c));let L=U?U[R]:0;(!L||!await(a.isElement==null?void 0:a.isElement(U)))&&(L=o.floating[R]||s.floating[v]);const F=N/2-P/2,O=L/2-b[v]/2-1,B=Dm(p[T],O),q=Dm(p[M],O),j=B,Q=L-b[v]-q,se=L/2-b[v]/2+F,ae=wU(j,se,Q),V=!l.arrow&&Qx(i)!=null&&se!==ae&&s.reference[v]/2-(se<j?B:q)-b[v]/2<0,X=V?se<j?se-j:se-Q:0;return{[_]:y[_]+X,data:{[_]:ae,centerOffset:se-ae-X,...V&&{alignmentOffset:X}},reset:V}}}),wxe=function(r){return r===void 0&&(r={}),{name:"flip",options:r,async fn(e){var t,n;const{placement:i,middlewareData:s,rects:a,initialPlacement:o,platform:l,elements:c}=e,{mainAxis:d=!0,crossAxis:p=!0,fallbackPlacements:y,fallbackStrategy:_="bestFit",fallbackAxisSideDirection:v="none",flipAlignment:b=!0,...E}=Wh(r,e);if((t=s.arrow)!=null&&t.alignmentOffset)return{};const T=qh(i),M=sd(o),R=qh(o)===o,N=await(l.isRTL==null?void 0:l.isRTL(c.floating)),P=y||(R||!b?[kR(o)]:vxe(o)),U=v!=="none";!y&&U&&P.push(...Txe(o,b,v,N));const L=[o,...P],F=await D1(e,E),O=[];let B=((n=s.flip)==null?void 0:n.overflows)||[];if(d&&O.push(F[T]),p){const se=_xe(i,a,N);O.push(F[se[0]],F[se[1]])}if(B=[...B,{placement:i,overflows:O}],!O.every(se=>se<=0)){var q,j;const se=(((q=s.flip)==null?void 0:q.index)||0)+1,ae=L[se];if(ae&&(!(p==="alignment"?M!==sd(ae):!1)||B.every(ee=>sd(ee.placement)===M?ee.overflows[0]>0:!0)))return{data:{index:se,overflows:B},reset:{placement:ae}};let V=(j=B.filter(X=>X.overflows[0]<=0).sort((X,ee)=>X.overflows[1]-ee.overflows[1])[0])==null?void 0:j.placement;if(!V)switch(_){case"bestFit":{var Q;const X=(Q=B.filter(ee=>{if(U){const fe=sd(ee.placement);return fe===M||fe==="y"}return!0}).map(ee=>[ee.placement,ee.overflows.filter(fe=>fe>0).reduce((fe,Y)=>fe+Y,0)]).sort((ee,fe)=>ee[1]-fe[1])[0])==null?void 0:Q[0];X&&(V=X);break}case"initialPlacement":V=o;break}if(i!==V)return{reset:{placement:V}}}return{}}}};function h5(r,e){return{top:r.top-e.height,right:r.right-e.width,bottom:r.bottom-e.height,left:r.left-e.width}}function p5(r){return pxe.some(e=>r[e]>=0)}const Rxe=function(r){return r===void 0&&(r={}),{name:"hide",options:r,async fn(e){const{rects:t}=e,{strategy:n="referenceHidden",...i}=Wh(r,e);switch(n){case"referenceHidden":{const s=await D1(e,{...i,elementContext:"reference"}),a=h5(s,t.reference);return{data:{referenceHiddenOffsets:a,referenceHidden:p5(a)}}}case"escaped":{const s=await D1(e,{...i,altBoundary:!0}),a=h5(s,t.floating);return{data:{escapedOffsets:a,escaped:p5(a)}}}default:return{}}}}},jX=new Set(["left","top"]);async function Cxe(r,e){const{placement:t,platform:n,elements:i}=r,s=await(n.isRTL==null?void 0:n.isRTL(i.floating)),a=qh(t),o=Qx(t),l=sd(t)==="y",c=jX.has(a)?-1:1,d=s&&l?-1:1,p=Wh(e,r);let{mainAxis:y,crossAxis:_,alignmentAxis:v}=typeof p=="number"?{mainAxis:p,crossAxis:0,alignmentAxis:null}:{mainAxis:p.mainAxis||0,crossAxis:p.crossAxis||0,alignmentAxis:p.alignmentAxis};return o&&typeof v=="number"&&(_=o==="end"?v*-1:v),l?{x:_*d,y:y*c}:{x:y*c,y:_*d}}const Nxe=function(r){return r===void 0&&(r=0),{name:"offset",options:r,async fn(e){var t,n;const{x:i,y:s,placement:a,middlewareData:o}=e,l=await Cxe(e,r);return a===((t=o.offset)==null?void 0:t.placement)&&(n=o.arrow)!=null&&n.alignmentOffset?{}:{x:i+l.x,y:s+l.y,data:{...l,placement:a}}}}},Dxe=function(r){return r===void 0&&(r={}),{name:"shift",options:r,async fn(e){const{x:t,y:n,placement:i}=e,{mainAxis:s=!0,crossAxis:a=!1,limiter:o={fn:E=>{let{x:T,y:M}=E;return{x:T,y:M}}},...l}=Wh(r,e),c={x:t,y:n},d=await D1(e,l),p=sd(qh(i)),y=mI(p);let _=c[y],v=c[p];if(s){const E=y==="y"?"top":"left",T=y==="y"?"bottom":"right",M=_+d[E],R=_-d[T];_=wU(M,_,R)}if(a){const E=p==="y"?"top":"left",T=p==="y"?"bottom":"right",M=v+d[E],R=v-d[T];v=wU(M,v,R)}const b=o.fn({...e,[y]:_,[p]:v});return{...b,data:{x:b.x-t,y:b.y-n,enabled:{[y]:s,[p]:a}}}}}},Oxe=function(r){return r===void 0&&(r={}),{options:r,fn(e){const{x:t,y:n,placement:i,rects:s,middlewareData:a}=e,{offset:o=0,mainAxis:l=!0,crossAxis:c=!0}=Wh(r,e),d={x:t,y:n},p=sd(i),y=mI(p);let _=d[y],v=d[p];const b=Wh(o,e),E=typeof b=="number"?{mainAxis:b,crossAxis:0}:{mainAxis:0,crossAxis:0,...b};if(l){const R=y==="y"?"height":"width",N=s.reference[y]-s.floating[R]+E.mainAxis,P=s.reference[y]+s.reference[R]-E.mainAxis;_<N?_=N:_>P&&(_=P)}if(c){var T,M;const R=y==="y"?"width":"height",N=jX.has(qh(i)),P=s.reference[p]-s.floating[R]+(N&&((T=a.offset)==null?void 0:T[p])||0)+(N?0:E.crossAxis),U=s.reference[p]+s.reference[R]+(N?0:((M=a.offset)==null?void 0:M[p])||0)-(N?E.crossAxis:0);v<P?v=P:v>U&&(v=U)}return{[y]:_,[p]:v}}}},Uxe=function(r){return r===void 0&&(r={}),{name:"size",options:r,async fn(e){var t,n;const{placement:i,rects:s,platform:a,elements:o}=e,{apply:l=()=>{},...c}=Wh(r,e),d=await D1(e,c),p=qh(i),y=Qx(i),_=sd(i)==="y",{width:v,height:b}=s.floating;let E,T;p==="top"||p==="bottom"?(E=p,T=y===(await(a.isRTL==null?void 0:a.isRTL(o.floating))?"start":"end")?"left":"right"):(T=p,E=y==="end"?"top":"bottom");const M=b-d.top-d.bottom,R=v-d.left-d.right,N=Dm(b-d[E],M),P=Dm(v-d[T],R),U=!e.middlewareData.shift;let L=N,F=P;if((t=e.middlewareData.shift)!=null&&t.enabled.x&&(F=R),(n=e.middlewareData.shift)!=null&&n.enabled.y&&(L=M),U&&!y){const B=uu(d.left,0),q=uu(d.right,0),j=uu(d.top,0),Q=uu(d.bottom,0);_?F=v-2*(B!==0||q!==0?B+q:uu(d.left,d.right)):L=b-2*(j!==0||Q!==0?j+Q:uu(d.top,d.bottom))}await l({...e,availableWidth:F,availableHeight:L});const O=await a.getDimensions(o.floating);return v!==O.width||b!==O.height?{reset:{rects:!0}}:{}}}};function FN(){return typeof window<"u"}function Jx(r){return YX(r)?(r.nodeName||"").toLowerCase():"#document"}function _u(r){var e;return(r==null||(e=r.ownerDocument)==null?void 0:e.defaultView)||window}function Td(r){var e;return(e=(YX(r)?r.ownerDocument:r.document)||window.document)==null?void 0:e.documentElement}function YX(r){return FN()?r instanceof Node||r instanceof _u(r).Node:!1}function nf(r){return FN()?r instanceof Element||r instanceof _u(r).Element:!1}function vd(r){return FN()?r instanceof HTMLElement||r instanceof _u(r).HTMLElement:!1}function m5(r){return!FN()||typeof ShadowRoot>"u"?!1:r instanceof ShadowRoot||r instanceof _u(r).ShadowRoot}const Lxe=new Set(["inline","contents"]);function pE(r){const{overflow:e,overflowX:t,overflowY:n,display:i}=rf(r);return/auto|scroll|overlay|hidden|clip/.test(e+n+t)&&!Lxe.has(i)}const Pxe=new Set(["table","td","th"]);function Bxe(r){return Pxe.has(Jx(r))}const Ixe=[":popover-open",":modal"];function zN(r){return Ixe.some(e=>{try{return r.matches(e)}catch{return!1}})}const Fxe=["transform","translate","scale","rotate","perspective"],zxe=["transform","translate","scale","rotate","perspective","filter"],Vxe=["paint","layout","strict","content"];function _I(r){const e=vI(),t=nf(r)?rf(r):r;return Fxe.some(n=>t[n]?t[n]!=="none":!1)||(t.containerType?t.containerType!=="normal":!1)||!e&&(t.backdropFilter?t.backdropFilter!=="none":!1)||!e&&(t.filter?t.filter!=="none":!1)||zxe.some(n=>(t.willChange||"").includes(n))||Vxe.some(n=>(t.contain||"").includes(n))}function Gxe(r){let e=Om(r);for(;vd(e)&&!Ux(e);){if(_I(e))return e;if(zN(e))return null;e=Om(e)}return null}function vI(){return typeof CSS>"u"||!CSS.supports?!1:CSS.supports("-webkit-backdrop-filter","none")}const kxe=new Set(["html","body","#document"]);function Ux(r){return kxe.has(Jx(r))}function rf(r){return _u(r).getComputedStyle(r)}function VN(r){return nf(r)?{scrollLeft:r.scrollLeft,scrollTop:r.scrollTop}:{scrollLeft:r.scrollX,scrollTop:r.scrollY}}function Om(r){if(Jx(r)==="html")return r;const e=r.assignedSlot||r.parentNode||m5(r)&&r.host||Td(r);return m5(e)?e.host:e}function ZX(r){const e=Om(r);return Ux(e)?r.ownerDocument?r.ownerDocument.body:r.body:vd(e)&&pE(e)?e:ZX(e)}function O1(r,e,t){var n;e===void 0&&(e=[]),t===void 0&&(t=!0);const i=ZX(r),s=i===((n=r.ownerDocument)==null?void 0:n.body),a=_u(i);if(s){const o=CU(a);return e.concat(a,a.visualViewport||[],pE(i)?i:[],o&&t?O1(o):[])}return e.concat(i,O1(i,[],t))}function CU(r){return r.parent&&Object.getPrototypeOf(r.parent)?r.frameElement:null}function KX(r){const e=rf(r);let t=parseFloat(e.width)||0,n=parseFloat(e.height)||0;const i=vd(r),s=i?r.offsetWidth:t,a=i?r.offsetHeight:n,o=GR(t)!==s||GR(n)!==a;return o&&(t=s,n=a),{width:t,height:n,$:o}}function xI(r){return nf(r)?r:r.contextElement}function tx(r){const e=xI(r);if(!vd(e))return hd(1);const t=e.getBoundingClientRect(),{width:n,height:i,$:s}=KX(e);let a=(s?GR(t.width):t.width)/n,o=(s?GR(t.height):t.height)/i;return(!a||!Number.isFinite(a))&&(a=1),(!o||!Number.isFinite(o))&&(o=1),{x:a,y:o}}const Hxe=hd(0);function QX(r){const e=_u(r);return!vI()||!e.visualViewport?Hxe:{x:e.visualViewport.offsetLeft,y:e.visualViewport.offsetTop}}function Wxe(r,e,t){return e===void 0&&(e=!1),!t||e&&t!==_u(r)?!1:e}function Sy(r,e,t,n){e===void 0&&(e=!1),t===void 0&&(t=!1);const i=r.getBoundingClientRect(),s=xI(r);let a=hd(1);e&&(n?nf(n)&&(a=tx(n)):a=tx(r));const o=Wxe(s,t,n)?QX(s):hd(0);let l=(i.left+o.x)/a.x,c=(i.top+o.y)/a.y,d=i.width/a.x,p=i.height/a.y;if(s){const y=_u(s),_=n&&nf(n)?_u(n):n;let v=y,b=CU(v);for(;b&&n&&_!==v;){const E=tx(b),T=b.getBoundingClientRect(),M=rf(b),R=T.left+(b.clientLeft+parseFloat(M.paddingLeft))*E.x,N=T.top+(b.clientTop+parseFloat(M.paddingTop))*E.y;l*=E.x,c*=E.y,d*=E.x,p*=E.y,l+=R,c+=N,v=_u(b),b=CU(v)}}return HR({width:d,height:p,x:l,y:c})}function GN(r,e){const t=VN(r).scrollLeft;return e?e.left+t:Sy(Td(r)).left+t}function JX(r,e){const t=r.getBoundingClientRect(),n=t.left+e.scrollLeft-GN(r,t),i=t.top+e.scrollTop;return{x:n,y:i}}function qxe(r){let{elements:e,rect:t,offsetParent:n,strategy:i}=r;const s=i==="fixed",a=Td(n),o=e?zN(e.floating):!1;if(n===a||o&&s)return t;let l={scrollLeft:0,scrollTop:0},c=hd(1);const d=hd(0),p=vd(n);if((p||!p&&!s)&&((Jx(n)!=="body"||pE(a))&&(l=VN(n)),vd(n))){const _=Sy(n);c=tx(n),d.x=_.x+n.clientLeft,d.y=_.y+n.clientTop}const y=a&&!p&&!s?JX(a,l):hd(0);return{width:t.width*c.x,height:t.height*c.y,x:t.x*c.x-l.scrollLeft*c.x+d.x+y.x,y:t.y*c.y-l.scrollTop*c.y+d.y+y.y}}function Xxe(r){return Array.from(r.getClientRects())}function $xe(r){const e=Td(r),t=VN(r),n=r.ownerDocument.body,i=uu(e.scrollWidth,e.clientWidth,n.scrollWidth,n.clientWidth),s=uu(e.scrollHeight,e.clientHeight,n.scrollHeight,n.clientHeight);let a=-t.scrollLeft+GN(r);const o=-t.scrollTop;return rf(n).direction==="rtl"&&(a+=uu(e.clientWidth,n.clientWidth)-i),{width:i,height:s,x:a,y:o}}const g5=25;function jxe(r,e){const t=_u(r),n=Td(r),i=t.visualViewport;let s=n.clientWidth,a=n.clientHeight,o=0,l=0;if(i){s=i.width,a=i.height;const d=vI();(!d||d&&e==="fixed")&&(o=i.offsetLeft,l=i.offsetTop)}const c=GN(n);if(c<=0){const d=n.ownerDocument,p=d.body,y=getComputedStyle(p),_=d.compatMode==="CSS1Compat"&&parseFloat(y.marginLeft)+parseFloat(y.marginRight)||0,v=Math.abs(n.clientWidth-p.clientWidth-_);v<=g5&&(s-=v)}else c<=g5&&(s+=c);return{width:s,height:a,x:o,y:l}}const Yxe=new Set(["absolute","fixed"]);function Zxe(r,e){const t=Sy(r,!0,e==="fixed"),n=t.top+r.clientTop,i=t.left+r.clientLeft,s=vd(r)?tx(r):hd(1),a=r.clientWidth*s.x,o=r.clientHeight*s.y,l=i*s.x,c=n*s.y;return{width:a,height:o,x:l,y:c}}function y5(r,e,t){let n;if(e==="viewport")n=jxe(r,t);else if(e==="document")n=$xe(Td(r));else if(nf(e))n=Zxe(e,t);else{const i=QX(r);n={x:e.x-i.x,y:e.y-i.y,width:e.width,height:e.height}}return HR(n)}function e$(r,e){const t=Om(r);return t===e||!nf(t)||Ux(t)?!1:rf(t).position==="fixed"||e$(t,e)}function Kxe(r,e){const t=e.get(r);if(t)return t;let n=O1(r,[],!1).filter(o=>nf(o)&&Jx(o)!=="body"),i=null;const s=rf(r).position==="fixed";let a=s?Om(r):r;for(;nf(a)&&!Ux(a);){const o=rf(a),l=_I(a);!l&&o.position==="fixed"&&(i=null),(s?!l&&!i:!l&&o.position==="static"&&!!i&&Yxe.has(i.position)||pE(a)&&!l&&e$(r,a))?n=n.filter(d=>d!==a):i=o,a=Om(a)}return e.set(r,n),n}function Qxe(r){let{element:e,boundary:t,rootBoundary:n,strategy:i}=r;const a=[...t==="clippingAncestors"?zN(e)?[]:Kxe(e,this._c):[].concat(t),n],o=a[0],l=a.reduce((c,d)=>{const p=y5(e,d,i);return c.top=uu(p.top,c.top),c.right=Dm(p.right,c.right),c.bottom=Dm(p.bottom,c.bottom),c.left=uu(p.left,c.left),c},y5(e,o,i));return{width:l.right-l.left,height:l.bottom-l.top,x:l.left,y:l.top}}function Jxe(r){const{width:e,height:t}=KX(r);return{width:e,height:t}}function ebe(r,e,t){const n=vd(e),i=Td(e),s=t==="fixed",a=Sy(r,!0,s,e);let o={scrollLeft:0,scrollTop:0};const l=hd(0);function c(){l.x=GN(i)}if(n||!n&&!s)if((Jx(e)!=="body"||pE(i))&&(o=VN(e)),n){const _=Sy(e,!0,s,e);l.x=_.x+e.clientLeft,l.y=_.y+e.clientTop}else i&&c();s&&!n&&i&&c();const d=i&&!n&&!s?JX(i,o):hd(0),p=a.left+o.scrollLeft-l.x-d.x,y=a.top+o.scrollTop-l.y-d.y;return{x:p,y,width:a.width,height:a.height}}function BD(r){return rf(r).position==="static"}function _5(r,e){if(!vd(r)||rf(r).position==="fixed")return null;if(e)return e(r);let t=r.offsetParent;return Td(r)===t&&(t=t.ownerDocument.body),t}function t$(r,e){const t=_u(r);if(zN(r))return t;if(!vd(r)){let i=Om(r);for(;i&&!Ux(i);){if(nf(i)&&!BD(i))return i;i=Om(i)}return t}let n=_5(r,e);for(;n&&Bxe(n)&&BD(n);)n=_5(n,e);return n&&Ux(n)&&BD(n)&&!_I(n)?t:n||Gxe(r)||t}const tbe=async function(r){const e=this.getOffsetParent||t$,t=this.getDimensions,n=await t(r.floating);return{reference:ebe(r.reference,await e(r.floating),r.strategy),floating:{x:0,y:0,width:n.width,height:n.height}}};function nbe(r){return rf(r).direction==="rtl"}const ibe={convertOffsetParentRelativeRectToViewportRelativeRect:qxe,getDocumentElement:Td,getClippingRect:Qxe,getOffsetParent:t$,getElementRects:tbe,getClientRects:Xxe,getDimensions:Jxe,getScale:tx,isElement:nf,isRTL:nbe};function n$(r,e){return r.x===e.x&&r.y===e.y&&r.width===e.width&&r.height===e.height}function rbe(r,e){let t=null,n;const i=Td(r);function s(){var o;clearTimeout(n),(o=t)==null||o.disconnect(),t=null}function a(o,l){o===void 0&&(o=!1),l===void 0&&(l=1),s();const c=r.getBoundingClientRect(),{left:d,top:p,width:y,height:_}=c;if(o||e(),!y||!_)return;const v=yw(p),b=yw(i.clientWidth-(d+y)),E=yw(i.clientHeight-(p+_)),T=yw(d),R={rootMargin:-v+"px "+-b+"px "+-E+"px "+-T+"px",threshold:uu(0,Dm(1,l))||1};let N=!0;function P(U){const L=U[0].intersectionRatio;if(L!==l){if(!N)return a();L?a(!1,L):n=setTimeout(()=>{a(!1,1e-7)},1e3)}L===1&&!n$(c,r.getBoundingClientRect())&&a(),N=!1}try{t=new IntersectionObserver(P,{...R,root:i.ownerDocument})}catch{t=new IntersectionObserver(P,R)}t.observe(r)}return a(!0),s}function sbe(r,e,t,n){n===void 0&&(n={});const{ancestorScroll:i=!0,ancestorResize:s=!0,elementResize:a=typeof ResizeObserver=="function",layoutShift:o=typeof IntersectionObserver=="function",animationFrame:l=!1}=n,c=xI(r),d=i||s?[...c?O1(c):[],...O1(e)]:[];d.forEach(T=>{i&&T.addEventListener("scroll",t,{passive:!0}),s&&T.addEventListener("resize",t)});const p=c&&o?rbe(c,t):null;let y=-1,_=null;a&&(_=new ResizeObserver(T=>{let[M]=T;M&&M.target===c&&_&&(_.unobserve(e),cancelAnimationFrame(y),y=requestAnimationFrame(()=>{var R;(R=_)==null||R.observe(e)})),t()}),c&&!l&&_.observe(c),_.observe(e));let v,b=l?Sy(r):null;l&&E();function E(){const T=Sy(r);b&&!n$(b,T)&&t(),b=T,v=requestAnimationFrame(E)}return t(),()=>{var T;d.forEach(M=>{i&&M.removeEventListener("scroll",t),s&&M.removeEventListener("resize",t)}),p?.(),(T=_)==null||T.disconnect(),_=null,l&&cancelAnimationFrame(v)}}const abe=Nxe,obe=Dxe,lbe=wxe,ube=Uxe,cbe=Rxe,v5=Axe,fbe=Oxe,dbe=(r,e,t)=>{const n=new Map,i={platform:ibe,...t},s={...i.platform,_c:n};return Mxe(r,e,{...i,platform:s})};var hbe=typeof document<"u",pbe=function(){},Xw=hbe?H.useLayoutEffect:pbe;function WR(r,e){if(r===e)return!0;if(typeof r!=typeof e)return!1;if(typeof r=="function"&&r.toString()===e.toString())return!0;let t,n,i;if(r&&e&&typeof r=="object"){if(Array.isArray(r)){if(t=r.length,t!==e.length)return!1;for(n=t;n--!==0;)if(!WR(r[n],e[n]))return!1;return!0}if(i=Object.keys(r),t=i.length,t!==Object.keys(e).length)return!1;for(n=t;n--!==0;)if(!{}.hasOwnProperty.call(e,i[n]))return!1;for(n=t;n--!==0;){const s=i[n];if(!(s==="_owner"&&r.$$typeof)&&!WR(r[s],e[s]))return!1}return!0}return r!==r&&e!==e}function i$(r){return typeof window>"u"?1:(r.ownerDocument.defaultView||window).devicePixelRatio||1}function x5(r,e){const t=i$(r);return Math.round(e*t)/t}function ID(r){const e=H.useRef(r);return Xw(()=>{e.current=r}),e}function mbe(r){r===void 0&&(r={});const{placement:e="bottom",strategy:t="absolute",middleware:n=[],platform:i,elements:{reference:s,floating:a}={},transform:o=!0,whileElementsMounted:l,open:c}=r,[d,p]=H.useState({x:0,y:0,strategy:t,placement:e,middlewareData:{},isPositioned:!1}),[y,_]=H.useState(n);WR(y,n)||_(n);const[v,b]=H.useState(null),[E,T]=H.useState(null),M=H.useCallback(ee=>{ee!==U.current&&(U.current=ee,b(ee))},[]),R=H.useCallback(ee=>{ee!==L.current&&(L.current=ee,T(ee))},[]),N=s||v,P=a||E,U=H.useRef(null),L=H.useRef(null),F=H.useRef(d),O=l!=null,B=ID(l),q=ID(i),j=ID(c),Q=H.useCallback(()=>{if(!U.current||!L.current)return;const ee={placement:e,strategy:t,middleware:y};q.current&&(ee.platform=q.current),dbe(U.current,L.current,ee).then(fe=>{const Y={...fe,isPositioned:j.current!==!1};se.current&&!WR(F.current,Y)&&(F.current=Y,dI.flushSync(()=>{p(Y)}))})},[y,e,t,q,j]);Xw(()=>{c===!1&&F.current.isPositioned&&(F.current.isPositioned=!1,p(ee=>({...ee,isPositioned:!1})))},[c]);const se=H.useRef(!1);Xw(()=>(se.current=!0,()=>{se.current=!1}),[]),Xw(()=>{if(N&&(U.current=N),P&&(L.current=P),N&&P){if(B.current)return B.current(N,P,Q);Q()}},[N,P,Q,B,O]);const ae=H.useMemo(()=>({reference:U,floating:L,setReference:M,setFloating:R}),[M,R]),V=H.useMemo(()=>({reference:N,floating:P}),[N,P]),X=H.useMemo(()=>{const ee={position:t,left:0,top:0};if(!V.floating)return ee;const fe=x5(V.floating,d.x),Y=x5(V.floating,d.y);return o?{...ee,transform:"translate("+fe+"px, "+Y+"px)",...i$(V.floating)>=1.5&&{willChange:"transform"}}:{position:t,left:fe,top:Y}},[t,o,V.floating,d.x,d.y]);return H.useMemo(()=>({...d,update:Q,refs:ae,elements:V,floatingStyles:X}),[d,Q,ae,V,X])}const gbe=r=>{function e(t){return{}.hasOwnProperty.call(t,"current")}return{name:"arrow",options:r,fn(t){const{element:n,padding:i}=typeof r=="function"?r(t):r;return n&&e(n)?n.current!=null?v5({element:n.current,padding:i}).fn(t):{}:n?v5({element:n,padding:i}).fn(t):{}}}},ybe=(r,e)=>({...abe(r),options:[r,e]}),_be=(r,e)=>({...obe(r),options:[r,e]}),vbe=(r,e)=>({...fbe(r),options:[r,e]}),xbe=(r,e)=>({...lbe(r),options:[r,e]}),bbe=(r,e)=>({...ube(r),options:[r,e]}),Sbe=(r,e)=>({...cbe(r),options:[r,e]}),Tbe=(r,e)=>({...gbe(r),options:[r,e]});function Ebe(r){const e=Mbe(r),t=H.forwardRef((n,i)=>{const{children:s,...a}=n,o=H.Children.toArray(s),l=o.find(wbe);if(l){const c=l.props.children,d=o.map(p=>p===l?H.Children.count(c)>1?H.Children.only(null):H.isValidElement(c)?c.props.children:null:p);return Wt.jsx(e,{...a,ref:i,children:H.isValidElement(c)?H.cloneElement(c,void 0,d):null})}return Wt.jsx(e,{...a,ref:i,children:s})});return t.displayName=`${r}.Slot`,t}function Mbe(r){const e=H.forwardRef((t,n)=>{const{children:i,...s}=t;if(H.isValidElement(i)){const a=Cbe(i),o=Rbe(s,i.props);return i.type!==H.Fragment&&(o.ref=n?Iy(n,a):a),H.cloneElement(i,o)}return H.Children.count(i)>1?H.Children.only(null):null});return e.displayName=`${r}.SlotClone`,e}var Abe=Symbol("radix.slottable");function wbe(r){return H.isValidElement(r)&&typeof r.type=="function"&&"__radixId"in r.type&&r.type.__radixId===Abe}function Rbe(r,e){const t={...e};for(const n in e){const i=r[n],s=e[n];/^on[A-Z]/.test(n)?i&&s?t[n]=(...o)=>{const l=s(...o);return i(...o),l}:i&&(t[n]=i):n==="style"?t[n]={...i,...s}:n==="className"&&(t[n]=[i,s].filter(Boolean).join(" "))}return{...r,...t}}function Cbe(r){let e=Object.getOwnPropertyDescriptor(r.props,"ref")?.get,t=e&&"isReactWarning"in e&&e.isReactWarning;return t?r.ref:(e=Object.getOwnPropertyDescriptor(r,"ref")?.get,t=e&&"isReactWarning"in e&&e.isReactWarning,t?r.props.ref:r.props.ref||r.ref)}var Nbe=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"],Dbe=Nbe.reduce((r,e)=>{const t=Ebe(`Primitive.${e}`),n=H.forwardRef((i,s)=>{const{asChild:a,...o}=i,l=a?t:e;return typeof window<"u"&&(window[Symbol.for("radix-ui")]=!0),Wt.jsx(l,{...o,ref:s})});return n.displayName=`Primitive.${e}`,{...r,[e]:n}},{}),Obe="Arrow",r$=H.forwardRef((r,e)=>{const{children:t,width:n=10,height:i=5,...s}=r;return Wt.jsx(Dbe.svg,{...s,ref:e,width:n,height:i,viewBox:"0 0 30 10",preserveAspectRatio:"none",children:r.asChild?t:Wt.jsx("polygon",{points:"0,0 30,0 15,10"})})});r$.displayName=Obe;var Ube=r$;function Lbe(r){const e=Pbe(r),t=H.forwardRef((n,i)=>{const{children:s,...a}=n,o=H.Children.toArray(s),l=o.find(Ibe);if(l){const c=l.props.children,d=o.map(p=>p===l?H.Children.count(c)>1?H.Children.only(null):H.isValidElement(c)?c.props.children:null:p);return Wt.jsx(e,{...a,ref:i,children:H.isValidElement(c)?H.cloneElement(c,void 0,d):null})}return Wt.jsx(e,{...a,ref:i,children:s})});return t.displayName=`${r}.Slot`,t}function Pbe(r){const e=H.forwardRef((t,n)=>{const{children:i,...s}=t;if(H.isValidElement(i)){const a=zbe(i),o=Fbe(s,i.props);return i.type!==H.Fragment&&(o.ref=n?Iy(n,a):a),H.cloneElement(i,o)}return H.Children.count(i)>1?H.Children.only(null):null});return e.displayName=`${r}.SlotClone`,e}var Bbe=Symbol("radix.slottable");function Ibe(r){return H.isValidElement(r)&&typeof r.type=="function"&&"__radixId"in r.type&&r.type.__radixId===Bbe}function Fbe(r,e){const t={...e};for(const n in e){const i=r[n],s=e[n];/^on[A-Z]/.test(n)?i&&s?t[n]=(...o)=>{const l=s(...o);return i(...o),l}:i&&(t[n]=i):n==="style"?t[n]={...i,...s}:n==="className"&&(t[n]=[i,s].filter(Boolean).join(" "))}return{...r,...t}}function zbe(r){let e=Object.getOwnPropertyDescriptor(r.props,"ref")?.get,t=e&&"isReactWarning"in e&&e.isReactWarning;return t?r.ref:(e=Object.getOwnPropertyDescriptor(r,"ref")?.get,t=e&&"isReactWarning"in e&&e.isReactWarning,t?r.props.ref:r.props.ref||r.ref)}var Vbe=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"],s$=Vbe.reduce((r,e)=>{const t=Lbe(`Primitive.${e}`),n=H.forwardRef((i,s)=>{const{asChild:a,...o}=i,l=a?t:e;return typeof window<"u"&&(window[Symbol.for("radix-ui")]=!0),Wt.jsx(l,{...o,ref:s})});return n.displayName=`Primitive.${e}`,{...r,[e]:n}},{});function Gbe(r){const[e,t]=H.useState(void 0);return Nm(()=>{if(r){t({width:r.offsetWidth,height:r.offsetHeight});const n=new ResizeObserver(i=>{if(!Array.isArray(i)||!i.length)return;const s=i[0];let a,o;if("borderBoxSize"in s){const l=s.borderBoxSize,c=Array.isArray(l)?l[0]:l;a=c.inlineSize,o=c.blockSize}else a=r.offsetWidth,o=r.offsetHeight;t({width:a,height:o})});return n.observe(r,{box:"border-box"}),()=>n.unobserve(r)}else t(void 0)},[r]),e}var bI="Popper",[a$,o$]=kX(bI),[kbe,l$]=a$(bI),u$=r=>{const{__scopePopper:e,children:t}=r,[n,i]=H.useState(null);return Wt.jsx(kbe,{scope:e,anchor:n,onAnchorChange:i,children:t})};u$.displayName=bI;var c$="PopperAnchor",f$=H.forwardRef((r,e)=>{const{__scopePopper:t,virtualRef:n,...i}=r,s=l$(c$,t),a=H.useRef(null),o=Fy(e,a),l=H.useRef(null);return H.useEffect(()=>{const c=l.current;l.current=n?.current||a.current,c!==l.current&&s.onAnchorChange(l.current)}),n?null:Wt.jsx(s$.div,{...i,ref:o})});f$.displayName=c$;var SI="PopperContent",[Hbe,Wbe]=a$(SI),d$=H.forwardRef((r,e)=>{const{__scopePopper:t,side:n="bottom",sideOffset:i=0,align:s="center",alignOffset:a=0,arrowPadding:o=0,avoidCollisions:l=!0,collisionBoundary:c=[],collisionPadding:d=0,sticky:p="partial",hideWhenDetached:y=!1,updatePositionStrategy:_="optimized",onPlaced:v,...b}=r,E=l$(SI,t),[T,M]=H.useState(null),R=Fy(e,Ne=>M(Ne)),[N,P]=H.useState(null),U=Gbe(N),L=U?.width??0,F=U?.height??0,O=n+(s!=="center"?"-"+s:""),B=typeof d=="number"?d:{top:0,right:0,bottom:0,left:0,...d},q=Array.isArray(c)?c:[c],j=q.length>0,Q={padding:B,boundary:q.filter(Xbe),altBoundary:j},{refs:se,floatingStyles:ae,placement:V,isPositioned:X,middlewareData:ee}=mbe({strategy:"fixed",placement:O,whileElementsMounted:(...Ne)=>sbe(...Ne,{animationFrame:_==="always"}),elements:{reference:E.anchor},middleware:[ybe({mainAxis:i+F,alignmentAxis:a}),l&&_be({mainAxis:!0,crossAxis:!1,limiter:p==="partial"?vbe():void 0,...Q}),l&&xbe({...Q}),bbe({...Q,apply:({elements:Ne,rects:rt,availableWidth:Nt,availableHeight:Ft})=>{const{width:fn,height:Sn}=rt.reference,At=Ne.floating.style;At.setProperty("--radix-popper-available-width",`${Nt}px`),At.setProperty("--radix-popper-available-height",`${Ft}px`),At.setProperty("--radix-popper-anchor-width",`${fn}px`),At.setProperty("--radix-popper-anchor-height",`${Sn}px`)}}),N&&Tbe({element:N,padding:o}),$be({arrowWidth:L,arrowHeight:F}),y&&Sbe({strategy:"referenceHidden",...Q})]}),[fe,Y]=m$(V),K=IN(v);Nm(()=>{X&&K?.()},[X,K]);const he=ee.arrow?.x,Ce=ee.arrow?.y,Ie=ee.arrow?.centerOffset!==0,[ut,Ee]=H.useState();return Nm(()=>{T&&Ee(window.getComputedStyle(T).zIndex)},[T]),Wt.jsx("div",{ref:se.setFloating,"data-radix-popper-content-wrapper":"",style:{...ae,transform:X?ae.transform:"translate(0, -200%)",minWidth:"max-content",zIndex:ut,"--radix-popper-transform-origin":[ee.transformOrigin?.x,ee.transformOrigin?.y].join(" "),...ee.hide?.referenceHidden&&{visibility:"hidden",pointerEvents:"none"}},dir:r.dir,children:Wt.jsx(Hbe,{scope:t,placedSide:fe,onArrowChange:P,arrowX:he,arrowY:Ce,shouldHideArrow:Ie,children:Wt.jsx(s$.div,{"data-side":fe,"data-align":Y,...b,ref:R,style:{...b.style,animation:X?void 0:"none"}})})})});d$.displayName=SI;var h$="PopperArrow",qbe={top:"bottom",right:"left",bottom:"top",left:"right"},p$=H.forwardRef(function(e,t){const{__scopePopper:n,...i}=e,s=Wbe(h$,n),a=qbe[s.placedSide];return Wt.jsx("span",{ref:s.onArrowChange,style:{position:"absolute",left:s.arrowX,top:s.arrowY,[a]:0,transformOrigin:{top:"",right:"0 0",bottom:"center 0",left:"100% 0"}[s.placedSide],transform:{top:"translateY(100%)",right:"translateY(50%) rotate(90deg) translateX(-50%)",bottom:"rotate(180deg)",left:"translateY(50%) rotate(-90deg) translateX(50%)"}[s.placedSide],visibility:s.shouldHideArrow?"hidden":void 0},children:Wt.jsx(Ube,{...i,ref:t,style:{...i.style,display:"block"}})})});p$.displayName=h$;function Xbe(r){return r!==null}var $be=r=>({name:"transformOrigin",options:r,fn(e){const{placement:t,rects:n,middlewareData:i}=e,a=i.arrow?.centerOffset!==0,o=a?0:r.arrowWidth,l=a?0:r.arrowHeight,[c,d]=m$(t),p={start:"0%",center:"50%",end:"100%"}[d],y=(i.arrow?.x??0)+o/2,_=(i.arrow?.y??0)+l/2;let v="",b="";return c==="bottom"?(v=a?p:`${y}px`,b=`${-l}px`):c==="top"?(v=a?p:`${y}px`,b=`${n.floating.height+l}px`):c==="right"?(v=`${-l}px`,b=a?p:`${_}px`):c==="left"&&(v=`${n.floating.width+l}px`,b=a?p:`${_}px`),{data:{x:v,y:b}}}});function m$(r){const[e,t="center"]=r.split("-");return[e,t]}var jbe=u$,Ybe=f$,Zbe=d$,Kbe=p$;function Qbe(r){const e=Jbe(r),t=H.forwardRef((n,i)=>{const{children:s,...a}=n,o=H.Children.toArray(s),l=o.find(tSe);if(l){const c=l.props.children,d=o.map(p=>p===l?H.Children.count(c)>1?H.Children.only(null):H.isValidElement(c)?c.props.children:null:p);return Wt.jsx(e,{...a,ref:i,children:H.isValidElement(c)?H.cloneElement(c,void 0,d):null})}return Wt.jsx(e,{...a,ref:i,children:s})});return t.displayName=`${r}.Slot`,t}function Jbe(r){const e=H.forwardRef((t,n)=>{const{children:i,...s}=t;if(H.isValidElement(i)){const a=iSe(i),o=nSe(s,i.props);return i.type!==H.Fragment&&(o.ref=n?Iy(n,a):a),H.cloneElement(i,o)}return H.Children.count(i)>1?H.Children.only(null):null});return e.displayName=`${r}.SlotClone`,e}var g$=Symbol("radix.slottable");function eSe(r){const e=({children:t})=>Wt.jsx(Wt.Fragment,{children:t});return e.displayName=`${r}.Slottable`,e.__radixId=g$,e}function tSe(r){return H.isValidElement(r)&&typeof r.type=="function"&&"__radixId"in r.type&&r.type.__radixId===g$}function nSe(r,e){const t={...e};for(const n in e){const i=r[n],s=e[n];/^on[A-Z]/.test(n)?i&&s?t[n]=(...o)=>{const l=s(...o);return i(...o),l}:i&&(t[n]=i):n==="style"?t[n]={...i,...s}:n==="className"&&(t[n]=[i,s].filter(Boolean).join(" "))}return{...r,...t}}function iSe(r){let e=Object.getOwnPropertyDescriptor(r.props,"ref")?.get,t=e&&"isReactWarning"in e&&e.isReactWarning;return t?r.ref:(e=Object.getOwnPropertyDescriptor(r,"ref")?.get,t=e&&"isReactWarning"in e&&e.isReactWarning,t?r.props.ref:r.props.ref||r.ref)}var rSe=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"],sSe=rSe.reduce((r,e)=>{const t=Qbe(`Primitive.${e}`),n=H.forwardRef((i,s)=>{const{asChild:a,...o}=i,l=a?t:e;return typeof window<"u"&&(window[Symbol.for("radix-ui")]=!0),Wt.jsx(l,{...o,ref:s})});return n.displayName=`Primitive.${e}`,{...r,[e]:n}},{});function aSe(r,e){return H.useReducer((t,n)=>e[t][n]??t,r)}var y$=r=>{const{present:e,children:t}=r,n=oSe(e),i=typeof t=="function"?t({present:n.isPresent}):H.Children.only(t),s=Fy(n.ref,lSe(i));return typeof t=="function"||n.isPresent?H.cloneElement(i,{ref:s}):null};y$.displayName="Presence";function oSe(r){const[e,t]=H.useState(),n=H.useRef(null),i=H.useRef(r),s=H.useRef("none"),a=r?"mounted":"unmounted",[o,l]=aSe(a,{mounted:{UNMOUNT:"unmounted",ANIMATION_OUT:"unmountSuspended"},unmountSuspended:{MOUNT:"mounted",ANIMATION_END:"unmounted"},unmounted:{MOUNT:"mounted"}});return H.useEffect(()=>{const c=_w(n.current);s.current=o==="mounted"?c:"none"},[o]),Nm(()=>{const c=n.current,d=i.current;if(d!==r){const y=s.current,_=_w(c);r?l("MOUNT"):_==="none"||c?.display==="none"?l("UNMOUNT"):l(d&&y!==_?"ANIMATION_OUT":"UNMOUNT"),i.current=r}},[r,l]),Nm(()=>{if(e){let c;const d=e.ownerDocument.defaultView??window,p=_=>{const b=_w(n.current).includes(CSS.escape(_.animationName));if(_.target===e&&b&&(l("ANIMATION_END"),!i.current)){const E=e.style.animationFillMode;e.style.animationFillMode="forwards",c=d.setTimeout(()=>{e.style.animationFillMode==="forwards"&&(e.style.animationFillMode=E)})}},y=_=>{_.target===e&&(s.current=_w(n.current))};return e.addEventListener("animationstart",y),e.addEventListener("animationcancel",p),e.addEventListener("animationend",p),()=>{d.clearTimeout(c),e.removeEventListener("animationstart",y),e.removeEventListener("animationcancel",p),e.removeEventListener("animationend",p)}}else l("ANIMATION_END")},[e,l]),{isPresent:["mounted","unmountSuspended"].includes(o),ref:H.useCallback(c=>{n.current=c?getComputedStyle(c):null,t(c)},[])}}function _w(r){return r?.animationName||"none"}function lSe(r){let e=Object.getOwnPropertyDescriptor(r.props,"ref")?.get,t=e&&"isReactWarning"in e&&e.isReactWarning;return t?r.ref:(e=Object.getOwnPropertyDescriptor(r,"ref")?.get,t=e&&"isReactWarning"in e&&e.isReactWarning,t?r.props.ref:r.props.ref||r.ref)}var uSe=XU[" useInsertionEffect ".trim().toString()]||Nm;function cSe({prop:r,defaultProp:e,onChange:t=()=>{},caller:n}){const[i,s,a]=fSe({defaultProp:e,onChange:t}),o=r!==void 0,l=o?r:i;{const d=H.useRef(r!==void 0);H.useEffect(()=>{const p=d.current;p!==o&&console.warn(`${n} is changing from ${p?"controlled":"uncontrolled"} to ${o?"controlled":"uncontrolled"}. Components should not switch from controlled to uncontrolled (or vice versa). Decide between using a controlled or uncontrolled value for the lifetime of the component.`),d.current=o},[o,n])}const c=H.useCallback(d=>{if(o){const p=dSe(d)?d(r):d;p!==r&&a.current?.(p)}else s(d)},[o,r,s,a]);return[l,c]}function fSe({defaultProp:r,onChange:e}){const[t,n]=H.useState(r),i=H.useRef(t),s=H.useRef(e);return uSe(()=>{s.current=e},[e]),H.useEffect(()=>{i.current!==t&&(s.current?.(t),i.current=t)},[t,i]),[t,n,s]}function dSe(r){return typeof r=="function"}function hSe(r){const e=pSe(r),t=H.forwardRef((n,i)=>{const{children:s,...a}=n,o=H.Children.toArray(s),l=o.find(gSe);if(l){const c=l.props.children,d=o.map(p=>p===l?H.Children.count(c)>1?H.Children.only(null):H.isValidElement(c)?c.props.children:null:p);return Wt.jsx(e,{...a,ref:i,children:H.isValidElement(c)?H.cloneElement(c,void 0,d):null})}return Wt.jsx(e,{...a,ref:i,children:s})});return t.displayName=`${r}.Slot`,t}function pSe(r){const e=H.forwardRef((t,n)=>{const{children:i,...s}=t;if(H.isValidElement(i)){const a=_Se(i),o=ySe(s,i.props);return i.type!==H.Fragment&&(o.ref=n?Iy(n,a):a),H.cloneElement(i,o)}return H.Children.count(i)>1?H.Children.only(null):null});return e.displayName=`${r}.SlotClone`,e}var mSe=Symbol("radix.slottable");function gSe(r){return H.isValidElement(r)&&typeof r.type=="function"&&"__radixId"in r.type&&r.type.__radixId===mSe}function ySe(r,e){const t={...e};for(const n in e){const i=r[n],s=e[n];/^on[A-Z]/.test(n)?i&&s?t[n]=(...o)=>{const l=s(...o);return i(...o),l}:i&&(t[n]=i):n==="style"?t[n]={...i,...s}:n==="className"&&(t[n]=[i,s].filter(Boolean).join(" "))}return{...r,...t}}function _Se(r){let e=Object.getOwnPropertyDescriptor(r.props,"ref")?.get,t=e&&"isReactWarning"in e&&e.isReactWarning;return t?r.ref:(e=Object.getOwnPropertyDescriptor(r,"ref")?.get,t=e&&"isReactWarning"in e&&e.isReactWarning,t?r.props.ref:r.props.ref||r.ref)}var vSe=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"],xSe=vSe.reduce((r,e)=>{const t=hSe(`Primitive.${e}`),n=H.forwardRef((i,s)=>{const{asChild:a,...o}=i,l=a?t:e;return typeof window<"u"&&(window[Symbol.for("radix-ui")]=!0),Wt.jsx(l,{...o,ref:s})});return n.displayName=`Primitive.${e}`,{...r,[e]:n}},{}),bSe=Object.freeze({position:"absolute",border:0,width:1,height:1,padding:0,margin:-1,overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",wordWrap:"normal"}),SSe="VisuallyHidden",_$=H.forwardRef((r,e)=>Wt.jsx(xSe.span,{...r,ref:e,style:{...bSe,...r.style}}));_$.displayName=SSe;var TSe=_$,[kN]=kX("Tooltip",[o$]),HN=o$(),v$="TooltipProvider",ESe=700,NU="tooltip.open",[MSe,TI]=kN(v$),x$=r=>{const{__scopeTooltip:e,delayDuration:t=ESe,skipDelayDuration:n=300,disableHoverableContent:i=!1,children:s}=r,a=H.useRef(!0),o=H.useRef(!1),l=H.useRef(0);return H.useEffect(()=>{const c=l.current;return()=>window.clearTimeout(c)},[]),Wt.jsx(MSe,{scope:e,isOpenDelayedRef:a,delayDuration:t,onOpen:H.useCallback(()=>{window.clearTimeout(l.current),a.current=!1},[]),onClose:H.useCallback(()=>{window.clearTimeout(l.current),l.current=window.setTimeout(()=>a.current=!0,n)},[n]),isPointerInTransitRef:o,onPointerInTransitChange:H.useCallback(c=>{o.current=c},[]),disableHoverableContent:i,children:s})};x$.displayName=v$;var U1="Tooltip",[ASe,WN]=kN(U1),b$=r=>{const{__scopeTooltip:e,children:t,open:n,defaultOpen:i,onOpenChange:s,disableHoverableContent:a,delayDuration:o}=r,l=TI(U1,r.__scopeTooltip),c=HN(e),[d,p]=H.useState(null),y=hxe(),_=H.useRef(0),v=a??l.disableHoverableContent,b=o??l.delayDuration,E=H.useRef(!1),[T,M]=cSe({prop:n,defaultProp:i??!1,onChange:L=>{L?(l.onOpen(),document.dispatchEvent(new CustomEvent(NU))):l.onClose(),s?.(L)},caller:U1}),R=H.useMemo(()=>T?E.current?"delayed-open":"instant-open":"closed",[T]),N=H.useCallback(()=>{window.clearTimeout(_.current),_.current=0,E.current=!1,M(!0)},[M]),P=H.useCallback(()=>{window.clearTimeout(_.current),_.current=0,M(!1)},[M]),U=H.useCallback(()=>{window.clearTimeout(_.current),_.current=window.setTimeout(()=>{E.current=!0,M(!0),_.current=0},b)},[b,M]);return H.useEffect(()=>()=>{_.current&&(window.clearTimeout(_.current),_.current=0)},[]),Wt.jsx(jbe,{...c,children:Wt.jsx(ASe,{scope:e,contentId:y,open:T,stateAttribute:R,trigger:d,onTriggerChange:p,onTriggerEnter:H.useCallback(()=>{l.isOpenDelayedRef.current?U():N()},[l.isOpenDelayedRef,U,N]),onTriggerLeave:H.useCallback(()=>{v?P():(window.clearTimeout(_.current),_.current=0)},[P,v]),onOpen:N,onClose:P,disableHoverableContent:v,children:t})})};b$.displayName=U1;var DU="TooltipTrigger",S$=H.forwardRef((r,e)=>{const{__scopeTooltip:t,...n}=r,i=WN(DU,t),s=TI(DU,t),a=HN(t),o=H.useRef(null),l=Fy(e,o,i.onTriggerChange),c=H.useRef(!1),d=H.useRef(!1),p=H.useCallback(()=>c.current=!1,[]);return H.useEffect(()=>()=>document.removeEventListener("pointerup",p),[p]),Wt.jsx(Ybe,{asChild:!0,...a,children:Wt.jsx(sSe.button,{"aria-describedby":i.open?i.contentId:void 0,"data-state":i.stateAttribute,...n,ref:l,onPointerMove:fh(r.onPointerMove,y=>{y.pointerType!=="touch"&&!d.current&&!s.isPointerInTransitRef.current&&(i.onTriggerEnter(),d.current=!0)}),onPointerLeave:fh(r.onPointerLeave,()=>{i.onTriggerLeave(),d.current=!1}),onPointerDown:fh(r.onPointerDown,()=>{i.open&&i.onClose(),c.current=!0,document.addEventListener("pointerup",p,{once:!0})}),onFocus:fh(r.onFocus,()=>{c.current||i.onOpen()}),onBlur:fh(r.onBlur,i.onClose),onClick:fh(r.onClick,i.onClose)})})});S$.displayName=DU;var wSe="TooltipPortal",[swe,RSe]=kN(wSe,{forceMount:void 0}),Lx="TooltipContent",T$=H.forwardRef((r,e)=>{const t=RSe(Lx,r.__scopeTooltip),{forceMount:n=t.forceMount,side:i="top",...s}=r,a=WN(Lx,r.__scopeTooltip);return Wt.jsx(y$,{present:n||a.open,children:a.disableHoverableContent?Wt.jsx(E$,{side:i,...s,ref:e}):Wt.jsx(CSe,{side:i,...s,ref:e})})}),CSe=H.forwardRef((r,e)=>{const t=WN(Lx,r.__scopeTooltip),n=TI(Lx,r.__scopeTooltip),i=H.useRef(null),s=Fy(e,i),[a,o]=H.useState(null),{trigger:l,onClose:c}=t,d=i.current,{onPointerInTransitChange:p}=n,y=H.useCallback(()=>{o(null),p(!1)},[p]),_=H.useCallback((v,b)=>{const E=v.currentTarget,T={x:v.clientX,y:v.clientY},M=USe(T,E.getBoundingClientRect()),R=LSe(T,M),N=PSe(b.getBoundingClientRect()),P=ISe([...R,...N]);o(P),p(!0)},[p]);return H.useEffect(()=>()=>y(),[y]),H.useEffect(()=>{if(l&&d){const v=E=>_(E,d),b=E=>_(E,l);return l.addEventListener("pointerleave",v),d.addEventListener("pointerleave",b),()=>{l.removeEventListener("pointerleave",v),d.removeEventListener("pointerleave",b)}}},[l,d,_,y]),H.useEffect(()=>{if(a){const v=b=>{const E=b.target,T={x:b.clientX,y:b.clientY},M=l?.contains(E)||d?.contains(E),R=!BSe(T,a);M?y():R&&(y(),c())};return document.addEventListener("pointermove",v),()=>document.removeEventListener("pointermove",v)}},[l,d,a,c,y]),Wt.jsx(E$,{...r,ref:s})}),[NSe,DSe]=kN(U1,{isInside:!1}),OSe=eSe("TooltipContent"),E$=H.forwardRef((r,e)=>{const{__scopeTooltip:t,children:n,"aria-label":i,onEscapeKeyDown:s,onPointerDownOutside:a,...o}=r,l=WN(Lx,t),c=HN(t),{onClose:d}=l;return H.useEffect(()=>(document.addEventListener(NU,d),()=>document.removeEventListener(NU,d)),[d]),H.useEffect(()=>{if(l.trigger){const p=y=>{y.target?.contains(l.trigger)&&d()};return window.addEventListener("scroll",p,{capture:!0}),()=>window.removeEventListener("scroll",p,{capture:!0})}},[l.trigger,d]),Wt.jsx(qX,{asChild:!0,disableOutsidePointerEvents:!1,onEscapeKeyDown:s,onPointerDownOutside:a,onFocusOutside:p=>p.preventDefault(),onDismiss:d,children:Wt.jsxs(Zbe,{"data-state":l.stateAttribute,...c,...o,ref:e,style:{...o.style,"--radix-tooltip-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-tooltip-content-available-width":"var(--radix-popper-available-width)","--radix-tooltip-content-available-height":"var(--radix-popper-available-height)","--radix-tooltip-trigger-width":"var(--radix-popper-anchor-width)","--radix-tooltip-trigger-height":"var(--radix-popper-anchor-height)"},children:[Wt.jsx(OSe,{children:n}),Wt.jsx(NSe,{scope:t,isInside:!0,children:Wt.jsx(TSe,{id:l.contentId,role:"tooltip",children:i||n})})]})})});T$.displayName=Lx;var M$="TooltipArrow",A$=H.forwardRef((r,e)=>{const{__scopeTooltip:t,...n}=r,i=HN(t);return DSe(M$,t).isInside?null:Wt.jsx(Kbe,{...i,...n,ref:e})});A$.displayName=M$;function USe(r,e){const t=Math.abs(e.top-r.y),n=Math.abs(e.bottom-r.y),i=Math.abs(e.right-r.x),s=Math.abs(e.left-r.x);switch(Math.min(t,n,i,s)){case s:return"left";case i:return"right";case t:return"top";case n:return"bottom";default:throw new Error("unreachable")}}function LSe(r,e,t=5){const n=[];switch(e){case"top":n.push({x:r.x-t,y:r.y+t},{x:r.x+t,y:r.y+t});break;case"bottom":n.push({x:r.x-t,y:r.y-t},{x:r.x+t,y:r.y-t});break;case"left":n.push({x:r.x+t,y:r.y-t},{x:r.x+t,y:r.y+t});break;case"right":n.push({x:r.x-t,y:r.y-t},{x:r.x-t,y:r.y+t});break}return n}function PSe(r){const{top:e,right:t,bottom:n,left:i}=r;return[{x:i,y:e},{x:t,y:e},{x:t,y:n},{x:i,y:n}]}function BSe(r,e){const{x:t,y:n}=r;let i=!1;for(let s=0,a=e.length-1;s<e.length;a=s++){const o=e[s],l=e[a],c=o.x,d=o.y,p=l.x,y=l.y;d>n!=y>n&&t<(p-c)*(n-d)/(y-d)+c&&(i=!i)}return i}function ISe(r){const e=r.slice();return e.sort((t,n)=>t.x<n.x?-1:t.x>n.x?1:t.y<n.y?-1:t.y>n.y?1:0),FSe(e)}function FSe(r){if(r.length<=1)return r.slice();const e=[];for(let n=0;n<r.length;n++){const i=r[n];for(;e.length>=2;){const s=e[e.length-1],a=e[e.length-2];if((s.x-a.x)*(i.y-a.y)>=(s.y-a.y)*(i.x-a.x))e.pop();else break}e.push(i)}e.pop();const t=[];for(let n=r.length-1;n>=0;n--){const i=r[n];for(;t.length>=2;){const s=t[t.length-1],a=t[t.length-2];if((s.x-a.x)*(i.y-a.y)>=(s.y-a.y)*(i.x-a.x))t.pop();else break}t.push(i)}return t.pop(),e.length===1&&t.length===1&&e[0].x===t[0].x&&e[0].y===t[0].y?e:e.concat(t)}var zSe=x$,VSe=b$,GSe=S$,kSe=T$,HSe=A$;function WSe(r,e){if(r==null)return{};var t={};for(var n in r)if({}.hasOwnProperty.call(r,n)){if(e.indexOf(n)!==-1)continue;t[n]=r[n]}return t}function Tr(r,e){if(r==null)return{};var t,n,i=WSe(r,e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(r);for(n=0;n<s.length;n++)t=s[n],e.indexOf(t)===-1&&{}.propertyIsEnumerable.call(r,t)&&(i[t]=r[t])}return i}let zs=(function(r){return r[r.UNSUPPORTED_INPUT=0]="UNSUPPORTED_INPUT",r[r.NO_COMPONENT_FOR_TYPE=1]="NO_COMPONENT_FOR_TYPE",r[r.UNKNOWN_INPUT=2]="UNKNOWN_INPUT",r[r.DUPLICATE_KEYS=3]="DUPLICATE_KEYS",r[r.ALREADY_REGISTERED_TYPE=4]="ALREADY_REGISTERED_TYPE",r[r.CLIPBOARD_ERROR=5]="CLIPBOARD_ERROR",r[r.THEME_ERROR=6]="THEME_ERROR",r[r.PATH_DOESNT_EXIST=7]="PATH_DOESNT_EXIST",r[r.INPUT_TYPE_OVERRIDE=8]="INPUT_TYPE_OVERRIDE",r[r.EMPTY_KEY=9]="EMPTY_KEY",r})({});const qSe={[zs.UNSUPPORTED_INPUT]:(r,e)=>[`An input with type \`${r}\` input was found at path \`${e}\` but it's not supported yet.`],[zs.NO_COMPONENT_FOR_TYPE]:(r,e)=>[`Type \`${r}\` found at path \`${e}\` can't be displayed in panel because no component supports it yet.`],[zs.UNKNOWN_INPUT]:(r,e)=>[`input at path \`${r}\` is not recognized.`,e],[zs.DUPLICATE_KEYS]:(r,e,t)=>[`Key \`${r}\` of path \`${e}\` already exists at path \`${t}\`. Even nested keys need to be unique. Rename one of the keys.`],[zs.ALREADY_REGISTERED_TYPE]:r=>[`Type ${r} has already been registered. You can't register a component with the same type.`],[zs.CLIPBOARD_ERROR]:r=>["Error copying the value",r],[zs.THEME_ERROR]:(r,e)=>[`Error accessing the theme \`${r}.${e}\` value.`],[zs.PATH_DOESNT_EXIST]:r=>[`Error getting the value at path \`${r}\`. There is probably an error in your \`render\` function.`],[zs.INPUT_TYPE_OVERRIDE]:(r,e,t)=>[`Input at path \`${r}\` already exists with type: \`${e}\`. Its type cannot be overridden with type \`${t}\`.`],[zs.EMPTY_KEY]:()=>["Keys can not be empty, if you want to hide a label use whitespace."]};function w$(r,e,...t){const n=qSe[e],[i,...s]=n(...t);console[r]("LEVA: "+i,...s)}const mh=w$.bind(null,"warn"),XSe=w$.bind(null,"log"),$Se=["value"],jSe=["schema"],YSe=["value"],R$=[],Ty={};function b5(r){let{value:e}=r,t=Tr(r,$Se);for(let n of R$){const i=n(e,t);if(i)return i}}function Zh(r,e){let{schema:t}=e,n=Tr(e,jSe);if(r in Ty){mh(zs.ALREADY_REGISTERED_TYPE,r);return}R$.push((i,s)=>t(i,s)&&r),Ty[r]=n}function FD(r,e,t,n){const{normalize:i}=Ty[r];if(i)return i(e,t,n);if(typeof e!="object"||!("value"in e))return{value:e};const{value:s}=e,a=Tr(e,YSe);return{value:s,settings:a}}function ZSe(r,e,t,n,i,s){const{sanitize:a}=Ty[r];return a?a(e,t,n,i,s):e}function S5(r,e,t){const{format:n}=Ty[r];return n?n(e,t):e}function KSe(r,e){if(typeof r!="object"||!r)return r;var t=r[Symbol.toPrimitive];if(t!==void 0){var n=t.call(r,e);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(r)}function QSe(r){var e=KSe(r,"string");return typeof e=="symbol"?e:e+""}function JSe(r,e,t){return(e=QSe(e))in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function T5(r,e){var t=Object.keys(r);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(r);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(r,i).enumerable})),t.push.apply(t,n)}return t}function Wn(r){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?T5(Object(t),!0).forEach(function(n){JSe(r,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(t)):T5(Object(t)).forEach(function(n){Object.defineProperty(r,n,Object.getOwnPropertyDescriptor(t,n))})}return r}const Um=(r,e,t)=>r>t?t:r<e?e:r,eTe=r=>{if(r===""||typeof r=="number")return r;try{const e=Ov(r);if(!isNaN(e))return e}catch{}return parseFloat(r)},tTe=Math.log(10);function E5(r){let e=Math.abs(+String(r).replace(".",""));if(e===0)return .01;for(;e!==0&&e%10===0;)e/=10;const t=Math.floor(Math.log(e)/tTe)+1,n=Math.floor(Math.log10(Math.abs(r))),i=Math.pow(10,n-t);return Math.max(i,.001)}const qR=(r,e,t)=>t===e?0:(Um(r,e,t)-e)/(t-e),XR=(r,e,t)=>r*(t-e)+e,nTe=()=>"_"+Math.random().toString(36).substr(2,9),M5=/\(([^\(\)]+)\)/,A5=/(-?\d+(?:\.\d+)?)\s*\^\s*(-?\d+(?:\.\d+)?)/,w5=/(-?\d+(?:\.\d+)?)\s*([*/])\s*(-?\d+(?:\.\d+)?)/,R5=/(-?\d+(?:\.\d+)?)\s*([+-])\s*(-?\d+(?:\.\d+)?)/;function Ov(r){return r=r.replace(/\s+/g,""),M5.test(r)?Ov(r.replace(M5,(e,t)=>Ov(t).toString())):A5.test(r)?Ov(r.replace(A5,(e,t,n)=>Math.pow(Number(t),Number(n)).toString())):w5.test(r)?Ov(r.replace(w5,(e,t,n,i)=>n==="*"?(Number(t)*Number(i)).toString():Number(i)===0?(()=>{throw new Error("Division by zero")})():(Number(t)/Number(i)).toString())):R5.test(r)?Ov(r.replace(R5,(e,t,n,i)=>n==="+"?(Number(t)+Number(i)).toString():(Number(t)-Number(i)).toString())):Number(r)}function iTe(r,e){return e.reduce((t,n)=>(r&&r.hasOwnProperty(n)&&(t[n]=r[n]),t),{})}function rTe(r,e){const t=Wn({},r);return e.forEach(n=>n in r&&delete t[n]),t}function sTe(r,e){return r.reduce((t,n,i)=>Object.assign(t,{[e[i]]:n}),{})}function C$(r){return Object.prototype.toString.call(r)==="[object Object]"}const aTe=r=>C$(r)&&Object.keys(r).length===0;let pd=(function(r){return r.BUTTON="BUTTON",r.BUTTON_GROUP="BUTTON_GROUP",r.MONITOR="MONITOR",r.FOLDER="FOLDER",r})({}),Kh=(function(r){return r.SELECT="SELECT",r.IMAGE="IMAGE",r.NUMBER="NUMBER",r.COLOR="COLOR",r.STRING="STRING",r.BOOLEAN="BOOLEAN",r.INTERVAL="INTERVAL",r.VECTOR3D="VECTOR3D",r.VECTOR2D="VECTOR2D",r})({});const oTe=["type","__customInput"],lTe=["render","label","optional","order","disabled","hint","onChange","onEditStart","onEditEnd","transient"],uTe=["type"];function N$(r,e,t={},n){var i,s;if(typeof r!="object"||Array.isArray(r))return{type:n,input:r,options:Wn({key:e,label:e,optional:!1,disabled:!1,order:0},t)};if("__customInput"in r){const{type:P,__customInput:U}=r,L=Tr(r,oTe);return N$(U,e,L,P)}const{render:a,label:o,optional:l,order:c=0,disabled:d,hint:p,onChange:y,onEditStart:_,onEditEnd:v,transient:b}=r,E=Tr(r,lTe),T=Wn({render:a,key:e,label:o??e,hint:p,transient:b??!!y,onEditStart:_,onEditEnd:v,disabled:d,optional:l,order:c},t);let{type:M}=E,R=Tr(E,uTe);if(M=n??M,M in pd)return{type:M,input:R,options:T};let N;return n&&C$(R)&&"value"in R?N=R.value:N=aTe(R)?void 0:R,{type:M,input:N,options:Wn(Wn({},T),{},{onChange:y,optional:(i=T.optional)!==null&&i!==void 0?i:!1,disabled:(s=T.disabled)!==null&&s!==void 0?s:!1})}}function cTe(r,e,t,n){const i=N$(r,e),{type:s,input:a,options:o}=i;if(s)return s in pd?i:{type:s,input:FD(s,a,t,n),options:o};let l=b5(a);return l?{type:l,input:FD(l,a,t,n),options:o}:(l=b5({value:a}),l?{type:l,input:FD(l,{value:a},t,n),options:o}:!1)}function C5(r,e,t,n,i){const{value:s,type:a,settings:o}=r;r.value=D$({type:a,value:s,settings:o},e,t,n),r.fromPanel=i}const fTe=function(e,t,n){this.type="LEVA_ERROR",this.message="LEVA: "+e,this.previousValue=t,this.error=n};function D$({type:r,value:e,settings:t},n,i,s){const a=r!=="SELECT"&&typeof n=="function"?n(e):n;let o;try{o=ZSe(r,a,t,e,i,s)}catch(l){throw new fTe(`The value \`${n}\` did not result in a correct value.`,e,l)}return C1(o,e)?e:o}const O$=(r,e,t=!1)=>{let n=0;return function(){const i=arguments,s=t&&!n,a=()=>r.apply(this,i);window.clearTimeout(n),n=window.setTimeout(a,e),s&&a()}},U$=r=>r.shiftKey?5:r.altKey?1/5:1,dTe=["value"],hTe=["min","max"],pTe=r=>{if(typeof r=="number")return!0;if(typeof r=="string"){const e=parseFloat(r);return isNaN(e)?!1:r.substring((""+e).length).trim().length<4}return!1},L$=(r,{min:e=-1/0,max:t=1/0,suffix:n})=>{const i=parseFloat(r);if(r===""||isNaN(i))throw Error("Invalid number");const s=Um(i,e,t);return n?s+n:s},mTe=(r,{pad:e=0,suffix:t})=>{const n=parseFloat(r).toFixed(e);return t?n+t:n},P$=r=>{let{value:e}=r,t=Tr(r,dTe);const{min:n=-1/0,max:i=1/0}=t,s=Tr(t,hTe);let a=parseFloat(e);const o=typeof e=="string"?e.substring((""+a).length):void 0;a=Um(a,n,i);let l=t.step;l||(Number.isFinite(n)?Number.isFinite(i)?l=+(Math.abs(i-n)/100).toPrecision(1):l=+(Math.abs(a-n)/100).toPrecision(1):Number.isFinite(i)&&(l=+(Math.abs(i-a)/100).toPrecision(1)));const c=l?E5(l)*10:E5(a);l=l||c/10;const d=Math.round(Um(Math.log10(1/c),0,2));return{value:o?a+o:a,settings:Wn({initialValue:a,step:l,pad:d,min:n,max:i,suffix:o},s)}},B$=(r,{step:e,initialValue:t})=>{const n=Math.round((r-t)/e);return t+n*e};var I$=Object.freeze({__proto__:null,schema:pTe,sanitize:L$,format:mTe,normalize:P$,sanitizeStep:B$});function Ss(){return Ss=Object.assign?Object.assign.bind():function(r){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var n in t)({}).hasOwnProperty.call(t,n)&&(r[n]=t[n])}return r},Ss.apply(null,arguments)}const F$=H.createContext({});function So(){return H.useContext(F$)}const EI=H.createContext(null),z$=H.createContext(null),V$=H.createContext(null);function mE(){return H.useContext(z$)}function gTe(){return H.useContext(V$)}const G$=()=>({colors:{elevation1:"#292d39",elevation2:"#181c20",elevation3:"#373c4b",accent1:"#0066dc",accent2:"#007bff",accent3:"#3c93ff",highlight1:"#535760",highlight2:"#8c92a4",highlight3:"#fefefe",vivid1:"#ffcc00",folderWidgetColor:"$highlight2",folderTextColor:"$highlight3",toolTipBackground:"$highlight3",toolTipText:"$elevation2"},radii:{xs:"2px",sm:"3px",lg:"10px"},space:{xs:"3px",sm:"6px",md:"10px",rowGap:"7px",colGap:"7px"},fonts:{mono:"ui-monospace, SFMono-Regular, Menlo, 'Roboto Mono', monospace",sans:"system-ui, sans-serif"},fontSizes:{root:"11px",toolTip:"$root"},sizes:{rootWidth:"280px",controlWidth:"160px",numberInputMinWidth:"38px",scrubberWidth:"8px",scrubberHeight:"16px",rowHeight:"24px",folderTitleHeight:"20px",checkboxSize:"16px",joystickWidth:"100px",joystickHeight:"100px",colorPickerWidth:"$controlWidth",colorPickerHeight:"100px",imagePreviewWidth:"$controlWidth",imagePreviewHeight:"100px",monitorHeight:"60px",titleBarHeight:"39px"},shadows:{level1:"0 0 9px 0 #00000088",level2:"0 4px 14px #00000033"},borderWidths:{root:"0px",input:"1px",focus:"1px",hover:"1px",active:"1px",folder:"1px"},fontWeights:{label:"normal",folder:"normal",button:"normal"}});function vw(r,e){const[t,n]=r.split(" "),i={};return t!=="none"&&(i.boxShadow=`${e.inset?"inset ":""}0 0 0 $borderWidths${[e.key]} $colors${t!=="default"&&t||e.borderColor}`),n&&(i.backgroundColor=n),i}const uT={$inputStyle:()=>r=>vw(r,{key:"$input",borderColor:"$highlight1",inset:!0}),$focusStyle:()=>r=>vw(r,{key:"$focus",borderColor:"$accent2"}),$hoverStyle:()=>r=>vw(r,{key:"$hover",borderColor:"$accent1",inset:!0}),$activeStyle:()=>r=>vw(r,{key:"$active",borderColor:"$accent1",inset:!0})},gE=$ve({prefix:"leva",theme:G$(),utils:Wn(Wn({},uT),{},{$flex:()=>({display:"flex",alignItems:"center"}),$flexCenter:()=>({display:"flex",alignItems:"center",justifyContent:"center"}),$reset:()=>({outline:"none",fontSize:"inherit",fontWeight:"inherit",color:"inherit",fontFamily:"inherit",border:"none",backgroundColor:"transparent",appearance:"none"}),$draggable:()=>({touchAction:"none",WebkitUserDrag:"none",userSelect:"none"}),$focus:r=>({"&:focus":uT.$focusStyle()(r)}),$focusWithin:r=>({"&:focus-within":uT.$focusStyle()(r)}),$hover:r=>({"&:hover":uT.$hoverStyle()(r)}),$active:r=>({"&:active":uT.$activeStyle()(r)})})}),kn=gE.styled;gE.css;const yTe=gE.createTheme,_Te=gE.globalCss;gE.keyframes;const vTe=_Te({".leva__panel__dragged":{WebkitUserDrag:"none",userSelect:"none",input:{userSelect:"none"},"*":{cursor:"ew-resize !important"}}});function xTe(r){const e=G$();if(!r)return{theme:e,className:""};Object.keys(r).forEach(n=>{Object.assign(e[n],r[n])});const t=yTe(e);return{theme:e,className:t.className}}function Dh(r,e){const{theme:t}=H.useContext(EI);if(!(r in t)||!(e in t[r]))return mh(zs.THEME_ERROR,r,e),"";let n=e;for(;;){let i=t[r][n];if(typeof i=="string"&&i.charAt(0)==="$")n=i.substr(1);else return i}}const k$=kn("input",{$reset:"",padding:"0 $sm",width:0,minWidth:0,flex:1,height:"100%",variants:{levaType:{number:{textAlign:"right"}},as:{textarea:{padding:"$sm"}}}}),H$=kn("div",{$draggable:"",height:"100%",$flexCenter:"",position:"relative",padding:"0 $xs",fontSize:"0.8em",opacity:.8,cursor:"default",touchAction:"none",[`& + ${k$}`]:{paddingLeft:0}}),bTe=kn(H$,{cursor:"ew-resize",marginRight:"-$xs",textTransform:"uppercase",opacity:.3,"&:hover":{opacity:1},variants:{dragging:{true:{backgroundColor:"$accent2",opacity:1}}}}),STe=kn("div",{$flex:"",position:"relative",borderRadius:"$sm",overflow:"hidden",color:"inherit",height:"$rowHeight",backgroundColor:"$elevation3",$inputStyle:"$elevation1",$hover:"",$focusWithin:"",variants:{textArea:{true:{height:"auto"}}}}),TTe=["innerLabel","value","onUpdate","onChange","onKeyDown","type","id","inputType","rows"],ETe=["onUpdate"];function MI(r){let{innerLabel:e,value:t,onUpdate:n,onChange:i,onKeyDown:s,type:a,id:o,inputType:l="text",rows:c=0}=r,d=Tr(r,TTe);const{id:p,emitOnEditStart:y,emitOnEditEnd:_,disabled:v}=So(),b=o||p,E=H.useRef(null),T=c>0,M=T?"textarea":"input",R=H.useCallback(U=>L=>{const F=L.currentTarget.value;U(F)},[]);ve.useEffect(()=>{const U=E.current,L=R(F=>{n(F),_()});return U?.addEventListener("blur",L),()=>U?.removeEventListener("blur",L)},[R,n,_]);const N=H.useCallback(U=>{U.key==="Enter"&&R(n)(U)},[R,n]),P=Object.assign({as:M},T?{rows:c}:{},d);return ve.createElement(STe,{textArea:T},e&&typeof e=="string"?ve.createElement(H$,null,e):e,ve.createElement(k$,Ss({levaType:a,ref:E,id:b,type:l,autoComplete:"off",spellCheck:"false",value:t,onChange:R(i),onFocus:()=>y(),onKeyPress:N,onKeyDown:s,disabled:v},P)))}function MTe(r){let{onUpdate:e}=r,t=Tr(r,ETe);const n=H.useCallback(s=>e(eTe(s)),[e]),i=H.useCallback(s=>{const a=s.key==="ArrowUp"?1:s.key==="ArrowDown"?-1:0;if(a){s.preventDefault();const o=s.altKey?.1:s.shiftKey?10:1;e(l=>parseFloat(l)+a*o)}},[e]);return ve.createElement(MI,Ss({},t,{onUpdate:n,onKeyDown:i,type:"number"}))}const $R=kn("div",{}),OU=kn("div",{position:"relative",background:"$elevation2",transition:"height 300ms ease",variants:{fill:{true:{},false:{}},flat:{false:{},true:{}},isRoot:{true:{},false:{paddingLeft:"$md","&::after":{content:'""',position:"absolute",left:0,top:0,width:"$borderWidths$folder",height:"100%",backgroundColor:"$folderWidgetColor",opacity:.4,transform:"translateX(-50%)"}}}},compoundVariants:[{isRoot:!0,fill:!1,css:{overflowY:"auto",maxHeight:"calc(100vh - 20px - $$titleBarHeight)"}},{isRoot:!0,flat:!1,css:{borderRadius:"$lg"}}]}),ATe=kn("div",{$flex:"",color:"$folderTextColor",userSelect:"none",cursor:"pointer",height:"$folderTitleHeight",fontWeight:"$folder","> svg":{marginLeft:-4,marginRight:4,cursor:"pointer",fill:"$folderWidgetColor",opacity:.6},"&:hover > svg":{fill:"$folderWidgetColor"},[`&:hover + ${OU}::after`]:{opacity:.6},[`${$R}:hover > & + ${OU}::after`]:{opacity:.6},[`${$R}:hover > & > svg`]:{opacity:1}}),W$=kn("div",{position:"relative",display:"grid",gridTemplateColumns:"100%",rowGap:"$rowGap",transition:"opacity 250ms ease",variants:{toggled:{true:{opacity:1,transitionDelay:"250ms"},false:{opacity:0,transitionDelay:"0ms",pointerEvents:"none"}},isRoot:{true:{"& > div":{paddingLeft:"$md",paddingRight:"$md"},"& > div:first-of-type":{paddingTop:"$sm"},"& > div:last-of-type":{paddingBottom:"$sm"},[`> ${$R}:not(:first-of-type)`]:{paddingTop:"$sm",marginTop:"$md",borderTop:"$borderWidths$folder solid $colors$elevation1"}}}}}),q$=kn("div",{position:"relative",zIndex:100,display:"grid",rowGap:"$rowGap",gridTemplateRows:"minmax($sizes$rowHeight, max-content)",alignItems:"center",color:"$highlight2",[`${W$} > &`]:{"&:first-of-type":{marginTop:"$rowGap"},"&:last-of-type":{marginBottom:"$rowGap"}},variants:{disabled:{true:{pointerEvents:"none"},false:{"&:hover,&:focus-within":{color:"$highlight3"}}}}}),X$=kn(q$,{gridTemplateColumns:"auto $sizes$controlWidth",columnGap:"$colGap"}),wTe=kn("div",{$flex:"",height:"100%",position:"relative",overflow:"hidden","& > div":{marginLeft:"$colGap",padding:"0 $xs",opacity:.4},"& > div:hover":{opacity:.8},"& > div > svg":{display:"none",cursor:"pointer",width:13,minWidth:13,height:13,backgroundColor:"$elevation2"},"&:hover > div > svg":{display:"block"},variants:{align:{top:{height:"100%",alignItems:"flex-start",paddingTop:"$sm"}}}}),RTe=kn("input",{$reset:"",height:0,width:0,opacity:0,margin:0,"& + label":{position:"relative",$flexCenter:"",height:"100%",userSelect:"none",cursor:"pointer",paddingLeft:2,paddingRight:"$sm",pointerEvents:"auto"},"& + label:after":{content:'""',width:6,height:6,backgroundColor:"$elevation3",borderRadius:"50%",$activeStyle:""},"&:focus + label:after":{$focusStyle:""},"& + label:active:after":{backgroundColor:"$accent1",$focusStyle:""},"&:checked + label:after":{backgroundColor:"$accent1"}}),UU=kn("label",{fontWeight:"$label",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap","& > svg":{display:"block"}}),CTe=kn("div",{opacity:1,variants:{disabled:{true:{opacity:.6,pointerEvents:"none",[`& ${UU}`]:{pointerEvents:"auto"}}}}}),$$=kn("div",{position:"fixed",top:0,bottom:0,right:0,left:0,zIndex:1e3,userSelect:"none"}),NTe=kn("div",{background:"$toolTipBackground",fontFamily:"$sans",fontSize:"$toolTip",padding:"$xs $sm",color:"$toolTipText",borderRadius:"$xs",boxShadow:"$level2",maxWidth:260}),DTe=kn(HSe,{fill:"$toolTipBackground"});function AI({children:r,container:e=(t=>globalThis==null||(t=globalThis.document)===null||t===void 0?void 0:t.body)()}){const{className:t}=H.useContext(EI);return ve.createElement(mve,{className:t,container:e},r)}const OTe=["align"];function UTe(){const{id:r,disable:e,disabled:t}=So();return ve.createElement(ve.Fragment,null,ve.createElement(RTe,{id:r+"__disable",type:"checkbox",checked:!t,onChange:()=>e(!t)}),ve.createElement("label",{htmlFor:r+"__disable"}))}function LTe(r){const{id:e,optional:t,hint:n}=So(),i=r.htmlFor||e||void 0,s=!n&&typeof r.children=="string"?r.children:void 0;return ve.createElement(ve.Fragment,null,t&&ve.createElement(UTe,null),n!==void 0?ve.createElement(VSe,null,ve.createElement(GSe,{asChild:!0},ve.createElement(UU,Ss({htmlFor:i},r))),ve.createElement(kSe,{side:"top",sideOffset:2},ve.createElement(NTe,null,n,ve.createElement(DTe,null)))):ve.createElement(UU,Ss({htmlFor:i,title:s},r)))}function of(r){let{align:e}=r,t=Tr(r,OTe);const{value:n,label:i,key:s,disabled:a}=So(),{hideCopyButton:o}=gTe(),l=!o&&s!==void 0,[c,d]=H.useState(!1),p=async()=>{try{await navigator.clipboard.writeText(JSON.stringify({[s]:n??""})),d(!0)}catch{mh(zs.CLIPBOARD_ERROR,{[s]:n})}};return ve.createElement(wTe,{align:e,onPointerLeave:()=>d(!1)},ve.createElement(LTe,t),l&&!a&&ve.createElement("div",{title:`Click to copy ${typeof i=="string"?i:s} value`},c?ve.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor"},ve.createElement("path",{d:"M9 2a1 1 0 000 2h2a1 1 0 100-2H9z"}),ve.createElement("path",{fillRule:"evenodd",d:"M4 5a2 2 0 012-2 3 3 0 003 3h2a3 3 0 003-3 2 2 0 012 2v11a2 2 0 01-2 2H6a2 2 0 01-2-2V5zm9.707 5.707a1 1 0 00-1.414-1.414L9 12.586l-1.293-1.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z",clipRule:"evenodd"})):ve.createElement("svg",{onClick:p,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor"},ve.createElement("path",{d:"M8 3a1 1 0 011-1h2a1 1 0 110 2H9a1 1 0 01-1-1z"}),ve.createElement("path",{d:"M6 3a2 2 0 00-2 2v11a2 2 0 002 2h8a2 2 0 002-2V5a2 2 0 00-2-2 3 3 0 01-3 3H9a3 3 0 01-3-3z"}))))}const PTe=["toggled"],BTe=kn("svg",{fill:"currentColor",transition:"transform 350ms ease, fill 250ms ease"});function wI(r){let{toggled:e}=r,t=Tr(r,PTe);return ve.createElement(BTe,Ss({width:"9",height:"5",viewBox:"0 0 9 5",xmlns:"http://www.w3.org/2000/svg",style:{transform:`rotate(${e?0:-90}deg)`}},t),ve.createElement("path",{d:"M3.8 4.4c.4.3 1 .3 1.4 0L8 1.7A1 1 0 007.4 0H1.6a1 1 0 00-.7 1.7l3 2.7z"}))}const ITe=["input"];function pc(r){let{input:e}=r,t=Tr(r,ITe);return e?ve.createElement(X$,t):ve.createElement(q$,t)}function j$({value:r,type:e,settings:t,setValue:n}){const[i,s]=H.useState(S5(e,r,t)),a=H.useRef(r),o=H.useRef(t);o.current=t;const l=H.useCallback(d=>s(S5(e,d,o.current)),[e]),c=H.useCallback(d=>{try{n(d)}catch(p){const{type:y,previousValue:_}=p;if(y!=="LEVA_ERROR")throw p;l(_)}},[l,n]);return H.useEffect(()=>{C1(r,a.current)||l(r),a.current=r},[r,l]),{displayValue:i,onChange:s,onUpdate:c}}function yE(r,e){const{emitOnEditStart:t,emitOnEditEnd:n}=So();return Loe(i=>{i.first&&(document.body.classList.add("leva__panel__dragged"),t?.());const s=r(i);return i.last&&(document.body.classList.remove("leva__panel__dragged"),n?.()),s},e)}function FTe(r){const e=H.useRef(null),t=H.useRef(null),n=H.useRef(!1);return H.useEffect(()=>{const i=O$(()=>{e.current.width=e.current.offsetWidth*window.devicePixelRatio,e.current.height=e.current.offsetHeight*window.devicePixelRatio,r(e.current,t.current)},250);return window.addEventListener("resize",i),n.current||(i(),n.current=!0),()=>window.removeEventListener("resize",i)},[r]),H.useEffect(()=>{t.current=e.current.getContext("2d")},[]),[e,t]}function Y$(){const r=H.useRef(null),e=H.useRef({x:0,y:0}),t=H.useCallback(n=>{Object.assign(e.current,n),r.current&&(r.current.style.transform=`translate3d(${e.current.x}px, ${e.current.y}px, 0)`)},[]);return[r,t]}const zTe=["__refCount"],zD=(r,e)=>{if(!r[e])return null;const t=r[e];return Tr(t,zTe)};function VTe(r){const e=mE(),[t,n]=H.useState(zD(e.getData(),r)),i=H.useCallback(c=>e.setValueAtPath(r,c,!0),[r,e]),s=H.useCallback(c=>e.setSettingsAtPath(r,c),[r,e]),a=H.useCallback(c=>e.disableInputAtPath(r,c),[r,e]),o=H.useCallback(()=>e.emitOnEditStart(r),[r,e]),l=H.useCallback(()=>e.emitOnEditEnd(r),[r,e]);return H.useEffect(()=>{n(zD(e.getData(),r));const c=e.useStore.subscribe(d=>zD(d.data,r),n,{equalityFn:PN});return()=>c()},[e,r]),[t,{set:i,setSettings:s,disable:a,storeId:e.storeId,emitOnEditStart:o,emitOnEditEnd:l}]}const GTe=kn("div",{variants:{hasRange:{true:{position:"relative",display:"grid",gridTemplateColumns:"auto $sizes$numberInputMinWidth",columnGap:"$colGap",alignItems:"center"}}}}),Z$=kn("div",{position:"relative",width:"100%",height:2,borderRadius:"$xs",backgroundColor:"$elevation1"}),LU=kn("div",{position:"absolute",width:"$scrubberWidth",height:"$scrubberHeight",borderRadius:"$xs",boxShadow:"0 0 0 2px $colors$elevation2",backgroundColor:"$accent2",cursor:"pointer",$active:"none $accent1",$hover:"none $accent3",variants:{position:{left:{borderTopRightRadius:0,borderBottomRightRadius:0,transform:"translateX(calc(-0.5 * ($sizes$scrubberWidth + 4px)))"},right:{borderTopLeftRadius:0,borderBottomLeftRadius:0,transform:"translateX(calc(0.5 * ($sizes$scrubberWidth + 4px)))"}}}}),K$=kn("div",{position:"relative",$flex:"",height:"100%",cursor:"pointer",touchAction:"none"}),Q$=kn("div",{position:"absolute",height:"100%",backgroundColor:"$accent2"});function kTe({value:r,min:e,max:t,onDrag:n,step:i,initialValue:s}){const a=H.useRef(null),o=H.useRef(null),l=H.useRef(0),c=Dh("sizes","scrubberWidth"),d=yE(({event:y,first:_,xy:[v],movement:[b],memo:E})=>{if(_){const{width:M,left:R}=a.current.getBoundingClientRect();l.current=M-parseFloat(c),E=y?.target===o.current?r:XR((v-R)/M,e,t)}const T=E+XR(b/l.current,0,t-e);return n(B$(T,{step:i,initialValue:s})),E}),p=qR(r,e,t);return ve.createElement(K$,Ss({ref:a},d()),ve.createElement(Z$,null,ve.createElement(Q$,{style:{left:0,right:`${(1-p)*100}%`}})),ve.createElement(LU,{ref:o,style:{left:`calc(${p} * (100% - ${c}))`}}))}const HTe=ve.memo(({label:r,onUpdate:e,step:t,innerLabelTrim:n})=>{const[i,s]=H.useState(!1),a=yE(({active:o,delta:[l],event:c,memo:d=0,first:p,last:y,target:_})=>(p&&_.requestPointerLock(),y&&document.exitPointerLock(),s(o),d+=l/2,Math.abs(d)>=1&&(e(v=>parseFloat(v)+Math.floor(d)*t*U$(c)),d=0),d));return ve.createElement(bTe,Ss({dragging:i,title:r.length>1?r:""},a()),r.slice(0,n))});function J$({label:r,id:e,displayValue:t,onUpdate:n,onChange:i,settings:s,innerLabelTrim:a=1}){const o=a>0&&ve.createElement(HTe,{label:r,step:s.step,onUpdate:n,innerLabelTrim:a});return ve.createElement(MTe,{id:e,value:String(t),onUpdate:n,onChange:i,innerLabel:o})}function WTe(){const r=So(),{label:e,value:t,onUpdate:n,settings:i,id:s}=r,{min:a,max:o}=i,l=o!==1/0&&a!==-1/0;return ve.createElement(pc,{input:!0},ve.createElement(of,null,e),ve.createElement(GTe,{hasRange:l},l&&ve.createElement(kTe,Ss({value:parseFloat(t),onDrag:n},i)),ve.createElement(J$,Ss({},r,{id:s,label:"value",innerLabelTrim:l?0:1}))))}const{sanitizeStep:qTe}=I$,XTe=Tr(I$,["sanitizeStep"]);var $Te=Wn({component:WTe},XTe);const jTe=(r,e)=>Rl().schema({options:Rl().passesAnyOf(Rl().object(),Rl().array())}).test(e),YTe=(r,{values:e})=>{if(e.indexOf(r)<0)throw Error("Selected value doesn't match Select options");return r},ZTe=(r,{values:e})=>e.indexOf(r),KTe=r=>{let{value:e,options:t}=r,n,i;return Array.isArray(t)?(i=t,n=t.map(s=>String(s))):(i=Object.values(t),n=Object.keys(t)),"value"in r?i.includes(e)||(n.unshift(String(e)),i.unshift(e)):e=i[0],Object.values(t).includes(e)||(t[String(e)]=e),{value:e,settings:{keys:n,values:i}}};var QTe=Object.freeze({__proto__:null,schema:jTe,sanitize:YTe,format:ZTe,normalize:KTe});const JTe=kn("div",{$flexCenter:"",position:"relative","> svg":{pointerEvents:"none",position:"absolute",right:"$md"}}),PU=kn("select",{position:"absolute",top:0,left:0,width:"100%",height:"100%",opacity:0}),e1e=kn("div",{display:"flex",alignItems:"center",width:"100%",height:"$rowHeight",backgroundColor:"$elevation3",borderRadius:"$sm",padding:"0 $sm",cursor:"pointer",[`${PU}:focus + &`]:{$focusStyle:""},[`${PU}:hover + &`]:{$hoverStyle:""}});function t1e({displayValue:r,value:e,onUpdate:t,id:n,settings:i,disabled:s}){const{keys:a,values:o}=i,l=H.useRef();return e===o[r]&&(l.current=a[r]),ve.createElement(JTe,null,ve.createElement(PU,{id:n,value:r,onChange:c=>t(o[Number(c.currentTarget.value)]),disabled:s},a.map((c,d)=>ve.createElement("option",{key:c,value:d},c))),ve.createElement(e1e,null,l.current),ve.createElement(wI,{toggled:!0}))}function n1e(){const{label:r,value:e,displayValue:t,onUpdate:n,id:i,disabled:s,settings:a}=So();return ve.createElement(pc,{input:!0},ve.createElement(of,null,r),ve.createElement(t1e,{id:i,value:e,displayValue:t,onUpdate:n,settings:a,disabled:s}))}var i1e=Wn({component:n1e},QTe);const r1e=r=>Rl().string().test(r),s1e=r=>{if(typeof r!="string")throw Error("Invalid string");return r},a1e=({value:r,editable:e=!0,rows:t=!1})=>({value:r,settings:{editable:e,rows:typeof t=="number"?t:t?5:0}});var o1e=Object.freeze({__proto__:null,schema:r1e,sanitize:s1e,normalize:a1e});const l1e=["displayValue","onUpdate","onChange","editable"],u1e=kn("div",{whiteSpace:"pre-wrap"});function c1e(r){let{displayValue:e,onUpdate:t,onChange:n,editable:i=!0}=r,s=Tr(r,l1e);return i?ve.createElement(MI,Ss({value:e,onUpdate:t,onChange:n},s)):ve.createElement(u1e,null,e)}function f1e(){const{label:r,settings:e,displayValue:t,onUpdate:n,onChange:i}=So();return ve.createElement(pc,{input:!0},ve.createElement(of,null,r),ve.createElement(c1e,Ss({displayValue:t,onUpdate:n,onChange:i},e)))}var d1e=Wn({component:f1e},o1e);const h1e=r=>Rl().boolean().test(r),p1e=r=>{if(typeof r!="boolean")throw Error("Invalid boolean");return r};var m1e=Object.freeze({__proto__:null,schema:h1e,sanitize:p1e});const g1e=kn("div",{position:"relative",$flex:"",height:"$rowHeight",input:{$reset:"",height:0,width:0,opacity:0,margin:0},label:{position:"relative",$flexCenter:"",userSelect:"none",cursor:"pointer",height:"$checkboxSize",width:"$checkboxSize",backgroundColor:"$elevation3",borderRadius:"$sm",$hover:""},"input:focus + label":{$focusStyle:""},"input:focus:checked + label, input:checked + label:hover":{$hoverStyle:"$accent3"},"input + label:active":{backgroundColor:"$accent1"},"input:checked + label:active":{backgroundColor:"$accent1"},"label > svg":{display:"none",width:"90%",height:"90%",stroke:"$highlight3"},"input:checked + label":{backgroundColor:"$accent2"},"input:checked + label > svg":{display:"block"}});function y1e({value:r,onUpdate:e,id:t,disabled:n}){return ve.createElement(g1e,null,ve.createElement("input",{id:t,type:"checkbox",checked:r,onChange:i=>e(i.currentTarget.checked),disabled:n}),ve.createElement("label",{htmlFor:t},ve.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},ve.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"}))))}function _1e(){const{label:r,value:e,onUpdate:t,disabled:n,id:i}=So();return ve.createElement(pc,{input:!0},ve.createElement(of,null,r),ve.createElement(y1e,{value:e,onUpdate:t,id:i,disabled:n}))}var v1e=Wn({component:_1e},m1e);const x1e=["locked"];function b1e({value:r,id:e,valueKey:t,settings:n,onUpdate:i,innerLabelTrim:s}){const a=H.useRef(r[t]);a.current=r[t];const o=H.useCallback(c=>i({[t]:D$({type:"NUMBER",value:a.current,settings:n},c)}),[i,n,t]),l=j$({type:"NUMBER",value:r[t],settings:n,setValue:o});return ve.createElement(J$,{id:e,label:t,value:r[t],displayValue:l.displayValue,onUpdate:l.onUpdate,onChange:l.onChange,settings:n,innerLabelTrim:s})}const S1e=kn("div",{display:"grid",columnGap:"$colGap",gridAutoFlow:"column dense",alignItems:"center",variants:{withLock:{true:{gridTemplateColumns:"10px auto","> svg":{cursor:"pointer"}}}}});function T1e(r){let{locked:e}=r,t=Tr(r,x1e);return ve.createElement("svg",Ss({width:"10",height:"10",viewBox:"0 0 15 15",fill:"none",xmlns:"http://www.w3.org/2000/svg"},t),e?ve.createElement("path",{d:"M5 4.63601C5 3.76031 5.24219 3.1054 5.64323 2.67357C6.03934 2.24705 6.64582 1.9783 7.5014 1.9783C8.35745 1.9783 8.96306 2.24652 9.35823 2.67208C9.75838 3.10299 10 3.75708 10 4.63325V5.99999H5V4.63601ZM4 5.99999V4.63601C4 3.58148 4.29339 2.65754 4.91049 1.99307C5.53252 1.32329 6.42675 0.978302 7.5014 0.978302C8.57583 0.978302 9.46952 1.32233 10.091 1.99162C10.7076 2.65557 11 3.57896 11 4.63325V5.99999H12C12.5523 5.99999 13 6.44771 13 6.99999V13C13 13.5523 12.5523 14 12 14H3C2.44772 14 2 13.5523 2 13V6.99999C2 6.44771 2.44772 5.99999 3 5.99999H4ZM3 6.99999H12V13H3V6.99999Z",fill:"currentColor",fillRule:"evenodd",clipRule:"evenodd"}):ve.createElement("path",{d:"M9 3.63601C9 2.76044 9.24207 2.11211 9.64154 1.68623C10.0366 1.26502 10.6432 1 11.5014 1C12.4485 1 13.0839 1.30552 13.4722 1.80636C13.8031 2.23312 14 2.84313 14 3.63325H15C15 2.68242 14.7626 1.83856 14.2625 1.19361C13.6389 0.38943 12.6743 0 11.5014 0C10.4294 0 9.53523 0.337871 8.91218 1.0021C8.29351 1.66167 8 2.58135 8 3.63601V6H1C0.447715 6 0 6.44772 0 7V13C0 13.5523 0.447715 14 1 14H10C10.5523 14 11 13.5523 11 13V7C11 6.44772 10.5523 6 10 6H9V3.63601ZM1 7H10V13H1V7Z",fill:"currentColor",fillRule:"evenodd",clipRule:"evenodd"}))}function RI({value:r,onUpdate:e,settings:t,innerLabelTrim:n}){const{id:i,setSettings:s}=So(),{lock:a,locked:o}=t;return ve.createElement(S1e,{withLock:a},a&&ve.createElement(T1e,{locked:o,onClick:()=>s({locked:!o})}),Object.keys(r).map((l,c)=>ve.createElement(b1e,{id:c===0?i:`${i}.${l}`,key:l,valueKey:l,value:r,settings:t[l],onUpdate:e,innerLabelTrim:n})))}const ej=(r,e)=>{const t={};let n=0,i=1/0;Object.entries(r).forEach(([s,a])=>{t[s]=P$(Wn({value:a},e[s])).settings,n=Math.max(n,t[s].step),i=Math.min(i,t[s].pad)});for(let s in t){const{step:a,min:o,max:l}=e[s]||{};!isFinite(a)&&(!isFinite(o)||!isFinite(l))&&(t[s].step=n,t[s].pad=i)}return t},E1e=["lock"],M1e=["value"];function A1e(r){const e=Rl().array().length(r).every.number(),t=n=>{if(!n||typeof n!="object")return!1;const i=Object.values(n);return i.length===r&&i.every(s=>isFinite(s))};return n=>e.test(n)||t(n)}function w1e(r){return Array.isArray(r)?"array":"object"}function QT(r,e,t){return w1e(r)===e?r:e==="array"?Object.values(r):sTe(r,t)}const R1e=(r,e,t)=>{const n=QT(r,"object",e.keys);for(let a in n)n[a]=L$(n[a],e[a]);const i=Object.keys(n);let s={};if(i.length===e.keys.length)s=n;else{const a=QT(t,"object",e.keys);if(i.length===1&&e.locked){const o=i[0],l=n[o],c=a[o],d=c!==0?l/c:1;for(let p in a)p===o?s[o]=l:s[p]=a[p]*d}else s=Wn(Wn({},a),n)}return QT(s,e.format,e.keys)},C1e=(r,e)=>QT(r,"object",e.keys),N1e=r=>!!r&&("step"in r||"min"in r||"max"in r);function D1e(r,e,t=[]){const{lock:n=!1}=e,i=Tr(e,E1e),s=Array.isArray(r)?"array":"object",a=s==="object"?Object.keys(r):t,o=QT(r,"object",a),l=N1e(i)?a.reduce((d,p)=>Object.assign(d,{[p]:i}),{}):i,c=ej(o,l);return{value:s==="array"?r:o,settings:Wn(Wn({},c),{},{format:s,keys:a,lock:n,locked:!1})}}function tj(r){return{schema:A1e(r.length),normalize:e=>{let{value:t}=e,n=Tr(e,M1e);return D1e(t,n,r)},format:(e,t)=>C1e(e,t),sanitize:(e,t,n)=>R1e(e,t,n)}}var O1e={grad:.9,turn:360,rad:360/(2*Math.PI)},oh=function(r){return typeof r=="string"?r.length>0:typeof r=="number"},va=function(r,e,t){return e===void 0&&(e=0),t===void 0&&(t=Math.pow(10,e)),Math.round(t*r)/t+0},nc=function(r,e,t){return e===void 0&&(e=0),t===void 0&&(t=1),r>t?t:r>e?r:e},nj=function(r){return(r=isFinite(r)?r%360:0)>0?r:r+360},N5=function(r){return{r:nc(r.r,0,255),g:nc(r.g,0,255),b:nc(r.b,0,255),a:nc(r.a)}},VD=function(r){return{r:va(r.r),g:va(r.g),b:va(r.b),a:va(r.a,3)}},U1e=/^#([0-9a-f]{3,8})$/i,xw=function(r){var e=r.toString(16);return e.length<2?"0"+e:e},ij=function(r){var e=r.r,t=r.g,n=r.b,i=r.a,s=Math.max(e,t,n),a=s-Math.min(e,t,n),o=a?s===e?(t-n)/a:s===t?2+(n-e)/a:4+(e-t)/a:0;return{h:60*(o<0?o+6:o),s:s?a/s*100:0,v:s/255*100,a:i}},rj=function(r){var e=r.h,t=r.s,n=r.v,i=r.a;e=e/360*6,t/=100,n/=100;var s=Math.floor(e),a=n*(1-t),o=n*(1-(e-s)*t),l=n*(1-(1-e+s)*t),c=s%6;return{r:255*[n,o,a,a,l,n][c],g:255*[l,n,n,o,a,a][c],b:255*[a,a,l,n,n,o][c],a:i}},D5=function(r){return{h:nj(r.h),s:nc(r.s,0,100),l:nc(r.l,0,100),a:nc(r.a)}},O5=function(r){return{h:va(r.h),s:va(r.s),l:va(r.l),a:va(r.a,3)}},U5=function(r){return rj((t=(e=r).s,{h:e.h,s:(t*=((n=e.l)<50?n:100-n)/100)>0?2*t/(n+t)*100:0,v:n+t,a:e.a}));var e,t,n},JT=function(r){return{h:(e=ij(r)).h,s:(i=(200-(t=e.s))*(n=e.v)/100)>0&&i<200?t*n/100/(i<=100?i:200-i)*100:0,l:i/2,a:e.a};var e,t,n,i},L1e=/^hsla?\(\s*([+-]?\d*\.?\d+)(deg|rad|grad|turn)?\s*,\s*([+-]?\d*\.?\d+)%\s*,\s*([+-]?\d*\.?\d+)%\s*(?:,\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,P1e=/^hsla?\(\s*([+-]?\d*\.?\d+)(deg|rad|grad|turn)?\s+([+-]?\d*\.?\d+)%\s+([+-]?\d*\.?\d+)%\s*(?:\/\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,B1e=/^rgba?\(\s*([+-]?\d*\.?\d+)(%)?\s*,\s*([+-]?\d*\.?\d+)(%)?\s*,\s*([+-]?\d*\.?\d+)(%)?\s*(?:,\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,I1e=/^rgba?\(\s*([+-]?\d*\.?\d+)(%)?\s+([+-]?\d*\.?\d+)(%)?\s+([+-]?\d*\.?\d+)(%)?\s*(?:\/\s*([+-]?\d*\.?\d+)(%)?\s*)?\)$/i,BU={string:[[function(r){var e=U1e.exec(r);return e?(r=e[1]).length<=4?{r:parseInt(r[0]+r[0],16),g:parseInt(r[1]+r[1],16),b:parseInt(r[2]+r[2],16),a:r.length===4?va(parseInt(r[3]+r[3],16)/255,2):1}:r.length===6||r.length===8?{r:parseInt(r.substr(0,2),16),g:parseInt(r.substr(2,2),16),b:parseInt(r.substr(4,2),16),a:r.length===8?va(parseInt(r.substr(6,2),16)/255,2):1}:null:null},"hex"],[function(r){var e=B1e.exec(r)||I1e.exec(r);return e?e[2]!==e[4]||e[4]!==e[6]?null:N5({r:Number(e[1])/(e[2]?100/255:1),g:Number(e[3])/(e[4]?100/255:1),b:Number(e[5])/(e[6]?100/255:1),a:e[7]===void 0?1:Number(e[7])/(e[8]?100:1)}):null},"rgb"],[function(r){var e=L1e.exec(r)||P1e.exec(r);if(!e)return null;var t,n,i=D5({h:(t=e[1],n=e[2],n===void 0&&(n="deg"),Number(t)*(O1e[n]||1)),s:Number(e[3]),l:Number(e[4]),a:e[5]===void 0?1:Number(e[5])/(e[6]?100:1)});return U5(i)},"hsl"]],object:[[function(r){var e=r.r,t=r.g,n=r.b,i=r.a,s=i===void 0?1:i;return oh(e)&&oh(t)&&oh(n)?N5({r:Number(e),g:Number(t),b:Number(n),a:Number(s)}):null},"rgb"],[function(r){var e=r.h,t=r.s,n=r.l,i=r.a,s=i===void 0?1:i;if(!oh(e)||!oh(t)||!oh(n))return null;var a=D5({h:Number(e),s:Number(t),l:Number(n),a:Number(s)});return U5(a)},"hsl"],[function(r){var e=r.h,t=r.s,n=r.v,i=r.a,s=i===void 0?1:i;if(!oh(e)||!oh(t)||!oh(n))return null;var a=(function(o){return{h:nj(o.h),s:nc(o.s,0,100),v:nc(o.v,0,100),a:nc(o.a)}})({h:Number(e),s:Number(t),v:Number(n),a:Number(s)});return rj(a)},"hsv"]]},L5=function(r,e){for(var t=0;t<e.length;t++){var n=e[t][0](r);if(n)return[n,e[t][1]]}return[null,void 0]},sj=function(r){return typeof r=="string"?L5(r.trim(),BU.string):typeof r=="object"&&r!==null?L5(r,BU.object):[null,void 0]},F1e=function(r){return sj(r)[1]},GD=function(r,e){var t=JT(r);return{h:t.h,s:nc(t.s+100*e,0,100),l:t.l,a:t.a}},kD=function(r){return(299*r.r+587*r.g+114*r.b)/1e3/255},P5=function(r,e){var t=JT(r);return{h:t.h,s:t.s,l:nc(t.l+100*e,0,100),a:t.a}},IU=(function(){function r(e){this.parsed=sj(e)[0],this.rgba=this.parsed||{r:0,g:0,b:0,a:1}}return r.prototype.isValid=function(){return this.parsed!==null},r.prototype.brightness=function(){return va(kD(this.rgba),2)},r.prototype.isDark=function(){return kD(this.rgba)<.5},r.prototype.isLight=function(){return kD(this.rgba)>=.5},r.prototype.toHex=function(){return e=VD(this.rgba),t=e.r,n=e.g,i=e.b,a=(s=e.a)<1?xw(va(255*s)):"","#"+xw(t)+xw(n)+xw(i)+a;var e,t,n,i,s,a},r.prototype.toRgb=function(){return VD(this.rgba)},r.prototype.toRgbString=function(){return e=VD(this.rgba),t=e.r,n=e.g,i=e.b,(s=e.a)<1?"rgba("+t+", "+n+", "+i+", "+s+")":"rgb("+t+", "+n+", "+i+")";var e,t,n,i,s},r.prototype.toHsl=function(){return O5(JT(this.rgba))},r.prototype.toHslString=function(){return e=O5(JT(this.rgba)),t=e.h,n=e.s,i=e.l,(s=e.a)<1?"hsla("+t+", "+n+"%, "+i+"%, "+s+")":"hsl("+t+", "+n+"%, "+i+"%)";var e,t,n,i,s},r.prototype.toHsv=function(){return e=ij(this.rgba),{h:va(e.h),s:va(e.s),v:va(e.v),a:va(e.a,3)};var e},r.prototype.invert=function(){return Zo({r:255-(e=this.rgba).r,g:255-e.g,b:255-e.b,a:e.a});var e},r.prototype.saturate=function(e){return e===void 0&&(e=.1),Zo(GD(this.rgba,e))},r.prototype.desaturate=function(e){return e===void 0&&(e=.1),Zo(GD(this.rgba,-e))},r.prototype.grayscale=function(){return Zo(GD(this.rgba,-1))},r.prototype.lighten=function(e){return e===void 0&&(e=.1),Zo(P5(this.rgba,e))},r.prototype.darken=function(e){return e===void 0&&(e=.1),Zo(P5(this.rgba,-e))},r.prototype.rotate=function(e){return e===void 0&&(e=15),this.hue(this.hue()+e)},r.prototype.alpha=function(e){return typeof e=="number"?Zo({r:(t=this.rgba).r,g:t.g,b:t.b,a:e}):va(this.rgba.a,3);var t},r.prototype.hue=function(e){var t=JT(this.rgba);return typeof e=="number"?Zo({h:e,s:t.s,l:t.l,a:t.a}):va(t.h)},r.prototype.isEqual=function(e){return this.toHex()===Zo(e).toHex()},r})(),Zo=function(r){return r instanceof IU?r:new IU(r)},B5=[],z1e=function(r){r.forEach(function(e){B5.indexOf(e)<0&&(e(IU,BU),B5.push(e))})};function V1e(r,e){var t={white:"#ffffff",bisque:"#ffe4c4",blue:"#0000ff",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",antiquewhite:"#faebd7",aqua:"#00ffff",azure:"#f0ffff",whitesmoke:"#f5f5f5",papayawhip:"#ffefd5",plum:"#dda0dd",blanchedalmond:"#ffebcd",black:"#000000",gold:"#ffd700",goldenrod:"#daa520",gainsboro:"#dcdcdc",cornsilk:"#fff8dc",cornflowerblue:"#6495ed",burlywood:"#deb887",aquamarine:"#7fffd4",beige:"#f5f5dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkkhaki:"#bdb76b",darkgray:"#a9a9a9",darkgreen:"#006400",darkgrey:"#a9a9a9",peachpuff:"#ffdab9",darkmagenta:"#8b008b",darkred:"#8b0000",darkorchid:"#9932cc",darkorange:"#ff8c00",darkslateblue:"#483d8b",gray:"#808080",darkslategray:"#2f4f4f",darkslategrey:"#2f4f4f",deeppink:"#ff1493",deepskyblue:"#00bfff",wheat:"#f5deb3",firebrick:"#b22222",floralwhite:"#fffaf0",ghostwhite:"#f8f8ff",darkviolet:"#9400d3",magenta:"#ff00ff",green:"#008000",dodgerblue:"#1e90ff",grey:"#808080",honeydew:"#f0fff0",hotpink:"#ff69b4",blueviolet:"#8a2be2",forestgreen:"#228b22",lawngreen:"#7cfc00",indianred:"#cd5c5c",indigo:"#4b0082",fuchsia:"#ff00ff",brown:"#a52a2a",maroon:"#800000",mediumblue:"#0000cd",lightcoral:"#f08080",darkturquoise:"#00ced1",lightcyan:"#e0ffff",ivory:"#fffff0",lightyellow:"#ffffe0",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",linen:"#faf0e6",mediumaquamarine:"#66cdaa",lemonchiffon:"#fffacd",lime:"#00ff00",khaki:"#f0e68c",mediumseagreen:"#3cb371",limegreen:"#32cd32",mediumspringgreen:"#00fa9a",lightskyblue:"#87cefa",lightblue:"#add8e6",midnightblue:"#191970",lightpink:"#ffb6c1",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",mintcream:"#f5fffa",lightslategray:"#778899",lightslategrey:"#778899",navajowhite:"#ffdead",navy:"#000080",mediumvioletred:"#c71585",powderblue:"#b0e0e6",palegoldenrod:"#eee8aa",oldlace:"#fdf5e6",paleturquoise:"#afeeee",mediumturquoise:"#48d1cc",mediumorchid:"#ba55d3",rebeccapurple:"#663399",lightsteelblue:"#b0c4de",mediumslateblue:"#7b68ee",thistle:"#d8bfd8",tan:"#d2b48c",orchid:"#da70d6",mediumpurple:"#9370db",purple:"#800080",pink:"#ffc0cb",skyblue:"#87ceeb",springgreen:"#00ff7f",palegreen:"#98fb98",red:"#ff0000",yellow:"#ffff00",slateblue:"#6a5acd",lavenderblush:"#fff0f5",peru:"#cd853f",palevioletred:"#db7093",violet:"#ee82ee",teal:"#008080",slategray:"#708090",slategrey:"#708090",aliceblue:"#f0f8ff",darkseagreen:"#8fbc8f",darkolivegreen:"#556b2f",greenyellow:"#adff2f",seagreen:"#2e8b57",seashell:"#fff5ee",tomato:"#ff6347",silver:"#c0c0c0",sienna:"#a0522d",lavender:"#e6e6fa",lightgreen:"#90ee90",orange:"#ffa500",orangered:"#ff4500",steelblue:"#4682b4",royalblue:"#4169e1",turquoise:"#40e0d0",yellowgreen:"#9acd32",salmon:"#fa8072",saddlebrown:"#8b4513",sandybrown:"#f4a460",rosybrown:"#bc8f8f",darksalmon:"#e9967a",lightgoldenrodyellow:"#fafad2",snow:"#fffafa",lightgrey:"#d3d3d3",lightgray:"#d3d3d3",dimgray:"#696969",dimgrey:"#696969",olivedrab:"#6b8e23",olive:"#808000"},n={};for(var i in t)n[t[i]]=i;var s={};r.prototype.toName=function(a){if(!(this.rgba.a||this.rgba.r||this.rgba.g||this.rgba.b))return"transparent";var o,l,c=n[this.toHex()];if(c)return c;if(a?.closest){var d=this.toRgb(),p=1/0,y="black";if(!s.length)for(var _ in t)s[_]=new r(t[_]).toRgb();for(var v in t){var b=(o=d,l=s[v],Math.pow(o.r-l.r,2)+Math.pow(o.g-l.g,2)+Math.pow(o.b-l.b,2));b<p&&(p=b,y=v)}return y}},e.string.push([function(a){var o=a.toLowerCase(),l=o==="transparent"?"#0000":t[o];return l?new r(l).toRgb():null},"name"])}function eb(){return(eb=Object.assign||function(r){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(r[n]=t[n])}return r}).apply(this,arguments)}function CI(r,e){if(r==null)return{};var t,n,i={},s=Object.keys(r);for(n=0;n<s.length;n++)e.indexOf(t=s[n])>=0||(i[t]=r[t]);return i}function FU(r){var e=H.useRef(r),t=H.useRef(function(n){e.current&&e.current(n)});return e.current=r,t.current}var Px=function(r,e,t){return e===void 0&&(e=0),t===void 0&&(t=1),r>t?t:r<e?e:r},e1=function(r){return"touches"in r},zU=function(r){return r&&r.ownerDocument.defaultView||self},I5=function(r,e,t){var n=r.getBoundingClientRect(),i=e1(e)?(function(s,a){for(var o=0;o<s.length;o++)if(s[o].identifier===a)return s[o];return s[0]})(e.touches,t):e;return{left:Px((i.pageX-(n.left+zU(r).pageXOffset))/n.width),top:Px((i.pageY-(n.top+zU(r).pageYOffset))/n.height)}},F5=function(r){!e1(r)&&r.preventDefault()},NI=ve.memo(function(r){var e=r.onMove,t=r.onKey,n=CI(r,["onMove","onKey"]),i=H.useRef(null),s=FU(e),a=FU(t),o=H.useRef(null),l=H.useRef(!1),c=H.useMemo(function(){var _=function(E){F5(E),(e1(E)?E.touches.length>0:E.buttons>0)&&i.current?s(I5(i.current,E,o.current)):b(!1)},v=function(){return b(!1)};function b(E){var T=l.current,M=zU(i.current),R=E?M.addEventListener:M.removeEventListener;R(T?"touchmove":"mousemove",_),R(T?"touchend":"mouseup",v)}return[function(E){var T=E.nativeEvent,M=i.current;if(M&&(F5(T),!(function(N,P){return P&&!e1(N)})(T,l.current)&&M)){if(e1(T)){l.current=!0;var R=T.changedTouches||[];R.length&&(o.current=R[0].identifier)}M.focus(),s(I5(M,T,o.current)),b(!0)}},function(E){var T=E.which||E.keyCode;T<37||T>40||(E.preventDefault(),a({left:T===39?.05:T===37?-.05:0,top:T===40?.05:T===38?-.05:0}))},b]},[a,s]),d=c[0],p=c[1],y=c[2];return H.useEffect(function(){return y},[y]),ve.createElement("div",eb({},n,{onTouchStart:d,onMouseDown:d,className:"react-colorful__interactive",ref:i,onKeyDown:p,tabIndex:0,role:"slider"}))}),_E=function(r){return r.filter(Boolean).join(" ")},DI=function(r){var e=r.color,t=r.left,n=r.top,i=n===void 0?.5:n,s=_E(["react-colorful__pointer",r.className]);return ve.createElement("div",{className:s,style:{top:100*i+"%",left:100*t+"%"}},ve.createElement("div",{className:"react-colorful__pointer-fill",style:{backgroundColor:e}}))},rl=function(r,e,t){return e===void 0&&(e=0),t===void 0&&(t=Math.pow(10,e)),Math.round(t*r)/t},aj=function(r){var e=r.s,t=r.v,n=r.a,i=(200-e)*t/100;return{h:rl(r.h),s:rl(i>0&&i<200?e*t/100/(i<=100?i:200-i)*100:0),l:rl(i/2),a:rl(n,2)}},VU=function(r){var e=aj(r);return"hsl("+e.h+", "+e.s+"%, "+e.l+"%)"},HD=function(r){var e=aj(r);return"hsla("+e.h+", "+e.s+"%, "+e.l+"%, "+e.a+")"},oj=function(r){var e=r.h,t=r.s,n=r.v,i=r.a;e=e/360*6,t/=100,n/=100;var s=Math.floor(e),a=n*(1-t),o=n*(1-(e-s)*t),l=n*(1-(1-e+s)*t),c=s%6;return{r:rl(255*[n,o,a,a,l,n][c]),g:rl(255*[l,n,n,o,a,a][c]),b:rl(255*[a,a,l,n,n,o][c]),a:rl(i,2)}},lj=function(r){var e=r.r,t=r.g,n=r.b,i=r.a,s=Math.max(e,t,n),a=s-Math.min(e,t,n),o=a?s===e?(t-n)/a:s===t?2+(n-e)/a:4+(e-t)/a:0;return{h:rl(60*(o<0?o+6:o)),s:rl(s?a/s*100:0),v:rl(s/255*100),a:i}},uj=ve.memo(function(r){var e=r.hue,t=r.onChange,n=_E(["react-colorful__hue",r.className]);return ve.createElement("div",{className:n},ve.createElement(NI,{onMove:function(i){t({h:360*i.left})},onKey:function(i){t({h:Px(e+360*i.left,0,360)})},"aria-label":"Hue","aria-valuenow":rl(e),"aria-valuemax":"360","aria-valuemin":"0"},ve.createElement(DI,{className:"react-colorful__hue-pointer",left:e/360,color:VU({h:e,s:100,v:100,a:1})})))}),cj=ve.memo(function(r){var e=r.hsva,t=r.onChange,n={backgroundColor:VU({h:e.h,s:100,v:100,a:1})};return ve.createElement("div",{className:"react-colorful__saturation",style:n},ve.createElement(NI,{onMove:function(i){t({s:100*i.left,v:100-100*i.top})},onKey:function(i){t({s:Px(e.s+100*i.left,0,100),v:Px(e.v-100*i.top,0,100)})},"aria-label":"Color","aria-valuetext":"Saturation "+rl(e.s)+"%, Brightness "+rl(e.v)+"%"},ve.createElement(DI,{className:"react-colorful__saturation-pointer",top:1-e.v/100,left:e.s/100,color:VU(e)})))}),OI=function(r,e){if(r===e)return!0;for(var t in r)if(r[t]!==e[t])return!1;return!0};function fj(r,e,t){var n=FU(t),i=H.useState(function(){return r.toHsva(e)}),s=i[0],a=i[1],o=H.useRef({color:e,hsva:s});H.useEffect(function(){if(!r.equal(e,o.current.color)){var c=r.toHsva(e);o.current={hsva:c,color:e},a(c)}},[e,r]),H.useEffect(function(){var c;OI(s,o.current.hsva)||r.equal(c=r.fromHsva(s),o.current.color)||(o.current={hsva:s,color:c},n(c))},[s,r,n]);var l=H.useCallback(function(c){a(function(d){return Object.assign({},d,c)})},[]);return[s,l]}var G1e=typeof window<"u"?H.useLayoutEffect:H.useEffect,k1e=function(){return typeof __webpack_nonce__<"u"?__webpack_nonce__:void 0},z5=new Map,dj=function(r){G1e(function(){var e=r.current?r.current.ownerDocument:document;if(e!==void 0&&!z5.has(e)){var t=e.createElement("style");t.innerHTML=`.react-colorful{position:relative;display:flex;flex-direction:column;width:200px;height:200px;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;cursor:default}.react-colorful__saturation{position:relative;flex-grow:1;border-color:transparent;border-bottom:12px solid #000;border-radius:8px 8px 0 0;background-image:linear-gradient(0deg,#000,transparent),linear-gradient(90deg,#fff,hsla(0,0%,100%,0))}.react-colorful__alpha-gradient,.react-colorful__pointer-fill{content:"";position:absolute;left:0;top:0;right:0;bottom:0;pointer-events:none;border-radius:inherit}.react-colorful__alpha-gradient,.react-colorful__saturation{box-shadow:inset 0 0 0 1px rgba(0,0,0,.05)}.react-colorful__alpha,.react-colorful__hue{position:relative;height:24px}.react-colorful__hue{background:linear-gradient(90deg,red 0,#ff0 17%,#0f0 33%,#0ff 50%,#00f 67%,#f0f 83%,red)}.react-colorful__last-control{border-radius:0 0 8px 8px}.react-colorful__interactive{position:absolute;left:0;top:0;right:0;bottom:0;border-radius:inherit;outline:none;touch-action:none}.react-colorful__pointer{position:absolute;z-index:1;box-sizing:border-box;width:28px;height:28px;transform:translate(-50%,-50%);background-color:#fff;border:2px solid #fff;border-radius:50%;box-shadow:0 2px 4px rgba(0,0,0,.2)}.react-colorful__interactive:focus .react-colorful__pointer{transform:translate(-50%,-50%) scale(1.1)}.react-colorful__alpha,.react-colorful__alpha-pointer{background-color:#fff;background-image:url('data:image/svg+xml;charset=utf-8,<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill-opacity=".05"><path d="M8 0h8v8H8zM0 8h8v8H0z"/></svg>')}.react-colorful__saturation-pointer{z-index:3}.react-colorful__hue-pointer{z-index:2}`,z5.set(e,t);var n=k1e();n&&t.setAttribute("nonce",n),e.head.appendChild(t)}},[])},H1e=function(r){var e=r.className,t=r.colorModel,n=r.color,i=n===void 0?t.defaultColor:n,s=r.onChange,a=CI(r,["className","colorModel","color","onChange"]),o=H.useRef(null);dj(o);var l=fj(t,i,s),c=l[0],d=l[1],p=_E(["react-colorful",e]);return ve.createElement("div",eb({},a,{ref:o,className:p}),ve.createElement(cj,{hsva:c,onChange:d}),ve.createElement(uj,{hue:c.h,onChange:d,className:"react-colorful__last-control"}))},W1e=function(r){var e=r.className,t=r.hsva,n=r.onChange,i={backgroundImage:"linear-gradient(90deg, "+HD(Object.assign({},t,{a:0}))+", "+HD(Object.assign({},t,{a:1}))+")"},s=_E(["react-colorful__alpha",e]),a=rl(100*t.a);return ve.createElement("div",{className:s},ve.createElement("div",{className:"react-colorful__alpha-gradient",style:i}),ve.createElement(NI,{onMove:function(o){n({a:o.left})},onKey:function(o){n({a:Px(t.a+o.left)})},"aria-label":"Alpha","aria-valuetext":a+"%","aria-valuenow":a,"aria-valuemin":"0","aria-valuemax":"100"},ve.createElement(DI,{className:"react-colorful__alpha-pointer",left:t.a,color:HD(t)})))},q1e=function(r){var e=r.className,t=r.colorModel,n=r.color,i=n===void 0?t.defaultColor:n,s=r.onChange,a=CI(r,["className","colorModel","color","onChange"]),o=H.useRef(null);dj(o);var l=fj(t,i,s),c=l[0],d=l[1],p=_E(["react-colorful",e]);return ve.createElement("div",eb({},a,{ref:o,className:p}),ve.createElement(cj,{hsva:c,onChange:d}),ve.createElement(uj,{hue:c.h,onChange:d}),ve.createElement(W1e,{hsva:c,onChange:d,className:"react-colorful__last-control"}))},X1e={defaultColor:{r:0,g:0,b:0,a:1},toHsva:lj,fromHsva:oj,equal:OI},$1e=function(r){return ve.createElement(q1e,eb({},r,{colorModel:X1e}))},j1e={defaultColor:{r:0,g:0,b:0},toHsva:function(r){return lj({r:r.r,g:r.g,b:r.b,a:1})},fromHsva:function(r){return{r:(e=oj(r)).r,g:e.g,b:e.b};var e},equal:OI},Y1e=function(r){return ve.createElement(H1e,eb({},r,{colorModel:j1e}))},WD={exports:{}},qD,V5;function Z1e(){if(V5)return qD;V5=1;var r="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED";return qD=r,qD}var XD,G5;function K1e(){if(G5)return XD;G5=1;var r=Z1e();function e(){}function t(){}return t.resetWarningCache=e,XD=function(){function n(a,o,l,c,d,p){if(p!==r){var y=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw y.name="Invariant Violation",y}}n.isRequired=n;function i(){return n}var s={array:n,bigint:n,bool:n,func:n,number:n,object:n,string:n,symbol:n,any:n,arrayOf:i,element:n,elementType:n,instanceOf:i,node:n,objectOf:i,oneOf:i,oneOfType:i,shape:i,exact:i,checkPropTypes:t,resetWarningCache:e};return s.PropTypes=s,s},XD}var k5;function Q1e(){return k5||(k5=1,WD.exports=K1e()()),WD.exports}var J1e=Q1e();const Or=Ey(J1e);function tb(r,e,t,n){function i(s){return s instanceof t?s:new t(function(a){a(s)})}return new(t||(t=Promise))(function(s,a){function o(d){try{c(n.next(d))}catch(p){a(p)}}function l(d){try{c(n.throw(d))}catch(p){a(p)}}function c(d){d.done?s(d.value):i(d.value).then(o,l)}c((n=n.apply(r,e||[])).next())})}function nb(r,e){var t={label:0,sent:function(){if(s[0]&1)throw s[1];return s[1]},trys:[],ops:[]},n,i,s,a=Object.create((typeof Iterator=="function"?Iterator:Object).prototype);return a.next=o(0),a.throw=o(1),a.return=o(2),typeof Symbol=="function"&&(a[Symbol.iterator]=function(){return this}),a;function o(c){return function(d){return l([c,d])}}function l(c){if(n)throw new TypeError("Generator is already executing.");for(;a&&(a=0,c[0]&&(t=0)),t;)try{if(n=1,i&&(s=c[0]&2?i.return:c[0]?i.throw||((s=i.return)&&s.call(i),0):i.next)&&!(s=s.call(i,c[1])).done)return s;switch(i=0,s&&(c=[c[0]&2,s.value]),c[0]){case 0:case 1:s=c;break;case 4:return t.label++,{value:c[1],done:!1};case 5:t.label++,i=c[1],c=[0];continue;case 7:c=t.ops.pop(),t.trys.pop();continue;default:if(s=t.trys,!(s=s.length>0&&s[s.length-1])&&(c[0]===6||c[0]===2)){t=0;continue}if(c[0]===3&&(!s||c[1]>s[0]&&c[1]<s[3])){t.label=c[1];break}if(c[0]===6&&t.label<s[1]){t.label=s[1],s=c;break}if(s&&t.label<s[2]){t.label=s[2],t.ops.push(c);break}s[2]&&t.ops.pop(),t.trys.pop();continue}c=e.call(r,t)}catch(d){c=[6,d],i=0}finally{n=s=0}if(c[0]&5)throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}}function eEe(r,e){var t=typeof Symbol=="function"&&r[Symbol.iterator];if(!t)return r;var n=t.call(r),i,s=[],a;try{for(;(e===void 0||e-- >0)&&!(i=n.next()).done;)s.push(i.value)}catch(o){a={error:o}}finally{try{i&&!i.done&&(t=n.return)&&t.call(n)}finally{if(a)throw a.error}}return s}function tEe(){for(var r=[],e=0;e<arguments.length;e++)r=r.concat(eEe(arguments[e]));return r}var nEe=new Map([["aac","audio/aac"],["abw","application/x-abiword"],["arc","application/x-freearc"],["avif","image/avif"],["avi","video/x-msvideo"],["azw","application/vnd.amazon.ebook"],["bin","application/octet-stream"],["bmp","image/bmp"],["bz","application/x-bzip"],["bz2","application/x-bzip2"],["cda","application/x-cdf"],["csh","application/x-csh"],["css","text/css"],["csv","text/csv"],["doc","application/msword"],["docx","application/vnd.openxmlformats-officedocument.wordprocessingml.document"],["eot","application/vnd.ms-fontobject"],["epub","application/epub+zip"],["gz","application/gzip"],["gif","image/gif"],["heic","image/heic"],["heif","image/heif"],["htm","text/html"],["html","text/html"],["ico","image/vnd.microsoft.icon"],["ics","text/calendar"],["jar","application/java-archive"],["jpeg","image/jpeg"],["jpg","image/jpeg"],["js","text/javascript"],["json","application/json"],["jsonld","application/ld+json"],["mid","audio/midi"],["midi","audio/midi"],["mjs","text/javascript"],["mp3","audio/mpeg"],["mp4","video/mp4"],["mpeg","video/mpeg"],["mpkg","application/vnd.apple.installer+xml"],["odp","application/vnd.oasis.opendocument.presentation"],["ods","application/vnd.oasis.opendocument.spreadsheet"],["odt","application/vnd.oasis.opendocument.text"],["oga","audio/ogg"],["ogv","video/ogg"],["ogx","application/ogg"],["opus","audio/opus"],["otf","font/otf"],["png","image/png"],["pdf","application/pdf"],["php","application/x-httpd-php"],["ppt","application/vnd.ms-powerpoint"],["pptx","application/vnd.openxmlformats-officedocument.presentationml.presentation"],["rar","application/vnd.rar"],["rtf","application/rtf"],["sh","application/x-sh"],["svg","image/svg+xml"],["swf","application/x-shockwave-flash"],["tar","application/x-tar"],["tif","image/tiff"],["tiff","image/tiff"],["ts","video/mp2t"],["ttf","font/ttf"],["txt","text/plain"],["vsd","application/vnd.visio"],["wav","audio/wav"],["weba","audio/webm"],["webm","video/webm"],["webp","image/webp"],["woff","font/woff"],["woff2","font/woff2"],["xhtml","application/xhtml+xml"],["xls","application/vnd.ms-excel"],["xlsx","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"],["xml","application/xml"],["xul","application/vnd.mozilla.xul+xml"],["zip","application/zip"],["7z","application/x-7z-compressed"],["mkv","video/x-matroska"],["mov","video/quicktime"],["msg","application/vnd.ms-outlook"]]);function vE(r,e){var t=iEe(r);if(typeof t.path!="string"){var n=r.webkitRelativePath;Object.defineProperty(t,"path",{value:typeof e=="string"?e:typeof n=="string"&&n.length>0?n:r.name,writable:!1,configurable:!1,enumerable:!0})}return t}function iEe(r){var e=r.name,t=e&&e.lastIndexOf(".")!==-1;if(t&&!r.type){var n=e.split(".").pop().toLowerCase(),i=nEe.get(n);i&&Object.defineProperty(r,"type",{value:i,writable:!1,configurable:!1,enumerable:!0})}return r}var rEe=[".DS_Store","Thumbs.db"];function sEe(r){return tb(this,void 0,void 0,function(){return nb(this,function(e){return jR(r)&&aEe(r)?[2,cEe(r.dataTransfer,r.type)]:oEe(r)?[2,lEe(r)]:Array.isArray(r)&&r.every(function(t){return"getFile"in t&&typeof t.getFile=="function"})?[2,uEe(r)]:[2,[]]})})}function aEe(r){return jR(r.dataTransfer)}function oEe(r){return jR(r)&&jR(r.target)}function jR(r){return typeof r=="object"&&r!==null}function lEe(r){return GU(r.target.files).map(function(e){return vE(e)})}function uEe(r){return tb(this,void 0,void 0,function(){var e;return nb(this,function(t){switch(t.label){case 0:return[4,Promise.all(r.map(function(n){return n.getFile()}))];case 1:return e=t.sent(),[2,e.map(function(n){return vE(n)})]}})})}function cEe(r,e){return tb(this,void 0,void 0,function(){var t,n;return nb(this,function(i){switch(i.label){case 0:return r===null?[2,[]]:r.items?(t=GU(r.items).filter(function(s){return s.kind==="file"}),e!=="drop"?[2,t]:[4,Promise.all(t.map(fEe))]):[3,2];case 1:return n=i.sent(),[2,H5(hj(n))];case 2:return[2,H5(GU(r.files).map(function(s){return vE(s)}))]}})})}function H5(r){return r.filter(function(e){return rEe.indexOf(e.name)===-1})}function GU(r){if(r===null)return[];for(var e=[],t=0;t<r.length;t++){var n=r[t];e.push(n)}return e}function fEe(r){if(typeof r.webkitGetAsEntry!="function")return W5(r);var e=r.webkitGetAsEntry();return e&&e.isDirectory?pj(e):W5(r)}function hj(r){return r.reduce(function(e,t){return tEe(e,Array.isArray(t)?hj(t):[t])},[])}function W5(r){var e=r.getAsFile();if(!e)return Promise.reject(r+" is not a File");var t=vE(e);return Promise.resolve(t)}function dEe(r){return tb(this,void 0,void 0,function(){return nb(this,function(e){return[2,r.isDirectory?pj(r):hEe(r)]})})}function pj(r){var e=r.createReader();return new Promise(function(t,n){var i=[];function s(){var a=this;e.readEntries(function(o){return tb(a,void 0,void 0,function(){var l,c,d;return nb(this,function(p){switch(p.label){case 0:if(o.length)return[3,5];p.label=1;case 1:return p.trys.push([1,3,,4]),[4,Promise.all(i)];case 2:return l=p.sent(),t(l),[3,4];case 3:return c=p.sent(),n(c),[3,4];case 4:return[3,6];case 5:d=Promise.all(o.map(dEe)),i.push(d),s(),p.label=6;case 6:return[2]}})})},function(o){n(o)})}s()})}function hEe(r){return tb(this,void 0,void 0,function(){return nb(this,function(e){return[2,new Promise(function(t,n){r.file(function(i){var s=vE(i,r.fullPath);t(s)},function(i){n(i)})})]})})}var bw={},q5;function pEe(){return q5||(q5=1,bw.__esModule=!0,bw.default=function(r,e){if(r&&e){var t=Array.isArray(e)?e:e.split(",");if(t.length===0)return!0;var n=r.name||"",i=(r.type||"").toLowerCase(),s=i.replace(/\/.*$/,"");return t.some(function(a){var o=a.trim().toLowerCase();return o.charAt(0)==="."?n.toLowerCase().endsWith(o):o.endsWith("/*")?s===o.replace(/\/.*$/,""):i===o})}return!0}),bw}var mEe=pEe();const gEe=Ey(mEe);function X5(r,e){var t=Object.keys(r);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(r);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(r,i).enumerable})),t.push.apply(t,n)}return t}function $5(r){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?X5(Object(t),!0).forEach(function(n){mj(r,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(t)):X5(Object(t)).forEach(function(n){Object.defineProperty(r,n,Object.getOwnPropertyDescriptor(t,n))})}return r}function mj(r,e,t){return e in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function j5(r,e){return xEe(r)||vEe(r,e)||_Ee(r,e)||yEe()}function yEe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function _Ee(r,e){if(r){if(typeof r=="string")return Y5(r,e);var t=Object.prototype.toString.call(r).slice(8,-1);if(t==="Object"&&r.constructor&&(t=r.constructor.name),t==="Map"||t==="Set")return Array.from(r);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return Y5(r,e)}}function Y5(r,e){(e==null||e>r.length)&&(e=r.length);for(var t=0,n=new Array(e);t<e;t++)n[t]=r[t];return n}function vEe(r,e){var t=r==null?null:typeof Symbol<"u"&&r[Symbol.iterator]||r["@@iterator"];if(t!=null){var n=[],i=!0,s=!1,a,o;try{for(t=t.call(r);!(i=(a=t.next()).done)&&(n.push(a.value),!(e&&n.length===e));i=!0);}catch(l){s=!0,o=l}finally{try{!i&&t.return!=null&&t.return()}finally{if(s)throw o}}return n}}function xEe(r){if(Array.isArray(r))return r}var bEe="file-invalid-type",SEe="file-too-large",TEe="file-too-small",EEe="too-many-files",MEe=function(e){e=Array.isArray(e)&&e.length===1?e[0]:e;var t=Array.isArray(e)?"one of ".concat(e.join(", ")):e;return{code:bEe,message:"File type must be ".concat(t)}},Z5=function(e){return{code:SEe,message:"File is larger than ".concat(e," ").concat(e===1?"byte":"bytes")}},K5=function(e){return{code:TEe,message:"File is smaller than ".concat(e," ").concat(e===1?"byte":"bytes")}},AEe={code:EEe,message:"Too many files"};function gj(r,e){var t=r.type==="application/x-moz-file"||gEe(r,e);return[t,t?null:MEe(e)]}function yj(r,e,t){if(cT(r.size))if(cT(e)&&cT(t)){if(r.size>t)return[!1,Z5(t)];if(r.size<e)return[!1,K5(e)]}else{if(cT(e)&&r.size<e)return[!1,K5(e)];if(cT(t)&&r.size>t)return[!1,Z5(t)]}return[!0,null]}function cT(r){return r!=null}function wEe(r){var e=r.files,t=r.accept,n=r.minSize,i=r.maxSize,s=r.multiple,a=r.maxFiles;return!s&&e.length>1||s&&a>=1&&e.length>a?!1:e.every(function(o){var l=gj(o,t),c=j5(l,1),d=c[0],p=yj(o,n,i),y=j5(p,1),_=y[0];return d&&_})}function YR(r){return typeof r.isPropagationStopped=="function"?r.isPropagationStopped():typeof r.cancelBubble<"u"?r.cancelBubble:!1}function Sw(r){return r.dataTransfer?Array.prototype.some.call(r.dataTransfer.types,function(e){return e==="Files"||e==="application/x-moz-file"}):!!r.target&&!!r.target.files}function Q5(r){r.preventDefault()}function REe(r){return r.indexOf("MSIE")!==-1||r.indexOf("Trident/")!==-1}function CEe(r){return r.indexOf("Edge/")!==-1}function NEe(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:window.navigator.userAgent;return REe(r)||CEe(r)}function Yf(){for(var r=arguments.length,e=new Array(r),t=0;t<r;t++)e[t]=arguments[t];return function(n){for(var i=arguments.length,s=new Array(i>1?i-1:0),a=1;a<i;a++)s[a-1]=arguments[a];return e.some(function(o){return!YR(n)&&o&&o.apply(void 0,[n].concat(s)),YR(n)})}}function DEe(){return"showOpenFilePicker"in window}function OEe(r){return r=typeof r=="string"?r.split(","):r,[{description:"everything",accept:Array.isArray(r)?r.filter(function(e){return e==="audio/*"||e==="video/*"||e==="image/*"||e==="text/*"||/\w+\/[-+.\w]+/g.test(e)}).reduce(function(e,t){return $5($5({},e),{},mj({},t,[]))},{}):{}}]}function UEe(r){return r instanceof DOMException&&(r.name==="AbortError"||r.code===r.ABORT_ERR)}function LEe(r){return r instanceof DOMException&&(r.name==="SecurityError"||r.code===r.SECURITY_ERR)}var PEe=["children"],BEe=["open"],IEe=["refKey","role","onKeyDown","onFocus","onBlur","onClick","onDragEnter","onDragOver","onDragLeave","onDrop"],FEe=["refKey","onChange","onClick"];function zEe(r){return kEe(r)||GEe(r)||_j(r)||VEe()}function VEe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function GEe(r){if(typeof Symbol<"u"&&r[Symbol.iterator]!=null||r["@@iterator"]!=null)return Array.from(r)}function kEe(r){if(Array.isArray(r))return kU(r)}function $D(r,e){return qEe(r)||WEe(r,e)||_j(r,e)||HEe()}function HEe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function _j(r,e){if(r){if(typeof r=="string")return kU(r,e);var t=Object.prototype.toString.call(r).slice(8,-1);if(t==="Object"&&r.constructor&&(t=r.constructor.name),t==="Map"||t==="Set")return Array.from(r);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return kU(r,e)}}function kU(r,e){(e==null||e>r.length)&&(e=r.length);for(var t=0,n=new Array(e);t<e;t++)n[t]=r[t];return n}function WEe(r,e){var t=r==null?null:typeof Symbol<"u"&&r[Symbol.iterator]||r["@@iterator"];if(t!=null){var n=[],i=!0,s=!1,a,o;try{for(t=t.call(r);!(i=(a=t.next()).done)&&(n.push(a.value),!(e&&n.length===e));i=!0);}catch(l){s=!0,o=l}finally{try{!i&&t.return!=null&&t.return()}finally{if(s)throw o}}return n}}function qEe(r){if(Array.isArray(r))return r}function J5(r,e){var t=Object.keys(r);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(r);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(r,i).enumerable})),t.push.apply(t,n)}return t}function ss(r){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?J5(Object(t),!0).forEach(function(n){HU(r,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(t)):J5(Object(t)).forEach(function(n){Object.defineProperty(r,n,Object.getOwnPropertyDescriptor(t,n))})}return r}function HU(r,e,t){return e in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function ZR(r,e){if(r==null)return{};var t=XEe(r,e),n,i;if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(r);for(i=0;i<s.length;i++)n=s[i],!(e.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(r,n)&&(t[n]=r[n])}return t}function XEe(r,e){if(r==null)return{};var t={},n=Object.keys(r),i,s;for(s=0;s<n.length;s++)i=n[s],!(e.indexOf(i)>=0)&&(t[i]=r[i]);return t}var UI=H.forwardRef(function(r,e){var t=r.children,n=ZR(r,PEe),i=xj(n),s=i.open,a=ZR(i,BEe);return H.useImperativeHandle(e,function(){return{open:s}},[s]),ve.createElement(H.Fragment,null,t(ss(ss({},a),{},{open:s})))});UI.displayName="Dropzone";var vj={disabled:!1,getFilesFromEvent:sEe,maxSize:1/0,minSize:0,multiple:!0,maxFiles:0,preventDropOnDocument:!0,noClick:!1,noKeyboard:!1,noDrag:!1,noDragEventsBubbling:!1,validator:null,useFsAccessApi:!0};UI.defaultProps=vj;UI.propTypes={children:Or.func,accept:Or.oneOfType([Or.string,Or.arrayOf(Or.string)]),multiple:Or.bool,preventDropOnDocument:Or.bool,noClick:Or.bool,noKeyboard:Or.bool,noDrag:Or.bool,noDragEventsBubbling:Or.bool,minSize:Or.number,maxSize:Or.number,maxFiles:Or.number,disabled:Or.bool,getFilesFromEvent:Or.func,onFileDialogCancel:Or.func,onFileDialogOpen:Or.func,useFsAccessApi:Or.bool,onDragEnter:Or.func,onDragLeave:Or.func,onDragOver:Or.func,onDrop:Or.func,onDropAccepted:Or.func,onDropRejected:Or.func,validator:Or.func};var WU={isFocused:!1,isFileDialogActive:!1,isDragActive:!1,isDragAccept:!1,isDragReject:!1,draggedFiles:[],acceptedFiles:[],fileRejections:[]};function xj(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},e=ss(ss({},vj),r),t=e.accept,n=e.disabled,i=e.getFilesFromEvent,s=e.maxSize,a=e.minSize,o=e.multiple,l=e.maxFiles,c=e.onDragEnter,d=e.onDragLeave,p=e.onDragOver,y=e.onDrop,_=e.onDropAccepted,v=e.onDropRejected,b=e.onFileDialogCancel,E=e.onFileDialogOpen,T=e.useFsAccessApi,M=e.preventDropOnDocument,R=e.noClick,N=e.noKeyboard,P=e.noDrag,U=e.noDragEventsBubbling,L=e.validator,F=H.useMemo(function(){return typeof E=="function"?E:ek},[E]),O=H.useMemo(function(){return typeof b=="function"?b:ek},[b]),B=H.useRef(null),q=H.useRef(null),j=H.useReducer($Ee,WU),Q=$D(j,2),se=Q[0],ae=Q[1],V=se.isFocused,X=se.isFileDialogActive,ee=se.draggedFiles,fe=H.useRef(typeof window<"u"&&window.isSecureContext&&T&&DEe()),Y=function(){!fe.current&&X&&setTimeout(function(){if(q.current){var k=q.current.files;k.length||(ae({type:"closeDialog"}),O())}},300)};H.useEffect(function(){return window.addEventListener("focus",Y,!1),function(){window.removeEventListener("focus",Y,!1)}},[q,X,O,fe]);var K=H.useRef([]),he=function(k){B.current&&B.current.contains(k.target)||(k.preventDefault(),K.current=[])};H.useEffect(function(){return M&&(document.addEventListener("dragover",Q5,!1),document.addEventListener("drop",he,!1)),function(){M&&(document.removeEventListener("dragover",Q5),document.removeEventListener("drop",he))}},[B,M]);var Ce=H.useCallback(function(Z){Z.preventDefault(),Z.persist(),Je(Z),K.current=[].concat(zEe(K.current),[Z.target]),Sw(Z)&&Promise.resolve(i(Z)).then(function(k){YR(Z)&&!U||(ae({draggedFiles:k,isDragActive:!0,type:"setDraggedFiles"}),c&&c(Z))})},[i,c,U]),Ie=H.useCallback(function(Z){Z.preventDefault(),Z.persist(),Je(Z);var k=Sw(Z);if(k&&Z.dataTransfer)try{Z.dataTransfer.dropEffect="copy"}catch{}return k&&p&&p(Z),!1},[p,U]),ut=H.useCallback(function(Z){Z.preventDefault(),Z.persist(),Je(Z);var k=K.current.filter(function(Fe){return B.current&&B.current.contains(Fe)}),pe=k.indexOf(Z.target);pe!==-1&&k.splice(pe,1),K.current=k,!(k.length>0)&&(ae({isDragActive:!1,type:"setDraggedFiles",draggedFiles:[]}),Sw(Z)&&d&&d(Z))},[B,d,U]),Ee=H.useCallback(function(Z,k){var pe=[],Fe=[];Z.forEach(function(He){var ze=gj(He,t),Bt=$D(ze,2),Ct=Bt[0],Yt=Bt[1],$t=yj(He,a,s),st=$D($t,2),nt=st[0],Pt=st[1],ue=L?L(He):null;if(Ct&&nt&&!ue)pe.push(He);else{var Re=[Yt,Pt];ue&&(Re=Re.concat(ue)),Fe.push({file:He,errors:Re.filter(function(dt){return dt})})}}),(!o&&pe.length>1||o&&l>=1&&pe.length>l)&&(pe.forEach(function(He){Fe.push({file:He,errors:[AEe]})}),pe.splice(0)),ae({acceptedFiles:pe,fileRejections:Fe,type:"setFiles"}),y&&y(pe,Fe,k),Fe.length>0&&v&&v(Fe,k),pe.length>0&&_&&_(pe,k)},[ae,o,t,a,s,l,y,_,v,L]),Ne=H.useCallback(function(Z){Z.preventDefault(),Z.persist(),Je(Z),K.current=[],Sw(Z)&&Promise.resolve(i(Z)).then(function(k){YR(Z)&&!U||Ee(k,Z)}),ae({type:"reset"})},[i,Ee,U]),rt=H.useCallback(function(){if(fe.current){ae({type:"openDialog"}),F();var Z={multiple:o,types:OEe(t)};window.showOpenFilePicker(Z).then(function(k){return i(k)}).then(function(k){Ee(k,null),ae({type:"closeDialog"})}).catch(function(k){UEe(k)?(O(k),ae({type:"closeDialog"})):LEe(k)&&(fe.current=!1,q.current&&(q.current.value=null,q.current.click()))});return}q.current&&(ae({type:"openDialog"}),F(),q.current.value=null,q.current.click())},[ae,F,O,T,Ee,t,o]),Nt=H.useCallback(function(Z){!B.current||!B.current.isEqualNode(Z.target)||(Z.key===" "||Z.key==="Enter"||Z.keyCode===32||Z.keyCode===13)&&(Z.preventDefault(),rt())},[B,rt]),Ft=H.useCallback(function(){ae({type:"focus"})},[]),fn=H.useCallback(function(){ae({type:"blur"})},[]),Sn=H.useCallback(function(){R||(NEe()?setTimeout(rt,0):rt())},[R,rt]),At=function(k){return n?null:k},qe=function(k){return N?null:At(k)},at=function(k){return P?null:At(k)},Je=function(k){U&&k.stopPropagation()},xe=H.useMemo(function(){return function(){var Z=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},k=Z.refKey,pe=k===void 0?"ref":k,Fe=Z.role,He=Z.onKeyDown,ze=Z.onFocus,Bt=Z.onBlur,Ct=Z.onClick,Yt=Z.onDragEnter,$t=Z.onDragOver,st=Z.onDragLeave,nt=Z.onDrop,Pt=ZR(Z,IEe);return ss(ss(HU({onKeyDown:qe(Yf(He,Nt)),onFocus:qe(Yf(ze,Ft)),onBlur:qe(Yf(Bt,fn)),onClick:At(Yf(Ct,Sn)),onDragEnter:at(Yf(Yt,Ce)),onDragOver:at(Yf($t,Ie)),onDragLeave:at(Yf(st,ut)),onDrop:at(Yf(nt,Ne)),role:typeof Fe=="string"&&Fe!==""?Fe:"button"},pe,B),!n&&!N?{tabIndex:0}:{}),Pt)}},[B,Nt,Ft,fn,Sn,Ce,Ie,ut,Ne,N,P,n]),oe=H.useCallback(function(Z){Z.stopPropagation()},[]),Qt=H.useMemo(function(){return function(){var Z=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},k=Z.refKey,pe=k===void 0?"ref":k,Fe=Z.onChange,He=Z.onClick,ze=ZR(Z,FEe),Bt=HU({accept:t,multiple:o,type:"file",style:{display:"none"},onChange:At(Yf(Fe,Ne)),onClick:At(Yf(He,oe)),tabIndex:-1},pe,q);return ss(ss({},Bt),ze)}},[q,t,o,Ne,n]),Dt=ee.length,zt=Dt>0&&wEe({files:ee,accept:t,minSize:a,maxSize:s,multiple:o,maxFiles:l}),wt=Dt>0&&!zt;return ss(ss({},se),{},{isDragAccept:zt,isDragReject:wt,isFocused:V&&!n,getRootProps:xe,getInputProps:Qt,rootRef:B,inputRef:q,open:At(rt)})}function $Ee(r,e){switch(e.type){case"focus":return ss(ss({},r),{},{isFocused:!0});case"blur":return ss(ss({},r),{},{isFocused:!1});case"openDialog":return ss(ss({},WU),{},{isFileDialogActive:!0});case"closeDialog":return ss(ss({},r),{},{isFileDialogActive:!1});case"setDraggedFiles":var t=e.isDragActive,n=e.draggedFiles;return ss(ss({},r),{},{draggedFiles:n,isDragActive:t});case"setFiles":return ss(ss({},r),{},{acceptedFiles:e.acceptedFiles,fileRejections:e.fileRejections});case"reset":return ss({},WU);default:return r}}function ek(){}function jEe(r){let e;const t=new Set,n=(c,d)=>{const p=typeof c=="function"?c(e):c;if(p!==e){const y=e;e=d?p:Object.assign({},e,p),t.forEach(_=>_(e,y))}},i=()=>e,s=(c,d=i,p=Object.is)=>{console.warn("[DEPRECATED] Please use `subscribeWithSelector` middleware");let y=d(e);function _(){const v=d(e);if(!p(y,v)){const b=y;c(y=v,b)}}return t.add(_),()=>t.delete(_)},l={setState:n,getState:i,subscribe:(c,d,p)=>d||p?s(c,d,p):(t.add(c),()=>t.delete(c)),destroy:()=>t.clear()};return e=r(n,i,l),l}const YEe=typeof window>"u"||!window.navigator||/ServerSideRendering|^Deno\//.test(window.navigator.userAgent),tk=YEe?H.useEffect:H.useLayoutEffect;function ZEe(r){const e=typeof r=="function"?jEe(r):r,t=(n=e.getState,i=Object.is)=>{const[,s]=H.useReducer(E=>E+1,0),a=e.getState(),o=H.useRef(a),l=H.useRef(n),c=H.useRef(i),d=H.useRef(!1),p=H.useRef();p.current===void 0&&(p.current=n(a));let y,_=!1;(o.current!==a||l.current!==n||c.current!==i||d.current)&&(y=n(a),_=!i(p.current,y)),tk(()=>{_&&(p.current=y),o.current=a,l.current=n,c.current=i,d.current=!1});const v=H.useRef(a);tk(()=>{const E=()=>{try{const M=e.getState(),R=l.current(M);c.current(p.current,R)||(o.current=M,p.current=R,s())}catch{d.current=!0,s()}},T=e.subscribe(E);return e.getState()!==v.current&&E(),T},[]);const b=_?y:p.current;return H.useDebugValue(b),b};return Object.assign(t,e),t[Symbol.iterator]=function(){console.warn("[useStore, api] = create() is deprecated and will be removed in v4");const n=[t,e];return{next(){const i=n.length<=0;return{value:n.shift(),done:i}}}},t}const KEe=r=>(e,t,n)=>{const i=n.subscribe;return n.subscribe=(a,o,l)=>{let c=a;if(o){const d=l?.equalityFn||Object.is;let p=a(n.getState());c=y=>{const _=a(y);if(!d(p,_)){const v=p;o(p=_,v)}},l?.fireImmediately&&o(p,p)}return i(c)},r(e,t,n)};var jD,nk;function QEe(){return nk||(nk=1,jD=function(e){return e!=null&&typeof e=="object"&&Array.isArray(e)===!1}),jD}var YD,ik;function bj(){if(ik)return YD;ik=1;var r=QEe();function e(t){return r(t)===!0&&Object.prototype.toString.call(t)==="[object Object]"}return YD=function(n){var i,s;return!(e(n)===!1||(i=n.constructor,typeof i!="function")||(s=i.prototype,e(s)===!1)||s.hasOwnProperty("isPrototypeOf")===!1)},YD}var ZD,rk;function LI(){if(rk)return ZD;rk=1;var r=bj();return ZD=function(t){return r(t)||typeof t=="function"||Array.isArray(t)},ZD}var KD,sk;function JEe(){return sk||(sk=1,KD=function(e,t,n){for(var i in e)if(t.call(n,e[i],i,e)===!1)break}),KD}var QD,ak;function eMe(){if(ak)return QD;ak=1;var r=LI(),e=JEe();function t(a,o){for(var l=arguments.length,c=0;++c<l;){var d=arguments[c];i(d)&&e(d,n,a)}return a}function n(a,o){if(s(o)){var l=this[o];i(a)&&i(l)?t(l,a):this[o]=a}}function i(a){return r(a)&&!Array.isArray(a)}function s(a){return a!=="__proto__"&&a!=="constructor"&&a!=="prototype"}return QD=t,QD}var JD,ok;function tMe(){if(ok)return JD;ok=1,JD=function(t,n,i,s,a){if(!r(t)||!n)return t;if(n=e(n),i&&(n+="."+e(i)),s&&(n+="."+e(s)),a&&(n+="."+e(a)),n in t)return t[n];for(var o=n.split("."),l=o.length,c=-1;t&&++c<l;){for(var d=o[c];d[d.length-1]==="\\";)d=d.slice(0,-1)+"."+o[++c];t=t[d]}return t};function r(t){return t!==null&&(typeof t=="object"||typeof t=="function")}function e(t){return t?Array.isArray(t)?t.join("."):t:""}return JD}var eO,lk;function nMe(){return lk||(lk=1,eO=function(r,e){if(r===null||typeof r>"u")throw new TypeError("expected first argument to be an object.");if(typeof e>"u"||typeof Symbol>"u"||typeof Object.getOwnPropertySymbols!="function")return r;for(var t=Object.prototype.propertyIsEnumerable,n=Object(r),i=arguments.length,s=0;++s<i;)for(var a=Object(arguments[s]),o=Object.getOwnPropertySymbols(a),l=0;l<o.length;l++){var c=o[l];t.call(a,c)&&(n[c]=a[c])}return n}),eO}var tO,uk;function iMe(){if(uk)return tO;uk=1;var r=LI(),e=nMe();tO=Object.assign||function(o){if(o===null||typeof o>"u")throw new TypeError("Cannot convert undefined or null to object");s(o)||(o={});for(var l=1;l<arguments.length;l++){var c=arguments[l];n(c)&&(c=i(c)),s(c)&&(t(o,c),e(o,c))}return o};function t(o,l){for(var c in l)a(l,c)&&(o[c]=l[c])}function n(o){return o&&typeof o=="string"}function i(o){var l={};for(var c in o)l[c]=o[c];return l}function s(o){return o&&typeof o=="object"||r(o)}function a(o,l){return Object.prototype.hasOwnProperty.call(o,l)}return tO}var nO,ck;function rMe(){if(ck)return nO;ck=1;var r=iMe();nO=function(i,s,a){if(typeof i!="string")throw new TypeError("expected a string");typeof s=="function"&&(a=s,s=null),typeof s=="string"&&(s={sep:s});var o=r({sep:"."},s),l=o.quotes||['"',"'","`"],c;o.brackets===!0?c={"<":">","(":")","[":"]","{":"}"}:o.brackets&&(c=o.brackets);var d=[],p=[],y=[""],_=o.sep,v=i.length,b=-1,E;function T(){if(c&&p.length)return c[p[p.length-1]]}for(;++b<v;){var M=i[b],R=i[b+1],N={val:M,idx:b,arr:y,str:i};if(d.push(N),M==="\\"){N.val=n(o,i,b)===!0?M+R:R,N.escaped=!0,typeof a=="function"&&a(N),y[y.length-1]+=N.val,b++;continue}if(c&&c[M]){p.push(M);var P=T(),U=b+1;if(i.indexOf(P,U+1)!==-1)for(;p.length&&U<v;){var L=i[++U];if(L==="\\"){L++;continue}if(l.indexOf(L)!==-1){U=e(i,L,U+1);continue}if(P=T(),p.length&&i.indexOf(P,U+1)===-1)break;if(c[L]){p.push(L);continue}P===L&&p.pop()}if(E=U,E===-1){y[y.length-1]+=M;continue}M=i.slice(b,E+1),N.val=M,N.idx=b=E}if(l.indexOf(M)!==-1){if(E=e(i,M,b+1),E===-1){y[y.length-1]+=M;continue}t(M,o)===!0?M=i.slice(b,E+1):M=i.slice(b+1,E),N.val=M,N.idx=b=E}if(typeof a=="function"&&(a(N,d),M=N.val,b=N.idx),N.val===_&&N.split!==!1){y.push("");continue}y[y.length-1]+=N.val}return y};function e(i,s,a,o){var l=i.indexOf(s,a);return i.charAt(l-1)==="\\"?e(i,s,l+1):l}function t(i,s){return s.keepDoubleQuotes===!0&&i==='"'||s.keepSingleQuotes===!0&&i==="'"?!0:s.keepQuotes}function n(i,s,a){return typeof i.keepEscaping=="function"?i.keepEscaping(s,a):i.keepEscaping===!0||s[a+1]==="\\"}return nO}var iO,fk;function sMe(){return fk||(fk=1,iO=function(e){return typeof e<"u"&&e!==null&&(typeof e=="object"||typeof e=="function")}),iO}var rO,dk;function aMe(){if(dk)return rO;dk=1;var r=sMe();rO=function(i){r(i)||(i={});for(var s=arguments.length,a=1;a<s;a++){var o=arguments[a];r(o)&&e(i,o)}return i};function e(n,i){for(var s in i)t(i,s)&&(n[s]=i[s])}function t(n,i){return Object.prototype.hasOwnProperty.call(n,i)}return rO}var sO,hk;function oMe(){return hk||(hk=1,sO=function(e){return typeof e<"u"&&e!==null&&(typeof e=="object"||typeof e=="function")}),sO}var aO,pk;function lMe(){if(pk)return aO;pk=1;var r=rMe(),e=aMe(),t=bj(),n=oMe();aO=function(s,a,o){if(!n(s)||(Array.isArray(a)&&(a=[].concat.apply([],a).join(".")),typeof a!="string"))return s;for(var l=r(a,{sep:".",brackets:!0}).filter(i),c=l.length,d=-1,p=s;++d<c;){var y=l[d];if(d!==c-1){n(p[y])||(p[y]={}),p=p[y];continue}t(p[y])&&t(o)?p[y]=e({},p[y],o):p[y]=o}return s};function i(s){return s!=="__proto__"&&s!=="constructor"&&s!=="prototype"}return aO}var oO,mk;function uMe(){if(mk)return oO;mk=1;var r=LI(),e=eMe(),t=tMe(),n=lMe();return oO=function(s,a,o){if(!r(s))throw new TypeError("expected an object");if(typeof a!="string"||o==null)return e.apply(null,arguments);if(typeof o=="string")return n(s,a,o),s;var l=t(s,a);return r(o)&&r(l)&&(o=e({},l,o)),n(s,a,o),s},oO}var cMe=uMe();const fMe=Ey(cMe),PI=(...r)=>r.filter(Boolean).join(".");function dMe(r){const e=r.split(".");return[e.pop(),e.join(".")||void 0]}function hMe(r,e){return Object.entries(iTe(r,e)).reduce((t,[,{value:n,disabled:i,key:s}])=>(t[s]=i?void 0:n,t),{})}function pMe(r,e){const t=H.useRef();return C1(r,t.current)||(t.current=r),t.current}function Sj(r,e){var t;return H.useMemo(r,(t=pMe(e))!==null&&t!==void 0?t:[])}function mMe(r){const e=H.useRef(null),t=H.useRef(null),n=H.useRef(!0);return H.useLayoutEffect(()=>{r||(e.current.style.height="0px",e.current.style.overflow="hidden")},[]),H.useEffect(()=>{if(n.current){n.current=!1;return}let i;const s=e.current,a=()=>{r&&(s.style.removeProperty("height"),s.style.removeProperty("overflow"),t.current.scrollIntoView({behavior:"smooth",block:"nearest"}))};s.addEventListener("transitionend",a,{once:!0});const{height:o}=t.current.getBoundingClientRect();return s.style.height=o+"px",r||(s.style.overflow="hidden",i=window.setTimeout(()=>s.style.height="0px",50)),()=>{s.removeEventListener("transitionend",a),clearTimeout(i)}},[r]),{wrapperRef:e,contentRef:t}}const gMe=r=>{const[e,t]=H.useState(r.getVisiblePaths());return H.useEffect(()=>{t(r.getVisiblePaths());const n=r.useStore.subscribe(r.getVisiblePaths,t,{equalityFn:PN});return()=>n()},[r]),e};function yMe(r,e,t){return r.useStore(i=>{const s=Wn(Wn({},t),i.data);return hMe(s,e)},PN)}function Tj(r=3){const e=H.useRef(null),t=H.useRef(null),[n,i]=H.useState(!1),s=H.useCallback(()=>i(!0),[]),a=H.useCallback(()=>i(!1),[]);return H.useLayoutEffect(()=>{if(n){const{bottom:o,top:l,left:c}=e.current.getBoundingClientRect(),{height:d}=t.current.getBoundingClientRect(),p=o+d>window.innerHeight-40?"up":"down";t.current.style.position="fixed",t.current.style.zIndex="10000",t.current.style.left=c+"px",p==="down"?t.current.style.top=o+r+"px":t.current.style.bottom=window.innerHeight-l+r+"px"}},[r,n]),{popinRef:e,wrapperRef:t,shown:n,show:s,hide:a}}z1e([V1e]);const _Me={rgb:"toRgb",hsl:"toHsl",hsv:"toHsv",hex:"toHex"};Rl.extend({color:()=>r=>Zo(r).isValid()});const vMe=r=>Rl().color().test(r);function Ej(r,{format:e,hasAlpha:t,isString:n}){const i=_Me[e]+(n&&e!=="hex"?"String":""),s=r[i]();return typeof s=="object"&&!t?rTe(s,["a"]):s}const Mj=(r,e)=>{const t=Zo(r);if(!t.isValid())throw Error("Invalid color");return Ej(t,e)},xMe=(r,e)=>Ej(Zo(r),Wn(Wn({},e),{},{isString:!0,format:"hex"})),bMe=({value:r})=>{const e=F1e(r),t=e==="name"?"hex":e,n=typeof r=="object"?"a"in r:e==="hex"&&r.length===8||/^(rgba)|(hsla)|(hsva)/.test(r),i={format:t,hasAlpha:n,isString:typeof r=="string"};return{value:Mj(r,i),settings:i}};var SMe=Object.freeze({__proto__:null,schema:vMe,sanitize:Mj,format:xMe,normalize:bMe});const TMe=kn("div",{position:"relative",boxSizing:"border-box",borderRadius:"$sm",overflow:"hidden",cursor:"pointer",height:"$rowHeight",width:"$rowHeight",backgroundColor:"#fff",backgroundImage:`url('data:image/svg+xml;charset=utf-8,<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill-opacity=".05"><path d="M8 0h8v8H8zM0 8h8v8H0z"/></svg>')`,$inputStyle:"",$hover:"",zIndex:1,variants:{active:{true:{$inputStyle:"$accent1"}}},"&::before":{content:'""',position:"absolute",top:0,bottom:0,right:0,left:0,backgroundColor:"currentColor",zIndex:1}}),EMe=kn("div",{position:"relative",display:"grid",gridTemplateColumns:"$sizes$rowHeight auto",columnGap:"$colGap",alignItems:"center"}),MMe=kn("div",{width:"$colorPickerWidth",height:"$colorPickerHeight",".react-colorful":{width:"100%",height:"100%",boxShadow:"$level2",cursor:"crosshair"},".react-colorful__saturation":{borderRadius:"$sm $sm 0 0"},".react-colorful__alpha, .react-colorful__hue":{height:10},".react-colorful__last-control":{borderRadius:"0 0 $sm $sm"},".react-colorful__pointer":{height:12,width:12}});function gk(r,e){return e!=="rgb"?Zo(r).toRgb():r}function AMe({value:r,displayValue:e,settings:t,onUpdate:n}){const{emitOnEditStart:i,emitOnEditEnd:s}=So(),{format:a,hasAlpha:o}=t,{popinRef:l,wrapperRef:c,shown:d,show:p,hide:y}=Tj(),_=H.useRef(0),[v,b]=H.useState(()=>gk(r,a)),E=o?$1e:Y1e,T=()=>{b(gk(r,a)),p(),i()},M=()=>{y(),s(),window.clearTimeout(_.current)},R=()=>{_.current=window.setTimeout(M,500)};return H.useEffect(()=>()=>window.clearTimeout(_.current),[]),ve.createElement(ve.Fragment,null,ve.createElement(TMe,{ref:l,active:d,onClick:()=>T(),style:{color:e}}),d&&ve.createElement(AI,null,ve.createElement($$,{onPointerUp:M}),ve.createElement(MMe,{ref:c,onMouseEnter:()=>window.clearTimeout(_.current),onMouseLeave:N=>N.buttons===0&&R()},ve.createElement(E,{color:v,onChange:n}))))}function wMe(){const{value:r,displayValue:e,label:t,onChange:n,onUpdate:i,settings:s}=So();return ve.createElement(pc,{input:!0},ve.createElement(of,null,t),ve.createElement(EMe,null,ve.createElement(AMe,{value:r,displayValue:e,onChange:n,onUpdate:i,settings:s}),ve.createElement(MI,{value:e,onChange:n,onUpdate:i})))}var RMe=Wn({component:wMe},SMe);function CMe(){const{label:r,displayValue:e,onUpdate:t,settings:n}=So();return ve.createElement(pc,{input:!0},ve.createElement(of,null,r),ve.createElement(RI,{value:e,settings:n,onUpdate:t}))}var NMe=Wn({component:CMe},tj(["x","y","z"]));const DMe=kn("div",{$flexCenter:"",position:"relative",backgroundColor:"$elevation3",borderRadius:"$sm",cursor:"pointer",height:"$rowHeight",width:"$rowHeight",touchAction:"none",$draggable:"",$hover:"","&:active":{cursor:"none"},"&::after":{content:'""',backgroundColor:"$accent2",height:4,width:4,borderRadius:2}}),OMe=kn("div",{$flexCenter:"",width:"$joystickWidth",height:"$joystickHeight",borderRadius:"$sm",boxShadow:"$level2",position:"fixed",zIndex:1e4,overflow:"hidden",$draggable:"",transform:"translate(-50%, -50%)",variants:{isOutOfBounds:{true:{backgroundColor:"$elevation1"},false:{backgroundColor:"$elevation3"}}},"> div":{position:"absolute",$flexCenter:"",borderStyle:"solid",borderWidth:1,borderColor:"$highlight1",backgroundColor:"$elevation3",width:"80%",height:"80%","&::after,&::before":{content:'""',position:"absolute",zindex:10,backgroundColor:"$highlight1"},"&::before":{width:"100%",height:1},"&::after":{height:"100%",width:1}},"> span":{position:"relative",zindex:100,width:10,height:10,backgroundColor:"$accent2",borderRadius:"50%"}});function UMe({value:r,settings:e,onUpdate:t}){const n=H.useRef(),i=H.useRef(0),s=H.useRef(0),a=H.useRef(1),[o,l]=H.useState(!1),[c,d]=H.useState(!1),[p,y]=Y$(),_=H.useRef(null),v=H.useRef(null);H.useLayoutEffect(()=>{if(o){const{top:j,left:Q,width:se,height:ae}=_.current.getBoundingClientRect();v.current.style.left=Q+se/2+"px",v.current.style.top=j+ae/2+"px"}},[o]);const{keys:[b,E],joystick:T}=e,M=T==="invertY"?1:-1,{[b]:{step:R},[E]:{step:N}}=e,P=Dh("sizes","joystickWidth"),U=Dh("sizes","joystickHeight"),L=parseFloat(P)*.8/2,F=parseFloat(U)*.8/2,O=H.useCallback(()=>{n.current||(d(!0),i.current&&y({x:i.current*L}),s.current&&y({y:s.current*-F}),n.current=window.setInterval(()=>{t(j=>{const Q=R*i.current*a.current,se=M*N*s.current*a.current;return Array.isArray(j)?{[b]:j[0]+Q,[E]:j[1]+se}:{[b]:j[b]+Q,[E]:j[E]+se}})},16))},[L,F,t,y,R,N,b,E,M]),B=H.useCallback(()=>{window.clearTimeout(n.current),n.current=void 0,d(!1)},[]);H.useEffect(()=>{function j(Q){a.current=U$(Q)}return window.addEventListener("keydown",j),window.addEventListener("keyup",j),()=>{window.clearTimeout(n.current),window.removeEventListener("keydown",j),window.removeEventListener("keyup",j)}},[]);const q=yE(({first:j,active:Q,delta:[se,ae],movement:[V,X]})=>{j&&l(!0);const ee=Um(V,-L,L),fe=Um(X,-F,F);i.current=Math.abs(V)>Math.abs(ee)?Math.sign(V-ee):0,s.current=Math.abs(X)>Math.abs(fe)?Math.sign(fe-X):0;let Y=r[b],K=r[E];Q?(i.current||(Y+=se*R*a.current,y({x:ee})),s.current||(K-=M*ae*N*a.current,y({y:fe})),i.current||s.current?O():B(),t({[b]:Y,[E]:K})):(l(!1),i.current=0,s.current=0,y({x:0,y:0}),B())});return ve.createElement(DMe,Ss({ref:_},q()),o&&ve.createElement(AI,null,ve.createElement(OMe,{ref:v,isOutOfBounds:c},ve.createElement("div",null),ve.createElement("span",{ref:p}))))}const LMe=kn("div",{display:"grid",columnGap:"$colGap",variants:{withJoystick:{true:{gridTemplateColumns:"$sizes$rowHeight auto"},false:{gridTemplateColumns:"auto"}}}});function PMe(){const{label:r,displayValue:e,onUpdate:t,settings:n}=So();return ve.createElement(pc,{input:!0},ve.createElement(of,null,r),ve.createElement(LMe,{withJoystick:!!n.joystick},n.joystick&&ve.createElement(UMe,{value:e,settings:n,onUpdate:t}),ve.createElement(RI,{value:e,settings:n,onUpdate:t})))}const BMe=["joystick"],Aj=tj(["x","y"]),IMe=r=>{let{joystick:e=!0}=r,t=Tr(r,BMe);const{value:n,settings:i}=Aj.normalize(t);return{value:n,settings:Wn(Wn({},i),{},{joystick:e})}};var FMe=Wn(Wn({component:PMe},Aj),{},{normalize:IMe});const zMe=r=>{if(r!==void 0){if(r instanceof File)try{return URL.createObjectURL(r)}catch{return}if(typeof r=="string"&&r.indexOf("blob:")===0)return r;throw Error("Invalid image format [undefined | blob |File].")}},VMe=(r,e)=>typeof e=="object"&&"image"in e,GMe=({image:r})=>({value:r});var kMe=Object.freeze({__proto__:null,sanitize:zMe,schema:VMe,normalize:GMe});const HMe=kn("div",{position:"relative",display:"grid",gridTemplateColumns:"$sizes$rowHeight auto 20px",columnGap:"$colGap",alignItems:"center"}),WMe=kn("div",{$flexCenter:"",overflow:"hidden",height:"$rowHeight",background:"$elevation3",textAlign:"center",color:"inherit",borderRadius:"$sm",outline:"none",userSelect:"none",cursor:"pointer",$inputStyle:"",$hover:"",$focusWithin:"",$active:"$accent1 $elevation1",variants:{isDragAccept:{true:{$inputStyle:"$accent1",backgroundColor:"$elevation1"}}}}),qMe=kn("div",{boxSizing:"border-box",borderRadius:"$sm",height:"$rowHeight",width:"$rowHeight",$inputStyle:"",backgroundSize:"cover",backgroundPosition:"center",variants:{hasImage:{true:{cursor:"pointer",$hover:"",$active:""}}}}),XMe=kn("div",{$flexCenter:"",width:"$imagePreviewWidth",height:"$imagePreviewHeight",borderRadius:"$sm",boxShadow:"$level2",pointerEvents:"none",$inputStyle:"",backgroundSize:"cover",backgroundPosition:"center"}),$Me=kn("div",{fontSize:"0.8em",height:"100%",padding:"$rowGap $md"}),jMe=kn("div",{$flexCenter:"",top:"0",right:"0",marginRight:"$sm",height:"100%",cursor:"pointer",variants:{disabled:{true:{color:"$elevation3",cursor:"default"}}},"&::after,&::before":{content:'""',position:"absolute",height:2,width:10,borderRadius:1,backgroundColor:"currentColor"},"&::after":{transform:"rotate(45deg)"},"&::before":{transform:"rotate(-45deg)"}});function YMe(){const{label:r,value:e,onUpdate:t,disabled:n}=So(),{popinRef:i,wrapperRef:s,shown:a,show:o,hide:l}=Tj(),c=H.useCallback(v=>{v.length&&t(v[0])},[t]),d=H.useCallback(v=>{v.stopPropagation(),t(void 0)},[t]),{getRootProps:p,getInputProps:y,isDragAccept:_}=xj({maxFiles:1,accept:"image/*",onDrop:c,disabled:n});return ve.createElement(pc,{input:!0},ve.createElement(of,null,r),ve.createElement(HMe,null,ve.createElement(qMe,{ref:i,hasImage:!!e,onPointerDown:()=>!!e&&o(),onPointerUp:l,style:{backgroundImage:e?`url(${e})`:"none"}}),a&&!!e&&ve.createElement(AI,null,ve.createElement($$,{onPointerUp:l,style:{cursor:"pointer"}}),ve.createElement(XMe,{ref:s,style:{backgroundImage:`url(${e})`}})),ve.createElement(WMe,p({isDragAccept:_}),ve.createElement("input",y()),ve.createElement($Me,null,_?"drop image":"click or drop")),ve.createElement(jMe,{onClick:d,disabled:!e})))}var ZMe=Wn({component:YMe},kMe);const yk=Rl().number(),KMe=(r,e)=>Rl().array().length(2).every.number().test(r)&&Rl().schema({min:yk,max:yk}).test(e),KR=r=>({min:r[0],max:r[1]}),wj=(r,{bounds:[e,t]},n)=>{const i=Array.isArray(r)?KR(r):r,s={min:n[0],max:n[1]},{min:a,max:o}=Wn(Wn({},s),i);return[Um(Number(a),e,Math.max(e,o)),Um(Number(o),Math.min(t,a),t)]},QMe=({value:r,min:e,max:t})=>{const n={min:e,max:t},i=ej(KR(r),{min:n,max:n}),s=[e,t],a=Wn(Wn({},i),{},{bounds:s});return{value:wj(KR(r),a,r),settings:a}};var JMe=Object.freeze({__proto__:null,schema:KMe,format:KR,sanitize:wj,normalize:QMe});const eAe=["value","bounds","onDrag"],tAe=["bounds"],nAe=kn("div",{display:"grid",columnGap:"$colGap",gridTemplateColumns:"auto calc($sizes$numberInputMinWidth * 2 + $space$rowGap)"});function iAe(r){let{value:e,bounds:[t,n],onDrag:i}=r,s=Tr(r,eAe);const a=H.useRef(null),o=H.useRef(null),l=H.useRef(null),c=H.useRef(0),d=Dh("sizes","scrubberWidth"),p=yE(({event:v,first:b,xy:[E],movement:[T],memo:M={}})=>{if(b){const{width:N,left:P}=a.current.getBoundingClientRect();c.current=N-parseFloat(d);const U=v?.target===o.current||v?.target===l.current;M.pos=XR((E-P)/N,t,n);const L=Math.abs(M.pos-e.min)-Math.abs(M.pos-e.max);M.key=L<0||L===0&&M.pos<=e.min?"min":"max",U&&(M.pos=e[M.key])}const R=M.pos+XR(T/c.current,0,n-t);return i({[M.key]:qTe(R,s[M.key])}),M}),y=`calc(${qR(e.min,t,n)} * (100% - ${d} - 8px) + 4px)`,_=`calc(${1-qR(e.max,t,n)} * (100% - ${d} - 8px) + 4px)`;return ve.createElement(K$,Ss({ref:a},p()),ve.createElement(Z$,null,ve.createElement(Q$,{style:{left:y,right:_}})),ve.createElement(LU,{position:"left",ref:o,style:{left:y}}),ve.createElement(LU,{position:"right",ref:l,style:{right:_}}))}function rAe(){const{label:r,displayValue:e,onUpdate:t,settings:n}=So(),i=Tr(n,tAe);return ve.createElement(ve.Fragment,null,ve.createElement(pc,{input:!0},ve.createElement(of,null,r),ve.createElement(nAe,null,ve.createElement(iAe,Ss({value:e},n,{onDrag:t})),ve.createElement(RI,{value:e,settings:i,onUpdate:t,innerLabelTrim:0}))))}var sAe=Wn({component:rAe},JMe);const aAe=()=>{const r=new Map;return{on:(e,t)=>{let n=r.get(e);n===void 0&&(n=new Set,r.set(e,n)),n.add(t)},off:(e,t)=>{const n=r.get(e);n!==void 0&&(n.delete(t),n.size===0&&r.delete(e))},emit:(e,...t)=>{const n=r.get(e);if(n!==void 0)for(const i of n)i(...t)}}},oAe=["type","value"],lAe=["onChange","transient","onEditStart","onEditEnd"],uAe=function(){const e=ZEe(KEe(()=>({data:{}}))),t=aAe();this.storeId=nTe(),this.useStore=e;const n={},i=new Set;this.getVisiblePaths=()=>{const a=this.getData(),o=Object.keys(a),l=[];Object.entries(n).forEach(([d,p])=>{p.render&&o.some(y=>y.indexOf(d)===0)&&!p.render(this.get)&&l.push(d+".")});const c=[];return i.forEach(d=>{d in a&&a[d].__refCount>0&&l.every(p=>d.indexOf(p)===-1)&&(!a[d].render||a[d].render(this.get))&&c.push(d)}),c},this.setOrderedPaths=a=>{a.forEach(o=>i.add(o))},this.orderPaths=a=>(this.setOrderedPaths(a),a),this.disposePaths=a=>{e.setState(o=>{const l=o.data;return a.forEach(c=>{if(c in l){const d=l[c];d.__refCount--,d.__refCount===0&&d.type in pd&&delete l[c]}}),{data:l}})},this.dispose=()=>{e.setState(()=>({data:{}}))},this.getFolderSettings=a=>n[a]||{},this.getData=()=>e.getState().data,this.addData=(a,o)=>{e.setState(l=>{const c=l.data;return Object.entries(a).forEach(([d,p])=>{let y=c[d];if(y){const{type:_,value:v}=p,b=Tr(p,oAe);_!==y.type?mh(zs.INPUT_TYPE_OVERRIDE,d,y.type,_):((y.__refCount===0||o)&&Object.assign(y,b),y.__refCount++)}else c[d]=Wn(Wn({},p),{},{__refCount:1})}),{data:c}})},this.setValueAtPath=(a,o,l)=>{e.setState(c=>{const d=c.data;return C5(d[a],o,a,this,l),{data:d}})},this.setSettingsAtPath=(a,o)=>{e.setState(l=>{const c=l.data;return c[a].settings=Wn(Wn({},c[a].settings),o),{data:c}})},this.disableInputAtPath=(a,o)=>{e.setState(l=>{const c=l.data;return c[a].disabled=o,{data:c}})},this.set=(a,o)=>{e.setState(l=>{const c=l.data;return Object.entries(a).forEach(([d,p])=>{try{C5(c[d],p,void 0,void 0,o)}catch{}}),{data:c}})},this.getInput=a=>{try{return this.getData()[a]}catch{mh(zs.PATH_DOESNT_EXIST,a)}},this.get=a=>{var o;return(o=this.getInput(a))===null||o===void 0?void 0:o.value},this.emitOnEditStart=a=>{t.emit(`onEditStart:${a}`,this.get(a),a,Wn(Wn({},this.getInput(a)),{},{get:this.get}))},this.emitOnEditEnd=a=>{t.emit(`onEditEnd:${a}`,this.get(a),a,Wn(Wn({},this.getInput(a)),{},{get:this.get}))},this.subscribeToEditStart=(a,o)=>{const l=`onEditStart:${a}`;return t.on(l,o),()=>t.off(l,o)},this.subscribeToEditEnd=(a,o)=>{const l=`onEditEnd:${a}`;return t.on(l,o),()=>t.off(l,o)};const s=(a,o,l)=>{const c={};return Object.entries(a).forEach(([d,p])=>{if(d==="")return mh(zs.EMPTY_KEY);let y=PI(o,d);if(p.type===pd.FOLDER){const _=s(p.schema,y,l);Object.assign(c,_),y in n||(n[y]=p.settings)}else if(d in l)mh(zs.DUPLICATE_KEYS,d,y,l[d].path);else{const _=cTe(p,d,y,c);if(_){const{type:v,options:b,input:E}=_,{onChange:T,transient:M,onEditStart:R,onEditEnd:N}=b,P=Tr(b,lAe);c[y]=Wn(Wn(Wn({type:v},P),E),{},{fromPanel:!0}),l[d]={path:y,onChange:T,transient:M,onEditStart:R,onEditEnd:N}}else mh(zs.UNKNOWN_INPUT,y,p)}}),c};this.getDataFromSchema=a=>{const o={};return[s(a,"",o),o]}},Rj=new uAe,cAe={collapsed:!1};function Cj(r,e){return{type:pd.FOLDER,schema:r,settings:Wn(Wn({},cAe),e)}}const fAe={disabled:!1};function $p(r,e){return{type:pd.BUTTON,onClick:r,settings:Wn(Wn({},fAe),e)}}const _k=r=>"__levaInput"in r,dAe=(r,e)=>{const t={},n=e?e.toLowerCase():null;return r.forEach(i=>{const[s,a]=dMe(i);(!n||s.toLowerCase().indexOf(n)>-1)&&fMe(t,a,{[s]:{__levaInput:!0,path:i}})}),t},hAe=["type","label","path","valueKey","value","settings","setValue","disabled"];function pAe(r){let{type:e,label:t,path:n,valueKey:i,value:s,settings:a,setValue:o,disabled:l}=r,c=Tr(r,hAe);const{displayValue:d,onChange:p,onUpdate:y}=j$({type:e,value:s,settings:a,setValue:o}),_=Ty[e].component;return _?ve.createElement(F$.Provider,{value:Wn({key:i,path:n,id:""+n,label:t,displayValue:d,value:s,onChange:p,onUpdate:y,settings:a,setValue:o,disabled:l},c)},ve.createElement(CTe,{disabled:l},ve.createElement(_,null))):(mh(zs.NO_COMPONENT_FOR_TYPE,e,n),null)}const mAe=kn("button",{display:"block",$reset:"",fontWeight:"$button",height:"$rowHeight",borderStyle:"none",borderRadius:"$sm",backgroundColor:"$elevation1",color:"$highlight1","&:not(:disabled)":{color:"$highlight3",backgroundColor:"$accent2",cursor:"pointer",$hover:"$accent3",$active:"$accent3 $accent1",$focus:""}});function gAe({onClick:r,settings:e,label:t}){const n=mE();return ve.createElement(pc,null,ve.createElement(mAe,{disabled:e.disabled,onClick:()=>r(n.get)},t))}const yAe=kn("div",{$flex:"",justifyContent:"flex-end",gap:"$colGap"}),_Ae=kn("button",{$reset:"",cursor:"pointer",borderRadius:"$xs","&:hover":{backgroundColor:"$elevation3"}}),vAe=({label:r,opts:e})=>{let t=typeof r=="string"&&r.trim()===""?null:r,n=e;return typeof e.opts=="object"&&(n.label!==void 0&&(t=e.label),n=e.opts),{label:t,opts:n}};function xAe(r){const{label:e,opts:t}=vAe(r),n=mE();return ve.createElement(pc,{input:!!e},e&&ve.createElement(of,null,e),ve.createElement(yAe,null,Object.entries(t).map(([i,s])=>ve.createElement(_Ae,{key:i,onClick:()=>s(n.get)},i))))}const bAe=kn("canvas",{height:"$monitorHeight",width:"100%",display:"block",borderRadius:"$sm"}),Nj=100;function SAe(r,e){r.push(e),r.length>Nj&&r.shift()}const TAe=H.forwardRef(function({initialValue:r},e){const t=Dh("colors","highlight3"),n=Dh("colors","elevation2"),i=Dh("colors","highlight1"),[s,a]=H.useMemo(()=>[Zo(i).alpha(.4).toRgbString(),Zo(i).alpha(.1).toRgbString()],[i]),o=H.useRef([r]),l=H.useRef(r),c=H.useRef(r),d=H.useRef(),p=H.useCallback((v,b)=>{if(!v)return;const{width:E,height:T}=v,M=new Path2D,R=E/Nj,N=T*.05;for(let L=0;L<o.current.length;L++){const F=qR(o.current[L],l.current,c.current),O=R*L,B=T-F*(T-N*2)-N;M.lineTo(O,B)}b.clearRect(0,0,E,T);const P=new Path2D(M);P.lineTo(R*(o.current.length+1),T),P.lineTo(0,T),P.lineTo(0,0);const U=b.createLinearGradient(0,0,0,T);U.addColorStop(0,s),U.addColorStop(1,a),b.fillStyle=U,b.fill(P),b.strokeStyle=n,b.lineJoin="round",b.lineWidth=14,b.stroke(M),b.strokeStyle=t,b.lineWidth=2,b.stroke(M)},[t,n,s,a]),[y,_]=FTe(p);return H.useImperativeHandle(e,()=>({frame:v=>{(l.current===void 0||v<l.current)&&(l.current=v),(c.current===void 0||v>c.current)&&(c.current=v),SAe(o.current,v),d.current=requestAnimationFrame(()=>p(y.current,_.current))}}),[y,_,p]),H.useEffect(()=>()=>cancelAnimationFrame(d.current),[]),ve.createElement(bAe,{ref:y})}),vk=r=>Number.isFinite(r)?r.toPrecision(2):r.toString(),EAe=H.forwardRef(function({initialValue:r},e){const[t,n]=H.useState(vk(r));return H.useImperativeHandle(e,()=>({frame:i=>n(vk(i))}),[]),ve.createElement("div",null,t)});function xk(r){return typeof r=="function"?r():r.current}function MAe({label:r,objectOrFn:e,settings:t}){const n=H.useRef(),i=H.useRef(xk(e));return H.useEffect(()=>{const s=window.setInterval(()=>{var a;document.hidden||(a=n.current)===null||a===void 0||a.frame(xk(e))},t.interval);return()=>window.clearInterval(s)},[e,t.interval]),ve.createElement(pc,{input:!0},ve.createElement(of,{align:"top"},r),t.graph?ve.createElement(TAe,{ref:n,initialValue:i.current}):ve.createElement(EAe,{ref:n,initialValue:i.current}))}const AAe=["type","label","key"],wAe={[pd.BUTTON]:gAe,[pd.BUTTON_GROUP]:xAe,[pd.MONITOR]:MAe},RAe=ve.memo(({path:r})=>{const[e,{set:t,setSettings:n,disable:i,storeId:s,emitOnEditStart:a,emitOnEditEnd:o}]=VTe(r);if(!e)return null;const{type:l,label:c,key:d}=e,p=Tr(e,AAe);if(l in pd){const y=wAe[l];return ve.createElement(y,Ss({label:c,path:r},p))}return l in Ty?ve.createElement(pAe,Ss({key:s+r,type:l,label:c,storeId:s,path:r,valueKey:d,setValue:t,setSettings:n,disable:i,emitOnEditStart:a,emitOnEditEnd:o},p)):(XSe(zs.UNSUPPORTED_INPUT,l,r),null)});function CAe({toggle:r,toggled:e,name:t}){return ve.createElement(ATe,{onClick:()=>r()},ve.createElement(wI,{toggled:e}),ve.createElement("div",null,t))}const NAe=({name:r,path:e,tree:t})=>{const n=mE(),i=PI(e,r),{collapsed:s,color:a}=n.getFolderSettings(i),[o,l]=H.useState(!s),c=H.useRef(null),d=Dh("colors","folderWidgetColor"),p=Dh("colors","folderTextColor");return H.useLayoutEffect(()=>{c.current.style.setProperty("--leva-colors-folderWidgetColor",a||d),c.current.style.setProperty("--leva-colors-folderTextColor",a||p)},[a,d,p]),ve.createElement($R,{ref:c},ve.createElement(CAe,{name:r,toggled:o,toggle:()=>l(y=>!y)}),ve.createElement(Dj,{parent:i,tree:t,toggled:o}))},Dj=ve.memo(({isRoot:r=!1,fill:e=!1,flat:t=!1,parent:n,tree:i,toggled:s})=>{const{wrapperRef:a,contentRef:o}=mMe(s),l=mE(),c=([p,y])=>{var _;return(_k(y)?(_=l.getInput(y.path))===null||_===void 0?void 0:_.order:l.getFolderSettings(PI(n,p)).order)||0},d=Object.entries(i).sort((p,y)=>c(p)-c(y));return ve.createElement(OU,{ref:a,isRoot:r,fill:e,flat:t},ve.createElement(W$,{ref:o,isRoot:r,toggled:s},d.map(([p,y])=>_k(y)?ve.createElement(RAe,{key:y.path,valueKey:y.valueKey,path:y.path}):ve.createElement(NAe,{key:p,name:p,path:n,tree:y}))))}),DAe=kn("div",{position:"relative",fontFamily:"$mono",fontSize:"$root",color:"$rootText",backgroundColor:"$elevation1",variants:{fill:{false:{position:"fixed",top:"10px",right:"10px",zIndex:1e3,width:"$rootWidth"},true:{position:"relative",width:"100%"}},flat:{false:{borderRadius:"$lg",boxShadow:"$level1"}},oneLineLabels:{true:{[`${X$}`]:{gridTemplateColumns:"auto",gridAutoColumns:"minmax(max-content, 1fr)",gridAutoRows:"minmax($sizes$rowHeight), auto)",rowGap:0,columnGap:0,marginTop:"$rowGap"}}},hideTitleBar:{true:{$$titleBarHeight:"0px"},false:{$$titleBarHeight:"$sizes$titleBarHeight"}}},"&,*,*:after,*:before":{boxSizing:"border-box"},"*::selection":{backgroundColor:"$accent2"}}),Oj=40,QR=kn("i",{$flexCenter:"",width:Oj,userSelect:"none",cursor:"pointer","> svg":{fill:"$highlight1",transition:"transform 350ms ease, fill 250ms ease"},"&:hover > svg":{fill:"$highlight3"},variants:{active:{true:{"> svg":{fill:"$highlight2"}}}}}),OAe=kn("div",{display:"flex",alignItems:"stretch",justifyContent:"space-between",height:"$titleBarHeight",variants:{mode:{drag:{cursor:"grab"}}}}),UAe=kn("div",{$flex:"",position:"relative",width:"100%",overflow:"hidden",transition:"height 250ms ease",color:"$highlight3",paddingLeft:"$md",[`> ${QR}`]:{height:30},variants:{toggled:{true:{height:30},false:{height:0}}}}),LAe=kn("input",{$reset:"",flex:1,position:"relative",height:30,width:"100%",backgroundColor:"transparent",fontSize:"10px",borderRadius:"$root","&:focus":{},"&::placeholder":{color:"$highlight2"}}),PAe=kn("div",{touchAction:"none",$flexCenter:"",flex:1,"> svg":{fill:"$highlight1"},color:"$highlight1",variants:{drag:{true:{$draggable:"","> svg":{transition:"fill 250ms ease"},"&:hover":{color:"$highlight3"},"&:hover > svg":{fill:"$highlight3"}}},filterEnabled:{false:{paddingRight:Oj}}}}),BAe=ve.forwardRef(({setFilter:r,toggle:e},t)=>{const[n,i]=H.useState(""),s=H.useMemo(()=>O$(r,250),[r]),a=()=>{r(""),i("")},o=l=>{const c=l.currentTarget.value;e(!0),i(c)};return H.useEffect(()=>{s(n)},[n,s]),ve.createElement(ve.Fragment,null,ve.createElement(LAe,{ref:t,value:n,placeholder:"[Open filter with CMD+SHIFT+L]",onPointerDown:l=>l.stopPropagation(),onChange:o}),ve.createElement(QR,{onClick:()=>a(),style:{visibility:n?"visible":"hidden"}},ve.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",height:"14",width:"14",viewBox:"0 0 20 20",fill:"currentColor"},ve.createElement("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z",clipRule:"evenodd"}))))});function IAe({setFilter:r,onDrag:e,onDragStart:t,onDragEnd:n,toggle:i,toggled:s,title:a,drag:o,filterEnabled:l,from:c}){const[d,p]=H.useState(!1),y=H.useRef(null);H.useEffect(()=>{var v,b;d?(v=y.current)===null||v===void 0||v.focus():(b=y.current)===null||b===void 0||b.blur()},[d]);const _=yE(({offset:[v,b],first:E,last:T})=>{e({x:v,y:b}),E&&t({x:v,y:b}),T&&n({x:v,y:b})},{filterTaps:!0,from:({offset:[v,b]})=>[c?.x||v,c?.y||b]});return H.useEffect(()=>{const v=b=>{b.key==="L"&&b.shiftKey&&b.metaKey&&p(E=>!E)};return window.addEventListener("keydown",v),()=>window.removeEventListener("keydown",v)},[]),ve.createElement(ve.Fragment,null,ve.createElement(OAe,{mode:o?"drag":void 0},ve.createElement(QR,{active:!s,onClick:()=>i()},ve.createElement(wI,{toggled:s,width:12,height:8})),ve.createElement(PAe,Ss({},o?_():{},{drag:o,filterEnabled:l}),a===void 0&&o?ve.createElement("svg",{width:"20",height:"10",viewBox:"0 0 28 14",xmlns:"http://www.w3.org/2000/svg"},ve.createElement("circle",{cx:"2",cy:"2",r:"2"}),ve.createElement("circle",{cx:"14",cy:"2",r:"2"}),ve.createElement("circle",{cx:"26",cy:"2",r:"2"}),ve.createElement("circle",{cx:"2",cy:"12",r:"2"}),ve.createElement("circle",{cx:"14",cy:"12",r:"2"}),ve.createElement("circle",{cx:"26",cy:"12",r:"2"})):a),l&&ve.createElement(QR,{active:d,onClick:()=>p(v=>!v)},ve.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",height:"20",viewBox:"0 0 20 20"},ve.createElement("path",{d:"M9 9a2 2 0 114 0 2 2 0 01-4 0z"}),ve.createElement("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm1-13a4 4 0 00-3.446 6.032l-2.261 2.26a1 1 0 101.414 1.415l2.261-2.261A4 4 0 1011 5z",clipRule:"evenodd"})))),ve.createElement(UAe,{toggled:d},ve.createElement(BAe,{ref:y,setFilter:r,toggle:i})))}const FAe=["store","hidden","theme","collapsed"];function zAe(r){let{store:e,hidden:t=!1,theme:n,collapsed:i=!1}=r,s=Tr(r,FAe);const a=Sj(()=>xTe(n),[n]),[o,l]=H.useState(!i),c=typeof i=="object"?!i.collapsed:o,d=H.useMemo(()=>typeof i=="object"?p=>{typeof p=="function"?i.onChange(!p(!i.collapsed)):i.onChange(!p)}:l,[i]);return!e||t?null:ve.createElement(EI.Provider,{value:a},ve.createElement(VAe,Ss({store:e},s,{toggled:c,setToggle:d,rootClass:a.className})))}const VAe=ve.memo(({store:r,rootClass:e,fill:t=!1,flat:n=!1,neverHide:i=!1,oneLineLabels:s=!1,titleBar:a={title:void 0,drag:!0,filter:!0,position:void 0,onDrag:void 0,onDragStart:void 0,onDragEnd:void 0},hideCopyButton:o=!1,toggled:l,setToggle:c})=>{var d,p;const y=gMe(r),[_,v]=H.useState(""),b=H.useMemo(()=>dAe(y,_),[y,_]),[E,T]=Y$(),M=i||y.length>0,R=typeof a=="object"&&a.title||void 0,N=typeof a=="object"&&(d=a.drag)!==null&&d!==void 0?d:!0,P=typeof a=="object"&&(p=a.filter)!==null&&p!==void 0?p:!0,U=typeof a=="object"&&a.position||void 0,L=typeof a=="object"&&a.onDrag||void 0,F=typeof a=="object"&&a.onDragStart||void 0,O=typeof a=="object"&&a.onDragEnd||void 0;return ve.useEffect(()=>{T({x:U?.x,y:U?.y})},[U,T]),vTe(),ve.createElement(zSe,null,ve.createElement(V$.Provider,{value:{hideCopyButton:o}},ve.createElement(DAe,{ref:E,className:e,fill:t,flat:n,oneLineLabels:s,hideTitleBar:!a,style:{display:M?"block":"none"}},a&&ve.createElement(IAe,{onDrag:B=>{T(B),L?.(B)},onDragStart:B=>F?.(B),onDragEnd:B=>O?.(B),setFilter:v,toggle:B=>c(q=>B??!q),toggled:l,title:R,drag:N,filterEnabled:P,from:U}),M&&ve.createElement(z$.Provider,{value:r},ve.createElement(Dj,{isRoot:!0,fill:t,flat:n,tree:b,toggled:l})))))}),GAe=["isRoot"];let JR=!1,E0=null;function kAe(r){let{isRoot:e=!1}=r,t=Tr(r,GAe);return H.useEffect(()=>(JR=!0,!e&&E0&&(E0.remove(),E0=null),()=>{e||(JR=!1)}),[e]),ve.createElement(zAe,Ss({store:Rj},t))}function HAe(r){H.useEffect(()=>{r&&!JR&&(E0||(E0=document.getElementById("leva__root")||Object.assign(document.createElement("div"),{id:"leva__root"}),document.body&&(document.body.appendChild(E0),Sk.createRoot(E0).render(ve.createElement(kAe,{isRoot:!0})))),JR=!0)},[r])}function WAe(r,e,t,n,i){let s,a,o,l,c;return typeof r=="string"?(a=r,s=e,Array.isArray(t)?c=t:t&&("store"in t?(l=t,c=n):(o=t,Array.isArray(n)?c=n:(l=n,c=i)))):(s=r,Array.isArray(e)?c=e:(l=e,c=t)),{schema:s,folderName:a,folderSettings:o,hookSettings:l,deps:c||[]}}function qU(r,e,t,n,i){const{folderName:s,schema:a,folderSettings:o,hookSettings:l,deps:c}=WAe(r,e,t,n,i),d=typeof a=="function",p=H.useRef(!1),y=H.useRef(!0),_=Sj(()=>{p.current=!0;const q=typeof a=="function"?a():a;return s?{[s]:Cj(q,o)}:q},c),v=!(l!=null&&l.store);HAe(v);const[b]=H.useState(()=>l?.store||Rj),[E,T]=H.useMemo(()=>b.getDataFromSchema(_),[b,_]),[M,R,N,P,U]=H.useMemo(()=>{const q=[],j=[],Q={},se={},ae={};return Object.values(T).forEach(({path:V,onChange:X,onEditStart:ee,onEditEnd:fe,transient:Y})=>{q.push(V),X?(Q[V]=X,Y||j.push(V)):j.push(V),ee&&(se[V]=ee),fe&&(ae[V]=fe)}),[q,j,Q,se,ae]},[T]),L=H.useMemo(()=>b.orderPaths(M),[M,b]),F=yMe(b,R,E),O=H.useCallback(q=>{const j=Object.entries(q).reduce((Q,[se,ae])=>Object.assign(Q,{[T[se].path]:ae}),{});b.set(j,!1)},[b,T]),B=H.useCallback(q=>b.get(T[q].path),[b,T]);return H.useEffect(()=>{const q=!y.current&&p.current;return b.addData(E,q),y.current=!1,p.current=!1,()=>b.disposePaths(L)},[b,L,E]),H.useEffect(()=>{const q=[];return Object.entries(N).forEach(([j,Q])=>{Q(b.get(j),j,Wn({initial:!0,get:b.get},b.getInput(j)));const se=b.useStore.subscribe(ae=>{const V=ae.data[j];return[V.disabled?void 0:V.value,V]},([ae,V])=>Q(ae,j,Wn({initial:!1,get:b.get},V)),{equalityFn:PN});q.push(se)}),()=>q.forEach(j=>j())},[b,N]),H.useEffect(()=>{const q=[];return Object.entries(P).forEach(([j,Q])=>q.push(b.subscribeToEditStart(j,Q))),Object.entries(U).forEach(([j,Q])=>q.push(b.subscribeToEditEnd(j,Q))),()=>q.forEach(j=>j())},[P,U,b]),d?[F,O,B]:F}Zh(Kh.SELECT,i1e);Zh(Kh.IMAGE,ZMe);Zh(Kh.NUMBER,$Te);Zh(Kh.COLOR,RMe);Zh(Kh.STRING,d1e);Zh(Kh.BOOLEAN,v1e);Zh(Kh.INTERVAL,sAe);Zh(Kh.VECTOR3D,NMe);Zh(Kh.VECTOR2D,FMe);tP({MeshPhysicalNodeMaterial:xq});function qAe(){const[r,e]=qU("Alchemist Lab",()=>({waveStrength:{value:0,min:0,max:1,step:.01},waveSpeed:{value:1,min:0,max:5,step:.1},waveFrequency:{value:2,min:1,max:10,step:.1},wireColor:{value:"#00ff88"},wireThickness:{value:.1,min:0,max:1},baseColor:{value:"#ffffff",label:"Base Color"},roughness:{value:0,min:0,max:1},metalness:{value:0,min:0,max:1},transmission:{value:0,min:0,max:1,step:.01},ior:{value:1.5,min:1,max:2.33,step:.01},thickness:{value:1.5,min:0,max:5,step:.1},attenuationColor:{value:"#ffffff",label:"Atten. Color"},attenuationDistance:{value:.5,min:0,max:5,step:.1,label:"Atten. Dist"},dispersion:{value:0,min:0,max:10,step:.1,label:"Dispersion"}}),{collapsed:!0});qU("Alchemist Lab",{Presets:Cj({" Liquid Gold":$p(()=>e({baseColor:"#ffaa00",roughness:.15,metalness:1,transmission:0,ior:1.5,thickness:0,attenuationColor:"#ffffff",attenuationDistance:10,dispersion:0,waveStrength:.1,waveSpeed:.5,waveFrequency:1.5,wireThickness:0}))," Royal Diamond":$p(()=>e({baseColor:"#ffffff",roughness:0,metalness:.1,transmission:1,ior:2.4,thickness:5,attenuationColor:"#eecfff",attenuationDistance:.6,dispersion:5,waveStrength:0,wireThickness:0}))," Frosted Ice":$p(()=>e({baseColor:"#aaddff",roughness:.45,metalness:.1,transmission:1,ior:1.31,thickness:3,attenuationColor:"#0055ff",attenuationDistance:.8,dispersion:.5,waveStrength:0,wireThickness:0}))," Molten Core":$p(()=>e({baseColor:"#1a0500",roughness:.9,metalness:0,transmission:0,ior:1.5,thickness:.1,attenuationColor:"#000000",attenuationDistance:10,dispersion:0,waveStrength:.2,waveSpeed:.2,waveFrequency:3,wireColor:"#ff3300",wireThickness:.15}))," Cyber Matrix":$p(()=>e({baseColor:"#000500",roughness:.2,metalness:.8,transmission:.2,ior:1.2,thickness:1,attenuationColor:"#00ff00",attenuationDistance:2,dispersion:2,waveStrength:.05,waveSpeed:4,waveFrequency:8,wireColor:"#00ff00",wireThickness:.05}))," Black Pearl":$p(()=>e({baseColor:"#050505",roughness:.05,metalness:.7,transmission:0,ior:1.5,thickness:1,attenuationColor:"#ffffff",attenuationDistance:10,dispersion:0,waveStrength:0,wireThickness:0}))," Soap Bubble":$p(()=>e({baseColor:"#ffffff",roughness:0,metalness:0,transmission:1,ior:1.05,thickness:.1,attenuationColor:"#ffffff",attenuationDistance:5,dispersion:8,waveStrength:.1,waveSpeed:1,waveFrequency:1,wireThickness:0})),Reset:$p(()=>e({waveStrength:0,baseColor:"#ffffff",roughness:0,metalness:0,transmission:0,ior:1.5,thickness:1.5,attenuationColor:"#ffffff",attenuationDistance:.5,dispersion:0,wireThickness:.1,wireColor:"#00ff88"}))})},[e]);const{vertexNode:t,fragmentNode:n,materialsProps:i,uniforms:s}=H.useMemo(()=>{const a=xl(0),o=xl(0),l=xl(0),c=xl(new Kt(0)),d=xl(0),p=xl(new Kt(0)),y=xl(0),_=xl(0),v=xl(0),b=xl(1.5),E=xl(0),T=xl(new Kt(16777215)),M=xl(.5),R=xl(0),N=tve.mul(o),P=mw.mul(l).add(N),U=Q_e(P,1,0),L=J_e.mul(U).mul(a),F=mw.add(L),q=eve(mw.y.mul(20).add(mw.x.mul(10))).greaterThan(.9).mix(nve(0),c).mul(d).mul(5);return{vertexNode:F,fragmentNode:q,materialsProps:{colorNode:p,roughnessNode:y,metalnessNode:_,transmissionNode:v,iorNode:b,thicknessNode:E,attenuationColorNode:T,attenuationDistanceNode:M,dispersionNode:R},uniforms:{uStrength:a,uSpeed:o,uFrequency:l,uWireColor:c,uWireThickness:d,uBaseColor:p,uRoughness:y,uMetalness:_,uTransmission:v,uIOR:b,uThickness:E,uAttenuationColor:T,uAttenuationDistance:M,uDispersion:R}}},[]);return eP(()=>{s.uStrength.value=r.waveStrength,s.uSpeed.value=r.waveSpeed,s.uFrequency.value=r.waveFrequency,s.uWireColor.value.set(r.wireColor),s.uWireThickness.value=r.wireThickness,s.uBaseColor.value.set(r.baseColor),s.uRoughness.value=r.roughness,s.uMetalness.value=r.metalness,s.uTransmission.value=r.transmission,s.uIOR.value=r.ior,s.uThickness.value=r.thickness,s.uAttenuationColor.value.set(r.attenuationColor),s.uAttenuationDistance.value=r.attenuationDistance,s.uDispersion.value=r.dispersion}),Wt.jsxs("mesh",{children:[Wt.jsx("icosahedronGeometry",{args:[1,32]}),Wt.jsx("meshPhysicalNodeMaterial",{positionNode:t,emissiveNode:n,colorNode:i.colorNode,roughnessNode:i.roughnessNode,metalnessNode:i.metalnessNode,transmissionNode:i.transmissionNode,iorNode:i.iorNode,thicknessNode:i.thicknessNode,attenuationColorNode:i.attenuationColorNode,attenuationDistanceNode:i.attenuationDistanceNode,dispersionNode:i.dispersionNode,transparent:!0})]})}function XAe(){const r=qU("Environment Settings",{bgVisible:{value:!1,label:"Background Visible"},bgBlur:{value:.5,min:0,max:1,step:.05,label:"Background Blur"}},{collapsed:!0});return Wt.jsxs(Wt.Fragment,{children:[Wt.jsx(ale,{makeDefault:!0}),Wt.jsx("ambientLight",{intensity:.5}),Wt.jsx("directionalLight",{position:[5,5,5],intensity:2,castShadow:!0}),Wt.jsx("pointLight",{position:[-5,-5,-5],intensity:2,color:"#ffaa00"}),Wt.jsx(qAe,{}),Wt.jsxs("mesh",{position:[0,-1.2,0],receiveShadow:!0,children:[Wt.jsx("cylinderGeometry",{args:[.8,1.2,.5,32]}),Wt.jsx("meshStandardMaterial",{color:"#ff6600",roughness:.4,metalness:.2})]}),Wt.jsx(Tle,{files:"./hdri/potsdamer_platz_1k.hdr",background:r.bgVisible,blur:r.bgBlur})]})}nH.registerPlugin(Ei);function $Ae(){return Wt.jsx(Wt.Fragment,{children:Wt.jsx("div",{className:"canvas-warpper",children:Wt.jsx(rse,{shadows:!0,camera:{position:[0,0,5],fov:45},gl:async r=>{const e=new K_e(r);return await e.init(),e},children:Wt.jsx(XAe,{})})})})}function jAe(){return Wt.jsx(Wt.Fragment,{children:Wt.jsx($Ae,{})})}Sk.createRoot(document.getElementById("root")).render(Wt.jsx(Wt.Fragment,{children:Wt.jsx(jAe,{})}));
